typedef unsigned char   undefined;

typedef unsigned long long    GUID;
typedef unsigned int    ImageBaseOffset32;
typedef unsigned char    bool;
typedef unsigned char    byte;
typedef unsigned int    dword;
typedef long long    longlong;
typedef unsigned long long    qword;
typedef unsigned char    uchar;
typedef unsigned int    uint;
typedef unsigned long    ulong;
typedef unsigned long long    ulonglong;
typedef unsigned char    undefined1;
typedef unsigned short    undefined2;
typedef unsigned int    undefined4;
typedef unsigned long long    undefined8;
typedef unsigned short    ushort;
typedef short    wchar_t;
typedef unsigned short    word;
typedef struct _com_error _com_error, *P_com_error;

struct _com_error { // PlaceHolder Class Structure
};

typedef struct _s_HandlerType _s_HandlerType, *P_s_HandlerType;

struct _s_HandlerType {
    uint adjectives;
    ImageBaseOffset32 dispType;
    int dispCatchObj;
    ImageBaseOffset32 dispOfHandler;
    dword dispFrame;
};

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion;

typedef struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct;

struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct {
    dword OffsetToDirectory;
    dword DataIsDirectory;
};

union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion {
    dword OffsetToData;
    struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct;
};

typedef struct _s_FuncInfo _s_FuncInfo, *P_s_FuncInfo;

typedef int __ehstate_t;

struct _s_FuncInfo {
    uint magicNumber_and_bbtFlags;
    __ehstate_t maxState;
    ImageBaseOffset32 dispUnwindMap;
    uint nTryBlocks;
    ImageBaseOffset32 dispTryBlockMap;
    uint nIPMapEntries;
    ImageBaseOffset32 dispIPToStateMap;
    int dispUnwindHelp;
    ImageBaseOffset32 dispESTypeList;
    int EHFlags;
};

typedef struct _s__RTTIBaseClassDescriptor _s__RTTIBaseClassDescriptor, *P_s__RTTIBaseClassDescriptor;

typedef struct PMD PMD, *PPMD;

struct PMD {
    int mdisp;
    int pdisp;
    int vdisp;
};

struct _s__RTTIBaseClassDescriptor {
    ImageBaseOffset32 pTypeDescriptor; // ref to TypeDescriptor (RTTI 0) for class
    dword numContainedBases; // count of extended classes in BaseClassArray (RTTI 2)
    struct PMD where; // member displacement structure
    dword attributes; // bit flags
    ImageBaseOffset32 pClassHierarchyDescriptor; // ref to ClassHierarchyDescriptor (RTTI 3) for class
};

typedef struct _s_UnwindMapEntry _s_UnwindMapEntry, *P_s_UnwindMapEntry;

struct _s_UnwindMapEntry {
    __ehstate_t toState;
    ImageBaseOffset32 action;
};

typedef unsigned short    wchar16;
typedef struct _s_IPToStateMapEntry _s_IPToStateMapEntry, *P_s_IPToStateMapEntry;

typedef struct _s_IPToStateMapEntry IPToStateMapEntry;

struct _s_IPToStateMapEntry {
    ImageBaseOffset32 Ip;
    __ehstate_t state;
};

typedef struct _s_UnwindMapEntry UnwindMapEntry;

typedef struct _s__RTTIClassHierarchyDescriptor _s__RTTIClassHierarchyDescriptor, *P_s__RTTIClassHierarchyDescriptor;

typedef struct _s__RTTIClassHierarchyDescriptor RTTIClassHierarchyDescriptor;

struct _s__RTTIClassHierarchyDescriptor {
    dword signature;
    dword attributes; // bit flags
    dword numBaseClasses; // number of base classes (i.e. rtti1Count)
    ImageBaseOffset32 pBaseClassArray; // ref to BaseClassArray (RTTI 2)
};

typedef ulonglong __uint64;

typedef struct _s__RTTIBaseClassDescriptor RTTIBaseClassDescriptor;

typedef struct TypeDescriptor TypeDescriptor, *PTypeDescriptor;

struct TypeDescriptor {
    void * pVFTable;
    void * spare;
    char[0] name;
};

typedef struct _s__RTTICompleteObjectLocator _s__RTTICompleteObjectLocator, *P_s__RTTICompleteObjectLocator;

typedef struct _s__RTTICompleteObjectLocator RTTICompleteObjectLocator;

struct _s__RTTICompleteObjectLocator {
    dword signature;
    dword offset; // offset of vbtable within class
    dword cdOffset; // constructor displacement offset
    ImageBaseOffset32 pTypeDescriptor; // ref to TypeDescriptor (RTTI 0) for class
    ImageBaseOffset32 pClassDescriptor; // ref to ClassHierarchyDescriptor (RTTI 3)
};

typedef struct _s_HandlerType HandlerType;

typedef struct DName DName, *PDName;

struct DName { // PlaceHolder Class Structure
};

typedef struct pDNameNode pDNameNode, *PpDNameNode;

struct pDNameNode { // PlaceHolder Class Structure
};

typedef struct _s_TryBlockMapEntry _s_TryBlockMapEntry, *P_s_TryBlockMapEntry;

struct _s_TryBlockMapEntry {
    __ehstate_t tryLow;
    __ehstate_t tryHigh;
    __ehstate_t catchHigh;
    int nCatches;
    ImageBaseOffset32 dispHandlerArray;
};

typedef struct _s_TryBlockMapEntry TryBlockMapEntry;

typedef struct pcharNode pcharNode, *PpcharNode;

struct pcharNode { // PlaceHolder Class Structure
};

typedef struct _s_FuncInfo FuncInfo;

typedef struct _variant_t _variant_t, *P_variant_t;

struct _variant_t { // PlaceHolder Class Structure
};

typedef struct _HeapManager _HeapManager, *P_HeapManager;

struct _HeapManager { // PlaceHolder Class Structure
};

typedef struct UnDecorator UnDecorator, *PUnDecorator;

struct UnDecorator { // PlaceHolder Class Structure
};

typedef struct _OVERLAPPED _OVERLAPPED, *P_OVERLAPPED;

typedef ulonglong ULONG_PTR;

typedef union _union_538 _union_538, *P_union_538;

typedef void * HANDLE;

typedef struct _struct_539 _struct_539, *P_struct_539;

typedef void * PVOID;

typedef ulong DWORD;

struct _struct_539 {
    DWORD Offset;
    DWORD OffsetHigh;
};

union _union_538 {
    struct _struct_539 s;
    PVOID Pointer;
};

struct _OVERLAPPED {
    ULONG_PTR Internal;
    ULONG_PTR InternalHigh;
    union _union_538 u;
    HANDLE hEvent;
};

typedef struct _SECURITY_ATTRIBUTES _SECURITY_ATTRIBUTES, *P_SECURITY_ATTRIBUTES;

typedef void * LPVOID;

typedef int BOOL;

struct _SECURITY_ATTRIBUTES {
    DWORD nLength;
    LPVOID lpSecurityDescriptor;
    BOOL bInheritHandle;
};

typedef struct _STARTUPINFOW _STARTUPINFOW, *P_STARTUPINFOW;

typedef wchar_t WCHAR;

typedef WCHAR * LPWSTR;

typedef ushort WORD;

typedef uchar BYTE;

typedef BYTE * LPBYTE;

struct _STARTUPINFOW {
    DWORD cb;
    LPWSTR lpReserved;
    LPWSTR lpDesktop;
    LPWSTR lpTitle;
    DWORD dwX;
    DWORD dwY;
    DWORD dwXSize;
    DWORD dwYSize;
    DWORD dwXCountChars;
    DWORD dwYCountChars;
    DWORD dwFillAttribute;
    DWORD dwFlags;
    WORD wShowWindow;
    WORD cbReserved2;
    LPBYTE lpReserved2;
    HANDLE hStdInput;
    HANDLE hStdOutput;
    HANDLE hStdError;
};

typedef struct _SYSTEMTIME _SYSTEMTIME, *P_SYSTEMTIME;

struct _SYSTEMTIME {
    WORD wYear;
    WORD wMonth;
    WORD wDayOfWeek;
    WORD wDay;
    WORD wHour;
    WORD wMinute;
    WORD wSecond;
    WORD wMilliseconds;
};

typedef struct _STARTUPINFOW * LPSTARTUPINFOW;

typedef struct _WIN32_FIND_DATAW _WIN32_FIND_DATAW, *P_WIN32_FIND_DATAW;

typedef struct _WIN32_FIND_DATAW * LPWIN32_FIND_DATAW;

typedef struct _FILETIME _FILETIME, *P_FILETIME;

typedef struct _FILETIME FILETIME;

struct _FILETIME {
    DWORD dwLowDateTime;
    DWORD dwHighDateTime;
};

struct _WIN32_FIND_DATAW {
    DWORD dwFileAttributes;
    FILETIME ftCreationTime;
    FILETIME ftLastAccessTime;
    FILETIME ftLastWriteTime;
    DWORD nFileSizeHigh;
    DWORD nFileSizeLow;
    DWORD dwReserved0;
    DWORD dwReserved1;
    WCHAR cFileName[260];
    WCHAR cAlternateFileName[14];
};

typedef struct _OVERLAPPED * LPOVERLAPPED;

typedef struct _SECURITY_ATTRIBUTES * LPSECURITY_ATTRIBUTES;

typedef struct _RTL_CRITICAL_SECTION _RTL_CRITICAL_SECTION, *P_RTL_CRITICAL_SECTION;

typedef struct _RTL_CRITICAL_SECTION * PRTL_CRITICAL_SECTION;

typedef PRTL_CRITICAL_SECTION LPCRITICAL_SECTION;

typedef struct _RTL_CRITICAL_SECTION_DEBUG _RTL_CRITICAL_SECTION_DEBUG, *P_RTL_CRITICAL_SECTION_DEBUG;

typedef struct _RTL_CRITICAL_SECTION_DEBUG * PRTL_CRITICAL_SECTION_DEBUG;

typedef long LONG;

typedef struct _LIST_ENTRY _LIST_ENTRY, *P_LIST_ENTRY;

typedef struct _LIST_ENTRY LIST_ENTRY;

struct _RTL_CRITICAL_SECTION {
    PRTL_CRITICAL_SECTION_DEBUG DebugInfo;
    LONG LockCount;
    LONG RecursionCount;
    HANDLE OwningThread;
    HANDLE LockSemaphore;
    ULONG_PTR SpinCount;
};

struct _LIST_ENTRY {
    struct _LIST_ENTRY * Flink;
    struct _LIST_ENTRY * Blink;
};

struct _RTL_CRITICAL_SECTION_DEBUG {
    WORD Type;
    WORD CreatorBackTraceIndex;
    struct _RTL_CRITICAL_SECTION * CriticalSection;
    LIST_ENTRY ProcessLocksList;
    DWORD EntryCount;
    DWORD ContentionCount;
    DWORD Flags;
    WORD CreatorBackTraceIndexHigh;
    WORD SpareWORD;
};

typedef struct _EXCEPTION_POINTERS _EXCEPTION_POINTERS, *P_EXCEPTION_POINTERS;

typedef LONG (* PTOP_LEVEL_EXCEPTION_FILTER)(struct _EXCEPTION_POINTERS *);

typedef struct _EXCEPTION_RECORD _EXCEPTION_RECORD, *P_EXCEPTION_RECORD;

typedef struct _EXCEPTION_RECORD EXCEPTION_RECORD;

typedef EXCEPTION_RECORD * PEXCEPTION_RECORD;

typedef struct _CONTEXT _CONTEXT, *P_CONTEXT;

typedef struct _CONTEXT * PCONTEXT;

typedef ulonglong DWORD64;

typedef union _union_52 _union_52, *P_union_52;

typedef struct _M128A _M128A, *P_M128A;

typedef struct _M128A M128A;

typedef struct _XSAVE_FORMAT _XSAVE_FORMAT, *P_XSAVE_FORMAT;

typedef struct _XSAVE_FORMAT XSAVE_FORMAT;

typedef XSAVE_FORMAT XMM_SAVE_AREA32;

typedef struct _struct_53 _struct_53, *P_struct_53;

typedef ulonglong ULONGLONG;

typedef longlong LONGLONG;

struct _M128A {
    ULONGLONG Low;
    LONGLONG High;
};

struct _XSAVE_FORMAT {
    WORD ControlWord;
    WORD StatusWord;
    BYTE TagWord;
    BYTE Reserved1;
    WORD ErrorOpcode;
    DWORD ErrorOffset;
    WORD ErrorSelector;
    WORD Reserved2;
    DWORD DataOffset;
    WORD DataSelector;
    WORD Reserved3;
    DWORD MxCsr;
    DWORD MxCsr_Mask;
    M128A FloatRegisters[8];
    M128A XmmRegisters[16];
    BYTE Reserved4[96];
};

struct _struct_53 {
    M128A Header[2];
    M128A Legacy[8];
    M128A Xmm0;
    M128A Xmm1;
    M128A Xmm2;
    M128A Xmm3;
    M128A Xmm4;
    M128A Xmm5;
    M128A Xmm6;
    M128A Xmm7;
    M128A Xmm8;
    M128A Xmm9;
    M128A Xmm10;
    M128A Xmm11;
    M128A Xmm12;
    M128A Xmm13;
    M128A Xmm14;
    M128A Xmm15;
};

union _union_52 {
    XMM_SAVE_AREA32 FltSave;
    struct _struct_53 s;
};

struct _CONTEXT {
    DWORD64 P1Home;
    DWORD64 P2Home;
    DWORD64 P3Home;
    DWORD64 P4Home;
    DWORD64 P5Home;
    DWORD64 P6Home;
    DWORD ContextFlags;
    DWORD MxCsr;
    WORD SegCs;
    WORD SegDs;
    WORD SegEs;
    WORD SegFs;
    WORD SegGs;
    WORD SegSs;
    DWORD EFlags;
    DWORD64 Dr0;
    DWORD64 Dr1;
    DWORD64 Dr2;
    DWORD64 Dr3;
    DWORD64 Dr6;
    DWORD64 Dr7;
    DWORD64 Rax;
    DWORD64 Rcx;
    DWORD64 Rdx;
    DWORD64 Rbx;
    DWORD64 Rsp;
    DWORD64 Rbp;
    DWORD64 Rsi;
    DWORD64 Rdi;
    DWORD64 R8;
    DWORD64 R9;
    DWORD64 R10;
    DWORD64 R11;
    DWORD64 R12;
    DWORD64 R13;
    DWORD64 R14;
    DWORD64 R15;
    DWORD64 Rip;
    union _union_52 u;
    M128A VectorRegister[26];
    DWORD64 VectorControl;
    DWORD64 DebugControl;
    DWORD64 LastBranchToRip;
    DWORD64 LastBranchFromRip;
    DWORD64 LastExceptionToRip;
    DWORD64 LastExceptionFromRip;
};

struct _EXCEPTION_RECORD {
    DWORD ExceptionCode;
    DWORD ExceptionFlags;
    struct _EXCEPTION_RECORD * ExceptionRecord;
    PVOID ExceptionAddress;
    DWORD NumberParameters;
    ULONG_PTR ExceptionInformation[15];
};

struct _EXCEPTION_POINTERS {
    PEXCEPTION_RECORD ExceptionRecord;
    PCONTEXT ContextRecord;
};

typedef struct _SYSTEMTIME * LPSYSTEMTIME;

typedef PTOP_LEVEL_EXCEPTION_FILTER LPTOP_LEVEL_EXCEPTION_FILTER;

typedef struct ICreateErrorInfo ICreateErrorInfo, *PICreateErrorInfo;

typedef struct ICreateErrorInfoVtbl ICreateErrorInfoVtbl, *PICreateErrorInfoVtbl;

typedef long HRESULT;


// WARNING! conflicting data type names: /guiddef.h/GUID - /GUID

typedef GUID IID;

typedef DWORD ULONG;

typedef WCHAR OLECHAR;

typedef OLECHAR * LPOLESTR;

struct ICreateErrorInfo {
    struct ICreateErrorInfoVtbl * lpVtbl;
};

struct ICreateErrorInfoVtbl {
    HRESULT (* QueryInterface)(struct ICreateErrorInfo *, IID *, void * *);
    ULONG (* AddRef)(struct ICreateErrorInfo *);
    ULONG (* Release)(struct ICreateErrorInfo *);
    HRESULT (* SetGUID)(struct ICreateErrorInfo *, GUID *);
    HRESULT (* SetSource)(struct ICreateErrorInfo *, LPOLESTR);
    HRESULT (* SetDescription)(struct ICreateErrorInfo *, LPOLESTR);
    HRESULT (* SetHelpFile)(struct ICreateErrorInfo *, LPOLESTR);
    HRESULT (* SetHelpContext)(struct ICreateErrorInfo *, DWORD);
};

typedef struct IErrorInfo IErrorInfo, *PIErrorInfo;

typedef struct IErrorInfoVtbl IErrorInfoVtbl, *PIErrorInfoVtbl;

typedef OLECHAR * BSTR;

struct IErrorInfo {
    struct IErrorInfoVtbl * lpVtbl;
};

struct IErrorInfoVtbl {
    HRESULT (* QueryInterface)(struct IErrorInfo *, IID *, void * *);
    ULONG (* AddRef)(struct IErrorInfo *);
    ULONG (* Release)(struct IErrorInfo *);
    HRESULT (* GetGUID)(struct IErrorInfo *, GUID *);
    HRESULT (* GetSource)(struct IErrorInfo *, BSTR *);
    HRESULT (* GetDescription)(struct IErrorInfo *, BSTR *);
    HRESULT (* GetHelpFile)(struct IErrorInfo *, BSTR *);
    HRESULT (* GetHelpContext)(struct IErrorInfo *, DWORD *);
};

typedef struct tagSOLE_AUTHENTICATION_SERVICE tagSOLE_AUTHENTICATION_SERVICE, *PtagSOLE_AUTHENTICATION_SERVICE;

typedef struct tagSOLE_AUTHENTICATION_SERVICE SOLE_AUTHENTICATION_SERVICE;

struct tagSOLE_AUTHENTICATION_SERVICE {
    DWORD dwAuthnSvc;
    DWORD dwAuthzSvc;
    OLECHAR * pPrincipalName;
    HRESULT hr;
};

typedef enum _EXCEPTION_DISPOSITION {
    ExceptionContinueSearch=1,
    ExceptionNestedException=2,
    ExceptionCollidedUnwind=3,
    ExceptionContinueExecution=0
} _EXCEPTION_DISPOSITION;

typedef enum _EXCEPTION_DISPOSITION EXCEPTION_DISPOSITION;

typedef struct DotNetPdbInfo DotNetPdbInfo, *PDotNetPdbInfo;

struct DotNetPdbInfo {
    char signature[4];
    GUID guid;
    dword age;
    char pdbname[105];
};

typedef struct _iobuf _iobuf, *P_iobuf;

typedef struct _iobuf FILE;

struct _iobuf {
    char * _ptr;
    int _cnt;
    char * _base;
    int _flag;
    int _file;
    int _charbuf;
    int _bufsiz;
    char * _tmpfname;
};

typedef int PMFN;

typedef struct _s_ThrowInfo _s_ThrowInfo, *P_s_ThrowInfo;

typedef struct _s_ThrowInfo ThrowInfo;

struct _s_ThrowInfo {
    uint attributes;
    PMFN pmfnUnwind;
    int pForwardCompat;
    int pCatchableTypeArray;
};

typedef longlong __time64_t;

typedef ulonglong size_t;

typedef int errno_t;

typedef size_t rsize_t;

typedef struct exception exception, *Pexception;

struct exception { // PlaceHolder Class Structure
};

typedef struct bad_exception bad_exception, *Pbad_exception;

struct bad_exception { // PlaceHolder Class Structure
};

typedef struct _GUID _GUID, *P_GUID;

struct _GUID {
    ulong Data1;
    ushort Data2;
    ushort Data3;
    uchar Data4[8];
};

typedef void * RPC_AUTH_IDENTITY_HANDLE;

typedef union _ULARGE_INTEGER _ULARGE_INTEGER, *P_ULARGE_INTEGER;

typedef union _ULARGE_INTEGER ULARGE_INTEGER;

typedef struct _struct_22 _struct_22, *P_struct_22;

typedef struct _struct_23 _struct_23, *P_struct_23;

struct _struct_23 {
    DWORD LowPart;
    DWORD HighPart;
};

struct _struct_22 {
    DWORD LowPart;
    DWORD HighPart;
};

union _ULARGE_INTEGER {
    struct _struct_22 s;
    struct _struct_23 u;
    ULONGLONG QuadPart;
};

typedef PVOID PSECURITY_DESCRIPTOR;

typedef struct _struct_314 _struct_314, *P_struct_314;

typedef union anon__struct_314_bitfield_1 anon__struct_314_bitfield_1, *Panon__struct_314_bitfield_1;

typedef union anon__struct_314_bitfield_2 anon__struct_314_bitfield_2, *Panon__struct_314_bitfield_2;

union anon__struct_314_bitfield_1 {
    ULONGLONG Depth:16; // : bits 0-15
    ULONGLONG Sequence:48; // : bits 16-63
};

union anon__struct_314_bitfield_2 {
    ULONGLONG HeaderType:1; // : bits 0
    ULONGLONG Init:1; // : bits 1
    ULONGLONG Reserved:2; // : bits 2-3
    ULONGLONG NextEntry:60; // : bits 4-63
};

struct _struct_314 {
    union anon__struct_314_bitfield_1 field_0x0;
    union anon__struct_314_bitfield_2 field_0x8;
};

typedef struct _struct_313 _struct_313, *P_struct_313;

typedef union anon__struct_313_bitfield_1 anon__struct_313_bitfield_1, *Panon__struct_313_bitfield_1;

typedef union anon__struct_313_bitfield_2 anon__struct_313_bitfield_2, *Panon__struct_313_bitfield_2;

union anon__struct_313_bitfield_2 {
    ULONGLONG HeaderType:1; // : bits 0
    ULONGLONG Init:1; // : bits 1
    ULONGLONG Reserved:59; // : bits 2-60
    ULONGLONG Region:3; // : bits 61-63
};

union anon__struct_313_bitfield_1 {
    ULONGLONG Depth:16; // : bits 0-15
    ULONGLONG Sequence:9; // : bits 16-24
    ULONGLONG NextEntry:39; // : bits 25-63
};

struct _struct_313 {
    union anon__struct_313_bitfield_1 field_0x0;
    union anon__struct_313_bitfield_2 field_0x8;
};

typedef struct _struct_312 _struct_312, *P_struct_312;

struct _struct_312 {
    ULONGLONG Alignment;
    ULONGLONG Region;
};

typedef struct _struct_315 _struct_315, *P_struct_315;

typedef union anon__struct_315_bitfield_1 anon__struct_315_bitfield_1, *Panon__struct_315_bitfield_1;

typedef union anon__struct_315_bitfield_2 anon__struct_315_bitfield_2, *Panon__struct_315_bitfield_2;

union anon__struct_315_bitfield_1 {
    ULONGLONG Depth:16; // : bits 0-15
    ULONGLONG Sequence:48; // : bits 16-63
};

union anon__struct_315_bitfield_2 {
    ULONGLONG HeaderType:1; // : bits 0
    ULONGLONG Reserved:3; // : bits 1-3
    ULONGLONG NextEntry:60; // : bits 4-63
};

struct _struct_315 {
    union anon__struct_315_bitfield_1 field_0x0;
    union anon__struct_315_bitfield_2 field_0x8;
};

typedef struct _RUNTIME_FUNCTION _RUNTIME_FUNCTION, *P_RUNTIME_FUNCTION;

struct _RUNTIME_FUNCTION {
    DWORD BeginAddress;
    DWORD EndAddress;
    DWORD UnwindData;
};

typedef struct _RUNTIME_FUNCTION * PRUNTIME_FUNCTION;

typedef struct _UNWIND_HISTORY_TABLE_ENTRY _UNWIND_HISTORY_TABLE_ENTRY, *P_UNWIND_HISTORY_TABLE_ENTRY;

typedef struct _UNWIND_HISTORY_TABLE_ENTRY UNWIND_HISTORY_TABLE_ENTRY;

struct _UNWIND_HISTORY_TABLE_ENTRY {
    DWORD64 ImageBase;
    PRUNTIME_FUNCTION FunctionEntry;
};

typedef union _union_61 _union_61, *P_union_61;

typedef ulonglong * PDWORD64;

typedef struct _struct_62 _struct_62, *P_struct_62;

struct _struct_62 {
    PDWORD64 Rax;
    PDWORD64 Rcx;
    PDWORD64 Rdx;
    PDWORD64 Rbx;
    PDWORD64 Rsp;
    PDWORD64 Rbp;
    PDWORD64 Rsi;
    PDWORD64 Rdi;
    PDWORD64 R8;
    PDWORD64 R9;
    PDWORD64 R10;
    PDWORD64 R11;
    PDWORD64 R12;
    PDWORD64 R13;
    PDWORD64 R14;
    PDWORD64 R15;
};

union _union_61 {
    PDWORD64 IntegerContext[16];
    struct _struct_62 s;
};

typedef EXCEPTION_DISPOSITION (EXCEPTION_ROUTINE)(struct _EXCEPTION_RECORD *, PVOID, struct _CONTEXT *, PVOID);

typedef struct _struct_60 _struct_60, *P_struct_60;

typedef struct _M128A * PM128A;

struct _struct_60 {
    PM128A Xmm0;
    PM128A Xmm1;
    PM128A Xmm2;
    PM128A Xmm3;
    PM128A Xmm4;
    PM128A Xmm5;
    PM128A Xmm6;
    PM128A Xmm7;
    PM128A Xmm8;
    PM128A Xmm9;
    PM128A Xmm10;
    PM128A Xmm11;
    PM128A Xmm12;
    PM128A Xmm13;
    PM128A Xmm14;
    PM128A Xmm15;
};

typedef char CHAR;

typedef CHAR * LPCSTR;

typedef LONG * PLONG;

typedef ULARGE_INTEGER * PULARGE_INTEGER;

typedef CHAR * LPSTR;

typedef enum _SID_NAME_USE {
    SidTypeComputer=9,
    SidTypeUnknown=8,
    SidTypeInvalid=7,
    SidTypeLabel=10,
    SidTypeWellKnownGroup=5,
    SidTypeUser=1,
    SidTypeAlias=4,
    SidTypeDeletedAccount=6,
    SidTypeDomain=3,
    SidTypeGroup=2
} _SID_NAME_USE;

typedef enum _SID_NAME_USE * PSID_NAME_USE;

typedef DWORD ACCESS_MASK;

typedef PVOID PSID;

typedef union _union_236 _union_236, *P_union_236;

union _union_236 {
    DWORD PhysicalAddress;
    DWORD VirtualSize;
};

typedef union _LARGE_INTEGER _LARGE_INTEGER, *P_LARGE_INTEGER;

typedef union _LARGE_INTEGER LARGE_INTEGER;

typedef struct _struct_19 _struct_19, *P_struct_19;

typedef struct _struct_20 _struct_20, *P_struct_20;

struct _struct_20 {
    DWORD LowPart;
    LONG HighPart;
};

struct _struct_19 {
    DWORD LowPart;
    LONG HighPart;
};

union _LARGE_INTEGER {
    struct _struct_19 s;
    struct _struct_20 u;
    LONGLONG QuadPart;
};

typedef struct _IMAGE_SECTION_HEADER _IMAGE_SECTION_HEADER, *P_IMAGE_SECTION_HEADER;

typedef struct _IMAGE_SECTION_HEADER * PIMAGE_SECTION_HEADER;

struct _IMAGE_SECTION_HEADER {
    BYTE Name[8];
    union _union_236 Misc;
    DWORD VirtualAddress;
    DWORD SizeOfRawData;
    DWORD PointerToRawData;
    DWORD PointerToRelocations;
    DWORD PointerToLinenumbers;
    WORD NumberOfRelocations;
    WORD NumberOfLinenumbers;
    DWORD Characteristics;
};

typedef union _SLIST_HEADER _SLIST_HEADER, *P_SLIST_HEADER;

union _SLIST_HEADER {
    struct _struct_312 s;
    struct _struct_313 Header8;
    struct _struct_314 Header16;
    struct _struct_315 HeaderX64;
};

typedef WCHAR * LPCWSTR;

typedef union _union_59 _union_59, *P_union_59;

union _union_59 {
    PM128A FloatingContext[16];
    struct _struct_60 s;
};

typedef EXCEPTION_ROUTINE * PEXCEPTION_ROUTINE;

typedef struct _SLIST_ENTRY _SLIST_ENTRY, *P_SLIST_ENTRY;

typedef struct _SLIST_ENTRY * PSLIST_ENTRY;

struct _SLIST_ENTRY {
    PSLIST_ENTRY Next;
};

typedef struct _UNWIND_HISTORY_TABLE _UNWIND_HISTORY_TABLE, *P_UNWIND_HISTORY_TABLE;

struct _UNWIND_HISTORY_TABLE {
    DWORD Count;
    BYTE LocalHint;
    BYTE GlobalHint;
    BYTE Search;
    BYTE Once;
    DWORD64 LowAddress;
    DWORD64 HighAddress;
    UNWIND_HISTORY_TABLE_ENTRY Entry[12];
};

typedef struct _KNONVOLATILE_CONTEXT_POINTERS _KNONVOLATILE_CONTEXT_POINTERS, *P_KNONVOLATILE_CONTEXT_POINTERS;

struct _KNONVOLATILE_CONTEXT_POINTERS {
    union _union_59 u;
    union _union_61 u2;
};

typedef struct _UNWIND_HISTORY_TABLE * PUNWIND_HISTORY_TABLE;

typedef union _SLIST_HEADER * PSLIST_HEADER;

typedef struct _KNONVOLATILE_CONTEXT_POINTERS * PKNONVOLATILE_CONTEXT_POINTERS;

typedef struct IMAGE_DOS_HEADER IMAGE_DOS_HEADER, *PIMAGE_DOS_HEADER;

struct IMAGE_DOS_HEADER {
    char e_magic[2]; // Magic number
    word e_cblp; // Bytes of last page
    word e_cp; // Pages in file
    word e_crlc; // Relocations
    word e_cparhdr; // Size of header in paragraphs
    word e_minalloc; // Minimum extra paragraphs needed
    word e_maxalloc; // Maximum extra paragraphs needed
    word e_ss; // Initial (relative) SS value
    word e_sp; // Initial SP value
    word e_csum; // Checksum
    word e_ip; // Initial IP value
    word e_cs; // Initial (relative) CS value
    word e_lfarlc; // File address of relocation table
    word e_ovno; // Overlay number
    word e_res[4][4]; // Reserved words
    word e_oemid; // OEM identifier (for e_oeminfo)
    word e_oeminfo; // OEM information; e_oemid specific
    word e_res2[10][10]; // Reserved words
    dword e_lfanew; // File address of new exe header
    byte e_program[64]; // Actual DOS program
};

typedef struct tm tm, *Ptm;

struct tm {
    int tm_sec;
    int tm_min;
    int tm_hour;
    int tm_mday;
    int tm_mon;
    int tm_year;
    int tm_wday;
    int tm_yday;
    int tm_isdst;
};

typedef ULONG_PTR DWORD_PTR;

typedef ULONG_PTR SIZE_T;

typedef longlong INT_PTR;

typedef struct HKEY__ HKEY__, *PHKEY__;

struct HKEY__ {
    int unused;
};

typedef DWORD * LPDWORD;

typedef struct _FILETIME * PFILETIME;

typedef struct HINSTANCE__ HINSTANCE__, *PHINSTANCE__;

typedef struct HINSTANCE__ * HINSTANCE;

struct HINSTANCE__ {
    int unused;
};

typedef HINSTANCE HMODULE;

typedef HANDLE HLOCAL;

typedef struct _FILETIME * LPFILETIME;

typedef INT_PTR (* FARPROC)(void);

typedef struct HKEY__ * HKEY;

typedef HKEY * PHKEY;

typedef BOOL * LPBOOL;

typedef BYTE * PBYTE;

typedef void * LPCVOID;

typedef uint UINT;

typedef struct Var Var, *PVar;

struct Var {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct;

struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct {
    dword NameOffset;
    dword NameIsString;
};

typedef struct IMAGE_LOAD_CONFIG_CODE_INTEGRITY IMAGE_LOAD_CONFIG_CODE_INTEGRITY, *PIMAGE_LOAD_CONFIG_CODE_INTEGRITY;

struct IMAGE_LOAD_CONFIG_CODE_INTEGRITY {
    word Flags;
    word Catalog;
    dword CatalogOffset;
    dword Reserved;
};

typedef struct IMAGE_DEBUG_DIRECTORY IMAGE_DEBUG_DIRECTORY, *PIMAGE_DEBUG_DIRECTORY;

struct IMAGE_DEBUG_DIRECTORY {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    dword Type;
    dword SizeOfData;
    dword AddressOfRawData;
    dword PointerToRawData;
};

typedef struct IMAGE_RESOURCE_DIR_STRING_U_14 IMAGE_RESOURCE_DIR_STRING_U_14, *PIMAGE_RESOURCE_DIR_STRING_U_14;

struct IMAGE_RESOURCE_DIR_STRING_U_14 {
    word Length;
    wchar16 NameString[7];
};

typedef struct StringTable StringTable, *PStringTable;

struct StringTable {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_SECTION_HEADER IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;

typedef union Misc Misc, *PMisc;

typedef enum SectionFlags {
    IMAGE_SCN_ALIGN_128BYTES=8388608,
    IMAGE_SCN_ALIGN_2BYTES=2097152,
    IMAGE_SCN_ALIGN_4096BYTES=13631488,
    IMAGE_SCN_LNK_INFO=512,
    IMAGE_SCN_MEM_READ=1073741824,
    IMAGE_SCN_ALIGN_8BYTES=4194304,
    IMAGE_SCN_ALIGN_64BYTES=7340032,
    IMAGE_SCN_ALIGN_256BYTES=9437184,
    IMAGE_SCN_MEM_WRITE=2147483648,
    IMAGE_SCN_ALIGN_8192BYTES=14680064,
    IMAGE_SCN_LNK_COMDAT=4096,
    IMAGE_SCN_MEM_16BIT=131072,
    IMAGE_SCN_MEM_PURGEABLE=131072,
    IMAGE_SCN_GPREL=32768,
    IMAGE_SCN_MEM_EXECUTE=536870912,
    IMAGE_SCN_ALIGN_4BYTES=3145728,
    IMAGE_SCN_LNK_OTHER=256,
    IMAGE_SCN_ALIGN_1BYTES=1048576,
    IMAGE_SCN_MEM_PRELOAD=524288,
    IMAGE_SCN_MEM_NOT_PAGED=134217728,
    IMAGE_SCN_ALIGN_1024BYTES=11534336,
    IMAGE_SCN_ALIGN_512BYTES=10485760,
    IMAGE_SCN_MEM_LOCKED=262144,
    IMAGE_SCN_RESERVED_0001=16,
    IMAGE_SCN_CNT_INITIALIZED_DATA=64,
    IMAGE_SCN_ALIGN_32BYTES=6291456,
    IMAGE_SCN_MEM_DISCARDABLE=33554432,
    IMAGE_SCN_CNT_UNINITIALIZED_DATA=128,
    IMAGE_SCN_ALIGN_2048BYTES=12582912,
    IMAGE_SCN_MEM_SHARED=268435456,
    IMAGE_SCN_CNT_CODE=32,
    IMAGE_SCN_ALIGN_16BYTES=5242880,
    IMAGE_SCN_LNK_REMOVE=2048,
    IMAGE_SCN_LNK_NRELOC_OVFL=16777216,
    IMAGE_SCN_TYPE_NO_PAD=8,
    IMAGE_SCN_RESERVED_0040=1024,
    IMAGE_SCN_MEM_NOT_CACHED=67108864
} SectionFlags;

union Misc {
    dword PhysicalAddress;
    dword VirtualSize;
};

struct IMAGE_SECTION_HEADER {
    char Name[8];
    union Misc Misc;
    ImageBaseOffset32 VirtualAddress;
    dword SizeOfRawData;
    dword PointerToRawData;
    dword PointerToRelocations;
    dword PointerToLinenumbers;
    word NumberOfRelocations;
    word NumberOfLinenumbers;
    enum SectionFlags Characteristics;
};

typedef struct IMAGE_DATA_DIRECTORY IMAGE_DATA_DIRECTORY, *PIMAGE_DATA_DIRECTORY;

struct IMAGE_DATA_DIRECTORY {
    ImageBaseOffset32 VirtualAddress;
    dword Size;
};

typedef struct IMAGE_RESOURCE_DATA_ENTRY IMAGE_RESOURCE_DATA_ENTRY, *PIMAGE_RESOURCE_DATA_ENTRY;

struct IMAGE_RESOURCE_DATA_ENTRY {
    dword OffsetToData;
    dword Size;
    dword CodePage;
    dword Reserved;
};

typedef struct IMAGE_RESOURCE_DIRECTORY IMAGE_RESOURCE_DIRECTORY, *PIMAGE_RESOURCE_DIRECTORY;

struct IMAGE_RESOURCE_DIRECTORY {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    word NumberOfNamedEntries;
    word NumberOfIdEntries;
};

typedef struct IMAGE_DIRECTORY_ENTRY_EXPORT IMAGE_DIRECTORY_ENTRY_EXPORT, *PIMAGE_DIRECTORY_ENTRY_EXPORT;

struct IMAGE_DIRECTORY_ENTRY_EXPORT {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    dword Name;
    dword Base;
    dword NumberOfFunctions;
    dword NumberOfNames;
    dword AddressOfFunctions;
    dword AddressOfNames;
    dword AddressOfNameOrdinals;
};

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion;

union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion {
    struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct;
    dword Name;
    word Id;
};

typedef struct IMAGE_FILE_HEADER IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;

struct IMAGE_FILE_HEADER {
    word Machine; // 34404
    word NumberOfSections;
    dword TimeDateStamp;
    dword PointerToSymbolTable;
    dword NumberOfSymbols;
    word SizeOfOptionalHeader;
    word Characteristics;
};

typedef struct IMAGE_NT_HEADERS32 IMAGE_NT_HEADERS32, *PIMAGE_NT_HEADERS32;

typedef struct IMAGE_OPTIONAL_HEADER64 IMAGE_OPTIONAL_HEADER64, *PIMAGE_OPTIONAL_HEADER64;

struct IMAGE_OPTIONAL_HEADER64 {
    word Magic;
    byte MajorLinkerVersion;
    byte MinorLinkerVersion;
    dword SizeOfCode;
    dword SizeOfInitializedData;
    dword SizeOfUninitializedData;
    ImageBaseOffset32 AddressOfEntryPoint;
    ImageBaseOffset32 BaseOfCode;
    pointer64 ImageBase;
    dword SectionAlignment;
    dword FileAlignment;
    word MajorOperatingSystemVersion;
    word MinorOperatingSystemVersion;
    word MajorImageVersion;
    word MinorImageVersion;
    word MajorSubsystemVersion;
    word MinorSubsystemVersion;
    dword Win32VersionValue;
    dword SizeOfImage;
    dword SizeOfHeaders;
    dword CheckSum;
    word Subsystem;
    word DllCharacteristics;
    qword SizeOfStackReserve;
    qword SizeOfStackCommit;
    qword SizeOfHeapReserve;
    qword SizeOfHeapCommit;
    dword LoaderFlags;
    dword NumberOfRvaAndSizes;
    struct IMAGE_DATA_DIRECTORY DataDirectory[16];
};

struct IMAGE_NT_HEADERS32 {
    char Signature[4];
    struct IMAGE_FILE_HEADER FileHeader;
    struct IMAGE_OPTIONAL_HEADER64 OptionalHeader;
};

typedef struct IMAGE_LOAD_CONFIG_DIRECTORY64 IMAGE_LOAD_CONFIG_DIRECTORY64, *PIMAGE_LOAD_CONFIG_DIRECTORY64;

typedef enum IMAGE_GUARD_FLAGS {
    IMAGE_GUARD_DELAYLOAD_IAT_IN_ITS_OWN_SECTION=8192,
    IMAGE_GUARD_CF_ENABLE_EXPORT_SUPPRESSION=32768,
    IMAGE_GUARD_CF_INSTRUMENTED=256,
    IMAGE_GUARD_CF_EXPORT_SUPPRESSION_INFO_PRESENT=16384,
    IMAGE_GUARD_CFW_INSTRUMENTED=512,
    IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK_4=1073741824,
    IMAGE_GUARD_RF_INSTRUMENTED=131072,
    IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK_2=536870912,
    IMAGE_GUARD_CF_LONGJUMP_TABLE_PRESENT=65536,
    IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK_1=268435456,
    IMAGE_GUARD_PROTECT_DELAYLOAD_IAT=4096,
    IMAGE_GUARD_SECURITY_COOKIE_UNUSED=2048,
    IMAGE_GUARD_RF_STRICT=524288,
    IMAGE_GUARD_CF_FUNCTION_TABLE_PRESENT=1024,
    IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK_8=2147483648,
    IMAGE_GUARD_RF_ENABLE=262144
} IMAGE_GUARD_FLAGS;

struct IMAGE_LOAD_CONFIG_DIRECTORY64 {
    dword Size;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    dword GlobalFlagsClear;
    dword GlobalFlagsSet;
    dword CriticalSectionDefaultTimeout;
    qword DeCommitFreeBlockThreshold;
    qword DeCommitTotalFreeThreshold;
    pointer64 LockPrefixTable;
    qword MaximumAllocationSize;
    qword VirtualMemoryThreshold;
    qword ProcessAffinityMask;
    dword ProcessHeapFlags;
    word CsdVersion;
    word DependentLoadFlags;
    pointer64 EditList;
    pointer64 SecurityCookie;
    pointer64 SEHandlerTable;
    qword SEHandlerCount;
    pointer64 GuardCFCCheckFunctionPointer;
    pointer64 GuardCFDispatchFunctionPointer;
    pointer64 GuardCFFunctionTable;
    qword GuardCFFunctionCount;
    enum IMAGE_GUARD_FLAGS GuardFlags;
    struct IMAGE_LOAD_CONFIG_CODE_INTEGRITY CodeIntegrity;
    pointer64 GuardAddressTakenIatEntryTable;
    qword GuardAddressTakenIatEntryCount;
    pointer64 GuardLongJumpTargetTable;
    qword GuardLongJumpTargetCount;
    pointer64 DynamicValueRelocTable;
    pointer64 CHPEMetadataPointer;
    pointer64 GuardRFFailureRoutine;
    pointer64 GuardRFFailureRoutineFunctionPointer;
    dword DynamicValueRelocTableOffset;
    word DynamicValueRelocTableSection;
    word Reserved1;
    pointer64 GuardRFVerifyStackPointerFunctionPointer;
    dword HotPatchTableOffset;
    dword Reserved2;
    qword Reserved3;
};

typedef struct StringFileInfo StringFileInfo, *PStringFileInfo;

struct StringFileInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY IMAGE_RESOURCE_DIRECTORY_ENTRY, *PIMAGE_RESOURCE_DIRECTORY_ENTRY;

union IMAGE_RESOURCE_DIRECTORY_ENTRY {
    union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion NameUnion;
    union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion DirectoryUnion;
};

typedef struct VS_VERSION_INFO VS_VERSION_INFO, *PVS_VERSION_INFO;

struct VS_VERSION_INFO {
    word StructLength;
    word ValueLength;
    word StructType;
    wchar16 Info[16];
    byte Padding[2];
    dword Signature;
    word StructVersion[2];
    word FileVersion[4];
    word ProductVersion[4];
    dword FileFlagsMask[2];
    dword FileFlags;
    dword FileOS;
    dword FileType;
    dword FileSubtype;
    dword FileTimestamp;
};

typedef struct VarFileInfo VarFileInfo, *PVarFileInfo;

struct VarFileInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct StringInfo StringInfo, *PStringInfo;

struct StringInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef ACCESS_MASK REGSAM;

typedef LONG LSTATUS;

typedef struct DNameStatusNode DNameStatusNode, *PDNameStatusNode;

struct DNameStatusNode { // PlaceHolder Structure
};

typedef struct _xDISPATCHER_CONTEXT _xDISPATCHER_CONTEXT, *P_xDISPATCHER_CONTEXT;

struct _xDISPATCHER_CONTEXT { // PlaceHolder Structure
};

typedef struct EHExceptionRecord EHExceptionRecord, *PEHExceptionRecord;

struct EHExceptionRecord { // PlaceHolder Structure
};

typedef struct _s_ESTypeList _s_ESTypeList, *P_s_ESTypeList;

struct _s_ESTypeList { // PlaceHolder Structure
};

typedef struct _s_CatchableType _s_CatchableType, *P_s_CatchableType;

struct _s_CatchableType { // PlaceHolder Structure
};

typedef struct DNameNode DNameNode, *PDNameNode;

struct DNameNode { // PlaceHolder Structure
};

typedef struct IDispatch IDispatch, *PIDispatch;

struct IDispatch { // PlaceHolder Structure
};

typedef struct tagEXCEPINFO tagEXCEPINFO, *PtagEXCEPINFO;

struct tagEXCEPINFO { // PlaceHolder Structure
};

typedef enum DNameStatus {
} DNameStatus;

typedef int (* _onexit_t)(void);

typedef struct IUnknownVtbl IUnknownVtbl, *PIUnknownVtbl;

typedef struct IUnknown IUnknown, *PIUnknown;

struct IUnknownVtbl {
    HRESULT (* QueryInterface)(struct IUnknown *, IID *, void * *);
    ULONG (* AddRef)(struct IUnknown *);
    ULONG (* Release)(struct IUnknown *);
};

struct IUnknown {
    struct IUnknownVtbl * lpVtbl;
};

typedef struct IUnknown * LPUNKNOWN;




ulonglong FUN_180001080(void)

{
  code *pcVar1;
  undefined (*pauVar2) [16];
  ulonglong uVar3;
  _onexit_t p_Var4;

  pauVar2 = (undefined (*) [16])FUN_18005f1cc(0x10);
  if (pauVar2 != (undefined (*) [16])0x0) {
    DAT_1800b1810 = pauVar2;
    *pauVar2 = ZEXT816(0);
    *(undefined (***) [16])*DAT_1800b1810 = &DAT_1800b1810;
    p_Var4 = _onexit((_onexit_t)&LAB_18006d2b0);
    return (ulonglong)((p_Var4 != (_onexit_t)0x0) - 1);
  }
  _invalid_parameter_noinfo_noreturn();
  pcVar1 = (code *)swi(3);
  uVar3 = (*pcVar1)();
  return uVar3;
}



void FUN_1800010d0(void)

{
  DAT_1800b18e0 = (undefined **)FUN_18005f1cc(0x60);
  if (DAT_1800b18e0 != (undefined **)0x0) {
    *DAT_1800b18e0 = (undefined *)ChainBase::vftable;
    DAT_1800b18e0[2] = (undefined *)0x0;
    DAT_1800b18e0[3] = (undefined *)0x0;
    *(undefined2 *)(DAT_1800b18e0 + 4) = 0;
    *(undefined8 *)((longlong)DAT_1800b18e0 + 0x22) = 0;
    *(undefined8 *)((longlong)DAT_1800b18e0 + 0x2a) = 0;
    *(undefined8 *)((longlong)DAT_1800b18e0 + 0x32) = 0;
    *(undefined8 *)((longlong)DAT_1800b18e0 + 0x3a) = 0;
    *(undefined8 *)((longlong)DAT_1800b18e0 + 0x42) = 0;
    *(undefined8 *)((longlong)DAT_1800b18e0 + 0x4a) = 0;
    *(undefined8 *)((longlong)DAT_1800b18e0 + 0x52) = 0;
    *(undefined4 *)((longlong)DAT_1800b18e0 + 0x5a) = 0;
    *(undefined2 *)((longlong)DAT_1800b18e0 + 0x5e) = 0;
    *(undefined4 *)(DAT_1800b18e0 + 1) = 0xffffffff;
    return;
  }
  DAT_1800b18e0 = (undefined **)0x0;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint ** enrolStartEx(uint *param_1)

{
  uint **_Memory;
  uint **_Memory_00;
  uint **_Memory_01;
  undefined8 uVar1;
  uint uVar2;

                    // 0x1160  7  enrolStartEx
  if (_DAT_1800b20a0 != 1) {
    FUN_1800545f0();
    return (uint **)0x0;
  }
  uVar2 = (((DAT_1800d853c << 9 | DAT_1800d8540) << 0xb | DAT_1800d8538) << 2 | DAT_1800b20ac) * 2 |
          DAT_1800b20a8 | DAT_1800b20a4;
  _Memory = (uint **)malloc(0x20);
  _Memory_00 = (uint **)malloc(8);
  _Memory_01 = (uint **)malloc(8);
  if ((((_Memory != (uint **)0x0) && (_Memory_00 != (uint **)0x0)) && (_Memory_01 != (uint **)0x0))
     && (param_1 != (uint *)0x0)) {
    _Memory[1] = (uint *)0x0;
    _Memory[2] = (uint *)0x0;
    _Memory[3] = (uint *)0x0;
    *(undefined4 *)(_Memory + 1) = 8;
    *_Memory = (uint *)_Memory_00;
    if (0x32 < (int)*param_1) {
      *param_1 = 0x32;
    }
    uVar1 = FUN_180003f90(_Memory_01,*param_1,(ulonglong)uVar2);
    if ((*_Memory_01 != (uint *)0x0) && ((int)uVar1 == 0)) {
      *param_1 = (*_Memory_01)[8];
      FUN_1800545f0();
      *_Memory_00 = (uint *)_Memory_01;
      FUN_1800545f0();
      return _Memory;
    }
  }
  FUN_1800545f0();
  free(_Memory);
  free(_Memory_00);
  free(_Memory_01);
  return (uint **)0x0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint ** enrolStart(void)

{
  uint **_Memory;
  uint **_Memory_00;
  uint **_Memory_01;
  undefined8 uVar1;
  uint uVar2;

                    // 0x12d0  6  enrolStart
  if (_DAT_1800b20a0 != 1) {
    FUN_1800545f0();
    return (uint **)0x0;
  }
  uVar2 = (((DAT_1800d853c << 9 | DAT_1800d8540) << 0xb | DAT_1800d8538) << 2 | DAT_1800b20ac) * 2 |
          DAT_1800b20a8 | DAT_1800b20a4;
  _Memory = (uint **)malloc(0x20);
  _Memory_00 = (uint **)malloc(8);
  _Memory_01 = (uint **)malloc(8);
  if (((_Memory == (uint **)0x0) || (_Memory_00 == (uint **)0x0)) || (_Memory_01 == (uint **)0x0)) {
    FUN_1800545f0();
    free(_Memory);
    free(_Memory_00);
    free(_Memory_01);
  }
  else {
    _Memory[1] = (uint *)0x0;
    _Memory[2] = (uint *)0x0;
    _Memory[3] = (uint *)0x0;
    *(undefined4 *)(_Memory + 1) = 8;
    *_Memory = (uint *)_Memory_00;
    uVar1 = FUN_180003f90(_Memory_01,0x32,(ulonglong)uVar2);
    if ((*_Memory_01 != (uint *)0x0) && ((int)uVar1 == 0)) {
      FUN_1800545f0();
      *_Memory_00 = (uint *)_Memory_01;
      FUN_1800545f0();
      return _Memory;
    }
    FUN_1800545f0();
    free(_Memory);
    free(_Memory_00);
    free(_Memory_01);
  }
  return (uint **)0x0;
}



undefined8 gx_sensorCheck(longlong *param_1,longlong *param_2,int *param_3,byte *param_4)

{
  undefined8 uVar1;

                    // 0x1450  10  gx_sensorCheck
  if (((param_1 != (longlong *)0x0) && (param_2 != (longlong *)0x0)) && (param_3 != (int *)0x0)) {
    if ((((*(char *)((longlong)param_1 + 0xe) == '\x10') &&
         (*(char *)((longlong)param_1 + 0xf) == '\x01')) &&
        ((*(short *)(param_1 + 3) != 0 &&
         ((*(char *)((longlong)param_2 + 0xe) == '\x10' &&
          (*(char *)((longlong)param_2 + 0xf) == '\x01')))))) && (*(short *)(param_2 + 3) != 0)) {
      if ((*param_1 != 0) && (*param_2 != 0)) {
        uVar1 = FUN_180015830(*param_1,*param_2,param_4,param_3);
        return uVar1;
      }
      FUN_1800545f0();
      return 0x81;
    }
    FUN_1800545f0();
    FUN_1800545f0();
    FUN_1800545f0();
  }
  return 0x81;
}



// WARNING: Could not reconcile some variable overlaps

undefined8
enrolAddImage(longlong **param_1,longlong *param_2,undefined8 param_3,char param_4,uint *param_5)

{
  void **ppvVar1;
  byte bVar2;
  uint **ppuVar3;
  uint *puVar4;
  uint *puVar5;
  int *_Memory;
  undefined8 *_Memory_00;
  uint uVar6;
  int iVar7;
  int iVar8;
  uint local_res8 [2];
  char local_res20;
  int *local_68;
  undefined8 local_60;
  undefined8 local_58;
  undefined8 local_50;
  undefined8 *local_48;

                    // 0x1560  2  enrolAddImage
  puVar5 = param_5;
  local_60 = 0;
  local_58 = 0;
  local_50 = 0;
  local_48 = (undefined8 *)0x0;
  local_68 = (int *)0x0;
  local_res20 = param_4;
  if ((((param_1 == (longlong **)0x0) || ((uint **)*param_1 == (uint **)0x0)) ||
      (ppuVar3 = (uint **)**param_1, ppuVar3 == (uint **)0x0)) ||
     (((puVar4 = *ppuVar3, puVar4 == (uint *)0x0 || (param_2 == (longlong *)0x0)) ||
      (param_5 == (uint *)0x0)))) {
    FUN_1800545f0();
    return 0x81;
  }
  if (((*(char *)((longlong)param_2 + 0xe) == '\b') &&
      (*(char *)((longlong)param_2 + 0xf) == '\x01')) && (*(short *)(param_2 + 3) != 0)) {
    if (*param_2 == 0) {
      FUN_1800545f0();
      return 0x81;
    }
    iVar8 = (int)*(short *)((longlong)param_2 + 10);
    uVar6 = iVar8 * *(short *)(param_2 + 1);
    local_60 = CONCAT44(iVar8,(int)*(short *)(param_2 + 1));
    local_50 = 1;
    local_58._0_4_ = 0;
    local_58._4_4_ = uVar6;
    _Memory_00 = (undefined8 *)malloc((ulonglong)uVar6);
    local_48 = _Memory_00;
    if (_Memory_00 == (undefined8 *)0x0) {
      FUN_1800545f0();
      return 0x82;
    }
    local_58 = CONCAT44(local_58._4_4_,iVar8);
    memcpy_FUN_180061f90(_Memory_00,(undefined8 *)*param_2,(longlong)(int)uVar6);
    puVar5[1] = (uint)*(byte *)(param_2 + 5);
    bVar2 = *(byte *)((longlong)param_2 + 0x29);
    *puVar5 = (uint)bVar2;
    if (*(short *)((longlong)param_1 + 10) < *(short *)(param_1 + 1)) {
      local_res8[0] = 0;
      if (((*puVar4 < 9) && ((0x132U >> (*puVar4 & 0x1f) & 1) != 0)) ||
         (iVar8 = FUN_180011ab0(&local_68,(uint *)&local_60,puVar5[1],(uint)bVar2,0,puVar4),
         _Memory = local_68, _Memory_00 = local_48, iVar8 != 0)) {
        FUN_1800545f0();
        free(_Memory_00);
        return 0x80000001;
      }
      if (local_res20 != '\0') {
        local_68 = (int *)((ulonglong)local_68 & 0xffffffff00000000);
        FUN_1800144b0(_Memory,puVar4,&DAT_1800c52f4);
      }
      iVar8 = FUN_180007bc0((int *)local_res8,_Memory,puVar4);
      if (iVar8 != 0) {
        FUN_1800545f0();
        FUN_1800545f0();
        if (_Memory != (int *)0x0) {
          ppvVar1 = (void **)(_Memory + 2);
          if (((*(longlong *)(_Memory + 2) != 0) && (ppvVar1 != (void **)0x0)) &&
             (*ppvVar1 != (void *)0x0)) {
            free(*ppvVar1);
            *ppvVar1 = (void *)0x0;
          }
          *ppvVar1 = (void *)0x0;
          ppvVar1 = (void **)(_Memory + 4);
          if (((*ppvVar1 != (void *)0x0) && (ppvVar1 != (void **)0x0)) && (*ppvVar1 != (void *)0x0))
          {
            free(*ppvVar1);
            *ppvVar1 = (void *)0x0;
          }
          *ppvVar1 = (void *)0x0;
          ppvVar1 = (void **)(_Memory + 6);
          if (((*ppvVar1 != (void *)0x0) && (ppvVar1 != (void **)0x0)) && (*ppvVar1 != (void *)0x0))
          {
            free(*ppvVar1);
            *ppvVar1 = (void *)0x0;
          }
          *ppvVar1 = (void *)0x0;
          ppvVar1 = (void **)(_Memory + 8);
          if (((*ppvVar1 != (void *)0x0) && (ppvVar1 != (void **)0x0)) && (*ppvVar1 != (void *)0x0))
          {
            free(*ppvVar1);
            *ppvVar1 = (void *)0x0;
          }
          *ppvVar1 = (void *)0x0;
          if (*(void **)(_Memory + 0x3e) != (void *)0x0) {
            free(*(void **)(_Memory + 0x3e));
          }
          ppvVar1 = (void **)(_Memory + 0x4c);
          *(undefined8 *)(_Memory + 0x3e) = 0;
          if (((*ppvVar1 != (void *)0x0) && (ppvVar1 != (void **)0x0)) && (*ppvVar1 != (void *)0x0))
          {
            free(*ppvVar1);
            *ppvVar1 = (void *)0x0;
          }
          *ppvVar1 = (void *)0x0;
          free(_Memory);
        }
        free(local_48);
        return 0x83;
      }
      *(short *)((longlong)param_1 + 10) = *(short *)((longlong)param_1 + 10) + 1;
      *(uint *)(param_1 + 2) = 100 - (local_res8[0] >> 0x18);
      *(uint *)((longlong)param_1 + 0x14) = 100 - (local_res8[0] & 0xff);
      _Memory_00 = local_48;
      if (_Memory != (int *)0x0) {
        ppvVar1 = (void **)(_Memory + 2);
        if (((*(longlong *)(_Memory + 2) != 0) && (ppvVar1 != (void **)0x0)) &&
           (*ppvVar1 != (void *)0x0)) {
          free(*ppvVar1);
          *ppvVar1 = (void *)0x0;
        }
        *ppvVar1 = (void *)0x0;
        ppvVar1 = (void **)(_Memory + 4);
        if (((*ppvVar1 != (void *)0x0) && (ppvVar1 != (void **)0x0)) && (*ppvVar1 != (void *)0x0)) {
          free(*ppvVar1);
          *ppvVar1 = (void *)0x0;
        }
        *ppvVar1 = (void *)0x0;
        ppvVar1 = (void **)(_Memory + 6);
        if (((*ppvVar1 != (void *)0x0) && (ppvVar1 != (void **)0x0)) && (*ppvVar1 != (void *)0x0)) {
          free(*ppvVar1);
          *ppvVar1 = (void *)0x0;
        }
        *ppvVar1 = (void *)0x0;
        ppvVar1 = (void **)(_Memory + 8);
        if (((*ppvVar1 != (void *)0x0) && (ppvVar1 != (void **)0x0)) && (*ppvVar1 != (void *)0x0)) {
          free(*ppvVar1);
          *ppvVar1 = (void *)0x0;
        }
        *ppvVar1 = (void *)0x0;
        if (*(void **)(_Memory + 0x3e) != (void *)0x0) {
          free(*(void **)(_Memory + 0x3e));
        }
        ppvVar1 = (void **)(_Memory + 0x4c);
        *(undefined8 *)(_Memory + 0x3e) = 0;
        if (((*ppvVar1 != (void *)0x0) && (ppvVar1 != (void **)0x0)) && (*ppvVar1 != (void *)0x0)) {
          free(*ppvVar1);
          *ppvVar1 = (void *)0x0;
        }
        *ppvVar1 = (void *)0x0;
        free(_Memory);
        _Memory_00 = local_48;
      }
    }
    free(_Memory_00);
    iVar8 = (*(short *)((longlong)param_1 + 10) * 100) / (int)*(short *)(param_1 + 1);
    iVar7 = 100;
    if (iVar8 < 100) {
      iVar7 = iVar8;
    }
    *(int *)((longlong)param_1 + 0xc) = iVar7;
    if (iVar7 == 100) {
      FUN_1800545f0();
    }
    return 0;
  }
  FUN_1800545f0();
  FUN_1800545f0();
  return 0x81;
}



undefined8 enrolDeleteImage(int **param_1)

{
  int iVar1;
  int **ppiVar2;
  int *piVar3;
  longlong lVar4;
  short sVar5;
  int iVar6;
  longlong *plVar7;
  int iVar8;
  int *piVar9;
  uint uVar10;
  ulonglong uVar11;

                    // 0x1a80  3  enrolDeleteImage
  FUN_1800545f0();
  if ((((param_1 != (int **)0x0) && ((int **)*param_1 != (int **)0x0)) &&
      (ppiVar2 = *(int ***)*param_1, ppiVar2 != (int **)0x0)) &&
     (piVar3 = *ppiVar2, piVar3 != (int *)0x0)) {
    if (piVar3[7] != 0) {
      iVar8 = piVar3[7] + -1;
      iVar6 = *(int *)(*(longlong *)(piVar3 + (longlong)iVar8 * 2 + 10) + 0x104);
      uVar11 = (longlong)iVar6 & 0xffffffff;
      if (iVar6 < piVar3[9]) {
        piVar9 = piVar3 + (longlong)iVar6 * 7 + 0x6e;
        do {
          uVar10 = (int)uVar11 + 1;
          uVar11 = (ulonglong)uVar10;
          *piVar9 = -1;
          piVar9[1] = 0x100;
          piVar9[2] = 0;
          piVar9[3] = 0;
          *(undefined8 *)(piVar9 + 4) = 0x10000000000;
          piVar9[6] = 0;
          piVar9 = piVar9 + 7;
        } while ((int)uVar10 < piVar3[9]);
      }
      iVar1 = piVar3[7];
      piVar3[9] = iVar6;
      piVar3[7] = iVar1 + -1;
      if (iVar8 == piVar3[0x21f6]) {
        piVar3[0x21f9] = 0;
        iVar8 = 0;
        if (0 < iVar1 + -1) {
          plVar7 = (longlong *)(piVar3 + 10);
          do {
            lVar4 = *plVar7;
            plVar7 = plVar7 + 1;
            iVar8 = iVar8 + 1;
            *(undefined4 *)(lVar4 + 0x100) = 0;
          } while (iVar8 < piVar3[7]);
        }
      }
      if (1 < *piVar3 - 9U) {
        FUN_180017490((longlong)piVar3);
      }
    }
    if (0 < *(short *)((longlong)param_1 + 10)) {
      sVar5 = *(short *)((longlong)param_1 + 10) + -1;
      *(short *)((longlong)param_1 + 10) = sVar5;
      iVar8 = (sVar5 * 100) / (int)*(short *)(param_1 + 1);
      iVar6 = 100;
      if (iVar8 < 100) {
        iVar6 = iVar8;
      }
      *(int *)((longlong)param_1 + 0xc) = iVar6;
    }
    return 0;
  }
  FUN_1800545f0();
  return 0x81;
}



undefined8 enrolGetTemplate(longlong *param_1,undefined8 *param_2)

{
                    // 0x1bd0  5  enrolGetTemplate
  FUN_1800545f0();
  if ((param_1 != (longlong *)0x0) && ((undefined8 *)*param_1 != (undefined8 *)0x0)) {
    *param_2 = *(undefined8 *)*param_1;
    return 0;
  }
  FUN_1800545f0();
  return 0x81;
}



undefined8 enrolFinish(void **param_1)

{
  void **_Memory;

                    // 0x1c30  4  enrolFinish
  FUN_1800545f0();
  if (param_1 == (void **)0x0) {
    FUN_1800545f0();
    return 0x81;
  }
                    // WARNING: Load size is inaccurate
  _Memory = **param_1;
  if (_Memory != (void **)0x0) {
    FUN_1800048e0(_Memory);
  }
  free(_Memory);
  free(*param_1);
  *param_1 = (void *)0x0;
  free(param_1);
  return 0;
}



// WARNING: Could not reconcile some variable overlaps

undefined8
identifyImage(longlong *param_1,longlong **param_2,uint param_3,uint *param_4,int *param_5,
             uint *param_6,uint param_7,byte param_8,ulonglong param_9,char param_10)

{
  byte bVar1;
  uint *puVar2;
  undefined8 *_Memory;
  undefined8 uVar3;
  ulonglong uVar4;
  int iVar5;
  uint *puVar6;
  uint uVar7;
  int iVar8;
  uint uVar9;
  longlong lVar10;
  uint *puVar11;
  int local_68 [2];
  undefined8 local_60;
  undefined8 local_58;
  undefined8 local_50;
  undefined8 *local_48;

                    // 0x1cb0  11  identifyImage
  local_60 = 0;
  local_58 = 0;
  iVar5 = 0;
  local_50 = 0;
  local_48 = (undefined8 *)0x0;
  local_68[0] = 0;
  DAT_1800b2098 = (uint *)0x0;
  if ((((param_1 == (longlong *)0x0) || (param_2 == (longlong **)0x0)) || (param_4 == (uint *)0x0))
     || ((param_5 == (int *)0x0 || (param_6 == (uint *)0x0)))) {
    FUN_1800545f0();
    return 0x81;
  }
  *param_5 = 0;
  *param_4 = 0xffffffff;
  if (*param_1 == 0) {
    FUN_1800545f0();
    return 0x81;
  }
  if (((*(char *)((longlong)param_1 + 0xe) != '\b') ||
      (*(char *)((longlong)param_1 + 0xf) != '\x01')) || (*(short *)(param_1 + 3) == 0)) {
    FUN_1800545f0();
    return 0x81;
  }
  if (*param_2 == (longlong *)0x0) {
    FUN_1800545f0();
    return 0x81;
  }
  if (**param_2 == 0) {
    FUN_1800545f0();
    return 0x81;
  }
  if (param_3 == 0) {
    FUN_1800545f0();
    return 0x81;
  }
  iVar8 = (int)*(short *)((longlong)param_1 + 10);
  local_58._4_4_ = iVar8 * *(short *)(param_1 + 1);
  local_60 = CONCAT44(iVar8,(int)*(short *)(param_1 + 1));
  local_50 = 1;
  local_58._0_4_ = 0;
  _Memory = (undefined8 *)malloc((ulonglong)local_58._4_4_);
  local_48 = _Memory;
  if (_Memory == (undefined8 *)0x0) {
    FUN_1800545f0();
    uVar3 = 0x82;
  }
  else {
    local_58 = CONCAT44(local_58._4_4_,iVar8);
    memcpy_FUN_180061f90
              (_Memory,(undefined8 *)*param_1,
               (longlong)((int)*(short *)((longlong)param_1 + 10) * (int)*(short *)(param_1 + 1)));
    param_6[1] = (uint)*(byte *)(param_1 + 5);
    bVar1 = *(byte *)((longlong)param_1 + 0x29);
    puVar11 = (uint *)(ulonglong)bVar1;
    *param_6 = (uint)bVar1;
    uVar9 = *(uint *)**param_2;
    if (((uVar9 < 9) && ((0x132U >> (uVar9 & 0x1f) & 1) != 0)) ||
       (iVar8 = FUN_180011ab0((int **)&DAT_1800b2090,(uint *)&local_60,param_6[1],(uint)bVar1,1,
                              (uint *)**param_2), _Memory = local_48, iVar8 != 0)) {
      FUN_1800545f0();
      free(_Memory);
      uVar3 = 0x80000001;
    }
    else {
      uVar9 = 0;
      if (param_3 != 0) {
        do {
          puVar2 = (uint *)**param_2;
          if (puVar2 == (uint *)0x0) {
            FUN_1800545f0();
            free(local_48);
            return 0x81;
          }
          if (param_10 != '\0') {
            uVar7 = (((DAT_1800d853c << 9 | DAT_1800d8540) << 0xb | DAT_1800d8538) << 2 |
                    DAT_1800b20ac) * 2 | DAT_1800b20a8 | DAT_1800b20a4;
            puVar6 = puVar2;
            FUN_1800144b0(DAT_1800b2090);
            uVar4 = FUN_18003b0b0(param_9,(ulonglong)puVar6,(ulonglong)uVar7,(ulonglong)puVar11);
            if ((int)uVar4 == 0) {
              return 0x84;
            }
          }
          iVar8 = FUN_1800206e0(local_68,DAT_1800b2090,puVar2,param_7,(uint)param_8,
                                (undefined8 *)&DAT_1800e9750);
          iVar5 = local_68[0];
          if (iVar8 != 0) {
            FUN_1800545f0();
            return 0x83;
          }
          puVar11 = (uint *)(ulonglong)puVar2[8];
          FUN_1800545f0();
          if (*puVar2 - 9 < 2) {
            if (puVar2[0x2380] == 0) {
              puVar11 = (uint *)&DAT_00000004;
              do {
                puVar11 = (uint *)((longlong)puVar11 + -1);
              } while (puVar11 != (uint *)0x0);
            }
            else {
              puVar11 = puVar2 + 0x236d;
              lVar10 = 4;
              do {
                puVar11 = puVar11 + 5;
                lVar10 = lVar10 + -1;
              } while (lVar10 != 0);
            }
          }
          else {
            if (puVar2[0x2380] == 0) {
              puVar11 = (uint *)&DAT_00000004;
              do {
                puVar11 = (uint *)((longlong)puVar11 + -1);
              } while (puVar11 != (uint *)0x0);
            }
          }
          FUN_1800545f0();
          if (0 < iVar5) {
            *param_5 = iVar5;
            DAT_1800b2098 = puVar2;
            *param_4 = uVar9;
            free(local_48);
            goto LAB_180002155;
          }
          uVar9 = uVar9 + 1;
          param_2 = param_2 + 1;
        } while (uVar9 < param_3);
      }
      free(local_48);
      *param_5 = iVar5;
      *param_4 = 0xffffffff;
LAB_180002155:
      uVar3 = 0;
    }
  }
  return uVar3;
}



ulonglong templateStudy(int *param_1)

{
  void **ppvVar1;
  int iVar2;
  ulonglong uVar3;
  int local_res8;
  undefined4 local_resc;

                    // 0x2220  27  templateStudy
  if (param_1 == (int *)0x0) {
    FUN_1800545f0();
    uRam0000000000000000 = 0;
    if (DAT_1800b2090 != (uint *)0x0) {
      ppvVar1 = (void **)(DAT_1800b2090 + 2);
      if (((*(longlong *)(DAT_1800b2090 + 2) != 0) && (ppvVar1 != (void **)0x0)) &&
         (*ppvVar1 != (void *)0x0)) {
        free(*ppvVar1);
        *ppvVar1 = (void *)0x0;
      }
      *(undefined8 *)(DAT_1800b2090 + 2) = 0;
      ppvVar1 = (void **)(DAT_1800b2090 + 4);
      if (((*(longlong *)(DAT_1800b2090 + 4) != 0) && (ppvVar1 != (void **)0x0)) &&
         (*ppvVar1 != (void *)0x0)) {
        free(*ppvVar1);
        *ppvVar1 = (void *)0x0;
      }
      *(undefined8 *)(DAT_1800b2090 + 4) = 0;
      ppvVar1 = (void **)(DAT_1800b2090 + 6);
      if (((*(longlong *)(DAT_1800b2090 + 6) != 0) && (ppvVar1 != (void **)0x0)) &&
         (*ppvVar1 != (void *)0x0)) {
        free(*ppvVar1);
        *ppvVar1 = (void *)0x0;
      }
      *(undefined8 *)(DAT_1800b2090 + 6) = 0;
      ppvVar1 = (void **)(DAT_1800b2090 + 8);
      if (((*(longlong *)(DAT_1800b2090 + 8) != 0) && (ppvVar1 != (void **)0x0)) &&
         (*ppvVar1 != (void *)0x0)) {
        free(*ppvVar1);
        *ppvVar1 = (void *)0x0;
      }
      *(undefined8 *)(DAT_1800b2090 + 8) = 0;
      if (*(void **)(DAT_1800b2090 + 0x3e) != (void *)0x0) {
        free(*(void **)(DAT_1800b2090 + 0x3e));
      }
      *(undefined8 *)(DAT_1800b2090 + 0x3e) = 0;
      ppvVar1 = (void **)(DAT_1800b2090 + 0x4c);
      if (((*ppvVar1 != (void *)0x0) && (ppvVar1 != (void **)0x0)) && (*ppvVar1 != (void *)0x0)) {
        free(*ppvVar1);
        *ppvVar1 = (void *)0x0;
      }
      *(undefined8 *)(DAT_1800b2090 + 0x4c) = 0;
      free(DAT_1800b2090);
      DAT_1800b2090 = (uint *)0x0;
    }
    return 0x81;
  }
  local_resc = 0xffffffff;
  local_res8 = 0;
  if (DAT_1800b2098 != (uint *)0x0) {
    uVar3 = FUN_180018a70(DAT_1800b2098,DAT_1800b2090,(uint *)&DAT_1800e9750,&local_res8);
    iVar2 = local_res8;
    if ((int)uVar3 != 0) {
      FUN_1800545f0();
      *param_1 = iVar2;
      if (DAT_1800b2090 == (uint *)0x0) {
        return uVar3 & 0xffffffff;
      }
      ppvVar1 = (void **)(DAT_1800b2090 + 2);
      if (((*(longlong *)(DAT_1800b2090 + 2) != 0) && (ppvVar1 != (void **)0x0)) &&
         (*ppvVar1 != (void *)0x0)) {
        free(*ppvVar1);
        *ppvVar1 = (void *)0x0;
      }
      *(undefined8 *)(DAT_1800b2090 + 2) = 0;
      ppvVar1 = (void **)(DAT_1800b2090 + 4);
      if (((*(longlong *)(DAT_1800b2090 + 4) != 0) && (ppvVar1 != (void **)0x0)) &&
         (*ppvVar1 != (void *)0x0)) {
        free(*ppvVar1);
        *ppvVar1 = (void *)0x0;
      }
      *(undefined8 *)(DAT_1800b2090 + 4) = 0;
      ppvVar1 = (void **)(DAT_1800b2090 + 6);
      if (((*(longlong *)(DAT_1800b2090 + 6) != 0) && (ppvVar1 != (void **)0x0)) &&
         (*ppvVar1 != (void *)0x0)) {
        free(*ppvVar1);
        *ppvVar1 = (void *)0x0;
      }
      *(undefined8 *)(DAT_1800b2090 + 6) = 0;
      ppvVar1 = (void **)(DAT_1800b2090 + 8);
      if (((*(longlong *)(DAT_1800b2090 + 8) != 0) && (ppvVar1 != (void **)0x0)) &&
         (*ppvVar1 != (void *)0x0)) {
        free(*ppvVar1);
        *ppvVar1 = (void *)0x0;
      }
      *(undefined8 *)(DAT_1800b2090 + 8) = 0;
      if (*(void **)(DAT_1800b2090 + 0x3e) != (void *)0x0) {
        free(*(void **)(DAT_1800b2090 + 0x3e));
      }
      *(undefined8 *)(DAT_1800b2090 + 0x3e) = 0;
      ppvVar1 = (void **)(DAT_1800b2090 + 0x4c);
      if (((*ppvVar1 != (void *)0x0) && (ppvVar1 != (void **)0x0)) && (*ppvVar1 != (void *)0x0)) {
        free(*ppvVar1);
        *ppvVar1 = (void *)0x0;
      }
      *(undefined8 *)(DAT_1800b2090 + 0x4c) = 0;
      free(DAT_1800b2090);
      DAT_1800b2090 = (uint *)0x0;
      return uVar3 & 0xffffffff;
    }
  }
  *param_1 = local_res8;
  FUN_1800545f0();
  if (DAT_1800b2090 != (uint *)0x0) {
    ppvVar1 = (void **)(DAT_1800b2090 + 2);
    if (((*(longlong *)(DAT_1800b2090 + 2) != 0) && (ppvVar1 != (void **)0x0)) &&
       (*ppvVar1 != (void *)0x0)) {
      free(*ppvVar1);
      *ppvVar1 = (void *)0x0;
    }
    *(undefined8 *)(DAT_1800b2090 + 2) = 0;
    ppvVar1 = (void **)(DAT_1800b2090 + 4);
    if (((*(longlong *)(DAT_1800b2090 + 4) != 0) && (ppvVar1 != (void **)0x0)) &&
       (*ppvVar1 != (void *)0x0)) {
      free(*ppvVar1);
      *ppvVar1 = (void *)0x0;
    }
    *(undefined8 *)(DAT_1800b2090 + 4) = 0;
    ppvVar1 = (void **)(DAT_1800b2090 + 6);
    if (((*(longlong *)(DAT_1800b2090 + 6) != 0) && (ppvVar1 != (void **)0x0)) &&
       (*ppvVar1 != (void *)0x0)) {
      free(*ppvVar1);
      *ppvVar1 = (void *)0x0;
    }
    *(undefined8 *)(DAT_1800b2090 + 6) = 0;
    ppvVar1 = (void **)(DAT_1800b2090 + 8);
    if (((*(longlong *)(DAT_1800b2090 + 8) != 0) && (ppvVar1 != (void **)0x0)) &&
       (*ppvVar1 != (void *)0x0)) {
      free(*ppvVar1);
      *ppvVar1 = (void *)0x0;
    }
    *(undefined8 *)(DAT_1800b2090 + 8) = 0;
    if (*(void **)(DAT_1800b2090 + 0x3e) != (void *)0x0) {
      free(*(void **)(DAT_1800b2090 + 0x3e));
    }
    *(undefined8 *)(DAT_1800b2090 + 0x3e) = 0;
    ppvVar1 = (void **)(DAT_1800b2090 + 0x4c);
    if (((*ppvVar1 != (void *)0x0) && (ppvVar1 != (void **)0x0)) && (*ppvVar1 != (void *)0x0)) {
      free(*ppvVar1);
      *ppvVar1 = (void *)0x0;
    }
    *(undefined8 *)(DAT_1800b2090 + 0x4c) = 0;
    free(DAT_1800b2090);
    DAT_1800b2090 = (uint *)0x0;
  }
  return 0;
}



undefined8 identifyUpdate(void)

{
                    // 0x26d0  12  identifyUpdate
  return 0;
}



undefined8 templatePack(uint **param_1,undefined *param_2)

{
  uint *puVar1;
  int iVar2;
  ulonglong uVar3;
  uint local_res8 [2];
  undefined8 local_res18 [2];

                    // 0x26e0  26  templatePack
  local_res18[0] = 0;
  FUN_1800545f0();
  if (((param_1 != (uint **)0x0) && (param_2 != (undefined *)0x0)) &&
     (puVar1 = *param_1, puVar1 != (uint *)0x0)) {
    uVar3 = FUN_18000d5a0(puVar1);
    local_res8[0] = (uint)uVar3;
    iVar2 = FUN_18000a3c0(local_res18,param_2,local_res8,puVar1);
    if (iVar2 != 0) {
      FUN_1800545f0();
      return 0x80;
    }
    return 0;
  }
  FUN_1800545f0();
  return 0x81;
}



ulonglong templateGetPackedSize(uint **param_1)

{
  ulonglong uVar1;

                    // 0x2790  25  templateGetPackedSize
  FUN_1800545f0();
  if ((param_1 != (uint **)0x0) && (*param_1 != (uint *)0x0)) {
    uVar1 = FUN_18000d5a0(*param_1);
    FUN_1800545f0();
    return uVar1 & 0xffffffff;
  }
  return 0;
}



ulonglong templateUnPack(uint *param_1,uint param_2,uint *param_3,uint **param_4)

{
  uint uVar1;
  uint **_Memory;
  uint *local_res8;
  uint local_res10 [2];
  uint *local_28 [2];

                    // 0x27e0  28  templateUnPack
  local_res8 = (uint *)0x0;
  local_res10[0] = param_2;
  FUN_1800545f0();
  if (((param_1 == (uint *)0x0) || (param_4 == (uint **)0x0)) || (param_2 == 0)) {
    return 0x81;
  }
  _Memory = (uint **)malloc(8);
  if (_Memory == (uint **)0x0) {
    FUN_1800545f0();
    return 0x82;
  }
  local_28[0] = param_1;
  uVar1 = FUN_18000b0e0(local_28,local_res10,&local_res8,param_3);
  if (uVar1 != 0) {
    free(_Memory);
    return (ulonglong)uVar1;
  }
  *_Memory = local_res8;
  FUN_1800545f0();
  *param_4 = (uint *)_Memory;
  return 0;
}



void templateDelete(void **param_1)

{
  void *_Memory;
  int iVar1;
  void **ppvVar2;
  longlong lVar3;

                    // 0x28d0  24  templateDelete
  FUN_1800545f0();
  if ((param_1 != (void **)0x0) && (_Memory = *param_1, _Memory != (void *)0x0)) {
    iVar1 = 0;
    if (0 < *(int *)((longlong)_Memory + 0x20)) {
      do {
        FUN_180004ab0((void **)((longlong)_Memory + ((longlong)iVar1 + 5) * 8));
        iVar1 = iVar1 + 1;
      } while (iVar1 < *(int *)((longlong)_Memory + 0x20));
    }
    ppvVar2 = (void **)((longlong)_Memory + 0x8d10);
    lVar3 = 0x14;
    do {
      FUN_180004ab0(ppvVar2);
      ppvVar2 = ppvVar2 + 1;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
    free(_Memory);
                    // WARNING: Could not recover jumptable at 0x000180002966. Too many branches
                    // WARNING: Treating indirect jump as call
    free(param_1);
    return;
  }
  FUN_1800545f0();
  return;
}



undefined8 getAlgorithmVersion(uint *param_1)

{
  char cVar1;
  uint *_Memory;
  uint *puVar2;
  int iVar3;
  void **ppvVar4;
  uint *puVar5;
  longlong lVar6;
  uint *local_res8;

                    // 0x2990  8  getAlgorithmVersion
  iVar3 = 0;
  local_res8 = (uint *)0x0;
  if (param_1 == (uint *)0x0) {
    return 0x81;
  }
  FUN_180003f90(&local_res8,0x32,
                (ulonglong)
                ((((DAT_1800d853c << 9 | DAT_1800d8540) << 0xb | DAT_1800d8538) << 2 | DAT_1800b20ac
                 ) * 2 | DAT_1800b20a8 | DAT_1800b20a4));
  _Memory = local_res8;
  if (local_res8 != (uint *)0x0) {
    puVar2 = local_res8 + 0x222d;
    if ((puVar2 != (uint *)0x0) && (param_1 != puVar2)) {
      puVar5 = (uint *)((longlong)param_1 - (longlong)puVar2);
      do {
        cVar1 = *(char *)puVar2;
        *(char *)((longlong)puVar5 + (longlong)puVar2) = cVar1;
        puVar2 = (uint *)((longlong)puVar2 + 1);
      } while (cVar1 != '\0');
    }
    if (0 < (int)local_res8[8]) {
      do {
        FUN_180004ab0((void **)(_Memory + ((longlong)iVar3 + 5) * 2));
        iVar3 = iVar3 + 1;
      } while (iVar3 < (int)_Memory[8]);
    }
    ppvVar4 = (void **)(_Memory + 0x2344);
    lVar6 = 0x14;
    do {
      FUN_180004ab0(ppvVar4);
      ppvVar4 = ppvVar4 + 1;
      lVar6 = lVar6 + -1;
    } while (lVar6 != 0);
    free(_Memory);
    return 0;
  }
  return 0x80;
}



void getQuality(longlong *param_1,int *param_2)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  undefined8 local_28;
  undefined8 local_20;
  undefined8 local_18;
  longlong local_10;

                    // 0x2ab0  9  getQuality
  uVar2 = (((DAT_1800d853c << 9 | DAT_1800d8540) << 0xb | DAT_1800d8538) << 2 | DAT_1800b20ac) * 2 |
          DAT_1800b20a8 | DAT_1800b20a4;
  if ((param_1 != (longlong *)0x0) && (local_10 = *param_1, local_10 != 0)) {
    iVar3 = (int)*(short *)(param_1 + 1);
    iVar1 = (int)*(short *)((longlong)param_1 + 10);
    local_28 = CONCAT44(iVar1,iVar3);
    local_18 = 1;
    local_20 = CONCAT44(iVar1 * iVar3,iVar1);
    if ((DAT_1800d8538 == 1) || (DAT_1800d8538 == 8)) {
      *param_2 = iVar1 * iVar3;
    }
    else {
      *param_2 = 0;
    }
    FUN_180013600((uint *)&local_28,uVar2,param_2 + 1,param_2);
    *(undefined *)(param_1 + 5) = *(undefined *)(param_2 + 1);
    *(undefined *)((longlong)param_1 + 0x29) = *(undefined *)param_2;
  }
  return;
}



void identifytemplate(uint **param_1,undefined8 *param_2,undefined8 param_3,uint *param_4)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  uint *puVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined8 *_Memory;
  undefined8 *puVar7;
  undefined8 *puVar8;
  longlong lVar9;
  uint uVar10;
  uint **ppuVar11;
  int local_6d8 [4];
  undefined8 local_6c8 [210];
  ulonglong local_38;

                    // 0x2b90  13  identifytemplate
  local_38 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffff8e8;
  local_6d8[0] = 0;
  if ((((param_1 != (uint **)0x0) && (param_2 != (undefined8 *)0x0)) && (param_4 != (uint *)0x0)) &&
     ((puVar3 = *param_1, puVar3 != (uint *)0x0 &&
      (_Memory = (undefined8 *)malloc(0x8e08), _Memory != (undefined8 *)0x0)))) {
    lVar9 = 0x11c;
    puVar7 = (undefined8 *)*param_2;
    puVar8 = _Memory;
    do {
      puVar1 = puVar8 + 0x10;
      uVar4 = *(undefined4 *)((longlong)puVar7 + 4);
      uVar5 = *(undefined4 *)(puVar7 + 1);
      uVar6 = *(undefined4 *)((longlong)puVar7 + 0xc);
      puVar2 = puVar7 + 0x10;
      *(undefined4 *)puVar8 = *(undefined4 *)puVar7;
      *(undefined4 *)((longlong)puVar8 + 4) = uVar4;
      *(undefined4 *)(puVar8 + 1) = uVar5;
      *(undefined4 *)((longlong)puVar8 + 0xc) = uVar6;
      uVar4 = *(undefined4 *)((longlong)puVar7 + 0x14);
      uVar5 = *(undefined4 *)(puVar7 + 3);
      uVar6 = *(undefined4 *)((longlong)puVar7 + 0x1c);
      *(undefined4 *)(puVar8 + 2) = *(undefined4 *)(puVar7 + 2);
      *(undefined4 *)((longlong)puVar8 + 0x14) = uVar4;
      *(undefined4 *)(puVar8 + 3) = uVar5;
      *(undefined4 *)((longlong)puVar8 + 0x1c) = uVar6;
      uVar4 = *(undefined4 *)((longlong)puVar7 + 0x24);
      uVar5 = *(undefined4 *)(puVar7 + 5);
      uVar6 = *(undefined4 *)((longlong)puVar7 + 0x2c);
      *(undefined4 *)(puVar8 + 4) = *(undefined4 *)(puVar7 + 4);
      *(undefined4 *)((longlong)puVar8 + 0x24) = uVar4;
      *(undefined4 *)(puVar8 + 5) = uVar5;
      *(undefined4 *)((longlong)puVar8 + 0x2c) = uVar6;
      uVar4 = *(undefined4 *)((longlong)puVar7 + 0x34);
      uVar5 = *(undefined4 *)(puVar7 + 7);
      uVar6 = *(undefined4 *)((longlong)puVar7 + 0x3c);
      *(undefined4 *)(puVar8 + 6) = *(undefined4 *)(puVar7 + 6);
      *(undefined4 *)((longlong)puVar8 + 0x34) = uVar4;
      *(undefined4 *)(puVar8 + 7) = uVar5;
      *(undefined4 *)((longlong)puVar8 + 0x3c) = uVar6;
      uVar4 = *(undefined4 *)((longlong)puVar7 + 0x44);
      uVar5 = *(undefined4 *)(puVar7 + 9);
      uVar6 = *(undefined4 *)((longlong)puVar7 + 0x4c);
      *(undefined4 *)(puVar8 + 8) = *(undefined4 *)(puVar7 + 8);
      *(undefined4 *)((longlong)puVar8 + 0x44) = uVar4;
      *(undefined4 *)(puVar8 + 9) = uVar5;
      *(undefined4 *)((longlong)puVar8 + 0x4c) = uVar6;
      uVar4 = *(undefined4 *)((longlong)puVar7 + 0x54);
      uVar5 = *(undefined4 *)(puVar7 + 0xb);
      uVar6 = *(undefined4 *)((longlong)puVar7 + 0x5c);
      *(undefined4 *)(puVar8 + 10) = *(undefined4 *)(puVar7 + 10);
      *(undefined4 *)((longlong)puVar8 + 0x54) = uVar4;
      *(undefined4 *)(puVar8 + 0xb) = uVar5;
      *(undefined4 *)((longlong)puVar8 + 0x5c) = uVar6;
      uVar4 = *(undefined4 *)((longlong)puVar7 + 100);
      uVar5 = *(undefined4 *)(puVar7 + 0xd);
      uVar6 = *(undefined4 *)((longlong)puVar7 + 0x6c);
      *(undefined4 *)(puVar8 + 0xc) = *(undefined4 *)(puVar7 + 0xc);
      *(undefined4 *)((longlong)puVar8 + 100) = uVar4;
      *(undefined4 *)(puVar8 + 0xd) = uVar5;
      *(undefined4 *)((longlong)puVar8 + 0x6c) = uVar6;
      uVar4 = *(undefined4 *)((longlong)puVar7 + 0x74);
      uVar5 = *(undefined4 *)(puVar7 + 0xf);
      uVar6 = *(undefined4 *)((longlong)puVar7 + 0x7c);
      *(undefined4 *)(puVar8 + 0xe) = *(undefined4 *)(puVar7 + 0xe);
      *(undefined4 *)((longlong)puVar8 + 0x74) = uVar4;
      *(undefined4 *)(puVar8 + 0xf) = uVar5;
      *(undefined4 *)((longlong)puVar8 + 0x7c) = uVar6;
      lVar9 = lVar9 + -1;
      puVar7 = puVar2;
      puVar8 = puVar1;
    } while (lVar9 != 0);
    uVar10 = 0;
    *puVar1 = *puVar2;
    if (*(int *)((longlong)_Memory + 0x1c) != 0) {
      ppuVar11 = (uint **)(_Memory + 5);
      do {
        FUN_1800206e0(local_6d8,*ppuVar11,puVar3,0,0,local_6c8);
        if (0 < local_6d8[0]) {
          *param_4 = uVar10;
          goto LAB_180002ccb;
        }
        uVar10 = uVar10 + 1;
        ppuVar11 = ppuVar11 + 1;
      } while (uVar10 < *(uint *)((longlong)_Memory + 0x1c));
    }
    *param_4 = 0xffffffff;
LAB_180002ccb:
    free(_Memory);
  }
  FUN_18005f100(local_38 ^ (ulonglong)&stack0xfffffffffffff8e8);
  return;
}



void init_crc_FUN_180002d20(void)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint *puVar4;

  uVar3 = 0;
  puVar4 = &crc_table_DAT_1800e9de0;
  do {
    uVar2 = ((int)(uVar3 << 0x18) >> 0x1f & 0x4c11db7U) * 2;
    if ((int)(uVar3 * 0x2000000) < 0) {
      uVar2 = uVar2 ^ 0x4c11db7;
    }
    if ((int)(uVar2 ^ uVar3 * 0x4000000) < 0) {
      uVar2 = uVar2 * 2 ^ 0x4c11db7;
    }
    else {
      uVar2 = uVar2 * 2;
    }
    if ((int)(uVar2 ^ uVar3 * 0x8000000) < 0) {
      uVar2 = uVar2 * 2 ^ 0x4c11db7;
    }
    else {
      uVar2 = uVar2 * 2;
    }
    if ((int)(uVar2 ^ uVar3 * 0x10000000) < 0) {
      uVar2 = uVar2 * 2 ^ 0x4c11db7;
    }
    else {
      uVar2 = uVar2 * 2;
    }
    if ((int)(uVar2 ^ uVar3 * 0x20000000) < 0) {
      uVar2 = uVar2 * 2 ^ 0x4c11db7;
    }
    else {
      uVar2 = uVar2 * 2;
    }
    uVar1 = uVar2 * 2;
    if ((int)(uVar2 ^ uVar3 * 0x40000000) < 0) {
      uVar1 = uVar1 ^ 0x4c11db7;
    }
    if ((int)(uVar3 << 0x1f ^ uVar1) < 0) {
      uVar1 = uVar1 * 2 ^ 0x4c11db7;
    }
    else {
      uVar1 = uVar1 * 2;
    }
    *puVar4 = uVar1;
    uVar3 = uVar3 + 1;
    puVar4 = puVar4 + 1;
  } while (uVar3 < 0x100);
  return;
}



void calc_crc_FUN_180002de0(byte *buffer,short len)

{
  byte bVar1;

  if (len != 0) {
    do {
      bVar1 = *buffer;
      buffer = buffer + 1;
      crc_DAT_1800b0550 =
           *(uint *)((longlong)&crc_table_DAT_1800e9de0 +
                    (ulonglong)(byte)((byte)(crc_DAT_1800b0550 >> 0x18) ^ bVar1) * 4) ^
           crc_DAT_1800b0550 << 8;
      len = len + -1;
    } while (len != 0);
  }
  return;
}



void FUN_180002e50(ushort *buffer,short len)

{
  ushort uVar1;
  uint uVar2;

  if (len != 0) {
    do {
      uVar1 = *buffer;
      buffer = buffer + 1;
      uVar2 = *(uint *)((longlong)&crc_table_DAT_1800e9de0 +
                       ((ulonglong)(crc_DAT_1800b0550 >> 0x18) ^ (ulonglong)(uVar1 >> 8)) * 4) ^
              crc_DAT_1800b0550 << 8;
      crc_DAT_1800b0550 =
           *(uint *)((longlong)&crc_table_DAT_1800e9de0 +
                    ((ulonglong)(uVar2 >> 0x18) ^ (ulonglong)(byte)uVar1) * 4) ^ uVar2 << 8;
      len = len + -1;
    } while (len != 0);
  }
  return;
}



ulonglong FUN_1800030d0(undefined8 param_1,longlong param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  longlong lVar4;

  uVar3 = 0xffffffff;
  if (0 < param_3) {
    lVar4 = 0;
    do {
      uVar1 = *(byte *)(lVar4 + param_2) ^ uVar3;
      uVar2 = uVar1 & 0xff;
      if ((uVar1 & 1) == 0) {
        uVar2 = uVar2 >> 1;
      }
      else {
        uVar2 = uVar2 >> 1 ^ 0xedb88320;
      }
      if ((uVar2 & 1) == 0) {
        uVar2 = uVar2 >> 1;
      }
      else {
        uVar2 = uVar2 >> 1 ^ 0xedb88320;
      }
      if ((uVar2 & 1) == 0) {
        uVar2 = uVar2 >> 1;
      }
      else {
        uVar2 = uVar2 >> 1 ^ 0xedb88320;
      }
      if ((uVar2 & 1) == 0) {
        uVar2 = uVar2 >> 1;
      }
      else {
        uVar2 = uVar2 >> 1 ^ 0xedb88320;
      }
      if ((uVar2 & 1) == 0) {
        uVar2 = uVar2 >> 1;
      }
      else {
        uVar2 = uVar2 >> 1 ^ 0xedb88320;
      }
      if ((uVar2 & 1) == 0) {
        uVar2 = uVar2 >> 1;
      }
      else {
        uVar2 = uVar2 >> 1 ^ 0xedb88320;
      }
      if ((uVar2 & 1) == 0) {
        uVar2 = uVar2 >> 1;
      }
      else {
        uVar2 = uVar2 >> 1 ^ 0xedb88320;
      }
      if ((uVar2 & 1) == 0) {
        uVar2 = uVar2 >> 1;
      }
      else {
        uVar2 = uVar2 >> 1 ^ 0xedb88320;
      }
      lVar4 = lVar4 + 1;
      uVar3 = uVar3 >> 8 ^ uVar2;
    } while (lVar4 < param_3);
  }
  return (ulonglong)uVar3;
}



ulonglong FUN_1800031d0(longlong param_1,uint param_2)

{
  byte *pbVar1;
  uint uVar2;
  ulonglong uVar3;
  ushort uVar4;
  uint uVar5;
  ushort uVar6;
  ushort uVar8;
  uint uVar7;

  uVar6 = 0;
  uVar8 = 0;
  uVar4 = 0;
  uVar5 = 0;
  uVar2 = 0;
  uVar7 = uVar2;
  if (1 < param_2) {
    uVar2 = (param_2 - 2 >> 1) + 1;
    uVar3 = (ulonglong)uVar2;
    uVar2 = uVar2 * 2;
    pbVar1 = (byte *)(param_1 + 1);
    do {
      uVar6 = uVar6 + pbVar1[-1];
      uVar7 = (uint)uVar6;
      uVar4 = uVar4 + *pbVar1;
      uVar5 = (uint)uVar4;
      uVar3 = uVar3 - 1;
      pbVar1 = pbVar1 + 2;
    } while (uVar3 != 0);
  }
  if (uVar2 < param_2) {
    uVar8 = (ushort)*(byte *)((ulonglong)uVar2 + param_1);
  }
  return (ulonglong)(uVar7 + uVar5 & 0xffff0000 | (uint)(ushort)((short)(uVar7 + uVar5) + uVar8));
}



void FUN_180003250(void)

{
  FUN_1800545f0();
  return;
}



void FUN_1800032a0(void)

{
  FUN_1800545f0();
  FUN_1800545f0();
  FUN_1800545f0();
  FUN_1800545f0();
  FUN_1800545f0();
  FUN_1800545f0();
  FUN_1800545f0();
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 ppp_param_init(uint param_1)

{
  longlong lVar1;

                    // 0x3320  14  ppp_param_init
  if (0xb < param_1) {
    FUN_1800545f0();
    return 0x81;
  }
  _DAT_1800b20a0 = 1;
  lVar1 = (longlong)(int)param_1 * 0x20;
  DAT_1800b20a4 = *(undefined4 *)(&DAT_18007c554 + lVar1);
  DAT_1800b20ac = *(undefined4 *)(&DAT_18007c558 + lVar1);
  DAT_1800b20a8 = *(undefined4 *)(&DAT_18007c55c + lVar1);
  DAT_1800d8548 = *(undefined4 *)(&DAT_18007c560 + lVar1);
  DAT_1800d8540 = *(undefined4 *)(&DAT_18007c564 + lVar1);
  DAT_1800d853c = *(undefined4 *)(&DAT_18007c568 + lVar1);
  DAT_1800d8538 = *(undefined4 *)(&DAT_18007c56c + lVar1);
  FUN_1800545f0();
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

ulonglong preprocessor_init(longlong param_1)

{
  ulonglong uVar1;
  ulonglong uVar2;
  uint uVar3;
  ulonglong uVar4;
  uint *local_res8;
  int local_res10;
  int local_res14;
  undefined4 in_stack_ffffffffffffffb0;
  undefined4 in_stack_ffffffffffffffb4;
  undefined4 in_stack_ffffffffffffffb8;
  undefined4 in_stack_ffffffffffffffbc;

                    // 0x33c0  23  preprocessor_init
  local_res8 = (uint *)0x0;
  uVar2 = 0xffffffff;
  FUN_1800545f0();
  if (param_1 == 0) {
    return 0x81;
  }
  if (_DAT_1800b20a0 != 1) {
    FUN_1800545f0();
    return 0x80;
  }
  uVar3 = (((DAT_1800d853c << 9 | DAT_1800d8540) << 0xb | DAT_1800d8538) << 2 | DAT_1800b20ac) * 2 |
          DAT_1800b20a8 | DAT_1800b20a4;
  FUN_1800545f0();
  FUN_1800545f0();
  uVar4 = (ulonglong)DAT_1800b20a8;
  FUN_1800545f0();
  FUN_1800545f0();
  uVar1 = (ulonglong)DAT_1800d853c;
  FUN_1800545f0();
  DAT_1800d8544 = 0;
  if (*(undefined **)(param_1 + 0x18) != (undefined *)0x0) {
    uVar3 = FUN_180027640(&local_res8,*(undefined **)(param_1 + 0x18),uVar1,uVar4,uVar3,
                          CONCAT44(in_stack_ffffffffffffffb4,in_stack_ffffffffffffffb0),
                          CONCAT44(in_stack_ffffffffffffffbc,in_stack_ffffffffffffffb8),&local_res14
                          ,&local_res10,(int *)0x0);
    uVar2 = (ulonglong)uVar3;
    if (local_res8 != (uint *)0x0) {
      free(local_res8);
    }
  }
  FUN_1800545f0();
  uVar1 = 0;
  if (DAT_1800d8544 != 1) {
    uVar1 = uVar2;
  }
  return uVar1;
}



undefined8 preprocessor_exit(void)

{
                    // 0x3580  21  preprocessor_exit
  FUN_1800545f0();
  DAT_1800d8544 = 0;
  memset(&DAT_1800b20b0,0,0x26488);
  return 0;
}



undefined8 preprocessor_get_CalibParam(undefined8 *param_1,undefined4 *param_2)

{
                    // 0x35c0  22  preprocessor_get_CalibParam
  FUN_1800545f0();
  if ((param_1 != (undefined8 *)0x0) && (param_2 != (undefined4 *)0x0)) {
    *param_1 = &DAT_1800b20b0;
    *param_2 = 0x26488;
    return 0;
  }
  return 0x80;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

ulonglong preprocessor(undefined8 *param_1,int *param_2,longlong *param_3,undefined *param_4)

{
  longlong lVar1;
  uint uVar2;
  uint uVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  uint *local_res8;
  undefined8 in_stack_ffffffffffffffb0;
  undefined8 in_stack_ffffffffffffffb8;

                    // 0x3620  20  preprocessor
  uVar4 = 0;
  local_res8 = (uint *)0x0;
  if ((param_1 == (undefined8 *)0x0) || (param_3 == (longlong *)0x0)) {
    FUN_1800545f0();
    return 0x81;
  }
  if (_DAT_1800b20a0 != 1) {
    FUN_1800545f0();
    return 0x80;
  }
  if (DAT_1800d8544 == 1) {
    uVar2 = FUN_180027640(&local_res8,(undefined *)*param_1,param_3,param_4,
                          (((DAT_1800d853c << 9 | DAT_1800d8540) << 0xb | DAT_1800d8538) << 2 |
                          DAT_1800b20ac) * 2 | DAT_1800b20a8 | DAT_1800b20a4,
                          in_stack_ffffffffffffffb0,in_stack_ffffffffffffffb8,(int *)(param_4 + 4),
                          (int *)param_4,param_2);
    FUN_1800545f0();
    *(undefined *)(param_3 + 5) = param_4[4];
    *(undefined *)((longlong)param_3 + 0x29) = *param_4;
    if (local_res8 != (uint *)0x0) {
      lVar1 = *(longlong *)(local_res8 + 6);
      uVar5 = uVar4;
      if (*(int *)((longlong)param_3 + 0x14) != 0) {
        do {
          uVar3 = (int)uVar4 + 1;
          uVar4 = (ulonglong)uVar3;
          *(undefined *)(uVar5 + *param_3) = *(undefined *)(uVar5 + lVar1);
          uVar5 = uVar5 + 1;
        } while (uVar3 < *(uint *)((longlong)param_3 + 0x14));
      }
      free(local_res8);
    }
    return (ulonglong)uVar2;
  }
  FUN_1800545f0();
  return 0x80;
}



undefined8 preprocess_get_calidata_len(void)

{
                    // 0x3790  15  preprocess_get_calidata_len
  return 0x184ac;
}



undefined8 preprocess_save_calidata(undefined4 *param_1,uint *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  ulonglong uVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  char *pcVar9;
  longlong lVar10;
  int iVar11;

                    // 0x37a0  18  preprocess_save_calidata
  if ((param_1 != (undefined4 *)0x0) && (0x184ab < *param_2)) {
    uVar6 = (ulonglong)(uint)(DAT_1800d8540 * DAT_1800d853c) * 2;
    memcpy_FUN_180061f90((undefined8 *)(param_1 + 2),(undefined8 *)&DAT_1800b20b4,uVar6);
    memcpy_FUN_180061f90((undefined8 *)(param_1 + 0x264a),(undefined8 *)&DAT_1800bb9d4,uVar6);
    param_1[0x6122] = DAT_1800b20b0;
    lVar10 = 0x10;
    *(undefined8 *)(param_1 + 0x6123) = 0;
    *(undefined8 *)(param_1 + 0x6125) = 0;
    *(undefined8 *)(param_1 + 0x6127) = 0;
    *(undefined8 *)(param_1 + 0x6129) = 0;
    param_1[0x6123] = 0x70657250;
    param_1[0x6124] = 0x65636f72;
    param_1[0x6125] = 0x765f7373;
    param_1[0x6126] = 0x302e315f;
    param_1[0x6127] = 0x31302e31;
    puVar4 = param_1 + 0x4c92;
    puVar7 = &DAT_1800dcf90;
    do {
      uVar1 = puVar7[1];
      uVar2 = puVar7[2];
      uVar3 = puVar7[3];
      *puVar4 = *puVar7;
      puVar4[1] = uVar1;
      puVar4[2] = uVar2;
      puVar4[3] = uVar3;
      uVar1 = puVar7[5];
      uVar2 = puVar7[6];
      uVar3 = puVar7[7];
      puVar4[4] = puVar7[4];
      puVar4[5] = uVar1;
      puVar4[6] = uVar2;
      puVar4[7] = uVar3;
      uVar1 = puVar7[9];
      uVar2 = puVar7[10];
      uVar3 = puVar7[0xb];
      puVar4[8] = puVar7[8];
      puVar4[9] = uVar1;
      puVar4[10] = uVar2;
      puVar4[0xb] = uVar3;
      uVar1 = puVar7[0xd];
      uVar2 = puVar7[0xe];
      uVar3 = puVar7[0xf];
      puVar4[0xc] = puVar7[0xc];
      puVar4[0xd] = uVar1;
      puVar4[0xe] = uVar2;
      puVar4[0xf] = uVar3;
      uVar1 = puVar7[0x11];
      uVar2 = puVar7[0x12];
      uVar3 = puVar7[0x13];
      puVar4[0x10] = puVar7[0x10];
      puVar4[0x11] = uVar1;
      puVar4[0x12] = uVar2;
      puVar4[0x13] = uVar3;
      uVar1 = puVar7[0x15];
      uVar2 = puVar7[0x16];
      uVar3 = puVar7[0x17];
      puVar4[0x14] = puVar7[0x14];
      puVar4[0x15] = uVar1;
      puVar4[0x16] = uVar2;
      puVar4[0x17] = uVar3;
      uVar1 = puVar7[0x19];
      uVar2 = puVar7[0x1a];
      uVar3 = puVar7[0x1b];
      puVar4[0x18] = puVar7[0x18];
      puVar4[0x19] = uVar1;
      puVar4[0x1a] = uVar2;
      puVar4[0x1b] = uVar3;
      uVar1 = puVar7[0x1d];
      uVar2 = puVar7[0x1e];
      uVar3 = puVar7[0x1f];
      puVar4[0x1c] = puVar7[0x1c];
      puVar4[0x1d] = uVar1;
      puVar4[0x1e] = uVar2;
      puVar4[0x1f] = uVar3;
      lVar10 = lVar10 + -1;
      puVar4 = puVar4 + 0x20;
      puVar7 = puVar7 + 0x20;
    } while (lVar10 != 0);
    lVar10 = 0x94;
    puVar4 = &DAT_1800d8550;
    puVar7 = param_1 + 0x4e92;
    do {
      puVar8 = puVar7;
      puVar5 = puVar4;
      uVar1 = puVar5[1];
      uVar2 = puVar5[2];
      uVar3 = puVar5[3];
      *puVar8 = *puVar5;
      puVar8[1] = uVar1;
      puVar8[2] = uVar2;
      puVar8[3] = uVar3;
      uVar1 = puVar5[5];
      uVar2 = puVar5[6];
      uVar3 = puVar5[7];
      puVar8[4] = puVar5[4];
      puVar8[5] = uVar1;
      puVar8[6] = uVar2;
      puVar8[7] = uVar3;
      uVar1 = puVar5[9];
      uVar2 = puVar5[10];
      uVar3 = puVar5[0xb];
      puVar8[8] = puVar5[8];
      puVar8[9] = uVar1;
      puVar8[10] = uVar2;
      puVar8[0xb] = uVar3;
      uVar1 = puVar5[0xd];
      uVar2 = puVar5[0xe];
      uVar3 = puVar5[0xf];
      puVar8[0xc] = puVar5[0xc];
      puVar8[0xd] = uVar1;
      puVar8[0xe] = uVar2;
      puVar8[0xf] = uVar3;
      uVar1 = puVar5[0x11];
      uVar2 = puVar5[0x12];
      uVar3 = puVar5[0x13];
      puVar8[0x10] = puVar5[0x10];
      puVar8[0x11] = uVar1;
      puVar8[0x12] = uVar2;
      puVar8[0x13] = uVar3;
      uVar1 = puVar5[0x15];
      uVar2 = puVar5[0x16];
      uVar3 = puVar5[0x17];
      puVar8[0x14] = puVar5[0x14];
      puVar8[0x15] = uVar1;
      puVar8[0x16] = uVar2;
      puVar8[0x17] = uVar3;
      uVar1 = puVar5[0x19];
      uVar2 = puVar5[0x1a];
      uVar3 = puVar5[0x1b];
      puVar8[0x18] = puVar5[0x18];
      puVar8[0x19] = uVar1;
      puVar8[0x1a] = uVar2;
      puVar8[0x1b] = uVar3;
      uVar1 = puVar5[0x1d];
      uVar2 = puVar5[0x1e];
      uVar3 = puVar5[0x1f];
      puVar8[0x1c] = puVar5[0x1c];
      puVar8[0x1d] = uVar1;
      puVar8[0x1e] = uVar2;
      puVar8[0x1f] = uVar3;
      lVar10 = lVar10 + -1;
      puVar4 = puVar5 + 0x20;
      puVar7 = puVar8 + 0x20;
    } while (lVar10 != 0);
    uVar1 = puVar5[0x21];
    uVar2 = puVar5[0x22];
    uVar3 = puVar5[0x23];
    puVar8[0x20] = puVar5[0x20];
    puVar8[0x21] = uVar1;
    puVar8[0x22] = uVar2;
    puVar8[0x23] = uVar3;
    uVar1 = puVar5[0x25];
    uVar2 = puVar5[0x26];
    uVar3 = puVar5[0x27];
    puVar8[0x24] = puVar5[0x24];
    puVar8[0x25] = uVar1;
    puVar8[0x26] = uVar2;
    puVar8[0x27] = uVar3;
    uVar1 = puVar5[0x29];
    uVar2 = puVar5[0x2a];
    uVar3 = puVar5[0x2b];
    puVar8[0x28] = puVar5[0x28];
    puVar8[0x29] = uVar1;
    puVar8[0x2a] = uVar2;
    puVar8[0x2b] = uVar3;
    uVar1 = puVar5[0x2d];
    uVar2 = puVar5[0x2e];
    uVar3 = puVar5[0x2f];
    puVar8[0x2c] = puVar5[0x2c];
    puVar8[0x2d] = uVar1;
    puVar8[0x2e] = uVar2;
    puVar8[0x2f] = uVar3;
    FUN_1800545f0();
    pcVar9 = "pCaliData->version: %s";
    FUN_1800545f0();
    iVar11 = DAT_1800d8540 * DAT_1800d853c * 2;
    uVar6 = FUN_1800030d0(pcVar9,(longlong)(param_1 + 2),iVar11);
    *param_1 = (int)uVar6;
    uVar6 = FUN_1800030d0(pcVar9,(longlong)(param_1 + 0x264a),iVar11);
    param_1[1] = (int)uVar6;
    *param_2 = 0x184ac;
    return 0;
  }
  return 0x81;
}



undefined8 preprocess_load_calidata(int *param_1,uint param_2)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  ulonglong uVar6;
  int *piVar7;
  int *piVar8;
  int *piVar9;
  int *piVar10;
  uint uVar11;
  longlong lVar12;
  uint uVar13;
  int iVar14;

                    // 0x39d0  17  preprocess_load_calidata
  if ((param_1 == (int *)0x0) || (param_2 < 0x184ac)) {
    FUN_1800545f0();
    return 0x81;
  }
  if (((*(longlong *)(param_1 + 0x6123) == 0x65636f7270657250) &&
      (*(longlong *)(param_1 + 0x6125) == 0x302e315f765f7373)) && (param_1[0x6127] == 0x31302e31)) {
    iVar14 = DAT_1800d8540 * DAT_1800d853c * 2;
    piVar7 = param_1;
    uVar6 = FUN_1800030d0(param_1,(longlong)(param_1 + 2),iVar14);
    if ((*param_1 == (int)uVar6) &&
       (uVar6 = FUN_1800030d0(piVar7,(longlong)(param_1 + 0x264a),iVar14), param_1[1] == (int)uVar6)
       ) {
      FUN_1800545f0();
      uVar5 = DAT_1800d8540;
      uVar4 = DAT_1800d853c;
      uVar13 = 0;
      if (DAT_1800d8540 != 0) {
        do {
          uVar11 = 0;
          if (uVar4 != 0) {
            do {
              uVar1 = uVar4 * uVar13 + uVar11;
              uVar11 = uVar11 + 1;
              uVar6 = (ulonglong)uVar1;
              *(undefined2 *)(&DAT_1800b20b4 + uVar6 * 2) =
                   *(undefined2 *)((longlong)param_1 + (ulonglong)uVar1 * 2 + 8);
              *(undefined2 *)((longlong)&DAT_1800bb9d4 + uVar6 * 2) =
                   *(undefined2 *)((longlong)param_1 + uVar6 * 2 + 0x9928);
            } while (uVar11 < uVar4);
          }
          uVar13 = uVar13 + 1;
        } while (uVar13 < uVar5);
      }
      lVar12 = 0x10;
      piVar7 = param_1 + 0x4c92;
      piVar9 = &DAT_1800dcf90;
      do {
        iVar14 = piVar7[1];
        iVar2 = piVar7[2];
        iVar3 = piVar7[3];
        *piVar9 = *piVar7;
        piVar9[1] = iVar14;
        piVar9[2] = iVar2;
        piVar9[3] = iVar3;
        iVar14 = piVar7[5];
        iVar2 = piVar7[6];
        iVar3 = piVar7[7];
        piVar9[4] = piVar7[4];
        piVar9[5] = iVar14;
        piVar9[6] = iVar2;
        piVar9[7] = iVar3;
        iVar14 = piVar7[9];
        iVar2 = piVar7[10];
        iVar3 = piVar7[0xb];
        piVar9[8] = piVar7[8];
        piVar9[9] = iVar14;
        piVar9[10] = iVar2;
        piVar9[0xb] = iVar3;
        iVar14 = piVar7[0xd];
        iVar2 = piVar7[0xe];
        iVar3 = piVar7[0xf];
        piVar9[0xc] = piVar7[0xc];
        piVar9[0xd] = iVar14;
        piVar9[0xe] = iVar2;
        piVar9[0xf] = iVar3;
        iVar14 = piVar7[0x11];
        iVar2 = piVar7[0x12];
        iVar3 = piVar7[0x13];
        piVar9[0x10] = piVar7[0x10];
        piVar9[0x11] = iVar14;
        piVar9[0x12] = iVar2;
        piVar9[0x13] = iVar3;
        iVar14 = piVar7[0x15];
        iVar2 = piVar7[0x16];
        iVar3 = piVar7[0x17];
        piVar9[0x14] = piVar7[0x14];
        piVar9[0x15] = iVar14;
        piVar9[0x16] = iVar2;
        piVar9[0x17] = iVar3;
        iVar14 = piVar7[0x19];
        iVar2 = piVar7[0x1a];
        iVar3 = piVar7[0x1b];
        piVar9[0x18] = piVar7[0x18];
        piVar9[0x19] = iVar14;
        piVar9[0x1a] = iVar2;
        piVar9[0x1b] = iVar3;
        iVar14 = piVar7[0x1d];
        iVar2 = piVar7[0x1e];
        iVar3 = piVar7[0x1f];
        piVar9[0x1c] = piVar7[0x1c];
        piVar9[0x1d] = iVar14;
        piVar9[0x1e] = iVar2;
        piVar9[0x1f] = iVar3;
        lVar12 = lVar12 + -1;
        piVar7 = piVar7 + 0x20;
        piVar9 = piVar9 + 0x20;
      } while (lVar12 != 0);
      lVar12 = 0x94;
      piVar7 = &DAT_1800d8550;
      piVar9 = param_1 + 0x4e92;
      do {
        piVar10 = piVar9;
        piVar8 = piVar7;
        iVar14 = piVar10[1];
        iVar2 = piVar10[2];
        iVar3 = piVar10[3];
        *piVar8 = *piVar10;
        piVar8[1] = iVar14;
        piVar8[2] = iVar2;
        piVar8[3] = iVar3;
        iVar14 = piVar10[5];
        iVar2 = piVar10[6];
        iVar3 = piVar10[7];
        piVar8[4] = piVar10[4];
        piVar8[5] = iVar14;
        piVar8[6] = iVar2;
        piVar8[7] = iVar3;
        iVar14 = piVar10[9];
        iVar2 = piVar10[10];
        iVar3 = piVar10[0xb];
        piVar8[8] = piVar10[8];
        piVar8[9] = iVar14;
        piVar8[10] = iVar2;
        piVar8[0xb] = iVar3;
        iVar14 = piVar10[0xd];
        iVar2 = piVar10[0xe];
        iVar3 = piVar10[0xf];
        piVar8[0xc] = piVar10[0xc];
        piVar8[0xd] = iVar14;
        piVar8[0xe] = iVar2;
        piVar8[0xf] = iVar3;
        iVar14 = piVar10[0x11];
        iVar2 = piVar10[0x12];
        iVar3 = piVar10[0x13];
        piVar8[0x10] = piVar10[0x10];
        piVar8[0x11] = iVar14;
        piVar8[0x12] = iVar2;
        piVar8[0x13] = iVar3;
        iVar14 = piVar10[0x15];
        iVar2 = piVar10[0x16];
        iVar3 = piVar10[0x17];
        piVar8[0x14] = piVar10[0x14];
        piVar8[0x15] = iVar14;
        piVar8[0x16] = iVar2;
        piVar8[0x17] = iVar3;
        iVar14 = piVar10[0x19];
        iVar2 = piVar10[0x1a];
        iVar3 = piVar10[0x1b];
        piVar8[0x18] = piVar10[0x18];
        piVar8[0x19] = iVar14;
        piVar8[0x1a] = iVar2;
        piVar8[0x1b] = iVar3;
        iVar14 = piVar10[0x1d];
        iVar2 = piVar10[0x1e];
        iVar3 = piVar10[0x1f];
        piVar8[0x1c] = piVar10[0x1c];
        piVar8[0x1d] = iVar14;
        piVar8[0x1e] = iVar2;
        piVar8[0x1f] = iVar3;
        lVar12 = lVar12 + -1;
        piVar7 = piVar8 + 0x20;
        piVar9 = piVar10 + 0x20;
      } while (lVar12 != 0);
      iVar14 = piVar10[0x21];
      iVar2 = piVar10[0x22];
      iVar3 = piVar10[0x23];
      piVar8[0x20] = piVar10[0x20];
      piVar8[0x21] = iVar14;
      piVar8[0x22] = iVar2;
      piVar8[0x23] = iVar3;
      iVar14 = piVar10[0x25];
      iVar2 = piVar10[0x26];
      iVar3 = piVar10[0x27];
      piVar8[0x24] = piVar10[0x24];
      piVar8[0x25] = iVar14;
      piVar8[0x26] = iVar2;
      piVar8[0x27] = iVar3;
      iVar14 = piVar10[0x29];
      iVar2 = piVar10[0x2a];
      iVar3 = piVar10[0x2b];
      piVar8[0x28] = piVar10[0x28];
      piVar8[0x29] = iVar14;
      piVar8[0x2a] = iVar2;
      piVar8[0x2b] = iVar3;
      iVar14 = piVar10[0x2d];
      iVar2 = piVar10[0x2e];
      iVar3 = piVar10[0x2f];
      piVar8[0x2c] = piVar10[0x2c];
      piVar8[0x2d] = iVar14;
      piVar8[0x2e] = iVar2;
      piVar8[0x2f] = iVar3;
      DAT_1800b20b0 = param_1[0x6122];
      return 0;
    }
    FUN_1800545f0();
    return 0x80;
  }
  FUN_1800545f0();
  return 0x80;
}



undefined8 preprocess_init_calidata(void)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  longlong lVar5;
  ulonglong uVar6;
  uint uVar7;
  undefined2 *puVar8;
  uint uVar9;
  ulonglong uVar10;
  uint uVar11;

                    // 0x3c30  16  preprocess_init_calidata
  FUN_1800545f0();
  uVar3 = DAT_1800d8540;
  uVar2 = DAT_1800d853c;
  uVar11 = 0;
  if (DAT_1800d8540 != 0) {
    do {
      uVar9 = 0;
      if (uVar2 != 0) {
        uVar4 = uVar9;
        if (7 < uVar2) {
          uVar7 = uVar2 * uVar11;
          lVar5 = (longlong)(int)((uVar2 - 1) + uVar7);
          if ((&DAT_1800b20b4 + lVar5 * 2 <
               (undefined *)((longlong)&DAT_1800bb9d4 + (longlong)(int)uVar7 * 2)) ||
             (uVar4 = 0,
             (undefined *)((longlong)&DAT_1800bb9d4 + lVar5 * 2) <
             &DAT_1800b20b4 + (longlong)(int)uVar7 * 2)) {
            uVar4 = uVar2 - (uVar2 & 7);
            do {
              uVar9 = uVar9 + 8;
            } while (uVar9 < uVar4);
            iVar1 = uVar4 + 7;
            uVar10 = (longlong)((int)(iVar1 + (iVar1 >> 0x1f & 7U)) >> 3) << 4;
            uVar6 = uVar10 >> 1;
            puVar8 = (undefined2 *)(&DAT_1800b20b4 + (ulonglong)uVar7 * 2);
            while (uVar6 != 0) {
              uVar6 = uVar6 - 1;
              *puVar8 = 0x2000;
              puVar8 = puVar8 + 1;
            }
            uVar10 = uVar10 >> 1;
            puVar8 = (undefined2 *)((longlong)&DAT_1800bb9d4 + (ulonglong)uVar7 * 2);
            while (uVar4 = uVar9, uVar10 != 0) {
              uVar10 = uVar10 - 1;
              *puVar8 = 0;
              puVar8 = puVar8 + 1;
            }
          }
        }
        if (uVar4 < uVar2) {
          do {
            uVar6 = (ulonglong)(uVar2 * uVar11 + uVar4);
            uVar4 = uVar4 + 1;
            *(undefined2 *)(&DAT_1800b20b4 + uVar6 * 2) = 0x2000;
            *(undefined2 *)((longlong)&DAT_1800bb9d4 + uVar6 * 2) = 0;
          } while (uVar4 < uVar2);
        }
      }
      uVar11 = uVar11 + 1;
    } while (uVar11 < uVar3);
  }
  DAT_1800b20b0 = 0;
  return 0;
}



undefined8 preprocess_set_mode(undefined4 param_1)

{
                    // 0x3da0  19  preprocess_set_mode
  DAT_1800d8544 = param_1;
  return 0;
}



undefined8 FUN_180003f90(uint **param_1,uint param_2,ulonglong param_3)

{
  undefined4 *puVar1;
  char cVar2;
  uint *puVar3;
  int iVar4;
  uint *puVar5;
  undefined8 *puVar6;
  int *piVar7;
  void *pvVar8;
  undefined8 *puVar9;
  int iVar10;
  longlong lVar11;
  longlong lVar12;
  ulonglong uVar13;
  uint uVar14;
  longlong lVar15;
  char *pcVar16;
  uint uVar17;
  longlong *plVar18;
  int iVar19;
  uint uVar20;
  uint uVar21;
  uint uVar22;
  uint uVar23;
  int iVar24;
  int iVar25;
  int iVar26;
  uint local_res18;

  uVar13 = (param_3 & 0xffffffff) >> 0x17;
  uVar17 = (int)param_3 >> 3 & 0x3f;
  uVar20 = (int)param_3 >> 0xe & 0x1ff;
  puVar5 = (uint *)malloc(0x8e08);
  *param_1 = puVar5;
  uVar23 = 0;
  if (uVar17 != 0x14) {
    uVar23 = uVar17;
  }
  if (puVar5 == (uint *)0x0) {
    return 0x80000004;
  }
  uVar14 = 0x32;
  local_res18 = 0xa0;
  uVar21 = 0;
  uVar22 = 0;
  switch(uVar17) {
  default:
    local_res18 = 0x96;
    uVar14 = 0x28;
    uVar21 = 1;
    uVar22 = 1;
    if ((int)uVar13 == 0x6c) {
      uVar13 = 0x68;
    }
    break;
  case 1:
  case 5:
  case 8:
  case 0xb:
  case 0xc:
  case 0xd:
  case 0xe:
  case 0xf:
  case 0x10:
  case 0x11:
  case 0x12:
  case 0x13:
  case 0x14:
  case 0x15:
  case 0x16:
  case 0x17:
  case 0x18:
  case 0x19:
  case 0x1a:
  case 0x1b:
  case 0x1c:
  case 0x1d:
  case 0x1e:
  case 0x1f:
  case 0x20:
  case 0x21:
  case 0x22:
  case 0x23:
  case 0x24:
  case 0x25:
  case 0x26:
  case 0x27:
  case 0x28:
  case 0x29:
  case 0x2a:
  case 0x2b:
  case 0x2c:
  case 0x2d:
  case 0x2e:
  case 0x2f:
  case 0x30:
  case 0x31:
  case 0x32:
  case 0x33:
  case 0x34:
  case 0x35:
  case 0x36:
  case 0x37:
  case 0x38:
  case 0x39:
  case 0x3a:
  case 0x3b:
  case 0x3c:
  case 0x3d:
    break;
  case 2:
    uVar14 = 0x1e;
    local_res18 = 0x96;
    goto LAB_1800040c5;
  case 3:
    uVar14 = 0xf;
    local_res18 = 0x96;
    goto LAB_1800040c5;
  case 4:
    uVar14 = 0x28;
    local_res18 = 0x96;
    uVar21 = 0;
    uVar22 = 0;
    break;
  case 6:
  case 7:
  case 0x3e:
    uVar14 = 0x28;
    local_res18 = 0x96;
    goto LAB_1800040c5;
  case 9:
    uVar14 = 0x2d;
    local_res18 = 0x96;
    uVar21 = 0;
    uVar22 = 1;
    break;
  case 10:
    local_res18 = 0x78;
    uVar21 = 0;
    uVar22 = 1;
    break;
  case 0x3f:
    local_res18 = 0x8c;
    uVar14 = 0x32;
    if ((int)uVar13 == 0x76) {
      uVar13 = 0x78;
    }
LAB_1800040c5:
    uVar21 = 1;
    uVar22 = 1;
  }
  *puVar5 = uVar23;
  if (param_2 < uVar14) {
    uVar14 = param_2;
  }
  (*param_1)[1] = (uint)uVar13;
  (*param_1)[2] = uVar20;
  (*param_1)[3] = uVar21;
  (*param_1)[4] = uVar22;
  (*param_1)[5] = local_res18;
  (*param_1)[6] = local_res18;
  (*param_1)[7] = 0;
  (*param_1)[8] = uVar14;
  (*param_1)[9] = 0;
  puVar3 = *param_1;
  plVar18 = (longlong *)(puVar3 + 10);
  if (puVar3[3] != 0) {
    uVar13 = (ulonglong)((uint)uVar13 >> 1);
    uVar20 = uVar20 >> 1;
  }
  iVar19 = (int)uVar13;
  iVar26 = 0;
  iVar10 = (int)(uVar13 >> 3);
  iVar24 = iVar10 + 1;
  if (iVar19 == iVar10 * 8) {
    iVar24 = iVar10;
  }
  if (0 < (int)puVar3[8]) {
    uVar17 = uVar20 * iVar19;
    iVar4 = (int)uVar17 >> 3;
    iVar10 = iVar4 + 1;
    if (uVar17 <= (uint)(iVar4 * 8)) {
      iVar10 = iVar4;
    }
    do {
      puVar6 = (undefined8 *)malloc(0x158);
      *plVar18 = (longlong)puVar6;
      if (puVar6 != (undefined8 *)0x0) {
        lVar11 = 5;
        do {
          puVar9 = puVar6;
          *puVar9 = 0;
          puVar9[1] = 0;
          puVar9[2] = 0;
          puVar9[3] = 0;
          puVar9[4] = 0;
          puVar9[5] = 0;
          puVar9[6] = 0;
          puVar9[7] = 0;
          lVar11 = lVar11 + -1;
          puVar6 = puVar9 + 8;
        } while (lVar11 != 0);
        puVar9[8] = 0;
        puVar9[9] = 0;
        puVar9[10] = 0;
      }
      piVar7 = (int *)malloc((longlong)iVar10 + 0x20);
      if (piVar7 != (int *)0x0) {
        piVar7[3] = iVar10;
        *piVar7 = iVar19;
        piVar7[1] = uVar20;
        piVar7[4] = 8;
        piVar7[2] = -1;
        *(int **)(piVar7 + 6) = piVar7 + 8;
      }
      *(int **)(*plVar18 + 8) = piVar7;
      iVar25 = iVar4 + 1;
      if (uVar17 <= (uint)(iVar4 * 8)) {
        iVar25 = iVar4;
      }
      piVar7 = (int *)malloc((longlong)iVar25 + 0x20);
      if (piVar7 != (int *)0x0) {
        piVar7[3] = iVar25;
        *piVar7 = iVar19;
        piVar7[1] = uVar20;
        piVar7[4] = 8;
        piVar7[2] = -1;
        *(int **)(piVar7 + 6) = piVar7 + 8;
      }
      *(int **)(*plVar18 + 0x10) = piVar7;
      if ((ulonglong)uVar23 - 9 < 2) {
        *(undefined8 *)(*plVar18 + 0x18) = 0;
      }
      else {
        piVar7 = (int *)malloc((longlong)iVar25 + 0x20);
        if (piVar7 == (int *)0x0) {
          *(undefined8 *)(*plVar18 + 0x18) = 0;
        }
        else {
          piVar7[3] = iVar25;
          *piVar7 = iVar19;
          piVar7[1] = uVar20;
          piVar7[4] = 8;
          piVar7[2] = -1;
          *(int **)(piVar7 + 6) = piVar7 + 8;
          *(int **)(*plVar18 + 0x18) = piVar7;
        }
      }
      pvVar8 = malloc((ulonglong)local_res18 * 0x38);
      *(void **)(*plVar18 + 0xf8) = pvVar8;
      piVar7 = (int *)malloc((ulonglong)(iVar24 * uVar20) + 0x20);
      if (piVar7 != (int *)0x0) {
        piVar7[3] = iVar24 * uVar20;
        *(int **)(piVar7 + 6) = piVar7 + 8;
        *piVar7 = iVar24;
        piVar7[1] = uVar20;
        piVar7[4] = 1;
        piVar7[2] = iVar24;
      }
      iVar26 = iVar26 + 1;
      *(int **)(*plVar18 + 0x130) = piVar7;
      *(undefined8 *)(*plVar18 + 0x20) = 0;
      lVar11 = *plVar18;
      plVar18 = plVar18 + 1;
      *(undefined8 *)(lVar11 + 0x140) = 0;
    } while (iVar26 < (int)(*param_1)[8]);
  }
  puVar3 = *param_1;
  plVar18 = (longlong *)(puVar3 + 0x2344);
  if ((undefined8 *)(puVar3 + 0x236c) != (undefined8 *)0x0) {
    *(undefined8 *)(puVar3 + 0x236c) = 0xffffffffffffffff;
    *(undefined8 *)(puVar3 + 0x236e) = 0xffffffffffffffff;
    *(undefined8 *)(puVar3 + 0x2370) = 0xffffffffffffffff;
    *(undefined8 *)(puVar3 + 0x2372) = 0xffffffffffffffff;
    *(undefined8 *)(puVar3 + 0x2374) = 0xffffffffffffffff;
    *(undefined8 *)(puVar3 + 0x2376) = 0xffffffffffffffff;
    *(undefined8 *)(puVar3 + 0x2378) = 0xffffffffffffffff;
    *(undefined8 *)(puVar3 + 0x237a) = 0xffffffffffffffff;
    *(undefined8 *)(puVar3 + 0x237c) = 0xffffffffffffffff;
    *(undefined8 *)(puVar3 + 0x237e) = 0xffffffffffffffff;
  }
  if ((undefined8 *)(*param_1 + 0x2380) != (undefined8 *)0x0) {
    *(undefined8 *)(*param_1 + 0x2380) = 0;
  }
  lVar11 = 0x14;
  uVar17 = uVar20 * iVar19;
  do {
    puVar6 = (undefined8 *)malloc(0x158);
    *plVar18 = (longlong)puVar6;
    if (puVar6 != (undefined8 *)0x0) {
      lVar12 = 5;
      do {
        puVar9 = puVar6;
        *puVar9 = 0;
        puVar9[1] = 0;
        puVar9[2] = 0;
        puVar9[3] = 0;
        puVar9[4] = 0;
        puVar9[5] = 0;
        puVar9[6] = 0;
        puVar9[7] = 0;
        lVar12 = lVar12 + -1;
        puVar6 = puVar9 + 8;
      } while (lVar12 != 0);
      puVar9[8] = 0;
      puVar9[9] = 0;
      puVar9[10] = 0;
    }
    uVar21 = (uVar17 >> 3) + 1;
    if (uVar17 <= (uVar17 & 0xfffffff8)) {
      uVar21 = uVar17 >> 3;
    }
    uVar13 = (ulonglong)uVar21;
    piVar7 = (int *)malloc(uVar13 + 0x20);
    if (piVar7 != (int *)0x0) {
      piVar7[3] = uVar21;
      *piVar7 = iVar19;
      piVar7[1] = uVar20;
      piVar7[4] = 8;
      piVar7[2] = -1;
      *(int **)(piVar7 + 6) = piVar7 + 8;
    }
    *(int **)(*plVar18 + 8) = piVar7;
    piVar7 = (int *)malloc(uVar13 + 0x20);
    if (piVar7 != (int *)0x0) {
      piVar7[3] = uVar21;
      *piVar7 = iVar19;
      piVar7[1] = uVar20;
      piVar7[4] = 8;
      piVar7[2] = -1;
      *(int **)(piVar7 + 6) = piVar7 + 8;
    }
    *(int **)(*plVar18 + 0x10) = piVar7;
    if ((ulonglong)uVar23 - 9 < 2) {
      *(undefined8 *)(*plVar18 + 0x18) = 0;
    }
    else {
      piVar7 = (int *)malloc(uVar13 + 0x20);
      if (piVar7 == (int *)0x0) {
        *(undefined8 *)(*plVar18 + 0x18) = 0;
      }
      else {
        piVar7[3] = uVar21;
        *piVar7 = iVar19;
        piVar7[1] = uVar20;
        piVar7[4] = 8;
        piVar7[2] = -1;
        *(int **)(piVar7 + 6) = piVar7 + 8;
        *(int **)(*plVar18 + 0x18) = piVar7;
      }
    }
    pvVar8 = malloc((ulonglong)local_res18 * 0x38);
    *(void **)(*plVar18 + 0xf8) = pvVar8;
    piVar7 = (int *)malloc((ulonglong)(iVar24 * uVar20) + 0x20);
    if (piVar7 == (int *)0x0) {
      piVar7 = (int *)0x0;
    }
    else {
      piVar7[3] = iVar24 * uVar20;
      *piVar7 = iVar24;
      piVar7[1] = uVar20;
      piVar7[4] = 1;
      piVar7[2] = iVar24;
      *(int **)(piVar7 + 6) = piVar7 + 8;
    }
    lVar15 = 0;
    *(int **)(*plVar18 + 0x130) = piVar7;
    *(undefined8 *)(*plVar18 + 0x20) = 0;
    lVar12 = *plVar18;
    plVar18 = plVar18 + 1;
    *(undefined8 *)(lVar12 + 0x140) = 0;
    lVar11 = lVar11 + -1;
  } while (lVar11 != 0);
  do {
    puVar3 = *param_1;
    puVar1 = (undefined4 *)((longlong)puVar3 + lVar15 + 0x1b8);
    *puVar1 = 0xffffffff;
    puVar1[1] = 0x100;
    puVar1[2] = 0;
    puVar1[3] = 0;
    *(undefined8 *)((longlong)puVar3 + lVar15 + 0x1c8) = 0x10000000000;
    *(undefined4 *)((longlong)puVar3 + lVar15 + 0x1d0) = 0;
    puVar3 = *param_1;
    puVar1 = (undefined4 *)((longlong)puVar3 + lVar15 + 0x1d4);
    *puVar1 = 0xffffffff;
    puVar1[1] = 0x100;
    puVar1[2] = 0;
    puVar1[3] = 0;
    *(undefined8 *)((longlong)puVar3 + lVar15 + 0x1e4) = 0x10000000000;
    *(undefined4 *)((longlong)puVar3 + lVar15 + 0x1ec) = 0;
    lVar15 = lVar15 + 0x38;
  } while (lVar15 < 0x8618);
  *(undefined8 *)(puVar5 + 0x21f4) = 0;
  *(undefined8 *)(puVar5 + 0x21f6) = 0xffffffffffffffff;
  puVar5[0x21f8] = 0xffffffff;
  puVar5[0x21f9] = 0;
  if ((undefined8 *)(*param_1 + 0x21fa) != (undefined8 *)0x0) {
    lVar11 = 3;
    puVar6 = (undefined8 *)(*param_1 + 0x21fa);
    do {
      *puVar6 = 0xffffffffffffffff;
      puVar6[1] = 0xffffffffffffffff;
      puVar6[2] = 0xffffffffffffffff;
      puVar9 = puVar6 + 8;
      puVar6[3] = 0xffffffffffffffff;
      puVar6[4] = 0xffffffffffffffff;
      puVar6[5] = 0xffffffffffffffff;
      puVar6[6] = 0xffffffffffffffff;
      puVar6[7] = 0xffffffffffffffff;
      lVar11 = lVar11 + -1;
      puVar6 = puVar9;
    } while (lVar11 != 0);
    *puVar9 = 0xffffffffffffffff;
  }
  pcVar16 = "Milan_v_3.00.11.02";
  (*param_1)[0x222c] = 0xffffffff;
  puVar5 = *param_1 + 0x222d;
  if ((puVar5 != (uint *)0x0) && (puVar5 != (uint *)"Milan_v_3.00.11.02")) {
    do {
      cVar2 = *pcVar16;
      pcVar16 = pcVar16 + 1;
      *(char *)puVar5 = cVar2;
      puVar5 = (uint *)((longlong)puVar5 + 1);
    } while (cVar2 != '\0');
  }
  pcVar16 = "";
  puVar5 = *param_1 + 0x223d;
  if ((puVar5 != (uint *)0x0) && (puVar5 != (uint *)&DAT_1800a4143)) {
    do {
      cVar2 = *pcVar16;
      pcVar16 = pcVar16 + 1;
      *(char *)puVar5 = cVar2;
      puVar5 = (uint *)((longlong)puVar5 + 1);
    } while (cVar2 != '\0');
  }
  (*param_1)[0x233d] = 0;
  (*param_1)[0x233e] = 0;
  (*param_1)[0x233f] = 0;
  *(undefined8 *)(*param_1 + 0x2342) = 0;
  return 0;
}



undefined8 FUN_180004800(int *param_1)

{
  int iVar1;
  int iVar2;
  longlong lVar3;
  longlong *plVar4;
  int iVar5;
  int *piVar6;
  uint uVar7;
  ulonglong uVar8;

  if (param_1 == (int *)0x0) {
    return 0x80000002;
  }
  if (param_1[7] == 0) {
    return 0x80000003;
  }
  iVar5 = param_1[7] + -1;
  iVar1 = *(int *)(*(longlong *)(param_1 + (longlong)iVar5 * 2 + 10) + 0x104);
  uVar8 = (longlong)iVar1 & 0xffffffff;
  if (iVar1 < param_1[9]) {
    piVar6 = param_1 + (longlong)iVar1 * 7 + 0x6e;
    do {
      uVar7 = (int)uVar8 + 1;
      uVar8 = (ulonglong)uVar7;
      *piVar6 = -1;
      piVar6[1] = 0x100;
      piVar6[2] = 0;
      piVar6[3] = 0;
      *(undefined8 *)(piVar6 + 4) = 0x10000000000;
      piVar6[6] = 0;
      piVar6 = piVar6 + 7;
    } while ((int)uVar7 < param_1[9]);
  }
  iVar2 = param_1[7];
  param_1[9] = iVar1;
  param_1[7] = iVar2 + -1;
  if (iVar5 == param_1[0x21f6]) {
    param_1[0x21f9] = 0;
    iVar5 = 0;
    if (0 < iVar2 + -1) {
      plVar4 = (longlong *)(param_1 + 10);
      do {
        lVar3 = *plVar4;
        plVar4 = plVar4 + 1;
        iVar5 = iVar5 + 1;
        *(undefined4 *)(lVar3 + 0x100) = 0;
      } while (iVar5 < param_1[7]);
    }
  }
  if (1 < *param_1 - 9U) {
    FUN_180017490((longlong)param_1);
  }
  return 0;
}



undefined8 FUN_1800048e0(void **param_1)

{
  void **ppvVar1;
  int iVar2;
  void **ppvVar3;
  longlong lVar4;
  longlong lVar5;

  if (*param_1 != (void *)0x0) {
    iVar2 = 0;
    if (0 < *(int *)((longlong)*param_1 + 0x20)) {
      lVar5 = 0x28;
      do {
        ppvVar1 = (void **)((longlong)*param_1 + lVar5);
        if ((ppvVar1 != (void **)0x0) && (*ppvVar1 != (void *)0x0)) {
          ppvVar3 = (void **)((longlong)*ppvVar1 + 8);
          if ((*ppvVar3 != (void *)0x0) && ((ppvVar3 != (void **)0x0 && (*ppvVar3 != (void *)0x0))))
          {
            free(*ppvVar3);
            *ppvVar3 = (void *)0x0;
          }
          *(undefined8 *)((longlong)*ppvVar1 + 8) = 0;
          ppvVar3 = (void **)((longlong)*ppvVar1 + 0x10);
          if (((*ppvVar3 != (void *)0x0) && (ppvVar3 != (void **)0x0)) && (*ppvVar3 != (void *)0x0))
          {
            free(*ppvVar3);
            *ppvVar3 = (void *)0x0;
          }
          *(undefined8 *)((longlong)*ppvVar1 + 0x10) = 0;
          ppvVar3 = (void **)((longlong)*ppvVar1 + 0x18);
          if (((*ppvVar3 != (void *)0x0) && (ppvVar3 != (void **)0x0)) && (*ppvVar3 != (void *)0x0))
          {
            free(*ppvVar3);
            *ppvVar3 = (void *)0x0;
          }
          *(undefined8 *)((longlong)*ppvVar1 + 0x18) = 0;
          ppvVar3 = (void **)((longlong)*ppvVar1 + 0x20);
          if (((*ppvVar3 != (void *)0x0) && (ppvVar3 != (void **)0x0)) && (*ppvVar3 != (void *)0x0))
          {
            free(*ppvVar3);
            *ppvVar3 = (void *)0x0;
          }
          *(undefined8 *)((longlong)*ppvVar1 + 0x20) = 0;
          if (*(void **)((longlong)*ppvVar1 + 0xf8) != (void *)0x0) {
            free(*(void **)((longlong)*ppvVar1 + 0xf8));
          }
          *(undefined8 *)((longlong)*ppvVar1 + 0xf8) = 0;
          ppvVar3 = (void **)((longlong)*ppvVar1 + 0x130);
          if (((*ppvVar3 != (void *)0x0) && (ppvVar3 != (void **)0x0)) && (*ppvVar3 != (void *)0x0))
          {
            free(*ppvVar3);
            *ppvVar3 = (void *)0x0;
          }
          *(undefined8 *)((longlong)*ppvVar1 + 0x130) = 0;
          free(*ppvVar1);
          *ppvVar1 = (void *)0x0;
        }
        iVar2 = iVar2 + 1;
        lVar5 = lVar5 + 8;
      } while (iVar2 < *(int *)((longlong)*param_1 + 0x20));
    }
    lVar5 = 0x8d10;
    lVar4 = 0x14;
    do {
      FUN_180004ab0((void **)((longlong)*param_1 + lVar5));
      lVar5 = lVar5 + 8;
      lVar4 = lVar4 + -1;
    } while (lVar4 != 0);
    free(*param_1);
    *param_1 = (void *)0x0;
    return 0;
  }
  return 0x80000002;
}



undefined8 FUN_180004ab0(void **param_1)

{
  void **ppvVar1;

  if ((param_1 != (void **)0x0) && (*param_1 != (void *)0x0)) {
    ppvVar1 = (void **)((longlong)*param_1 + 8);
    if (((*ppvVar1 != (void *)0x0) && (ppvVar1 != (void **)0x0)) && (*ppvVar1 != (void *)0x0)) {
      free(*ppvVar1);
      *ppvVar1 = (void *)0x0;
    }
    *(undefined8 *)((longlong)*param_1 + 8) = 0;
    ppvVar1 = (void **)((longlong)*param_1 + 0x10);
    if (((*ppvVar1 != (void *)0x0) && (ppvVar1 != (void **)0x0)) && (*ppvVar1 != (void *)0x0)) {
      free(*ppvVar1);
      *ppvVar1 = (void *)0x0;
    }
    *(undefined8 *)((longlong)*param_1 + 0x10) = 0;
    ppvVar1 = (void **)((longlong)*param_1 + 0x18);
    if (((*ppvVar1 != (void *)0x0) && (ppvVar1 != (void **)0x0)) && (*ppvVar1 != (void *)0x0)) {
      free(*ppvVar1);
      *ppvVar1 = (void *)0x0;
    }
    *(undefined8 *)((longlong)*param_1 + 0x18) = 0;
    ppvVar1 = (void **)((longlong)*param_1 + 0x20);
    if (((*ppvVar1 != (void *)0x0) && (ppvVar1 != (void **)0x0)) && (*ppvVar1 != (void *)0x0)) {
      free(*ppvVar1);
      *ppvVar1 = (void *)0x0;
    }
    *(undefined8 *)((longlong)*param_1 + 0x20) = 0;
    if (*(void **)((longlong)*param_1 + 0xf8) != (void *)0x0) {
      free(*(void **)((longlong)*param_1 + 0xf8));
    }
    *(undefined8 *)((longlong)*param_1 + 0xf8) = 0;
    ppvVar1 = (void **)((longlong)*param_1 + 0x130);
    if (((*ppvVar1 != (void *)0x0) && (ppvVar1 != (void **)0x0)) && (*ppvVar1 != (void *)0x0)) {
      free(*ppvVar1);
      *ppvVar1 = (void *)0x0;
    }
    *(undefined8 *)((longlong)*param_1 + 0x130) = 0;
    free(*param_1);
    *param_1 = (void *)0x0;
    return 0;
  }
  return 0x80000002;
}



undefined8 FUN_180004c30(longlong param_1)

{
  longlong lVar1;
  longlong lVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  undefined4 *puVar6;
  longlong lVar7;
  longlong lVar8;
  longlong lVar9;
  int *piVar10;

  if (param_1 == 0) {
    return 0x80000002;
  }
  iVar3 = *(int *)(param_1 + 0x1c);
  if (iVar3 == 0) {
    return 0x80000003;
  }
  if (*(int *)(param_1 + 0x87e4) != 0) {
    lVar2 = param_1 + 0x1b8;
    iVar4 = *(int *)(param_1 + 0x87d8);
    lVar8 = (longlong)iVar4;
    lVar1 = param_1 + 0x28;
    if (0 < iVar4) {
      lVar9 = 0;
      piVar10 = (int *)((longlong)*(int *)(*(longlong *)(lVar1 + lVar8 * 8) + 0x104) * 0x1c + lVar2)
      ;
      do {
        if ((*piVar10 != -1) && (0 < lVar9)) {
          lVar7 = lVar9;
          puVar6 = (undefined4 *)
                   ((longlong)*(int *)(*(longlong *)(lVar1 + lVar9 * 8) + 0x104) * 0x1c + lVar2);
          do {
            *puVar6 = 0xffffffff;
            puVar6[1] = 0x100;
            puVar6[2] = 0;
            puVar6[3] = 0;
            *(undefined8 *)(puVar6 + 4) = 0x10000000000;
            puVar6[6] = 0;
            lVar7 = lVar7 + -1;
            puVar6 = puVar6 + 7;
          } while (lVar7 != 0);
        }
        lVar9 = lVar9 + 1;
        piVar10 = piVar10 + 7;
      } while (lVar9 < lVar8);
    }
    lVar9 = (longlong)(iVar4 + 1);
    while (lVar9 < iVar3) {
      iVar5 = *(int *)(*(longlong *)(lVar1 + lVar9 * 8) + 0x104);
      if ((*(int *)((longlong)(iVar5 + iVar4) * 0x1c + lVar2) != -1) && (0 < lVar9)) {
        lVar7 = 0;
        puVar6 = (undefined4 *)((longlong)iVar5 * 0x1c + lVar2);
        do {
          if (lVar7 != lVar8) {
            *puVar6 = 0xffffffff;
            puVar6[1] = 0x100;
            puVar6[2] = 0;
            puVar6[3] = 0;
            *(undefined8 *)(puVar6 + 4) = 0x10000000000;
            puVar6[6] = 0;
          }
          lVar7 = lVar7 + 1;
          puVar6 = puVar6 + 7;
        } while (lVar7 < lVar9);
      }
      lVar9 = lVar9 + 1;
    }
  }
  return 0;
}



void FUN_180004ea0(longlong param_1)

{
  byte *pbVar1;
  ulonglong *puVar2;
  undefined (*pauVar3) [16];
  longlong lVar4;
  longlong lVar5;
  ulonglong uVar6;
  ulonglong *puVar7;
  int iVar8;
  ulonglong uVar9;
  int iVar10;
  undefined4 local_48;
  undefined4 uStack68;
  undefined4 uStack64;
  undefined4 uStack60;
  undefined4 local_38;
  undefined4 uStack52;
  undefined4 uStack48;
  undefined4 uStack44;
  undefined4 local_28;
  undefined4 uStack36;
  undefined4 uStack32;
  undefined4 uStack28;
  ulonglong local_18;
  ulonglong local_10;

  local_10 = DAT_1800b04e8 ^ (ulonglong)&local_48;
  uVar6 = 0;
  iVar8 = 0;
  iVar10 = *(int *)(param_1 + 0xf0) + -1;
  if (0 < iVar10) {
    lVar4 = (longlong)iVar10;
    uVar9 = uVar6;
LAB_180004ef2:
    lVar5 = *(longlong *)(param_1 + 0xf8);
    pbVar1 = (byte *)(uVar6 * 0x38 + lVar5);
    do {
      if ((*pbVar1 & 3) != 0) break;
      uVar9 = (ulonglong)((int)uVar9 + 1);
      uVar6 = uVar6 + 1;
      pbVar1 = pbVar1 + 0x38;
    } while ((longlong)uVar6 < lVar4);
    iVar8 = (int)uVar9;
    if (iVar8 < iVar10) {
      pbVar1 = (byte *)(lVar4 * 0x38 + lVar5);
      do {
        if ((*pbVar1 & 3) != 1) break;
        iVar10 = iVar10 + -1;
        lVar4 = lVar4 + -1;
        pbVar1 = pbVar1 + -0x38;
      } while ((longlong)uVar6 < lVar4);
      if (iVar10 <= iVar8) goto LAB_180005014;
      puVar7 = (ulonglong *)((longlong)iVar8 * 0x38 + lVar5);
      if ((puVar7 != (ulonglong *)0x0) && ((puVar7 + 7 <= &local_48 || (&local_10 <= puVar7)))) {
        local_48 = *(undefined4 *)puVar7;
        uStack68 = *(undefined4 *)((longlong)puVar7 + 4);
        uStack64 = *(undefined4 *)(puVar7 + 1);
        uStack60 = *(undefined4 *)((longlong)puVar7 + 0xc);
        local_38 = *(undefined4 *)(puVar7 + 2);
        uStack52 = *(undefined4 *)((longlong)puVar7 + 0x14);
        uStack48 = *(undefined4 *)(puVar7 + 3);
        uStack44 = *(undefined4 *)((longlong)puVar7 + 0x1c);
        local_28 = *(undefined4 *)(puVar7 + 4);
        uStack36 = *(undefined4 *)((longlong)puVar7 + 0x24);
        uStack32 = *(undefined4 *)(puVar7 + 5);
        uStack28 = *(undefined4 *)((longlong)puVar7 + 0x2c);
        local_18 = puVar7[6];
      }
      puVar2 = (ulonglong *)((longlong)iVar10 * 0x38 + lVar5);
      if (((puVar7 != (ulonglong *)0x0) && (puVar2 != (ulonglong *)0x0)) &&
         ((puVar2 + 7 <= puVar7 || (puVar7 + 7 <= puVar2)))) {
        puVar7 = (ulonglong *)((longlong)puVar7 - (longlong)puVar2);
        lVar5 = 0x1c;
        do {
          *(undefined *)((longlong)puVar7 + (longlong)puVar2) = *(undefined *)puVar2;
          ((undefined *)((longlong)puVar7 + 1))[(longlong)puVar2] =
               *(undefined *)((longlong)puVar2 + 1);
          puVar2 = (ulonglong *)((longlong)puVar2 + 2);
          lVar5 = lVar5 + -1;
        } while (lVar5 != 0);
      }
      pauVar3 = (undefined (*) [16])(*(longlong *)(param_1 + 0xf8) + (longlong)iVar10 * 0x38);
      if ((pauVar3 != (undefined (*) [16])0x0) &&
         (((undefined (*) [16])&local_10 <= pauVar3 || (pauVar3[3] + 8 <= &local_48)))) {
        *pauVar3 = CONCAT412(uStack60,CONCAT48(uStack64,CONCAT44(uStack68,local_48)));
        pauVar3[1] = CONCAT412(uStack44,CONCAT48(uStack48,CONCAT44(uStack52,local_38)));
        pauVar3[2] = CONCAT412(uStack28,CONCAT48(uStack32,CONCAT44(uStack36,local_28)));
        *(ulonglong *)pauVar3[3] = local_18;
      }
      goto LAB_180004ef2;
    }
  }
LAB_180005014:
  if ((iVar8 == iVar10) &&
     ((*(byte *)((longlong)iVar8 * 0x38 + *(longlong *)(param_1 + 0xf8)) & 3) == 0)) {
    iVar8 = iVar8 + 1;
  }
  *(int *)(param_1 + 0x108) = iVar8;
  FUN_18005f100(local_10 ^ (ulonglong)&local_48);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180005050(longlong param_1,longlong param_2,int param_3,int param_4)

{
  int iVar1;
  undefined4 uVar2;
  undefined *puVar3;
  void *pvVar4;
  undefined8 *puVar5;
  undefined *puVar6;
  undefined2 *puVar7;
  undefined2 *puVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  undefined2 *puVar11;
  undefined4 *puVar12;
  longlong lVar13;
  uint uVar14;
  longlong lVar15;
  undefined2 *puVar16;
  undefined auStack1544 [32];
  undefined8 local_5e8;
  undefined8 uStack1504;
  undefined8 local_5d8;
  undefined8 local_5d0 [179];
  ulonglong local_38;

  local_38 = DAT_1800b04e8 ^ (ulonglong)auStack1544;
  if (*(longlong *)(param_2 + 0xf8) == 0) {
    pvVar4 = malloc((longlong)(param_3 * 0x38));
    *(void **)(param_2 + 0xf8) = pvVar4;
  }
  iVar1 = *(int *)(param_1 + 0xf0);
  uVar9 = 0;
  if (param_3 < iVar1) {
    puVar16 = *(undefined2 **)(param_2 + 0xf8);
    if (0 < iVar1) {
      puVar5 = &local_5d8;
      puVar12 = (undefined4 *)(*(longlong *)(param_1 + 0xf8) + 8);
      uVar10 = uVar9;
      do {
        uVar2 = *puVar12;
        puVar12 = puVar12 + 0xe;
        *(int *)((longlong)puVar5 + 4) = (int)uVar10;
        uVar14 = (int)uVar10 + 1;
        uVar10 = (ulonglong)uVar14;
        *(undefined4 *)puVar5 = uVar2;
        puVar5 = puVar5 + 1;
      } while ((int)uVar14 < iVar1);
    }
    if (1 < (longlong)iVar1) {
      lVar15 = 1;
      do {
        local_5e8 = (&local_5d8)[lVar15];
        lVar13 = lVar15;
        if (0 < lVar15) {
          local_5e8._4_4_ = (int)((ulonglong)local_5e8 >> 0x20);
          puVar5 = &uStack1504 + lVar15;
          do {
            if ((*(int *)puVar5 <= (int)local_5e8) &&
               ((*(int *)puVar5 != (int)local_5e8 ||
                (*(int *)((longlong)puVar5 + 4) == local_5e8._4_4_ ||
                 *(int *)((longlong)puVar5 + 4) < local_5e8._4_4_)))) break;
            lVar13 = lVar13 + -1;
            puVar5[1] = *puVar5;
            puVar5 = puVar5 + -1;
          } while (0 < lVar13);
        }
        lVar15 = lVar15 + 1;
        (&local_5d8)[lVar13] = local_5e8;
      } while (lVar15 < iVar1);
    }
    uVar10 = uVar9;
    if (0 < param_3) {
      do {
        puVar7 = (undefined2 *)
                 ((longlong)*(int *)((longlong)local_5d0 + uVar10 * 8 + -4) * 0x38 +
                 *(longlong *)(param_1 + 0xf8));
        puVar11 = puVar7 + 8;
        puVar16[1] = puVar7[1];
        puVar16[2] = puVar7[2];
        puVar16[3] = puVar7[3];
        *puVar16 = *puVar7;
        puVar8 = puVar16 + 8;
        *(undefined4 *)(puVar16 + 4) = *(undefined4 *)(puVar7 + 4);
        if (((puVar8 != (undefined2 *)0x0) && (puVar11 != (undefined2 *)0x0)) &&
           ((puVar7 + 0x14 <= puVar8 || (puVar16 + 0x14 <= puVar11)))) {
          puVar11 = (undefined2 *)((longlong)puVar11 - (longlong)puVar8);
          lVar15 = 0x18;
          do {
            *(undefined *)puVar8 = *(undefined *)((longlong)puVar11 + (longlong)puVar8);
            puVar8 = (undefined2 *)((longlong)puVar8 + 1);
            lVar15 = lVar15 + -1;
          } while (lVar15 != 0);
        }
        uVar10 = uVar10 + 1;
        puVar16 = puVar16 + 0x1c;
      } while ((longlong)uVar10 < (longlong)param_3);
    }
    *(int *)(param_2 + 0xf0) = param_3;
    FUN_180004ea0(param_2);
  }
  else {
    puVar6 = *(undefined **)(param_2 + 0xf8);
    *(int *)(param_2 + 0xf0) = iVar1;
    uVar14 = *(int *)(param_1 + 0xf0) * 0x38;
    uVar10 = (ulonglong)uVar14;
    puVar3 = *(undefined **)(param_1 + 0xf8);
    if (((((puVar6 != (undefined *)0x0) && (puVar3 != (undefined *)0x0)) && (uVar14 != 0)) &&
        ((puVar3 + uVar10 <= puVar6 || (puVar6 + uVar10 <= puVar3)))) && (uVar14 != 0)) {
      lVar15 = -(longlong)puVar6;
      do {
        *puVar6 = puVar6[(longlong)(puVar3 + lVar15)];
        puVar6 = puVar6 + 1;
        uVar10 = uVar10 - 1;
      } while (uVar10 != 0);
    }
    *(undefined4 *)(param_2 + 0x108) = *(undefined4 *)(param_1 + 0x108);
  }
  if ((param_4 != 0) && (0 < *(int *)(param_2 + 0xf0))) {
    puVar5 = (undefined8 *)(*(longlong *)(param_2 + 0xf8) + 0x30);
    do {
      *(undefined4 *)((longlong)puVar5 + -0xc) = 0;
      uVar14 = (int)uVar9 + 1;
      uVar9 = (ulonglong)uVar14;
      *puVar5 = 0;
      puVar5 = puVar5 + 7;
    } while ((int)uVar14 < *(int *)(param_2 + 0xf0));
  }
  FUN_18005f100(local_38 ^ (ulonglong)auStack1544);
  return;
}



undefined8 * FUN_180005350(undefined8 *param_1,undefined8 *param_2,ulonglong param_3)

{
  memcpy_FUN_180061f90(param_1,param_2,param_3);
  return param_1;
}



void * FUN_180005370(void *param_1,undefined8 param_2,size_t param_3)

{
  memset(param_1,0,param_3);
  return param_1;
}



void FUN_180005390(undefined4 *param_1,undefined4 *param_2,int param_3)

{
  undefined *puVar1;
  int iVar2;
  ulonglong uVar3;
  undefined4 *puVar4;
  undefined *puVar5;
  undefined4 *puVar6;
  longlong lVar7;
  uint uVar8;

  uVar8 = *(uint *)(*(longlong *)(param_1 + 2) + 0xc);
  uVar3 = (ulonglong)uVar8;
  puVar1 = *(undefined **)(*(longlong *)(param_1 + 2) + 0x18);
  puVar5 = *(undefined **)(*(longlong *)(param_2 + 2) + 0x18);
  if ((((puVar5 != (undefined *)0x0) && (puVar1 != (undefined *)0x0)) && (uVar8 != 0)) &&
     (((puVar1 + uVar3 <= puVar5 || (puVar5 + uVar3 <= puVar1)) && (uVar8 != 0)))) {
    lVar7 = -(longlong)puVar5;
    do {
      *puVar5 = puVar5[(longlong)(puVar1 + lVar7)];
      puVar5 = puVar5 + 1;
      uVar3 = uVar3 - 1;
    } while (uVar3 != 0);
  }
  lVar7 = *(longlong *)(param_1 + 4);
  if (lVar7 == 0) {
    *(undefined8 *)(param_2 + 4) = 0;
  }
  else {
    uVar8 = *(uint *)(lVar7 + 0xc);
    uVar3 = (ulonglong)uVar8;
    puVar1 = *(undefined **)(lVar7 + 0x18);
    puVar5 = *(undefined **)(*(longlong *)(param_2 + 4) + 0x18);
    if (((puVar5 != (undefined *)0x0) && (puVar1 != (undefined *)0x0)) &&
       ((uVar8 != 0 && (((puVar1 + uVar3 <= puVar5 || (puVar5 + uVar3 <= puVar1)) && (uVar8 != 0))))
       )) {
      lVar7 = -(longlong)puVar5;
      do {
        *puVar5 = puVar5[(longlong)(puVar1 + lVar7)];
        puVar5 = puVar5 + 1;
        uVar3 = uVar3 - 1;
      } while (uVar3 != 0);
    }
  }
  lVar7 = *(longlong *)(param_1 + 6);
  if (lVar7 == 0) {
    *(undefined8 *)(param_2 + 6) = 0;
  }
  else {
    uVar8 = *(uint *)(lVar7 + 0xc);
    uVar3 = (ulonglong)uVar8;
    puVar1 = *(undefined **)(lVar7 + 0x18);
    puVar5 = *(undefined **)(*(longlong *)(param_2 + 6) + 0x18);
    if ((((puVar5 != (undefined *)0x0) && (puVar1 != (undefined *)0x0)) &&
        ((uVar8 != 0 && ((puVar1 + uVar3 <= puVar5 || (puVar5 + uVar3 <= puVar1)))))) &&
       (uVar8 != 0)) {
      lVar7 = -(longlong)puVar5;
      do {
        *puVar5 = puVar5[(longlong)(puVar1 + lVar7)];
        puVar5 = puVar5 + 1;
        uVar3 = uVar3 - 1;
      } while (uVar3 != 0);
    }
  }
  puVar6 = param_2 + 10;
  puVar4 = param_1 + 10;
  if (((puVar6 != (undefined4 *)0x0) && (puVar4 != (undefined4 *)0x0)) &&
     ((param_1 + 0x3c <= puVar6 || (param_2 + 0x3c <= puVar4)))) {
    puVar6 = (undefined4 *)((longlong)puVar6 - (longlong)puVar4);
    lVar7 = 100;
    do {
      *(undefined *)((longlong)puVar6 + (longlong)puVar4) = *(undefined *)puVar4;
      *(undefined *)((longlong)puVar6 + 1 + (longlong)puVar4) = *(undefined *)((longlong)puVar4 + 1)
      ;
      puVar4 = (undefined4 *)((longlong)puVar4 + 2);
      lVar7 = lVar7 + -1;
    } while (lVar7 != 0);
  }
  if (*(int **)(param_1 + 0x4c) != (int *)0x0) {
    FUN_1800230e0(*(int **)(param_1 + 0x4c),(int **)(param_2 + 0x4c));
  }
  puVar5 = *(undefined **)(param_2 + 0x3e);
  *(undefined8 *)(param_2 + 8) = 0;
  iVar2 = param_1[0x3c];
  if (param_3 < (int)param_1[0x3c]) {
    iVar2 = param_3;
  }
  uVar8 = iVar2 * 0x38;
  uVar3 = (ulonglong)uVar8;
  param_2[0x3c] = iVar2;
  puVar1 = *(undefined **)(param_1 + 0x3e);
  if (((((puVar5 != (undefined *)0x0) && (puVar1 != (undefined *)0x0)) && (uVar8 != 0)) &&
      ((puVar1 + uVar3 <= puVar5 || (puVar5 + uVar3 <= puVar1)))) && (uVar8 != 0)) {
    lVar7 = -(longlong)puVar5;
    do {
      *puVar5 = puVar5[(longlong)(puVar1 + lVar7)];
      puVar5 = puVar5 + 1;
      uVar3 = uVar3 - 1;
    } while (uVar3 != 0);
  }
  param_2[0x42] = param_1[0x42];
  param_2[0x41] = param_1[0x41];
  param_2[0x43] = param_1[0x43];
  param_2[0x44] = param_1[0x44];
  param_2[0x40] = param_1[0x40];
  param_2[0x49] = param_1[0x49];
  param_2[0x47] = param_1[0x47];
  param_2[0x48] = param_1[0x48];
  param_2[0x45] = param_1[0x45];
  param_2[0x43] = param_1[0x43];
  param_2[0x44] = param_1[0x44];
  param_2[0x4a] = param_1[0x4a];
  param_2[1] = param_1[1];
  *param_2 = *param_1;
  param_2[0x54] = param_1[0x54];
  param_2[0x53] = param_1[0x53];
  return;
}



void FUN_180005670(longlong param_1,undefined4 *param_2,int *param_3)

{
  undefined4 *puVar1;
  ulonglong *puVar2;
  undefined auStack88 [32];
  ulonglong local_38 [2];
  ulonglong local_28;
  ulonglong local_20;

  local_20 = DAT_1800b04e8 ^ (ulonglong)auStack88;
  local_28 = 0x100;
  puVar1 = *(undefined4 **)(param_1 + 0x28 + (ulonglong)*(uint *)(param_1 + 0x1c) * 8);
  FUN_180005390(param_2,puVar1,*(int *)(param_1 + 0x14));
  *(undefined4 *)((ulonglong)*(uint *)(param_1 + 0x24) * 0x1c + 0x1b8 + param_1) = 0xffffffff;
  puVar2 = (ulonglong *)(param_1 + 0x1bc + (ulonglong)*(uint *)(param_1 + 0x24) * 0x1c);
  if ((puVar2 != (ulonglong *)0x0) && ((&local_20 <= puVar2 || (puVar2 + 3 <= local_38)))) {
    *(undefined4 *)puVar2 = 0x100;
    *(undefined4 *)((longlong)puVar2 + 4) = 0;
    *(undefined4 *)(puVar2 + 1) = 0;
    *(undefined4 *)((longlong)puVar2 + 0xc) = 0;
    puVar2[2] = local_28;
  }
  *(int *)(param_1 + 0x24) = *(int *)(param_1 + 0x24) + 1;
  *(undefined4 *)(*(longlong *)(param_1 + 0x28 + (ulonglong)*(uint *)(param_1 + 0x1c) * 8) + 0x108)
       = puVar1[0x42];
  *(undefined4 *)(*(longlong *)(param_1 + 0x28 + (ulonglong)*(uint *)(param_1 + 0x1c) * 8) + 0x10c)
       = puVar1[0x43];
  *(undefined4 *)(*(longlong *)(param_1 + 0x28 + (ulonglong)*(uint *)(param_1 + 0x1c) * 8) + 0x114)
       = 0;
  *(undefined4 *)(*(longlong *)(param_1 + 0x28 + (ulonglong)*(uint *)(param_1 + 0x1c) * 8) + 0x11c)
       = 0;
  *(undefined4 *)(*(longlong *)(param_1 + 0x28 + (ulonglong)*(uint *)(param_1 + 0x1c) * 8) + 0x120)
       = 0;
  *(undefined4 *)(*(longlong *)(param_1 + 0x28 + (ulonglong)*(uint *)(param_1 + 0x1c) * 8) + 0x124)
       = 0;
  *(undefined8 *)(*(longlong *)(param_1 + 0x28 + (ulonglong)*(uint *)(param_1 + 0x1c) * 8) + 0x140)
       = 0;
  *(int *)(param_1 + 0x1c) = *(int *)(param_1 + 0x1c) + 1;
  *param_3 = *param_3 + 100;
  FUN_18005f100(local_20 ^ (ulonglong)auStack88);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_1800057a0(longlong param_1,uint *param_2,int *param_3,longlong param_4,int *param_5)

{
  int iVar1;
  int iVar2;
  uint *puVar3;
  undefined8 *puVar4;
  longlong lVar5;
  longlong lVar6;
  undefined (*pauVar7) [16];
  undefined8 *puVar8;
  ulonglong uVar9;
  int iVar10;
  uint uVar11;
  int *piVar13;
  ulonglong uVar14;
  uint **ppuVar15;
  int iVar16;
  undefined4 uVar17;
  undefined4 uVar18;
  undefined auVar19 [16];
  int local_3d8;
  int local_3d4;
  longlong local_3d0;
  uint *local_3c8;
  int *local_3c0;
  longlong local_3b8;
  undefined8 local_3b0;
  undefined4 uStack936;
  undefined4 uStack932;
  undefined8 local_3a0;
  undefined8 local_398;
  undefined8 local_298;
  undefined8 local_198;
  undefined8 local_98;
  undefined8 local_90;
  undefined8 local_88;
  undefined4 local_80;
  undefined2 local_7c;
  undefined local_7a;
  ulonglong local_78;
  ulonglong uVar12;

  auVar19 = _DAT_1800a4170;
  local_78 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffbd8;
  lVar6 = *(longlong *)(param_2 + 0x3e);
  ppuVar15 = (uint **)(param_1 + 0x28);
  iVar16 = 0;
  *param_5 = 0;
  local_3a0 = 0x100;
  local_3d0 = lVar6;
  local_3c8 = param_2;
  local_3c0 = param_3;
  local_3b8 = param_4;
  if (0 < *(int *)(param_1 + 0x1c) + -1) {
    uVar17 = 0x100;
    uVar18 = 0;
    do {
      iVar10 = 0;
      puVar3 = *ppuVar15;
      lVar5 = 3;
      puVar8 = &local_398;
      do {
        puVar4 = puVar8;
        *puVar4 = 0xffffffffffffffff;
        puVar4[1] = 0xffffffffffffffff;
        puVar4[2] = 0xffffffffffffffff;
        puVar4[3] = 0xffffffffffffffff;
        puVar4[4] = 0xffffffffffffffff;
        puVar4[5] = 0xffffffffffffffff;
        puVar4[6] = 0xffffffffffffffff;
        puVar4[7] = 0xffffffffffffffff;
        lVar5 = lVar5 + -1;
        puVar8 = puVar4 + 8;
      } while (lVar5 != 0);
      puVar4[8] = 0xffffffffffffffff;
      lVar5 = 3;
      puVar4[9] = 0xffffffffffffffff;
      puVar4[10] = 0xffffffffffffffff;
      puVar4[0xb] = 0xffffffffffffffff;
      puVar4[0xc] = 0xffffffffffffffff;
      puVar4[0xd] = 0xffffffffffffffff;
      puVar4[0xe] = 0xffffffffffffffff;
      puVar8 = &local_298;
      do {
        puVar4 = puVar8;
        *puVar4 = 0;
        puVar4[1] = 0;
        puVar4[2] = 0;
        puVar4[3] = 0;
        puVar4[4] = 0;
        puVar4[5] = 0;
        puVar4[6] = 0;
        puVar4[7] = 0;
        lVar5 = lVar5 + -1;
        puVar8 = puVar4 + 8;
      } while (lVar5 != 0);
      puVar4[8] = 0;
      lVar5 = 3;
      puVar4[9] = 0;
      puVar4[10] = 0;
      puVar4[0xb] = 0;
      puVar4[0xc] = 0;
      puVar4[0xd] = 0;
      puVar4[0xe] = 0;
      puVar8 = &local_198;
      do {
        puVar4 = puVar8;
        *puVar4 = 0;
        puVar4[1] = 0;
        puVar4[2] = 0;
        puVar4[3] = 0;
        puVar4[4] = 0;
        puVar4[5] = 0;
        puVar4[6] = 0;
        puVar4[7] = 0;
        lVar5 = lVar5 + -1;
        puVar8 = puVar4 + 8;
      } while (lVar5 != 0);
      puVar4[8] = 0;
      puVar4[9] = 0;
      puVar4[10] = 0;
      puVar4[0xb] = 0;
      puVar4[0xc] = 0;
      puVar4[0xd] = 0;
      puVar4[0xe] = 0;
      FUN_1800329f0((longlong)puVar3,(longlong)local_3c8,&local_398);
      uVar9 = 0;
      piVar13 = (int *)((longlong)&local_398 + 4);
      uVar12 = uVar9;
      uVar14 = uVar9;
      do {
        iVar1 = *(int *)((longlong)&local_398 + (longlong)((int)uVar12 * 2) * 4);
        if (-1 < iVar1) {
          iVar2 = *piVar13;
          iVar10 = iVar10 + 1;
          *(uint *)((longlong)&local_198 + uVar14) =
               (uint)*(ushort *)((longlong)iVar2 * 0x38 + 2 + lVar6);
          *(uint *)((longlong)&local_198 + uVar14 + 4) =
               (uint)*(ushort *)((longlong)iVar2 * 0x38 + 4 + lVar6);
          lVar5 = (longlong)iVar1 * 0x38 + *(longlong *)(puVar3 + 0x3e);
          *(uint *)((longlong)&local_298 + uVar14) = (uint)*(ushort *)(lVar5 + 2);
          *(uint *)((longlong)&local_298 + uVar14 + 4) = (uint)*(ushort *)(lVar5 + 4);
          uVar14 = uVar14 + 8;
        }
        uVar11 = (int)uVar12 + 1;
        uVar12 = (ulonglong)uVar11;
        piVar13 = piVar13 + 2;
      } while ((int)uVar11 < 0x1f);
      if (iVar10 < 5) {
        *(undefined4 *)((ulonglong)*(uint *)(param_1 + 0x24) * 0x1c + 0x1b8 + param_1) = 0xffffffff;
        pauVar7 = (undefined (*) [16])
                  (param_1 + 0x1bc + (ulonglong)*(uint *)(param_1 + 0x24) * 0x1c);
        if ((pauVar7 != (undefined (*) [16])0x0) &&
           (((undefined (*) [16])&local_398 <= pauVar7 || (pauVar7[1] + 8 <= &local_3b0)))) {
          *pauVar7 = auVar19;
          *(ulonglong *)pauVar7[1] = CONCAT44(uVar18,uVar17);
        }
      }
      else {
        local_3a0 = 0x100;
        local_98 = 0;
        local_90 = 0;
        local_88 = 0;
        local_80 = 0;
        local_7c = 0;
        local_7a = 0;
        local_3b0._0_4_ = 0x100;
        local_3b0._4_4_ = 0;
        uStack936 = 0;
        uStack932 = 0;
        local_3d8 = 0;
        FUN_180030800(&local_198,(longlong)&local_298,iVar10,&local_3b0,
                      (undefined1 (*) [9])&local_98,&local_3d8);
        lVar6 = 0;
        do {
          uVar11 = (uint)uVar9 + 1;
          if (*(char *)((longlong)&local_98 + lVar6) == '\0') {
            uVar11 = (uint)uVar9;
          }
          lVar6 = lVar6 + 1;
          uVar9 = (ulonglong)uVar11;
        } while (lVar6 < 0x1f);
        local_3d4 = 0;
        local_3d8 = 0;
        if (4 < (int)uVar11) {
          FUN_18002bd60(local_3c8,puVar3,&local_3b0,local_3c0,(int *)0x0,(int *)0x0,&local_3d4,
                        &local_3d8,0,(int *)0x0);
        }
        lVar6 = local_3d0;
        if ((((((int)uVar11 < 7) || (local_3d4 < 0xd1)) || (local_3d8 < 0x41)) &&
            ((int)uVar11 < 0xb)) && ((local_3d4 < 0xd8 || ((int)uVar11 < 6)))) {
          *(undefined4 *)((ulonglong)*(uint *)(param_1 + 0x24) * 0x1c + 0x1b8 + param_1) =
               0xffffffff;
          pauVar7 = (undefined (*) [16])
                    (param_1 + 0x1bc + (ulonglong)*(uint *)(param_1 + 0x24) * 0x1c);
          if ((pauVar7 != (undefined (*) [16])0x0) &&
             (((undefined (*) [16])&local_398 <= pauVar7 || (pauVar7[1] + 8 <= &local_3b0)))) {
            *pauVar7 = auVar19;
            *(ulonglong *)pauVar7[1] = CONCAT44(uVar18,uVar17);
          }
        }
        else {
          *(uint *)((ulonglong)*(uint *)(param_1 + 0x24) * 0x1c + 0x1b8 + param_1) = uVar11;
          puVar8 = (undefined8 *)(param_1 + 0x1bc + (ulonglong)*(uint *)(param_1 + 0x24) * 0x1c);
          if ((puVar8 != (undefined8 *)0x0) &&
             ((&local_398 <= puVar8 || (puVar8 + 3 <= &local_3b0)))) {
            *(undefined4 *)puVar8 = (undefined4)local_3b0;
            *(undefined4 *)((longlong)puVar8 + 4) = local_3b0._4_4_;
            *(undefined4 *)(puVar8 + 1) = uStack936;
            *(undefined4 *)((longlong)puVar8 + 0xc) = uStack932;
            puVar8[2] = local_3a0;
          }
          *(int *)(local_3b8 + (longlong)*param_5 * 4) = iVar16;
          *param_5 = *param_5 + 1;
        }
      }
      *(int *)(param_1 + 0x24) = *(int *)(param_1 + 0x24) + 1;
      iVar16 = iVar16 + 1;
      ppuVar15 = ppuVar15 + 1;
    } while (iVar16 < *(int *)(param_1 + 0x1c) + -1);
  }
  FUN_18005f100(local_78 ^ (ulonglong)&stack0xfffffffffffffbd8);
  return;
}



// WARNING: Could not reconcile some variable overlaps
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180005c80(longlong param_1,longlong param_2,int *param_3,undefined (*param_4) [16])

{
  longlong lVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  byte bVar5;
  longlong lVar6;
  undefined (*pauVar7) [16];
  uint uVar8;
  longlong lVar9;
  longlong lVar10;
  int iVar11;
  longlong lVar12;
  int iVar13;
  uint uVar14;
  longlong lVar15;
  uint uVar16;
  int *piVar17;
  ulonglong uVar18;
  undefined auVar19 [16];
  undefined auStack232 [32];
  uint local_c8;
  uint local_c4;
  undefined (*local_c0) [16];
  int *local_b8;
  longlong local_b0;
  longlong local_a8;
  int *local_a0;
  undefined local_98 [12];
  undefined4 uStack140;
  undefined8 local_88;
  int local_80;
  int iStack124;
  int iStack120;
  int iStack116;
  undefined8 local_70;
  ulonglong local_68;

  local_68 = DAT_1800b04e8 ^ (ulonglong)auStack232;
  local_b8 = (int *)(param_1 + 0x28);
  lVar1 = param_1 + 0x1b8;
  lVar9 = *(longlong *)(param_3 + 2);
  iVar11 = 0;
  iVar2 = *param_3;
  iVar13 = 0;
  local_c8 = *(uint *)(param_1 + 0x87d8);
  local_88 = 0x100;
  _local_98 = _DAT_1800a4170;
  if (0 < (longlong)param_3[1]) {
    lVar12 = 0;
    lVar10 = 0;
    do {
      lVar15 = lVar12 * 4;
      iVar3 = *(int *)((longlong)(*(int *)(lVar15 + lVar9) + iVar2) * 0x1c + lVar1);
      lVar6 = (longlong)(*(int *)(lVar10 + lVar9) + iVar2) * 0x1c;
      if (*(int *)(lVar6 + lVar1) < iVar3) {
        iVar11 = iVar13;
      }
      iVar13 = iVar13 + 1;
      lVar12 = lVar12 + 1;
      if (iVar3 <= *(int *)(lVar6 + lVar1)) {
        lVar15 = lVar10;
      }
      lVar10 = lVar15;
    } while (lVar12 < param_3[1]);
  }
  uVar4 = *(uint *)(lVar9 + (longlong)iVar11 * 4);
  auVar19 = _DAT_1800a4170;
  local_c4 = uVar4;
  local_c0 = param_4;
  local_a8 = param_2;
  local_a0 = param_3;
  if ((int)local_c8 < (int)uVar4) {
    piVar17 = (int *)(param_1 + 0x1bc + (longlong)(int)(uVar4 + iVar2) * 0x1c);
    local_b8 = (int *)(param_1 + 0x1bc +
                      (longlong)
                      (int)(*(int *)(*(longlong *)(local_b8 + (longlong)(int)uVar4 * 2) + 0x104) +
                           local_c8) * 0x1c);
    if ((local_b8 != (int *)0x0) && (piVar17 != (int *)0x0)) {
      lVar9 = (longlong)*local_b8;
      lVar12 = (longlong)local_b8[1];
      lVar15 = (longlong)local_b8[3];
      lVar10 = (longlong)local_b8[4];
      local_b0 = lVar15 * *piVar17;
      uStack140 = SUB164(_DAT_1800a4170 >> 0x60,0);
      local_98._0_8_ = SUB168(_DAT_1800a4170,0);
      local_98 = CONCAT48((int)((ulonglong)(piVar17[2] * lVar9 + piVar17[5] * lVar12) >> 8) +
                          local_b8[2],local_98._0_8_);
      bVar5 = 0xf;
      iVar11 = (int)((ulonglong)(local_b0 + lVar10 * piVar17[3]) >> 8) -
               (int)((ulonglong)(piVar17[1] * lVar9 + piVar17[4] * lVar12) >> 8) >> 1;
      iVar13 = (int)((ulonglong)(piVar17[1] * lVar15 + lVar10 * piVar17[4]) >> 8) +
               (int)((ulonglong)(*piVar17 * lVar9 + piVar17[3] * lVar12) >> 8) >> 1;
      local_88 = (ulonglong)
                 (uint)((int)((ulonglong)(lVar15 * piVar17[2] + lVar10 * piVar17[5]) >> 8) +
                       local_b8[5]) << 0x20;
      uVar14 = 0;
      uVar16 = iVar11 * iVar11 + iVar13 * iVar13;
      uVar4 = 0x8000;
      uVar8 = uVar16;
      if (1 < uVar16) {
        do {
          uVar8 = uVar4 + uVar14 * 2 << (bVar5 & 0x1f);
          bVar5 = bVar5 - 1;
          if (uVar8 <= uVar16) {
            uVar14 = uVar14 + uVar4;
            uVar16 = uVar16 - uVar8;
          }
          uVar4 = uVar4 >> 1;
          uVar8 = uVar14;
        } while (uVar4 != 0);
      }
LAB_18000601a:
      param_4 = local_c0;
      uVar4 = local_c4;
      if (uVar8 == 0) {
        _local_98 = CONCAT88(stack0xffffffffffffff70,0x100);
        local_88 = CONCAT44(local_88._4_4_,0x100);
        _local_98 = _local_98 & (undefined  [16])0xffffffffffffffff;
        auVar19 = _local_98;
      }
      else {
        uVar14 = (((int)uVar8 >> 1) + iVar13 * 0x100) / (int)uVar8;
        local_88 = local_88 | uVar14;
        iVar11 = (((int)uVar8 >> 1) + iVar11 * -0x100) / (int)uVar8;
        local_98._0_8_ = CONCAT44(iVar11,uVar14);
        _local_98 = CONCAT412(-iVar11,local_98);
        auVar19 = _local_98;
      }
    }
  }
  else {
    if ((int)local_c8 <= (int)uVar4) {
      pauVar7 = (undefined (*) [16])(param_1 + 0x1bc + (longlong)(int)(uVar4 + iVar2) * 0x1c);
      uVar18 = local_88;
      if ((pauVar7 != (undefined (*) [16])0x0) &&
         ((pauVar7[1] + 8 <= local_98 || ((undefined (*) [16])&local_80 <= pauVar7)))) {
        uVar18 = *(ulonglong *)pauVar7[1];
        auVar19 = *pauVar7;
      }
      goto LAB_1800060e6;
    }
    iVar11 = 0x100;
    local_80 = 0x100;
    iStack124 = 0;
    iStack120 = 0;
    iStack116 = 0;
    local_70 = 0x100;
    piVar17 = (int *)((longlong)
                      (int)(*(int *)(*(longlong *)(local_b8 + (longlong)(int)local_c8 * 2) + 0x104)
                           + uVar4) * 0x1c + 4 + lVar1);
    if (piVar17 != (int *)0x0) {
      FUN_180023cd0(piVar17,&local_80);
      iVar11 = (int)local_70;
    }
    piVar17 = (int *)(param_1 + 0x1bc + (longlong)(int)(uVar4 + iVar2) * 0x1c);
    if (piVar17 != (int *)0x0) {
      lVar9 = (longlong)iStack124;
      lVar10 = (longlong)local_80;
      bVar5 = 0xf;
      local_98 = CONCAT48((int)((ulonglong)(lVar10 * piVar17[2] + lVar9 * piVar17[5]) >> 8) +
                          iStack120,local_98._0_8_);
      lVar12 = (longlong)iVar11;
      lVar15 = (longlong)iStack116;
      local_b0 = lVar15 * *piVar17;
      iVar11 = (int)((ulonglong)(local_b0 + lVar12 * piVar17[3]) >> 8) -
               (int)((ulonglong)(lVar10 * piVar17[1] + lVar9 * piVar17[4]) >> 8) >> 1;
      iVar13 = (int)((ulonglong)(piVar17[1] * lVar15 + lVar12 * piVar17[4]) >> 8) +
               (int)((ulonglong)(lVar10 * *piVar17 + lVar9 * piVar17[3]) >> 8) >> 1;
      local_88 = (ulonglong)
                 (uint)((int)((ulonglong)(lVar15 * piVar17[2] + lVar12 * piVar17[5]) >> 8) +
                       local_70._4_4_) << 0x20;
      uVar14 = 0;
      uVar16 = iVar13 * iVar13 + iVar11 * iVar11;
      uVar4 = 0x8000;
      uVar8 = uVar16;
      if (1 < uVar16) {
        do {
          uVar8 = uVar4 + uVar14 * 2 << (bVar5 & 0x1f);
          bVar5 = bVar5 - 1;
          if (uVar8 <= uVar16) {
            uVar14 = uVar14 + uVar4;
            uVar16 = uVar16 - uVar8;
          }
          uVar4 = uVar4 >> 1;
          uVar8 = uVar14;
        } while (uVar4 != 0);
      }
      goto LAB_18000601a;
    }
  }
  pauVar7 = (undefined (*) [16])(param_1 + 0x1bc + (longlong)(int)(local_c8 + iVar2) * 0x1c);
  uVar18 = local_88;
  if ((pauVar7 != (undefined (*) [16])0x0) &&
     (((undefined (*) [16])&local_80 <= pauVar7 || (pauVar7[1] + 8 <= local_98)))) {
    *pauVar7 = auVar19;
    *(ulonglong *)pauVar7[1] = local_88;
  }
LAB_1800060e6:
  if ((uVar4 != local_c8) &&
     (lVar9 = (longlong)(int)(local_c8 + iVar2) * 0x1c, *(int *)(lVar9 + lVar1) < 0)) {
    *(undefined4 *)(lVar9 + lVar1) = 0;
  }
  *(undefined4 *)(local_a8 + 0x100) = 1;
  if ((param_4 != (undefined (*) [16])0x0) &&
     (((undefined (*) [16])&local_80 <= param_4 || (param_4[1] + 8 <= local_98)))) {
    *param_4 = auVar19;
    *(ulonglong *)param_4[1] = uVar18;
  }
  local_a0[7] = local_a0[7] + (uVar4 & 0xff) * 0x100 + 0x100;
  FUN_18005f100(local_68 ^ (ulonglong)auStack232);
  return;
}



ulonglong FUN_180006180(longlong param_1,uint *param_2,int *param_3,ulonglong *param_4)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  ulonglong uVar6;
  ulonglong *puVar7;
  longlong lVar8;

  iVar2 = *param_3;
  uVar5 = **(uint **)(param_3 + 2);
  if (1 < (longlong)param_3[1]) {
    lVar8 = 1;
    do {
      uVar3 = (*(uint **)(param_3 + 2))[lVar8];
      iVar4 = *(int *)((longlong)(int)(uVar5 + iVar2) * 0x1c + 0x1b8 + param_1);
      piVar1 = (int *)((longlong)(int)(uVar3 + iVar2) * 0x1c + 0x1b8 + param_1);
      if (*piVar1 == iVar4 || *piVar1 < iVar4) {
        uVar3 = uVar5;
      }
      uVar5 = uVar3;
      lVar8 = lVar8 + 1;
    } while (lVar8 < param_3[1]);
  }
  uVar6 = (longlong)(int)(uVar5 + iVar2) * 0x1c;
  if (5 < *(int *)(uVar6 + 0x1b8 + param_1)) {
    puVar7 = (ulonglong *)(param_1 + 0x1bc + uVar6);
    uVar6 = FUN_18002bd60(param_2,*(uint **)((longlong)(int)uVar5 * 8 + 0x28 + param_1),puVar7,
                          *(int **)(param_3 + 4),(int *)0x0,(int *)0x0,(int *)0x0,(int *)0x0,0,
                          (int *)0x0);
    if (param_3[6] < (int)uVar6) {
      *(uint *)(param_1 + 0x87d8) = uVar5;
      param_2[0x40] = 1;
      *(undefined4 *)(*(longlong *)((longlong)(int)uVar5 * 8 + 0x28 + param_1) + 0x100) = 1;
      *(undefined4 *)(param_1 + 0x87e4) = 1;
      if (((param_4 != (ulonglong *)0x0) && (puVar7 != (ulonglong *)0x0)) &&
         ((puVar7 + 3 <= param_4 || (param_4 + 3 <= puVar7)))) {
        puVar7 = (ulonglong *)((longlong)puVar7 - (longlong)param_4);
        lVar8 = 0x18;
        do {
          *(undefined *)param_4 = *(undefined *)((longlong)puVar7 + (longlong)param_4);
          param_4 = (ulonglong *)((longlong)param_4 + 1);
          lVar8 = lVar8 + -1;
        } while (lVar8 != 0);
      }
      uVar5 = (uVar5 & 0xff) * 0x100 + 0x100;
      uVar6 = (ulonglong)uVar5;
      param_3[7] = param_3[7] + uVar5;
    }
  }
  return uVar6;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180006300(longlong param_1,int *param_2,int param_3,int *param_4,int param_5)

{
  uint **ppuVar1;
  uint *puVar2;
  int iVar3;
  uint uVar4;
  byte bVar5;
  uint uVar6;
  int iVar7;
  longlong lVar8;
  longlong lVar9;
  int iVar10;
  uint uVar11;
  longlong lVar12;
  undefined8 *puVar13;
  longlong lVar14;
  ulonglong *puVar15;
  ulonglong uVar16;
  longlong lVar17;
  uint uVar18;
  uint uVar19;
  longlong lVar20;
  int iVar21;
  int iVar22;
  int iVar23;
  ulonglong uVar24;
  int iVar25;
  ulonglong uVar26;
  uint uVar27;
  ulonglong uVar28;
  int *piVar29;
  uint **ppuVar30;
  longlong lVar31;
  ulonglong local_1b8;
  ulonglong local_1b0;
  int local_1a8;
  uint local_1a4;
  ulonglong local_1a0;
  uint local_198;
  int *local_190;
  ulonglong local_188;
  longlong local_180;
  int *local_178;
  int *local_170;
  uint **local_168;
  int aiStack348 [53];
  undefined8 local_88;
  uint uStack128;
  int iStack124;
  ulonglong local_78;
  undefined8 local_70;
  int iStack104;
  int iStack100;
  ulonglong local_60;
  int local_58;
  int local_54;
  int local_50;
  int local_4c;
  ulonglong local_48;
  ulonglong local_40;

  if (param_3 < 1) {
    return;
  }
  local_40 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffdf8;
  uVar28 = SEXT48(param_3);
  local_178 = aiStack348 + 2;
  uVar26 = 0;
  ppuVar30 = (uint **)(param_1 + 0x28 + uVar28 * 8);
  local_188 = 0;
  local_1a4 = 0;
  aiStack348[1] = param_3;
  uVar16 = uVar26;
  local_190 = param_2;
  local_180 = param_1;
  local_170 = param_4;
LAB_180006390:
  ppuVar1 = ppuVar30 + -1;
  ppuVar30 = ppuVar30 + -1;
  uVar27 = (int)uVar28 - 1;
  uVar28 = (ulonglong)uVar27;
  local_198 = uVar27;
  local_168 = ppuVar30;
  if (((*ppuVar1)[0x40] != 1) && (piVar29 = local_170, -1 < (int)uVar26)) {
LAB_1800063c0:
    puVar2 = *(uint **)(param_1 + 0x28 + (longlong)aiStack348[uVar16 + 1] * 8);
    lVar8 = (longlong)(int)(puVar2[0x41] + uVar27) * 0x1c;
    iVar22 = (int)uVar26;
    if (0x7fffffff < *(uint *)(lVar8 + 0x1b8 + param_1)) goto LAB_180006427;
    puVar15 = (ulonglong *)(lVar8 + 0x1bc + param_1);
    iVar3 = FUN_18002bd60(puVar2,*ppuVar30,puVar15,piVar29,(int *)0x0,(int *)0x0,(int *)0x0,
                          (int *)0x0,0,(int *)0x0);
    piVar29 = local_170;
    if (iVar3 <= param_5) goto LAB_180006427;
    iVar3 = 0x100;
    iVar7 = 0;
    local_1b0 = 0;
    uVar26 = 0x100;
    local_60 = 0x100;
    local_78 = 0x100;
    local_1a0 = 0;
    local_70 = 0x100;
    iStack104 = 0;
    iStack100 = 0;
    local_88 = 0x100;
    local_88._0_4_ = 0x100;
    uStack128 = 0;
    iStack124 = 0;
    if ((puVar15 != (ulonglong *)0x0) && ((puVar15 + 3 <= &local_70 || (&local_58 <= puVar15)))) {
      iVar3 = *(int *)puVar15;
      iVar7 = *(int *)((longlong)puVar15 + 4);
      local_60 = puVar15[2];
      local_1b0 = local_60 >> 0x20;
      uVar26 = local_60 & 0xffffffff;
      local_70 = *puVar15;
      iStack104 = *(int *)(puVar15 + 1);
      iStack100 = *(int *)((longlong)puVar15 + 0xc);
    }
    iVar25 = (int)uVar26;
    local_1a8 = iVar22 + -1;
    uVar24 = local_70 & 0xffffffff;
    iVar21 = iStack100;
    uVar27 = local_70._4_4_;
    iVar23 = (int)local_70;
    iVar10 = iStack104;
    if (-1 < local_1a8) {
      lVar8 = (longlong)iVar22 * 4;
      lVar9 = uVar16 * 4;
      do {
        lVar31 = lVar9 + -4;
        lVar9 = (longlong)
                (*(int *)(*(longlong *)
                           (param_1 + 0x28 + (longlong)*(int *)((longlong)aiStack348 + lVar9) * 8) +
                         0x104) + *(int *)((longlong)aiStack348 + lVar8 + 4)) * 0x1c;
        if ((*(uint *)(lVar9 + 0x1b8 + param_1) < 0x80000000) &&
           (piVar29 = (int *)(param_1 + 0x1bc + lVar9), lVar8 = lVar31, piVar29 != (int *)0x0)) {
          lVar12 = (longlong)*piVar29;
          lVar20 = (longlong)piVar29[1];
          lVar17 = (longlong)piVar29[4];
          lVar14 = (longlong)piVar29[3];
          lVar9 = (longlong)iVar10;
          iVar22 = (int)((ulonglong)((int)uVar27 * lVar14 + (int)uVar26 * lVar17) >> 8) +
                   (int)((ulonglong)((int)uVar24 * lVar12 + iVar21 * lVar20) >> 8) >> 1;
          iVar3 = (int)((ulonglong)((int)uVar24 * lVar14 + iVar21 * lVar17) >> 8) -
                  (int)((ulonglong)((int)uVar27 * lVar12 + (int)uVar26 * lVar20) >> 8) >> 1;
          iVar10 = (int)((ulonglong)(lVar9 * lVar12 + (int)local_1b0 * lVar20) >> 8) + piVar29[2];
          uVar6 = (int)((ulonglong)(lVar9 * lVar14 + (int)local_1b0 * lVar17) >> 8) + piVar29[5];
          local_1b0 = (ulonglong)uVar6;
          iStack104 = iVar10;
          uVar11 = 0x8000;
          uVar18 = iVar3 * iVar3 + iVar22 * iVar22;
          bVar5 = 0xf;
          uVar27 = uVar18;
          uVar19 = 0;
          if (1 < uVar18) {
            do {
              uVar4 = uVar11 + uVar19 * 2 << (bVar5 & 0x1f);
              bVar5 = bVar5 - 1;
              uVar27 = uVar19;
              if (uVar4 <= uVar18) {
                uVar27 = uVar19 + uVar11;
                uVar18 = uVar18 - uVar4;
              }
              uVar11 = uVar11 >> 1;
              uVar19 = uVar27;
            } while (uVar11 != 0);
          }
          if (uVar27 == 0) {
            uVar24 = 0x100;
            uVar27 = 0;
            local_70 = 0x100;
            iVar21 = 0;
          }
          else {
            uVar24 = (longlong)(((int)uVar27 >> 1) + iVar22 * 0x100) / (longlong)(int)uVar27 &
                     0xffffffff;
            uVar27 = (((int)uVar27 >> 1) + iVar3 * -0x100) / (int)uVar27;
            local_70 = uVar24 | (ulonglong)uVar27 << 0x20;
            iVar21 = -uVar27;
          }
          iStack100 = iVar21;
          local_60 = uVar24 | (ulonglong)uVar6 << 0x20;
          uVar26 = uVar24;
          param_1 = local_180;
        }
        iVar25 = (int)uVar26;
        local_1a8 = local_1a8 + -1;
        lVar9 = lVar31;
      } while (-1 < local_1a8);
      uVar28 = (ulonglong)local_198;
      iVar23 = (int)uVar24;
      iVar3 = (int)local_70;
      iVar7 = local_70._4_4_;
    }
    iVar22 = iVar23 * iVar25 - uVar27 * iVar21;
    if (iVar22 == 0) {
      local_58 = iVar3;
      local_54 = iVar7;
      local_50 = iStack104;
      local_4c = iStack100;
      local_48 = local_60;
      local_1b8 = local_60 >> 0x20;
      local_48._0_4_ = (int)local_60;
      iVar22 = iStack104;
      iVar10 = iStack100;
    }
    else {
      lVar8 = (longlong)iVar22;
      iVar3 = (int)(((longlong)iVar25 << 0x10) / lVar8);
      iVar7 = (int)(((longlong)(int)uVar27 * -0x10000) / lVar8);
      local_1b0 = ((longlong)iVar23 << 0x10) / lVar8;
      local_48._0_4_ = (int)local_1b0;
      local_1b8 = (((longlong)iVar21 * (longlong)iVar10 -
                   (longlong)(int)local_1b0 * (longlong)iVar23) * 0x100) / lVar8;
      iVar22 = (int)((((longlong)(int)local_1b0 * (longlong)(int)uVar27 -
                      (longlong)iVar25 * (longlong)iVar10) * 0x100) / lVar8);
      iVar10 = (int)(((longlong)iVar21 * -0x10000) / lVar8);
    }
    if (local_190 == (int *)0x0) {
      uVar27 = 0;
    }
    else {
      lVar9 = (longlong)local_190[1];
      lVar31 = (longlong)*local_190;
      uStack128 = (int)((ulonglong)((int)local_1b8 * lVar9 + lVar31 * iVar22) >> 8) + local_190[2];
      local_1b8 = (ulonglong)uStack128;
      lVar12 = (longlong)local_190[3];
      lVar8 = (longlong)local_190[4];
      uVar6 = 0;
      iVar21 = (int)((ulonglong)(lVar8 * iVar10 + lVar12 * iVar3) >> 8) -
               (int)((ulonglong)((int)local_48 * lVar9 + lVar31 * iVar7) >> 8) >> 1;
      uVar18 = (int)((ulonglong)(lVar8 * (int)local_1b8 + lVar12 * iVar22) >> 8) + local_190[5];
      local_1a0 = (ulonglong)uVar18;
      uVar11 = 0x8000;
      local_78 = (ulonglong)uVar18 << 0x20;
      bVar5 = 0xf;
      iVar22 = (int)((ulonglong)(lVar8 * (int)local_48 + lVar12 * iVar7) >> 8) +
               (int)((ulonglong)(iVar10 * lVar9 + lVar31 * iVar3) >> 8) >> 1;
      uVar27 = iVar21 * iVar21 + iVar22 * iVar22;
      uVar19 = uVar27;
      if (1 < uVar27) {
        do {
          uVar4 = uVar11 + uVar6 * 2 << (bVar5 & 0x1f);
          bVar5 = bVar5 - 1;
          uVar27 = uVar6;
          if (uVar4 <= uVar19) {
            uVar27 = uVar6 + uVar11;
            uVar19 = uVar19 - uVar4;
          }
          uVar11 = uVar11 >> 1;
          uVar6 = uVar27;
        } while (uVar11 != 0);
      }
      if (uVar27 == 0) {
        local_88._0_4_ = 0x100;
        uVar27 = 0;
        local_88 = 0x100;
        local_78 = CONCAT44(uVar18,0x100);
        iStack124 = 0;
      }
      else {
        local_88 = (longlong)(((int)uVar27 >> 1) + iVar22 * 0x100) / (longlong)(int)uVar27 &
                   0xffffffff;
        local_78 = local_78 | local_88;
        uVar27 = (((int)uVar27 >> 1) + iVar21 * -0x100) / (int)uVar27;
        local_88 = local_88 | (ulonglong)uVar27 << 0x20;
        iStack124 = -uVar27;
      }
    }
    (*local_168)[0x40] = 1;
    iVar22 = *(int *)(param_1 + 0x87d8);
    iVar3 = (int)uVar28;
    if (iVar3 < iVar22) {
      lVar9 = (longlong)iStack124;
      lVar8 = (longlong)(int)uStack128;
      iVar7 = (int)local_88 * (int)local_88 - uVar27 * iStack124;
      if (iVar7 != 0) {
        lVar31 = (longlong)iVar7;
        local_88 = ((longlong)(int)local_88 << 0x10) / lVar31 & 0xffffffffU |
                   ((longlong)(int)uVar27 * -0x10000) / lVar31 << 0x20;
        uStack128 = (uint)((((longlong)(int)local_1a0 * (longlong)(int)uVar27 -
                            (int)local_88 * lVar8) * 0x100) / lVar31);
        iStack124 = (int)((lVar9 * -0x10000) / lVar31);
        local_78 = ((longlong)(int)local_88 << 0x10) / lVar31 & 0xffffffffU |
                   ((lVar9 * lVar8 - (longlong)(int)local_1a0 * (longlong)(int)local_88) * 0x100) /
                   lVar31 << 0x20;
      }
      puVar13 = (undefined8 *)
                (param_1 + 0x1bc +
                (longlong)
                (*(int *)(*(longlong *)(param_1 + 0x28 + (longlong)iVar22 * 8) + 0x104) + iVar3) *
                0x1c);
      if ((puVar13 != (undefined8 *)0x0) && ((&local_70 <= puVar13 || (puVar13 + 3 <= &local_88))))
      {
        *(int *)puVar13 = (int)local_88;
        *(undefined4 *)((longlong)puVar13 + 4) = local_88._4_4_;
        *(uint *)(puVar13 + 1) = uStack128;
        *(int *)((longlong)puVar13 + 0xc) = iStack124;
        puVar13[2] = local_78;
      }
      iVar22 = *(int *)(*(longlong *)(param_1 + 0x28 + (longlong)*(int *)(param_1 + 0x87d8) * 8) +
                       0x104) + iVar3;
    }
    else {
      puVar13 = (undefined8 *)
                (param_1 + 0x1bc + (longlong)(int)((*local_168)[0x41] + iVar22) * 0x1c);
      if ((puVar13 != (undefined8 *)0x0) && ((&local_70 <= puVar13 || (puVar13 + 3 <= &local_88))))
      {
        *(int *)puVar13 = (int)local_88;
        *(undefined4 *)((longlong)puVar13 + 4) = local_88._4_4_;
        *(uint *)(puVar13 + 1) = uStack128;
        *(int *)((longlong)puVar13 + 0xc) = iStack124;
        puVar13[2] = local_78;
      }
      iVar22 = (*local_168)[0x41] + *(int *)(param_1 + 0x87d8);
    }
    uVar16 = local_188 + 1;
    *local_178 = iVar3;
    *(undefined4 *)((longlong)iVar22 * 0x1c + 0x1b8 + param_1) = 0;
    local_1a4 = local_1a4 + 1;
    uVar26 = (ulonglong)local_1a4;
    local_178 = local_178 + 1;
    ppuVar30 = local_168;
    local_188 = uVar16;
  }
  goto LAB_180006437;
LAB_180006427:
  uVar16 = uVar16 - 1;
  uVar26 = (ulonglong)(iVar22 - 1U);
  if ((int)(iVar22 - 1U) < 0) goto code_r0x00018000642f;
  goto LAB_1800063c0;
code_r0x00018000642f:
  uVar26 = (ulonglong)local_1a4;
  uVar16 = local_188;
LAB_180006437:
  if ((int)uVar28 < 1) {
    FUN_18005f100(local_40 ^ (ulonglong)&stack0xfffffffffffffdf8);
    return;
  }
  goto LAB_180006390;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180006be0(longlong param_1,int *param_2,int param_3,int *param_4,int param_5)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  ulonglong uVar4;
  byte bVar5;
  int iVar6;
  uint uVar7;
  longlong lVar8;
  longlong lVar9;
  ulonglong *puVar10;
  longlong lVar11;
  longlong lVar12;
  int iVar13;
  int iVar14;
  uint uVar15;
  int *piVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  longlong *plVar20;
  int iVar21;
  int local_98;
  int local_94;
  ulonglong local_90;
  int *local_88;
  longlong local_80;
  int *local_78;
  longlong local_70;
  longlong local_68;
  undefined8 local_60;
  uint uStack88;
  int iStack84;
  ulonglong local_50;
  ulonglong local_48 [2];

  local_48[0] = DAT_1800b04e8 ^ (ulonglong)&stack0xffffffffffffff18;
  iVar21 = *(int *)(param_1 + 0x1c) + -2;
  local_98 = param_3;
  local_94 = iVar21;
  local_88 = param_2;
  local_78 = param_4;
  if (param_3 < iVar21) {
    lVar11 = (longlong)param_3 * 8;
    plVar20 = (longlong *)(param_1 + 0x28 + lVar11);
    iVar14 = param_3;
    local_80 = lVar11;
    do {
      puVar1 = (uint *)plVar20[1];
      plVar20 = plVar20 + 1;
      param_3 = param_3 + 1;
      if ((puVar1[0x40] != 1) &&
         (lVar12 = (longlong)(int)(puVar1[0x41] + iVar14) * 0x1c,
         *(uint *)(lVar12 + 0x1b8 + param_1) < 0x80000000)) {
        uVar19 = 0;
        iVar2 = FUN_18002bd60(puVar1,*(uint **)(lVar11 + 0x28 + param_1),
                              (ulonglong *)(param_1 + 0x1bc + lVar12),param_4,(int *)0x0,(int *)0x0,
                              (int *)0x0,(int *)0x0,0,(int *)0x0);
        lVar11 = local_80;
        param_4 = local_78;
        iVar14 = local_98;
        if (param_5 < iVar2) {
          piVar16 = (int *)(param_1 + 0x1bc + lVar12);
          iVar2 = 0x100;
          local_50 = 0x100;
          local_60 = 0x100;
          uStack88 = 0;
          iStack84 = 0;
          if ((param_2 == (int *)0x0) || (piVar16 == (int *)0x0)) {
            uVar18 = 0;
          }
          else {
            lVar8 = (longlong)param_2[1];
            lVar12 = (longlong)*param_2;
            uStack88 = (int)((ulonglong)(piVar16[2] * lVar12 + piVar16[5] * lVar8) >> 8) +
                       local_88[2];
            local_90 = (ulonglong)uStack88;
            lVar9 = (longlong)local_88[4];
            local_68 = (longlong)local_88[3];
            local_70 = local_68 * *piVar16;
            iVar13 = (int)((ulonglong)(local_70 + lVar9 * piVar16[3]) >> 8) -
                     (int)((ulonglong)(piVar16[1] * lVar12 + piVar16[4] * lVar8) >> 8) >> 1;
            uVar7 = 0x8000;
            uVar19 = (int)((ulonglong)(local_68 * piVar16[2] + lVar9 * piVar16[5]) >> 8) +
                     local_88[5];
            iVar2 = (int)((ulonglong)(local_68 * piVar16[1] + lVar9 * piVar16[4]) >> 8) +
                    (int)((ulonglong)(lVar12 * *piVar16 + lVar8 * piVar16[3]) >> 8) >> 1;
            bVar5 = 0xf;
            local_50 = (ulonglong)uVar19 << 0x20;
            uVar15 = iVar13 * iVar13 + iVar2 * iVar2;
            uVar18 = uVar15;
            uVar17 = 0;
            if (1 < uVar15) {
              do {
                uVar3 = uVar7 + uVar17 * 2 << (bVar5 & 0x1f);
                bVar5 = bVar5 - 1;
                uVar18 = uVar17;
                if (uVar3 <= uVar15) {
                  uVar18 = uVar17 + uVar7;
                  uVar15 = uVar15 - uVar3;
                }
                uVar7 = uVar7 >> 1;
                uVar17 = uVar18;
              } while (uVar7 != 0);
            }
            iVar21 = local_94;
            if (uVar18 == 0) {
              uVar18 = 0;
              iVar2 = 0x100;
              local_60 = 0x100;
              local_50 = CONCAT44(uVar19,0x100);
              iStack84 = 0;
            }
            else {
              uVar4 = (longlong)(((int)uVar18 >> 1) + iVar2 * 0x100) / (longlong)(int)uVar18 &
                      0xffffffff;
              iVar2 = (int)uVar4;
              uVar18 = (((int)uVar18 >> 1) + iVar13 * -0x100) / (int)uVar18;
              local_60 = uVar4 | (ulonglong)uVar18 << 0x20;
              iStack84 = -uVar18;
              local_50 = local_50 | uVar4;
            }
          }
          *(undefined4 *)(*plVar20 + 0x100) = 1;
          iVar13 = *(int *)(param_1 + 0x87d8);
          if (param_3 < iVar13) {
            lVar8 = (longlong)iStack84;
            lVar12 = (longlong)(int)uStack88;
            iVar6 = iVar2 * iVar2 - uVar18 * iStack84;
            if (iVar6 != 0) {
              lVar9 = (longlong)iVar6;
              local_60 = ((longlong)iVar2 << 0x10) / lVar9 & 0xffffffffU |
                         ((longlong)(int)uVar18 * -0x10000) / lVar9 << 0x20;
              uStack88 = (uint)((((longlong)(int)uVar19 * (longlong)(int)uVar18 - iVar2 * lVar12) *
                                0x100) / lVar9);
              iStack84 = (int)((lVar8 * -0x10000) / lVar9);
              local_50 = ((longlong)iVar2 << 0x10) / lVar9 & 0xffffffffU |
                         ((lVar8 * lVar12 - (longlong)(int)uVar19 * (longlong)iVar2) * 0x100) /
                         lVar9 << 0x20;
            }
            puVar10 = (ulonglong *)
                      (param_1 + 0x1bc +
                      (longlong)
                      (*(int *)(*(longlong *)(param_1 + 0x28 + (longlong)iVar13 * 8) + 0x104) +
                      param_3) * 0x1c);
            if ((puVar10 != (ulonglong *)0x0) &&
               ((local_48 <= puVar10 || (puVar10 + 3 <= &local_60)))) {
              *(undefined4 *)puVar10 = (undefined4)local_60;
              *(undefined4 *)((longlong)puVar10 + 4) = local_60._4_4_;
              *(uint *)(puVar10 + 1) = uStack88;
              *(int *)((longlong)puVar10 + 0xc) = iStack84;
              puVar10[2] = local_50;
            }
            iVar2 = *(int *)(*(longlong *)
                              (param_1 + 0x28 + (longlong)*(int *)(param_1 + 0x87d8) * 8) + 0x104) +
                    param_3;
          }
          else {
            puVar10 = (ulonglong *)
                      (param_1 + 0x1bc + (longlong)(*(int *)(*plVar20 + 0x104) + iVar13) * 0x1c);
            if ((puVar10 != (ulonglong *)0x0) &&
               ((local_48 <= puVar10 || (puVar10 + 3 <= &local_60)))) {
              *(undefined4 *)puVar10 = (undefined4)local_60;
              *(undefined4 *)((longlong)puVar10 + 4) = local_60._4_4_;
              *(uint *)(puVar10 + 1) = uStack88;
              *(int *)((longlong)puVar10 + 0xc) = iStack84;
              puVar10[2] = local_50;
            }
            iVar2 = *(int *)(*plVar20 + 0x104) + *(int *)(param_1 + 0x87d8);
          }
          *(undefined4 *)((longlong)iVar2 * 0x1c + 0x1b8 + param_1) = 0;
          param_2 = local_88;
        }
      }
    } while (param_3 < iVar21);
  }
  FUN_18005f100(local_48[0] ^ (ulonglong)&stack0xffffffffffffff18);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180007050(longlong param_1,uint *param_2,int *param_3)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  byte bVar4;
  int iVar5;
  longlong lVar6;
  uint uVar7;
  longlong lVar8;
  longlong lVar9;
  longlong *plVar10;
  ulonglong *puVar11;
  uint uVar12;
  int *piVar13;
  uint uVar14;
  int iVar15;
  uint uVar16;
  ulonglong local_c8;
  int local_c0;
  longlong local_b8;
  int *local_b0;
  longlong *local_a8;
  longlong local_a0;
  longlong local_98;
  longlong local_90;
  uint *local_88;
  longlong local_80;
  undefined8 local_78;
  uint uStack112;
  int iStack108;
  ulonglong local_68;
  int local_60;
  int iStack92;
  int iStack88;
  int iStack84;
  undefined8 local_50;
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffee8;
  local_c0 = *param_3;
  local_90 = (longlong)param_3[1];
  local_80 = *(longlong *)(param_3 + 2);
  local_88 = param_2;
  if (0 < local_90) {
    local_b8 = 0;
    do {
      lVar6 = local_b8;
      iVar1 = *(int *)(local_80 + local_b8 * 4);
      plVar10 = (longlong *)(param_1 + 0x28 + (longlong)iVar1 * 8);
      puVar11 = (ulonglong *)(param_1 + 0x1bc + (longlong)(local_c0 + iVar1) * 0x1c);
      local_a8 = plVar10;
      iVar2 = FUN_18002bd60(local_88,*(uint **)(param_1 + 0x28 + (longlong)iVar1 * 8),puVar11,
                            *(int **)(param_3 + 4),(int *)0x0,(int *)0x0,(int *)0x0,(int *)0x0,0,
                            (int *)0x0);
      if (0xd0 < iVar2) {
        iVar2 = 0x100;
        local_68 = 0x100;
        local_a0 = 0;
        local_50._0_4_ = 0x100;
        local_50 = 0x100;
        local_78 = 0x100;
        uStack112 = 0;
        iStack108 = 0;
        local_60 = 0x100;
        iStack92 = 0;
        iStack88 = 0;
        iStack84 = 0;
        if (puVar11 != (ulonglong *)0x0) {
          FUN_180023cd0((int *)puVar11,&local_60);
        }
        uVar16 = (uint)local_a0;
        local_b0 = (int *)(param_1 + 0x1bc +
                          (longlong)(*(int *)(param_1 + 0x87d8) + local_c0) * 0x1c);
        if (local_b0 == (int *)0x0) {
          local_c8 = (ulonglong)uStack112;
          iVar15 = (int)local_78;
        }
        else {
          lVar6 = (longlong)local_b0[1];
          lVar8 = (longlong)*local_b0;
          uStack112 = (int)((ulonglong)(local_50._4_4_ * lVar6 + lVar8 * iStack88) >> 8) +
                      local_b0[2];
          local_c8 = (ulonglong)uStack112;
          lVar9 = (longlong)local_b0[3];
          local_a0 = (longlong)local_b0[4];
          local_98 = local_a0 * iStack84;
          uVar16 = (int)((ulonglong)(local_a0 * local_50._4_4_ + lVar9 * iStack88) >> 8) +
                   local_b0[5];
          uVar7 = 0x8000;
          iVar2 = (int)((ulonglong)(local_98 + lVar9 * local_60) >> 8) -
                  (int)((ulonglong)((int)local_50 * lVar6 + lVar8 * iStack92) >> 8) >> 1;
          iVar15 = (int)((ulonglong)(local_a0 * (int)local_50 + lVar9 * iStack92) >> 8) +
                   (int)((ulonglong)(iStack84 * lVar6 + lVar8 * local_60) >> 8) >> 1;
          bVar4 = 0xf;
          local_68 = (ulonglong)uVar16 << 0x20;
          uVar12 = iVar2 * iVar2 + iVar15 * iVar15;
          local_78._4_4_ = uVar12;
          uVar14 = 0;
          if (1 < uVar12) {
            do {
              uVar3 = uVar7 + uVar14 * 2 << (bVar4 & 0x1f);
              bVar4 = bVar4 - 1;
              local_78._4_4_ = uVar14;
              if (uVar3 <= uVar12) {
                local_78._4_4_ = uVar14 + uVar7;
                uVar12 = uVar12 - uVar3;
              }
              uVar7 = uVar7 >> 1;
              uVar14 = local_78._4_4_;
            } while (uVar7 != 0);
          }
          lVar6 = local_b8;
          plVar10 = local_a8;
          if (local_78._4_4_ == 0) {
            iVar15 = 0x100;
            local_78._4_4_ = 0;
            local_78 = 0x100;
            local_68 = CONCAT44(uVar16,0x100);
            iStack108 = 0;
            iVar2 = 0x100;
          }
          else {
            local_78 = (longlong)(((int)local_78._4_4_ >> 1) + iVar15 * 0x100) /
                       (longlong)(int)local_78._4_4_ & 0xffffffff;
            iVar15 = (int)local_78;
            local_68 = local_68 | local_78;
            local_78._4_4_ = (((int)local_78._4_4_ >> 1) + iVar2 * -0x100) / (int)local_78._4_4_;
            local_78 = local_78 | (ulonglong)local_78._4_4_ << 0x20;
            iStack108 = -local_78._4_4_;
            iVar2 = iVar15;
          }
        }
        *(undefined4 *)(*plVar10 + 0x100) = 1;
        iVar5 = *(int *)(param_1 + 0x87d8);
        if (iVar1 < iVar5) {
          piVar13 = (int *)(param_1 + 0x1bc +
                           (longlong)
                           (*(int *)(*(longlong *)(param_1 + 0x28 + (longlong)iVar5 * 8) + 0x104) +
                           iVar1) * 0x1c);
          if (piVar13 != (int *)0x0) {
            local_b8 = (longlong)iVar15;
            local_98 = (longlong)(int)local_78._4_4_;
            local_a8 = (longlong *)(longlong)(int)uStack112;
            local_b0 = (int *)(longlong)(int)uVar16;
            iVar5 = iVar15 * iVar2 - local_78._4_4_ * iStack108;
            if (iVar5 == 0) {
              piVar13[2] = (int)local_c8;
              *piVar13 = iVar15;
              piVar13[1] = local_78._4_4_;
              piVar13[3] = iStack108;
              piVar13[4] = iVar2;
              piVar13[5] = uVar16;
            }
            else {
              lVar8 = (longlong)iVar5;
              *piVar13 = (int)(((longlong)iVar2 << 0x10) / lVar8);
              piVar13[1] = (int)((local_98 * -0x10000) / lVar8);
              piVar13[2] = (int)((((longlong)local_b0 * local_98 -
                                  (longlong)iVar2 * (longlong)local_a8) * 0x100) / lVar8);
              piVar13[3] = (int)(((longlong)iStack108 * -0x10000) / lVar8);
              piVar13[4] = (int)((local_b8 << 0x10) / lVar8);
              piVar13[5] = (int)((((longlong)iStack108 * (longlong)local_a8 -
                                  (longlong)local_b0 * local_b8) * 0x100) / lVar8);
            }
          }
          iVar2 = *(int *)(*(longlong *)(param_1 + 0x28 + (longlong)*(int *)(param_1 + 0x87d8) * 8)
                          + 0x104) + iVar1;
        }
        else {
          piVar13 = (int *)(param_1 + 0x1bc + (longlong)(*(int *)(*plVar10 + 0x104) + iVar5) * 0x1c)
          ;
          if ((piVar13 != (int *)0x0) && ((&local_60 <= piVar13 || (piVar13 + 6 <= &local_78)))) {
            *piVar13 = (int)local_78;
            piVar13[1] = local_78._4_4_;
            piVar13[2] = uStack112;
            piVar13[3] = iStack108;
            *(ulonglong *)(piVar13 + 4) = local_68;
          }
          iVar2 = *(int *)(*plVar10 + 0x104) + *(int *)(param_1 + 0x87d8);
        }
        *(undefined4 *)((longlong)iVar2 * 0x1c + 0x1b8 + param_1) = 0;
        FUN_180006300(param_1,(int *)&local_78,iVar1,*(int **)(param_3 + 4),param_3[6]);
        FUN_180006be0(param_1,(int *)&local_78,iVar1,*(int **)(param_3 + 4),param_3[6]);
      }
      local_b8 = lVar6 + 1;
    } while (local_b8 < local_90);
  }
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xfffffffffffffee8);
  return;
}



void FUN_1800076d0(longlong param_1,uint *param_2,int *param_3)

{
  int *piVar1;
  int iVar2;
  uint *puVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  longlong *plVar9;
  longlong lVar10;
  ulonglong uVar11;
  uint *puVar12;
  uint uVar13;
  longlong lVar14;
  int iVar15;
  int iVar16;
  ulonglong *puVar17;
  uint *local_a28;
  int local_a20;
  int local_a1c;
  int local_a18 [516];
  ulonglong local_208;
  ulonglong uStack512;
  ulonglong local_1f8;
  ulonglong local_1f0;
  uint local_1e8 [52];
  uint local_118 [52];
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffff588;
  lVar10 = (longlong)param_3[1];
  puVar3 = *(uint **)(param_3 + 2);
  uVar7 = 0;
  iVar6 = 0;
  if (0 < lVar10) {
    puVar12 = local_118;
    uVar8 = uVar7;
    uVar11 = uVar7;
    do {
      if (*(int *)(*(longlong *)(param_1 + 0x28 + (longlong)(int)puVar3[uVar8] * 8) + 0x100) == 1) {
        uVar11 = (ulonglong)((int)uVar11 + 1);
        *puVar12 = puVar3[uVar8];
        puVar12 = puVar12 + 1;
      }
      iVar6 = (int)uVar11;
      uVar8 = uVar8 + 1;
    } while ((longlong)uVar8 < lVar10);
  }
  local_1f8 = 0x100;
  local_208 = 0x100;
  uStack512 = 0;
  local_a28 = param_2;
  if (iVar6 < 1) {
    if (*(int *)(param_1 + 0x87e4) == 0) {
      iVar6 = *param_3;
      uVar13 = *puVar3;
      if (1 < lVar10) {
        lVar14 = 1;
        do {
          iVar2 = *(int *)((longlong)(int)(uVar13 + iVar6) * 0x1c + 0x1b8 + param_1);
          piVar1 = (int *)((longlong)(int)(iVar6 + puVar3[lVar14]) * 0x1c + 0x1b8 + param_1);
          uVar4 = puVar3[lVar14];
          if (*piVar1 == iVar2 || *piVar1 < iVar2) {
            uVar4 = uVar13;
          }
          uVar13 = uVar4;
          lVar14 = lVar14 + 1;
        } while (lVar14 < lVar10);
      }
      lVar14 = (longlong)(int)(uVar13 + iVar6) * 0x1c;
      if (5 < *(int *)(lVar14 + 0x1b8 + param_1)) {
        puVar17 = (ulonglong *)(param_1 + 0x1bc + lVar14);
        lVar14 = param_1 + (longlong)(int)uVar13 * 8;
        iVar6 = FUN_18002bd60(param_2,*(uint **)(lVar14 + 0x28),puVar17,*(int **)(param_3 + 4),
                              (int *)0x0,(int *)0x0,(int *)0x0,(int *)0x0,0,(int *)0x0);
        if (param_3[6] < iVar6) {
          *(uint *)(param_1 + 0x87d8) = uVar13;
          local_a28[0x40] = 1;
          *(undefined4 *)(*(longlong *)(lVar14 + 0x28) + 0x100) = 1;
          *(undefined4 *)(param_1 + 0x87e4) = 1;
          if ((puVar17 != (ulonglong *)0x0) &&
             ((puVar17 + 3 <= &local_208 || (&local_1f0 <= puVar17)))) {
            local_208 = *puVar17;
            uStack512 = puVar17[1];
            local_1f8 = puVar17[2];
          }
          param_3[7] = param_3[7] + (uVar13 & 0xff) * 0x100 + 0x100;
        }
      }
    }
  }
  else {
    param_3[1] = iVar6;
    *(uint **)(param_3 + 2) = local_118;
    FUN_180005c80(0x100,param_1);
  }
  if (0 < lVar10) {
    uVar11 = 0;
    puVar12 = local_1e8;
    uVar13 = 0;
    uVar8 = uVar11;
    do {
      if (*(int *)(*(longlong *)(param_1 + 0x28 + (longlong)(int)puVar3[uVar8] * 8) + 0x100) == 0) {
        uVar7 = (ulonglong)((int)uVar7 + 1);
        *puVar12 = puVar3[uVar8];
        puVar12 = puVar12 + 1;
      }
      uVar8 = uVar8 + 1;
    } while ((longlong)uVar8 < lVar10);
    iVar6 = (int)uVar7;
    if (0 < iVar6) {
      param_3[1] = iVar6;
      *(uint **)(param_3 + 2) = local_1e8;
      if ((*(int *)(param_1 + 0x87e4) == 0) || (local_a28[0x40] == 0)) {
        local_a1c = *(int *)(param_1 + 8);
        local_a20 = *(int *)(param_1 + 4);
        iVar2 = *param_3;
        iVar15 = local_a1c * local_a20;
        uVar7 = uVar11;
        iVar16 = iVar15;
        if (0 < (longlong)iVar6) {
          do {
            iVar5 = FUN_18002bd60(local_a28,
                                  *(uint **)(param_1 + 0x28 + (longlong)(int)local_1e8[uVar11] * 8),
                                  (ulonglong *)
                                  (param_1 + 0x1bc +
                                  (longlong)(int)(local_1e8[uVar11] + iVar2) * 0x1c),
                                  *(int **)(param_3 + 4),(int *)0x0,(int *)0x0,(int *)0x0,(int *)0x0
                                  ,0,(int *)0x0);
            if (param_3[6] < iVar5) {
              uVar8 = FUN_18002d430(local_a1c,local_a20,local_a1c,local_a20,
                                    (int *)(param_1 + 0x1bc +
                                           (longlong)(int)(local_1e8[uVar11] + iVar2) * 0x1c),
                                    local_a18);
              iVar5 = iVar15 - (int)uVar8;
              if (iVar5 < iVar16) {
                uVar7 = (ulonglong)local_1e8[uVar11];
                iVar16 = iVar5;
              }
            }
            uVar13 = (uint)uVar7;
            uVar11 = uVar11 + 1;
          } while ((longlong)uVar11 < (longlong)iVar6);
        }
        param_3[8] = iVar16;
        param_3[7] = param_3[7] + (uVar13 & 0xff) * 0x100 + 0x100;
      }
      else {
        FUN_180007050(param_1,local_a28,param_3);
      }
    }
  }
  if ((*(int *)(param_1 + 0x87e4) == 1) && (local_a28[0x40] != 0)) {
    iVar6 = FUN_180016b60(param_1,(longlong)local_a28,(int *)&local_208,
                          *(int *)(param_1 + 0x1c) + -1);
    param_3[8] = iVar6;
    if (*(int *)(param_1 + 0xc) != 0) {
      param_3[8] = iVar6 * 4;
    }
  }
  iVar6 = *(int *)(param_1 + 0x1c) + -1;
  lVar10 = (longlong)iVar6;
  if (0 < iVar6) {
    plVar9 = (longlong *)(param_1 + 0x20 + lVar10 * 8);
    do {
      if (*(int *)(*plVar9 + 0x114) != 5) {
        if ((-1 < iVar6 + -1) &&
           (lVar10 = (longlong)(*param_3 + iVar6 + -1) * 0x1c,
           5 < *(int *)(lVar10 + param_1 + 0x1b8))) {
          iVar6 = *(int *)(param_1 + 8);
          iVar2 = *(int *)(param_1 + 4);
          uVar7 = FUN_18002d430(iVar6,iVar2,iVar6,iVar2,(int *)(lVar10 + 4 + param_1 + 0x1b8),
                                local_a18);
          param_3[7] = ((iVar2 * iVar6 - (int)uVar7) * 100) / (iVar2 * iVar6 + 1) << 0x18 ^
                       param_3[7] & 0xffffffU;
        }
        break;
      }
      iVar6 = iVar6 + -1;
      lVar10 = lVar10 + -1;
      plVar9 = plVar9 + -1;
    } while (0 < lVar10);
  }
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xfffffffffffff588);
  return;
}



void FUN_180007bc0(int *param_1,undefined4 *param_2,uint *param_3)

{
  uint uVar1;
  uint uVar2;
  undefined4 *puVar3;
  longlong lVar4;
  uint uVar5;
  ulonglong uVar6;
  uint *puVar7;
  longlong lVar8;
  int iVar9;
  undefined auStack392 [32];
  int *local_168;
  int local_158;
  uint local_154;
  uint local_150;
  undefined8 local_14c;
  uint local_140;
  int local_13c;
  undefined *local_138;
  uint *local_130;
  uint local_128;
  int local_124;
  int local_120;
  undefined local_118 [208];
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)auStack392;
  local_150 = param_3[3];
  uVar6 = 0;
  local_14c = 0;
  if ((*param_3 < 9) && ((0x132U >> (*param_3 & 0x1f) & 1) != 0)) {
    local_14c = 4;
  }
  local_154 = param_3[1];
  uVar1 = param_3[8];
  uVar5 = param_3[2];
  uVar2 = param_3[7];
  if (uVar2 < uVar1) {
    if (param_2[0x3c] == 0) {
      *param_1 = 0;
    }
    else {
      if (uVar2 == 0) {
        puVar3 = *(undefined4 **)(param_3 + 10);
        local_130 = (uint *)0x100;
        FUN_180005390(param_2,puVar3,param_3[5]);
        param_3[(ulonglong)param_3[9] * 7 + 0x6e] = 0xffffffff;
        puVar7 = param_3 + (ulonglong)param_3[9] * 7 + 0x6f;
        if ((puVar7 != (uint *)0x0) && ((&local_128 <= puVar7 || (puVar7 + 6 <= &local_140)))) {
          *puVar7 = 0x100;
          puVar7[1] = 0;
          puVar7[2] = 0;
          puVar7[3] = 0;
          *(uint **)(puVar7 + 4) = local_130;
        }
        param_3[9] = param_3[9] + 1;
        iVar9 = 0x64000064;
        *(undefined4 *)(*(longlong *)(param_3 + (ulonglong)param_3[7] * 2 + 10) + 0x108) =
             puVar3[0x42];
        *(undefined4 *)(*(longlong *)(param_3 + (ulonglong)param_3[7] * 2 + 10) + 0x10c) =
             puVar3[0x43];
        *(undefined4 *)(*(longlong *)(param_3 + (ulonglong)param_3[7] * 2 + 10) + 0x114) = 0;
        *(undefined4 *)(*(longlong *)(param_3 + (ulonglong)param_3[7] * 2 + 10) + 0x11c) = 0;
        *(undefined4 *)(*(longlong *)(param_3 + (ulonglong)param_3[7] * 2 + 10) + 0x120) = 0;
        *(undefined4 *)(*(longlong *)(param_3 + (ulonglong)param_3[7] * 2 + 10) + 0x124) = 0;
        *(undefined8 *)(*(longlong *)(param_3 + (ulonglong)param_3[7] * 2 + 10) + 0x140) = 0;
        param_3[7] = param_3[7] + 1;
      }
      else {
        puVar7 = *(uint **)(param_3 + (ulonglong)uVar2 * 2 + 10);
        uVar2 = param_3[9];
        local_158 = 0;
        FUN_180005390(param_2,puVar7,param_3[5]);
        puVar7[0x41] = uVar2;
        puVar7[0x45] = 0;
        puVar7[0x47] = param_3[7];
        local_168 = &local_158;
        *(undefined8 *)(puVar7 + 0x48) = 0;
        *(undefined8 *)(puVar7 + 0x50) = 0;
        param_3[7] = param_3[7] + 1;
        FUN_1800057a0(param_3,puVar7,&local_150,local_118);
        if (local_158 < 1) {
          iVar9 = 0x64000064;
        }
        else {
          iVar9 = uVar5 * local_154;
          local_13c = local_158;
          local_138 = local_118;
          local_130 = &local_150;
          local_128 = 0xcd;
          local_124 = 0x64000000;
          local_140 = uVar2;
          local_120 = iVar9;
          FUN_1800076d0((longlong)param_3,puVar7,(int *)&local_140);
          iVar9 = (local_120 * 100) / (iVar9 + 1) + local_124;
        }
      }
      if (param_3[7] != 0) {
        do {
          param_3[uVar6 + 0x21fa] = (uint)uVar6;
          uVar5 = (uint)uVar6 + 1;
          uVar6 = (ulonglong)uVar5;
        } while (uVar5 < param_3[7]);
      }
      lVar8 = (longlong)(int)param_3[7];
      if (lVar8 < (int)uVar1) {
        lVar4 = (int)uVar1 - lVar8;
        puVar7 = param_3 + lVar8 + 0x21fa;
        while (lVar4 != 0) {
          lVar4 = lVar4 + -1;
          *puVar7 = 0xffffffff;
          puVar7 = puVar7 + 1;
        }
      }
      *param_1 = iVar9;
      if ((param_3[7] == param_3[8]) && (FUN_18002e530((longlong)param_3,0), 1 < *param_3 - 9)) {
        FUN_180017490((longlong)param_3);
      }
    }
  }
  else {
    *param_1 = 0;
  }
  FUN_18005f100(local_48 ^ (ulonglong)auStack392);
  return;
}



void FUN_180007f10(undefined4 *param_1,int param_2)

{
  undefined4 local_78;
  undefined4 uStack116;
  undefined4 uStack112;
  undefined4 uStack108;
  undefined4 local_68;
  undefined4 uStack100;
  ulonglong local_60 [2];
  undefined4 local_50;
  undefined4 uStack76;
  ulonglong local_48 [2];
  undefined4 local_38;
  undefined4 uStack52;
  ulonglong local_30 [2];
  undefined4 local_20;
  undefined4 uStack28;
  ulonglong local_18 [2];

  local_18[0] = DAT_1800b04e8 ^ (ulonglong)&local_78;
  uStack100 = 4;
  local_50 = 0x14;
  uStack76 = 4;
  local_38 = 0x14;
  uStack52 = 6;
  local_20 = 0x14;
  uStack28 = 6;
  uStack108 = 300;
  if (param_2 == 9) {
    if ((local_18 <= &local_78) || (local_60 <= local_30)) {
      uStack108 = 600;
      uStack100 = 6;
    }
  }
  else {
    if (param_2 == 10) {
      if ((local_30 <= &local_78) || (local_60 <= local_48)) {
        uStack100 = 6;
        uStack108 = 600;
      }
    }
    else {
      uStack100 = 4;
      uStack108 = 300;
    }
  }
  local_68 = 0x14;
  uStack112 = 0x14;
  uStack116 = 0x1e;
  local_78 = 0x14;
  param_1[3] = 0x14;
  param_1[4] = uStack108;
  param_1[5] = 0x14;
  param_1[6] = uStack100;
  *(undefined8 *)(param_1 + 7) = 0;
  *(undefined8 *)(param_1 + 9) = 0;
  param_1[0xb] = 0;
  *(undefined8 *)(param_1 + 0xf) = 0;
  param_1[0x11] = 0;
  param_1[1] = 0x14;
  param_1[2] = 0x1e;
  *param_1 = 0xffff0000;
  param_1[0xd] = 0x14;
  param_1[0xe] = 0x1e;
  FUN_18005f100(local_18[0] ^ (ulonglong)&local_78);
  return;
}



undefined8
FUN_180008060(longlong param_1,longlong param_2,int param_3,int param_4,int param_5,int param_6,
             undefined4 *param_7,undefined4 *param_8)

{
  ushort uVar1;
  int iVar2;
  int iVar3;
  int iVar4;

  uVar1 = *(ushort *)(param_1 + 0x1c);
  iVar4 = 100;
  iVar3 = 100;
  if (*(int *)(param_2 + 0x24) < *(int *)(param_2 + 0x18)) {
    iVar4 = param_6;
    iVar3 = param_5;
  }
  iVar2 = *(int *)(param_2 + 0x44);
  if (*(int *)(param_2 + 0x40) < 9) {
    iVar3 = iVar4 + 5;
    if (iVar2 <= *(int *)(param_2 + 4)) {
      iVar3 = iVar4;
    }
    if ((iVar3 < param_4) && (uVar1 != 0)) {
      *(undefined4 *)(*(longlong *)(param_1 + 0x20 + (ulonglong)uVar1 * 8) + 0x114) = 5;
      *(int *)(param_2 + 0x44) = *(int *)(param_2 + 0x44) + 1;
      *(int *)(param_2 + 0x3c) = *(int *)(param_2 + 0x3c) + 1;
      *(int *)(param_2 + 0x24) = *(int *)(param_2 + 0x24) + 1;
      *(int *)(param_2 + 0x38) = *(int *)(param_2 + 0x38) + -1;
      *param_8 = 1;
      goto LAB_18000814e;
    }
  }
  else {
    if (*(int *)(param_2 + 4) < iVar2) {
      iVar4 = iVar4 + 5;
      iVar3 = iVar3 + 5;
    }
    if (((iVar4 < param_4) && (iVar3 < param_3)) && (uVar1 != 0)) {
      *(undefined4 *)(*(longlong *)(param_1 + 0x20 + (ulonglong)uVar1 * 8) + 0x114) = 5;
      *(int *)(param_2 + 0x44) = *(int *)(param_2 + 0x44) + 1;
      *(int *)(param_2 + 0x3c) = *(int *)(param_2 + 0x3c) + 1;
      *(int *)(param_2 + 0x24) = *(int *)(param_2 + 0x24) + 1;
      *(int *)(param_2 + 0x38) = *(int *)(param_2 + 0x38) + -1;
      *param_8 = 2;
      goto LAB_18000814e;
    }
  }
  *(int *)(param_2 + 0x3c) = *(int *)(param_2 + 0x3c) + 1;
  *(int *)(param_2 + 0x34) = *(int *)(param_2 + 0x34) + -1;
  *(int *)(param_2 + 0x38) = *(int *)(param_2 + 0x38) + -1;
  *(int *)(param_2 + 0x40) = *(int *)(param_2 + 0x40) + 1;
  *(int *)(param_2 + 0x44) = iVar2 + 1;
  *(undefined4 *)(param_2 + 0x24) = 0;
  *param_8 = 0;
LAB_18000814e:
  *param_7 = 3;
  return 0;
}



ulonglong FUN_1800083c0(longlong param_1)

{
  byte *pbVar1;
  uint uVar2;
  ulonglong uVar3;
  byte *pbVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;

  iVar7 = *(int *)(param_1 + 0xc);
  pbVar4 = *(byte **)(param_1 + 0x18);
  iVar5 = 0;
  iVar6 = 0;
  iVar8 = 0;
  if (1 < iVar7) {
    uVar2 = (iVar7 - 2U >> 1) + 1;
    uVar3 = (ulonglong)uVar2;
    iVar7 = iVar7 + uVar2 * -2;
    do {
      iVar5 = iVar5 + *(int *)(&DAT_18007caf0 + (ulonglong)*pbVar4 * 4);
      pbVar1 = pbVar4 + 1;
      pbVar4 = pbVar4 + 2;
      iVar6 = iVar6 + *(int *)(&DAT_18007caf0 + (ulonglong)*pbVar1 * 4);
      uVar3 = uVar3 - 1;
    } while (uVar3 != 0);
  }
  if (0 < iVar7) {
    iVar8 = *(int *)(&DAT_18007caf0 + (ulonglong)*pbVar4 * 4);
  }
  return (ulonglong)(uint)(iVar6 + iVar5 + iVar8);
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180008440(void)

{
  undefined local_28 [16];
  undefined8 local_18;
  ulonglong local_10 [2];

  local_10[0] = DAT_1800b04e8 ^ (ulonglong)local_28;
  local_18 = 0x100;
  if ((local_10 < (ulonglong *)0x9) || ((undefined *)0x1f < local_28)) {
    _DAT_00000008 = 0x100;
    _DAT_0000000c = 0;
    _DAT_00000010 = 0;
    _DAT_00000014 = 0;
    _DAT_00000018 = 0x100;
  }
  FUN_18005f100(local_10[0] ^ (ulonglong)local_28);
  uRam0000000000000000 = 0;
  _DAT_00000004 = 0;
  return;
}



undefined8 FUN_1800084b0(int *param_1,undefined4 *param_2)

{
  int iVar1;
  int iVar2;
  short sVar3;
  uint uVar4;
  ulonglong uVar5;
  byte bVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint local_res8 [4];
  uint local_res18 [4];

  if ((param_1 != (int *)0x0) && (param_2 != (undefined4 *)0x0)) {
    iVar1 = *param_1;
    uVar10 = 0;
    iVar2 = param_1[3];
    bVar6 = 0xf;
    uVar8 = iVar2 * iVar2 + iVar1 * iVar1;
    uVar4 = 0x8000;
    uVar9 = uVar8;
    if (1 < uVar8) {
      do {
        uVar7 = uVar4 + uVar10 * 2 << (bVar6 & 0x1f);
        bVar6 = bVar6 - 1;
        uVar8 = uVar10;
        if (uVar7 <= uVar9) {
          uVar8 = uVar10 + uVar4;
          uVar9 = uVar9 - uVar7;
        }
        uVar4 = uVar4 >> 1;
        uVar10 = uVar8;
      } while (uVar4 != 0);
    }
    local_res8[0] = (iVar1 << 8) / (int)(uVar8 + 1);
    local_res18[0] = (iVar2 << 8) / (int)(uVar8 + 1);
    uVar5 = FUN_1800350d0(local_res18,local_res8);
    sVar3 = (short)uVar5;
    if (sVar3 < 0) {
      sVar3 = sVar3 + 0x6488;
    }
    *param_2 = (int)((ulonglong)((longlong)sVar3 * 0x395) >> 0x10);
    return 0;
  }
  return 0x80000002;
}



void FUN_180008580(uint **param_1,int param_2,ulonglong param_3)

{
  char cVar1;
  uint *puVar2;
  longlong lVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  undefined *puVar6;
  char *pcVar7;
  uint uVar8;
  uint uVar9;
  int iVar10;
  uint *puVar11;
  undefined *puVar12;
  ulonglong uVar13;
  uint uVar14;

  puVar2 = param_1[3];
  uVar14 = param_2 + 7 >> 3;
  uVar8 = param_2 >> 3;
  uVar5 = param_3 & 0xffffffff;
  if (puVar2 == (uint *)0x0) {
    puVar2 = (uint *)malloc(0x1e7a0);
    param_1[3] = puVar2;
  }
  *param_1 = puVar2;
  param_1[4] = puVar2 + 8;
  param_1[5] = puVar2 + 0x260;
  puVar11 = puVar2 + 0x4b8;
  *(uint **)(puVar2 + 6) = puVar11;
  if (puVar11 != (uint *)0x0) {
    lVar3 = 120000;
    while (lVar3 != 0) {
      lVar3 = lVar3 + -1;
      *(undefined *)puVar11 = 0;
      puVar11 = (uint *)((longlong)puVar11 + 1);
    }
  }
  puVar6 = *(undefined **)(puVar2 + 6);
  *puVar2 = uVar14;
  uVar9 = (uint)uVar5;
  puVar2[1] = uVar9;
  puVar2[2] = 100;
  puVar2[3] = 120000;
  puVar2[4] = 1;
  uVar13 = uVar5;
  if (0 < (int)uVar9) {
    do {
      if ((puVar6 != (undefined *)0x0) && (uVar8 != 0)) {
        uVar4 = (ulonglong)uVar8;
        puVar12 = puVar6;
        while (uVar4 != 0) {
          uVar4 = uVar4 - 1;
          *puVar12 = 0xff;
          puVar12 = puVar12 + 1;
        }
      }
      puVar6 = puVar6 + 100;
      uVar13 = uVar13 - 1;
    } while (uVar13 != 0);
  }
  if (uVar8 != uVar14) {
    iVar10 = param_2 + uVar8 * -8;
    cVar1 = '\x01';
    if (1 < iVar10) {
      uVar13 = (ulonglong)(iVar10 - 1);
      do {
        cVar1 = cVar1 * '\x02' + '\x01';
        uVar13 = uVar13 - 1;
      } while (uVar13 != 0);
    }
    if (0 < (int)uVar9) {
      pcVar7 = (char *)(*(longlong *)(puVar2 + 6) + (longlong)(int)uVar8);
      do {
        *pcVar7 = cVar1;
        pcVar7 = pcVar7 + 100;
        uVar5 = uVar5 - 1;
      } while (uVar5 != 0);
    }
  }
  return;
}



undefined8 FUN_180008ef0(int *param_1,int *param_2,int *param_3)

{
  int iVar1;
  int iVar2;
  longlong lVar3;
  uint *puVar4;
  int iVar5;

  iVar5 = 0;
  iVar1 = 0;
  if (*param_1 - 9U < 2) {
    puVar4 = (uint *)(param_1 + 0x236d);
    lVar3 = 4;
    if (param_1[0x2380] == 0) {
      do {
        iVar5 = iVar1 + 1;
        if (0x7fffffff < puVar4[-1]) {
          iVar5 = iVar1;
        }
        iVar1 = iVar5 + 1;
        if (0x7fffffff < *puVar4) {
          iVar1 = iVar5;
        }
        iVar5 = iVar1 + 1;
        if (0x7fffffff < puVar4[1]) {
          iVar5 = iVar1;
        }
        iVar2 = iVar5 + 1;
        if (0x7fffffff < puVar4[2]) {
          iVar2 = iVar5;
        }
        iVar1 = iVar2 + 1;
        if (0x7fffffff < puVar4[3]) {
          iVar1 = iVar2;
        }
        lVar3 = lVar3 + -1;
        puVar4 = puVar4 + 5;
      } while (lVar3 != 0);
      *param_2 = iVar1;
      *param_3 = 0;
      return 0;
    }
    do {
      iVar1 = iVar5 + 1;
      if (0x7fffffff < puVar4[-1]) {
        iVar1 = iVar5;
      }
      iVar5 = iVar1 + 1;
      if (0x7fffffff < *puVar4) {
        iVar5 = iVar1;
      }
      iVar1 = iVar5 + 1;
      if (0x7fffffff < puVar4[1]) {
        iVar1 = iVar5;
      }
      iVar2 = iVar1 + 1;
      if (0x7fffffff < puVar4[2]) {
        iVar2 = iVar1;
      }
      iVar5 = iVar2 + 1;
      if (0x7fffffff < puVar4[3]) {
        iVar5 = iVar2;
      }
      lVar3 = lVar3 + -1;
      puVar4 = puVar4 + 5;
    } while (lVar3 != 0);
  }
  else {
    if (param_1[0x2380] == 0) {
      lVar3 = 4;
      puVar4 = (uint *)(param_1 + 0x236d);
      do {
        iVar5 = iVar1 + 1;
        if (0x7fffffff < puVar4[-1]) {
          iVar5 = iVar1;
        }
        iVar1 = iVar5 + 1;
        if (0x7fffffff < *puVar4) {
          iVar1 = iVar5;
        }
        iVar5 = iVar1 + 1;
        if (0x7fffffff < puVar4[1]) {
          iVar5 = iVar1;
        }
        iVar2 = iVar5 + 1;
        if (0x7fffffff < puVar4[2]) {
          iVar2 = iVar5;
        }
        iVar1 = iVar2 + 1;
        if (0x7fffffff < puVar4[3]) {
          iVar1 = iVar2;
        }
        lVar3 = lVar3 + -1;
        puVar4 = puVar4 + 5;
      } while (lVar3 != 0);
      *param_2 = iVar1;
      *param_3 = 0;
      return 0;
    }
  }
  *param_2 = 0;
  *param_3 = iVar5;
  return 0;
}



void FUN_1800090f0(undefined *param_1,undefined *param_2,uint param_3)

{
  longlong lVar1;
  ulonglong uVar2;

  if ((((param_1 != (undefined *)0x0) && (param_2 != (undefined *)0x0)) && (param_3 != 0)) &&
     (((uVar2 = (ulonglong)param_3, param_2 + uVar2 <= param_1 || (param_1 + uVar2 <= param_2)) &&
      (param_3 != 0)))) {
    lVar1 = -(longlong)param_1;
    do {
      *param_1 = (param_2 + lVar1)[(longlong)param_1];
      param_1 = param_1 + 1;
      uVar2 = uVar2 - 1;
    } while (uVar2 != 0);
  }
  return;
}



undefined * FUN_180009140(undefined *param_1,undefined param_2,uint param_3)

{
  ulonglong uVar1;
  undefined *puVar2;

  if ((param_1 != (undefined *)0x0) && (param_3 != 0)) {
    uVar1 = (ulonglong)param_3;
    puVar2 = param_1;
    while (uVar1 != 0) {
      uVar1 = uVar1 - 1;
      *puVar2 = param_2;
      puVar2 = puVar2 + 1;
    }
  }
  return param_1;
}



void FUN_180009170(int *param_1,int *param_2)

{
  int iVar1;
  int local_18;
  int local_14;
  ulonglong local_10;

  local_10 = DAT_1800b04e8 ^ (ulonglong)&local_18;
  iVar1 = 0;
  if ((param_1 != (int *)0x0) && ((param_1 + 1 <= &local_18 || (iVar1 = 0, &local_14 <= param_1))))
  {
    iVar1 = *param_1;
  }
  *param_2 = *param_2 - (iVar1 + 4);
  FUN_18005f100(local_10 ^ (ulonglong)&local_18);
  return;
}



void FUN_180009310(uint **param_1,uint *param_2,undefined8 *param_3,int param_4)

{
  undefined *puVar1;
  ulonglong uVar2;
  uint *puVar3;
  uint uVar4;
  uint local_18;
  uint local_14;
  ulonglong local_10;

  local_10 = DAT_1800b04e8 ^ (ulonglong)&local_18;
  puVar3 = *param_1;
  uVar4 = 0xffff0006;
  if ((puVar3 != (uint *)0x0) && ((puVar3 + 1 <= &local_18 || (&local_14 <= puVar3)))) {
    uVar4 = *puVar3;
  }
  *param_2 = *param_2 - 4;
  puVar3 = puVar3 + 1;
  *param_1 = puVar3;
  if (((uVar4 <= *param_2) && (0 < (int)uVar4)) && ((int)uVar4 <= param_4)) {
    puVar1 = (undefined *)*param_3;
    if ((((puVar1 != (undefined *)0x0) && (puVar3 != (uint *)0x0)) &&
        ((uVar4 != 0 &&
         ((uVar2 = (ulonglong)uVar4, (undefined *)(uVar2 + (longlong)puVar3) <= puVar1 ||
          (puVar1 + uVar2 <= puVar3)))))) && (uVar4 != 0)) {
      puVar3 = (uint *)((longlong)puVar3 - (longlong)puVar1);
      do {
        *puVar1 = *(undefined *)((longlong)puVar3 + (longlong)puVar1);
        puVar1 = puVar1 + 1;
        uVar2 = uVar2 - 1;
      } while (uVar2 != 0);
    }
    *param_1 = (uint *)((longlong)*param_1 + (longlong)(int)uVar4);
    *param_2 = *param_2 - uVar4;
  }
  FUN_18005f100(local_10 ^ (ulonglong)&local_18);
  return;
}



void FUN_1800093f0(undefined *param_1,undefined8 param_2,undefined *param_3)

{
  int *piVar1;
  int iVar2;
  longlong lVar3;
  int *piVar4;
  undefined *puVar5;
  undefined *puVar6;
  longlong lVar7;
  undefined local_18 [4];
  int local_14;
  ulonglong local_10;

  local_10 = DAT_1800b04e8 ^ (ulonglong)local_18;
  piVar1 = (int *)(param_1 + 1);
  *param_1 = 0x94;
  param_1[5] = 0xa1;
  lVar7 = 200;
  piVar4 = (int *)(param_1 + 6);
  if ((piVar4 != (int *)0x0) && ((&local_14 <= piVar4 || (param_1 + 10 <= local_18)))) {
    *piVar4 = 200;
  }
  puVar5 = param_1 + 10;
  if (((puVar5 != (undefined *)0x0) && (param_3 != (undefined *)0x0)) &&
     ((param_3 + 200 <= puVar5 || (param_1 + 0xd2 <= param_3)))) {
    lVar3 = -(longlong)puVar5;
    do {
      *puVar5 = puVar5[(longlong)(param_3 + lVar3)];
      puVar5 = puVar5 + 1;
      lVar7 = lVar7 + -1;
    } while (lVar7 != 0);
  }
  iVar2 = *(int *)(param_3 + 200);
  param_1[0xd2] = 0xa2;
  piVar4 = (int *)(param_1 + 0xd3);
  if ((piVar4 != (int *)0x0) && ((&local_14 <= piVar4 || (param_1 + 0xd7 <= local_18)))) {
    *piVar4 = iVar2;
  }
  lVar7 = 0x40;
  puVar5 = param_3 + 0xcc;
  param_1[0xd7] = 0xa3;
  piVar4 = (int *)(param_1 + 0xd8);
  if ((piVar4 != (int *)0x0) && ((&local_14 <= piVar4 || (param_1 + 0xdc <= local_18)))) {
    *piVar4 = 0x40;
  }
  puVar6 = param_1 + 0xdc;
  if (((puVar6 != (undefined *)0x0) && (puVar5 != (undefined *)0x0)) &&
     ((param_3 + 0x10c <= puVar6 || (param_1 + 0x11c <= puVar5)))) {
    lVar3 = -(longlong)puVar6;
    do {
      *puVar6 = puVar6[(longlong)(puVar5 + lVar3)];
      puVar6 = puVar6 + 1;
      lVar7 = lVar7 + -1;
    } while (lVar7 != 0);
  }
  lVar7 = 0x400;
  puVar5 = param_3 + 0x10c;
  param_1[0x11c] = 0xa4;
  piVar4 = (int *)(param_1 + 0x11d);
  if ((piVar4 != (int *)0x0) && ((&local_14 <= piVar4 || (param_1 + 0x121 <= local_18)))) {
    *piVar4 = 0x400;
  }
  puVar6 = param_1 + 0x121;
  if (((puVar6 != (undefined *)0x0) && (puVar5 != (undefined *)0x0)) &&
     ((param_3 + 0x50c <= puVar6 || (param_1 + 0x521 <= puVar5)))) {
    lVar3 = -(longlong)puVar6;
    do {
      *puVar6 = (puVar5 + lVar3)[(longlong)puVar6];
      puVar6 = puVar6 + 1;
      lVar7 = lVar7 + -1;
    } while (lVar7 != 0);
  }
  iVar2 = *(int *)(param_3 + 0x50c);
  param_1[0x521] = 0xa5;
  piVar4 = (int *)(param_1 + 0x522);
  if ((piVar4 != (int *)0x0) && ((&local_14 <= piVar4 || (param_1 + 0x526 <= local_18)))) {
    *piVar4 = iVar2;
  }
  iVar2 = *(int *)(param_3 + 0x510);
  param_1[0x526] = 0xa6;
  piVar4 = (int *)(param_1 + 0x527);
  if ((piVar4 != (int *)0x0) && ((&local_14 <= piVar4 || (param_1 + 0x52b <= local_18)))) {
    *piVar4 = iVar2;
  }
  iVar2 = *(int *)(param_3 + 0x514);
  param_1[0x52b] = 0xa7;
  piVar4 = (int *)(param_1 + 0x52c);
  if ((piVar4 != (int *)0x0) && ((&local_14 <= piVar4 || (param_1 + 0x530 <= local_18)))) {
    *piVar4 = iVar2;
  }
  iVar2 = *(int *)(param_3 + 0x518);
  param_1[0x530] = 0xa8;
  piVar4 = (int *)(param_1 + 0x531);
  if ((piVar4 != (int *)0x0) && ((&local_14 <= piVar4 || (param_1 + 0x535 <= local_18)))) {
    *piVar4 = iVar2;
  }
  if ((piVar1 != (int *)0x0) && ((&local_14 <= piVar1 || (param_1 + 5 <= local_18)))) {
    *piVar1 = ((int)param_1 - (int)piVar1) + 0x531;
  }
  FUN_18005f100(local_10 ^ (ulonglong)local_18);
  return;
}



void FUN_180009690(undefined *param_1,undefined param_2,uint *param_3)

{
  uint *puVar1;
  uint uVar2;
  undefined *puVar3;
  uint *puVar4;
  undefined *puVar5;
  undefined *puVar6;
  ulonglong uVar7;
  undefined local_18 [4];
  uint local_14;
  ulonglong local_10;

  local_10 = DAT_1800b04e8 ^ (ulonglong)local_18;
  if (param_3 != (uint *)0x0) {
    *param_1 = param_2;
    puVar1 = (uint *)(param_1 + 1);
    uVar2 = *param_3;
    param_1[5] = 0xc1;
    puVar4 = (uint *)(param_1 + 6);
    if ((puVar4 != (uint *)0x0) && ((&local_14 <= puVar4 || (param_1 + 10 <= local_18)))) {
      *puVar4 = uVar2;
    }
    uVar2 = param_3[1];
    param_1[10] = 0xc2;
    puVar4 = (uint *)(param_1 + 0xb);
    if ((puVar4 != (uint *)0x0) && ((&local_14 <= puVar4 || (param_1 + 0xf <= local_18)))) {
      *puVar4 = uVar2;
    }
    uVar2 = param_3[2];
    param_1[0xf] = 0xc3;
    puVar4 = (uint *)(param_1 + 0x10);
    if ((puVar4 != (uint *)0x0) && ((&local_14 <= puVar4 || (param_1 + 0x14 <= local_18)))) {
      *puVar4 = uVar2;
    }
    uVar2 = param_3[4];
    param_1[0x14] = 0xc4;
    puVar4 = (uint *)(param_1 + 0x15);
    if ((puVar4 != (uint *)0x0) && ((&local_14 <= puVar4 || (param_1 + 0x19 <= local_18)))) {
      *puVar4 = uVar2;
    }
    uVar2 = param_3[3];
    uVar7 = (ulonglong)uVar2;
    puVar3 = *(undefined **)(param_3 + 6);
    param_1[0x19] = 0xc5;
    puVar4 = (uint *)(param_1 + 0x1a);
    if ((puVar4 != (uint *)0x0) && ((&local_14 <= puVar4 || (param_1 + 0x1e <= local_18)))) {
      *puVar4 = uVar2;
    }
    puVar6 = param_1 + 0x1e;
    if (((((uVar2 != 0) && (puVar6 != (undefined *)0x0)) && (puVar3 != (undefined *)0x0)) &&
        (uVar2 != 0)) &&
       (((puVar3 + uVar7 <= puVar6 || (puVar6 + uVar7 <= puVar3)) && (uVar2 != 0)))) {
      puVar5 = puVar6;
      do {
        *puVar5 = puVar5[(longlong)(puVar3 + -(longlong)puVar6)];
        puVar5 = puVar5 + 1;
        uVar7 = uVar7 - 1;
      } while (uVar7 != 0);
    }
    if ((puVar1 != (uint *)0x0) && ((&local_14 <= puVar1 || (param_1 + 5 <= local_18)))) {
      *puVar1 = (((int)puVar6 + uVar2) - (int)puVar1) - 4;
    }
  }
  FUN_18005f100(local_10 ^ (ulonglong)local_18);
  return;
}



void FUN_180009830(undefined *param_1,undefined8 param_2,int *param_3,int param_4)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  undefined local_18 [4];
  int local_14;
  ulonglong local_10;

  local_10 = DAT_1800b04e8 ^ (ulonglong)local_18;
  piVar1 = (int *)(param_1 + 1);
  *param_1 = 0x96;
  param_1[5] = 0xe3;
  piVar3 = (int *)(param_1 + 6);
  if ((piVar3 != (int *)0x0) && ((&local_14 <= piVar3 || (param_1 + 10 <= local_18)))) {
    *piVar3 = param_4;
  }
  iVar2 = *param_3;
  param_1[10] = 0xe1;
  piVar3 = (int *)(param_1 + 0xb);
  if ((piVar3 != (int *)0x0) && ((&local_14 <= piVar3 || (param_1 + 0xf <= local_18)))) {
    *piVar3 = iVar2;
  }
  iVar2 = param_3[1];
  param_1[0xf] = 0xe4;
  piVar3 = (int *)(param_1 + 0x10);
  if ((piVar3 != (int *)0x0) && ((&local_14 <= piVar3 || (param_1 + 0x14 <= local_18)))) {
    *piVar3 = iVar2;
  }
  iVar2 = param_3[2];
  param_1[0x14] = 0xe5;
  piVar3 = (int *)(param_1 + 0x15);
  if ((piVar3 != (int *)0x0) && ((&local_14 <= piVar3 || (param_1 + 0x19 <= local_18)))) {
    *piVar3 = iVar2;
  }
  iVar2 = param_3[3];
  param_1[0x19] = 0xe6;
  piVar3 = (int *)(param_1 + 0x1a);
  if ((piVar3 != (int *)0x0) && ((&local_14 <= piVar3 || (param_1 + 0x1e <= local_18)))) {
    *piVar3 = iVar2;
  }
  iVar2 = param_3[4];
  param_1[0x1e] = 0xe7;
  piVar3 = (int *)(param_1 + 0x1f);
  if ((piVar3 != (int *)0x0) && ((&local_14 <= piVar3 || (param_1 + 0x23 <= local_18)))) {
    *piVar3 = iVar2;
  }
  iVar2 = param_3[5];
  param_1[0x23] = 0xe8;
  piVar3 = (int *)(param_1 + 0x24);
  if ((piVar3 != (int *)0x0) && ((&local_14 <= piVar3 || (param_1 + 0x28 <= local_18)))) {
    *piVar3 = iVar2;
  }
  iVar2 = param_3[6];
  param_1[0x28] = 0xe9;
  piVar3 = (int *)(param_1 + 0x29);
  if ((piVar3 != (int *)0x0) && ((&local_14 <= piVar3 || (param_1 + 0x2d <= local_18)))) {
    *piVar3 = iVar2;
  }
  if ((piVar1 != (int *)0x0) && ((&local_14 <= piVar1 || (param_1 + 5 <= local_18)))) {
    *piVar1 = ((int)param_1 - (int)piVar1) + 0x29;
  }
  FUN_18005f100(local_10 ^ (ulonglong)local_18);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_1800099e0(undefined *param_1,undefined8 param_2,int *param_3,uint param_4)

{
  undefined8 *puVar1;
  int *piVar2;
  ushort *puVar3;
  ulonglong *puVar4;
  undefined8 uVar5;
  byte bVar6;
  ushort uVar7;
  int iVar8;
  int iVar9;
  undefined4 uVar10;
  uint *puVar11;
  undefined4 uVar12;
  undefined4 uVar13;
  undefined4 uVar14;
  longlong lVar15;
  undefined *puVar16;
  longlong lVar17;
  int *piVar18;
  uint uVar19;
  byte *pbVar20;
  undefined8 unaff_RBX;
  undefined (*pauVar21) [16];
  undefined8 *puVar22;
  ulonglong uVar23;
  undefined *puVar24;
  undefined8 unaff_RSI;
  undefined8 unaff_RDI;
  undefined8 *puVar25;
  byte bVar26;
  ulonglong uVar27;
  undefined4 *puVar28;
  byte bVar29;
  undefined4 *puVar30;
  uint uVar31;
  longlong lVar32;
  ushort *puVar33;
  longlong lVar34;
  undefined8 *puVar35;
  undefined *puVar36;
  undefined8 unaff_R13;
  short sVar37;
  undefined8 unaff_R14;
  int *piVar38;
  ulonglong uStackX8;
  int *apiStackX16 [3];
  undefined8 local_16d8;
  undefined4 auStack5840 [3];
  undefined local_16c4 [8];
  int aiStack5820 [1433];
  undefined8 local_58;
  undefined8 local_50;
  ulonglong local_48;
  ulonglong local_40 [4];
  undefined8 uStack32;

  uStack32 = 0x1800099f8;
  lVar15 = _alloca_probe();
  lVar15 = -lVar15;
  local_40[0] = DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffe8 + lVar15);
  piVar38 = (int *)(param_1 + 1);
  *(undefined8 *)(&stack0x00001750 + lVar15) = unaff_RBX;
  *param_1 = 0x95;
  puVar36 = param_1 + 5;
  *(undefined8 *)(&stack0x00001720 + lVar15) = unaff_RSI;
  *(undefined8 *)(&stack0x00001708 + lVar15) = unaff_R14;
  puVar11 = *(uint **)(param_3 + 2);
  *(int **)((longlong)apiStackX16 + lVar15 + 0x10) = piVar38;
  *(undefined **)((longlong)apiStackX16 + lVar15 + 8) = puVar36;
  *(undefined8 *)((longlong)&uStack32 + lVar15) = 0x180009a4d;
  puVar16 = (undefined *)
            FUN_180009690(puVar36,0xb2,puVar11,*(undefined *)((longlong)&uStack32 + lVar15));
  puVar11 = *(uint **)(param_3 + 4);
  *(undefined8 *)((longlong)&uStack32 + lVar15) = 0x180009a5b;
  puVar16 = (undefined *)
            FUN_180009690(puVar16,0xcf,puVar11,*(undefined *)((longlong)&uStack32 + lVar15));
  iVar8 = param_3[1];
  piVar18 = param_3 + 10;
  iVar9 = *param_3;
  puVar11 = (uint *)(puVar16 + 1);
  *puVar16 = 0xce;
  uVar31 = (iVar8 + 3U >> 2) * (iVar9 + 3U >> 2) + 7 >> 3;
  uVar23 = (ulonglong)uVar31;
  if ((puVar11 != (uint *)0x0) &&
     ((&stack0x0000002c + lVar15 <= puVar11 || (puVar16 + 5 <= &stack0x00000028 + lVar15)))) {
    *puVar11 = uVar31;
  }
  puVar16 = puVar16 + 5;
  if (((((uVar31 != 0) && (puVar16 != (undefined *)0x0)) && (piVar18 != (int *)0x0)) &&
      (uVar31 != 0)) &&
     (((uVar27 = (ulonglong)uVar31, (undefined *)(uVar23 + (longlong)piVar18) <= puVar16 ||
       (puVar16 + uVar23 <= piVar18)) && (uVar31 != 0)))) {
    puVar24 = puVar16;
    do {
      *puVar24 = puVar24[(longlong)((longlong)piVar18 - (longlong)puVar16)];
      puVar24 = puVar24 + 1;
      uVar27 = uVar27 - 1;
    } while (uVar27 != 0);
  }
  puVar11 = *(uint **)(param_3 + 6);
  puVar16 = puVar16 + uVar23;
  if (puVar11 != (uint *)0x0) {
    *(undefined8 *)((longlong)&uStack32 + lVar15) = 0x180009b0a;
    puVar16 = (undefined *)
              FUN_180009690(puVar16,0xcd,puVar11,*(undefined *)((longlong)&uStack32 + lVar15));
  }
  iVar8 = param_3[0x3c];
  piVar18 = (int *)(puVar16 + 1);
  *puVar16 = 0xb3;
  *(int **)((longlong)apiStackX16 + lVar15) = piVar18;
  if ((piVar18 != (int *)0x0) &&
     ((&stack0x0000002c + lVar15 <= piVar18 || (puVar16 + 5 <= &stack0x00000028 + lVar15)))) {
    *piVar18 = iVar8;
  }
  *(undefined8 *)(&stack0x00001718 + lVar15) = unaff_RDI;
  if ((param_4 < 0x40) && ((0xc0000000000000cdU >> ((longlong)(int)param_4 & 0x3fU) & 1) != 0)) {
    uVar31 = param_3[0x3c];
    if (0 < (int)uVar31) {
      puVar25 = *(undefined8 **)(param_3 + 0x3e);
      pauVar21 = (undefined (*) [16])((longlong)&local_16d8 + 4);
      local_58._0_4_ = *(undefined4 *)(&stack0x00000040 + lVar15);
      local_58._4_4_ = *(undefined4 *)(&stack0x00000044 + lVar15);
      local_50._0_4_ = *(undefined4 *)(&stack0x00000048 + lVar15);
      local_50._4_4_ = *(undefined4 *)(&stack0x0000004c + lVar15);
      sVar37 = *(short *)(&stack0x00000036 + lVar15);
      *(undefined8 *)(&stack0x00001710 + lVar15) = unaff_R13;
      puVar22 = &local_16d8;
      *(undefined4 *)(&stack0x00000028 + lVar15) = 0x10100;
      *(undefined4 *)(&stack0x0000002c + lVar15) = 0x1000001;
      *(ulonglong *)((longlong)&uStackX8 + lVar15) = (ulonglong)uVar31;
      puVar35 = puVar25;
      do {
        lVar32 = 0;
        puVar35 = puVar35 + 7;
        if ((puVar25 != (undefined8 *)0x0) &&
           ((puVar35 <= &stack0x00000030 + lVar15 || (&local_16d8 <= puVar25)))) {
          local_58._0_4_ = *(undefined4 *)(puVar25 + 2);
          local_58._4_4_ = *(undefined4 *)((longlong)puVar25 + 0x14);
          local_50._0_4_ = *(undefined4 *)(puVar25 + 3);
          local_50._4_4_ = *(undefined4 *)((longlong)puVar25 + 0x1c);
          uVar10 = *(undefined4 *)((longlong)puVar25 + 4);
          uVar12 = *(undefined4 *)(puVar25 + 1);
          uVar13 = *(undefined4 *)((longlong)puVar25 + 0xc);
          *(undefined4 *)(&stack0x00000030 + lVar15) = *(undefined4 *)puVar25;
          *(undefined4 *)(&stack0x00000034 + lVar15) = uVar10;
          *(undefined4 *)(&stack0x00000038 + lVar15) = uVar12;
          *(undefined4 *)(&stack0x0000003c + lVar15) = uVar13;
          sVar37 = *(short *)(&stack0x00000036 + lVar15);
          uVar10 = *(undefined4 *)(puVar25 + 4);
          uVar12 = *(undefined4 *)((longlong)puVar25 + 0x24);
          uVar13 = *(undefined4 *)(puVar25 + 5);
          uVar14 = *(undefined4 *)((longlong)puVar25 + 0x2c);
          *(undefined4 *)(&stack0x00000040 + lVar15) = (undefined4)local_58;
          *(undefined4 *)(&stack0x00000044 + lVar15) = local_58._4_4_;
          *(undefined4 *)(&stack0x00000048 + lVar15) = (undefined4)local_50;
          *(undefined4 *)(&stack0x0000004c + lVar15) = local_50._4_4_;
          uVar5 = puVar25[6];
          *(undefined4 *)(&stack0x00000050 + lVar15) = uVar10;
          *(undefined4 *)(&stack0x00000054 + lVar15) = uVar12;
          *(undefined4 *)(&stack0x00000058 + lVar15) = uVar13;
          *(undefined4 *)(&stack0x0000005c + lVar15) = uVar14;
          *(undefined8 *)(&stack0x00000060 + lVar15) = uVar5;
        }
        local_58 = 0;
        pbVar20 = (byte *)((longlong)&local_58 + 1);
        local_50 = 0;
        local_48 = 0;
        lVar34 = 8;
        do {
          lVar17 = lVar32 >> 1;
          bVar6 = (&stack0x00000048)[lVar17 + lVar15];
          bVar26 = (&stack0x00000040)[lVar17 + lVar15];
          bVar29 = (bVar6 ^ bVar26) & 0xf ^ bVar6;
          bVar26 = (bVar6 ^ bVar26) & 0xf ^ bVar26;
          if ((&stack0x00000028)[lVar17 + lVar15] == '\0') {
            pbVar20[-1] = bVar29;
            *pbVar20 = bVar26;
          }
          else {
            pbVar20[-1] = bVar26;
            *pbVar20 = bVar29;
          }
          lVar32 = lVar32 + 2;
          pbVar20 = pbVar20 + 2;
          lVar34 = lVar34 + -1;
        } while (lVar34 != 0);
        local_48 = local_48 & 0xffffffff00000000 | (ulonglong)*(uint *)(&stack0x00000050 + lVar15);
        if ((local_40 <= &stack0x00000040 + lVar15) || (&stack0x00000058 + lVar15 <= &local_58)) {
          *(undefined4 *)(&stack0x00000040 + lVar15) = (undefined4)local_58;
          *(undefined4 *)(&stack0x00000044 + lVar15) = local_58._4_4_;
          *(undefined4 *)(&stack0x00000048 + lVar15) = (undefined4)local_50;
          *(undefined4 *)(&stack0x0000004c + lVar15) = local_50._4_4_;
          *(ulonglong *)(&stack0x00000050 + lVar15) = local_48;
        }
        if (sVar37 < 0) {
          uVar19 = (uint)(byte)((char)((uint)-(int)sVar37 >> 8) + 0x80);
        }
        else {
          uVar19 = (uint)(ushort)(sVar37 >> 8);
        }
        *(uint *)puVar22 =
             ((uint)*(ushort *)(&stack0x00000032 + lVar15) << 0xc |
             (uint)*(ushort *)(&stack0x00000034 + lVar15)) << 4 | uVar19 & 0xff;
        if ((pauVar21 != (undefined (*) [16])0x0) &&
           (((undefined (*) [16])(&stack0x00000054 + lVar15) <= pauVar21 ||
            (pauVar21[1] + 4 <= &stack0x00000040 + lVar15)))) {
          uVar10 = *(undefined4 *)(&stack0x00000050 + lVar15);
          *pauVar21 = CONCAT412(local_50._4_4_,
                                CONCAT48((undefined4)local_50,
                                         CONCAT44(local_58._4_4_,(undefined4)local_58)));
          *(undefined4 *)pauVar21[1] = uVar10;
        }
        puVar1 = (undefined8 *)(pauVar21[1] + 4);
        if ((puVar1 != (undefined8 *)0x0) &&
           ((&stack0x00000060 + lVar15 <= puVar1 || (pauVar21[1] + 0xc <= &stack0x00000058 + lVar15)
            ))) {
          *puVar1 = *(undefined8 *)(&stack0x00000058 + lVar15);
        }
        puVar25 = puVar25 + 7;
        pauVar21 = pauVar21[2];
        puVar22 = puVar22 + 4;
        puVar4 = (ulonglong *)((longlong)&uStackX8 + lVar15);
        *puVar4 = *puVar4 - 1;
      } while (*puVar4 != 0);
      piVar18 = *(int **)((longlong)apiStackX16 + lVar15);
      puVar36 = *(undefined **)((longlong)apiStackX16 + lVar15 + 8);
    }
    uVar31 = uVar31 << 5;
    uVar23 = (ulonglong)uVar31;
    puVar11 = (uint *)((longlong)piVar18 + 5);
    *(undefined *)(piVar18 + 1) = 0xb4;
    if ((puVar11 != (uint *)0x0) &&
       ((&stack0x0000002c + lVar15 <= puVar11 ||
        ((undefined *)((longlong)piVar18 + 9) <= &stack0x00000028 + lVar15)))) {
      *puVar11 = uVar31;
    }
    puVar22 = (undefined8 *)((longlong)piVar18 + 9);
    if ((((uVar31 != 0) && (puVar22 != (undefined8 *)0x0)) && (uVar31 != 0)) &&
       ((((undefined8 *)((longlong)auStack5840 + ((ulonglong)uVar31 - 8)) <= puVar22 ||
         ((undefined8 *)((longlong)puVar22 + uVar23) <= &local_16d8)) && (uVar31 != 0)))) {
      *(undefined8 *)((longlong)&uStack32 + lVar15) = 0x180009ddb;
      memcpy_FUN_180061f90
                (puVar22,&local_16d8,(ulonglong)uVar31,*(undefined *)((longlong)&uStack32 + lVar15))
      ;
    }
    piVar38 = *(int **)((longlong)apiStackX16 + lVar15 + 0x10);
    goto LAB_18000a029;
  }
  uVar31 = param_3[0x3c];
  uVar23 = (ulonglong)uVar31;
  if (param_4 - 9 < 2) {
    if (0 < (int)uVar31) {
      piVar18 = aiStack5820;
      puVar30 = (undefined4 *)((longlong)&local_16d8 + 4);
      puVar33 = (ushort *)(*(longlong *)(param_3 + 0x3e) + 2);
      puVar28 = (undefined4 *)(*(longlong *)(param_3 + 0x3e) + 0x10);
      do {
        uVar7 = puVar33[2];
        if ((short)uVar7 < 0) {
          uVar19 = (uint)(byte)((char)(-(uint)uVar7 >> 8) + 0x80);
        }
        else {
          uVar19 = (uint)(ushort)((short)uVar7 >> 8);
        }
        piVar18[-7] = ((uint)puVar33[1] | (uint)*puVar33 << 0xc) << 4 | uVar19 & 0xff;
        if (((puVar30 != (undefined4 *)0x0) && (puVar28 != (undefined4 *)0x0)) &&
           ((puVar28 + 6 <= puVar30 || (puVar30 + 6 <= puVar28)))) {
          uVar10 = puVar28[1];
          uVar12 = puVar28[2];
          uVar13 = puVar28[3];
          uVar5 = *(undefined8 *)(puVar28 + 4);
          *puVar30 = *puVar28;
          puVar30[1] = uVar10;
          puVar30[2] = uVar12;
          puVar30[3] = uVar13;
          *(undefined8 *)(puVar30 + 4) = uVar5;
        }
        piVar2 = (int *)(puVar33 + 5);
        puVar28 = puVar28 + 0xe;
        puVar3 = puVar33 + -1;
        puVar30 = puVar30 + 8;
        puVar33 = puVar33 + 0x1c;
        *piVar18 = *piVar2 * 0x10000 + (int)(short)*puVar3;
        piVar18 = piVar18 + 8;
        uVar23 = uVar23 - 1;
      } while (uVar23 != 0);
    }
    uVar31 = uVar31 << 5;
    uVar23 = (ulonglong)uVar31;
    puVar11 = (uint *)(puVar16 + 6);
    puVar16[5] = 0xb4;
    if ((puVar11 != (uint *)0x0) &&
       ((&stack0x0000002c + lVar15 <= puVar11 || (puVar16 + 10 <= &stack0x00000028 + lVar15)))) {
      *puVar11 = uVar31;
    }
    puVar24 = puVar16 + 10;
    if ((((uVar31 != 0) && (puVar24 != (undefined *)0x0)) && (uVar31 != 0)) &&
       ((uVar27 = (ulonglong)uVar31, (undefined *)((longlong)auStack5840 + (uVar27 - 8)) <= puVar24
        || (puVar24 + uVar23 <= &local_16d8)))) goto joined_r0x00018000a019;
  }
  else {
    if (0 < (int)uVar31) {
      puVar22 = &local_16d8;
      puVar30 = (undefined4 *)((longlong)&local_16d8 + 4);
      puVar33 = (ushort *)(*(longlong *)(param_3 + 0x3e) + 2);
      puVar28 = (undefined4 *)(*(longlong *)(param_3 + 0x3e) + 0x10);
      do {
        uVar7 = puVar33[2];
        if ((short)uVar7 < 0) {
          uVar19 = (uint)(byte)((char)(-(uint)uVar7 >> 8) + 0x80);
        }
        else {
          uVar19 = (uint)(ushort)((short)uVar7 >> 8);
        }
        *(uint *)puVar22 = ((uint)*puVar33 << 0xc | (uint)puVar33[1]) << 4 | uVar19 & 0xff;
        if (((puVar30 != (undefined4 *)0x0) && (puVar28 != (undefined4 *)0x0)) &&
           ((puVar28 + 6 <= puVar30 || (puVar30 + 6 <= puVar28)))) {
          uVar10 = puVar28[1];
          uVar12 = puVar28[2];
          uVar13 = puVar28[3];
          uVar5 = *(undefined8 *)(puVar28 + 4);
          *puVar30 = *puVar28;
          puVar30[1] = uVar10;
          puVar30[2] = uVar12;
          puVar30[3] = uVar13;
          *(undefined8 *)(puVar30 + 4) = uVar5;
        }
        puVar28 = puVar28 + 0xe;
        puVar30 = puVar30 + 7;
        puVar33 = puVar33 + 0x1c;
        puVar22 = (undefined8 *)((longlong)puVar22 + 0x1c);
        uVar23 = uVar23 - 1;
      } while (uVar23 != 0);
    }
    uVar31 = uVar31 * 0x1c;
    uVar23 = (ulonglong)uVar31;
    puVar11 = (uint *)(puVar16 + 6);
    puVar16[5] = 0xb4;
    if ((puVar11 != (uint *)0x0) &&
       ((&stack0x0000002c + lVar15 <= puVar11 || (puVar16 + 10 <= &stack0x00000028 + lVar15)))) {
      *puVar11 = uVar31;
    }
    puVar24 = puVar16 + 10;
    if ((((uVar31 != 0) && (puVar24 != (undefined *)0x0)) && (uVar31 != 0)) &&
       ((uVar27 = (ulonglong)uVar31, (undefined *)((longlong)auStack5840 + (uVar27 - 8)) <= puVar24
        || (puVar24 + uVar23 <= &local_16d8)))) {
joined_r0x00018000a019:
      if (uVar31 != 0) {
        *(undefined8 *)((longlong)&uStack32 + lVar15) = 0x18000a027;
        memcpy_FUN_180061f90
                  ((undefined8 *)(puVar16 + 10),&local_16d8,uVar27,
                   *(undefined *)((longlong)&uStack32 + lVar15));
      }
    }
  }
  puVar22 = (undefined8 *)(puVar16 + 10);
LAB_18000a029:
  iVar8 = param_3[0x40];
  puVar16 = (undefined *)(uVar23 + (longlong)puVar22);
  piVar18 = (int *)(puVar16 + 1);
  *puVar16 = 0xb5;
  if ((piVar18 != (int *)0x0) &&
     ((&stack0x0000002c + lVar15 <= piVar18 || (puVar16 + 5 <= &stack0x00000028 + lVar15)))) {
    *piVar18 = iVar8;
  }
  iVar8 = param_3[0x41];
  puVar16[5] = 0xb6;
  piVar18 = (int *)(puVar16 + 6);
  if ((piVar18 != (int *)0x0) &&
     ((&stack0x0000002c + lVar15 <= piVar18 || (puVar16 + 10 <= &stack0x00000028 + lVar15)))) {
    *piVar18 = iVar8;
  }
  iVar8 = param_3[0x42];
  puVar16[10] = 0xb7;
  piVar18 = (int *)(puVar16 + 0xb);
  if ((piVar18 != (int *)0x0) &&
     ((&stack0x0000002c + lVar15 <= piVar18 || (puVar16 + 0xf <= &stack0x00000028 + lVar15)))) {
    *piVar18 = iVar8;
  }
  iVar8 = param_3[0x43];
  puVar16[0xf] = 0xb8;
  piVar18 = (int *)(puVar16 + 0x10);
  if ((piVar18 != (int *)0x0) &&
     ((&stack0x0000002c + lVar15 <= piVar18 || (puVar16 + 0x14 <= &stack0x00000028 + lVar15)))) {
    *piVar18 = iVar8;
  }
  iVar8 = param_3[0x44];
  puVar16[0x14] = 0xb9;
  piVar18 = (int *)(puVar16 + 0x15);
  if ((piVar18 != (int *)0x0) &&
     ((&stack0x0000002c + lVar15 <= piVar18 || (puVar16 + 0x19 <= &stack0x00000028 + lVar15)))) {
    *piVar18 = iVar8;
  }
  iVar8 = param_3[0x45];
  puVar16[0x19] = 0xba;
  piVar18 = (int *)(puVar16 + 0x1a);
  if ((piVar18 != (int *)0x0) &&
     ((&stack0x0000002c + lVar15 <= piVar18 || (puVar16 + 0x1e <= &stack0x00000028 + lVar15)))) {
    *piVar18 = iVar8;
  }
  iVar8 = param_3[0x46];
  puVar16[0x1e] = 0xbb;
  piVar18 = (int *)(puVar16 + 0x1f);
  if ((piVar18 != (int *)0x0) &&
     ((&stack0x0000002c + lVar15 <= piVar18 || (puVar16 + 0x23 <= &stack0x00000028 + lVar15)))) {
    *piVar18 = iVar8;
  }
  iVar8 = param_3[0x47];
  puVar16[0x23] = 0xbc;
  piVar18 = (int *)(puVar16 + 0x24);
  if ((piVar18 != (int *)0x0) &&
     ((&stack0x0000002c + lVar15 <= piVar18 || (puVar16 + 0x28 <= &stack0x00000028 + lVar15)))) {
    *piVar18 = iVar8;
  }
  iVar8 = param_3[0x48];
  puVar16[0x28] = 0xbd;
  piVar18 = (int *)(puVar16 + 0x29);
  if ((piVar18 != (int *)0x0) &&
     ((&stack0x0000002c + lVar15 <= piVar18 || (puVar16 + 0x2d <= &stack0x00000028 + lVar15)))) {
    *piVar18 = iVar8;
  }
  iVar8 = param_3[0x49];
  puVar16[0x2d] = 0xbe;
  piVar18 = (int *)(puVar16 + 0x2e);
  if ((piVar18 != (int *)0x0) &&
     ((&stack0x0000002c + lVar15 <= piVar18 || (puVar16 + 0x32 <= &stack0x00000028 + lVar15)))) {
    *piVar18 = iVar8;
  }
  iVar8 = param_3[0x53];
  puVar16[0x32] = 0xd6;
  piVar18 = (int *)(puVar16 + 0x33);
  if ((piVar18 != (int *)0x0) &&
     ((&stack0x0000002c + lVar15 <= piVar18 || (puVar16 + 0x37 <= &stack0x00000028 + lVar15)))) {
    *piVar18 = iVar8;
  }
  iVar8 = param_3[0x54];
  puVar16[0x37] = 0xd7;
  piVar18 = (int *)(puVar16 + 0x38);
  if ((piVar18 != (int *)0x0) &&
     ((&stack0x0000002c + lVar15 <= piVar18 || (puVar16 + 0x3c <= &stack0x00000028 + lVar15)))) {
    *piVar18 = iVar8;
  }
  if ((piVar38 != (int *)0x0) &&
     ((&stack0x0000002c + lVar15 <= piVar38 || (puVar36 <= &stack0x00000028 + lVar15)))) {
    *piVar38 = ((int)puVar16 - (int)piVar38) + 0x38;
  }
  *(undefined8 *)((longlong)&uStack32 + lVar15) = 0x18000a29e;
  FUN_18005f100(local_40[0] ^ (ulonglong)(&stack0xffffffffffffffe8 + lVar15),
                *(undefined *)((longlong)&uStack32 + lVar15));
  return;
}



void FUN_18000a2b0(undefined *param_1,undefined8 param_2,longlong param_3)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  undefined local_18 [4];
  int local_14;
  ulonglong local_10;

  local_10 = DAT_1800b04e8 ^ (ulonglong)local_18;
  *param_1 = 0x93;
  piVar1 = (int *)(param_1 + 1);
  iVar2 = *(int *)(param_3 + 8);
  param_1[5] = 0xf2;
  piVar3 = (int *)(param_1 + 6);
  if ((piVar3 != (int *)0x0) && ((&local_14 <= piVar3 || (param_1 + 10 <= local_18)))) {
    *piVar3 = iVar2;
  }
  iVar2 = *(int *)(param_3 + 0xc);
  param_1[10] = 0xf3;
  piVar3 = (int *)(param_1 + 0xb);
  if ((piVar3 != (int *)0x0) && ((&local_14 <= piVar3 || (param_1 + 0xf <= local_18)))) {
    *piVar3 = iVar2;
  }
  iVar2 = *(int *)(param_3 + 0x10);
  param_1[0xf] = 0xf4;
  piVar3 = (int *)(param_1 + 0x10);
  if ((piVar3 != (int *)0x0) && ((&local_14 <= piVar3 || (param_1 + 0x14 <= local_18)))) {
    *piVar3 = iVar2;
  }
  iVar2 = *(int *)(param_3 + 0x14);
  param_1[0x14] = 0xf5;
  piVar3 = (int *)(param_1 + 0x15);
  if ((piVar3 != (int *)0x0) && ((&local_14 <= piVar3 || (param_1 + 0x19 <= local_18)))) {
    *piVar3 = iVar2;
  }
  if ((piVar1 != (int *)0x0) && ((&local_14 <= piVar1 || (param_1 + 5 <= local_18)))) {
    *piVar1 = ((int)param_1 - (int)piVar1) + 0x15;
  }
  FUN_18005f100(local_10 ^ (ulonglong)local_18);
  return;
}



void FUN_18000a3c0(undefined8 *param_1,undefined *param_2,uint *param_3,uint *param_4)

{
  undefined *puVar1;
  longlong lVar2;
  undefined8 uVar3;
  uint *puVar4;
  uint uVar5;
  longlong *plVar6;
  void *pvVar7;
  void *pvVar8;
  uint uVar9;
  void *pvVar10;
  uint uVar11;
  void *pvVar12;
  int iVar13;
  ulonglong uVar14;
  uint *puVar15;
  void *pvVar16;
  uint *puVar17;
  undefined auStack1240 [32];
  undefined *local_4b8;
  uint local_4a8;
  uint uStack1188;
  uint uStack1184;
  uint uStack1180;
  undefined8 local_498;
  uint local_490;
  uint *local_488;
  uint *local_480;
  uint *local_478;
  undefined8 *local_470;
  uint local_468;
  uint local_464 [3];
  uint local_458 [256];
  ulonglong local_58;

  local_58 = DAT_1800b04e8 ^ (ulonglong)auStack1240;
  local_4b8 = param_2;
  local_478 = param_3;
  local_470 = param_1;
  if ((param_2 != (undefined *)0x0) && (param_4 != (uint *)0x0)) {
    *param_2 = 0x87;
    puVar15 = (uint *)(param_2 + 1);
    param_2[5] = 0x86;
    uVar11 = param_4[6];
    uVar5 = param_4[5];
    puVar17 = (uint *)(param_2 + 6);
    if (param_4[7] != 0) {
      plVar6 = (longlong *)(param_4 + 10);
      uVar14 = (ulonglong)param_4[7];
      do {
        lVar2 = *plVar6;
        plVar6 = plVar6 + 1;
        uVar9 = *(uint *)(lVar2 + 0xf0);
        if ((int)*(uint *)(lVar2 + 0xf0) <= (int)uVar5) {
          uVar9 = uVar5;
        }
        uVar5 = uVar9;
        uVar14 = uVar14 - 1;
      } while (uVar14 != 0);
    }
    puVar4 = (uint *)(param_2 + 0xb);
    param_2[10] = 0x81;
    if ((puVar4 != (uint *)0x0) && ((local_464 <= puVar4 || (param_2 + 0xf <= &local_468)))) {
      *puVar4 = 0x2dcb0e;
    }
    uVar9 = *param_4;
    param_2[0xf] = 0x98;
    puVar4 = (uint *)(param_2 + 0x10);
    if ((puVar4 != (uint *)0x0) && ((local_464 <= puVar4 || (param_2 + 0x14 <= &local_468)))) {
      *puVar4 = uVar9;
    }
    uVar9 = param_4[2];
    param_2[0x14] = 0x9a;
    puVar4 = (uint *)(param_2 + 0x15);
    if ((puVar4 != (uint *)0x0) && ((local_464 <= puVar4 || (param_2 + 0x19 <= &local_468)))) {
      *puVar4 = uVar9;
    }
    uVar9 = param_4[1];
    param_2[0x19] = 0x9b;
    puVar4 = (uint *)(param_2 + 0x1a);
    if ((puVar4 != (uint *)0x0) && ((local_464 <= puVar4 || (param_2 + 0x1e <= &local_468)))) {
      *puVar4 = uVar9;
    }
    uVar9 = param_4[7];
    param_2[0x1e] = 0x91;
    puVar4 = (uint *)(param_2 + 0x1f);
    if ((puVar4 != (uint *)0x0) && ((local_464 <= puVar4 || (param_2 + 0x23 <= &local_468)))) {
      *puVar4 = uVar9;
    }
    uVar9 = param_4[8];
    param_2[0x23] = 0x97;
    puVar4 = (uint *)(param_2 + 0x24);
    if ((puVar4 != (uint *)0x0) && ((local_464 <= puVar4 || (param_2 + 0x28 <= &local_468)))) {
      *puVar4 = uVar9;
    }
    uVar9 = param_4[9];
    param_2[0x28] = 0x92;
    puVar4 = (uint *)(param_2 + 0x29);
    if ((puVar4 != (uint *)0x0) && ((local_464 <= puVar4 || (param_2 + 0x2d <= &local_468)))) {
      *puVar4 = uVar9;
    }
    param_2[0x2d] = 0x9e;
    puVar4 = (uint *)(param_2 + 0x2e);
    if ((puVar4 != (uint *)0x0) && ((local_464 <= puVar4 || (param_2 + 0x32 <= &local_468)))) {
      *puVar4 = uVar5;
    }
    param_2[0x32] = 0x9f;
    puVar4 = (uint *)(param_2 + 0x33);
    if ((puVar4 != (uint *)0x0) && ((local_464 <= puVar4 || (param_2 + 0x37 <= &local_468)))) {
      *puVar4 = uVar11;
    }
    uVar11 = param_4[3];
    param_2[0x37] = 0x9c;
    puVar4 = (uint *)(param_2 + 0x38);
    if ((puVar4 != (uint *)0x0) && ((local_464 <= puVar4 || (param_2 + 0x3c <= &local_468)))) {
      *puVar4 = uVar11;
    }
    uVar11 = param_4[4];
    param_2[0x3c] = 0x9d;
    puVar4 = (uint *)(param_2 + 0x3d);
    if ((puVar4 != (uint *)0x0) && ((local_464 <= puVar4 || (param_2 + 0x41 <= &local_468)))) {
      *puVar4 = uVar11;
    }
    uVar11 = param_4[0x2380];
    param_2[0x41] = 0xfa;
    puVar4 = (uint *)(param_2 + 0x42);
    if ((puVar4 != (uint *)0x0) && ((local_464 <= puVar4 || (param_2 + 0x46 <= &local_468)))) {
      *puVar4 = uVar11;
    }
    uVar11 = param_4[0x2381];
    pvVar7 = (void *)(ulonglong)uVar11;
    param_2[0x46] = 0xfb;
    puVar4 = (uint *)(param_2 + 0x47);
    if ((puVar4 != (uint *)0x0) && ((local_464 <= puVar4 || (param_2 + 0x4b <= &local_468)))) {
      *puVar4 = uVar11;
    }
    pvVar10 = (void *)0x0;
    puVar1 = param_2 + 0x4b;
    pvVar8 = pvVar10;
    local_488 = puVar17;
    local_480 = puVar15;
    if (param_4[7] != 0) {
      do {
        puVar1 = (undefined *)
                 FUN_1800099e0(puVar1,pvVar7,*(int **)(param_4 + (longlong)pvVar8 * 2 + 10),*param_4
                              );
        uVar11 = (int)pvVar8 + 1;
        pvVar8 = (void *)(ulonglong)uVar11;
      } while (uVar11 < param_4[7]);
    }
    if (*param_4 - 9 < 2) {
      pvVar12 = malloc((ulonglong)param_4[9]);
      pvVar7 = pvVar12;
      FUN_18002e3f0((longlong)param_4,(longlong)pvVar12);
      pvVar8 = pvVar10;
      if (param_4[9] != 0) {
        do {
          pvVar7 = pvVar8;
          iVar13 = (int)pvVar7;
          if ((-1 < (int)param_4[(longlong)pvVar7 * 7 + 0x6e]) &&
             (*(char *)((longlong)pvVar7 + (longlong)pvVar12) == '\x01')) {
            puVar4 = param_4 + (longlong)pvVar7 * 7 + 0x6e;
            local_4a8 = *puVar4;
            uStack1188 = puVar4[1];
            uStack1184 = puVar4[2];
            uStack1180 = puVar4[3];
            local_490 = param_4[(longlong)pvVar7 * 7 + 0x74];
            local_498 = *(undefined8 *)(param_4 + (longlong)pvVar7 * 7 + 0x72);
            puVar1 = (undefined *)FUN_180009830(puVar1,pvVar7,(int *)&local_4a8,iVar13);
          }
          uVar11 = iVar13 + 1;
          pvVar8 = (void *)(ulonglong)uVar11;
        } while (uVar11 < param_4[9]);
      }
      free(pvVar12);
      param_2 = local_4b8;
    }
    else {
      if ((0 < (int)param_4[0x21f9]) &&
         (pvVar8 = (void *)(longlong)(int)param_4[0x21f6], pvVar7 = pvVar8, param_2 = local_4b8,
         0 < (int)param_4[7])) {
        plVar6 = (longlong *)(param_4 + 10);
        pvVar12 = pvVar10;
        pvVar16 = pvVar10;
        do {
          if ((longlong)pvVar12 < (longlong)pvVar8) {
            iVar13 = *(int *)(*(longlong *)(param_4 + (longlong)pvVar8 * 2 + 10) + 0x104) +
                     (int)pvVar16;
LAB_18000a72a:
            lVar2 = (longlong)iVar13;
            if (-1 < (int)param_4[lVar2 * 7 + 0x6e]) {
              puVar15 = param_4 + lVar2 * 7 + 0x6e;
              local_4a8 = *puVar15;
              uStack1188 = puVar15[1];
              uStack1184 = puVar15[2];
              uStack1180 = puVar15[3];
              local_490 = param_4[lVar2 * 7 + 0x74];
              local_498 = *(undefined8 *)(param_4 + lVar2 * 7 + 0x72);
              puVar1 = (undefined *)FUN_180009830(puVar1,pvVar7,(int *)&local_4a8,iVar13);
              pvVar7 = (void *)((ulonglong)pvVar8 & 0xffffffff);
            }
          }
          else {
            if (pvVar12 != pvVar8) {
              iVar13 = *(int *)(*plVar6 + 0x104) + (int)pvVar7;
              goto LAB_18000a72a;
            }
          }
          uVar11 = (int)pvVar16 + 1;
          pvVar16 = (void *)(ulonglong)uVar11;
          pvVar12 = (void *)((longlong)pvVar12 + 1);
          plVar6 = plVar6 + 1;
          puVar15 = local_480;
          param_2 = local_4b8;
          puVar17 = local_488;
        } while ((int)uVar11 < (int)param_4[7]);
      }
    }
    puVar1 = (undefined *)FUN_18000a2b0(puVar1,pvVar7,(longlong)(param_4 + 0x21f4));
    uVar3 = FUN_1800093f0(puVar1,pvVar7,(undefined *)(param_4 + 0x21fa));
    uVar11 = ((int)uVar3 - (int)puVar17) - 4;
    if ((puVar17 != (uint *)0x0) && ((local_464 <= puVar17 || (puVar17 + 1 <= &local_468)))) {
      *puVar17 = uVar11;
    }
    *local_478 = uVar11;
    memset(local_458,0,0x400);
    FUN_18000d7f0(local_458);
    uVar5 = 0xffffffff;
    if (uVar11 != 0) {
      do {
        uVar9 = (int)pvVar10 + 1;
        uVar5 = local_458[((byte)param_2[(longlong)pvVar10 + 10] ^ uVar5) & 0xff] ^ uVar5 >> 8;
        pvVar10 = (void *)(ulonglong)uVar9;
      } while (uVar9 != uVar11);
    }
    if ((puVar15 != (uint *)0x0) && ((local_464 <= puVar15 || (puVar15 + 1 <= &local_468)))) {
      *puVar15 = ~uVar5;
    }
    if (local_470 != (undefined8 *)0x0) {
      *local_470 = uVar3;
    }
  }
  FUN_18005f100(local_58 ^ (ulonglong)auStack1240);
  return;
}



undefined8
FUN_18000a930(uint *param_1,undefined4 *param_2,uint *param_3,undefined4 *param_4,
             undefined4 *param_5)

{
  undefined4 uVar1;
  uint uVar2;
  undefined4 uVar3;
  uint uVar4;

  uVar1 = param_2[5];
  uVar4 = param_2[8];
  uVar3 = param_2[6];
  switch(*param_2) {
  case 0:
  case 4:
  case 6:
  case 7:
  case 0x3e:
    uVar3 = 0x96;
    uVar4 = 0x28;
    uVar1 = 0x96;
    break;
  case 1:
  case 5:
  case 8:
    uVar1 = 0xa0;
    goto LAB_18000a9d2;
  case 2:
    uVar3 = 0x96;
    uVar4 = 0x1e;
    uVar1 = 0x96;
    break;
  case 3:
    uVar3 = 0x96;
    uVar4 = 0xf;
    uVar1 = 0x96;
    break;
  case 9:
    uVar3 = 0x96;
    uVar4 = 0x2d;
    uVar1 = 0x96;
    break;
  case 10:
    uVar1 = 0x78;
    goto LAB_18000a9d2;
  case 0x3f:
    uVar1 = 0x8c;
LAB_18000a9d2:
    uVar4 = 0x32;
    uVar3 = uVar1;
  }
  uVar2 = param_2[8];
  if ((param_1 != (uint *)0x0) && (uVar2 = *param_1, uVar4 <= *param_1)) {
    uVar2 = uVar4;
  }
  *param_4 = uVar1;
  *param_3 = uVar2;
  *param_5 = uVar3;
  return 0;
}



ulonglong FUN_18000aa60(int *param_1,uint param_2,uint param_3)

{
  int iVar1;
  bool bVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  undefined8 *puVar6;
  uint *puVar7;
  int *piVar8;
  void *pvVar9;
  undefined8 *puVar10;
  longlong lVar11;
  ulonglong uVar12;
  uint *puVar13;
  uint **ppuVar14;
  longlong *plVar15;
  uint uVar16;
  uint uVar17;
  uint uVar18;
  int iVar19;
  undefined *puVar20;
  void **ppvVar21;
  uint **ppuVar22;
  uint uVar23;
  int iVar24;
  uint local_res20;

  if (param_1 == (int *)0x0) {
    return 0x80000002;
  }
  iVar24 = 0;
  uVar18 = param_1[2];
  uVar5 = param_1[1];
  ppuVar22 = (uint **)(param_1 + 10);
  local_res20 = 0;
  uVar16 = uVar18;
  uVar23 = uVar5;
  if (param_1[3] != 0) {
    uVar23 = uVar5 >> 1;
    uVar16 = uVar18 >> 1;
  }
  uVar3 = (uVar23 >> 3) + 1;
  if (uVar23 == (uVar23 & 0xfffffff8)) {
    uVar3 = uVar23 >> 3;
  }
  iVar1 = *param_1;
  ppuVar14 = ppuVar22;
  if (0 < (int)param_3) {
    do {
      puVar6 = (undefined8 *)malloc(0x158);
      *ppuVar14 = (uint *)puVar6;
      if (puVar6 == (undefined8 *)0x0) {
LAB_18000ad07:
        local_res20 = 0x80000004;
        break;
      }
      lVar11 = 5;
      do {
        puVar10 = puVar6;
        *puVar10 = 0;
        puVar10[1] = 0;
        puVar10[2] = 0;
        puVar10[3] = 0;
        puVar10[4] = 0;
        puVar10[5] = 0;
        puVar10[6] = 0;
        puVar10[7] = 0;
        lVar11 = lVar11 + -1;
        puVar6 = puVar10 + 8;
      } while (lVar11 != 0);
      puVar10[8] = 0;
      puVar10[9] = 0;
      puVar10[10] = 0;
      **ppuVar14 = uVar5;
      (*ppuVar14)[1] = uVar18;
      iVar19 = uVar16 * uVar23;
      uVar4 = (int)(iVar19 + (iVar19 >> 0x1f & 7U)) >> 3;
      uVar17 = uVar4 + 1;
      if (iVar19 <= (int)(uVar4 * 8)) {
        uVar17 = uVar4;
      }
      puVar7 = (uint *)malloc((longlong)(int)uVar17 + 0x20);
      if (puVar7 != (uint *)0x0) {
        puVar7[3] = uVar17;
        *puVar7 = uVar23;
        puVar7[1] = uVar16;
        puVar7[4] = 8;
        puVar7[2] = 0xffffffff;
        *(uint **)(puVar7 + 6) = puVar7 + 8;
      }
      *(uint **)(*ppuVar14 + 2) = puVar7;
      if (*(longlong *)(*ppuVar14 + 2) == 0) goto LAB_18000ad07;
      puVar7 = (uint *)malloc((longlong)(int)uVar17 + 0x20);
      if (puVar7 == (uint *)0x0) {
        puVar7 = (uint *)0x0;
      }
      else {
        puVar7[3] = uVar17;
        *puVar7 = uVar23;
        puVar7[1] = uVar16;
        puVar7[4] = 8;
        puVar7[2] = 0xffffffff;
        *(uint **)(puVar7 + 6) = puVar7 + 8;
      }
      *(uint **)(*ppuVar14 + 4) = puVar7;
      if (*(longlong *)(*ppuVar14 + 4) == 0) goto LAB_18000ad07;
      if ((longlong)iVar1 - 9U < 2) {
        *(undefined8 *)(*ppuVar14 + 6) = 0;
      }
      else {
        piVar8 = FUN_180022ff0(uVar23,uVar16,8);
        *(int **)(*ppuVar14 + 6) = piVar8;
        lVar11 = *(longlong *)(*ppuVar14 + 6);
        if (lVar11 == 0) goto LAB_18000ad07;
        if ((*(undefined **)(lVar11 + 0x18) != (undefined *)0x0) && (*(uint *)(lVar11 + 0xc) != 0))
        {
          uVar12 = (ulonglong)*(uint *)(lVar11 + 0xc);
          puVar20 = *(undefined **)(lVar11 + 0x18);
          while (uVar12 != 0) {
            uVar12 = uVar12 - 1;
            *puVar20 = 0;
            puVar20 = puVar20 + 1;
          }
        }
      }
      pvVar9 = malloc((ulonglong)param_2 * 0x38);
      *(void **)(*ppuVar14 + 0x3e) = pvVar9;
      if (*(longlong *)(*ppuVar14 + 0x3e) == 0) goto LAB_18000ad07;
      piVar8 = FUN_180022ff0(uVar3,uVar16,1);
      *(int **)(*ppuVar14 + 0x4c) = piVar8;
      if (*(longlong *)(*ppuVar14 + 0x4c) == 0) goto LAB_18000ad07;
      *(undefined8 *)(*ppuVar14 + 8) = 0;
      iVar24 = iVar24 + 1;
      puVar7 = *ppuVar14;
      ppuVar14 = ppuVar14 + 1;
      *(undefined8 *)(puVar7 + 0x50) = 0;
    } while (iVar24 < (int)param_3);
  }
  iVar24 = 0;
  bVar2 = true;
  if ((1 < *param_1 - 9U) && (bVar2 = true, param_1[0x2380] == 1)) {
    bVar2 = false;
  }
  if (local_res20 == 0) {
    if ((undefined8 *)(param_1 + 0x236c) != (undefined8 *)0x0) {
      *(undefined8 *)(param_1 + 0x236c) = 0xffffffffffffffff;
      *(undefined8 *)(param_1 + 0x236e) = 0xffffffffffffffff;
      *(undefined8 *)(param_1 + 0x2370) = 0xffffffffffffffff;
      *(undefined8 *)(param_1 + 0x2372) = 0xffffffffffffffff;
      *(undefined8 *)(param_1 + 0x2374) = 0xffffffffffffffff;
      *(undefined8 *)(param_1 + 0x2376) = 0xffffffffffffffff;
      *(undefined8 *)(param_1 + 0x2378) = 0xffffffffffffffff;
      *(undefined8 *)(param_1 + 0x237a) = 0xffffffffffffffff;
      *(undefined8 *)(param_1 + 0x237c) = 0xffffffffffffffff;
      *(undefined8 *)(param_1 + 0x237e) = 0xffffffffffffffff;
    }
    plVar15 = (longlong *)(param_1 + 0x2344);
    if (bVar2) {
      do {
        puVar6 = (undefined8 *)malloc(0x158);
        *plVar15 = (longlong)puVar6;
        if (puVar6 == (undefined8 *)0x0) {
LAB_18000b01b:
          local_res20 = 0x80000004;
          goto LAB_18000b031;
        }
        lVar11 = 5;
        do {
          puVar10 = puVar6;
          *puVar10 = 0;
          puVar10[1] = 0;
          puVar10[2] = 0;
          puVar10[3] = 0;
          puVar10[4] = 0;
          puVar10[5] = 0;
          puVar10[6] = 0;
          puVar10[7] = 0;
          lVar11 = lVar11 + -1;
          puVar6 = puVar10 + 8;
        } while (lVar11 != 0);
        puVar10[8] = 0;
        puVar10[9] = 0;
        puVar10[10] = 0;
        iVar19 = uVar16 * uVar23;
        uVar5 = (int)(iVar19 + (iVar19 >> 0x1f & 7U)) >> 3;
        uVar18 = uVar5 + 1;
        if (iVar19 <= (int)(uVar5 * 8)) {
          uVar18 = uVar5;
        }
        puVar7 = (uint *)malloc((longlong)(int)uVar18 + 0x20);
        if (puVar7 != (uint *)0x0) {
          puVar7[3] = uVar18;
          *puVar7 = uVar23;
          puVar7[1] = uVar16;
          puVar7[4] = 8;
          puVar7[2] = 0xffffffff;
          *(uint **)(puVar7 + 6) = puVar7 + 8;
        }
        *(uint **)(*plVar15 + 8) = puVar7;
        if (*(longlong *)(*plVar15 + 8) == 0) goto LAB_18000b01b;
        puVar7 = (uint *)malloc((longlong)(int)uVar18 + 0x20);
        if (puVar7 == (uint *)0x0) {
          puVar7 = (uint *)0x0;
        }
        else {
          puVar7[3] = uVar18;
          *puVar7 = uVar23;
          puVar7[1] = uVar16;
          puVar7[4] = 8;
          puVar7[2] = 0xffffffff;
          *(uint **)(puVar7 + 6) = puVar7 + 8;
        }
        puVar13 = (uint *)0x0;
        *(uint **)(*plVar15 + 0x10) = puVar7;
        if (*(longlong *)(*plVar15 + 0x10) == 0) goto LAB_18000b01b;
        *(undefined8 *)(*plVar15 + 0x18) = 0;
        if (1 < (longlong)iVar1 - 9U) {
          puVar7 = (uint *)malloc((longlong)(int)uVar18 + 0x20);
          if (puVar7 != (uint *)0x0) {
            puVar7[3] = uVar18;
            *puVar7 = uVar23;
            puVar7[1] = uVar16;
            puVar7[4] = 8;
            puVar7[2] = 0xffffffff;
            *(uint **)(puVar7 + 6) = puVar7 + 8;
            puVar13 = puVar7;
          }
          *(uint **)(*plVar15 + 0x18) = puVar13;
          lVar11 = *(longlong *)(*plVar15 + 0x18);
          if (lVar11 == 0) goto LAB_18000b01b;
          if ((*(undefined **)(lVar11 + 0x18) != (undefined *)0x0) && (*(uint *)(lVar11 + 0xc) != 0)
             ) {
            uVar12 = (ulonglong)*(uint *)(lVar11 + 0xc);
            puVar20 = *(undefined **)(lVar11 + 0x18);
            while (uVar12 != 0) {
              uVar12 = uVar12 - 1;
              *puVar20 = 0;
              puVar20 = puVar20 + 1;
            }
          }
        }
        pvVar9 = malloc((ulonglong)param_2 * 0x38);
        *(void **)(*plVar15 + 0xf8) = pvVar9;
        if (*(longlong *)(*plVar15 + 0xf8) == 0) goto LAB_18000b01b;
        *(undefined4 *)(*plVar15 + 0xf0) = 0xffffffff;
        puVar7 = (uint *)malloc((longlong)(int)(uVar3 * uVar16) + 0x20);
        if (puVar7 == (uint *)0x0) {
          puVar7 = (uint *)0x0;
        }
        else {
          *puVar7 = uVar3;
          puVar7[2] = uVar3;
          puVar7[3] = uVar3 * uVar16;
          puVar7[1] = uVar16;
          puVar7[4] = 1;
          *(uint **)(puVar7 + 6) = puVar7 + 8;
        }
        *(uint **)(*plVar15 + 0x130) = puVar7;
        if (*(longlong *)(*plVar15 + 0x130) == 0) goto LAB_18000b01b;
        *(undefined8 *)(*plVar15 + 0x20) = 0;
        iVar24 = iVar24 + 1;
        lVar11 = *plVar15;
        plVar15 = plVar15 + 1;
        *(undefined8 *)(lVar11 + 0x140) = 0;
      } while (iVar24 < 0x14);
    }
  }
  else {
LAB_18000b031:
    if (0 < (int)param_3) {
      uVar12 = (ulonglong)param_3;
      do {
        FUN_180004ab0(ppuVar22);
        ppuVar22 = ppuVar22 + 1;
        uVar12 = uVar12 - 1;
      } while (uVar12 != 0);
    }
    if (bVar2) {
      ppvVar21 = (void **)(param_1 + 0x2344);
      lVar11 = 0x14;
      do {
        FUN_180004ab0(ppvVar21);
        ppvVar21 = ppvVar21 + 1;
        lVar11 = lVar11 + -1;
      } while (lVar11 != 0);
    }
  }
  return (ulonglong)local_res20;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18000b0e0(uint **param_1,uint *param_2,uint **param_3,uint *param_4)

{
  undefined8 *puVar1;
  char cVar2;
  uint uVar3;
  int iVar4;
  undefined8 *puVar5;
  ulonglong uVar6;
  uint *puVar7;
  uint uVar8;
  longlong lVar9;
  undefined4 *puVar10;
  uint *puVar11;
  uint uVar12;
  ulonglong uVar13;
  uint *puVar14;
  ulonglong uVar15;
  uint *puVar16;
  uint *puVar17;
  uint *puVar18;
  uint uVar19;
  ulonglong uVar20;
  int iVar21;
  bool bVar22;
  uint *local_498;
  uint *local_490;
  uint *local_488;
  uint **local_480;
  uint local_478;
  uint local_474;
  undefined8 local_470;
  undefined4 local_468 [4];
  undefined8 local_458;
  undefined4 local_450 [2];
  uint local_448 [256];
  ulonglong local_48;

  puVar17 = local_470;
  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffb38;
  puVar7 = *param_1;
  uVar15 = 0;
  uVar3 = 0;
  local_470 = (uint *)((ulonglong)local_470 & 0xffffffff00000000);
  local_488 = param_4;
  local_480 = param_1;
  if (*(char *)puVar7 == -0x79) {
    *param_2 = *param_2 - 1;
    uVar8 = *param_2;
    puVar16 = (uint *)((longlong)puVar7 + 1);
    if ((puVar16 != (uint *)0x0) &&
       (((uint *)((longlong)puVar7 + 5U) <= &local_478 || (&local_474 <= puVar16)))) {
      local_470 = (uint *)((ulonglong)puVar17 & 0xffffffff00000000 | (ulonglong)*puVar16);
    }
    *param_2 = uVar8 - 4;
    if (*(char *)((longlong)puVar7 + 5) == -0x7a) {
      puVar17 = (uint *)((longlong)puVar7 + 6);
      *param_2 = uVar8 - 5;
      if (3 < uVar8 - 5) {
        if ((puVar17 != (uint *)0x0) &&
           (((uint *)((longlong)puVar7 + 10U) <= &local_478 || (&local_474 <= puVar17)))) {
          uVar3 = *puVar17;
        }
        *param_2 = uVar8 - 9;
        memset(local_448,0,0x400);
        FUN_18000d7f0(local_448);
        uVar12 = 0xffffffff;
        if (uVar3 != 0) {
          uVar13 = uVar15;
          do {
            uVar19 = (int)uVar13 + 1;
            uVar12 = local_448[(*(byte *)(uVar13 + 10 + (longlong)*local_480) ^ uVar12) & 0xff] ^
                     uVar12 >> 8;
            uVar13 = (ulonglong)uVar19;
          } while (uVar19 != uVar3);
        }
        if (((uint)local_470 == ~uVar12) &&
           (local_490 = (uint *)((char *)((longlong)puVar7 + 10) + (int)uVar3),
           *(char *)((longlong)puVar7 + 10) == -0x7f)) {
          *param_2 = uVar8 - 10;
          puVar17 = (uint *)((longlong)puVar7 + 0xb);
          if ((puVar17 != (uint *)0x0) &&
             (((undefined8 *)((longlong)puVar7 + 0xfU) <= &local_470 ||
              ((uint *)((longlong)&local_470 + 4U) <= puVar17)))) {
            local_470._0_4_ = *puVar17;
          }
          puVar17 = (uint *)((longlong)puVar7 + 0xf);
          *param_2 = uVar8 - 0xe;
          do {
            uVar3 = (uint)local_470;
            local_470._0_4_ = (int)uVar3 / 10;
          } while ((uint)local_470 != 0);
          uVar8 = 0x4944e;
          do {
            uVar12 = uVar8;
            uVar8 = (int)uVar12 / 10;
          } while (uVar8 != 0);
          if (uVar3 == uVar12) {
            puVar5 = (undefined8 *)malloc(0x8e08);
            *param_3 = (uint *)puVar5;
            if (puVar5 != (undefined8 *)0x0) {
              lVar9 = 0x238;
              do {
                *puVar5 = 0;
                puVar5[1] = 0;
                puVar5[2] = 0;
                puVar1 = puVar5 + 8;
                puVar5[3] = 0;
                puVar5[4] = 0;
                puVar5[5] = 0;
                puVar5[6] = 0;
                puVar5[7] = 0;
                lVar9 = lVar9 + -1;
                puVar5 = puVar1;
              } while (lVar9 != 0);
              *puVar1 = 0;
              lVar9 = 0x4ca;
              local_458 = 0x100;
              (*param_3)[0x2380] = 1;
              uVar13 = uVar15;
              uVar20 = uVar15;
              do {
                *(undefined4 *)((longlong)*param_3 + uVar13 + 0x1b8) = 0xffffffff;
                puVar10 = (undefined4 *)((longlong)*param_3 + uVar20 + 0x1bc);
                if ((puVar10 != (undefined4 *)0x0) &&
                   ((local_450 <= puVar10 || (puVar10 + 6 <= local_468)))) {
                  *puVar10 = 0x100;
                  puVar10[1] = 0;
                  puVar10[2] = 0;
                  puVar10[3] = 0;
                  *(undefined8 *)(puVar10 + 4) = 0x100;
                }
                uVar20 = uVar20 + 0x1c;
                uVar13 = uVar13 + 0x1c;
                lVar9 = lVar9 + -1;
              } while (lVar9 != 0);
              uVar13 = uVar15;
              uVar20 = uVar15;
              if (puVar17 < (uint *)((longlong)puVar7 + 0x41U)) {
                puVar16 = (uint *)((longlong)puVar7 + 0x13);
                puVar18 = puVar17;
                do {
                  puVar17 = puVar18;
                  if ((int)uVar20 != 0) break;
                  *param_2 = *param_2 - 1;
                  puVar14 = (uint *)((longlong)puVar16 + 1);
                  puVar17 = (uint *)((longlong)puVar18 + 1);
                  switch(*(char *)puVar18) {
                  case -0x6f:
                    puVar11 = *param_3 + 7;
                    bVar22 = puVar11 == (uint *)0x0;
                    break;
                  case -0x6e:
                    puVar11 = *param_3 + 9;
                    bVar22 = puVar11 == (uint *)0x0;
                    break;
                  default:
                    uVar13 = 0xffff0006;
                    uVar20 = 1;
                    goto LAB_18000b49d;
                  case -0x69:
                    puVar11 = *param_3 + 8;
                    bVar22 = puVar11 == (uint *)0x0;
                    break;
                  case -0x68:
                    puVar11 = *param_3;
                    bVar22 = puVar11 == (uint *)0x0;
                    break;
                  case -0x66:
                    puVar11 = *param_3 + 2;
                    bVar22 = puVar11 == (uint *)0x0;
                    break;
                  case -0x65:
                    puVar11 = *param_3 + 1;
                    bVar22 = puVar11 == (uint *)0x0;
                    break;
                  case -100:
                    puVar11 = *param_3 + 3;
                    bVar22 = puVar11 == (uint *)0x0;
                    break;
                  case -99:
                    puVar11 = *param_3 + 4;
                    bVar22 = puVar11 == (uint *)0x0;
                    break;
                  case -0x62:
                    puVar11 = *param_3 + 5;
                    bVar22 = puVar11 == (uint *)0x0;
                    break;
                  case -0x61:
                    puVar11 = *param_3 + 6;
                    bVar22 = puVar11 == (uint *)0x0;
                  }
                  if (((!bVar22) && (puVar17 != (uint *)0x0)) &&
                     ((puVar14 <= puVar11 || (puVar11 + 1 <= puVar17)))) {
                    *(char *)puVar11 = *(char *)puVar17;
                    *(char *)((longlong)puVar11 + 1) = *(char *)((longlong)puVar18 + 2);
                    *(char *)((longlong)puVar11 + 2) = *(char *)((longlong)puVar18 + 3);
                    *(char *)((longlong)puVar11 + 3) = *(char *)(puVar18 + 1);
                  }
                  *param_2 = *param_2 - 4;
                  puVar17 = (uint *)((longlong)puVar18 + 5);
                  puVar14 = (uint *)((longlong)puVar16 + 5);
LAB_18000b49d:
                  puVar16 = puVar14;
                  puVar18 = puVar17;
                } while (puVar17 < (uint *)((longlong)puVar7 + 0x41U));
              }
              iVar4 = (int)uVar13;
              if (*(char *)puVar17 == -6) {
                *param_2 = *param_2 - 1;
                puVar18 = (uint *)((longlong)puVar17 + 1);
                puVar7 = *param_3;
                puVar16 = puVar7 + 0x2380;
                if (((puVar16 != (uint *)0x0) && (puVar18 != (uint *)0x0)) &&
                   (((uint *)((longlong)puVar17 + 5U) <= puVar16 || (puVar7 + 0x2381 <= puVar18))))
                {
                  *(char *)puVar16 = *(char *)puVar18;
                  *(char *)((longlong)puVar7 + 0x8e01) = *(char *)((longlong)puVar17 + 2);
                  *(char *)((longlong)puVar7 + 0x8e02) = *(char *)((longlong)puVar17 + 3);
                  *(char *)((longlong)puVar7 + 0x8e03) = *(char *)(puVar17 + 1);
                }
                *param_2 = *param_2 - 4;
                puVar17 = (uint *)((longlong)puVar17 + 5);
              }
              if (*(char *)puVar17 == -5) {
                *param_2 = *param_2 - 1;
                puVar18 = (uint *)((longlong)puVar17 + 1);
                puVar7 = *param_3;
                puVar16 = puVar7 + 0x2381;
                if (((puVar16 != (uint *)0x0) && (puVar18 != (uint *)0x0)) &&
                   (((uint *)((longlong)puVar17 + 5U) <= puVar16 || (puVar7 + 0x2382 <= puVar18))))
                {
                  *(char *)puVar16 = *(char *)puVar18;
                  *(char *)((longlong)puVar7 + 0x8e05) = *(char *)((longlong)puVar17 + 2);
                  *(char *)((longlong)puVar7 + 0x8e06) = *(char *)((longlong)puVar17 + 3);
                  *(char *)((longlong)puVar7 + 0x8e07) = *(char *)(puVar17 + 1);
                }
                *param_2 = *param_2 - 4;
                puVar17 = (uint *)((longlong)puVar17 + 5);
              }
              if ((int)uVar20 == 0) {
                puVar7 = *param_3;
                uVar3 = puVar7[5];
                uVar8 = puVar7[8];
                local_470 = (uint *)((ulonglong)local_470 & 0xffffffff00000000 | (ulonglong)uVar3);
                local_470._0_4_ = uVar3;
                local_478 = uVar8;
                if (puVar7 != (uint *)0x0) {
                  FUN_18000a930(local_488,puVar7,&local_478,(undefined4 *)&local_470,
                                (undefined4 *)&local_498);
                  uVar3 = puVar7[5];
                  uVar8 = puVar7[8];
                }
                if ((uint)local_470 < uVar3) {
                  local_470._0_4_ = uVar3;
                }
                uVar3 = local_478;
                if (local_478 < uVar8) {
                  uVar3 = uVar8;
                }
                uVar6 = FUN_18000aa60((int *)puVar7,(uint)local_470,uVar3);
                puVar7 = local_490;
                if ((int)uVar6 != 0) {
                  uVar13 = 0xffff0002;
                  uVar20 = 1;
                }
                iVar4 = (int)uVar13;
                iVar21 = (int)uVar20;
                (*param_3)[7] = 0;
                while (puVar17 < puVar7) {
                  iVar4 = (int)uVar13;
                  if ((int)uVar20 != 0) goto LAB_18000b6b8;
                  *param_2 = *param_2 - 1;
                  cVar2 = *(char *)puVar17;
                  local_498 = (uint *)((longlong)puVar17 + 1);
                  if (cVar2 == -0x6d) {
                    local_490 = *param_3 + 0x21f4;
                    uVar3 = FUN_18000c2b0(&local_498,param_2,(longlong *)&local_490);
                    uVar13 = uVar15;
                    puVar17 = local_498;
                    if ((int)uVar3 < 0) {
                      uVar20 = 1;
                      uVar13 = (ulonglong)uVar3;
                    }
                  }
                  else {
                    if (cVar2 == -0x6c) {
                      local_490 = *param_3 + 0x21fa;
                      uVar3 = FUN_18000bea0(&local_498,param_2,(longlong *)&local_490);
                      uVar13 = uVar15;
                      puVar17 = local_498;
                      if ((int)uVar3 < 0) {
                        uVar20 = 1;
                        uVar13 = (ulonglong)uVar3;
                      }
                    }
                    else {
                      if (cVar2 == -0x6b) {
                        puVar17 = *param_3;
                        if (puVar17[7] < puVar17[8]) {
                          local_490 = *(uint **)(puVar17 + (longlong)(int)puVar17[7] * 2 + 10);
                          uVar3 = FUN_18000c640(&local_498,param_2,&local_490,puVar17);
                          puVar17 = local_498;
                          if ((int)uVar3 < 0) {
                            uVar20 = 1;
                            uVar13 = (ulonglong)uVar3;
                          }
                          else {
                            (*param_3)[7] = (*param_3)[7] + 1;
                            uVar13 = uVar15;
                          }
                        }
                        else {
                          puVar17 = (uint *)FUN_180009170((int *)local_498,(int *)param_2);
                        }
                      }
                      else {
                        puVar17 = local_498;
                        if (cVar2 == -0x6a) {
                          local_470 = (uint *)0x0;
                          local_478 = 0;
                          uVar3 = FUN_18000c440(&local_498,param_2,(uint **)&local_470,&local_478);
                          puVar17 = local_498;
                          if ((int)uVar3 < 0) {
                            uVar20 = 1;
                            uVar13 = (ulonglong)uVar3;
                          }
                          else {
                            uVar13 = uVar15;
                            if (local_470 != (uint *)0x0) {
                              puVar17 = *param_3 + (ulonglong)local_478 * 7 + 0x6e;
                              if ((puVar17 != (uint *)0x0) &&
                                 ((local_470 + 7 <= puVar17 || (puVar17 + 7 <= local_470)))) {
                                lVar9 = 0xe;
                                puVar16 = local_470;
                                do {
                                  *(undefined *)
                                   ((longlong)(uint *)((longlong)puVar17 - (longlong)local_470) +
                                   (longlong)puVar16) = *(undefined *)puVar16;
                                  ((undefined *)
                                  ((longlong)(uint *)((longlong)puVar17 - (longlong)local_470) + 1))
                                  [(longlong)puVar16] = *(undefined *)((longlong)puVar16 + 1);
                                  puVar16 = (uint *)((longlong)puVar16 + 2);
                                  lVar9 = lVar9 + -1;
                                } while (lVar9 != 0);
                              }
                              free(local_470);
                              puVar17 = local_498;
                            }
                          }
                        }
                      }
                    }
                  }
                  iVar4 = (int)uVar13;
                  iVar21 = (int)uVar20;
                }
                if (iVar21 != 0) {
LAB_18000b6b8:
                  FUN_1800048e0(param_3);
                }
              }
              if (((iVar4 == 0) && (*param_3 != (uint *)0x0)) &&
                 (iVar4 = FUN_18000b8b0(local_488,(int *)*param_3), iVar4 == 0)) {
                puVar7 = *param_3;
                local_478 = puVar7[2];
                uVar3 = puVar7[1];
                if ((*puVar7 - 9 < 2) &&
                   (FUN_18002e530((longlong)puVar7,0), uVar8 = local_478, (*param_3)[7] != 0)) {
                  do {
                    puVar7 = FUN_18002a710(*(longlong *)(*param_3 + uVar15 * 2 + 10) + 0x28,
                                           (*param_3)[3],uVar8,uVar3);
                    FUN_180029df0((int *)puVar7,
                                  (int **)(*(longlong *)(*param_3 + uVar15 * 2 + 10) + 0x130));
                    if (puVar7 != (uint *)0x0) {
                      free(puVar7);
                    }
                    uVar12 = (int)uVar15 + 1;
                    uVar15 = (ulonglong)uVar12;
                  } while (uVar12 < (*param_3)[7]);
                }
                puVar7 = *param_3;
                if (puVar7 == (uint *)0x0) {
                  *local_480 = puVar17;
                }
                else {
                  if (1 < *puVar7 - 9) {
                    FUN_180017490((longlong)puVar7);
                  }
                  *local_480 = puVar17;
                }
              }
            }
          }
        }
      }
    }
  }
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xfffffffffffffb38);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18000b8b0(uint *param_1,int *param_2)

{
  undefined8 *puVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  longlong lVar5;
  undefined8 *puVar6;
  byte bVar7;
  longlong lVar8;
  longlong lVar9;
  longlong *plVar10;
  uint uVar11;
  uint uVar12;
  int *piVar13;
  longlong lVar14;
  ulonglong uVar15;
  int iVar16;
  undefined8 *puVar17;
  short *psVar18;
  int iVar19;
  int iVar20;
  ulonglong uVar21;
  uint uVar22;
  uint uVar23;
  ulonglong uVar24;
  uint uVar25;
  int iVar26;
  uint uVar27;
  int *piVar28;
  bool bVar29;
  uint local_168;
  uint local_164;
  int local_160;
  int local_15c;
  longlong *local_158;
  int *local_150;
  int *local_148;
  longlong *local_140;
  int local_138;
  int local_134;
  int local_130;
  int local_12c;
  undefined8 local_128;
  int local_120;
  int local_11c;
  int local_118;
  int local_114;
  int local_110;
  int local_10c;
  undefined8 local_108 [25];
  undefined8 local_40;
  ulonglong local_38;

  local_38 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffe68;
  local_148 = param_2;
  if (param_2 != (int *)0x0) {
    local_168 = param_2[8];
    local_160 = param_2[5];
    uVar22 = param_2[7];
    local_15c = param_2[6];
    local_164 = uVar22;
    FUN_18000a930(param_1,param_2,&local_168,&local_160,&local_15c);
    uVar3 = local_168;
    uVar21 = (ulonglong)local_168;
    piVar28 = param_2;
    if (local_168 < uVar22) {
      if ((param_2[0x21f9] != 0) && ((int)(local_168 - 1) <= param_2[0x21f6])) {
        uVar15 = 0xffffffff;
        uVar27 = 0xffffffff;
        plVar10 = (longlong *)(param_2 + 10);
        iVar26 = 0;
        uVar24 = 0;
        local_150 = param_2 + 0x6e;
        if (local_168 != 0) {
          do {
            bVar29 = *(int *)(plVar10[uVar24] + 0x100) != 1;
            iVar16 = iVar26 + 1;
            if (bVar29) {
              iVar16 = iVar26;
            }
            iVar26 = iVar16;
            if (!bVar29) {
              uVar15 = uVar24;
            }
            uVar27 = (uint)uVar15;
            uVar22 = (int)uVar24 + 1;
            uVar24 = (ulonglong)uVar22;
            piVar28 = local_148;
          } while (uVar22 < local_168);
        }
        uVar22 = local_164;
        local_158 = plVar10;
        if (*piVar28 - 9U < 2) {
          if ((uVar27 == 0xffffffff) || (iVar26 == 1)) {
            piVar28[0x21f9] = 0;
            piVar28[0x21f6] = -1;
          }
        }
        else {
          if ((uVar27 == 0xffffffff) || (iVar26 == 1)) {
            piVar28[0x21f9] = 0;
            piVar28[0x21f6] = -1;
            uVar15 = uVar21;
            if (local_168 != 0) {
              do {
                *(undefined4 *)(*plVar10 + 0x100) = 0;
                uVar15 = uVar15 - 1;
                plVar10 = plVar10 + 1;
              } while (uVar15 != 0);
            }
          }
          else {
            local_140 = plVar10 + piVar28[0x21f6];
            piVar13 = param_2 + (longlong)(int)(*(int *)(plVar10[piVar28[0x21f6]] + 0x104) + uVar27)
                                * 7 + 0x6f;
            piVar2 = local_150;
            local_168 = uVar27;
            if ((piVar13 != (int *)0x0) && ((piVar13 + 6 <= &local_138 || (&local_120 <= piVar13))))
            {
              local_138 = *piVar13;
              local_134 = piVar13[1];
              local_130 = piVar13[2];
              local_12c = piVar13[3];
              local_128 = *(undefined8 *)(piVar13 + 4);
            }
            while (local_168 = local_168 + 1, local_168 < uVar3) {
              lVar5 = plVar10[local_168];
              piVar28 = local_148;
              if (*(int *)(lVar5 + 0x100) == 1) {
                if (piVar2 + (ulonglong)(*(int *)(*local_140 + 0x104) + local_168) * 7 + 1 !=
                    (int *)0x0) {
                  FUN_180023cd0(piVar2 + (ulonglong)(*(int *)(*local_140 + 0x104) + local_168) * 7 +
                                         1,&local_120);
                }
                puVar17 = (undefined8 *)
                          (piVar2 + (longlong)(int)(*(int *)(lVar5 + 0x104) + uVar27) * 7 + 1);
                piVar28 = local_148;
                if (puVar17 != (undefined8 *)0x0) {
                  lVar8 = (longlong)local_138;
                  lVar14 = (longlong)local_134;
                  iVar19 = (int)((ulonglong)(lVar14 * local_114 + lVar8 * local_120) >> 8);
                  *(int *)puVar17 = iVar19;
                  lVar9 = (longlong)(int)local_128;
                  iVar20 = (int)((ulonglong)(local_110 * lVar14 + local_11c * lVar8) >> 8);
                  *(int *)((longlong)puVar17 + 4) = iVar20;
                  lVar5 = (longlong)local_12c;
                  *(int *)(puVar17 + 1) =
                       (int)((ulonglong)(lVar14 * local_10c + local_118 * lVar8) >> 8) + local_130;
                  iVar16 = (int)((ulonglong)(local_110 * lVar9 + local_11c * lVar5) >> 8);
                  *(int *)(puVar17 + 2) = iVar16;
                  iVar26 = (int)((ulonglong)(local_114 * lVar9 + local_120 * lVar5) >> 8);
                  *(int *)((longlong)puVar17 + 0xc) = iVar26;
                  uVar11 = iVar26 - iVar20 >> 1;
                  local_158 = (longlong *)(ulonglong)uVar11;
                  bVar7 = 0xf;
                  uVar12 = 0x8000;
                  *(int *)((longlong)puVar17 + 0x14) =
                       (int)((ulonglong)(local_118 * lVar5 + lVar9 * local_10c) >> 8) +
                       local_128._4_4_;
                  iVar26 = iVar16 + iVar19 >> 1;
                  uVar25 = uVar11 * uVar11 + iVar26 * iVar26;
                  uVar22 = uVar25;
                  uVar23 = 0;
                  if (1 < uVar25) {
                    do {
                      uVar4 = uVar12 + uVar23 * 2 << (bVar7 & 0x1f);
                      bVar7 = bVar7 - 1;
                      uVar22 = uVar23;
                      if (uVar4 <= uVar25) {
                        uVar22 = uVar23 + uVar12;
                        uVar25 = uVar25 - uVar4;
                      }
                      uVar12 = uVar12 >> 1;
                      uVar23 = uVar22;
                    } while (uVar12 != 0);
                  }
                  piVar2 = local_150;
                  if (uVar22 == 0) {
                    *puVar17 = 0x100;
                    *(undefined4 *)(puVar17 + 2) = 0x100;
                    *(undefined4 *)((longlong)puVar17 + 0xc) = 0;
                  }
                  else {
                    iVar26 = (((int)uVar22 >> 1) + iVar26 * 0x100) / (int)uVar22;
                    *(int *)puVar17 = iVar26;
                    *(int *)(puVar17 + 2) = iVar26;
                    iVar26 = (int)(((int)uVar22 >> 1) + uVar11 * -0x100) / (int)uVar22;
                    *(int *)((longlong)puVar17 + 4) = iVar26;
                    *(int *)((longlong)puVar17 + 0xc) = -iVar26;
                  }
                }
              }
            }
            piVar28[0x21f6] = uVar27;
            uVar22 = local_164;
          }
        }
      }
      iVar26 = 0;
      if (0 < (int)uVar3) {
        plVar10 = (longlong *)(piVar28 + 10);
        do {
          lVar5 = *plVar10;
          plVar10 = plVar10 + 1;
          *(int *)(lVar5 + 0x11c) = iVar26;
          iVar26 = iVar26 + 1;
        } while (iVar26 < (int)uVar3);
      }
      if (uVar3 < uVar22) {
        lVar5 = uVar21 << 3;
        uVar21 = (ulonglong)(uVar22 - uVar3);
        do {
          FUN_180004ab0((void **)(lVar5 + 0x28 + (longlong)piVar28));
          lVar5 = lVar5 + 8;
          uVar21 = uVar21 - 1;
        } while (uVar21 != 0);
      }
      piVar28[7] = uVar3;
      puVar17 = (undefined8 *)(piVar28 + 0x21fa);
      piVar28[9] = ((uVar3 - 1) * uVar3 >> 1) + 1;
      if (puVar17 != (undefined8 *)0x0) {
        if ((piVar28 + 0x222c <= local_108) || (&local_40 <= puVar17)) {
          memcpy_FUN_180061f90(local_108,puVar17,200);
        }
        if (puVar17 != (undefined8 *)0x0) {
          lVar5 = 3;
          puVar6 = puVar17;
          do {
            *puVar6 = 0xffffffffffffffff;
            puVar6[1] = 0xffffffffffffffff;
            puVar6[2] = 0xffffffffffffffff;
            puVar1 = puVar6 + 8;
            puVar6[3] = 0xffffffffffffffff;
            puVar6[4] = 0xffffffffffffffff;
            puVar6[5] = 0xffffffffffffffff;
            puVar6[6] = 0xffffffffffffffff;
            puVar6[7] = 0xffffffffffffffff;
            lVar5 = lVar5 + -1;
            puVar6 = puVar1;
          } while (lVar5 != 0);
          *puVar1 = 0xffffffffffffffff;
        }
      }
      puVar6 = local_108;
      lVar5 = 0x32;
      do {
        iVar26 = *(int *)puVar6;
        if ((-1 < iVar26) && (iVar26 < piVar28[7])) {
          *(int *)puVar17 = iVar26;
          puVar17 = (undefined8 *)((longlong)puVar17 + 4);
        }
        puVar6 = (undefined8 *)((longlong)puVar6 + 4);
        lVar5 = lVar5 + -1;
      } while (lVar5 != 0);
    }
    piVar28[5] = local_160;
    piVar28[6] = local_15c;
    piVar28[8] = uVar3;
    if ((1 < *piVar28 - 9U) && (uVar21 = 0, piVar28[7] != 0)) {
      do {
        iVar26 = 0;
        lVar5 = *(longlong *)(*(longlong *)(piVar28 + uVar21 * 2 + 10) + 0xf8);
        if (0 < *(int *)(*(longlong *)(piVar28 + uVar21 * 2 + 10) + 0xf0)) {
          psVar18 = (short *)(lVar5 + 6);
          do {
            if (*psVar18 < 0) {
              *psVar18 = *psVar18 + 0x3244;
            }
            FUN_18000fe00((longlong)iVar26 * 0x38 + lVar5,0);
            iVar26 = iVar26 + 1;
            psVar18 = psVar18 + 0x1c;
          } while (iVar26 < *(int *)(*(longlong *)(piVar28 + uVar21 * 2 + 10) + 0xf0));
        }
        uVar22 = (int)uVar21 + 1;
        uVar21 = (ulonglong)uVar22;
      } while (uVar22 < (uint)piVar28[7]);
    }
  }
  FUN_18005f100(local_38 ^ (ulonglong)&stack0xfffffffffffffe68);
  return;
}



// WARNING: Removing unreachable block (ram,0x00018000c0b5)
// WARNING: Removing unreachable block (ram,0x00018000c16d)
// WARNING: Removing unreachable block (ram,0x00018000bfb0)

void FUN_18000bea0(uint **param_1,uint *param_2,longlong *param_3)

{
  longlong lVar1;
  bool bVar2;
  ulonglong uVar3;
  undefined *puVar4;
  uint uVar5;
  uint *puVar6;
  uint *puVar7;
  uint uVar8;
  uint *puVar9;
  bool bVar10;
  uint local_38;
  uint local_34;
  ulonglong local_30;

  local_30 = DAT_1800b04e8 ^ (ulonglong)&local_38;
  puVar7 = *param_1;
  uVar8 = 0;
  if (*param_2 < 4) {
    *param_1 = puVar7;
  }
  else {
    if ((puVar7 != (uint *)0x0) && ((puVar7 + 1 <= &local_38 || (&local_34 <= puVar7)))) {
      uVar8 = *puVar7;
    }
    uVar5 = *param_2 - 4;
    puVar7 = puVar7 + 1;
    *param_2 = uVar5;
    if (uVar8 <= uVar5) {
      puVar9 = (uint *)((longlong)(int)uVar8 + (longlong)puVar7);
      bVar2 = false;
      puVar6 = puVar7;
joined_r0x00018000bf2c:
      puVar7 = puVar6;
      if ((puVar9 <= puVar7) || (bVar2)) goto LAB_18000c26b;
      *param_2 = *param_2 - 1;
      puVar6 = (uint *)((longlong)puVar7 + 1);
      uVar8 = *param_2;
      switch(*(undefined *)puVar7) {
      case 0xa1:
        puVar4 = (undefined *)*param_3;
        uVar5 = 0xffff0006;
        if ((puVar6 != (uint *)0x0) &&
           (((undefined *)((longlong)puVar7 + 5U) <= &local_38 || (&local_34 <= puVar6)))) {
          uVar5 = *puVar6;
        }
        puVar6 = (uint *)((longlong)puVar7 + 5);
        *param_2 = uVar8 - 4;
        if (uVar5 <= uVar8 - 4) {
          if (uVar5 - 1 < 200) {
            if ((((puVar4 != (undefined *)0x0) && (puVar6 != (uint *)0x0)) && (uVar5 != 0)) &&
               (((uVar3 = (ulonglong)uVar5, (undefined *)(uVar3 + (longlong)puVar6) <= puVar4 ||
                 (puVar4 + uVar3 <= puVar6)) && (uVar5 != 0)))) {
              puVar6 = (uint *)((longlong)puVar6 - (longlong)puVar4);
              do {
                *puVar4 = *(undefined *)((longlong)puVar6 + (longlong)puVar4);
                puVar4 = puVar4 + 1;
                uVar3 = uVar3 - 1;
              } while (uVar3 != 0);
            }
LAB_18000c001:
            puVar6 = (uint *)((longlong)puVar7 + (longlong)(int)uVar5 + 5);
            *param_2 = *param_2 - uVar5;
          }
          goto LAB_18000c009;
        }
        bVar2 = true;
        goto joined_r0x00018000bf2c;
      case 0xa2:
        puVar4 = (undefined *)(*param_3 + 200);
        bVar10 = puVar4 == (undefined *)0x0;
        break;
      case 0xa3:
        uVar5 = 0xffff0006;
        puVar4 = (undefined *)(*param_3 + 0xcc);
        if ((puVar6 != (uint *)0x0) &&
           (((undefined *)((longlong)puVar7 + 5U) <= &local_38 || (&local_34 <= puVar6)))) {
          uVar5 = *puVar6;
        }
        puVar6 = (uint *)((longlong)puVar7 + 5);
        *param_2 = uVar8 - 4;
        if (uVar5 <= uVar8 - 4) {
          if (uVar5 - 1 < 0x40) {
            if (((((puVar4 != (undefined *)0x0) && (puVar6 != (uint *)0x0)) && (uVar5 != 0)) &&
                ((uVar3 = (ulonglong)uVar5, (undefined *)(uVar3 + (longlong)puVar6) <= puVar4 ||
                 (puVar4 + uVar3 <= puVar6)))) && (uVar5 != 0)) {
              puVar6 = (uint *)((longlong)puVar6 - (longlong)puVar4);
              do {
                *puVar4 = *(undefined *)((longlong)puVar6 + (longlong)puVar4);
                puVar4 = puVar4 + 1;
                uVar3 = uVar3 - 1;
              } while (uVar3 != 0);
            }
            goto LAB_18000c001;
          }
          goto LAB_18000c009;
        }
        bVar2 = true;
        goto joined_r0x00018000bf2c;
      case 0xa4:
        uVar5 = 0xffff0006;
        puVar4 = (undefined *)(*param_3 + 0x10c);
        if ((puVar6 != (uint *)0x0) &&
           (((undefined *)((longlong)puVar7 + 5U) <= &local_38 || (&local_34 <= puVar6)))) {
          uVar5 = *puVar6;
        }
        puVar6 = (uint *)((longlong)puVar7 + 5);
        *param_2 = uVar8 - 4;
        if (uVar8 - 4 < uVar5) {
          bVar2 = true;
        }
        else {
          if (uVar5 - 1 < 0x400) {
            if (((((puVar4 != (undefined *)0x0) && (puVar6 != (uint *)0x0)) && (uVar5 != 0)) &&
                ((uVar3 = (ulonglong)uVar5, (undefined *)(uVar3 + (longlong)puVar6) <= puVar4 ||
                 (puVar4 + uVar3 <= puVar6)))) && (uVar5 != 0)) {
              puVar6 = (uint *)((longlong)puVar6 - (longlong)puVar4);
              do {
                *puVar4 = *(undefined *)((longlong)puVar6 + (longlong)puVar4);
                puVar4 = puVar4 + 1;
                uVar3 = uVar3 - 1;
              } while (uVar3 != 0);
            }
            goto LAB_18000c001;
          }
LAB_18000c009:
          if ((int)uVar5 < 0) {
            bVar2 = true;
          }
        }
        goto joined_r0x00018000bf2c;
      case 0xa5:
        puVar4 = (undefined *)(*param_3 + 0x50c);
        bVar10 = puVar4 == (undefined *)0x0;
        break;
      case 0xa6:
        puVar4 = (undefined *)(*param_3 + 0x510);
        bVar10 = puVar4 == (undefined *)0x0;
        break;
      case 0xa7:
        puVar4 = (undefined *)(*param_3 + 0x514);
        bVar10 = puVar4 == (undefined *)0x0;
        break;
      case 0xa8:
        lVar1 = *param_3;
        puVar4 = (undefined *)(lVar1 + 0x518);
        if (((puVar4 != (undefined *)0x0) && (puVar6 != (uint *)0x0)) &&
           (((undefined *)((longlong)puVar7 + 5U) <= puVar4 || ((uint *)(lVar1 + 0x51cU) <= puVar6))
           )) {
          *puVar4 = *(undefined *)puVar6;
          *(undefined *)(lVar1 + 0x519) = *(undefined *)((longlong)puVar7 + 2);
          *(undefined *)(lVar1 + 0x51a) = *(undefined *)((longlong)puVar7 + 3);
          *(undefined *)(lVar1 + 0x51b) = *(undefined *)(puVar7 + 1);
        }
        goto LAB_18000c254;
      default:
        goto joined_r0x00018000bf2c;
      }
      if (((!bVar10) && (puVar6 != (uint *)0x0)) &&
         (((undefined *)((longlong)puVar7 + 5U) <= puVar4 || (puVar4 + 4 <= puVar6)))) {
        *puVar4 = *(undefined *)puVar6;
        puVar4[1] = *(undefined *)((longlong)puVar7 + 2);
        puVar4[2] = *(undefined *)((longlong)puVar7 + 3);
        puVar4[3] = *(undefined *)(puVar7 + 1);
      }
LAB_18000c254:
      *param_2 = *param_2 - 4;
      puVar6 = (uint *)((longlong)puVar7 + 5);
      goto joined_r0x00018000bf2c;
    }
LAB_18000c26b:
    *param_1 = puVar7;
  }
  FUN_18005f100(local_30 ^ (ulonglong)&local_38);
  return;
}



void FUN_18000c2b0(uint **param_1,uint *param_2,longlong *param_3)

{
  char cVar1;
  uint *puVar2;
  uint *puVar3;
  uint *puVar4;
  uint uVar5;
  uint uVar6;
  char *pcVar7;
  bool bVar8;
  uint local_18;
  uint local_14;
  ulonglong local_10;

  local_10 = DAT_1800b04e8 ^ (ulonglong)&local_18;
  puVar3 = *param_1;
  if (*param_2 < 4) {
    *param_1 = puVar3;
    FUN_18005f100(local_10 ^ (ulonglong)&local_18);
    return;
  }
  uVar5 = 0;
  if ((puVar3 != (uint *)0x0) && ((puVar3 + 1 <= &local_18 || (uVar5 = 0, &local_14 <= puVar3)))) {
    uVar5 = *puVar3;
  }
  uVar6 = *param_2 - 4;
  puVar3 = puVar3 + 1;
  *param_2 = uVar6;
  if (uVar6 < uVar5) {
    *param_1 = puVar3;
    FUN_18005f100(local_10 ^ (ulonglong)&local_18);
    return;
  }
  puVar4 = puVar3;
  while( true ) {
    while( true ) {
      puVar2 = puVar4;
      if ((uint *)((longlong)(int)uVar5 + (longlong)puVar3) <= puVar2) {
        *param_1 = puVar2;
        FUN_18005f100(local_10 ^ (ulonglong)&local_18);
        return;
      }
      *param_2 = *param_2 - 1;
      cVar1 = *(char *)puVar2;
      puVar4 = (uint *)((longlong)puVar2 + 1);
      if (cVar1 != -0xf) break;
      uVar6 = 0;
      if ((puVar4 != (uint *)0x0) &&
         (((char *)((longlong)puVar2 + 5U) <= &local_18 || (&local_14 <= puVar4)))) {
        uVar6 = *puVar4;
      }
      *param_2 = *param_2 - (uVar6 + 4);
      puVar4 = (uint *)((longlong)puVar4 + (ulonglong)(uVar6 + 4));
    }
    if (cVar1 == -0xe) break;
    if (cVar1 == -0xd) {
      pcVar7 = (char *)(*param_3 + 0xc);
      bVar8 = pcVar7 == (char *)0x0;
      goto LAB_18000c3ab;
    }
    if (cVar1 == -0xc) {
      pcVar7 = (char *)(*param_3 + 0x10);
      bVar8 = pcVar7 == (char *)0x0;
      goto LAB_18000c3ab;
    }
    if (cVar1 == -0xb) {
      pcVar7 = (char *)(*param_3 + 0x14);
      bVar8 = pcVar7 == (char *)0x0;
LAB_18000c3ab:
      if (((!bVar8) && (puVar4 != (uint *)0x0)) &&
         (((char *)((longlong)puVar2 + 5U) <= pcVar7 || (pcVar7 + 4 <= puVar4)))) {
        *pcVar7 = *(char *)puVar4;
        pcVar7[1] = *(char *)((longlong)puVar2 + 2);
        pcVar7[2] = *(char *)((longlong)puVar2 + 3);
        pcVar7[3] = *(char *)(puVar2 + 1);
      }
      *param_2 = *param_2 - 4;
      puVar4 = (uint *)((longlong)puVar2 + 5);
    }
  }
  pcVar7 = (char *)(*param_3 + 8);
  bVar8 = pcVar7 == (char *)0x0;
  goto LAB_18000c3ab;
}



void FUN_18000c440(uint **param_1,uint *param_2,uint **param_3,uint *param_4)

{
  uint uVar1;
  undefined8 *puVar2;
  uint *puVar3;
  uint *puVar4;
  uint *puVar5;
  uint *puVar6;
  uint *puVar7;
  uint uVar8;
  uint *puVar9;
  bool bVar10;
  undefined auStack104 [32];
  uint local_48;
  uint local_44;
  ulonglong local_40;

  local_40 = DAT_1800b04e8 ^ (ulonglong)auStack104;
  puVar4 = *param_1;
  puVar7 = puVar4;
  if (3 < *param_2) {
    uVar8 = 0;
    if ((puVar4 != (uint *)0x0) && ((puVar4 + 1 <= &local_48 || (uVar8 = 0, &local_44 <= puVar4))))
    {
      uVar8 = *puVar4;
    }
    uVar1 = *param_2 - 4;
    puVar7 = puVar4 + 1;
    *param_2 = uVar1;
    if (uVar8 <= uVar1) {
      puVar2 = (undefined8 *)malloc(0x1c);
      *param_3 = (uint *)puVar2;
      if (puVar2 != (undefined8 *)0x0) {
        puVar9 = (uint *)((longlong)(int)uVar8 + (longlong)puVar7);
        *puVar2 = 0;
        puVar2[1] = 0;
        puVar2[2] = 0;
        *(undefined4 *)(puVar2 + 3) = 0;
        if (puVar7 < puVar9) {
          puVar4 = puVar4 + 2;
          do {
            *param_2 = *param_2 - 1;
            puVar5 = (uint *)((longlong)puVar4 + 1);
            puVar6 = (uint *)((longlong)puVar7 + 1);
            switch(*(undefined *)puVar7) {
            case 0xe1:
              puVar3 = *param_3;
              bVar10 = puVar3 == (uint *)0x0;
              break;
            default:
              goto switchD_18000c526_caseD_e2;
            case 0xe3:
              if (((param_4 != (uint *)0x0) && (puVar6 != (uint *)0x0)) &&
                 ((puVar5 <= param_4 || (param_4 + 1 <= puVar6)))) {
                *(undefined *)param_4 = *(undefined *)puVar6;
                *(undefined *)((longlong)param_4 + 1) = *(undefined *)((longlong)puVar7 + 2);
                *(undefined *)((longlong)param_4 + 2) = *(undefined *)((longlong)puVar7 + 3);
                *(undefined *)((longlong)param_4 + 3) = *(undefined *)(puVar7 + 1);
              }
              goto LAB_18000c5d7;
            case 0xe4:
              puVar3 = *param_3 + 1;
              bVar10 = puVar3 == (uint *)0x0;
              break;
            case 0xe5:
              puVar3 = *param_3 + 2;
              bVar10 = puVar3 == (uint *)0x0;
              break;
            case 0xe6:
              puVar3 = *param_3 + 3;
              bVar10 = puVar3 == (uint *)0x0;
              break;
            case 0xe7:
              puVar3 = *param_3 + 4;
              bVar10 = puVar3 == (uint *)0x0;
              break;
            case 0xe8:
              puVar3 = *param_3 + 5;
              bVar10 = puVar3 == (uint *)0x0;
              break;
            case 0xe9:
              puVar3 = *param_3 + 6;
              bVar10 = puVar3 == (uint *)0x0;
            }
            if (((!bVar10) && (puVar6 != (uint *)0x0)) &&
               ((puVar5 <= puVar3 || (puVar3 + 1 <= puVar6)))) {
              *(undefined *)puVar3 = *(undefined *)puVar6;
              *(undefined *)((longlong)puVar3 + 1) = *(undefined *)((longlong)puVar7 + 2);
              *(undefined *)((longlong)puVar3 + 2) = *(undefined *)((longlong)puVar7 + 3);
              *(undefined *)((longlong)puVar3 + 3) = *(undefined *)(puVar7 + 1);
            }
LAB_18000c5d7:
            *param_2 = *param_2 - 4;
            puVar6 = (uint *)((longlong)puVar7 + 5);
            puVar5 = (uint *)((longlong)puVar4 + 5);
switchD_18000c526_caseD_e2:
            puVar4 = puVar5;
            puVar7 = puVar6;
          } while (puVar6 < puVar9);
        }
      }
    }
  }
  *param_1 = puVar7;
  FUN_18005f100(local_40 ^ (ulonglong)auStack104);
  return;
}



void FUN_18000c640(uint **param_1,uint *param_2,uint **param_3,uint *param_4)

{
  undefined8 *puVar1;
  byte bVar2;
  ushort uVar3;
  uint uVar4;
  undefined8 *puVar5;
  uint *puVar6;
  undefined4 uVar7;
  longlong lVar8;
  longlong lVar9;
  longlong lVar10;
  short sVar11;
  ulonglong uVar12;
  int iVar13;
  uint *puVar14;
  uint uVar15;
  uint **ppuVar16;
  uint *puVar17;
  ulonglong uVar18;
  ulonglong uVar19;
  ulonglong uVar20;
  ulonglong uVar21;
  bool bVar22;
  undefined auStack392 [32];
  uint *local_168;
  uint *local_160;
  uint **local_158;
  uint *local_150;
  uint *local_148;
  uint local_140;
  uint local_13c;
  undefined8 local_138;
  undefined8 local_128;
  uint local_60 [2];
  ulonglong local_58;

  local_58 = DAT_1800b04e8 ^ (ulonglong)auStack392;
  puVar14 = *param_1;
  uVar12 = 0;
  uVar4 = 0;
  local_160 = param_4;
  local_158 = param_1;
  local_150 = param_2;
  if (3 < *param_2) {
    if ((puVar14 != (uint *)0x0) && ((puVar14 + 1 <= &local_140 || (&local_13c <= puVar14)))) {
      uVar4 = *puVar14;
    }
    uVar15 = *param_2 - 4;
    puVar14 = puVar14 + 1;
    *param_2 = uVar15;
    if (uVar4 <= uVar15) {
      uVar19 = 1;
      **param_3 = param_4[1];
      (*param_3)[1] = param_4[2];
      local_148 = (uint *)((longlong)(int)uVar4 + (longlong)puVar14);
      local_140 = 0;
      if (puVar14 < local_148) {
        uVar20 = 0xc0000000000000cd;
        puVar6 = puVar14;
        uVar21 = uVar12;
        do {
          uVar18 = 0;
          iVar13 = (int)uVar21;
          puVar14 = puVar6;
          if ((int)uVar12 != 0) break;
          *param_2 = *param_2 - 1;
          puVar14 = (uint *)((longlong)puVar6 + 1);
          uVar4 = *param_2;
          local_138 = puVar14;
          switch(*(undefined *)puVar6) {
          case 0xb1:
            puVar14 = (uint *)FUN_180009170((int *)puVar14,(int *)param_2);
            goto LAB_18000c97b;
          case 0xb2:
            ppuVar16 = (uint **)(*param_3 + 2);
            goto LAB_18000c770;
          case 0xb3:
            puVar17 = *param_3 + 0x3c;
            bVar22 = puVar17 == (uint *)0x0;
            break;
          case 0xb4:
            uVar4 = *param_4;
            if ((uVar4 < 0x40) && ((uVar20 >> ((longlong)(int)uVar4 & 0x3fU) & 1) != 0)) {
              if (param_4[5] <= (*param_3)[0x3c] && (*param_3)[0x3c] != param_4[5])
              goto LAB_18000cc96;
              local_168 = (uint *)malloc(0x1680);
              if (local_168 == (uint *)0x0) {
                uVar21 = 0xffff0002;
              }
              else {
                uVar4 = FUN_180009310((uint **)&local_138,param_2,&local_168,0x1680);
                uVar21 = (ulonglong)uVar4;
                puVar14 = *param_3;
                if (*(longlong *)(puVar14 + 0x3e) == 0) {
                  uVar21 = 0xffff0002;
                  free(local_168);
                  puVar14 = local_138;
                }
                else {
                  if (0 < (int)puVar14[0x3c]) {
                    lVar8 = 0;
                    puVar6 = local_168;
                    do {
                      *(undefined2 *)(lVar8 + *(longlong *)(puVar14 + 0x3e)) = 0;
                      *(ushort *)(*(longlong *)(*param_3 + 0x3e) + 2 + lVar8) =
                           *(ushort *)((longlong)puVar6 + 2) & 0xfff0;
                      *(ushort *)(*(longlong *)(*param_3 + 0x3e) + 4 + lVar8) =
                           (ushort)(*puVar6 >> 4) & 0xfff0;
                      bVar2 = *(byte *)puVar6;
                      if (bVar2 < 0x80) {
                        sVar11 = (ushort)bVar2 << 8;
                      }
                      else {
                        sVar11 = (ushort)bVar2 * -0x100 + -0x8000;
                      }
                      *(short *)(*(longlong *)(*param_3 + 0x3e) + 6 + lVar8) = sVar11;
                      *(undefined4 *)(*(longlong *)(*param_3 + 0x3e) + 8 + lVar8) = 0;
                      lVar9 = (longlong)(int)uVar18;
                      puVar17 = local_168 + lVar9 * 8 + 1;
                      puVar14 = (uint *)(*(longlong *)(*param_3 + 0x3e) + 0x10 + lVar9 * 0x38);
                      if (((puVar14 != (uint *)0x0) && (puVar17 != (uint *)0x0)) &&
                         ((puVar17 + 5 <= puVar14 || (puVar14 + 5 <= puVar17)))) {
                        puVar17 = (uint *)((longlong)puVar17 - (longlong)puVar14);
                        lVar10 = 0x14;
                        do {
                          *(byte *)puVar14 = *(byte *)((longlong)puVar17 + (longlong)puVar14);
                          puVar14 = (uint *)((longlong)puVar14 + 1);
                          lVar10 = lVar10 + -1;
                        } while (lVar10 != 0);
                      }
                      puVar14 = local_168 + lVar9 * 8 + 6;
                      *(undefined4 *)(*(longlong *)(*param_3 + 0x3e) + 0x24 + lVar8) = 0;
                      puVar17 = (uint *)(*(longlong *)(*param_3 + 0x3e) + 0x28 + lVar9 * 0x38);
                      if (((puVar17 != (uint *)0x0) && (puVar14 != (uint *)0x0)) &&
                         ((puVar14 + 2 <= puVar17 || (puVar17 + 2 <= puVar14)))) {
                        *(byte *)puVar17 = *(byte *)puVar14;
                        *(byte *)((longlong)puVar17 + 1) = *(byte *)((longlong)puVar14 + 1);
                        *(byte *)((longlong)puVar17 + 2) = *(byte *)((longlong)puVar14 + 2);
                        *(byte *)((longlong)puVar17 + 3) = *(byte *)((longlong)puVar14 + 3);
                        *(byte *)(puVar17 + 1) = *(byte *)(puVar14 + 1);
                        *(byte *)((longlong)puVar17 + 5) = *(byte *)((longlong)puVar14 + 5);
                        *(byte *)((longlong)puVar17 + 6) = *(byte *)((longlong)puVar14 + 6);
                        *(byte *)((longlong)puVar17 + 7) = *(byte *)((longlong)puVar14 + 7);
                      }
                      uVar4 = (int)uVar18 + 1;
                      uVar18 = (ulonglong)uVar4;
                      puVar6 = puVar6 + 8;
                      *(undefined4 *)(*(longlong *)(*param_3 + 0x3e) + 0x30 + lVar8) = 0;
                      *(undefined4 *)(*(longlong *)(*param_3 + 0x3e) + 0x34 + lVar8) = 0;
                      lVar8 = lVar8 + 0x38;
                      puVar14 = *param_3;
                      param_4 = local_160;
                      param_2 = local_150;
                    } while ((int)uVar4 < (int)puVar14[0x3c]);
                  }
                  free(local_168);
                  puVar14 = local_138;
                }
              }
            }
            else {
              uVar15 = param_4[5];
              if (uVar4 - 9 < 2) {
                puVar6 = *param_3 + 0x3c;
                if (uVar15 <= *puVar6 && *puVar6 != uVar15) goto LAB_18000cc96;
                local_168 = (uint *)malloc(0x1680);
                if (local_168 == (uint *)0x0) {
                  uVar21 = 0xffff0002;
                }
                else {
                  uVar4 = FUN_180009310((uint **)&local_138,param_2,&local_168,0x1680);
                  uVar21 = (ulonglong)uVar4;
                  puVar14 = *param_3;
                  if (*(longlong *)(puVar14 + 0x3e) == 0) {
                    free(local_168);
                    puVar14 = local_138;
                    uVar21 = 0xffff0002;
                  }
                  else {
                    uVar12 = uVar18;
                    puVar6 = local_168;
                    if (0 < (int)puVar14[0x3c]) {
                      do {
                        *(undefined2 *)(uVar12 + *(longlong *)(puVar14 + 0x3e)) = 0;
                        *(ushort *)(*(longlong *)(*param_3 + 0x3e) + 2 + uVar12) =
                             *(ushort *)((longlong)puVar6 + 2) & 0xfff0;
                        *(ushort *)(*(longlong *)(*param_3 + 0x3e) + 4 + uVar12) =
                             (ushort)(*puVar6 >> 4) & 0xfff0;
                        bVar2 = *(byte *)puVar6;
                        if (bVar2 < 0x80) {
                          sVar11 = (ushort)bVar2 << 8;
                        }
                        else {
                          sVar11 = (ushort)bVar2 * -0x100 + -0x8000;
                        }
                        *(short *)(*(longlong *)(*param_3 + 0x3e) + 6 + uVar12) = sVar11;
                        *(undefined4 *)(*(longlong *)(*param_3 + 0x3e) + 8 + uVar12) = 0;
                        *(undefined2 *)(uVar12 + *(longlong *)(*param_3 + 0x3e)) =
                             *(undefined2 *)(puVar6 + 7);
                        *(int *)(*(longlong *)(*param_3 + 0x3e) + 0xc + uVar12) =
                             (int)*(short *)((longlong)puVar6 + 0x1e);
                        iVar13 = (int)uVar18;
                        puVar17 = local_168 + (longlong)iVar13 * 8 + 1;
                        puVar14 = (uint *)((longlong)iVar13 * 0x38 +
                                          *(longlong *)(*param_3 + 0x3e) + 0x10);
                        if (((puVar14 != (uint *)0x0) && (puVar17 != (uint *)0x0)) &&
                           ((puVar17 + 6 <= puVar14 || (puVar14 + 6 <= puVar17)))) {
                          puVar17 = (uint *)((longlong)puVar17 - (longlong)puVar14);
                          lVar8 = 0x18;
                          do {
                            *(byte *)puVar14 = *(byte *)((longlong)puVar17 + (longlong)puVar14);
                            puVar14 = (uint *)((longlong)puVar14 + 1);
                            lVar8 = lVar8 + -1;
                          } while (lVar8 != 0);
                        }
                        puVar14 = *param_3;
                        uVar18 = (ulonglong)(iVar13 + 1U);
                        uVar12 = uVar12 + 0x38;
                        puVar6 = puVar6 + 8;
                        param_4 = local_160;
                      } while ((int)(iVar13 + 1U) < (int)puVar14[0x3c]);
                    }
                    free(local_168);
                    puVar14 = local_138;
                  }
                }
              }
              else {
                puVar6 = *param_3 + 0x3c;
                if (uVar15 <= *puVar6 && *puVar6 != uVar15) {
LAB_18000cc96:
                  FUN_180009170((int *)puVar14,(int *)param_2);
                  goto LAB_18000c97b;
                }
                local_168 = (uint *)malloc(0x13b0);
                if (local_168 == (uint *)0x0) {
                  uVar21 = 0xffff0002;
                }
                else {
                  uVar4 = FUN_180009310((uint **)&local_138,param_2,&local_168,0x13b0);
                  puVar14 = *param_3;
                  uVar12 = uVar18;
                  puVar6 = local_168;
                  if (0 < (int)puVar14[0x3c]) {
                    do {
                      *(undefined2 *)(uVar18 + *(longlong *)(puVar14 + 0x3e)) = 0;
                      *(ushort *)(*(longlong *)(*param_3 + 0x3e) + 2 + uVar18) =
                           *(ushort *)((longlong)puVar6 + 2) & 0xfff0;
                      *(ushort *)(*(longlong *)(*param_3 + 0x3e) + 4 + uVar18) =
                           (ushort)(*puVar6 >> 4) & 0xfff0;
                      bVar2 = *(byte *)puVar6;
                      if (bVar2 < 0x80) {
                        sVar11 = (ushort)bVar2 << 8;
                      }
                      else {
                        sVar11 = (ushort)bVar2 * -0x100 + -0x8000;
                      }
                      *(short *)(*(longlong *)(*param_3 + 0x3e) + 6 + uVar18) = sVar11;
                      *(undefined4 *)(*(longlong *)(*param_3 + 0x3e) + 8 + uVar18) = 0;
                      iVar13 = (int)uVar12;
                      puVar17 = local_168 + (longlong)iVar13 * 7 + 1;
                      puVar14 = (uint *)(*(longlong *)(*param_3 + 0x3e) + 0x10 +
                                        (longlong)iVar13 * 0x38);
                      if (((puVar14 != (uint *)0x0) && (puVar17 != (uint *)0x0)) &&
                         ((puVar17 + 6 <= puVar14 || (puVar14 + 6 <= puVar17)))) {
                        puVar17 = (uint *)((longlong)puVar17 - (longlong)puVar14);
                        lVar8 = 0x18;
                        do {
                          *(byte *)puVar14 = *(byte *)((longlong)puVar17 + (longlong)puVar14);
                          puVar14 = (uint *)((longlong)puVar14 + 1);
                          lVar8 = lVar8 + -1;
                        } while (lVar8 != 0);
                      }
                      puVar14 = *param_3;
                      uVar18 = uVar18 + 0x38;
                      uVar12 = (ulonglong)(iVar13 + 1U);
                      puVar6 = puVar6 + 7;
                    } while ((int)(iVar13 + 1U) < (int)puVar14[0x3c]);
                  }
                  free(local_168);
                  puVar14 = local_138;
                  uVar21 = (ulonglong)uVar4;
                }
              }
            }
            goto LAB_18000c96b;
          case 0xb5:
            puVar17 = *param_3 + 0x40;
            bVar22 = puVar17 == (uint *)0x0;
            break;
          case 0xb6:
            puVar17 = *param_3 + 0x41;
            bVar22 = puVar17 == (uint *)0x0;
            break;
          case 0xb7:
            puVar17 = *param_3 + 0x42;
            bVar22 = puVar17 == (uint *)0x0;
            break;
          case 0xb8:
            puVar17 = *param_3 + 0x43;
            bVar22 = puVar17 == (uint *)0x0;
            break;
          case 0xb9:
            puVar17 = *param_3 + 0x44;
            bVar22 = puVar17 == (uint *)0x0;
            break;
          case 0xba:
            puVar17 = *param_3 + 0x45;
            bVar22 = puVar17 == (uint *)0x0;
            break;
          case 0xbb:
            puVar17 = *param_3 + 0x46;
            bVar22 = puVar17 == (uint *)0x0;
            break;
          case 0xbc:
            puVar17 = *param_3 + 0x47;
            bVar22 = puVar17 == (uint *)0x0;
            break;
          case 0xbd:
            puVar17 = *param_3 + 0x48;
            bVar22 = puVar17 == (uint *)0x0;
            break;
          case 0xbe:
            puVar17 = *param_3 + 0x49;
            bVar22 = puVar17 == (uint *)0x0;
            break;
          default:
            goto switchD_18000c754_caseD_bf;
          case 0xcd:
            ppuVar16 = (uint **)(*param_3 + 6);
            goto LAB_18000c770;
          case 0xce:
            lVar8 = 3;
            puVar5 = &local_128;
            do {
              *puVar5 = 0xffffffffffffffff;
              puVar5[1] = 0xffffffffffffffff;
              puVar5[2] = 0xffffffffffffffff;
              puVar1 = puVar5 + 8;
              puVar5[3] = 0xffffffffffffffff;
              puVar5[4] = 0xffffffffffffffff;
              puVar5[5] = 0xffffffffffffffff;
              puVar5[6] = 0xffffffffffffffff;
              puVar5[7] = 0xffffffffffffffff;
              lVar8 = lVar8 + -1;
              puVar5 = puVar1;
            } while (lVar8 != 0);
            *puVar1 = 0xffffffffffffffff;
            uVar21 = 0xffff0006;
            if ((puVar14 != (uint *)0x0) &&
               (((undefined8 *)((longlong)puVar6 + 5U) <= &local_138 ||
                ((uint *)((longlong)&local_138 + 4U) <= puVar14)))) {
              uVar21 = (ulonglong)*puVar14;
            }
            uVar4 = uVar4 - 4;
            puVar14 = (uint *)((longlong)puVar6 + 5);
            *param_2 = uVar4;
            uVar15 = (uint)uVar21;
            if (uVar4 < uVar15) {
              uVar12 = uVar19 & 0xffffffff;
              uVar21 = 0xffff0006;
              local_140 = (uint)uVar12;
            }
            else {
              if (uVar15 - 1 < 200) {
                puVar5 = &local_128;
                if ((((puVar14 != (uint *)0x0) && (uVar15 != 0)) &&
                    (((undefined8 *)(uVar21 + (longlong)puVar14) <= &local_128 ||
                     ((uint *)((longlong)&local_128 + uVar21) <= puVar14)))) && (uVar15 != 0)) {
                  uVar12 = uVar21;
                  do {
                    *(undefined *)puVar5 =
                         *(undefined *)
                          ((longlong)((longlong)puVar14 - (longlong)&local_128) + (longlong)puVar5);
                    puVar5 = (undefined8 *)((longlong)puVar5 + 1);
                    uVar12 = uVar12 - 1;
                  } while (uVar12 != 0);
                }
                puVar14 = (uint *)((longlong)puVar14 + (longlong)(int)uVar15);
                *param_2 = uVar4 - uVar15;
              }
              if (-1 < (int)uVar15) {
                puVar6 = *param_3 + 10;
                if ((puVar6 != (uint *)0x0) &&
                   ((local_60 <= puVar6 || (*param_3 + 0x3c <= &local_128)))) {
                  lVar8 = 100;
                  puVar5 = &local_128;
                  do {
                    *(undefined *)
                     ((longlong)(uint *)((longlong)puVar6 - (longlong)&local_128) + (longlong)puVar5
                     ) = *(undefined *)puVar5;
                    *(undefined *)
                     ((longlong)(uint *)((longlong)puVar6 - (longlong)&local_128) + 1 +
                     (longlong)puVar5) = *(undefined *)((longlong)puVar5 + 1);
                    puVar5 = (undefined8 *)((longlong)puVar5 + 2);
                    lVar8 = lVar8 + -1;
                  } while (lVar8 != 0);
                }
                puVar6 = FUN_18002a710(&local_128,param_4[3],param_4[2],param_4[1]);
                FUN_180029df0((int *)puVar6,(int **)(*param_3 + 0x4c));
                uVar21 = uVar18;
                if (puVar6 != (uint *)0x0) {
                  free(puVar6);
                }
                goto LAB_18000c96b;
              }
              uVar12 = uVar19 & 0xffffffff;
              local_140 = (uint)uVar12;
            }
            goto switchD_18000c754_caseD_bf;
          case 0xcf:
            ppuVar16 = (uint **)(*param_3 + 4);
LAB_18000c770:
            uVar4 = FUN_18000d200((uint **)&local_138,param_2,ppuVar16);
            uVar21 = (ulonglong)uVar4;
            puVar14 = local_138;
            if (uVar4 == 0) {
LAB_18000c96b:
              uVar19 = 1;
              uVar20 = 0xc0000000000000cd;
              goto LAB_18000c97b;
            }
            uVar19 = 1;
            uVar12 = 1;
            uVar20 = 0xc0000000000000cd;
            local_140 = 1;
            goto switchD_18000c754_caseD_bf;
          case 0xd6:
            puVar17 = *param_3 + 0x53;
            bVar22 = puVar17 == (uint *)0x0;
            break;
          case 0xd7:
            puVar17 = *param_3 + 0x54;
            bVar22 = puVar17 == (uint *)0x0;
          }
          if (((!bVar22) && (puVar14 != (uint *)0x0)) &&
             (((uint *)((longlong)puVar6 + 5U) <= puVar17 || (puVar17 + 1 <= puVar14)))) {
            *(undefined *)puVar17 = *(undefined *)puVar14;
            *(undefined *)((longlong)puVar17 + 1) = *(undefined *)((longlong)puVar6 + 2);
            *(undefined *)((longlong)puVar17 + 2) = *(undefined *)((longlong)puVar6 + 3);
            *(undefined *)((longlong)puVar17 + 3) = *(undefined *)(puVar6 + 1);
          }
          *param_2 = *param_2 - 4;
          puVar14 = (uint *)((longlong)puVar6 + 5);
LAB_18000c97b:
          uVar12 = (ulonglong)local_140;
switchD_18000c754_caseD_bf:
          iVar13 = (int)uVar21;
          puVar6 = puVar14;
        } while (puVar14 < local_148);
        if (iVar13 < 0) goto LAB_18000d13e;
      }
      uVar12 = 0;
      if (1 < *param_4 - 9) {
        puVar6 = *param_3;
        if ((int)puVar6[0x3c] <= (int)puVar6[0x42]) {
          puVar6[0x42] = puVar6[0x3c] - 1;
        }
        puVar6 = *param_3;
        uVar4 = param_4[2];
        uVar21 = uVar12;
        if (0 < (int)puVar6[0x3c]) {
          do {
            if ((int)uVar21 < (int)puVar6[0x42]) {
              *(undefined2 *)(uVar12 + *(longlong *)(puVar6 + 0x3e)) = 0;
            }
            else {
              *(short *)(uVar12 + *(longlong *)(puVar6 + 0x3e)) = (short)uVar19;
            }
            lVar8 = *(longlong *)(*param_3 + 0x3e);
            uVar3 = *(ushort *)(lVar8 + 4 + uVar12);
            if (uVar3 < 0x1400) {
              *(undefined4 *)(lVar8 + 0xc + uVar12) = 1;
            }
            else {
              uVar7 = 0;
              if ((ushort)((short)(uVar4 << 8) + 0xec00U) <= uVar3) {
                uVar7 = 2;
              }
              *(undefined4 *)(lVar8 + 0xc + uVar12) = uVar7;
            }
            uVar19 = 1;
            puVar6 = *param_3;
            uVar15 = (int)uVar21 + 1;
            uVar12 = uVar12 + 0x38;
            uVar21 = (ulonglong)uVar15;
          } while ((int)uVar15 < (int)puVar6[0x3c]);
        }
      }
    }
  }
LAB_18000d13e:
  *local_158 = puVar14;
  FUN_18005f100(local_58 ^ (ulonglong)auStack392);
  return;
}



void FUN_18000d200(uint **param_1,uint *param_2,uint **param_3)

{
  char cVar1;
  uint uVar2;
  uint *puVar3;
  bool bVar4;
  undefined *puVar5;
  uint uVar6;
  uint uVar7;
  uint *puVar8;
  ulonglong uVar9;
  uint *puVar10;
  uint uVar11;
  uint uVar12;
  uint *puVar13;
  uint uVar14;
  uint uVar15;
  uint **local_58;
  uint local_50;
  uint local_4c;
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&local_58;
  puVar13 = *param_1;
  uVar11 = 0;
  if (3 < *param_2) {
    if ((puVar13 != (uint *)0x0) && ((puVar13 + 1 <= &local_50 || (&local_4c <= puVar13)))) {
      uVar11 = *puVar13;
    }
    uVar14 = *param_2 - 4;
    puVar13 = puVar13 + 1;
    *param_2 = uVar14;
    if (uVar11 <= uVar14) {
      bVar4 = false;
      uVar7 = 0;
      uVar14 = 0;
      uVar15 = 0;
      puVar8 = (uint *)((longlong)(int)uVar11 + (longlong)puVar13);
      uVar11 = 0;
      puVar10 = puVar13;
joined_r0x00018000d29c:
      do {
        puVar13 = puVar10;
        if ((puVar8 <= puVar13) || (bVar4)) break;
        *param_2 = *param_2 - 1;
        cVar1 = *(char *)puVar13;
        puVar10 = (uint *)((longlong)puVar13 + 1);
        uVar12 = *param_2;
        if (cVar1 == -0x3f) {
          if ((puVar10 != (uint *)0x0) &&
             (((uint *)((longlong)puVar13 + 5U) <= &local_50 || (&local_4c <= puVar10)))) {
            uVar7 = *puVar10;
          }
          *param_2 = uVar12 - 4;
        }
        else {
          if (cVar1 == -0x3e) {
            if ((puVar10 != (uint *)0x0) &&
               (((uint *)((longlong)puVar13 + 5U) <= &local_50 || (&local_4c <= puVar10)))) {
              uVar15 = *puVar10;
            }
            *param_2 = uVar12 - 4;
          }
          else {
            if (cVar1 == -0x3d) {
              if ((puVar10 != (uint *)0x0) &&
                 (((uint *)((longlong)puVar13 + 5U) <= &local_50 || (&local_4c <= puVar10)))) {
                uVar11 = *puVar10;
              }
              *param_2 = uVar12 - 4;
            }
            else {
              if (cVar1 != -0x3c) {
                if (cVar1 == -0x3b) {
                  puVar3 = *param_3;
                  if (puVar3 == (uint *)0x0) {
                    bVar4 = true;
                    goto joined_r0x00018000d29c;
                  }
                  if ((((uVar7 != *puVar3) || (uVar15 != puVar3[1])) || (uVar11 != puVar3[2])) ||
                     (uVar14 != puVar3[4])) {
                    bVar4 = true;
                  }
                  uVar2 = puVar3[3];
                  uVar6 = 0xffff0006;
                  if ((puVar10 != (uint *)0x0) &&
                     ((uVar12 = *param_2, (uint *)((longlong)puVar13 + 5U) <= &local_50 ||
                      (&local_4c <= puVar10)))) {
                    uVar6 = *puVar10;
                  }
                  puVar10 = (uint *)((longlong)puVar13 + 5);
                  *param_2 = uVar12 - 4;
                  if (uVar6 <= uVar12 - 4) {
                    if ((0 < (int)uVar6) && ((int)uVar6 <= (int)uVar2)) {
                      puVar5 = *(undefined **)(puVar3 + 6);
                      if ((((puVar5 != (undefined *)0x0) &&
                           ((puVar10 != (uint *)0x0 && (uVar6 != 0)))) &&
                          ((uVar9 = (ulonglong)uVar6,
                           (undefined *)(uVar9 + (longlong)puVar10) <= puVar5 ||
                           (puVar5 + uVar9 <= puVar10)))) && (uVar6 != 0)) {
                        puVar13 = (uint *)((longlong)puVar10 - (longlong)puVar5);
                        do {
                          *puVar5 = *(undefined *)((longlong)puVar13 + (longlong)puVar5);
                          puVar5 = puVar5 + 1;
                          uVar9 = uVar9 - 1;
                        } while (uVar9 != 0);
                      }
                      puVar10 = (uint *)((longlong)puVar10 + (longlong)(int)uVar6);
                      *param_2 = *param_2 - uVar6;
                    }
                    if ((-1 < (int)uVar6) && (uVar6 == (*param_3)[3])) goto joined_r0x00018000d29c;
                  }
                  bVar4 = true;
                }
                goto joined_r0x00018000d29c;
              }
              if ((puVar10 != (uint *)0x0) &&
                 (((uint *)((longlong)puVar13 + 5U) <= &local_50 || (&local_4c <= puVar10)))) {
                uVar14 = *puVar10;
              }
              *param_2 = uVar12 - 4;
            }
          }
        }
        puVar10 = (uint *)((longlong)puVar13 + 5);
      } while( true );
    }
  }
  *param_1 = puVar13;
  local_58 = param_1;
  FUN_18005f100(local_48 ^ (ulonglong)&local_58);
  return;
}



ulonglong FUN_18000d5a0(uint *param_1)

{
  longlong *plVar1;
  uint uVar2;
  int *piVar3;
  int iVar4;
  char *_Memory;
  char *pcVar5;
  uint *puVar6;
  int iVar7;
  ulonglong uVar8;
  int iVar9;
  ulonglong uVar10;
  int iVar11;
  uint uVar12;
  int iVar14;
  longlong *plVar15;
  int **ppiVar16;
  ulonglong uVar13;

  if (param_1 == (uint *)0x0) {
    return 0;
  }
  iVar9 = 0x4b;
  uVar8 = 0;
  iVar11 = 0;
  uVar2 = param_1[7];
  iVar7 = 0;
  if (uVar2 != 0) {
    uVar12 = *param_1;
    ppiVar16 = (int **)(param_1 + 10);
    uVar10 = (ulonglong)uVar2;
    do {
      piVar3 = *ppiVar16;
      iVar4 = iVar7;
      if (piVar3 != (int *)0x0) {
        if (*(longlong *)(piVar3 + 2) == 0) {
          iVar4 = 10;
        }
        else {
          iVar4 = *(int *)(*(longlong *)(piVar3 + 2) + 0xc) + 0x28;
        }
        iVar14 = iVar7;
        if (*(longlong *)(piVar3 + 4) != 0) {
          iVar14 = *(int *)(*(longlong *)(piVar3 + 4) + 0xc) + 0x1e;
        }
        iVar14 = iVar4 + ((piVar3[1] + 3U >> 2) * (*piVar3 + 3U >> 2) + 7 >> 3) + iVar14;
        if (*(longlong *)(piVar3 + 6) != 0) {
          iVar14 = iVar14 + 0x1e + *(int *)(*(longlong *)(piVar3 + 6) + 0xc);
        }
        if (((uVar12 < 0x40) && ((0xc0000000000000cdU >> ((longlong)(int)uVar12 & 0x3fU) & 1) != 0))
           || (uVar12 - 9 < 2)) {
          iVar4 = piVar3[0x3c] << 5;
        }
        else {
          iVar4 = piVar3[0x3c] * 0x1c;
        }
        iVar4 = iVar4 + 0x46 + iVar14;
      }
      iVar9 = iVar9 + iVar4;
      ppiVar16 = ppiVar16 + 1;
      uVar10 = uVar10 - 1;
    } while (uVar10 != 0);
  }
  if (*param_1 - 9 < 2) {
    _Memory = (char *)malloc((ulonglong)param_1[9]);
    FUN_18002e3f0((longlong)param_1,(longlong)_Memory);
    uVar8 = (ulonglong)param_1[9];
    if (param_1[9] != 0) {
      puVar6 = param_1 + 0x6e;
      pcVar5 = _Memory;
      do {
        if ((-1 < (int)*puVar6) && (*pcVar5 == '\x01')) {
          iVar9 = iVar9 + 0x2d;
        }
        puVar6 = puVar6 + 7;
        pcVar5 = pcVar5 + 1;
        uVar8 = uVar8 - 1;
      } while (uVar8 != 0);
    }
    free(_Memory);
  }
  else {
    if (0 < (int)param_1[0x21f9]) {
      uVar10 = SEXT48((int)param_1[0x21f6]);
      if (uVar2 != 0) {
        plVar15 = (longlong *)(param_1 + 10);
        plVar1 = plVar15 + uVar10;
        uVar13 = uVar8;
        do {
          if ((longlong)uVar8 < (longlong)uVar10) {
            iVar4 = *(int *)(*plVar1 + 0x104) + (int)uVar13;
LAB_18000d6f8:
            if (-1 < (int)param_1[(longlong)iVar4 * 7 + 0x6e]) {
              iVar9 = iVar9 + 0x2d;
            }
          }
          else {
            if (uVar8 != uVar10) {
              iVar4 = *(int *)(*plVar15 + 0x104) + param_1[0x21f6];
              goto LAB_18000d6f8;
            }
          }
          uVar12 = (int)uVar13 + 1;
          uVar13 = (ulonglong)uVar12;
          uVar8 = uVar8 + 1;
          plVar15 = plVar15 + 1;
        } while (uVar12 < uVar2);
      }
    }
  }
  if (param_1 != (uint *)0xffffffffffff7818) {
    iVar7 = 0x535;
  }
  if (param_1 != (uint *)0xffffffffffff7830) {
    iVar11 = 0x19;
  }
  return (ulonglong)(uint)(iVar9 + iVar7 + iVar11);
}



void FUN_18000d7f0(uint *param_1)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;

  uVar4 = 0;
  do {
    uVar2 = (uVar4 & 1) << 7;
    uVar1 = uVar2 | 0x40;
    if ((uVar4 >> 1 & 1) == 0) {
      uVar1 = uVar2;
    }
    uVar2 = uVar1 | 0x20;
    if ((uVar4 >> 2 & 1) == 0) {
      uVar2 = uVar1;
    }
    uVar1 = uVar2 | 0x10;
    if ((uVar4 >> 3 & 1) == 0) {
      uVar1 = uVar2;
    }
    uVar2 = uVar1 | 8;
    if ((uVar4 >> 4 & 1) == 0) {
      uVar2 = uVar1;
    }
    uVar1 = uVar2 | 4;
    if ((uVar4 >> 5 & 1) == 0) {
      uVar1 = uVar2;
    }
    uVar2 = uVar1 | 2;
    if ((uVar4 >> 6 & 1) == 0) {
      uVar2 = uVar1;
    }
    uVar1 = uVar2 | 1;
    if ((uVar4 >> 6 & 2) == 0) {
      uVar1 = uVar2;
    }
    uVar1 = (int)(uVar1 * 0x1000000) >> 0x1f & 0x4c11db7U ^ uVar1 * 0x2000000;
    uVar1 = (int)uVar1 >> 0x1f & 0x4c11db7U ^ uVar1 * 2;
    uVar1 = (int)uVar1 >> 0x1f & 0x4c11db7U ^ uVar1 * 2;
    uVar1 = (int)uVar1 >> 0x1f & 0x4c11db7U ^ uVar1 * 2;
    uVar1 = (int)uVar1 >> 0x1f & 0x4c11db7U ^ uVar1 * 2;
    uVar1 = (int)uVar1 >> 0x1f & 0x4c11db7U ^ uVar1 * 2;
    uVar1 = (int)uVar1 >> 0x1f & 0x4c11db7U ^ uVar1 * 2;
    uVar1 = (int)uVar1 >> 0x1f & 0x4c11db7U ^ uVar1 * 2;
    uVar2 = 0;
    *param_1 = uVar1;
    iVar3 = 0x1e;
    do {
      if ((uVar1 & 1) != 0) {
        uVar2 = uVar2 | 1 << ((byte)iVar3 + 1 & 0x1f);
      }
      if ((uVar1 >> 1 & 1) != 0) {
        uVar2 = uVar2 | 1 << ((byte)iVar3 & 0x1f);
      }
      uVar1 = uVar1 >> 2;
      iVar3 = iVar3 + -2;
    } while (-2 < iVar3);
    *param_1 = uVar2;
    uVar4 = uVar4 + 1;
    param_1 = param_1 + 1;
  } while ((int)uVar4 < 0x100);
  return;
}



void FUN_18000da00(longlong param_1,ulonglong **param_2,int param_3,int param_4)

{
  byte bVar1;
  ulonglong *puVar2;
  byte *pbVar3;
  short *psVar4;
  int iVar5;

  puVar2 = *param_2;
  iVar5 = 0;
  pbVar3 = *(byte **)(param_1 + 0x18);
  psVar4 = (short *)puVar2[3];
  if (0 < *(int *)(param_1 + 0xc)) {
    do {
      bVar1 = *pbVar3;
      pbVar3 = pbVar3 + 1;
      *psVar4 = (ushort)bVar1 << 8;
      iVar5 = iVar5 + 1;
      psVar4 = psVar4 + 1;
    } while (iVar5 < *(int *)(param_1 + 0xc));
  }
  if (param_4 - 9U < 2) {
    FUN_1800395b0(puVar2,(int *)puVar2,0xffffffffffffffff,200,-1,-1);
    iVar5 = 1;
    do {
      puVar2 = *param_2;
      param_2 = param_2 + 1;
      FUN_1800395b0(puVar2,(int *)*param_2,0xffffffffffffffff,iVar5 + 200,-1,-1);
      iVar5 = iVar5 + 1;
    } while (iVar5 < 9);
  }
  else {
    FUN_1800395b0(puVar2,(int *)puVar2,0xffffffffffffffff,param_3,-1,-1);
    iVar5 = 1;
    do {
      puVar2 = *param_2;
      param_2 = param_2 + 1;
      FUN_1800395b0(puVar2,(int *)*param_2,0xffffffffffffffff,iVar5 + param_3,-1,-1);
      iVar5 = iVar5 + 1;
    } while (iVar5 < 6);
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18000db40(longlong *param_1,longlong param_2)

{
  ushort uVar1;
  undefined auVar2 [16];
  undefined auVar3 [16];
  ulonglong *puVar4;
  ulonglong *puVar5;
  ulonglong uVar6;
  undefined (*pauVar7) [16];
  ulonglong uVar8;
  ulonglong uVar9;
  ulonglong *puVar10;
  undefined in_XMM1 [16];
  undefined in_XMM2 [16];
  undefined auVar11 [16];
  undefined auVar12 [16];

  auVar3 = _DAT_1800a41f0;
  auVar2 = _DAT_1800a41d0;
  uVar8 = 0;
  pauVar7 = *(undefined (**) [16])(param_2 + 0x18);
  puVar4 = *(ulonglong **)(param_1[1] + 0x18);
  puVar10 = *(ulonglong **)(*param_1 + 0x18);
  uVar6 = (longlong)*(int *)(param_2 + 0xc) + 3U >> 2;
  if ((undefined (*) [16])(*pauVar7 + *(int *)(param_2 + 0xc)) < pauVar7) {
    uVar6 = uVar8;
  }
  if (uVar6 != 0) {
    uVar9 = uVar8;
    if ((((0xf < uVar6) && (1 < DAT_1800b04f8)) &&
        (((undefined (*) [16])((longlong)puVar4 + uVar6 * 2 + -2) < pauVar7 ||
         (pauVar7[-1] + uVar6 * 4 + 0xc < puVar4)))) &&
       (((undefined (*) [16])((longlong)puVar10 + uVar6 * 2 + -2) < pauVar7 ||
        (uVar9 = 0, pauVar7[-1] + uVar6 * 4 + 0xc < puVar10)))) {
      uVar9 = uVar8;
      do {
        uVar9 = uVar9 + 0x10;
        auVar11 = pmovzxwd(in_XMM2,ZEXT816(*puVar10));
        auVar12 = pmulld(auVar11,auVar3);
        auVar11 = pmovzxwd(in_XMM1,ZEXT816(*puVar4));
        uVar8 = puVar10[1];
        auVar11 = pmulld(auVar11,auVar2);
        auVar12 = CONCAT412(SUB164(auVar12 >> 0x60,0) - SUB164(auVar11 >> 0x60,0),
                            CONCAT48(SUB164(auVar12 >> 0x40,0) - SUB164(auVar11 >> 0x40,0),
                                     CONCAT44(SUB164(auVar12 >> 0x20,0) - SUB164(auVar11 >> 0x20,0),
                                              SUB164(auVar12,0) - SUB164(auVar11,0))));
        *pauVar7 = auVar12;
        auVar12 = pmovzxwd(auVar12,ZEXT816(uVar8));
        auVar12 = pmulld(auVar12,auVar3);
        auVar11 = pmovzxwd(auVar11,ZEXT816(puVar4[1]));
        uVar8 = puVar10[2];
        auVar11 = pmulld(auVar11,auVar2);
        auVar12 = CONCAT412(SUB164(auVar12 >> 0x60,0) - SUB164(auVar11 >> 0x60,0),
                            CONCAT48(SUB164(auVar12 >> 0x40,0) - SUB164(auVar11 >> 0x40,0),
                                     CONCAT44(SUB164(auVar12 >> 0x20,0) - SUB164(auVar11 >> 0x20,0),
                                              SUB164(auVar12,0) - SUB164(auVar11,0))));
        pauVar7[1] = auVar12;
        auVar12 = pmovzxwd(auVar12,ZEXT816(uVar8));
        auVar12 = pmulld(auVar12,auVar3);
        auVar11 = pmovzxwd(auVar11,ZEXT816(puVar4[2]));
        uVar8 = puVar10[3];
        puVar10 = puVar10 + 4;
        auVar11 = pmulld(auVar11,auVar2);
        auVar12 = CONCAT412(SUB164(auVar12 >> 0x60,0) - SUB164(auVar11 >> 0x60,0),
                            CONCAT48(SUB164(auVar12 >> 0x40,0) - SUB164(auVar11 >> 0x40,0),
                                     CONCAT44(SUB164(auVar12 >> 0x20,0) - SUB164(auVar11 >> 0x20,0),
                                              SUB164(auVar12,0) - SUB164(auVar11,0))));
        pauVar7[2] = auVar12;
        auVar12 = pmovzxwd(auVar12,ZEXT816(uVar8));
        puVar5 = puVar4 + 3;
        puVar4 = puVar4 + 4;
        auVar11 = pmovzxwd(auVar11,ZEXT816(*puVar5));
        in_XMM1 = pmulld(auVar11,auVar2);
        auVar11 = pmulld(auVar12,auVar3);
        in_XMM2 = CONCAT412(SUB164(auVar11 >> 0x60,0) - SUB164(in_XMM1 >> 0x60,0),
                            CONCAT48(SUB164(auVar11 >> 0x40,0) - SUB164(in_XMM1 >> 0x40,0),
                                     CONCAT44(SUB164(auVar11 >> 0x20,0) - SUB164(in_XMM1 >> 0x20,0),
                                              SUB164(auVar11,0) - SUB164(in_XMM1,0))));
        pauVar7[3] = in_XMM2;
        pauVar7 = pauVar7[4];
      } while (uVar9 != (uVar6 & 0xfffffffffffffff0));
    }
    if (uVar9 != uVar6) {
      puVar5 = puVar4;
      do {
        uVar1 = *(ushort *)((longlong)((longlong)puVar10 - (longlong)puVar4) + (longlong)puVar5);
        uVar9 = uVar9 + 1;
        *(uint *)*pauVar7 =
             ((uint)uVar1 + (uint)uVar1 * 4) * 2 -
             ((uint)*(ushort *)puVar5 + (uint)*(ushort *)puVar5 * 8);
        puVar5 = (ulonglong *)((longlong)puVar5 + 2);
        pauVar7 = (undefined (*) [16])(*pauVar7 + 4);
      } while (uVar9 != uVar6);
    }
  }
  return;
}



undefined8
FUN_18000dce0(longlong param_1,int param_2,int param_3,int param_4,undefined8 param_5,uint *param_6)

{
  uint uVar1;
  uint *puVar2;
  short sVar3;
  longlong lVar4;
  longlong lVar5;
  longlong lVar6;
  longlong lVar7;
  ushort *puVar8;
  longlong lVar9;
  ushort *puVar10;
  uint uVar11;
  ushort *puVar12;
  ushort *puVar13;

  puVar2 = *(uint **)(param_1 + (longlong)param_4 * 8);
  uVar1 = *puVar2;
  lVar9 = (longlong)(int)uVar1;
  lVar4 = (longlong)(int)(uVar1 * param_3 + param_2) * 2;
  puVar13 = (ushort *)(*(longlong *)(puVar2 + 6) + lVar4);
  puVar10 = (ushort *)
            (*(longlong *)(*(longlong *)(param_1 + (longlong)(param_4 + 2) * 8) + 0x18) + lVar4);
  puVar8 = (ushort *)
           (*(longlong *)(*(longlong *)(param_1 + (longlong)(param_4 + 1) * 8) + 0x18) + lVar4);
  puVar12 = (ushort *)
            (*(longlong *)(*(longlong *)(param_1 + (longlong)(param_4 + -1) * 8) + 0x18) + lVar4);
  sVar3 = *puVar8 - *puVar13;
  uVar11 = SEXT24(sVar3);
  *param_6 = uVar11;
  if (0x148 < (int)((uVar11 ^ (int)uVar11 >> 0x1f) - ((int)uVar11 >> 0x1f))) {
    if (((0 < sVar3) && ((int)((uint)puVar8[-1] - (uint)puVar13[-1]) <= (int)uVar11)) &&
       ((int)((uint)puVar8[1] - (uint)puVar13[1]) <= (int)uVar11)) {
      lVar4 = (longlong)(int)~uVar1;
      if ((int)((uint)puVar8[lVar4] - (uint)puVar13[lVar4]) <= (int)uVar11) {
        if ((int)((uint)puVar8[-lVar9] - (uint)puVar13[-lVar9]) <= (int)uVar11) {
          lVar5 = (longlong)(int)(1 - uVar1);
          if ((int)((uint)puVar8[lVar5] - (uint)puVar13[lVar5]) <= (int)uVar11) {
            lVar6 = (longlong)(int)(uVar1 - 1);
            if (((int)((uint)puVar8[lVar6] - (uint)puVar13[lVar6]) <= (int)uVar11) &&
               ((int)((uint)puVar8[lVar9] - (uint)puVar13[lVar9]) <= (int)uVar11)) {
              lVar7 = (longlong)(int)(uVar1 + 1);
              if ((((((int)((uint)puVar8[lVar7] - (uint)puVar13[lVar7]) <= (int)uVar11) &&
                    (((int)((uint)*puVar10 - (uint)*puVar8) <= (int)uVar11 &&
                     ((int)((uint)puVar10[-1] - (uint)puVar8[-1]) <= (int)uVar11)))) &&
                   ((int)((uint)puVar10[1] - (uint)puVar8[1]) <= (int)uVar11)) &&
                  (((((((int)((uint)puVar10[lVar4] - (uint)puVar8[lVar4]) <= (int)uVar11 &&
                       ((int)((uint)puVar10[-lVar9] - (uint)puVar8[-lVar9]) <= (int)uVar11)) &&
                      ((int)((uint)puVar10[lVar5] - (uint)puVar8[lVar5]) <= (int)uVar11)) &&
                     (((int)((uint)puVar10[lVar6] - (uint)puVar8[lVar6]) <= (int)uVar11 &&
                      ((int)((uint)puVar10[lVar9] - (uint)puVar8[lVar9]) <= (int)uVar11)))) &&
                    (((int)((uint)puVar10[lVar7] - (uint)puVar8[lVar7]) <= (int)uVar11 &&
                     (((int)((uint)*puVar13 - (uint)*puVar12) <= (int)uVar11 &&
                      ((int)((uint)puVar13[-1] - (uint)puVar12[-1]) <= (int)uVar11)))))) &&
                   ((int)((uint)puVar13[1] - (uint)puVar12[1]) <= (int)uVar11)))) &&
                 (((((int)((uint)puVar13[lVar4] - (uint)puVar12[lVar4]) <= (int)uVar11 &&
                    ((int)((uint)puVar13[-lVar9] - (uint)puVar12[-lVar9]) <= (int)uVar11)) &&
                   ((int)((uint)puVar13[lVar5] - (uint)puVar12[lVar5]) <= (int)uVar11)) &&
                  ((((int)((uint)puVar13[lVar6] - (uint)puVar12[lVar6]) <= (int)uVar11 &&
                    ((int)((uint)puVar13[lVar9] - (uint)puVar12[lVar9]) <= (int)uVar11)) &&
                   ((int)((uint)puVar13[lVar7] - (uint)puVar12[lVar7]) <= (int)uVar11)))))) {
                return 1;
              }
            }
          }
        }
      }
    }
    if (((sVar3 < 0) && ((int)uVar11 <= (int)((uint)puVar8[-1] - (uint)puVar13[-1]))) &&
       ((int)uVar11 <= (int)((uint)puVar8[1] - (uint)puVar13[1]))) {
      lVar4 = (longlong)(int)~uVar1;
      if ((int)uVar11 <= (int)((uint)puVar8[lVar4] - (uint)puVar13[lVar4])) {
        if ((int)uVar11 <= (int)((uint)puVar8[-lVar9] - (uint)puVar13[-lVar9])) {
          lVar5 = (longlong)(int)(1 - uVar1);
          if ((int)uVar11 <= (int)((uint)puVar8[lVar5] - (uint)puVar13[lVar5])) {
            lVar6 = (longlong)(int)(uVar1 - 1);
            if ((int)uVar11 <= (int)((uint)puVar8[lVar6] - (uint)puVar13[lVar6])) {
              if ((int)uVar11 <= (int)((uint)puVar8[lVar9] - (uint)puVar13[lVar9])) {
                lVar7 = (longlong)(int)(uVar1 + 1);
                if (((((((int)uVar11 <= (int)((uint)puVar8[lVar7] - (uint)puVar13[lVar7])) &&
                       ((int)uVar11 <= (int)((uint)*puVar10 - (uint)*puVar8))) &&
                      ((int)uVar11 <= (int)((uint)puVar10[-1] - (uint)puVar8[-1]))) &&
                     (((int)uVar11 <= (int)((uint)puVar10[1] - (uint)puVar8[1]) &&
                      ((int)uVar11 <= (int)((uint)puVar10[lVar4] - (uint)puVar8[lVar4]))))) &&
                    (((int)uVar11 <= (int)((uint)puVar10[-lVar9] - (uint)puVar8[-lVar9]) &&
                     (((int)uVar11 <= (int)((uint)puVar10[lVar5] - (uint)puVar8[lVar5]) &&
                      ((int)uVar11 <= (int)((uint)puVar10[lVar6] - (uint)puVar8[lVar6]))))))) &&
                   ((((int)uVar11 <= (int)((uint)puVar10[lVar9] - (uint)puVar8[lVar9]) &&
                     (((((int)uVar11 <= (int)((uint)puVar10[lVar7] - (uint)puVar8[lVar7]) &&
                        ((int)uVar11 <= (int)((uint)*puVar13 - (uint)*puVar12))) &&
                       ((int)uVar11 <= (int)((uint)puVar13[-1] - (uint)puVar12[-1]))) &&
                      (((int)uVar11 <= (int)((uint)puVar13[1] - (uint)puVar12[1]) &&
                       ((int)uVar11 <= (int)((uint)puVar13[lVar4] - (uint)puVar12[lVar4]))))))) &&
                    ((((int)uVar11 <= (int)((uint)puVar13[-lVar9] - (uint)puVar12[-lVar9]) &&
                      (((int)uVar11 <= (int)((uint)puVar13[lVar5] - (uint)puVar12[lVar5]) &&
                       ((int)uVar11 <= (int)((uint)puVar13[lVar6] - (uint)puVar12[lVar6]))))) &&
                     (((int)uVar11 <= (int)((uint)puVar13[lVar9] - (uint)puVar12[lVar9]) &&
                      ((int)uVar11 <= (int)((uint)puVar13[lVar7] - (uint)puVar12[lVar7]))))))))) {
                  return 1;
                }
              }
            }
          }
        }
      }
    }
  }
  return 0;
}



undefined8
FUN_18000e2e0(longlong param_1,int param_2,int param_3,int param_4,undefined2 *param_5,
             undefined2 *param_6,short *param_7)

{
  ushort uVar1;
  ushort uVar2;
  ushort uVar3;
  ushort uVar4;
  ushort uVar5;
  ushort uVar6;
  ushort uVar7;
  ushort uVar8;
  ushort uVar9;
  ushort uVar10;
  uint *puVar11;
  longlong lVar12;
  short sVar13;
  uint uVar14;
  uint uVar15;
  ushort *puVar16;
  longlong lVar17;
  ushort *puVar18;
  ushort *puVar19;
  int iVar20;
  ushort *puVar21;

  puVar11 = *(uint **)(param_1 + (longlong)param_4 * 8);
  uVar15 = *puVar11;
  lVar17 = (longlong)(int)uVar15;
  lVar12 = (longlong)(int)(uVar15 * param_3 + param_2) * 2;
  puVar16 = (ushort *)(*(longlong *)(puVar11 + 6) + lVar12);
  uVar1 = puVar16[1];
  puVar19 = (ushort *)
            (*(longlong *)(*(longlong *)(param_1 + (longlong)(param_4 + 2) * 8) + 0x18) + lVar12);
  puVar21 = (ushort *)
            (*(longlong *)(*(longlong *)(param_1 + (longlong)(param_4 + 1) * 8) + 0x18) + lVar12);
  uVar2 = *puVar21;
  uVar3 = *puVar16;
  puVar18 = (ushort *)
            (*(longlong *)(*(longlong *)(param_1 + (longlong)(param_4 + -1) * 8) + 0x18) + lVar12);
  uVar4 = puVar21[-1];
  sVar13 = (uVar2 - uVar3) * 2;
  *param_7 = sVar13;
  uVar5 = puVar16[-1];
  uVar14 = ((((uint)puVar21[1] - (uint)uVar4) - (uint)uVar1) + (uint)uVar5) * 2;
  if (0x7fff < (int)((uVar14 ^ (int)uVar14 >> 0x1f) - ((int)uVar14 >> 0x1f))) {
    return 0;
  }
  uVar4 = puVar21[lVar17];
  *param_6 = (short)uVar14;
  uVar6 = puVar16[-lVar17];
  uVar7 = puVar16[lVar17];
  uVar8 = puVar21[-lVar17];
  uVar14 = ((((uint)uVar4 - (uint)uVar7) - (uint)uVar8) + (uint)uVar6) * 2;
  if ((int)((uVar14 ^ (int)uVar14 >> 0x1f) - ((int)uVar14 >> 0x1f)) < 0x8000) {
    uVar9 = *puVar18;
    uVar10 = *puVar19;
    param_6[1] = (short)uVar14;
    uVar14 = ((((uint)uVar10 - (uint)uVar2) - (uint)uVar3) + (uint)uVar9) * 2;
    if ((int)((uVar14 ^ (int)uVar14 >> 0x1f) - ((int)uVar14 >> 0x1f)) < 0x8000) {
      uVar2 = puVar16[1];
      param_6[2] = (short)uVar14;
      iVar20 = (int)sVar13;
      uVar14 = (((((uint)puVar21[1] - (uint)uVar2) - (uint)puVar16[-1]) - iVar20) +
               (uint)puVar21[-1]) * 4;
      if ((int)((uVar14 ^ (int)uVar14 >> 0x1f) - ((int)uVar14 >> 0x1f)) < 0x8000) {
        *param_5 = (short)uVar14;
        uVar14 = (((((uint)uVar4 - iVar20) - (uint)uVar7) - (uint)uVar6) + (uint)uVar8) * 4;
        if ((int)((uVar14 ^ (int)uVar14 >> 0x1f) - ((int)uVar14 >> 0x1f)) < 0x8000) {
          uVar2 = *puVar18;
          param_5[1] = (short)uVar14;
          uVar14 = (((((uint)uVar10 - (uint)*puVar21) - (uint)uVar2) - iVar20) + (uint)*puVar16) * 4
          ;
          if ((int)((uVar14 ^ (int)uVar14 >> 0x1f) - ((int)uVar14 >> 0x1f)) < 0x8000) {
            param_5[2] = (short)uVar14;
            uVar15 = (((((uint)puVar16[(int)(uVar15 - 1)] - (uint)puVar21[(int)(uVar15 - 1)]) -
                       (uint)puVar16[(int)(uVar15 + 1)]) - (uint)puVar16[(int)~uVar15]) -
                     (uint)puVar21[(int)(1 - uVar15)]) + (uint)puVar21[(int)(uVar15 + 1)] +
                     (uint)puVar21[(int)~uVar15] + (uint)puVar16[(int)(1 - uVar15)];
            if ((int)((uVar15 ^ (int)uVar15 >> 0x1f) - ((int)uVar15 >> 0x1f)) < 0x2000) {
              uVar2 = puVar18[lVar17];
              param_5[3] = (short)uVar15;
              uVar15 = ((((((uint)uVar2 - (uint)puVar18[-lVar17]) - (uint)puVar19[-lVar17]) +
                         (uint)puVar19[lVar17]) - (uint)uVar4) - (uint)uVar7) + (uint)uVar8 +
                       (uint)uVar6;
              if ((int)((uVar15 ^ (int)uVar15 >> 0x1f) - ((int)uVar15 >> 0x1f)) < 0x2000) {
                uVar2 = puVar18[-1];
                uVar3 = puVar18[1];
                param_5[4] = (short)uVar15;
                uVar15 = ((((((uint)uVar3 - (uint)uVar2) - (uint)puVar19[-1]) + (uint)puVar19[1]) -
                          (uint)puVar21[1]) - (uint)uVar1) + (uint)puVar21[-1] + (uint)uVar5;
                if ((int)((uVar15 ^ (int)uVar15 >> 0x1f) - ((int)uVar15 >> 0x1f)) < 0x2000) {
                  param_5[5] = (short)uVar15;
                  return 1;
                }
              }
            }
          }
        }
      }
    }
  }
  return 0;
}



undefined8 FUN_18000e610(short *param_1,short *param_2,undefined4 *param_3)

{
  short sVar1;
  short sVar2;
  short sVar3;
  byte bVar4;
  longlong lVar5;
  longlong lVar6;
  int iVar7;
  longlong lVar8;
  int iVar9;
  longlong lVar10;
  longlong lVar11;
  int iVar12;
  longlong lVar13;
  longlong *plVar14;
  longlong lVar15;
  int iVar16;
  longlong lVar17;
  int iVar18;
  longlong local_50 [3];

  sVar1 = param_1[3];
  iVar9 = (int)param_1[4];
  sVar2 = param_1[5];
  iVar7 = (int)param_1[1];
  iVar12 = (int)param_1[2];
  sVar3 = *param_1;
  iVar18 = (int)sVar2;
  lVar10 = (longlong)(sVar1 * iVar9 - sVar2 * iVar7);
  lVar17 = (longlong)(iVar18 * iVar9 - sVar1 * iVar12);
  lVar5 = (longlong)(iVar7 * iVar12 - iVar9 * iVar9);
  lVar8 = sVar1 * lVar17 + sVar3 * lVar5 + sVar2 * lVar10;
  if (lVar8 == 0) {
    *(undefined8 *)(param_3 + 1) = 0;
    *param_3 = 0;
  }
  else {
    iVar16 = 1;
    lVar6 = -lVar8;
    if (-1 < lVar8) {
      lVar6 = lVar8;
    }
    while (0 < lVar6) {
      iVar16 = iVar16 + 1;
      lVar6 = lVar6 >> 1;
    }
    lVar15 = (longlong)param_2[1];
    lVar13 = (longlong)*param_2;
    lVar11 = (longlong)param_2[2];
    lVar6 = (longlong)(sVar1 * iVar18 - sVar3 * iVar9);
    local_50[0] = -(lVar13 * lVar5 + lVar15 * lVar17 + lVar11 * lVar10);
    lVar5 = 3;
    local_50[1] = -((sVar3 * iVar12 - sVar2 * iVar18) * lVar15 + lVar13 * lVar17 + lVar6 * lVar11);
    plVar14 = local_50;
    local_50[2] = -((sVar3 * iVar7 - (int)sVar1 * (int)sVar1) * lVar11 + lVar13 * lVar10 +
                   lVar6 * lVar15);
    do {
      lVar10 = *plVar14;
      iVar7 = 1;
      lVar17 = -lVar10;
      if (-1 < lVar10) {
        lVar17 = lVar10;
      }
      while (0 < lVar17) {
        iVar7 = iVar7 + 1;
        lVar17 = lVar17 >> 1;
      }
      if (iVar7 - iVar16 < 9) {
        lVar17 = lVar8;
        if (iVar7 < iVar16) {
LAB_18000e7e7:
          iVar7 = iVar16;
          if (0x20 < iVar16) {
LAB_18000e7f4:
            bVar4 = (char)iVar7 - 0x20;
            lVar10 = lVar10 >> (bVar4 & 0x3f);
            *plVar14 = lVar10;
            lVar17 = lVar8 >> (bVar4 & 0x3f);
          }
        }
        else {
          if (0x20 < iVar7) goto LAB_18000e7f4;
          if (iVar7 < iVar16) goto LAB_18000e7e7;
        }
        *param_3 = (int)((lVar10 << 0xc) / lVar17);
      }
      else {
        *param_3 = 0xffffff;
      }
      plVar14 = plVar14 + 1;
      param_3 = param_3 + 1;
      lVar5 = lVar5 + -1;
    } while (lVar5 != 0);
  }
  return 1;
}



void FUN_18000e840(longlong param_1,int *param_2,undefined4 *param_3,int param_4,int param_5)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  undefined8 uVar4;
  int iVar5;
  longlong lVar6;
  int iVar7;
  int iVar8;
  uint uVar9;
  ulonglong uVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  ulonglong uVar14;
  ulonglong uVar15;
  longlong lVar16;
  short local_88 [2];
  short local_84;
  short local_82;
  short local_80;
  int local_7c;
  short local_78;
  short local_76;
  short local_72;
  longlong local_68;
  undefined4 *local_60;
  int local_58;
  int local_54;
  int local_50;
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xffffffffffffff38;
  uVar10 = SEXT48(param_2[2]);
  iVar12 = *param_2;
  iVar13 = param_2[1];
  piVar2 = *(int **)(param_1 + uVar10 * 8);
  iVar7 = 6;
  if (1 < param_5 - 9U) {
    iVar7 = 3;
  }
  iVar11 = 0;
  iVar5 = piVar2[1];
  iVar1 = *piVar2;
  local_7c = param_4;
  local_68 = param_1;
  local_60 = param_3;
  do {
    iVar8 = (int)uVar10;
    uVar4 = FUN_18000e2e0(local_68,iVar12,iVar13,iVar8,&local_78,&local_84,local_88);
    if (((int)uVar4 == 0) || (uVar4 = FUN_18000e610(&local_78,&local_84,&local_58), (int)uVar4 == 0)
       ) goto LAB_18000eb7d;
    uVar10 = SEXT48(local_58);
    iVar3 = local_58;
    if (local_58 < 1) {
      iVar3 = -local_58;
    }
    uVar15 = SEXT48(local_50);
    uVar14 = SEXT48(local_54);
    if (iVar3 < 0x800) {
      iVar3 = local_54;
      if (local_54 < 1) {
        iVar3 = -local_54;
      }
      if (iVar3 < 0x800) {
        iVar3 = local_50;
        if (local_50 < 1) {
          iVar3 = -local_50;
        }
        if (iVar3 < 0x800) {
          lVar16 = (longlong)local_80 * uVar15 + (longlong)local_82 * uVar14 +
                   (longlong)local_84 * uVar10;
          lVar6 = (longlong)local_88[0] * 0x4000 + lVar16;
          if (lVar6 < 1) {
            lVar6 = -((longlong)local_88[0] * 0x4000 + lVar16);
          }
          if (0x1477fff < lVar6) {
            iVar5 = (int)local_76 * (int)local_78 - (int)local_72 * (int)local_72;
            if (0 < iVar5) {
              lVar6 = (longlong)((int)local_76 + (int)local_78);
              lVar6 = lVar6 * lVar6;
              if (local_7c * lVar6 <
                  (longlong)iVar5 * (longlong)(local_7c + 1) * (longlong)(local_7c + 1)) {
                *(short *)(param_2 + 4) = (short)(iVar12 * 0x1000 + local_58 >> 4);
                *(short *)((longlong)param_2 + 0x12) = (short)(iVar13 * 0x1000 + local_54 >> 4);
                *local_60 = (int)((lVar6 * 0x400) / (longlong)iVar5);
                uVar10 = FUN_1800354d0(((local_50 + iVar8 * 0x1000) * 0x10) / iVar7);
                param_2[5] = (int)((uVar10 & 0xffffffff) * 0x13333 >> 0x10);
              }
            }
          }
LAB_18000eb7d:
          FUN_18005f100(local_48 ^ (ulonglong)&stack0xffffffffffffff38);
          return;
        }
      }
    }
    if (local_58 < 0) {
      iVar3 = -((uint)((-local_58 & 0x800U) != 0) + (-local_58 >> 0xc));
    }
    else {
      iVar3 = local_58;
      if (local_58 < 1) {
        iVar3 = -local_58;
        uVar10 = (ulonglong)(uint)-local_58;
      }
      iVar3 = (uint)((uVar10 & 0x800) != 0) + (iVar3 >> 0xc);
    }
    iVar12 = iVar12 + iVar3;
    if (local_54 < 0) {
      iVar3 = -((uint)((-local_54 & 0x800U) != 0) + (-local_54 >> 0xc));
    }
    else {
      iVar3 = local_54;
      if (local_54 < 1) {
        iVar3 = -local_54;
        uVar14 = (ulonglong)(uint)-local_54;
      }
      iVar3 = (uint)((uVar14 & 0x800) != 0) + (iVar3 >> 0xc);
    }
    iVar13 = iVar13 + iVar3;
    if (local_50 < 0) {
      iVar3 = -((uint)((-local_50 & 0x800U) != 0) + (-local_50 >> 0xc));
    }
    else {
      iVar3 = local_50;
      if (local_50 < 1) {
        iVar3 = -local_50;
        uVar15 = (ulonglong)(uint)-local_50;
      }
      iVar3 = (uint)((uVar15 & 0x800) != 0) + (iVar3 >> 0xc);
    }
    uVar9 = iVar8 + iVar3;
    uVar10 = (ulonglong)uVar9;
    *param_2 = iVar12;
    param_2[1] = iVar13;
    param_2[2] = uVar9;
    if (((((int)uVar9 < 1) || (iVar7 < (int)uVar9)) || (iVar1 + -1 <= iVar12)) ||
       (((iVar12 < 1 || (iVar5 + -1 <= iVar13)) ||
        ((iVar13 < 1 || (iVar11 = iVar11 + 1, 4 < iVar11)))))) goto LAB_18000eb7d;
  } while( true );
}



uint * FUN_18000ed20(uint *param_1,int param_2,int param_3)

{
  uint uVar1;
  uint *puVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  uint *puVar7;
  uint *puVar8;

  iVar3 = 0;
  if (0 < param_2) {
    puVar8 = param_1;
    do {
      if (iVar3 < param_2) {
        puVar2 = puVar8;
        puVar7 = puVar8;
        iVar6 = iVar3;
        do {
          uVar1 = (iVar6 * iVar6 + iVar3 * iVar3) * param_3;
          if (uVar1 < 0x6ee76) {
            uVar5 = (uVar1 >> 8) * (uVar1 >> 8);
            uVar4 = uVar5 >> 8;
            uVar1 = ((uVar4 * uVar4 >> 8) * (uVar1 / 5 + 0x10000 >> 8) >> 7) / 0x18 +
                    ((uVar1 / 6 + 0x8000 >> 8) * uVar5 >> 0xf) + 0x200 + (uVar1 >> 7);
            uVar1 = ((uVar1 >> 1) + 0x40000) / uVar1;
          }
          else {
            uVar1 = 0;
          }
          *puVar7 = uVar1;
          iVar6 = iVar6 + 1;
          *puVar2 = uVar1;
          puVar7 = puVar7 + 1;
          puVar2 = puVar2 + param_2;
        } while (iVar6 < param_2);
      }
      puVar8 = puVar8 + (param_2 + 1);
      iVar3 = iVar3 + 1;
    } while (iVar3 < param_2);
  }
  return param_1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18000ee70(int param_1,int param_2,int param_3,longlong param_4)

{
  uint *puVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  uint uVar12;
  int iVar13;
  longlong lVar14;
  int *piVar15;
  longlong lVar16;
  longlong lVar17;
  uint uVar18;
  uint *puVar19;
  int iVar20;
  int iVar21;
  int iVar22;
  ulonglong uVar23;
  ulonglong uVar24;
  uint uVar25;
  ulonglong uVar26;
  int iVar27;
  longlong lVar28;
  undefined auVar29 [16];
  longlong lStackX8;
  int *apiStackX16 [2];
  uint uStackX32;
  uint uStackX36;
  undefined8 uStack72;

  uStack72 = 0x18000ee87;
  lVar14 = _alloca_probe();
  lVar14 = -lVar14;
  *(ulonglong *)(&stack0x000011d0 + lVar14) =
       DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffc0 + lVar14);
  iVar20 = 0;
  piVar15 = *(int **)(&stack0x00001250 + lVar14);
  *(undefined8 *)(&stack0xfffffffffffffff8 + lVar14) = *(undefined8 *)(&stack0x00001258 + lVar14);
  *(int **)((longlong)apiStackX16 + lVar14) = *(int **)(&stack0x00001260 + lVar14);
  uVar12 = param_3 * 0x12 >> 2;
  uVar18 = param_3 * 0x12 >> 0x1f;
  if ((int)uVar12 < 0) {
    uVar18 = (uVar12 ^ uVar18) - uVar18;
    iVar27 = -((uint)((uVar18 & 0x8000) != 0) + ((int)uVar18 >> 0x10));
  }
  else {
    uVar18 = (uVar12 ^ uVar18) - uVar18;
    iVar27 = (uint)((uVar18 & 0x8000) != 0) + ((int)uVar18 >> 0x10);
  }
  if (0x20 < iVar27) {
    iVar27 = 0x20;
  }
  lVar16 = (longlong)(param_3 * 6 >> 2);
  iVar21 = *piVar15;
  *(int *)(&stack0xffffffffffffffe8 + lVar14) = iVar21;
  uVar18 = -iVar27;
  uVar12 = 1U - param_2;
  if ((int)(1U - param_2) <= (int)uVar18) {
    uVar12 = uVar18;
  }
  iVar13 = (piVar15[1] - param_2) + -2;
  if (iVar27 <= iVar13) {
    iVar13 = iVar27;
  }
  *(int *)(&stack0xffffffffffffffe4 + lVar14) = iVar13;
  uVar25 = 1U - param_1;
  if ((int)(1U - param_1) <= (int)uVar18) {
    uVar25 = uVar18;
  }
  *(uint *)(&stack0xffffffffffffffe0 + lVar14) = uVar25;
  iVar13 = (iVar21 - param_1) + -2;
  *(int *)(&stack0xfffffffffffffff0 + lVar14) = iVar27 + 1;
  lVar17 = (longlong)(int)((uVar12 + param_2) * iVar21 + param_1);
  lVar28 = *(longlong *)(piVar15 + 6) + lVar17 * 4;
  lVar17 = *(longlong *)(param_4 + 0x18) + lVar17 * 2;
  *(undefined8 *)((longlong)&uStack72 + lVar14) = 0x18000efb5;
  memset((uint *)((longlong)&uStackX32 + lVar14),0,0xa0,*(undefined *)((longlong)&uStack72 + lVar14)
        );
  iVar21 = iVar27 + 1;
  *(undefined8 *)((longlong)&uStack72 + lVar14) = 0x18000efcb;
  FUN_18000ed20((uint *)(&stack0x000000c0 + lVar14),iVar21,
                SUB164((SEXT816(0x800000000000) & (undefined  [16])0xffffffffffffffff |
                       ZEXT816(0x800000000000)) / SEXT816(lVar16 * lVar16),0),
                *(undefined *)((longlong)&uStack72 + lVar14));
  if (iVar27 <= iVar13) {
    iVar13 = iVar27;
  }
  iVar27 = *(int *)(&stack0x00001268 + lVar14);
  if ((int)uVar12 <= *(int *)(&stack0xffffffffffffffe4 + lVar14)) {
    iVar2 = *(int *)(&stack0xffffffffffffffe8 + lVar14);
    uVar23 = SEXT48(*(int *)(&stack0xffffffffffffffe0 + lVar14));
    *(ulonglong *)((longlong)&uStackX32 + lVar14 + -0x20) = uVar23;
    *(longlong *)((longlong)&lStackX8 + lVar14) = (longlong)iVar2 * 2;
    uVar24 = uVar23;
    do {
      uVar26 = uVar24 & 0xffffffff;
      if ((longlong)uVar23 <= (longlong)iVar13) {
        do {
          uVar18 = (uint)uVar26;
          iVar3 = (*(short *)(lVar17 + uVar23 * 2) * -0x24 + 0x743d4) / 0x6488;
          iVar22 = 0;
          if (iVar3 < 0x24) {
            iVar22 = iVar3;
          }
          uVar25 = (uint)(*(int *)(lVar28 + uVar23 * 4) *
                         *(int *)(&stack0x000000c0 +
                                 ((longlong)
                                  (int)((uVar18 ^ (int)uVar18 >> 0x1f) - ((int)uVar18 >> 0x1f)) +
                                 (longlong)
                                 (int)(((uVar12 ^ (int)uVar12 >> 0x1f) - ((int)uVar12 >> 0x1f)) *
                                      iVar21)) * 4 + lVar14)) >> 8;
          *(uint *)(&stack0x00000028 + (longlong)iVar22 * 4 + lVar14) =
               *(int *)(&stack0x00000028 + (longlong)iVar22 * 4 + lVar14) + uVar25;
          if (iVar27 != 0) {
            *(uint *)(&stack0x00000028 + (longlong)((iVar22 + 0x12) % 0x24) * 4 + lVar14) =
                 *(int *)(&stack0x00000028 + (longlong)((iVar22 + 0x12) % 0x24) * 4 + lVar14) +
                 uVar25;
          }
          uVar26 = (ulonglong)(uVar18 + 1);
          uVar23 = uVar23 + 1;
        } while ((longlong)uVar23 <= (longlong)iVar13);
        uVar23 = *(ulonglong *)((longlong)&uStackX32 + lVar14 + -0x20);
        uVar24 = (ulonglong)*(uint *)(&stack0xffffffffffffffe0 + lVar14);
        iVar21 = *(int *)(&stack0xfffffffffffffff0 + lVar14);
      }
      lVar17 = lVar17 + *(longlong *)((longlong)&lStackX8 + lVar14);
      lVar28 = lVar28 + (longlong)iVar2 * 4;
      uVar12 = uVar12 + 1;
    } while ((int)uVar12 <= *(int *)(&stack0xffffffffffffffe4 + lVar14));
  }
  iVar21 = 1;
  uVar23 = 0;
  puVar19 = *(uint **)(&stack0xfffffffffffffff8 + lVar14);
  *(undefined4 *)((longlong)&uStackX32 + lVar14 + 4) = *(undefined4 *)(&stack0x000000b4 + lVar14);
  *(uint *)((longlong)&uStackX32 + lVar14) = *(uint *)(&stack0x000000b0 + lVar14);
  *(undefined4 *)(&stack0x000000b8 + lVar14) = *(undefined4 *)(&stack0x00000028 + lVar14);
  *(undefined4 *)(&stack0x000000bc + lVar14) = *(undefined4 *)(&stack0x0000002c + lVar14);
  if (((1 < DAT_1800b04f8) &&
      ((&stack0x000000bc + lVar14 < puVar19 ||
       (puVar19 + 0x23 < (uint *)((longlong)&uStackX32 + lVar14 + 4))))) &&
     ((&stack0x000000b8 + lVar14 < puVar19 ||
      (puVar19 + 0x23 < (uint *)((longlong)&uStackX32 + lVar14))))) {
    uVar23 = 0x24;
    lVar16 = 9;
    piVar15 = (int *)((longlong)&uStackX32 + lVar14 + 4);
    do {
      iVar13 = piVar15[1];
      iVar2 = piVar15[2];
      iVar3 = piVar15[3];
      iVar22 = piVar15[3];
      iVar4 = piVar15[4];
      iVar5 = piVar15[5];
      auVar29 = pmulld(*(undefined (*) [16])(piVar15 + 1),_DAT_1800a41b0);
      iVar6 = *piVar15;
      iVar7 = piVar15[1];
      iVar8 = piVar15[2];
      iVar9 = piVar15[4];
      iVar10 = piVar15[5];
      iVar11 = piVar15[6];
      puVar1 = (uint *)((longlong)puVar19 + (-0x10 - ((longlong)&uStackX32 + lVar14 + 4)) +
                       (longlong)(piVar15 + 4));
      *puVar1 = (uint)((piVar15[2] + *piVar15) * 4 + SUB164(auVar29,0) + piVar15[-1] + piVar15[3])
                >> 4;
      puVar1[1] = (uint)(iVar22 + iVar13 + SUB164(auVar29 >> 0x20,0) + iVar6 + iVar9) >> 4;
      puVar1[2] = (uint)(iVar4 + iVar2 + SUB164(auVar29 >> 0x40,0) + iVar7 + iVar10) >> 4;
      puVar1[3] = (uint)(iVar5 + iVar3 + SUB164(auVar29 >> 0x60,0) + iVar8 + iVar11) >> 4;
      lVar16 = lVar16 + -1;
      piVar15 = piVar15 + 4;
    } while (lVar16 != 0);
  }
  if (uVar23 < 0x24) {
    lVar16 = 0x24 - uVar23;
    piVar15 = (int *)((longlong)&uStackX32 + uVar23 * 4 + lVar14 + 4);
    do {
      *(uint *)((longlong)piVar15 +
               (longlong)((longlong)puVar19 - ((longlong)&uStackX32 + lVar14 + 4))) =
           (uint)(piVar15[1] * 6 + (piVar15[2] + *piVar15) * 4 + piVar15[3] + piVar15[-1]) >> 4;
      lVar16 = lVar16 + -1;
      piVar15 = piVar15 + 1;
    } while (lVar16 != 0);
  }
  uVar12 = *puVar19;
  do {
    puVar19 = puVar19 + 1;
    if (uVar12 < *puVar19) {
      iVar20 = iVar21;
      uVar12 = *puVar19;
    }
    iVar21 = iVar21 + 1;
  } while (iVar21 < 0x24);
  if (iVar27 != 0) {
    **(int **)((longlong)apiStackX16 + lVar14) = iVar20 + 0x12;
  }
  *(undefined8 *)((longlong)&uStack72 + lVar14) = 0x18000f289;
  FUN_18005f100(*(ulonglong *)(&stack0x000011d0 + lVar14) ^
                (ulonglong)(&stack0xffffffffffffffc0 + lVar14),
                *(undefined *)((longlong)&uStack72 + lVar14));
  return;
}



void FUN_18000f2a0(longlong param_1,int param_2,int param_3,int param_4,int param_5)

{
  longlong lVar1;
  int *piVar2;
  longlong lVar3;
  uint uVar4;
  longlong lVar5;
  uint uVar6;
  longlong lVar7;
  int iVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  int iVar12;
  int iVar13;
  uint uVar14;
  uint uVar15;

  uVar6 = param_4 >> 0xc;
  iVar8 = param_2 + (param_2 >> 9) * -0x200;
  iVar13 = param_4 + uVar6 * -0x1000;
  uVar11 = (uint)((param_3 + (param_3 >> 9) * -0x200) * (param_5 >> 9)) >> 9;
  iVar12 = (param_5 >> 9) - uVar11;
  lVar1 = param_1 + (longlong)(((param_2 >> 9) + (param_3 >> 9) * 6) * 8 + 0x38) * 4;
  uVar9 = (uint)(iVar12 * iVar8) >> 9;
  uVar10 = uVar11 * iVar8 >> 9;
  iVar12 = iVar12 - uVar9;
  uVar15 = iVar12 * iVar13;
  uVar14 = (uVar11 - uVar10) * iVar13;
  uVar4 = uVar6 & 0x80000007;
  if ((int)uVar4 < 0) {
    uVar4 = (uVar4 - 1 | 0xfffffff8) + 1;
  }
  lVar3 = (longlong)(int)uVar4 * 4;
  *(int *)(lVar3 + lVar1) = *(int *)(lVar3 + lVar1) + (iVar12 - (uVar15 >> 0xc) >> 5);
  uVar4 = uVar6 + 1 & 0x80000007;
  if ((int)uVar4 < 0) {
    uVar4 = (uVar4 - 1 | 0xfffffff8) + 1;
  }
  lVar5 = (longlong)(int)uVar4;
  piVar2 = (int *)(lVar1 + lVar5 * 4);
  *piVar2 = *piVar2 + (uVar15 >> 0x11);
  piVar2 = (int *)(lVar3 + 0x20 + lVar1);
  *piVar2 = *piVar2 + (uVar9 - (uVar9 * iVar13 >> 0xc) >> 5);
  piVar2 = (int *)(lVar1 + 0x20 + lVar5 * 4);
  *piVar2 = *piVar2 + (uVar9 * iVar13 >> 0x11);
  lVar7 = lVar1 + 0xc0;
  *(int *)(lVar3 + lVar7) = *(int *)(lVar3 + lVar7) + ((uVar11 - uVar10) - (uVar14 >> 0xc) >> 5);
  piVar2 = (int *)(lVar7 + lVar5 * 4);
  *piVar2 = *piVar2 + (uVar14 >> 0x11);
  piVar2 = (int *)(lVar3 + 0x20 + lVar7);
  *piVar2 = *piVar2 + (uVar10 - (uVar10 * iVar13 >> 0xc) >> 5);
  piVar2 = (int *)(lVar1 + 0xe0 + lVar5 * 4);
  *piVar2 = *piVar2 + (uVar10 * iVar13 >> 0x11);
  return;
}



void FUN_18000f400(int param_1,int param_2,int param_3,short param_4)

{
  undefined *puVar1;
  int *piVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  int iVar11;
  uint uVar12;
  longlong lVar13;
  ulonglong uVar14;
  longlong lVar15;
  uint uVar16;
  int iVar17;
  longlong lVar18;
  longlong lVar19;
  undefined *puVar20;
  undefined4 *puVar21;
  uint uVar22;
  ulonglong uVar23;
  uint uVar24;
  longlong lVar25;
  undefined4 *puVar26;
  int iVar27;
  uint uVar28;
  int iVar29;
  int iVar30;
  int iVar31;
  uint uVar32;
  uint uVar33;
  longlong lVar34;
  int aiStackX8 [6];
  longlong lStackX32;
  undefined8 uStack72;

  uStack72 = 0x18000f417;
  lVar13 = _alloca_probe();
  lVar13 = -lVar13;
  *(ulonglong *)(&stack0x000015f0 + lVar13) =
       DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffc0 + lVar13);
  puVar26 = *(undefined4 **)(&stack0x00001680 + lVar13);
  *(undefined8 *)(&stack0xfffffffffffffff8 + lVar13) = *(undefined8 *)(&stack0x00001670 + lVar13);
  *(undefined8 *)((longlong)&lStackX32 + lVar13 + -0x20) =
       *(undefined8 *)(&stack0x00001678 + lVar13);
  lVar34 = (longlong)(param_3 * 3);
  *(int *)(&stack0xffffffffffffffe4 + lVar13) = param_2;
  uVar14 = lVar34 * 0x38916 >> 0x10;
  *(undefined4 **)(&stack0x00000050 + lVar13) = puVar26;
  uVar23 = lVar34 * 0x38916 >> 0x3f;
  if ((longlong)uVar14 < 0) {
    uVar23 = (uVar14 ^ uVar23) - uVar23;
    iVar27 = -((uint)((uVar23 & 0x8000) != 0) + (int)(uVar23 >> 0x10));
  }
  else {
    uVar23 = (uVar14 ^ uVar23) - uVar23;
    iVar27 = (uint)((uVar23 & 0x8000) != 0) + (int)(uVar23 >> 0x10);
  }
  if (0x20 < iVar27) {
    iVar27 = 0x20;
  }
  *(int *)(&stack0xfffffffffffffff0 + lVar13) = (int)param_4;
  *(undefined8 *)((longlong)&uStack72 + lVar13) = 0x18000f4d0;
  FUN_180035330((int)param_4,(int *)(&stack0xffffffffffffffe8 + lVar13),
                (int *)(&stack0xffffffffffffffec + lVar13),
                *(undefined *)((longlong)&uStack72 + lVar13));
  piVar2 = *(int **)((longlong)&lStackX32 + lVar13 + -0x20);
  lVar18 = (longlong)
           SUB164((SEXT816(0x1000000000) & (undefined  [16])0xffffffffffffffff |
                  ZEXT816(0x1000000000)) / SEXT816(lVar34),0);
  iVar30 = *piVar2;
  iVar11 = piVar2[1];
  uVar16 = -iVar27;
  lVar25 = *(int *)(&stack0xffffffffffffffec + lVar13) * lVar18 >> 0x19;
  *(int *)(&stack0xffffffffffffffe0 + lVar13) = iVar30;
  *(longlong *)(&stack0x00000028 + lVar13) = lVar25;
  lVar18 = *(int *)(&stack0xffffffffffffffe8 + lVar13) * lVar18 >> 0x19;
  *(longlong *)(&stack0x00000030 + lVar13) = lVar18;
  uVar22 = 1U - param_2;
  if ((int)(1U - param_2) <= (int)uVar16) {
    uVar22 = uVar16;
  }
  iVar11 = (iVar11 - param_2) + -2;
  *(uint *)(&stack0xfffffffffffffff4 + lVar13) = uVar22;
  if (iVar27 <= iVar11) {
    iVar11 = iVar27;
  }
  *(int *)(&stack0xffffffffffffffe8 + lVar13) = iVar11;
  uVar12 = 1U - param_1;
  if ((int)(1U - param_1) <= (int)uVar16) {
    uVar12 = uVar16;
  }
  *(int *)((longlong)aiStackX8 + lVar13) = iVar27 + 1;
  *(uint *)(&stack0xffffffffffffffec + lVar13) = uVar12;
  iVar11 = (iVar30 - param_1) + -2;
  lVar19 = (longlong)
           (int)((*(int *)(&stack0xffffffffffffffe4 + lVar13) + uVar22) * iVar30 + param_1);
  *(longlong *)((longlong)&lStackX32 + lVar13) = *(longlong *)(piVar2 + 6) + lVar19 * 4;
  lVar19 = *(longlong *)(*(longlong *)(&stack0xfffffffffffffff8 + lVar13) + 0x18) + lVar19 * 2;
  *(longlong *)((longlong)&lStackX32 + lVar13 + -0x20) = lVar19;
  *(undefined8 *)((longlong)&uStack72 + lVar13) = 0x18000f5a4;
  memset(&stack0x00000060 + lVar13,0,0x480,*(undefined *)((longlong)&uStack72 + lVar13));
  *(undefined8 *)((longlong)&uStack72 + lVar13) = 0x18000f5ca;
  FUN_18000ed20((uint *)(&stack0x000004e0 + lVar13),iVar27 + 1,
                SUB164((SEXT816(0x200000000000) & (undefined  [16])0xffffffffffffffff |
                       ZEXT816(0x200000000000)) / SEXT816(lVar34 * lVar34),0),
                *(undefined *)((longlong)&uStack72 + lVar13));
  if (iVar27 <= iVar11) {
    iVar11 = iVar27;
  }
  lVar34 = (longlong)iVar11;
  *(longlong *)(&stack0xfffffffffffffff8 + lVar13) = lVar34;
  if ((int)uVar22 <= *(int *)(&stack0xffffffffffffffe8 + lVar13)) {
    uVar23 = SEXT48(*(int *)(&stack0xffffffffffffffec + lVar13));
    iVar27 = *(int *)(&stack0xfffffffffffffff0 + lVar13);
    iVar30 = uVar22 * (int)lVar18;
    *(ulonglong *)(&stack0x00000038 + lVar13) = uVar23;
    *(longlong *)(&stack0x00000040 + lVar13) =
         (longlong)*(int *)(&stack0xffffffffffffffe0 + lVar13) * 4;
    iVar11 = uVar22 * (int)lVar25;
    *(longlong *)(&stack0x00000048 + lVar13) =
         (longlong)*(int *)(&stack0xffffffffffffffe0 + lVar13) * 2;
    *(int *)(&stack0xffffffffffffffe4 + lVar13) = iVar30;
    *(int *)(&stack0xffffffffffffffe0 + lVar13) = iVar11;
    uVar14 = uVar23;
    do {
      uVar23 = uVar23 & 0xffffffff;
      iVar29 = (uVar22 ^ (int)uVar22 >> 0x1f) - ((int)uVar22 >> 0x1f);
      *(int *)((longlong)aiStackX8 + lVar13 + 0x10) = iVar29;
      if ((longlong)uVar14 <= lVar34) {
        lVar34 = *(longlong *)(&stack0xfffffffffffffff8 + lVar13);
        iVar11 = (int)uVar23 * (int)lVar18 + 0x300 + iVar11;
        iVar30 = ((int)uVar23 * (int)lVar25 - iVar30) + 0x300;
        do {
          uVar22 = (int)(iVar30 - 0x300U) >> 0x1f;
          uVar16 = (uint)uVar23;
          if (((int)((iVar30 - 0x300U ^ uVar22) - uVar22) < 0x500) &&
             (uVar22 = (int)(iVar11 - 0x300U) >> 0x1f,
             (int)((iVar11 - 0x300U ^ uVar22) - uVar22) < 0x500)) {
            iVar29 = *(int *)(&stack0x000004e0 +
                             ((longlong)
                              (int)((uVar16 ^ (int)uVar16 >> 0x1f) - ((int)uVar16 >> 0x1f)) +
                             (longlong)(iVar29 * *(int *)((longlong)aiStackX8 + lVar13))) * 4 +
                             lVar13);
            uVar22 = (0x3244 - *(short *)(lVar19 + uVar14 * 2)) - iVar27;
            if ((int)uVar22 < 0) {
              uVar22 = uVar22 + (~uVar22 / 0x6488) * 0x6488 + 0x6488;
            }
            if (0x6487 < (int)uVar22) {
              uVar22 = uVar22 % 0x6488;
            }
            iVar17 = iVar30 + (iVar30 >> 9) * -0x200;
            iVar31 = (int)(uVar22 * 0x145f3) >> 0x1c;
            *(int *)(&stack0xfffffffffffffff0 + lVar13) = iVar31;
            iVar31 = ((int)(uVar22 * 0x145f3) >> 0x10) + iVar31 * -0x1000;
            iVar29 = *(int *)(*(longlong *)((longlong)&lStackX32 + lVar13) + uVar14 * 4) * iVar29 >>
                     9;
            uVar28 = (uint)((iVar11 + (iVar11 >> 9) * -0x200) * iVar29) >> 9;
            iVar29 = iVar29 - uVar28;
            uVar24 = uVar28 * iVar17 >> 9;
            uVar33 = (uint)(iVar29 * iVar17) >> 9;
            iVar29 = iVar29 - uVar33;
            uVar32 = iVar29 * iVar31;
            *(uint *)((longlong)aiStackX8 + lVar13 + 0xc) = uVar24 * iVar31 >> 0xc;
            *(uint *)((longlong)aiStackX8 + lVar13 + 8) = (uVar28 - uVar24) * iVar31 >> 0xc;
            uVar22 = *(uint *)(&stack0xfffffffffffffff0 + lVar13);
            *(uint *)((longlong)aiStackX8 + lVar13 + 4) = uVar33 * iVar31 >> 0xc;
            puVar1 = &stack0x00000060 +
                     (longlong)(((iVar30 >> 9) + (iVar11 >> 9) * 6) * 8 + 0x38) * 4 + lVar13;
            uVar12 = uVar22 & 0x80000007;
            if ((int)uVar12 < 0) {
              uVar12 = (uVar12 - 1 | 0xfffffff8) + 1;
            }
            lVar34 = (longlong)(int)uVar12 * 4;
            *(uint *)(puVar1 + lVar34) = *(int *)(puVar1 + lVar34) + (iVar29 - (uVar32 >> 0xc) >> 5)
            ;
            uVar22 = uVar22 + 1 & 0x80000007;
            if ((int)uVar22 < 0) {
              uVar22 = (uVar22 - 1 | 0xfffffff8) + 1;
            }
            uVar12 = *(uint *)((longlong)aiStackX8 + lVar13 + 4);
            lVar15 = (longlong)(int)uVar22;
            *(uint *)(puVar1 + lVar15 * 4) = *(int *)(puVar1 + lVar15 * 4) + (uVar32 >> 0x11);
            *(uint *)(puVar1 + lVar34 + 0x20) =
                 *(int *)(puVar1 + lVar34 + 0x20) + (uVar33 - uVar12 >> 5);
            *(uint *)(puVar1 + lVar15 * 4 + 0x20) =
                 *(int *)(puVar1 + lVar15 * 4 + 0x20) + (uVar12 >> 5);
            puVar20 = puVar1 + 0xc0;
            uVar22 = *(uint *)((longlong)aiStackX8 + lVar13 + 8);
            lVar18 = *(longlong *)(&stack0x00000030 + lVar13);
            lVar19 = *(longlong *)((longlong)&lStackX32 + lVar13 + -0x20);
            *(uint *)(puVar20 + lVar34) =
                 *(int *)(puVar20 + lVar34) + ((uVar28 - uVar24) - uVar22 >> 5);
            *(uint *)(puVar20 + lVar15 * 4) = *(int *)(puVar20 + lVar15 * 4) + (uVar22 >> 5);
            uVar22 = *(uint *)((longlong)aiStackX8 + lVar13 + 0xc);
            *(uint *)(puVar20 + lVar34 + 0x20) =
                 *(int *)(puVar20 + lVar34 + 0x20) + (uVar24 - uVar22 >> 5);
            lVar25 = *(longlong *)(&stack0x00000028 + lVar13);
            *(uint *)(puVar1 + lVar15 * 4 + 0xe0) =
                 *(int *)(puVar1 + lVar15 * 4 + 0xe0) + (uVar22 >> 5);
            iVar29 = *(int *)((longlong)aiStackX8 + lVar13 + 0x10);
            lVar34 = *(longlong *)(&stack0xfffffffffffffff8 + lVar13);
          }
          uVar23 = (ulonglong)(uVar16 + 1);
          iVar30 = iVar30 + (int)lVar25;
          iVar11 = iVar11 + (int)lVar18;
          uVar14 = uVar14 + 1;
        } while ((longlong)uVar14 <= lVar34);
        uVar22 = *(uint *)(&stack0xfffffffffffffff4 + lVar13);
        iVar30 = *(int *)(&stack0xffffffffffffffe4 + lVar13);
        iVar11 = *(int *)(&stack0xffffffffffffffe0 + lVar13);
        uVar14 = *(ulonglong *)(&stack0x00000038 + lVar13);
      }
      lVar19 = lVar19 + *(longlong *)(&stack0x00000048 + lVar13);
      uVar22 = uVar22 + 1;
      iVar11 = iVar11 + (int)lVar25;
      *(longlong *)((longlong)&lStackX32 + lVar13) =
           *(longlong *)((longlong)&lStackX32 + lVar13) + *(longlong *)(&stack0x00000040 + lVar13);
      iVar30 = iVar30 + (int)lVar18;
      uVar23 = (ulonglong)*(uint *)(&stack0xffffffffffffffec + lVar13);
      *(longlong *)((longlong)&lStackX32 + lVar13 + -0x20) = lVar19;
      *(uint *)(&stack0xfffffffffffffff4 + lVar13) = uVar22;
      *(int *)(&stack0xffffffffffffffe0 + lVar13) = iVar11;
      *(int *)(&stack0xffffffffffffffe4 + lVar13) = iVar30;
    } while ((int)uVar22 <= *(int *)(&stack0xffffffffffffffe8 + lVar13));
    puVar26 = *(undefined4 **)(&stack0x00000050 + lVar13);
  }
  puVar21 = (undefined4 *)(&stack0x00000140 + lVar13);
  lVar34 = 4;
  do {
    if (((puVar26 != (undefined4 *)0x0) && (puVar21 != (undefined4 *)0x0)) &&
       ((puVar21 + 0x20 <= puVar26 || (puVar26 + 0x20 <= puVar21)))) {
      uVar3 = puVar21[1];
      uVar4 = puVar21[2];
      uVar5 = puVar21[3];
      uVar6 = puVar21[4];
      uVar7 = puVar21[5];
      uVar8 = puVar21[6];
      uVar9 = puVar21[7];
      *puVar26 = *puVar21;
      puVar26[1] = uVar3;
      puVar26[2] = uVar4;
      puVar26[3] = uVar5;
      uVar3 = puVar21[8];
      uVar4 = puVar21[9];
      uVar5 = puVar21[10];
      uVar10 = puVar21[0xb];
      puVar26[4] = uVar6;
      puVar26[5] = uVar7;
      puVar26[6] = uVar8;
      puVar26[7] = uVar9;
      uVar6 = puVar21[0xc];
      uVar7 = puVar21[0xd];
      uVar8 = puVar21[0xe];
      uVar9 = puVar21[0xf];
      puVar26[8] = uVar3;
      puVar26[9] = uVar4;
      puVar26[10] = uVar5;
      puVar26[0xb] = uVar10;
      uVar3 = puVar21[0x10];
      uVar4 = puVar21[0x11];
      uVar5 = puVar21[0x12];
      uVar10 = puVar21[0x13];
      puVar26[0xc] = uVar6;
      puVar26[0xd] = uVar7;
      puVar26[0xe] = uVar8;
      puVar26[0xf] = uVar9;
      uVar6 = puVar21[0x14];
      uVar7 = puVar21[0x15];
      uVar8 = puVar21[0x16];
      uVar9 = puVar21[0x17];
      puVar26[0x10] = uVar3;
      puVar26[0x11] = uVar4;
      puVar26[0x12] = uVar5;
      puVar26[0x13] = uVar10;
      uVar3 = puVar21[0x18];
      uVar4 = puVar21[0x19];
      uVar5 = puVar21[0x1a];
      uVar10 = puVar21[0x1b];
      puVar26[0x14] = uVar6;
      puVar26[0x15] = uVar7;
      puVar26[0x16] = uVar8;
      puVar26[0x17] = uVar9;
      uVar6 = puVar21[0x1c];
      uVar7 = puVar21[0x1d];
      uVar8 = puVar21[0x1e];
      uVar9 = puVar21[0x1f];
      puVar26[0x18] = uVar3;
      puVar26[0x19] = uVar4;
      puVar26[0x1a] = uVar5;
      puVar26[0x1b] = uVar10;
      puVar26[0x1c] = uVar6;
      puVar26[0x1d] = uVar7;
      puVar26[0x1e] = uVar8;
      puVar26[0x1f] = uVar9;
    }
    puVar21 = puVar21 + 0x30;
    puVar26 = puVar26 + 0x20;
    lVar34 = lVar34 + -1;
  } while (lVar34 != 0);
  *(undefined8 *)((longlong)&uStack72 + lVar13) = 0x18000f985;
  FUN_18005f100(*(ulonglong *)(&stack0x000015f0 + lVar13) ^
                (ulonglong)(&stack0xffffffffffffffc0 + lVar13),
                *(undefined *)((longlong)&uStack72 + lVar13));
  return;
}



ulonglong FUN_18000f9a0(longlong param_1,int param_2)

{
  uint *puVar1;
  uint *puVar2;
  uint *puVar3;
  uint uVar4;
  byte bVar5;
  ulonglong uVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  uint *puVar10;

  uVar9 = 0;
  uVar8 = uVar9;
  if (0 < param_2) {
    puVar10 = (uint *)(param_1 + 8);
    uVar7 = (ulonglong)((param_2 - 1U >> 2) + 1);
    do {
      puVar1 = puVar10 + -1;
      puVar2 = puVar10 + -2;
      puVar3 = puVar10 + 1;
      uVar4 = *puVar10;
      puVar10 = puVar10 + 4;
      uVar8 = uVar8 + (ulonglong)uVar4 * (ulonglong)uVar4 +
              (ulonglong)*puVar2 * (ulonglong)*puVar2 + (ulonglong)*puVar1 * (ulonglong)*puVar1 +
              (ulonglong)*puVar3 * (ulonglong)*puVar3;
      uVar7 = uVar7 - 1;
    } while (uVar7 != 0);
  }
  bVar5 = 0x1f;
  uVar7 = 0x80000000;
  if (1 < uVar8) {
    do {
      uVar6 = (uint)((int)uVar9 * 2) + uVar7 << (bVar5 & 0x3f);
      bVar5 = bVar5 - 1;
      if (uVar6 <= uVar8) {
        uVar9 = (ulonglong)(uint)((int)uVar9 + (int)uVar7);
        uVar8 = uVar8 - uVar6;
      }
      uVar7 = uVar7 >> 1;
    } while (uVar7 != 0);
    return uVar9;
  }
  return uVar8 & 0xffffffff;
}



void FUN_18000fa50(longlong param_1,longlong param_2,longlong param_3,int param_4,int *param_5)

{
  uint *puVar1;
  uint *puVar2;
  uint *puVar3;
  undefined8 *puVar4;
  uint uVar5;
  uint uVar6;
  longlong lVar7;
  byte bVar8;
  uint uVar9;
  ulonglong uVar10;
  uint uVar11;
  int iVar12;
  uint uVar13;
  ulonglong uVar14;
  short *psVar15;
  uint uVar16;
  ulonglong uVar17;
  ulonglong uVar18;
  undefined *puVar19;
  uint *puVar20;
  uint uVar21;
  longlong lVar22;
  short *psVar23;
  undefined auStack376 [32];
  int local_158;
  undefined auStack332 [4];
  undefined8 local_148 [32];
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)auStack376;
  lVar7 = (longlong)param_4;
  uVar17 = 0;
  iVar12 = param_5[1];
  if (0 < param_4) {
    puVar20 = (uint *)(param_3 + 8);
    lVar22 = (lVar7 - 1U >> 2) + 1;
    do {
      puVar1 = puVar20 + -1;
      puVar2 = puVar20 + -2;
      puVar3 = puVar20 + 1;
      uVar13 = *puVar20;
      puVar20 = puVar20 + 4;
      uVar17 = uVar17 + (ulonglong)uVar13 * (ulonglong)uVar13 +
               (ulonglong)*puVar2 * (ulonglong)*puVar2 + (ulonglong)*puVar1 * (ulonglong)*puVar1 +
               (ulonglong)*puVar3 * (ulonglong)*puVar3;
      lVar22 = lVar22 + -1;
    } while (lVar22 != 0);
  }
  bVar8 = 0x1f;
  uVar14 = 0x80000000;
  uVar18 = uVar17;
  uVar10 = 0;
  if (1 < uVar17) {
    do {
      uVar17 = uVar10;
      uVar10 = (uint)((int)uVar17 * 2) + uVar14 << (bVar8 & 0x3f);
      bVar8 = bVar8 - 1;
      if (uVar10 <= uVar18) {
        uVar17 = (ulonglong)(uint)((int)uVar17 + (int)uVar14);
        uVar18 = uVar18 - uVar10;
      }
      uVar14 = uVar14 >> 1;
      uVar10 = uVar17;
    } while (uVar14 != 0);
  }
  uVar21 = 0;
  bVar8 = 0xf;
  uVar16 = 0x8000;
  uVar11 = (uint)((uVar17 & 0xffffffff) * 0x3333 >> 0x10);
  uVar13 = uVar11;
  uVar5 = uVar11;
  if (1 < uVar11) {
    do {
      uVar5 = uVar16 + uVar21 * 2 << (bVar8 & 0x1f);
      bVar8 = bVar8 - 1;
      if (uVar5 <= uVar13) {
        uVar21 = uVar21 + uVar16;
        uVar13 = uVar13 - uVar5;
      }
      uVar16 = uVar16 >> 1;
      uVar5 = uVar21;
    } while (uVar16 != 0);
  }
  if (0 < lVar7) {
    lVar22 = 0;
    do {
      uVar13 = *(uint *)(param_3 + lVar22 * 4);
      if (uVar13 < uVar11) {
        bVar8 = 0xf;
        uVar9 = 0x8000;
        uVar16 = uVar13;
        uVar21 = 0;
        if (1 < uVar13) {
          do {
            uVar6 = uVar9 + uVar21 * 2 << (bVar8 & 0x1f);
            bVar8 = bVar8 - 1;
            uVar16 = uVar21;
            if (uVar6 <= uVar13) {
              uVar16 = uVar21 + uVar9;
              uVar13 = uVar13 - uVar6;
            }
            uVar9 = uVar9 >> 1;
            uVar21 = uVar16;
          } while (uVar9 != 0);
        }
        *(short *)((longlong)local_148 + lVar22 * 2) = (short)uVar16;
      }
      else {
        *(short *)((longlong)local_148 + lVar22 * 2) = (short)uVar5;
      }
      lVar22 = lVar22 + 1;
    } while (lVar22 < lVar7);
  }
  local_158 = param_4;
  if (*param_5 == 0) {
    if (iVar12 - 9U < 2) {
      FUN_180035fd0(param_1,(longlong)local_148);
      lVar7 = param_1 + 0x20;
    }
    else {
      FUN_1800362e0(param_1,(longlong)local_148,param_2);
      lVar7 = param_1 + 0x20;
    }
  }
  else {
    if (*param_5 != 1) goto LAB_18000fd0b;
    puVar4 = (undefined8 *)(param_1 + 0x28);
    if (puVar4 != (undefined8 *)0x0) {
      *puVar4 = 0;
      *(undefined8 *)(param_1 + 0x30) = 0;
    }
    uVar13 = 0;
    psVar23 = (short *)(param_2 + 0xc);
    puVar19 = auStack332 + -param_2;
    do {
      iVar12 = 0;
      lVar7 = 4;
      psVar15 = psVar23;
      do {
        iVar12 = iVar12 + (int)*(short *)((longlong)((longlong)psVar15 + 4) + (longlong)puVar19) *
                          (int)*psVar15 +
                 (int)*(short *)((longlong)((longlong)psVar15 + -8) + (longlong)puVar19) *
                 (int)psVar15[-6] +
                 (int)*(short *)((longlong)((longlong)psVar15 + -6) + (longlong)puVar19) *
                 (int)psVar15[-5] +
                 (int)*(short *)((longlong)((longlong)psVar15 + -4) + (longlong)puVar19) *
                 (int)psVar15[-4] +
                 (int)*(short *)((longlong)((longlong)psVar15 + -2) + (longlong)puVar19) *
                 (int)psVar15[-3] +
                 (int)*(short *)((longlong)((longlong)psVar15 + 2) + (longlong)puVar19) *
                 (int)psVar15[-1] +
                 (int)*(short *)((longlong)((longlong)psVar15 + 6) + (longlong)puVar19) *
                 (int)psVar15[1] +
                 (int)*(short *)((longlong)psVar15 + (longlong)puVar19) * (int)psVar15[-2];
        lVar7 = lVar7 + -1;
        psVar15 = psVar15 + 8;
      } while (lVar7 != 0);
      if (0 < iVar12) {
        *(uint *)puVar4 = *(uint *)puVar4 | 1 << (uVar13 & 0x1f);
      }
      uVar13 = uVar13 + 1;
      psVar23 = psVar23 + 0x80;
      puVar19 = puVar19 + -0x100;
    } while ((int)uVar13 < 0x20);
    lVar7 = param_1 + 0x2c;
  }
  FUN_1800369f0(lVar7,local_148,param_4,(longlong)param_5);
LAB_18000fd0b:
  FUN_18005f100(local_48 ^ (ulonglong)auStack376);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18000fd30(void)

{
  short sVar1;
  short *psVar2;
  longlong lVar3;
  longlong lVar4;
  int iVar5;
  short *psVar6;
  longlong lVar7;

  _DAT_18010f0a0 = 0x10001;
  DAT_18010f1a0 = 1;
  iVar5 = 2;
  _DAT_18010f1a2 = 0xffff;
  do {
    lVar7 = (longlong)iVar5;
    if (0 < iVar5) {
      psVar2 = (short *)((longlong)&DAT_18010f0a0 + lVar7 * 0x100);
      lVar3 = lVar7;
      psVar6 = psVar2;
      lVar4 = lVar7;
      do {
        do {
          sVar1 = psVar2[lVar7 * -0x80];
          *psVar2 = sVar1;
          psVar2[lVar7 * -0x7f] = sVar1;
          psVar2[lVar7] = -sVar1;
          lVar3 = lVar3 + -1;
          psVar2 = psVar2 + 1;
        } while (lVar3 != 0);
        psVar2 = psVar6 + 0x80;
        lVar4 = lVar4 + -1;
        lVar3 = lVar7;
        psVar6 = psVar2;
      } while (lVar4 != 0);
    }
    iVar5 = iVar5 * 2;
  } while (iVar5 < 0x80);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18000fe00(longlong param_1,int param_2)

{
  ulonglong *puVar1;
  byte bVar2;
  uint uVar3;
  longlong lVar4;
  byte bVar5;
  byte bVar6;
  uint uVar7;
  longlong lVar8;
  uint uVar9;
  uint uVar10;
  ulonglong *puVar11;
  ulonglong uVar12;
  ulonglong uVar13;
  undefined4 local_38;
  undefined4 local_34;
  undefined8 local_30;
  undefined8 local_28;
  undefined8 local_20;
  ulonglong local_18 [2];

  local_18[0] = DAT_1800b04e8 ^ (ulonglong)&local_38;
  uVar13 = 0;
  local_38 = 0x10100;
  puVar1 = (ulonglong *)(param_1 + 0x10);
  local_34 = 0x1000001;
  local_30 = 0;
  local_28 = 0;
  lVar8 = 8;
  local_20 = 0;
  puVar11 = puVar1;
  uVar12 = uVar13;
  do {
    bVar5 = *(byte *)puVar11;
    bVar2 = *(byte *)((longlong)puVar11 + 1);
    bVar6 = (bVar2 ^ bVar5) & 0xf ^ bVar2;
    bVar5 = (bVar2 ^ bVar5) & 0xf ^ bVar5;
    lVar4 = (longlong)uVar12 >> 1;
    if (*(char *)((longlong)&local_38 + lVar4) == '\0') {
      *(byte *)((longlong)&local_30 + lVar4) = bVar6;
      *(byte *)((longlong)&local_28 + lVar4) = bVar5;
    }
    else {
      *(byte *)((longlong)&local_30 + lVar4) = bVar5;
      *(byte *)((longlong)&local_28 + lVar4) = bVar6;
    }
    uVar12 = uVar12 + 2;
    puVar11 = (ulonglong *)((longlong)puVar11 + 2);
    lVar8 = lVar8 + -1;
  } while (lVar8 != 0);
  local_20 = local_20 & 0xffffffff00000000;
  if (param_2 != 0) {
    local_20._4_4_ = (uint)(local_20 >> 0x20);
    uVar7 = 1;
    uVar9 = 0x1f;
    do {
      uVar3 = uVar7 & *(uint *)(param_1 + 0x20);
      uVar7 = uVar7 << 1 | (uint)((int)uVar7 < 0);
      bVar5 = (byte)uVar13;
      uVar13 = (ulonglong)((int)uVar13 + 1);
      uVar10 = uVar9 - 1;
      local_20._4_4_ = local_20._4_4_ + ((uVar3 >> (bVar5 & 0x1f)) << ((byte)uVar9 & 0x1f));
      uVar9 = uVar10;
    } while (uVar10 < 0x80000000);
    local_20 = (ulonglong)local_20._4_4_ << 0x20;
  }
  local_20 = local_20 | *(uint *)(param_1 + 0x20);
  if ((puVar1 != (ulonglong *)0x0) &&
     ((local_18 <= puVar1 || ((undefined8 *)(param_1 + 0x28U) <= &local_30)))) {
    *(undefined4 *)puVar1 = (undefined4)local_30;
    *(undefined4 *)(param_1 + 0x14) = local_30._4_4_;
    *(undefined4 *)(param_1 + 0x18) = (undefined4)local_28;
    *(undefined4 *)(param_1 + 0x1c) = local_28._4_4_;
    *(ulonglong *)(param_1 + 0x20) = local_20;
  }
  if (param_2 != 0) {
    *(undefined *)(param_1 + 0x30) = *(undefined *)(param_1 + 0x28);
    *(byte *)(param_1 + 0x31) = ~*(byte *)(param_1 + 0x29);
    *(byte *)(param_1 + 0x32) = ~*(byte *)(param_1 + 0x2a);
    *(undefined *)(param_1 + 0x33) = *(undefined *)(param_1 + 0x2b);
    *(undefined *)(param_1 + 0x34) = *(undefined *)(param_1 + 0x2f);
    *(undefined *)(param_1 + 0x35) = *(undefined *)(param_1 + 0x2e);
    *(undefined *)(param_1 + 0x36) = *(undefined *)(param_1 + 0x2d);
    *(undefined *)(param_1 + 0x37) = *(undefined *)(param_1 + 0x2c);
  }
  FUN_18005f100(local_18[0] ^ (ulonglong)&local_38);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18000ff90(longlong param_1)

{
  ulonglong *puVar1;
  byte bVar2;
  byte *pbVar3;
  longlong lVar4;
  longlong lVar5;
  byte bVar6;
  byte bVar7;
  longlong lVar8;
  undefined4 local_38;
  undefined4 local_34;
  undefined8 local_30;
  undefined8 local_28;
  ulonglong local_20;
  ulonglong local_18 [2];

  local_18[0] = DAT_1800b04e8 ^ (ulonglong)&local_38;
  lVar8 = 0;
  local_38 = 0x10100;
  puVar1 = (ulonglong *)(param_1 + 0x10);
  local_34 = 0x1000001;
  local_30 = 0;
  pbVar3 = (byte *)((longlong)&local_30 + 1);
  local_28 = 0;
  lVar4 = 8;
  local_20 = 0;
  do {
    lVar5 = lVar8 >> 1;
    bVar7 = *(byte *)(lVar5 + (longlong)puVar1);
    bVar2 = *(byte *)(lVar5 + 8 + (longlong)puVar1);
    bVar6 = (bVar7 ^ bVar2) & 0xf ^ bVar2;
    bVar7 = (bVar7 ^ bVar2) & 0xf ^ bVar7;
    if (*(char *)((longlong)&local_38 + lVar5) == '\0') {
      pbVar3[-1] = bVar6;
      *pbVar3 = bVar7;
    }
    else {
      pbVar3[-1] = bVar7;
      *pbVar3 = bVar6;
    }
    lVar8 = lVar8 + 2;
    pbVar3 = pbVar3 + 2;
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  local_20 = local_20 & 0xffffffff00000000 | (ulonglong)*(uint *)(param_1 + 0x20);
  if ((puVar1 != (ulonglong *)0x0) &&
     ((local_18 <= puVar1 || ((undefined8 *)(param_1 + 0x28U) <= &local_30)))) {
    *(undefined4 *)puVar1 = (undefined4)local_30;
    *(undefined4 *)(param_1 + 0x14) = local_30._4_4_;
    *(undefined4 *)(param_1 + 0x18) = (undefined4)local_28;
    *(undefined4 *)(param_1 + 0x1c) = local_28._4_4_;
    *(ulonglong *)(param_1 + 0x20) = local_20;
  }
  FUN_18005f100(local_18[0] ^ (ulonglong)&local_38);
  return;
}



void FUN_180010090(longlong param_1,int param_2,int param_3,int param_4,undefined8 param_5,
                  undefined8 param_6,longlong param_7,int *param_8)

{
  longlong lVar1;
  undefined8 local_310;
  undefined4 *local_308;
  int local_2f8;
  int local_2f4;
  int local_2f0;
  int local_2ec;
  longlong local_2e8;
  undefined4 local_2d8;
  undefined4 uStack724;
  undefined4 uStack720;
  undefined4 uStack716;
  undefined4 local_2c8;
  undefined4 uStack708;
  undefined4 uStack704;
  undefined4 uStack700;
  undefined4 local_2b8;
  undefined4 uStack692;
  undefined4 uStack688;
  undefined4 uStack684;
  undefined4 local_2a8;
  undefined4 uStack676;
  undefined4 uStack672;
  undefined4 uStack668;
  undefined4 local_298;
  undefined4 uStack660;
  undefined4 uStack656;
  undefined4 uStack652;
  undefined4 local_288;
  undefined4 uStack644;
  undefined4 uStack640;
  undefined4 uStack636;
  undefined4 local_278;
  undefined4 uStack628;
  undefined4 uStack624;
  undefined4 uStack620;
  undefined4 local_268;
  undefined4 uStack612;
  undefined4 uStack608;
  undefined4 uStack604;
  undefined4 local_258 [40];
  undefined4 local_1b8;
  undefined4 uStack436;
  undefined4 uStack432;
  undefined4 uStack428;
  undefined4 local_1a8;
  undefined4 uStack420;
  undefined4 uStack416;
  undefined4 uStack412;
  undefined4 local_198;
  undefined4 uStack404;
  undefined4 uStack400;
  undefined4 uStack396;
  undefined4 local_188;
  undefined4 uStack388;
  undefined4 uStack384;
  undefined4 uStack380;
  undefined4 local_178 [16];
  undefined4 local_138;
  undefined4 uStack308;
  undefined4 uStack304;
  undefined4 uStack300;
  undefined4 local_128;
  undefined4 uStack292;
  undefined4 uStack288;
  undefined4 uStack284;
  undefined4 local_118;
  undefined4 uStack276;
  undefined4 uStack272;
  undefined4 uStack268;
  undefined4 local_108;
  undefined4 uStack260;
  undefined4 uStack256;
  undefined4 uStack252;
  undefined4 local_f8 [40];
  ulonglong local_58;

  local_58 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffcc8;
  local_2e8 = param_7;
  memset(local_258,0,0x200);
  memset(&local_2d8,0,0x80);
  local_2f4 = *param_8;
  local_2f0 = param_8[6];
  local_2ec = param_8[7];
  local_308 = local_258;
  local_310 = param_6;
  local_2f8 = 0;
  FUN_18000f400(param_2,param_3,param_4,*(short *)(param_1 + 6));
  lVar1 = local_2e8;
  FUN_18000fa50(param_1,local_2e8,(longlong)local_258,0x80,&local_2f8);
  if (1 < *param_8 - 9U) {
    local_2f0 = param_8[8];
    local_2ec = param_8[9];
    local_2f8 = 1;
    if ((&local_198 <= &local_2d8) || (&local_2b8 <= &local_1b8)) {
      local_2d8 = local_1b8;
      uStack724 = uStack436;
      uStack720 = uStack432;
      uStack716 = uStack428;
      local_2c8 = local_1a8;
      uStack708 = uStack420;
      uStack704 = uStack416;
      uStack700 = uStack412;
    }
    if ((local_178 <= &local_2b8) || (&local_298 <= &local_198)) {
      local_2b8 = local_198;
      uStack692 = uStack404;
      uStack688 = uStack400;
      uStack684 = uStack396;
      local_2a8 = local_188;
      uStack676 = uStack388;
      uStack672 = uStack384;
      uStack668 = uStack380;
    }
    if ((&local_118 <= &local_298) || (&local_278 <= &local_138)) {
      local_298 = local_138;
      uStack660 = uStack308;
      uStack656 = uStack304;
      uStack652 = uStack300;
      local_288 = local_128;
      uStack644 = uStack292;
      uStack640 = uStack288;
      uStack636 = uStack284;
    }
    if ((local_f8 <= &local_278) || (local_258 <= &local_118)) {
      local_278 = local_118;
      uStack628 = uStack276;
      uStack624 = uStack272;
      uStack620 = uStack268;
      local_268 = local_108;
      uStack612 = uStack260;
      uStack608 = uStack256;
      uStack604 = uStack252;
    }
    FUN_18000fa50(param_1,lVar1,(longlong)&local_2d8,0x20,&local_2f8);
  }
  FUN_18005f100(local_58 ^ (ulonglong)&stack0xfffffffffffffcc8);
  return;
}



void FUN_1800102c0(byte *param_1,int *param_2,undefined param_3,undefined param_4,undefined param_5,
                  uint *param_6,int *param_7,longlong param_8,int param_9,int param_10)

{
  uint uVar1;
  bool bVar2;
  int iVar3;
  short sVar4;
  uint uVar5;
  uint uVar6;
  ulonglong uVar7;
  short sVar8;
  longlong lVar9;
  int *piVar10;
  int iVar11;
  int iVar12;
  undefined2 *puVar13;
  uint uVar14;
  int *piVar15;
  undefined auStack296 [32];
  int *local_108;
  uint *local_100;
  int *local_f8;
  uint local_f0;
  int local_e8;
  uint local_e4;
  uint local_e0;
  uint *local_d8;
  uint local_c8 [36];
  ulonglong local_38;

  local_38 = DAT_1800b04e8 ^ (ulonglong)auStack296;
  local_d8 = param_6;
  uVar7 = SEXT48((int)*param_6);
  local_e4 = (uint)param_1[*param_7] + (uint)param_1[-(longlong)*param_7] + (uint)param_1[-1] +
             (uint)param_1[1] + (uint)*param_1;
  memset(local_c8,0,0x90);
  uVar14 = 0;
  bVar2 = param_10 - 9U < 2;
  local_f0 = bVar2 ^ 1;
  local_f8 = &local_e8;
  local_100 = local_c8;
  local_108 = param_7;
  local_e0 = FUN_18000ee70(*param_2,param_2[1],param_2[5],param_8);
  if (bVar2) {
    uVar14 = (uint)((ulonglong)local_e0 * 0xcccd + 0x8000 >> 0x10);
  }
  iVar12 = 0;
  puVar13 = (undefined2 *)(&DAT_180106d64 + uVar7 * 0x38);
  piVar10 = (int *)((longlong)&DAT_18011f584 + uVar7 * 0x18);
  piVar15 = (int *)((longlong)&DAT_180122dc0 + uVar7 * 8);
  do {
    iVar3 = 0x23;
    iVar11 = iVar12;
    if (!bVar2) {
      iVar11 = local_e8;
    }
    if (iVar11 != 0) {
      iVar3 = iVar11 + -1;
    }
    uVar1 = local_c8[iVar11];
    iVar12 = iVar11 + 1;
    uVar6 = local_c8[iVar3];
    if ((((uVar6 < uVar1) && (local_c8[iVar12 % 0x24] <= uVar1 && uVar1 != local_c8[iVar12 % 0x24]))
        && (uVar14 <= uVar1)) || (!bVar2)) {
      lVar9 = ((ulonglong)(local_c8[iVar12 % 0x24] * 2) - (ulonglong)(uVar1 * 4)) +
              (ulonglong)(uVar6 * 2);
      sVar4 = 0x4800;
      sVar8 = (short)((longlong)
                      (((ulonglong)uVar6 - (ulonglong)local_c8[iVar12 % 0x24]) * 0x200 -
                      (lVar9 >> 1)) / lVar9) + (short)iVar11 * 0x200;
      if (sVar8 < 0) {
LAB_1800104af:
        sVar8 = sVar8 + sVar4;
      }
      else {
        if (0x47ff < sVar8) {
          sVar4 = -0x4800;
          goto LAB_1800104af;
        }
      }
      uVar6 = param_2[3];
      uVar5 = (int)uVar6 >> 0x1f;
      piVar15[1] = (int)uVar7;
      *piVar15 = -((uVar6 ^ uVar5) - uVar5);
      puVar13[-1] = *(undefined2 *)(param_2 + 4);
      *puVar13 = *(undefined2 *)((longlong)param_2 + 0x12);
      sVar8 = (short)((sVar8 * 0x6488) / 0x24 >> 9);
      sVar4 = sVar8 + -0x3244;
      puVar13[1] = sVar4;
      if ((!bVar2) && (sVar4 < 0)) {
        puVar13[1] = sVar8;
      }
      puVar13[-2] = (ushort)(0x27f < local_e4);
      *(int *)(puVar13 + 2) = *piVar15;
      piVar10[-1] = *param_2;
      *piVar10 = param_2[1];
      piVar10[1] = param_2[5];
      piVar10[2] = local_e0;
      piVar10[3] = uVar1;
      uVar6 = (int)uVar7 + 1;
      uVar7 = (ulonglong)uVar6;
      *(ushort *)(piVar10 + 4) = (ushort)(uVar1 != local_e0);
      piVar15 = piVar15 + 2;
      piVar10 = piVar10 + 6;
      puVar13 = puVar13 + 0x1c;
      if ((param_9 <= (int)uVar6) || (!bVar2)) break;
    }
    uVar6 = (uint)uVar7;
  } while (iVar12 < 0x24);
  *local_d8 = uVar6;
  FUN_18005f100(local_38 ^ (ulonglong)auStack296);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_1800105c0(int *param_1,undefined param_2,undefined param_3,undefined param_4,uint *param_5,
                  longlong param_6,undefined4 param_7,undefined8 param_8,undefined8 param_9,
                  int param_10,int param_11,int param_12)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined8 uVar5;
  ulonglong uVar6;
  longlong lVar7;
  int iVar8;
  int *piVar9;
  int iVar10;
  ulonglong uVar11;
  undefined4 *puVar12;
  ulonglong uVar13;
  undefined uVar14;
  undefined7 in_register_00000089;
  ulonglong uVar15;
  int iVar16;
  ulonglong local_res18;
  undefined8 local_res20;
  int in_stack_ffffffffffffff58;
  undefined4 in_stack_ffffffffffffff5c;
  int *local_70;
  int local_68;
  int local_64;
  int local_60;
  uint local_5c;
  short local_58;
  short sStack86;
  undefined4 uStack84;

  iVar2 = param_12;
  iVar4 = param_1[1];
  uVar11 = 0;
  iVar1 = *param_1;
  iVar16 = 1;
  local_res20._4_4_ = (uint)((uint7)in_register_00000089 >> 0x18);
  local_res20 = (ulonglong)local_res20._4_4_ << 0x20;
  local_res18 = 0;
  iVar8 = 6;
  if (1 < param_12 - 9U) {
    iVar8 = 3;
  }
  uVar6 = uVar11;
  lVar7 = param_6;
  uVar13 = uVar11;
  uVar15 = uVar11;
  param_12 = iVar8;
  do {
    iVar10 = 6;
    if (6 < iVar4 + -6) {
      do {
        iVar8 = 6;
        if (6 < iVar1 + -6) {
          local_70 = (int *)((longlong)&DAT_18011bd40 + uVar15 * 0x18);
          do {
            uVar5 = FUN_18000dce0(lVar7,iVar8,iVar10,iVar16,
                                  CONCAT44(in_stack_ffffffffffffff5c,in_stack_ffffffffffffff58),
                                  &local_5c);
            uVar13 = local_res18;
            if ((int)uVar5 == 0) {
              uVar6 = local_res20 & 0xffffffff;
            }
            else {
              uVar14 = (undefined)param_10;
              puVar12 = &param_7;
              param_7 = 0;
              uStack84 = 0;
              in_stack_ffffffffffffff58 = iVar2;
              local_68 = iVar8;
              local_64 = iVar10;
              local_60 = iVar16;
              iVar3 = FUN_18000e840(lVar7,&local_68,puVar12,param_10,iVar2);
              if (iVar3 == 0) {
                if ((1 < iVar2 - 9U) && ((longlong)uVar15 < 600)) {
                  local_58 = (short)iVar8 << 8;
                  sStack86 = (short)iVar10 << 8;
                  local_68 = iVar8;
                  local_64 = iVar10;
                  local_60 = iVar16;
                  uVar6 = FUN_1800354d0((iVar16 << 0x10) / param_12);
                  uVar15 = uVar15 + 1;
                  local_res18._0_4_ = (uint)local_res18 + 1;
                  uStack84 = (undefined4)((uVar6 & 0xffffffff) * 0x13333 >> 0x10);
                  *local_70 = local_68;
                  local_70[1] = local_64;
                  local_70[2] = local_60;
                  local_70[3] = local_5c;
                  local_res18 = (ulonglong)(uint)local_res18;
                  *(ulonglong *)(local_70 + 4) = CONCAT44(uStack84,CONCAT22(sStack86,local_58));
                  local_70 = local_70 + 6;
                }
              }
              else {
                lVar7 = (longlong)(local_64 * iVar1 + local_68);
                if ((&DAT_1801170a0)[lVar7] != '\0') {
                  uVar6 = local_res20 & 0xffffffff;
                  lVar7 = param_6;
                  goto LAB_180010812;
                }
                FUN_1800102c0((byte *)(lVar7 + *(longlong *)(param_1 + 6)),&local_68,(char)puVar12,
                              uVar14,(char)in_stack_ffffffffffffff58,&local_res20,param_8,param_9,
                              param_11,iVar2);
                (&DAT_1801170a0)[lVar7] = 1;
                lVar7 = param_6;
                if (param_11 <= (int)(uint)local_res20) goto LAB_180010915;
              }
              uVar6 = (ulonglong)(uint)local_res20;
              uVar13 = (ulonglong)(uint)local_res18;
            }
LAB_180010812:
            iVar8 = iVar8 + 1;
          } while (iVar8 < iVar1 + -6);
        }
        iVar10 = iVar10 + 1;
        iVar8 = param_12;
      } while (iVar10 < iVar4 + -6);
    }
    local_res20._0_4_ = (uint)uVar6;
    iVar16 = iVar16 + 1;
  } while (iVar16 <= iVar8);
  if ((((1 < iVar2 - 9U) &&
       (iVar8 = iVar1 * 2, iVar8 != iVar4 * 5 && SBORROW4(iVar8,iVar4 * 5) == iVar8 + iVar4 * -5 < 0
       )) && ((int)(uint)local_res20 < 0x78)) && (0 < (int)uVar13)) {
    piVar9 = &DAT_18011bd40;
    uVar15 = uVar11;
    do {
      local_res20._0_4_ = (uint)uVar6;
      if (0x77 < (int)(uint)local_res20) break;
      iVar4 = piVar9[1] * iVar1 + *piVar9;
      lVar7 = (longlong)iVar4;
      if ((&DAT_1801170a0)[lVar7] == '\0') {
        FUN_1800102c0((byte *)(*(longlong *)(param_1 + 6) + lVar7),
                      (int *)((longlong)&DAT_18011bd40 + (longlong)(int)uVar15 * 0x18),(char)iVar4,
                      0x40,(char)in_stack_ffffffffffffff58,&local_res20,param_8,param_9,param_11,
                      iVar2);
        uVar6 = local_res20 & 0xffffffff;
        (&DAT_1801170a0)[lVar7] = 1;
      }
      local_res20._0_4_ = (uint)uVar6;
      uVar15 = (ulonglong)((int)uVar15 + 1);
      uVar11 = uVar11 + 1;
      piVar9 = piVar9 + 6;
    } while ((longlong)uVar11 < (longlong)(int)uVar13);
  }
LAB_180010915:
  *param_5 = (uint)local_res20;
  return;
}



void FUN_180010930(undefined8 param_1,short *param_2,undefined8 param_3,undefined *param_4)

{
  int iVar1;
  undefined8 uVar2;
  longlong lVar3;
  ulonglong uVar4;
  short *psVar5;
  undefined *puVar6;
  undefined *puVar7;
  ulonglong uVar8;
  int *piVar9;
  undefined8 *puVar10;
  int iVar11;
  undefined8 unaff_RBX;
  ulonglong uVar12;
  undefined8 unaff_RSI;
  uint uVar13;
  int *piVar14;
  longlong lVar15;
  short *psVar16;
  int iVar17;
  longlong lVar18;
  ulonglong uVar19;
  short sVar20;
  undefined8 unaff_R14;
  ulonglong uVar21;
  undefined8 uStack48;

  uStack48 = 0x180010943;
  lVar3 = _alloca_probe();
  lVar3 = -lVar3;
  *(ulonglong *)(&stack0x000012a8 + lVar3) =
       DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffd8 + lVar3);
  iVar11 = *(int *)(&stack0x00001328 + lVar3);
  uVar4 = 0;
  iVar1 = *(int *)(&stack0x00001330 + lVar3);
  if (iVar1 < iVar11) {
    *(undefined8 *)(&stack0x000012f8 + lVar3) = unaff_RBX;
    *(undefined8 *)(&stack0x000012c0 + lVar3) = unaff_RSI;
    *(undefined8 *)(&stack0x000012b8 + lVar3) = unaff_R14;
    if (0 < iVar11) {
      piVar9 = (int *)(&stack0xffffffffffffffec + lVar3);
      piVar14 = &DAT_180106d68;
      uVar8 = uVar4;
      do {
        iVar17 = *piVar14;
        piVar14 = piVar14 + 0xe;
        *piVar9 = (int)uVar8;
        uVar13 = (int)uVar8 + 1;
        uVar8 = (ulonglong)uVar13;
        piVar9[-1] = iVar17;
        piVar9 = piVar9 + 2;
      } while ((int)uVar13 < iVar11);
    }
    if (1 < iVar11) {
      lVar18 = 1;
      uVar8 = (ulonglong)(iVar11 - 1);
      do {
        uVar2 = *(undefined8 *)(&stack0xffffffffffffffe8 + lVar18 * 8 + lVar3);
        *(undefined8 *)(&stack0xffffffffffffffd8 + lVar3) = uVar2;
        lVar15 = lVar18;
        if (0 < lVar18) {
          iVar17 = *(int *)(&stack0xffffffffffffffdc + lVar3);
          puVar10 = (undefined8 *)(&stack0xffffffffffffffe0 + lVar18 * 8 + lVar3);
          do {
            if ((*(int *)puVar10 <= (int)uVar2) &&
               ((*(int *)puVar10 != (int)uVar2 ||
                (*(int *)((longlong)puVar10 + 4) == iVar17 ||
                 *(int *)((longlong)puVar10 + 4) < iVar17)))) break;
            lVar15 = lVar15 + -1;
            puVar10[1] = *puVar10;
            puVar10 = puVar10 + -1;
          } while (0 < lVar15);
        }
        lVar18 = lVar18 + 1;
        *(undefined8 *)(&stack0xffffffffffffffe8 + lVar15 * 8 + lVar3) = uVar2;
        uVar8 = uVar8 - 1;
      } while (uVar8 != 0);
    }
    uVar8 = uVar4;
    uVar21 = uVar4;
    if (0 < iVar1) {
      piVar14 = (int *)(&stack0xffffffffffffffec + lVar3);
      uVar19 = uVar4;
      do {
        iVar17 = (int)uVar19;
        if (iVar11 <= iVar17) break;
        lVar18 = (longlong)*(int *)(&stack0xffffffffffffffec + (longlong)iVar17 * 8 + lVar3);
        if (*(short *)(&DAT_18011f594 + lVar18 * 0x18) == 0) {
          psVar5 = (short *)(&DAT_180106d60 + lVar18 * 0x38);
          if (((param_2 != (short *)0x0) && (psVar5 != (short *)0x0)) &&
             (((short *)(lVar18 * 0x38 + 0x180106d98) <= param_2 || (param_2 + 0x1c <= psVar5)))) {
            lVar15 = 0x1c;
            psVar16 = (short *)((longlong)param_2 - (longlong)psVar5);
            do {
              *(undefined *)((longlong)psVar16 + (longlong)psVar5) = *(undefined *)psVar5;
              ((undefined *)((longlong)psVar16 + 1))[(longlong)psVar5] =
                   *(undefined *)((longlong)psVar5 + 1);
              psVar5 = psVar5 + 1;
              lVar15 = lVar15 + -1;
            } while (lVar15 != 0);
          }
          puVar7 = (undefined *)((longlong)&DAT_18011f580 + lVar18 * 0x18);
          *param_2 = *param_2 + (short)uVar8 * 4;
          param_2 = param_2 + 0x1c;
          if (((param_4 != (undefined *)0x0) && (puVar7 != (undefined *)0x0)) &&
             (((undefined *)((longlong)&DAT_18011f598 + lVar18 * 0x18) <= param_4 ||
              (param_4 + 0x18 <= puVar7)))) {
            lVar18 = 0x18;
            puVar6 = param_4;
            do {
              *puVar6 = (puVar7 + -(longlong)param_4)[(longlong)puVar6];
              puVar6 = puVar6 + 1;
              lVar18 = lVar18 + -1;
            } while (lVar18 != 0);
          }
          param_4 = param_4 + 0x18;
          uVar8 = (ulonglong)((int)uVar8 + 1);
        }
        else {
          uVar21 = (ulonglong)((int)uVar21 + 1);
          *piVar14 = *(int *)(&stack0xffffffffffffffec + (longlong)iVar17 * 8 + lVar3);
          piVar14 = piVar14 + 2;
        }
        uVar19 = (ulonglong)(iVar17 + 1);
      } while ((int)uVar8 < iVar1);
    }
    do {
      uVar12 = 0;
      uVar19 = uVar12;
      if ((int)uVar8 < *(int *)(&stack0x00001330 + lVar3)) {
        piVar14 = (int *)(&stack0xffffffffffffffec + lVar3);
        do {
          iVar11 = (int)uVar12;
          if ((int)uVar21 <= iVar11) break;
          lVar18 = (longlong)*(int *)(&stack0xffffffffffffffec + (longlong)iVar11 * 8 + lVar3);
          if (*(uint *)(&DAT_18011f590 + lVar18 * 0x18) <
              (uint)((ulonglong)*(uint *)(&DAT_18011f58c + lVar18 * 0x18) *
                     (longlong)*(int *)(*(longlong *)(&stack0x00001318 + lVar3) + uVar4 * 4) +
                     0x8000 >> 0x10)) {
            uVar19 = (ulonglong)((int)uVar19 + 1);
            *piVar14 = *(int *)(&stack0xffffffffffffffec + (longlong)iVar11 * 8 + lVar3);
            piVar14 = piVar14 + 2;
          }
          else {
            psVar5 = (short *)(&DAT_180106d60 + lVar18 * 0x38);
            if (((param_2 != (short *)0x0) && (psVar5 != (short *)0x0)) &&
               (((short *)(lVar18 * 0x38 + 0x180106d98) <= param_2 || (param_2 + 0x1c <= psVar5))))
            {
              lVar15 = 0x1c;
              psVar16 = (short *)((longlong)param_2 - (longlong)psVar5);
              do {
                *(undefined *)((longlong)psVar16 + (longlong)psVar5) = *(undefined *)psVar5;
                ((undefined *)((longlong)psVar16 + 1))[(longlong)psVar5] =
                     *(undefined *)((longlong)psVar5 + 1);
                psVar5 = psVar5 + 1;
                lVar15 = lVar15 + -1;
              } while (lVar15 != 0);
            }
            *param_2 = *param_2 + (short)uVar8 * 4;
            param_2 = param_2 + 0x1c;
            if ((param_4 != (undefined *)0x0) &&
               (((undefined *)((longlong)&DAT_18011f598 + lVar18 * 0x18) <= param_4 ||
                (param_4 + 0x18 <= (undefined *)((longlong)&DAT_18011f580 + lVar18 * 0x18))))) {
              lVar15 = 0x18;
              puVar7 = param_4;
              do {
                *puVar7 = ((undefined *)((longlong)&DAT_18011f580 + lVar18 * 0x18) +
                          -(longlong)param_4)[(longlong)puVar7];
                puVar7 = puVar7 + 1;
                lVar15 = lVar15 + -1;
              } while (lVar15 != 0);
            }
            param_4 = param_4 + 0x18;
            uVar8 = (ulonglong)((int)uVar8 + 1);
          }
          uVar12 = (ulonglong)(iVar11 + 1);
        } while ((int)uVar8 < *(int *)(&stack0x00001330 + lVar3));
      }
      uVar4 = uVar4 + 1;
      uVar21 = uVar19;
    } while ((longlong)uVar4 < 2);
  }
  else {
    uVar13 = iVar11 * 0x38;
    uVar8 = (ulonglong)uVar13;
    if (((param_2 != (short *)0x0) && (uVar13 != 0)) &&
       (((&DAT_180106d60 + uVar8 <= param_2 ||
         ((undefined *)(uVar8 + (longlong)param_2) < &DAT_180106d61)) && (uVar13 != 0)))) {
      psVar5 = param_2;
      do {
        *(undefined *)psVar5 = (&DAT_180106d60 + -(longlong)param_2)[(longlong)psVar5];
        psVar5 = (short *)((longlong)psVar5 + 1);
        uVar8 = uVar8 - 1;
      } while (uVar8 != 0);
    }
    if (0 < iVar11) {
      do {
        sVar20 = (short)uVar4;
        uVar13 = (int)uVar4 + 1;
        uVar4 = (ulonglong)uVar13;
        *param_2 = *param_2 + sVar20 * 4;
        param_2 = param_2 + 0x1c;
      } while ((int)uVar13 < iVar11);
    }
    uVar13 = iVar11 * 0x18;
    uVar4 = (ulonglong)uVar13;
    if ((((param_4 != (undefined *)0x0) && (uVar13 != 0)) &&
        (((undefined *)((longlong)&DAT_18011f580 + uVar4) <= param_4 ||
         (param_4 + uVar4 < (undefined *)0x18011f581)))) && (uVar13 != 0)) {
      lVar18 = -(longlong)param_4;
      do {
        *param_4 = param_4[(longlong)((longlong)&DAT_18011f580 + lVar18)];
        param_4 = param_4 + 1;
        uVar4 = uVar4 - 1;
      } while (uVar4 != 0);
    }
  }
  *(undefined8 *)((longlong)&uStack48 + lVar3) = 0x180010d6b;
  FUN_18005f100(*(ulonglong *)(&stack0x000012a8 + lVar3) ^
                (ulonglong)(&stack0xffffffffffffffd8 + lVar3),
                *(undefined *)((longlong)&uStack48 + lVar3));
  return;
}



// WARNING: Could not reconcile some variable overlaps
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180010dc0(int *param_1,int *param_2,undefined8 param_3,uint *param_4,int *param_5)

{
  byte bVar1;
  short sVar2;
  int iVar3;
  ulonglong *puVar4;
  uint *puVar5;
  longlong lVar6;
  ulonglong **ppuVar7;
  ulonglong *puVar8;
  int *piVar9;
  int *piVar10;
  short *psVar11;
  ushort uVar12;
  uint uVar13;
  undefined4 uVar14;
  byte *pbVar15;
  ulonglong uVar16;
  undefined *puVar17;
  int *piVar18;
  undefined8 *puVar19;
  undefined2 *puVar20;
  ushort *puVar21;
  longlong lVar22;
  int iVar23;
  int *piVar24;
  ushort uVar25;
  int iVar26;
  int *piVar27;
  longlong lVar28;
  ulonglong **ppuVar29;
  short *psVar30;
  int iVar31;
  void *_Memory;
  longlong lVar32;
  int aiStackX8 [8];
  int local_3958;
  int *local_3950;
  uint local_3948;
  int local_3944;
  int local_3940;
  int *local_3938;
  ulonglong **local_3930;
  ulonglong *local_3928;
  uint local_3920;
  int local_391c;
  int local_3918;
  int local_3914;
  int local_3910;
  int *local_3908;
  int *local_3900;
  undefined8 local_38f8;
  undefined4 local_38f0;
  undefined4 uStack14572;
  undefined4 local_38e8;
  undefined4 uStack14564;
  undefined4 local_38e0;
  undefined4 uStack14556;
  undefined4 local_38d8;
  undefined4 uStack14548;
  undefined4 local_38d0;
  undefined4 uStack14540;
  int *local_38c8;
  longlong local_38c0;
  undefined8 local_38b8;
  ulonglong *local_38b0;
  int *local_38a8;
  undefined8 local_3898 [1800];
  ulonglong local_58 [2];
  undefined8 uStack72;

  uStack72 = 0x180010ddf;
  lVar6 = _alloca_probe();
  lVar6 = -lVar6;
  local_58[0] = DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffc0 + lVar6);
  local_3908 = param_1;
  local_38c8 = param_5;
  local_38f8 = param_4;
  *(undefined8 *)(&stack0x00000030 + lVar6) = param_3;
  local_3958 = param_5[1];
  local_3918 = param_5[3];
  local_391c = param_5[2];
  local_3914 = param_5[4];
  iVar31 = *param_5;
  local_3910 = param_5[5];
  *(int *)((longlong)aiStackX8 + lVar6 + 0x18) = iVar31;
  local_3938 = param_2;
  if (iVar31 - 9U < 2) {
    lVar32 = 9;
    uVar13 = 0x48;
  }
  else {
    lVar32 = 6;
    uVar13 = 0x30;
  }
  local_38c0 = lVar32;
  *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x180010e5e;
  ppuVar7 = (ulonglong **)malloc((ulonglong)uVar13,*(undefined *)((longlong)&uStack72 + lVar6));
  local_3930 = ppuVar7;
  lVar22 = 0;
  do {
    iVar31 = *param_2;
    iVar23 = param_2[1];
    iVar26 = iVar31 * iVar23 * 2;
    *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x180010e8d;
    puVar8 = (ulonglong *)
             malloc((longlong)iVar26 + 0x20,*(undefined *)((longlong)&uStack72 + lVar6));
    piVar24 = local_3908;
    if (puVar8 != (ulonglong *)0x0) {
      *(int *)((longlong)puVar8 + 4) = iVar23;
      *(int *)(puVar8 + 2) = 2;
      *(int *)((longlong)puVar8 + 0xc) = iVar26;
      *(int *)puVar8 = iVar31;
      *(int *)(puVar8 + 1) = iVar31 * 2;
      puVar8[3] = (ulonglong)(puVar8 + 4);
    }
    ppuVar7[lVar22] = puVar8;
    lVar22 = lVar22 + 1;
  } while (lVar22 < lVar32);
  iVar31 = *local_3908;
  iVar23 = local_3908[1];
  iVar26 = iVar31 * iVar23 * 2;
  *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x180010ee9;
  local_3928 = (ulonglong *)
               malloc((longlong)iVar26 + 0x20,*(undefined *)((longlong)&uStack72 + lVar6));
  if (local_3928 == (ulonglong *)0x0) {
  }
  else {
    *(int *)((longlong)local_3928 + 0xc) = iVar26;
    *(int *)local_3928 = iVar31;
    *(int *)((longlong)local_3928 + 4) = iVar23;
    *(int *)(local_3928 + 2) = 2;
    *(int *)(local_3928 + 1) = iVar31 * 2;
    local_3928[3] = (ulonglong)(local_3928 + 4);
  }
  iVar31 = *piVar24;
  iVar23 = piVar24[1];
  local_38b0 = local_3928;
  iVar26 = iVar31 * iVar23 * 2;
  *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x180010f36;
  local_3928 = local_38b0;
  local_3900 = (int *)malloc((longlong)iVar26 + 0x20,*(undefined *)((longlong)&uStack72 + lVar6));
  if (local_3900 == (int *)0x0) {
  }
  else {
    local_3900[3] = iVar26;
    *local_3900 = iVar31;
    local_3900[1] = iVar23;
    local_3900[4] = 2;
    local_3900[2] = iVar31 * 2;
    *(int **)(local_3900 + 6) = local_3900 + 8;
  }
  iVar31 = *piVar24;
  iVar23 = piVar24[1];
  local_38a8 = local_3900;
  iVar26 = iVar31 * iVar23 * 4;
  *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x180010f84;
  local_3900 = local_38a8;
  piVar9 = (int *)malloc((longlong)iVar26 + 0x20,*(undefined *)((longlong)&uStack72 + lVar6));
  ppuVar7 = local_3930;
  if (piVar9 != (int *)0x0) {
    piVar9[3] = iVar26;
    *piVar9 = iVar31;
    piVar9[1] = iVar23;
    piVar9[4] = 4;
    piVar9[2] = iVar31 * 4;
    *(int **)(piVar9 + 6) = piVar9 + 8;
  }
  iVar31 = *(int *)*local_3930;
  iVar23 = *(int *)((longlong)*local_3930 + 4);
  iVar26 = iVar31 * iVar23 * 4;
  *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x180010fd9;
  piVar10 = (int *)malloc((longlong)iVar26 + 0x20,*(undefined *)((longlong)&uStack72 + lVar6));
  *(int **)((longlong)&param_5 + lVar6) = piVar10;
  if (piVar10 == (int *)0x0) {
    *(int **)((longlong)&param_5 + lVar6) = (int *)0x0;
  }
  else {
    piVar10[3] = iVar26;
    *piVar10 = iVar31;
    piVar10[1] = iVar23;
    piVar10[4] = 4;
    piVar10[2] = iVar31 * 4;
    *(int **)(piVar10 + 6) = piVar10 + 8;
  }
  iVar31 = *(int *)*ppuVar7;
  iVar23 = *(int *)((longlong)*ppuVar7 + 4);
  iVar26 = iVar31 * iVar23 * 2;
  *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x18001102a;
  piVar10 = (int *)malloc((longlong)iVar26 + 0x20,*(undefined *)((longlong)&uStack72 + lVar6));
  *(int **)(&stack0x00000038 + lVar6) = piVar10;
  if (piVar10 == (int *)0x0) {
    *(undefined8 *)(&stack0x00000038 + lVar6) = 0;
  }
  else {
    piVar10[3] = iVar26;
    *piVar10 = iVar31;
    piVar10[1] = iVar23;
    piVar10[4] = 2;
    piVar10[2] = iVar31 * 2;
    *(int **)(piVar10 + 6) = piVar10 + 8;
  }
  iVar31 = 0;
  local_3950 = piVar9;
  while( true ) {
    ppuVar7 = local_3930;
    iVar26 = 0;
    iVar23 = 1;
    pbVar15 = *(byte **)(param_2 + 6);
    local_3940 = iVar31;
    puVar8 = *local_3930;
    psVar11 = (short *)puVar8[3];
    if (0 < param_2[3]) {
      do {
        bVar1 = *pbVar15;
        pbVar15 = pbVar15 + 1;
        *psVar11 = (ushort)bVar1 << 8;
        iVar26 = iVar26 + 1;
        psVar11 = psVar11 + 1;
      } while (iVar26 < param_2[3]);
    }
    if (*(int *)((longlong)aiStackX8 + lVar6 + 0x18) - 9U < 2) {
      local_38e0 = 0xffffffff;
      uStack14556 = 0xffffffff;
      *(undefined4 *)(&stack0xffffffffffffffe8 + lVar6) = 0xffffffff;
      *(undefined4 *)(&stack0xffffffffffffffe0 + lVar6) = 0xffffffff;
      *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x180011142;
      FUN_1800395b0(puVar8,(int *)puVar8,0xffffffffffffffff,200,
                    *(int *)(&stack0xffffffffffffffe0 + lVar6),
                    *(int *)(&stack0xffffffffffffffe8 + lVar6));
      local_38d8 = 0xffffffff;
      uStack14548 = 0xffffffff;
      do {
        puVar8 = *ppuVar7;
        ppuVar7 = ppuVar7 + 1;
        puVar4 = *ppuVar7;
        *(undefined4 *)(&stack0xffffffffffffffe8 + lVar6) = 0xffffffff;
        *(undefined4 *)(&stack0xffffffffffffffe0 + lVar6) = 0xffffffff;
        *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x180011173;
        FUN_1800395b0(puVar8,(int *)puVar4,0xffffffffffffffff,iVar23 + 200,
                      *(int *)(&stack0xffffffffffffffe0 + lVar6),
                      *(int *)(&stack0xffffffffffffffe8 + lVar6));
        iVar23 = iVar23 + 1;
        piVar9 = local_3950;
      } while (iVar23 < 9);
    }
    else {
      local_38f0 = 0xffffffff;
      uStack14572 = 0xffffffff;
      *(undefined4 *)(&stack0xffffffffffffffe8 + lVar6) = 0xffffffff;
      *(undefined4 *)(&stack0xffffffffffffffe0 + lVar6) = 0xffffffff;
      *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x1800110df;
      FUN_1800395b0(puVar8,(int *)puVar8,0xffffffffffffffff,iVar31,
                    *(int *)(&stack0xffffffffffffffe0 + lVar6),
                    *(int *)(&stack0xffffffffffffffe8 + lVar6));
      local_38e8 = 0xffffffff;
      uStack14564 = 0xffffffff;
      do {
        puVar8 = *ppuVar7;
        ppuVar7 = ppuVar7 + 1;
        puVar4 = *ppuVar7;
        *(undefined4 *)(&stack0xffffffffffffffe8 + lVar6) = 0xffffffff;
        *(undefined4 *)(&stack0xffffffffffffffe0 + lVar6) = 0xffffffff;
        *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x180011110;
        FUN_1800395b0(puVar8,(int *)puVar4,0xffffffffffffffff,iVar23 + iVar31,
                      *(int *)(&stack0xffffffffffffffe0 + lVar6),
                      *(int *)(&stack0xffffffffffffffe8 + lVar6));
        iVar23 = iVar23 + 1;
        piVar24 = local_3908;
      } while (iVar23 < 6);
    }
    puVar8 = local_3928;
    iVar23 = 0;
    pbVar15 = *(byte **)(piVar24 + 6);
    psVar11 = (short *)local_3928[3];
    if (*(int *)((longlong)aiStackX8 + lVar6 + 0x18) - 9U < 2) {
      if (0 < piVar24[3]) {
        do {
          bVar1 = *pbVar15;
          pbVar15 = pbVar15 + 1;
          *psVar11 = (ushort)bVar1 << 8;
          iVar23 = iVar23 + 1;
          psVar11 = psVar11 + 1;
        } while (iVar23 < piVar24[3]);
      }
      lVar22 = 0;
      iVar23 = *(int *)((longlong)local_3928 + 4) * *(int *)local_3928;
      uVar16 = local_3928[3];
      lVar32 = *(longlong *)(piVar9 + 6);
      if (0 < iVar23) {
        do {
          *(uint *)(lVar32 + lVar22 * 4) = (uint)*(ushort *)(uVar16 + lVar22 * 2);
          lVar22 = lVar22 + 1;
        } while (lVar22 < iVar23);
      }
    }
    else {
      if (0 < piVar24[3]) {
        do {
          bVar1 = *pbVar15;
          pbVar15 = pbVar15 + 1;
          *psVar11 = (ushort)bVar1 << 8;
          iVar23 = iVar23 + 1;
          psVar11 = psVar11 + 1;
        } while (iVar23 < piVar24[3]);
      }
      local_38d0 = 0xffffffff;
      uStack14540 = 0xffffffff;
      *(undefined4 *)(&stack0xffffffffffffffe8 + lVar6) = 0xffffffff;
      *(undefined4 *)(&stack0xffffffffffffffe0 + lVar6) = 0xffffffff;
      *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x1800111df;
      FUN_1800395b0(local_3928,(int *)local_3928,0xffffffffffffffff,iVar31,
                    *(int *)(&stack0xffffffffffffffe0 + lVar6),
                    *(int *)(&stack0xffffffffffffffe8 + lVar6));
      local_38b8 = 0xffffffffffffffff;
      *(undefined4 *)(&stack0xffffffffffffffe8 + lVar6) = 0xffffffff;
      *(undefined4 *)(&stack0xffffffffffffffe0 + lVar6) = 0xffffffff;
      *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x180011201;
      FUN_1800395b0(puVar8,local_3900,0xffffffffffffffff,iVar31 + 1,
                    *(int *)(&stack0xffffffffffffffe0 + lVar6),
                    *(int *)(&stack0xffffffffffffffe8 + lVar6));
      *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x18001120d;
      FUN_18000db40(&local_38b0,piVar9);
    }
    if (*param_2 * param_2[1] != 0) {
      uVar16 = (ulonglong)(uint)(*param_2 * param_2[1]);
      puVar17 = &DAT_1801170a0;
      while (uVar16 != 0) {
        uVar16 = uVar16 - 1;
        *puVar17 = 0;
        puVar17 = puVar17 + 1;
      }
    }
    piVar24 = *(int **)((longlong)&param_5 + lVar6);
    if ((*(undefined **)(piVar24 + 6) != (undefined *)0x0) && (piVar24[3] != 0)) {
      uVar16 = (ulonglong)(uint)piVar24[3];
      puVar17 = *(undefined **)(piVar24 + 6);
      while (uVar16 != 0) {
        uVar16 = uVar16 - 1;
        *puVar17 = 0;
        puVar17 = puVar17 + 1;
      }
    }
    piVar10 = *(int **)(&stack0x00000038 + lVar6);
    if ((*(undefined **)(piVar10 + 6) != (undefined *)0x0) && (piVar10[3] != 0)) {
      uVar16 = (ulonglong)(uint)piVar10[3];
      puVar17 = *(undefined **)(piVar10 + 6);
      while (uVar16 != 0) {
        uVar16 = uVar16 - 1;
        *puVar17 = 0;
        puVar17 = puVar17 + 1;
      }
    }
    lVar32 = (longlong)*piVar9;
    piVar18 = (int *)(*(longlong *)(piVar9 + 6) + 4 + lVar32 * 4);
    piVar27 = (int *)(*(longlong *)(piVar24 + 6) + ((longlong)*piVar24 + 1) * 4);
    puVar20 = (undefined2 *)(*(longlong *)(piVar10 + 6) + ((longlong)*piVar10 + 1) * 2);
    local_3944 = 1;
    if (1 < piVar9[1] + -1) {
      do {
        iVar31 = 1;
        if (1 < *piVar9 + -1) {
          piVar10 = piVar18 + -lVar32;
          piVar24 = piVar18;
          do {
            piVar18 = piVar24 + 1;
            iVar26 = *piVar18 - piVar24[-1];
            iVar23 = piVar24[lVar32] - *piVar10;
            if (iVar26 < 0x80000) {
              if (iVar26 < -0x80000) {
                iVar26 = -0x80000;
              }
            }
            else {
              iVar26 = 0x7ffff;
            }
            if (iVar23 < 0x80000) {
              if (iVar23 < -0x80000) {
                iVar23 = -0x80000;
              }
            }
            else {
              iVar23 = 0x7ffff;
            }
            local_3948 = iVar26 << 0xc;
            local_3920 = iVar23 << 0xc;
            *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x180011385;
            uVar16 = FUN_1800350d0(&local_3920,&local_3948,
                                   *(undefined *)((longlong)&uStack72 + lVar6));
            *puVar20 = (short)uVar16;
            *piVar27 = (int)local_3948 >> 0xc;
            if (0x3ffff < (int)local_3948 >> 0xc) {
              *piVar27 = 0x3ffff;
            }
            piVar10 = piVar10 + 1;
            piVar27 = piVar27 + 1;
            puVar20 = puVar20 + 1;
            iVar31 = iVar31 + 1;
            piVar24 = piVar18;
            piVar9 = local_3950;
          } while (iVar31 < *local_3950 + -1);
        }
        local_3944 = local_3944 + 1;
        piVar18 = piVar18 + 2;
        piVar27 = piVar27 + 2;
        puVar20 = puVar20 + 2;
      } while (local_3944 < piVar9[1] + -1);
      piVar10 = *(int **)(&stack0x00000038 + lVar6);
      piVar24 = *(int **)((longlong)&param_5 + lVar6);
      iVar31 = local_3940;
    }
    puVar5 = local_38f8;
    ppuVar7 = local_3930;
    param_2 = local_3938;
    iVar23 = *(int *)((longlong)aiStackX8 + lVar6 + 0x18);
    *(int *)((longlong)aiStackX8 + lVar6 + 0x10) = iVar23;
    *(int *)((longlong)aiStackX8 + lVar6 + 8) = local_391c;
    *(int *)((longlong)aiStackX8 + lVar6) = local_3918;
    *(int **)((longlong)aiStackX8 + lVar6 + -8) = piVar10;
    *(int **)(&stack0xfffffffffffffff8 + lVar6) = piVar24;
    *(ulonglong ***)(&stack0xffffffffffffffe8 + lVar6) = ppuVar7;
    *(uint **)(&stack0xffffffffffffffe0 + lVar6) = puVar5;
    *puVar5 = 0;
    *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x180011441;
    FUN_1800105c0(param_2,(char)piVar18,(char)piVar10,(char)piVar24,
                  *(undefined8 *)(&stack0xffffffffffffffe0 + lVar6),
                  *(undefined8 *)(&stack0xffffffffffffffe8 + lVar6),
                  *(undefined4 *)(&stack0xfffffffffffffff0 + lVar6),
                  *(undefined8 *)(&stack0xfffffffffffffff8 + lVar6),
                  *(undefined8 *)((longlong)aiStackX8 + lVar6 + -8),
                  *(int *)((longlong)aiStackX8 + lVar6),
                  *(undefined4 *)((longlong)aiStackX8 + lVar6 + 8),
                  *(undefined4 *)((longlong)aiStackX8 + lVar6 + 0x10));
    uVar13 = *puVar5;
    lVar32 = (longlong)(int)uVar13;
    if (((0x3c < (int)uVar13) || (iVar31 != 0)) || (local_3914 == 0)) break;
    iVar31 = 100;
    piVar24 = local_3908;
  }
  if (iVar23 - 9U < 2) {
    psVar11 = *(short **)(&stack0x00000030 + lVar6);
    *(int *)(&stack0xfffffffffffffff8 + lVar6) = local_3958;
    *(uint *)(&stack0xfffffffffffffff0 + lVar6) = uVar13;
    *(undefined8 **)(&stack0xffffffffffffffe0 + lVar6) = &local_38b8;
    local_38b8 = 0xe666;
    *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x1800117a1;
    uVar13 = FUN_180010930(lVar32,psVar11,piVar10,(undefined *)local_3898,
                           *(undefined *)((longlong)&uStack72 + lVar6));
    *puVar5 = uVar13;
    if ((local_58 < (ulonglong *)((longlong)&DAT_18011f580 + 1)) ||
       ((undefined8 *)0x180122dbf < local_3898)) {
      *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x1800117da;
      memcpy_FUN_180061f90
                ((undefined8 *)&DAT_18011f580,local_3898,0x3840,
                 *(undefined *)((longlong)&uStack72 + lVar6));
    }
    piVar24 = local_38c8;
    _Memory = *(void **)(&stack0x00000038 + lVar6);
    iVar31 = 0;
    if (0 < (int)*puVar5) {
      piVar10 = *(int **)((longlong)&param_5 + lVar6);
      piVar9 = &DAT_18011f584;
      lVar32 = *(longlong *)(&stack0x00000030 + lVar6);
      do {
        iVar23 = piVar9[1];
        iVar26 = *piVar9;
        iVar3 = piVar9[-1];
        *(int **)(&stack0xfffffffffffffff8 + lVar6) = piVar24;
        *(undefined8 *)(&stack0xfffffffffffffff0 + lVar6) = 0;
        *(int **)(&stack0xffffffffffffffe8 + lVar6) = piVar10;
        *(void **)(&stack0xffffffffffffffe0 + lVar6) = _Memory;
        *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x180011831;
        FUN_180010090((longlong)iVar31 * 0x38 + lVar32,iVar3,iVar26,iVar23,
                      *(undefined8 *)(&stack0xffffffffffffffe0 + lVar6),
                      *(undefined8 *)(&stack0xffffffffffffffe8 + lVar6),
                      *(longlong *)(&stack0xfffffffffffffff0 + lVar6),
                      *(int **)(&stack0xfffffffffffffff8 + lVar6));
        iVar31 = iVar31 + 1;
        piVar9 = piVar9 + 6;
      } while (iVar31 < (int)*puVar5);
      psVar11 = *(short **)(&stack0x00000030 + lVar6);
      param_2 = local_3938;
      piVar9 = local_3950;
      goto LAB_180011703;
    }
  }
  else {
    piVar24 = &DAT_180122dc4;
    if (local_3958 < (int)uVar13) {
      uVar13 = 0;
      if (1 < lVar32) {
        lVar22 = 1;
        do {
          local_38f8 = *(uint **)((longlong)&DAT_180122dc0 + lVar22 * 8);
          lVar28 = lVar22;
          if (0 < lVar22) {
            local_38f8._4_4_ = (int)((ulonglong)local_38f8 >> 0x20);
            puVar19 = (undefined8 *)((longlong)&DAT_180122db8 + lVar22 * 8);
            do {
              if ((*(int *)puVar19 <= (int)local_38f8) &&
                 ((*(int *)puVar19 != (int)local_38f8 ||
                  (*(int *)((longlong)puVar19 + 4) == local_38f8._4_4_ ||
                   *(int *)((longlong)puVar19 + 4) < local_38f8._4_4_)))) break;
              lVar28 = lVar28 + -1;
              puVar19[1] = *puVar19;
              puVar19 = puVar19 + -1;
            } while (0 < lVar28);
          }
          lVar22 = lVar22 + 1;
          *(uint **)((longlong)&DAT_180122dc0 + lVar28 * 8) = local_38f8;
        } while (lVar22 < lVar32);
      }
      iVar31 = 0;
      if (0 < (int)*puVar5) {
        lVar32 = 0;
        piVar10 = &DAT_180122dc4;
        puVar20 = (undefined2 *)(*(longlong *)(&stack0x00000030 + lVar6) + 4);
        do {
          lVar22 = (longlong)*piVar10;
          lVar28 = lVar22 * 0x38;
          uVar13 = uVar13 + 1;
          puVar20[-2] = *(undefined2 *)(&DAT_180106d60 + lVar28);
          puVar20[-1] = *(undefined2 *)(&DAT_180106d62 + lVar28);
          *puVar20 = *(undefined2 *)(&DAT_180106d64 + lVar28);
          puVar20[1] = *(undefined2 *)(&DAT_180106d66 + lVar28);
          *(undefined4 *)(puVar20 + 2) = *(undefined4 *)((longlong)&DAT_180106d68 + lVar22 * 0x38);
          *(int *)((longlong)&DAT_180122dc4 + lVar32 * 8) = *piVar10;
          *(undefined4 *)((longlong)&DAT_180122dc0 + lVar32 * 8) =
               *(undefined4 *)((longlong)&DAT_180106d68 + lVar22 * 0x38);
          lVar32 = lVar32 + 1;
          if (local_3958 <= lVar32) break;
          iVar31 = iVar31 + 1;
          piVar10 = piVar10 + 2;
          puVar20 = puVar20 + 0x1c;
        } while (iVar31 < (int)*puVar5);
      }
      *puVar5 = uVar13;
    }
    else {
      puVar17 = *(undefined **)(&stack0x00000030 + lVar6);
      uVar13 = *puVar5 * 0x38;
      uVar16 = (ulonglong)uVar13;
      if ((((puVar17 != (undefined *)0x0) && (uVar13 != 0)) &&
          ((&DAT_180106d60 + uVar16 <= puVar17 || (puVar17 + uVar16 < &DAT_180106d61)))) &&
         (uVar13 != 0)) {
        lVar32 = -(longlong)puVar17;
        do {
          *puVar17 = puVar17[(longlong)(&DAT_180106d60 + lVar32)];
          puVar17 = puVar17 + 1;
          uVar16 = uVar16 - 1;
        } while (uVar16 != 0);
      }
    }
    _DAT_18010f0a0 = 0x10001;
    DAT_18010f1a0 = 1;
    iVar31 = 2;
    _DAT_18010f1a2 = 0xffff;
    do {
      lVar32 = (longlong)iVar31;
      if (0 < iVar31) {
        psVar11 = (short *)((longlong)&DAT_18010f0a0 + lVar32 * 0x100);
        lVar22 = lVar32;
        lVar28 = lVar32;
        psVar30 = psVar11;
        do {
          do {
            sVar2 = psVar11[lVar32 * -0x80];
            *psVar11 = sVar2;
            psVar11[lVar32 * -0x7f] = sVar2;
            psVar11[lVar32] = -sVar2;
            lVar22 = lVar22 + -1;
            psVar11 = psVar11 + 1;
          } while (lVar22 != 0);
          psVar11 = psVar30 + 0x80;
          lVar28 = lVar28 + -1;
          lVar22 = lVar32;
          psVar30 = psVar11;
        } while (lVar28 != 0);
      }
      iVar31 = iVar31 * 2;
    } while (iVar31 < 0x80);
    iVar31 = 0;
    _Memory = *(void **)(&stack0x00000038 + lVar6);
    if (0 < (int)*puVar5) {
      piVar10 = *(int **)((longlong)&param_5 + lVar6);
      lVar32 = *(longlong *)(&stack0x00000030 + lVar6);
      do {
        iVar23 = *(int *)((longlong)&DAT_18011f584 + (longlong)*piVar24 * 0x18);
        iVar26 = *(int *)((longlong)&DAT_18011f580 + (longlong)*piVar24 * 0x18);
        *(int **)(&stack0xfffffffffffffff8 + lVar6) = local_38c8;
        *(undefined2 **)(&stack0xfffffffffffffff0 + lVar6) = &DAT_18010f0a0;
        *(int **)(&stack0xffffffffffffffe8 + lVar6) = piVar10;
        *(void **)(&stack0xffffffffffffffe0 + lVar6) = _Memory;
        *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x1800116e5;
        FUN_180010090((longlong)iVar31 * 0x38 + lVar32,iVar26,iVar23,local_3910,
                      *(undefined8 *)(&stack0xffffffffffffffe0 + lVar6),
                      *(undefined8 *)(&stack0xffffffffffffffe8 + lVar6),
                      *(longlong *)(&stack0xfffffffffffffff0 + lVar6),
                      *(int **)(&stack0xfffffffffffffff8 + lVar6));
        iVar31 = iVar31 + 1;
        piVar24 = piVar24 + 2;
        piVar9 = local_3950;
      } while (iVar31 < (int)*puVar5);
    }
    psVar11 = *(short **)(&stack0x00000030 + lVar6);
    param_2 = local_3938;
  }
  piVar10 = *(int **)((longlong)&param_5 + lVar6);
LAB_180011703:
  ppuVar7 = local_3930;
  iVar31 = param_2[1];
  iVar23 = 0;
  lVar32 = local_38c0;
  ppuVar29 = local_3930;
  if (0 < (int)*puVar5) {
    iVar26 = *(int *)((longlong)aiStackX8 + lVar6 + 0x18);
    puVar21 = (ushort *)(psVar11 + 2);
    do {
      uVar12 = puVar21[1];
      uVar25 = *puVar21 + 8 & 0xfff0;
      puVar21[-1] = puVar21[-1] + 8 & 0xfff0;
      *puVar21 = uVar25;
      if ((short)uVar12 < 0) {
        uVar12 = -(0x80 - uVar12 & 0xff00);
      }
      else {
        uVar12 = uVar12 + 0x80 & 0xff00;
      }
      puVar21[1] = uVar12;
      *(undefined4 *)(puVar21 + 4) = 0;
      if (1 < iVar26 - 9U) {
        if (uVar25 < 0x1400) {
          *(undefined4 *)(puVar21 + 4) = 1;
        }
        else {
          uVar14 = 0;
          if ((ushort)((short)(iVar31 << 8) + 0xec00U) <= uVar25) {
            uVar14 = 2;
          }
          *(undefined4 *)(puVar21 + 4) = uVar14;
        }
      }
      iVar23 = iVar23 + 1;
      puVar21 = puVar21 + 0x1c;
    } while (iVar23 < (int)*puVar5);
    _Memory = *(void **)(&stack0x00000038 + lVar6);
    piVar10 = *(int **)((longlong)&param_5 + lVar6);
    piVar9 = local_3950;
  }
  do {
    if ((ppuVar29 != (ulonglong **)0x0) && (puVar8 = *ppuVar29, puVar8 != (ulonglong *)0x0)) {
      *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x1800118d3;
      free(puVar8,*(undefined *)((longlong)&uStack72 + lVar6));
      *ppuVar29 = (ulonglong *)0x0;
    }
    lVar32 = lVar32 + -1;
    ppuVar29 = ppuVar29 + 1;
  } while (lVar32 != 0);
  *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x1800118e9;
  free(ppuVar7,*(undefined *)((longlong)&uStack72 + lVar6));
  *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x1800118f2;
  free(piVar9,*(undefined *)((longlong)&uStack72 + lVar6));
  if (local_3928 != (ulonglong *)0x0) {
    *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x180011901;
    free(local_3928,*(undefined *)((longlong)&uStack72 + lVar6));
  }
  if (local_3900 != (int *)0x0) {
    *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x180011913;
    free(local_3900,*(undefined *)((longlong)&uStack72 + lVar6));
  }
  *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x18001191c;
  free(piVar10,*(undefined *)((longlong)&uStack72 + lVar6));
  *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x180011925;
  free(_Memory,*(undefined *)((longlong)&uStack72 + lVar6));
  *(undefined8 *)((longlong)&uStack72 + lVar6) = 0x180011934;
  FUN_18005f100(local_58[0] ^ (ulonglong)(&stack0xffffffffffffffc0 + lVar6),
                *(undefined *)((longlong)&uStack72 + lVar6));
  return;
}



ulonglong FUN_180011950(int *param_1,ulonglong *param_2)

{
  longlong lVar1;
  longlong lVar2;
  undefined8 *puVar3;
  uint uVar4;
  uint uVar5;
  undefined8 *puVar6;
  ulonglong uVar7;
  undefined8 *puVar8;
  int iVar9;
  ulonglong uVar10;
  longlong lVar11;
  int iVar12;

  uVar7 = *param_2;
  lVar1 = *(longlong *)(param_1 + 6);
  iVar12 = *(int *)(uVar7 + 0xf0);
  lVar2 = *(longlong *)(uVar7 + 0xf8);
  if (0 < iVar12) {
    do {
      uVar4 = 0;
      uVar7 = 0;
      uVar10 = 0;
      if (0 < iVar12) {
        do {
          iVar9 = (int)uVar10;
          lVar11 = *(longlong *)(*param_2 + 0xf8);
          uVar5 = *(ushort *)(uVar7 + 2 + lVar11) + 0x80 >> 8;
          uVar4 = *(ushort *)(uVar7 + 4 + lVar11) + 0x80 >> 8;
          if ((((int)uVar5 < *param_1) && ((int)uVar4 < param_1[1])) &&
             (*(char *)((int)(*param_1 * uVar4 + uVar5) + lVar1) == '\0')) {
            iVar12 = iVar12 + -1;
            puVar6 = (undefined8 *)((longlong)iVar12 * 0x38 + lVar11);
            if (iVar9 != iVar12) {
              puVar8 = (undefined8 *)((longlong)iVar9 * 0x38 + lVar2);
              if (puVar8 != (undefined8 *)0x0) {
                if (puVar6 == (undefined8 *)0x0) goto LAB_180011a6a;
                if ((puVar6 + 7 <= puVar8) || (puVar8 + 7 <= puVar6)) {
                  lVar11 = 0x1c;
                  puVar3 = puVar6;
                  do {
                    *(undefined *)
                     ((longlong)(undefined8 *)((longlong)puVar8 - (longlong)puVar6) +
                     (longlong)puVar3) = *(undefined *)puVar3;
                    *(undefined *)
                     ((longlong)(undefined8 *)((longlong)puVar8 - (longlong)puVar6) + 1 +
                     (longlong)puVar3) = *(undefined *)((longlong)puVar3 + 1);
                    puVar3 = (undefined8 *)((longlong)puVar3 + 2);
                    lVar11 = lVar11 + -1;
                  } while (lVar11 != 0);
                }
              }
              if (puVar6 != (undefined8 *)0x0) {
                *puVar6 = 0;
                puVar6[1] = 0;
                puVar6[2] = 0;
                puVar6[3] = 0;
                puVar6[4] = 0;
                puVar6[5] = 0;
                puVar6[6] = 0;
              }
            }
LAB_180011a6a:
            iVar9 = iVar9 + -1;
            uVar7 = uVar7 - 0x38;
          }
          uVar4 = iVar9 + 1;
          uVar7 = uVar7 + 0x38;
          uVar10 = (ulonglong)uVar4;
        } while ((int)uVar4 < iVar12);
      }
      *(int *)(*param_2 + 0xf0) = iVar12;
      uVar7 = (ulonglong)(uVar4 + 1);
    } while ((int)(uVar4 + 1) < iVar12);
  }
  return uVar7;
}



void FUN_180011ab0(int **param_1,uint *param_2,int param_3,int param_4,int param_5,uint *param_6)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  undefined *puVar4;
  longlong lVar5;
  longlong lVar6;
  int *piVar7;
  uint uVar8;
  ulonglong uVar9;
  undefined8 *puVar10;
  undefined8 *puVar11;
  void *pvVar12;
  int *_Memory;
  int *_Memory_00;
  uint *puVar13;
  ulonglong *puVar14;
  uint uVar15;
  undefined *puVar16;
  longlong lVar17;
  byte *pbVar18;
  ulonglong *puVar19;
  int *piVar20;
  int iVar21;
  int iVar22;
  short *psVar23;
  ulonglong *puVar24;
  int iVar25;
  ulonglong uVar26;
  ulonglong uVar27;
  undefined8 local_b8;
  int local_b0 [2];
  int *local_a8;
  uint *local_a0;
  int *local_98;
  int *local_90;
  ulonglong *local_88;
  int local_80;
  int local_7c;
  uint *local_78;
  void *local_70;
  ulonglong local_68;
  undefined4 local_60;
  undefined4 uStack92;
  undefined4 local_58;
  undefined4 uStack84;
  undefined4 uStack80;
  undefined4 uStack76;
  undefined8 uStack72;
  ulonglong local_40;

  local_40 = DAT_1800b04e8 ^ (ulonglong)&stack0xffffffffffffff18;
  local_a0 = param_6;
  local_70 = (void *)0x0;
  local_b0[0] = 0;
  local_80 = param_4;
  local_78 = param_2;
  uVar9 = FUN_18002d800(*(longlong *)(param_2 + 6),&local_70,param_2[1],*param_2,local_b0);
  puVar13 = local_78;
  local_7c = (int)uVar9;
  if (param_5 == 0) {
    uVar8 = param_6[5];
  }
  else {
    uVar8 = param_6[6];
  }
  uVar15 = *param_6;
  uStack92 = 0x28;
  local_58 = 0;
  uStack84 = 0x1adfe;
  uStack80 = 0x20;
  uStack76 = 4;
  uStack72 = 0x100000020;
  if (uVar15 - 9 < 2) {
    uStack80 = 0x40;
    uStack76 = 2;
    uVar8 = (int)(param_4 * uVar8 + 0x32) / 100;
  }
  local_68 = CONCAT44(uVar8,uVar15);
  if (uVar15 == 2) {
    local_60 = 0x1c2;
  }
  else {
    if (uVar15 == 3) {
      local_60 = 600;
    }
    else {
      local_60 = 300;
      if (uVar15 - 6 < 2) {
        uStack84 = 0x1adfe;
        local_58 = 1;
        if (uVar15 == 7) {
          uStack84 = 0x1822e;
        }
      }
    }
  }
  uVar2 = param_6[4];
  uVar3 = param_6[3];
  if ((uVar15 == 0) || (uVar15 == 0x3f)) {
    local_a8 = FUN_180029ae0(local_78,(uint)(*local_78 == 0x76));
  }
  else {
    local_a8 = FUN_180022ff0(*local_78,local_78[1],local_78[4]);
    uVar15 = puVar13[3];
    uVar9 = (ulonglong)uVar15;
    puVar4 = *(undefined **)(puVar13 + 6);
    puVar16 = *(undefined **)(local_a8 + 6);
    if (((((puVar16 != (undefined *)0x0) && (puVar4 != (undefined *)0x0)) && (uVar15 != 0)) &&
        ((puVar4 + uVar9 <= puVar16 || (puVar16 + uVar9 <= puVar4)))) && (uVar15 != 0)) {
      lVar17 = -(longlong)puVar16;
      do {
        *puVar16 = puVar16[(longlong)(puVar4 + lVar17)];
        puVar16 = puVar16 + 1;
        uVar9 = uVar9 - 1;
      } while (uVar9 != 0);
    }
  }
  if (*param_1 == (int *)0x0) {
    uVar15 = local_a0[6];
    if (local_a0[6] < local_a0[5]) {
      uVar15 = local_a0[5];
    }
    puVar10 = (undefined8 *)malloc(0x158);
    *param_1 = (int *)puVar10;
    if (puVar10 != (undefined8 *)0x0) {
      lVar17 = 5;
      do {
        puVar11 = puVar10;
        *puVar11 = 0;
        puVar11[1] = 0;
        puVar11[2] = 0;
        puVar11[3] = 0;
        puVar11[4] = 0;
        puVar11[5] = 0;
        puVar11[6] = 0;
        puVar11[7] = 0;
        lVar17 = lVar17 + -1;
        puVar10 = puVar11 + 8;
      } while (lVar17 != 0);
      puVar11[8] = 0;
      puVar11[9] = 0;
      puVar11[10] = 0;
    }
    pvVar12 = malloc((longlong)(int)uVar15 * 0x38);
    *(void **)(*param_1 + 0x3e) = pvVar12;
    *(undefined8 *)(*param_1 + 8) = 0;
    *(undefined8 *)(*param_1 + 2) = 0;
    *(undefined8 *)(*param_1 + 4) = 0;
    *(undefined8 *)(*param_1 + 6) = 0;
    *(undefined8 *)(*param_1 + 0x4c) = 0;
  }
  **param_1 = *local_a8;
  (*param_1)[1] = local_a8[1];
  (*param_1)[0x43] = param_3;
  (*param_1)[0x44] = param_4;
  local_98 = FUN_180022ff0(*local_a8,local_a8[1],local_a8[4]);
  iVar25 = local_98[1];
  iVar22 = *local_98;
  iVar21 = iVar25 * iVar22 * 2;
  local_90 = (int *)malloc((longlong)iVar21 + 0x20);
  if (local_90 != (int *)0x0) {
    local_90[3] = iVar21;
    *local_90 = iVar22;
    local_90[1] = iVar25;
    local_90[4] = 2;
    local_90[2] = iVar22 * 2;
    *(int **)(local_90 + 6) = local_90 + 8;
  }
  iVar25 = *local_90;
  iVar22 = local_90[1];
  iVar21 = iVar25 * iVar22 * 2;
  local_88 = (ulonglong *)malloc((longlong)iVar21 + 0x20);
  if (local_88 != (ulonglong *)0x0) {
    *(int *)((longlong)local_88 + 0xc) = iVar21;
    *(int *)local_88 = iVar25;
    *(int *)((longlong)local_88 + 4) = iVar22;
    *(int *)(local_88 + 2) = 2;
    *(int *)(local_88 + 1) = iVar25 * 2;
    local_88[3] = (ulonglong)(local_88 + 4);
  }
  iVar25 = *local_a8;
  iVar22 = local_a8[1];
  iVar21 = iVar25 * iVar22;
  _Memory = (int *)malloc((longlong)iVar21 + 0x20);
  piVar20 = local_a8;
  if (_Memory == (int *)0x0) {
    _Memory = (int *)0x0;
  }
  else {
    _Memory[1] = iVar22;
    _Memory[3] = iVar21;
    *_Memory = iVar25;
    _Memory[4] = 1;
    _Memory[2] = iVar25;
    *(int **)(_Memory + 6) = _Memory + 8;
  }
  if ((*(undefined **)(_Memory + 6) != (undefined *)0x0) && (_Memory[3] != 0)) {
    uVar9 = (ulonglong)(uint)_Memory[3];
    puVar16 = *(undefined **)(_Memory + 6);
    while (uVar9 != 0) {
      uVar9 = uVar9 - 1;
      *puVar16 = 0;
      puVar16 = puVar16 + 1;
    }
  }
  FUN_180035ae0(local_a8,(longlong)_Memory,1,0x6e,1);
  local_b8 = 0;
  if (uVar2 == 0) {
    _Memory_00 = (int *)0x0;
  }
  else {
    _Memory_00 = (int *)FUN_180037360(piVar20);
  }
  piVar7 = local_90;
  iVar25 = 0;
  pbVar18 = *(byte **)(piVar20 + 6);
  psVar23 = (short *)local_88[3];
  if (0 < piVar20[3]) {
    do {
      bVar1 = *pbVar18;
      pbVar18 = pbVar18 + 1;
      *psVar23 = (ushort)bVar1 << 8;
      iVar25 = iVar25 + 1;
      psVar23 = psVar23 + 1;
    } while (iVar25 < piVar20[3]);
  }
  local_b8 = 0xffffffffffffffff;
  iVar25 = -1;
  if (*local_a0 - 9 < 2) {
    FUN_1800395b0(local_88,local_90,0xffffffffffffffff,7,-1,-1);
    piVar20 = local_98;
    lVar17 = *(longlong *)(piVar7 + 6);
    iVar22 = 0;
    puVar16 = *(undefined **)(local_98 + 6);
    if (0 < local_98[3]) {
      do {
        iVar22 = iVar22 + 1;
        *puVar16 = *(undefined *)(lVar17 + 1);
        puVar16 = puVar16 + 1;
        lVar17 = lVar17 + 2;
      } while (iVar22 < local_98[3]);
    }
    FUN_180028c20(uVar3,local_98,_Memory_00,_Memory,(longlong)*param_1);
  }
  else {
    FUN_1800395b0(local_88,local_90,0xffffffffffffffff,6,-1,-1);
    piVar20 = local_98;
    lVar17 = *(longlong *)(piVar7 + 6);
    iVar22 = 0;
    puVar16 = *(undefined **)(local_98 + 6);
    if (0 < local_98[3]) {
      do {
        iVar22 = iVar22 + 1;
        *puVar16 = *(undefined *)(lVar17 + 1);
        puVar16 = puVar16 + 1;
        lVar17 = lVar17 + 2;
      } while (iVar22 < local_98[3]);
    }
    FUN_180029250(uVar3,local_98,_Memory_00,_Memory,(longlong)*param_1);
  }
  FUN_18002a080(_Memory,(undefined8 *)(*param_1 + 10));
  puVar13 = FUN_18002a710(*param_1 + 10,uVar3,local_a0[2],local_a0[1]);
  FUN_180029df0((int *)puVar13,(int **)(*param_1 + 0x4c));
  if (puVar13 != (uint *)0x0) {
    free(puVar13);
  }
  if ((_Memory_00 == (int *)0x0) &&
     (_Memory_00 = FUN_180022ff0(*piVar20,piVar20[1],piVar20[4]), _Memory_00 != (int *)0x0)) {
    if (_Memory_00[3] < piVar20[3]) {
      free(_Memory_00);
      _Memory_00 = FUN_180022ff0(*piVar20,piVar20[1],piVar20[4]);
    }
    *_Memory_00 = *piVar20;
    _Memory_00[1] = piVar20[1];
    _Memory_00[2] = piVar20[2];
    _Memory_00[3] = piVar20[3];
    _Memory_00[4] = piVar20[4];
    puVar16 = *(undefined **)(_Memory_00 + 6);
    uVar15 = piVar20[3];
    puVar4 = *(undefined **)(piVar20 + 6);
    if ((((puVar16 != (undefined *)0x0) && (puVar4 != (undefined *)0x0)) && (uVar15 != 0)) &&
       (((uVar9 = (ulonglong)uVar15, puVar4 + uVar15 <= puVar16 || (puVar16 + uVar15 <= puVar4)) &&
        (uVar15 != 0)))) {
      lVar17 = -(longlong)puVar16;
      do {
        *puVar16 = puVar16[(longlong)(puVar4 + lVar17)];
        puVar16 = puVar16 + 1;
        uVar9 = uVar9 - 1;
      } while (uVar9 != 0);
    }
  }
  puVar13 = local_a0;
  if (*local_a0 == 7) {
    local_68 = local_68 & 0xffffffff |
               (ulonglong)((int)((uVar8 - 0x78) * local_80) / 100 + 0x78) << 0x20;
  }
  FUN_180010dc0(_Memory_00,piVar20,*(undefined8 *)(*param_1 + 0x3e),(uint *)(*param_1 + 0x3c),
                (int *)&local_68);
  uVar8 = *puVar13;
  if ((uVar8 < 0x3f) && ((0x40000000000000c1U >> ((longlong)(int)uVar8 & 0x3fU) & 1) != 0)) {
    lVar17 = *(longlong *)(_Memory + 6);
    iVar22 = (*param_1)[0x3c];
    lVar5 = *(longlong *)(*param_1 + 0x3e);
    piVar20 = local_98;
    if (0 < iVar22) {
      uVar9 = 0;
      do {
        uVar27 = uVar9 & 0xffffffff;
        uVar8 = (uint)uVar27;
        uVar26 = uVar9;
        if (0 < iVar22) {
          do {
            iVar21 = (int)uVar27;
            lVar6 = *(longlong *)(*param_1 + 0x3e);
            uVar15 = *(ushort *)(lVar6 + 2 + uVar26) + 0x80 >> 8;
            uVar8 = *(ushort *)(lVar6 + 4 + uVar26) + 0x80 >> 8;
            if ((((int)uVar15 < *_Memory) && ((int)uVar8 < _Memory[1])) &&
               (*(char *)((int)(uVar8 * *_Memory + uVar15) + lVar17) == '\0')) {
              iVar22 = iVar22 + -1;
              puVar19 = (ulonglong *)((longlong)iVar22 * 0x38 + lVar6);
              if (iVar21 != iVar22) {
                puVar24 = (ulonglong *)((longlong)iVar21 * 0x38 + lVar5);
                if (puVar24 != (ulonglong *)0x0) {
                  if (puVar19 == (ulonglong *)0x0) goto LAB_1800121f8;
                  if ((puVar19 + 7 <= puVar24) || (puVar24 + 7 <= puVar19)) {
                    uVar9 = 0x1c;
                    puVar14 = puVar19;
                    do {
                      *(undefined *)
                       ((longlong)(ulonglong *)((longlong)puVar24 - (longlong)puVar19) +
                       (longlong)puVar14) = *(undefined *)puVar14;
                      ((undefined *)
                      ((longlong)(ulonglong *)((longlong)puVar24 - (longlong)puVar19) + 1))
                      [(longlong)puVar14] = *(undefined *)((longlong)puVar14 + 1);
                      puVar14 = (ulonglong *)((longlong)puVar14 + 2);
                      uVar9 = uVar9 - 1;
                    } while (uVar9 != 0);
                  }
                }
                if (puVar19 != (ulonglong *)0x0) {
                  *puVar19 = uVar9;
                  puVar19[1] = uVar9;
                  puVar19[2] = uVar9;
                  puVar19[3] = uVar9;
                  puVar19[4] = uVar9;
                  puVar19[5] = uVar9;
                  puVar19[6] = uVar9;
                }
              }
LAB_1800121f8:
              iVar21 = iVar21 + -1;
              uVar26 = uVar26 - 0x38;
            }
            uVar8 = iVar21 + 1;
            uVar27 = (ulonglong)uVar8;
            uVar26 = uVar26 + 0x38;
          } while ((int)uVar8 < iVar22);
        }
        (*param_1)[0x3c] = iVar22;
      } while ((int)(uVar8 + 1) < iVar22);
    }
  }
  if (local_7c == 1) {
    FUN_180015de0(*(longlong *)(*param_1 + 0x3e),(longlong)local_70,*param_1 + 0x3c,*local_78,
                  local_78[1],iVar25);
    free(local_70);
  }
  if (_Memory_00 != (int *)0x0) {
    free(_Memory_00);
  }
  (*param_1)[0x52] = local_b0[0];
  if ((1 < *puVar13 - 9) && (iVar25 = 0, 0 < (*param_1)[0x3c])) {
    do {
      FUN_18000fe00((longlong)iVar25 * 0x38 + *(longlong *)(*param_1 + 0x3e),param_5);
      iVar25 = iVar25 + 1;
    } while (iVar25 < (*param_1)[0x3c]);
  }
  FUN_180004ea0((longlong)*param_1);
  (*param_1)[0x40] = 0;
  (*param_1)[0x41] = 0;
  (*param_1)[0x45] = 0;
  (*param_1)[0x47] = 0;
  (*param_1)[0x48] = 0;
  (*param_1)[0x49] = 0;
  (*param_1)[0x4a] = 0;
  free(_Memory);
  free(piVar20);
  free(local_90);
  free(local_88);
  free(local_a8);
  FUN_18005f100(local_40 ^ (ulonglong)&stack0xffffffffffffff18);
  return;
}



undefined8
FUN_180012380(int **param_1,uint *param_2,int param_3,int param_4,int param_5,uint *param_6)

{
  undefined8 uVar1;

  if (((*param_6 - 4 & 0xfffffffa) == 0) && (*param_6 != 9)) {
    return 0x80000003;
  }
  uVar1 = FUN_180011ab0(param_1,param_2,param_3,param_4,param_5,param_6);
  return uVar1;
}



void FUN_1800123c0(int *param_1,longlong param_2,longlong param_3,longlong param_4,longlong param_5)

{
  byte *pbVar1;
  longlong lVar2;
  longlong lVar3;
  longlong lVar4;
  longlong lVar5;
  ulonglong uVar6;
  int iVar7;
  longlong lVar8;
  longlong lVar9;
  int iVar10;
  undefined *puVar11;
  longlong lVar12;
  longlong lVar13;
  longlong lVar14;
  longlong lVar15;
  longlong lVar16;

  iVar7 = param_1[1];
  iVar10 = *param_1;
  lVar13 = (longlong)iVar10;
  if ((*(undefined **)(param_3 + 0x18) != (undefined *)0x0) && (*(uint *)(param_3 + 0xc) != 0)) {
    uVar6 = (ulonglong)*(uint *)(param_3 + 0xc);
    puVar11 = *(undefined **)(param_3 + 0x18);
    while (uVar6 != 0) {
      uVar6 = uVar6 - 1;
      *puVar11 = 0;
      puVar11 = puVar11 + 1;
    }
  }
  if ((*(undefined **)(param_4 + 0x18) != (undefined *)0x0) && (*(uint *)(param_4 + 0xc) != 0)) {
    uVar6 = (ulonglong)*(uint *)(param_4 + 0xc);
    puVar11 = *(undefined **)(param_4 + 0x18);
    while (uVar6 != 0) {
      uVar6 = uVar6 - 1;
      *puVar11 = 0;
      puVar11 = puVar11 + 1;
    }
  }
  if ((*(undefined **)(param_5 + 0x18) != (undefined *)0x0) && (*(uint *)(param_5 + 0xc) != 0)) {
    uVar6 = (ulonglong)*(uint *)(param_5 + 0xc);
    puVar11 = *(undefined **)(param_5 + 0x18);
    while (uVar6 != 0) {
      uVar6 = uVar6 - 1;
      *puVar11 = 0;
      puVar11 = puVar11 + 1;
    }
  }
  if (1 < iVar7 + -1) {
    lVar8 = lVar13 * 4 + 4;
    uVar6 = (ulonglong)(iVar7 - 2);
    lVar15 = (longlong)(iVar10 + -1);
    lVar16 = lVar13;
    do {
      lVar2 = *(longlong *)(param_3 + 0x18);
      lVar9 = *(longlong *)(param_1 + 6) + lVar16;
      lVar3 = *(longlong *)(param_4 + 0x18);
      lVar4 = *(longlong *)(param_5 + 0x18);
      lVar12 = *(longlong *)(param_2 + 0x18) + lVar16;
      lVar5 = 1;
      if (1 < lVar15) {
        lVar14 = lVar8;
        do {
          pbVar1 = (byte *)(lVar5 + (lVar9 - lVar13));
          if (((((((pbVar1 + -lVar9)[lVar12 + -1] != 0) && (pbVar1[lVar12 - lVar9] != 0)) &&
                ((pbVar1 + -lVar9)[lVar12 + 1] != 0)) &&
               ((*(char *)(lVar12 + -1 + lVar5) != '\0' && (pbVar1[lVar13 + -lVar9 + lVar12] != 0)))
               ) && ((*(char *)(lVar12 + 1 + lVar5) != '\0' &&
                     ((*(char *)(lVar13 + lVar12 + -1 + lVar5) != '\0' &&
                      (*(char *)(lVar13 + lVar5 + lVar12) != '\0')))))) &&
             (*(char *)(lVar13 + lVar12 + 1 + lVar5) != '\0')) {
            iVar10 = (uint)*(byte *)(lVar9 + 1 + lVar5) - (uint)*(byte *)(lVar5 + -1 + lVar9);
            iVar7 = (uint)*(byte *)(lVar13 + lVar5 + lVar9) - (uint)*pbVar1;
            *(int *)(lVar14 + lVar2) = iVar10;
            *(int *)(lVar14 + lVar3) = iVar7;
            *(int *)(lVar14 + lVar4) = iVar7 * iVar7 + iVar10 * iVar10;
          }
          lVar5 = lVar5 + 1;
          lVar14 = lVar14 + 4;
        } while (lVar5 < lVar15);
      }
      lVar8 = lVar8 + lVar13 * 4;
      lVar16 = lVar16 + lVar13;
      uVar6 = uVar6 - 1;
    } while (uVar6 != 0);
  }
  return;
}



void FUN_180012610(longlong param_1,longlong param_2,longlong param_3,int *param_4,int param_5,
                  int param_6,undefined8 param_7,undefined8 param_8,int param_9,int *param_10,
                  undefined4 *param_11)

{
  int iVar1;
  int iVar2;
  longlong lVar3;
  longlong lVar4;
  int *piVar5;
  int iVar6;
  longlong lVar7;
  longlong lVar8;
  uint uVar9;
  longlong lVar10;
  longlong lVar11;
  ulonglong uVar12;
  int *piVar13;
  ulonglong uVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  int iVar18;

  iVar17 = 0;
  iVar6 = *param_4;
  lVar11 = (longlong)iVar6;
  iVar15 = 0;
  *param_10 = 0;
  *param_11 = 0;
  lVar4 = (longlong)param_5;
  lVar10 = (longlong)(param_5 + 0x18);
  if (param_6 <= param_6 + 0x18) {
    lVar7 = (longlong)(iVar6 * param_6);
    lVar8 = *(longlong *)(param_4 + 6) + lVar7;
    lVar7 = (lVar7 + lVar4) * 4;
    piVar13 = (int *)(*(longlong *)(param_3 + 0x18) + lVar7);
    uVar9 = ((param_6 + 0x18) - param_6) + 1;
    uVar12 = (ulonglong)uVar9;
    uVar14 = (ulonglong)uVar9;
    lVar3 = lVar4;
    piVar5 = piVar13;
    do {
      while (lVar3 <= lVar10) {
        if (*(char *)(lVar8 + lVar3) != '\0') {
          iVar17 = iVar17 + *piVar13;
          iVar15 = iVar15 + 1;
        }
        piVar13 = piVar13 + 1;
        lVar3 = lVar3 + 1;
      }
      piVar13 = piVar5 + lVar11;
      lVar8 = lVar8 + lVar11;
      uVar14 = uVar14 - 1;
      lVar3 = lVar4;
      piVar5 = piVar13;
    } while (uVar14 != 0);
    if (0x137 < iVar15) {
      iVar6 = 0x19;
      if ((param_9 == 0) && (iVar15 = ((iVar15 >> 1) + iVar17) / iVar15, 0x19 < iVar15)) {
        iVar6 = iVar15;
      }
      iVar18 = 0;
      iVar16 = 0;
      iVar15 = 0;
      iVar17 = 0;
      lVar3 = *(longlong *)(param_1 + 0x18);
      piVar13 = (int *)(lVar7 + lVar3);
      do {
        if (lVar4 <= lVar10) {
          lVar7 = (lVar10 - lVar4) + 1;
          piVar5 = piVar13;
          do {
            if (iVar6 <= *(int *)((*(longlong *)(param_3 + 0x18) - lVar3) + (longlong)piVar5)) {
              iVar1 = *piVar5;
              iVar2 = *(int *)((*(longlong *)(param_2 + 0x18) - lVar3) + (longlong)piVar5);
              iVar16 = iVar16 + iVar1 * iVar1;
              iVar15 = iVar15 + iVar2 * iVar2;
              iVar17 = iVar17 + iVar2 * iVar1;
              iVar18 = iVar18 + 1;
            }
            piVar5 = piVar5 + 1;
            lVar7 = lVar7 + -1;
          } while (lVar7 != 0);
        }
        piVar13 = piVar13 + lVar11;
        uVar12 = uVar12 - 1;
      } while (uVar12 != 0);
      if (0x67 < iVar18) {
        iVar6 = iVar18 >> 1;
        lVar11 = (longlong)((iVar6 + iVar15) / iVar18);
        lVar7 = (longlong)((iVar6 + iVar16) / iVar18);
        lVar4 = (lVar7 + lVar11) / 2;
        lVar10 = (longlong)((iVar6 + iVar17) / iVar18);
        iVar6 = (int)(((lVar7 * lVar11 - lVar10 * lVar10) * 0x10000) / (lVar4 * lVar4 + 1));
        if (iVar6 < 1) {
          iVar6 = 0;
        }
        iVar6 = 0x10000 - iVar6;
        if (iVar6 < 1) {
          iVar6 = 0;
        }
        *param_10 = iVar6;
        *param_11 = 1;
        return;
      }
      *param_10 = 0;
      *param_11 = 1;
      return;
    }
  }
  *param_10 = 0;
  *param_11 = 0;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180012880(int *param_1,int *param_2,longlong param_3,longlong param_4,uint param_5,
                  int param_6)

{
  undefined auVar1 [16];
  undefined (*pauVar2) [16];
  undefined auVar3 [16];
  char cVar4;
  int iVar5;
  uint uVar7;
  longlong lVar8;
  undefined (*pauVar9) [16];
  char *pcVar10;
  int iVar11;
  int iVar12;
  longlong lVar13;
  uint uVar14;
  longlong lVar15;
  int iVar16;
  ulonglong uVar17;
  undefined auVar18 [16];
  int iVar6;

  iVar12 = *param_1;
  iVar16 = 0;
  uVar14 = param_1[1] * iVar12;
  iVar11 = 0;
  iVar5 = 0;
  lVar13 = 0;
  do {
    iVar16 = iVar16 + *(int *)(param_4 + lVar13 * 4);
    iVar6 = iVar5;
    if (param_6 >> 1 <= iVar16) {
      iVar6 = 100;
      lVar13 = 100;
      iVar11 = iVar5;
    }
    iVar5 = iVar6 + 1;
    lVar13 = lVar13 + 1;
  } while (iVar5 < 0x65);
  pauVar2 = *(undefined (**) [16])(param_1 + 6);
  if (0 < (int)param_5) {
    lVar13 = param_3 - (longlong)param_2;
    uVar17 = (ulonglong)param_5;
    do {
      iVar5 = *(int *)(lVar13 + (longlong)param_2);
      if ((iVar5 <= iVar11) && (-1 < iVar5)) {
        iVar5 = iVar12 * -0xc;
        lVar15 = 0x18;
        do {
          iVar16 = -0xc;
          do {
            lVar8 = (longlong)(iVar5 + iVar16 + *param_2);
            if ((*pauVar2)[lVar8] != '\0') {
              (*pauVar2)[lVar8] = 0x20;
            }
            iVar16 = iVar16 + 1;
          } while (iVar16 < 0xc);
          iVar5 = iVar5 + iVar12;
          lVar15 = lVar15 + -1;
        } while (lVar15 != 0);
      }
      param_2 = param_2 + 1;
      uVar17 = uVar17 - 1;
    } while (uVar17 != 0);
  }
  auVar3 = _DAT_1800a4470;
  iVar11 = 0;
  iVar12 = iVar11;
  if ((0 < (int)uVar14) && (iVar12 = 0, 0xf < uVar14)) {
    uVar7 = uVar14 & 0x8000000f;
    if ((int)uVar7 < 0) {
      uVar7 = (uVar7 - 1 | 0xfffffff0) + 1;
    }
    pauVar9 = pauVar2;
    do {
      auVar1 = *pauVar9;
      iVar11 = iVar11 + 0x10;
      auVar18 = CONCAT115(-(SUB161(auVar1 >> 0x78,0) == ' '),
                          CONCAT114(-(SUB161(auVar1 >> 0x70,0) == ' '),
                                    CONCAT113(-(SUB161(auVar1 >> 0x68,0) == ' '),
                                              CONCAT112(-(SUB161(auVar1 >> 0x60,0) == ' '),
                                                        CONCAT111(-(SUB161(auVar1 >> 0x58,0) == ' ')
                                                                  ,CONCAT110(-(SUB161(auVar1 >> 0x50
                                                                                      ,0) == ' '),
                                                                             CONCAT19(-(SUB161(
                                                  auVar1 >> 0x48,0) == ' '),
                                                  CONCAT18(-(SUB161(auVar1 >> 0x40,0) == ' '),
                                                           CONCAT17(-(SUB161(auVar1 >> 0x38,0) ==
                                                                     ' '),CONCAT16(-(SUB161(auVar1
                                                  >> 0x30,0) == ' '),
                                                  CONCAT15(-(SUB161(auVar1 >> 0x28,0) == ' '),
                                                           CONCAT14(-(SUB161(auVar1 >> 0x20,0) ==
                                                                     ' '),CONCAT13(-(SUB161(auVar1
                                                  >> 0x18,0) == ' '),
                                                  CONCAT12(-(SUB161(auVar1 >> 0x10,0) == ' '),
                                                           CONCAT11(-(SUB161(auVar1 >> 8,0) == ' '),
                                                                    -(SUB161(auVar1,0) == ' ')))))))
                                                  )))))))));
      *pauVar9 = (~auVar18 & auVar1 | auVar18 & auVar3) & auVar18 | ~auVar18 & ZEXT816(0);
      pauVar9 = pauVar9[1];
      iVar12 = iVar11;
    } while ((longlong)((longlong)pauVar9 - (longlong)pauVar2) < (longlong)(int)(uVar14 - uVar7));
  }
  lVar13 = (longlong)iVar12;
  if (lVar13 < (int)uVar14) {
    lVar15 = (int)uVar14 - lVar13;
    pcVar10 = *pauVar2 + lVar13;
    do {
      cVar4 = '\0';
      if (*pcVar10 == ' ') {
        cVar4 = -1;
      }
      *pcVar10 = cVar4;
      lVar15 = lVar15 + -1;
      pcVar10 = pcVar10 + 1;
    } while (lVar15 != 0);
  }
  return;
}



void FUN_180012a20(int *param_1,int *param_2,int param_3,int param_4)

{
  int *_Memory;
  int *_Memory_00;
  int *piVar1;
  int iVar2;
  longlong lVar3;
  int iVar4;
  int iVar5;
  longlong lVar6;
  uint uVar7;
  int *_Memory_01;
  longlong lVar8;
  longlong lVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  longlong lVar13;
  undefined8 in_stack_fffffffffffff488;
  undefined8 in_stack_fffffffffffff490;
  int local_b48;
  int local_b44;
  int local_b40;
  int local_b3c;
  int local_b38;
  int local_b34;
  int local_b30;
  int local_b2c;
  int local_b28;
  int local_b24;
  int *local_b20;
  int local_b18;
  int local_b14;
  longlong local_b10;
  int local_b08 [104];
  int local_968 [292];
  int local_4d8 [292];
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffff458;
  iVar2 = *param_1;
  local_b18 = param_1[1];
  iVar4 = iVar2 * local_b18 * 4;
  local_b48 = iVar2;
  local_b24 = param_4;
  local_b20 = param_2;
  local_b14 = param_3;
  _Memory = (int *)malloc((longlong)iVar4 + 0x20);
  if (_Memory != (int *)0x0) {
    _Memory[3] = iVar4;
    *_Memory = iVar2;
    _Memory[1] = local_b18;
    _Memory[4] = 4;
    _Memory[2] = iVar2 * 4;
    *(int **)(_Memory + 6) = _Memory + 8;
  }
  _Memory_00 = (int *)malloc((longlong)iVar4 + 0x20);
  if (_Memory_00 == (int *)0x0) {
    _Memory_00 = (int *)0x0;
  }
  else {
    *_Memory_00 = iVar2;
    _Memory_00[3] = iVar4;
    _Memory_00[1] = local_b18;
    _Memory_00[4] = 4;
    _Memory_00[2] = iVar2 * 4;
    *(int **)(_Memory_00 + 6) = _Memory_00 + 8;
  }
  _Memory_01 = (int *)0x0;
  piVar1 = (int *)malloc((longlong)iVar4 + 0x20);
  iVar2 = local_b48;
  if (piVar1 != (int *)0x0) {
    piVar1[3] = iVar4;
    *piVar1 = local_b48;
    piVar1[1] = local_b18;
    piVar1[4] = 4;
    piVar1[2] = local_b48 * 4;
    *(int **)(piVar1 + 6) = piVar1 + 8;
    _Memory_01 = piVar1;
  }
  local_b38 = 0;
  local_b3c = 0;
  local_b44 = 0;
  local_b40 = 0;
  FUN_1800123c0(param_1,(longlong)local_b20,(longlong)_Memory,(longlong)_Memory_00,
                (longlong)_Memory_01);
  memset(local_b08,0,0x194);
  memset(local_4d8,0,0x484);
  memset(local_968,0,0x484);
  local_b18 = local_b18 + -0xc;
  local_b30 = 0xc;
  uVar7 = 0;
  iVar4 = 0;
  if (0xc < local_b18) {
    iVar12 = iVar2 * 8;
    lVar3 = (longlong)(iVar2 + -0xc);
    iVar11 = iVar2 * -0xc + -0xc;
    iVar5 = iVar2 * -8;
    iVar10 = iVar2 * 0xc + 0xc;
    lVar13 = (longlong)(iVar2 * 0xc) + *(longlong *)(local_b20 + 6);
    lVar8 = 0;
    piVar1 = local_b20;
    local_b48 = iVar5;
    local_b34 = iVar12;
    local_b10 = lVar3;
    do {
      lVar6 = 0xc;
      lVar9 = lVar8;
      iVar2 = local_b30;
      local_b2c = iVar10;
      local_b28 = iVar11;
      if (0xc < lVar3) {
        do {
          lVar9 = lVar8;
          if (*(char *)(lVar13 + lVar6) != '\0') {
            FUN_180012610((longlong)_Memory,(longlong)_Memory_00,(longlong)_Memory_01,piVar1,
                          iVar11 + iVar10,iVar2 + -0xc,in_stack_fffffffffffff488,
                          in_stack_fffffffffffff490,local_b24,&local_b38,&local_b3c);
            if (local_b3c == 0) {
              local_968[lVar8] = -1;
            }
            else {
              local_b40 = local_b40 + local_b38;
              local_b44 = local_b44 + 1;
              iVar2 = local_b38 * 100 >> 0x10;
              local_b08[iVar2] = local_b08[iVar2] + 1;
              local_968[lVar8] = iVar2;
            }
            uVar7 = uVar7 + 1;
            lVar9 = lVar8 + 1;
            local_4d8[lVar8] = iVar10;
            lVar3 = local_b10;
            piVar1 = local_b20;
            iVar11 = local_b28;
            iVar2 = local_b30;
          }
          iVar10 = iVar10 + 8;
          lVar6 = lVar6 + 8;
          lVar8 = lVar9;
          iVar12 = local_b34;
          iVar5 = local_b48;
        } while (lVar6 < lVar3);
      }
      local_b30 = iVar2 + 8;
      iVar10 = local_b2c + iVar12;
      iVar11 = iVar11 + iVar5;
      lVar13 = lVar13 + iVar12;
      lVar8 = lVar9;
      iVar4 = local_b44;
      local_b2c = iVar10;
      local_b28 = iVar11;
    } while (local_b30 < local_b18);
  }
  if (local_b14 != 0) {
    FUN_180012880(local_b20,local_4d8,(longlong)local_968,(longlong)local_b08,uVar7,iVar4);
  }
  if (_Memory != (int *)0x0) {
    free(_Memory);
  }
  if (_Memory_00 != (int *)0x0) {
    free(_Memory_00);
  }
  if (_Memory_01 != (int *)0x0) {
    free(_Memory_01);
  }
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xfffffffffffff458);
  return;
}



void FUN_180012df0(uint *param_1,int *param_2,int *param_3)

{
  byte bVar1;
  uint uVar2;
  bool bVar3;
  bool bVar4;
  bool bVar5;
  bool bVar6;
  bool bVar7;
  bool bVar8;
  bool bVar9;
  bool bVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  uint uVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  uint uVar20;
  uint uVar21;
  uint uVar22;
  uint uVar23;
  uint uVar24;
  uint uVar25;
  uint uVar26;
  byte *pbVar27;
  byte *pbVar28;
  char *pcVar29;
  int iVar30;
  char *pcVar31;
  ulonglong uVar32;
  int local_b0;

  uVar2 = *param_1;
  local_b0 = 1;
  if (1 < (int)(param_1[1] - 1)) {
    uVar32 = SEXT48((int)-uVar2);
    do {
      iVar30 = 1;
      pbVar28 = (byte *)(*(longlong *)(param_1 + 6) + 1 + (longlong)(int)(*param_1 * local_b0));
      pcVar31 = (char *)(*(longlong *)(param_3 + 6) + (longlong)(*param_3 * local_b0) + 1);
      pcVar29 = (char *)(*(longlong *)(param_2 + 6) + 1 + (longlong)(*param_2 * local_b0));
      if (1 < (int)(*param_1 - 1)) {
        pbVar27 = pbVar28 + uVar32;
        do {
          if (*pcVar29 != '\0') {
            bVar1 = *pbVar28;
            bVar3 = 4 < (int)((uint)pbVar27[(longlong)(int)~uVar2 - uVar32] - (uint)bVar1);
            bVar4 = 4 < (int)((uint)*pbVar27 - (uint)bVar1);
            uVar12 = (uint)bVar1;
            bVar5 = 4 < (int)(pbVar27[(longlong)(int)(1 - uVar2) - uVar32] - uVar12);
            bVar6 = 4 < (int)(pbVar27[1 - uVar32] - uVar12);
            bVar7 = 4 < (int)(pbVar27[(longlong)(int)(uVar2 + 1) - uVar32] - uVar12);
            uVar15 = (uint)bVar7;
            bVar8 = 4 < (int)(pbVar27[(longlong)(int)uVar2 - uVar32] - uVar12);
            uVar14 = (uint)bVar8;
            bVar9 = 4 < (int)((uint)pbVar27[(longlong)(int)(uVar2 - 1) - uVar32] - (uint)bVar1);
            uVar12 = (uint)bVar9;
            bVar10 = 4 < (int)((uint)pbVar27[~uVar32] - (uint)bVar1);
            uVar11 = bVar10 - uVar12;
            uVar19 = (int)uVar11 >> 0x1f;
            uVar12 = uVar12 - uVar14;
            uVar20 = (int)uVar12 >> 0x1f;
            uVar26 = (uint)bVar3;
            uVar13 = uVar26 - bVar10;
            uVar21 = (int)uVar13 >> 0x1f;
            uVar14 = uVar14 - uVar15;
            uVar22 = (int)uVar14 >> 0x1f;
            uVar16 = (uint)bVar6;
            uVar15 = uVar15 - uVar16;
            uVar23 = (int)uVar15 >> 0x1f;
            uVar17 = (uint)bVar5;
            uVar16 = uVar16 - uVar17;
            uVar24 = (int)uVar16 >> 0x1f;
            uVar18 = (uint)bVar4;
            uVar17 = uVar17 - uVar18;
            uVar25 = (int)uVar17 >> 0x1f;
            uVar18 = uVar18 - uVar26;
            uVar26 = (int)uVar18 >> 0x1f;
            if ((int)(((uVar11 ^ uVar19) - uVar19) + ((uVar12 ^ uVar20) - uVar20) +
                      ((uVar13 ^ uVar21) - uVar21) + ((uVar14 ^ uVar22) - uVar22) +
                      ((uVar15 ^ uVar23) - uVar23) + ((uVar16 ^ uVar24) - uVar24) +
                      ((uVar17 ^ uVar25) - uVar25) + ((uVar18 ^ uVar26) - uVar26)) < 3) {
              *pcVar31 = bVar3 + bVar4 + bVar5 + bVar6 + bVar7 + bVar8 + bVar9 + bVar10;
            }
          }
          pcVar29 = pcVar29 + 1;
          pbVar28 = pbVar28 + 1;
          pbVar27 = pbVar27 + 1;
          pcVar31 = pcVar31 + 1;
          iVar30 = iVar30 + 1;
        } while (iVar30 < (int)(*param_1 - 1));
      }
      local_b0 = local_b0 + 1;
    } while (local_b0 < (int)(param_1[1] - 1));
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_1800131b0(uint *param_1,int *param_2,int *param_3)

{
  undefined8 *puVar1;
  uint uVar2;
  uint uVar3;
  uint *puVar4;
  byte *pbVar5;
  int iVar6;
  int iVar7;
  ulonglong uVar8;
  longlong lVar9;
  uint *_Memory;
  uint uVar10;
  int iVar11;
  undefined *puVar12;
  longlong lVar13;
  int iVar14;
  undefined auStack136 [32];
  undefined8 local_68;
  undefined8 local_60;
  undefined8 local_58;
  undefined8 local_50;
  undefined8 local_48;
  ulonglong local_40;

  local_40 = DAT_1800b04e8 ^ (ulonglong)auStack136;
  uVar2 = *param_1;
  uVar3 = param_1[1];
  uVar10 = uVar2 * uVar3;
  puVar4 = (uint *)malloc((longlong)(int)uVar10 + 0x20);
  _Memory = (uint *)0x0;
  iVar11 = 0;
  if (puVar4 != (uint *)0x0) {
    puVar4[3] = uVar10;
    *puVar4 = uVar2;
    puVar4[1] = uVar3;
    puVar4[4] = 1;
    puVar4[2] = uVar2;
    *(uint **)(puVar4 + 6) = puVar4 + 8;
    _Memory = puVar4;
  }
  if ((*(undefined **)(_Memory + 6) != (undefined *)0x0) && (*param_1 * param_1[1] != 0)) {
    uVar8 = (ulonglong)(*param_1 * param_1[1]);
    puVar12 = *(undefined **)(_Memory + 6);
    while (uVar8 != 0) {
      uVar8 = uVar8 - 1;
      *puVar12 = 9;
      puVar12 = puVar12 + 1;
    }
  }
  FUN_180012df0(param_1,param_2,(int *)_Memory);
  lVar9 = (longlong)(int)_Memory[3];
  pbVar5 = *(byte **)(_Memory + 6);
  local_68 = 0;
  local_60 = 0;
  local_58 = 0;
  local_50 = 0;
  local_48 = 0;
  iVar7 = iVar11;
  iVar14 = iVar11;
  iVar6 = iVar11;
  if (0 < lVar9) {
    lVar13 = *(longlong *)(param_2 + 6) - (longlong)pbVar5;
    do {
      if (pbVar5[lVar13] != 0) {
        puVar1 = (undefined8 *)((longlong)&local_68 + (ulonglong)*pbVar5 * 4);
        *(int *)puVar1 = *(int *)puVar1 + 1;
      }
      pbVar5 = pbVar5 + 1;
      lVar9 = lVar9 + -1;
    } while (lVar9 != 0);
    iVar6 = (int)local_48;
    iVar7 = (int)local_50;
    iVar14 = (int)local_60;
  }
  iVar7 = iVar6 + local_50._4_4_ + iVar7 + local_58._4_4_ + local_60._4_4_ + iVar14 + local_68._4_4_
          + (int)local_68 + (int)local_58;
  if (iVar7 != 0) {
    iVar11 = ((int)local_58 * 100) / iVar7;
  }
  *param_3 = iVar11;
  free(_Memory);
  FUN_18005f100(local_40 ^ (ulonglong)auStack136);
  return;
}



void FUN_180013410(int *param_1,int *param_2)

{
  int iVar1;
  code *pcVar2;
  longlong lVar3;
  char *pcVar4;
  undefined uVar5;
  ulonglong uVar6;
  int iVar7;
  int iVar8;
  undefined *puVar9;
  int iVar10;
  longlong lVar11;
  undefined *puVar12;
  uint uVar13;
  undefined8 uStack32;

  uStack32 = 0x18001342e;
  lVar3 = _alloca_probe();
  lVar3 = -lVar3;
  *(ulonglong *)(&stack0x00004c98 + lVar3) =
       DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffe8 + lVar3);
  lVar11 = *(longlong *)(param_1 + 6);
  puVar12 = *(undefined **)(param_2 + 6);
  iVar7 = 0;
  *(undefined8 *)((longlong)&uStack32 + lVar3) = 0x180013465;
  memset(&stack0x00000008 + lVar3,0,0x4c90,*(undefined *)((longlong)&uStack32 + lVar3));
  uVar13 = param_1[1] * *param_1;
  if (uVar13 != 0) {
    uVar6 = (ulonglong)uVar13;
    puVar9 = &stack0x00000008 + lVar3;
    while (uVar6 != 0) {
      uVar6 = uVar6 - 1;
      *puVar9 = 0xff;
      puVar9 = puVar9 + 1;
    }
  }
  if (0 < (int)uVar13) {
    uVar6 = 0;
    do {
      if ((&stack0x00000008 + uVar6 + lVar3)[lVar11 - (longlong)(&stack0x00000008 + lVar3)] == -1) {
        if (0x4c8f < uVar6) {
          *(undefined8 *)((longlong)&uStack32 + lVar3) = 0x1800135f7;
          __report_rangecheckfailure(*(undefined *)((longlong)&uStack32 + lVar3));
          pcVar2 = (code *)swi(3);
          (*pcVar2)();
          return;
        }
        (&stack0x00000008)[uVar6 + lVar3] = 0;
        iVar7 = iVar7 + 1;
      }
      uVar6 = uVar6 + 1;
    } while ((longlong)uVar6 < (longlong)(int)uVar13);
    if (0 < iVar7) {
      iVar7 = param_2[1];
      pcVar4 = &stack0x00000008 + lVar3;
      iVar1 = *param_2;
      uVar6 = SEXT48(iVar1);
      iVar10 = 0;
      if (0 < iVar7) {
        lVar11 = 0;
        do {
          iVar8 = 0;
          if (0 < iVar1) {
            do {
              if ((((((*pcVar4 == '\0') && ((iVar8 < 1 || (pcVar4[-1] == '\0')))) &&
                    ((iVar1 + -1 <= iVar8 || (pcVar4[1] == '\0')))) &&
                   ((((lVar11 < 1 || (pcVar4[~uVar6 + 1] == '\0')) &&
                     ((iVar7 + -1 <= iVar10 || (pcVar4[uVar6] == '\0')))) &&
                    ((iVar8 < 2 || (pcVar4[-2] == '\0')))))) &&
                  ((iVar1 + -2 <= iVar8 || (pcVar4[2] == '\0')))) &&
                 (((lVar11 < 2 || (pcVar4[uVar6 * -2] == '\0')) &&
                  ((iVar7 + -2 <= iVar10 || (pcVar4[uVar6 * 2] == '\0')))))) {
                uVar5 = 0;
              }
              else {
                uVar5 = 0xff;
              }
              *puVar12 = uVar5;
              pcVar4 = pcVar4 + 1;
              puVar12 = puVar12 + 1;
              iVar8 = iVar8 + 1;
            } while (iVar8 < iVar1);
          }
          iVar10 = iVar10 + 1;
          lVar11 = lVar11 + 1;
        } while (iVar10 < iVar7);
      }
      goto LAB_1800135b9;
    }
  }
  if ((puVar12 != (undefined *)0x0) && (uVar6 = (ulonglong)(uint)param_2[3], param_2[3] != 0)) {
    while (uVar6 != 0) {
      uVar6 = uVar6 - 1;
      *puVar12 = 0xff;
      puVar12 = puVar12 + 1;
    }
  }
LAB_1800135b9:
  *(undefined8 *)((longlong)&uStack32 + lVar3) = 0x1800135d5;
  FUN_18005f100(*(ulonglong *)(&stack0x00004c98 + lVar3) ^
                (ulonglong)(&stack0xffffffffffffffe8 + lVar3),
                *(undefined *)((longlong)&uStack32 + lVar3));
  return;
}



undefined8 FUN_180013600(uint *param_1,uint param_2,int *param_3,int *param_4)

{
  byte bVar1;
  uint uVar2;
  bool bVar3;
  int *_Memory;
  int iVar4;
  int iVar5;
  uint *puVar6;
  uint *_Memory_00;
  ulonglong uVar7;
  longlong lVar8;
  byte *pbVar9;
  undefined *puVar10;
  int iVar11;
  uint *puVar12;
  uint *_Memory_01;
  uint uVar13;
  short *psVar14;
  uint uVar15;
  uint uVar16;
  int local_68;
  int local_64;
  ulonglong local_60;
  ulonglong *local_58;
  int *local_50;
  int *local_48;

  puVar12 = (uint *)0x0;
  local_60 = local_60 & 0xffffffff00000000 | (ulonglong)param_2;
  uVar16 = (int)param_2 >> 3 & 0x3f;
  local_68 = 0;
  if (param_1[4] == 1) {
    uVar15 = *param_1;
    uVar2 = param_1[1];
    uVar13 = uVar15 * uVar2;
    local_48 = param_3;
    puVar6 = (uint *)malloc((longlong)(int)uVar13 + 0x20);
    _Memory_01 = puVar12;
    if (puVar6 != (uint *)0x0) {
      puVar6[3] = uVar13;
      *puVar6 = uVar15;
      puVar6[1] = uVar2;
      puVar6[4] = 1;
      puVar6[2] = uVar15;
      *(uint **)(puVar6 + 6) = puVar6 + 8;
      _Memory_01 = puVar6;
    }
    if ((*(undefined **)(_Memory_01 + 6) != (undefined *)0x0) && (*param_1 * param_1[1] != 0)) {
      uVar7 = (ulonglong)(*param_1 * param_1[1]);
      puVar10 = *(undefined **)(_Memory_01 + 6);
      while (uVar7 != 0) {
        uVar7 = uVar7 - 1;
        *puVar10 = 0;
        puVar10 = puVar10 + 1;
      }
    }
    uVar7 = FUN_180035ae0((int *)param_1,(longlong)_Memory_01,1,0x78,0xff);
    *param_4 = (int)uVar7;
    iVar4 = FUN_180013410((int *)param_1,(int *)_Memory_01);
    bVar3 = false;
    local_64 = iVar4;
    if (((local_60 & 4) == 0) && ((uVar16 != 0x3f || ((local_60 & 1) == 0)))) {
      iVar5 = FUN_180012a20((int *)param_1,(int *)_Memory_01,1,1);
      iVar11 = 0;
      if ((param_1[4] != 1) ||
         (FUN_1800131b0(param_1,(int *)_Memory_01,&local_68), iVar11 = local_68, local_68 < 0x2d)) {
        bVar3 = iVar5 < 0x46;
      }
    }
    else {
      iVar5 = FUN_180012a20((int *)param_1,(int *)_Memory_01,0,0);
      _Memory_00 = (uint *)FUN_180022ff0(*param_1,param_1[1],param_1[4]);
      local_58 = (ulonglong *)FUN_180022ff0(*param_1,param_1[1],2);
      local_50 = FUN_180022ff0(*param_1,param_1[1],2);
      pbVar9 = *(byte **)(param_1 + 6);
      psVar14 = (short *)local_58[3];
      puVar6 = puVar12;
      if (0 < (int)param_1[3]) {
        do {
          bVar1 = *pbVar9;
          pbVar9 = pbVar9 + 1;
          *psVar14 = (ushort)bVar1 << 8;
          uVar15 = (int)puVar6 + 1;
          psVar14 = psVar14 + 1;
          puVar6 = (uint *)(ulonglong)uVar15;
        } while ((int)uVar15 < (int)param_1[3]);
      }
      local_60 = 0xffffffffffffffff;
      FUN_1800395b0(local_58,local_50,0xffffffffffffffff,6,-1,-1);
      _Memory = local_50;
      puVar10 = *(undefined **)(_Memory_00 + 6);
      lVar8 = *(longlong *)(local_50 + 6);
      if (0 < (int)_Memory_00[3]) {
        do {
          uVar15 = (int)puVar12 + 1;
          puVar12 = (uint *)(ulonglong)uVar15;
          *puVar10 = *(undefined *)(lVar8 + 1);
          puVar10 = puVar10 + 1;
          lVar8 = lVar8 + 2;
        } while ((int)uVar15 < (int)_Memory_00[3]);
      }
      iVar11 = 0;
      if (_Memory_00[4] == 1) {
        FUN_1800131b0(_Memory_00,(int *)_Memory_01,&local_68);
        iVar11 = local_68;
      }
      free(_Memory_00);
      free(local_58);
      free(_Memory);
      iVar4 = local_64;
      if ((iVar11 < 0x2d) && (iVar5 < 0x5a)) {
        bVar3 = true;
      }
    }
    free(_Memory_01);
    if (bVar3) {
      iVar11 = (iVar11 * 0x100) / 0x2d;
      iVar5 = (iVar5 * iVar11 >> 8) * iVar11 >> 8;
    }
    iVar11 = *param_4;
    if (0x3333 < iVar4 - iVar11) {
      iVar5 = (((iVar11 * iVar5) / iVar4) * iVar11) / iVar4;
    }
    switch(uVar16) {
    case 0:
    case 2:
    case 9:
    case 10:
      iVar5 = iVar5 + -1;
      break;
    case 6:
      iVar5 = iVar5 + 2;
      break;
    case 7:
      iVar5 = iVar5 + -2;
      break;
    case 8:
      iVar5 = iVar5 + 3;
      break;
    case 0x3f:
      iVar5 = iVar5 + -8;
    }
    if (iVar5 < 0x65) {
      if (iVar5 < 1) {
        iVar5 = 1;
      }
    }
    else {
      iVar5 = 100;
    }
    *local_48 = iVar5;
    *param_4 = *param_4 * 100 >> 0x10;
    return 0;
  }
  return 0x80000003;
}



undefined8 FUN_180013a00(uint *param_1,int *param_2,undefined8 param_3,int *param_4,int *param_5)

{
  uint uVar1;
  uint uVar2;
  undefined *puVar3;
  longlong lVar4;
  int iVar5;
  int iVar6;
  uint *puVar7;
  undefined *puVar8;
  uint *puVar9;
  ulonglong uVar10;
  uint uVar11;
  uint uVar12;
  uint *_Memory;
  int iVar13;
  int local_48;
  int local_44;
  int local_40;
  int local_3c;
  int local_38;
  int local_34;
  int local_30;

  local_30 = *param_4;
  puVar9 = (uint *)0x0;
  local_44 = param_4[1];
  uVar11 = 0;
  if ((param_4[2] == 0) || (local_48 = 1, local_44 == 0)) {
    local_48 = 0;
  }
  uVar1 = *param_1;
  uVar2 = param_1[1];
  local_3c = param_4[3];
  local_40 = param_4[4];
  local_38 = param_4[5];
  local_34 = param_4[6];
  uVar12 = uVar1 * uVar2;
  puVar7 = (uint *)malloc((longlong)(int)uVar12 + 0x20);
  _Memory = puVar9;
  if (puVar7 != (uint *)0x0) {
    puVar7[3] = uVar12;
    *puVar7 = uVar1;
    puVar7[1] = uVar2;
    puVar7[4] = 1;
    puVar7[2] = uVar1;
    *(uint **)(puVar7 + 6) = puVar7 + 8;
    _Memory = puVar7;
  }
  puVar8 = *(undefined **)(_Memory + 6);
  uVar1 = param_2[3];
  uVar10 = (ulonglong)uVar1;
  puVar3 = *(undefined **)(param_2 + 6);
  if (((((puVar8 != (undefined *)0x0) && (puVar3 != (undefined *)0x0)) && (uVar1 != 0)) &&
      ((puVar3 + uVar10 <= puVar8 || (puVar8 + uVar10 <= puVar3)))) && (uVar1 != 0)) {
    lVar4 = -(longlong)puVar8;
    do {
      *puVar8 = puVar8[(longlong)(puVar3 + lVar4)];
      puVar8 = puVar8 + 1;
      uVar10 = uVar10 - 1;
    } while (uVar10 != 0);
  }
  iVar13 = param_2[1] * *param_2;
  puVar7 = puVar9;
  if (0 < iVar13) {
    do {
      uVar11 = (uint)puVar7 + 1;
      if (*(char *)((longlong)puVar9 + *(longlong *)(param_2 + 6)) == '\0') {
        uVar11 = (uint)puVar7;
      }
      puVar9 = (uint *)((longlong)puVar9 + 1);
      puVar7 = (uint *)(ulonglong)uVar11;
    } while ((longlong)puVar9 < (longlong)iVar13);
  }
  iVar13 = (int)(uVar11 << 0x10) / iVar13;
  iVar5 = FUN_180012a20((int *)param_1,(int *)_Memory,local_48,1);
  local_48 = 100;
  if ((local_44 != 0) && (iVar5 < local_40)) {
    if (param_1[4] == 1) {
      FUN_1800131b0(param_1,(int *)_Memory,&local_48);
    }
    if (local_48 < local_3c) {
      iVar6 = (local_48 << 8) / local_3c;
      iVar5 = (iVar5 * iVar6 >> 8) * iVar6 >> 8;
    }
    if (local_38 <= local_48) {
      iVar5 = iVar5 + local_34;
    }
  }
  if (local_30 != 0) {
    uVar10 = FUN_180035ae0((int *)param_1,0,0,0x78,0xff);
    iVar6 = (int)uVar10;
    if (0x3333 < iVar13 - iVar6) {
      iVar5 = (((iVar6 * iVar5) / iVar13) * iVar6) / iVar13;
    }
  }
  if (param_5 != (int *)0x0) {
    *param_5 = iVar5;
  }
  free(_Memory);
  return 0;
}



void FUN_180013ce0(ushort *param_1,short *param_2,uint param_3,uint param_4)

{
  int iVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  uint *_Memory;
  ulonglong uVar5;
  longlong lVar6;
  ulonglong uVar7;
  int iVar8;
  int iVar9;
  ushort *puVar10;
  short *psVar11;
  int iVar12;
  int iVar13;
  uint *puVar14;
  uint *puVar15;
  int iVar16;
  ushort *puVar17;
  ulonglong uVar18;
  int iVar19;
  ulonglong uVar20;
  short *local_68;

  _Memory = (uint *)malloc((longlong)(int)(param_3 * param_4) << 2);
  if ((_Memory != (uint *)0x0) &&
     (uVar4 = param_3 * param_4 * 4, uVar5 = (ulonglong)uVar4, puVar14 = _Memory, uVar4 != 0)) {
    while (uVar5 != 0) {
      uVar5 = uVar5 - 1;
      *(undefined *)puVar14 = 0;
      puVar14 = (uint *)((longlong)puVar14 + 1);
    }
  }
  uVar5 = SEXT48((int)param_4);
  *_Memory = (uint)*param_1;
  if (1 < (longlong)uVar5) {
    lVar6 = 1;
    do {
      _Memory[lVar6] = (uint)param_1[lVar6] + _Memory[lVar6 + -1];
      lVar6 = lVar6 + 1;
    } while (lVar6 < (longlong)uVar5);
  }
  uVar20 = uVar5;
  if (1 < (int)param_3) {
    uVar20 = (ulonglong)(param_3 - 1);
    puVar10 = param_1;
    puVar14 = _Memory;
    do {
      puVar14 = puVar14 + uVar5;
      puVar10 = puVar10 + uVar5;
      *puVar14 = (uint)*puVar10 + puVar14[-uVar5];
      if (1 < (longlong)uVar5) {
        lVar6 = uVar5 - 1;
        puVar15 = puVar14;
        puVar17 = puVar10;
        do {
          puVar17 = puVar17 + 1;
          puVar15[1] = (puVar15[1 - uVar5] - puVar15[-uVar5]) + (uint)*puVar17 + *puVar15;
          lVar6 = lVar6 + -1;
          puVar15 = puVar15 + 1;
        } while (lVar6 != 0);
      }
      uVar20 = uVar20 - 1;
    } while (uVar20 != 0);
    uVar20 = (ulonglong)param_4;
  }
  uVar7 = (ulonglong)param_3;
  if (0 < (int)param_3) {
    iVar19 = 5;
    local_68 = param_2;
    do {
      if (0 < (longlong)uVar5) {
        iVar9 = 5;
        iVar1 = param_3 - 1;
        if (iVar19 <= (int)(param_3 - 1)) {
          iVar1 = iVar19;
        }
        iVar8 = iVar1 * (uint)uVar20;
        psVar11 = local_68;
        uVar18 = uVar5;
        uVar4 = (uint)uVar20;
        do {
          iVar13 = iVar19 + -10;
          iVar2 = iVar9 + -10;
          if (iVar9 + -10 < 0) {
            iVar2 = 0;
          }
          iVar16 = uVar4 - 1;
          if (iVar9 <= (int)(uVar4 - 1)) {
            iVar16 = iVar9;
          }
          if (iVar13 < 0) {
            iVar13 = 0;
          }
          if (iVar2 == 0) {
            if (iVar13 == 0) {
              uVar4 = _Memory[iVar8 + iVar16];
            }
            else {
              iVar3 = (iVar13 + -1) * (int)uVar20 + iVar16;
LAB_180013f02:
              uVar4 = _Memory[iVar8 + iVar16] - _Memory[iVar3];
            }
          }
          else {
            iVar3 = iVar2 + -1 + iVar8;
            if (iVar13 == 0) goto LAB_180013f02;
            iVar12 = (iVar13 + -1) * (int)uVar20;
            uVar4 = ((_Memory[iVar2 + -1 + iVar12] - _Memory[iVar3]) - _Memory[iVar16 + iVar12]) +
                    _Memory[iVar8 + iVar16];
          }
          iVar13 = ((iVar1 - iVar13) + 1) * ((iVar16 - iVar2) + 1);
          if (0 < iVar13) {
            uVar4 = (int)(uVar4 + (iVar13 >> 1)) / iVar13;
          }
          uVar20 = (ulonglong)param_4;
          iVar9 = iVar9 + 1;
          *psVar11 = (*(short *)((longlong)psVar11 +
                                (longlong)((longlong)param_1 - (longlong)param_2)) - (short)uVar4) +
                     0x2000;
          psVar11 = psVar11 + 1;
          uVar18 = uVar18 - 1;
          uVar4 = param_4;
        } while (uVar18 != 0);
      }
      uVar20 = (ulonglong)param_4;
      local_68 = local_68 + uVar5;
      iVar19 = iVar19 + 1;
      uVar7 = uVar7 - 1;
    } while (uVar7 != 0);
  }
                    // WARNING: Could not recover jumptable at 0x000180014004. Too many branches
                    // WARNING: Treating indirect jump as call
  free(_Memory);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180014010(int *param_1,longlong param_2)

{
  uint uVar1;
  size_t _Size;
  undefined *_Memory;
  undefined *_Memory_00;
  ulonglong uVar2;
  undefined uVar3;
  undefined *puVar4;
  longlong lVar5;
  int iVar6;
  ulonglong local_98;
  longlong local_90;
  int local_88;
  undefined4 local_84;
  int local_80;
  int local_7c;
  undefined4 local_78;
  undefined *local_70;
  int local_68;
  undefined4 local_64;
  int local_60;
  int local_5c;
  undefined4 local_58;
  undefined *local_50;
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xffffffffffffff38;
  uVar1 = param_1[1];
  local_88 = *param_1;
  local_98 = local_98 & 0xffffffff00000000 | (ulonglong)uVar1;
  _Size = (longlong)local_88 * (longlong)(int)uVar1 * 2;
  iVar6 = local_88 * uVar1;
  local_90 = param_2;
  _Memory = (undefined *)malloc(_Size);
  _Memory_00 = (undefined *)malloc(_Size);
  if ((_Memory != (undefined *)0x0) && (iVar6 * 2 != 0)) {
    uVar2 = (ulonglong)(uint)(iVar6 * 2);
    puVar4 = _Memory;
    while (uVar2 != 0) {
      uVar2 = uVar2 - 1;
      *puVar4 = 0;
      puVar4 = puVar4 + 1;
    }
  }
  if ((_Memory_00 != (undefined *)0x0) && (iVar6 * 2 != 0)) {
    uVar2 = (ulonglong)(uint)(iVar6 * 2);
    puVar4 = _Memory_00;
    while (uVar2 != 0) {
      uVar2 = uVar2 - 1;
      *puVar4 = 0;
      puVar4 = puVar4 + 1;
    }
  }
  if (0 < iVar6) {
    lVar5 = 0;
    do {
      *(ushort *)(_Memory + lVar5 * 2) =
           (ushort)*(byte *)(*(longlong *)(param_1 + 6) + lVar5) * 0xff;
      lVar5 = lVar5 + 1;
      param_2 = local_90;
    } while (lVar5 < iVar6);
  }
  local_80 = local_88 * 2;
  local_7c = iVar6 * 2;
  local_84 = (undefined4)local_98;
  local_64 = (undefined4)local_98;
  local_98 = 0xffffffffffffffff;
  local_78 = 2;
  local_58 = 2;
  local_70 = _Memory;
  local_68 = local_88;
  local_60 = local_80;
  local_5c = local_7c;
  local_50 = _Memory_00;
  FUN_1800395b0((ulonglong *)&local_88,&local_68,0xffffffffffffffff,8,-1,-1);
  if (0 < iVar6) {
    lVar5 = 0;
    do {
      uVar3 = 0;
      if (0xf9 < *(ushort *)(_Memory_00 + lVar5 * 2)) {
        uVar3 = 0xff;
      }
      *(undefined *)(lVar5 + *(longlong *)(param_2 + 0x18)) = uVar3;
      lVar5 = lVar5 + 1;
    } while (lVar5 < iVar6);
  }
  free(_Memory);
  free(_Memory_00);
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xffffffffffffff38);
  return;
}



void FUN_1800141d0(longlong param_1,ushort *param_2,uint param_3,uint param_4,int *param_5,
                  int *param_6)

{
  short *_Memory;
  char *pcVar1;
  ulonglong uVar2;
  ushort *puVar3;
  int iVar4;
  ulonglong uVar5;
  ushort *puVar6;
  ulonglong uVar7;
  longlong lVar8;
  ulonglong uVar9;
  int iVar10;
  longlong lVar11;
  ulonglong uVar12;
  char *pcVar13;
  int iVar14;

  uVar7 = 0;
  lVar8 = (longlong)(int)param_4;
  iVar10 = 0;
  _Memory = (short *)malloc((longlong)(int)(param_3 * param_4) * 2);
  iVar14 = iVar10;
  if (0 < (int)param_3) {
    uVar12 = (ulonglong)param_3;
    uVar5 = uVar7;
    lVar11 = param_1;
    puVar6 = param_2;
    uVar9 = uVar7;
    do {
      uVar2 = uVar7;
      puVar3 = puVar6;
      if (0 < (int)param_4) {
        do {
          if (*(char *)(lVar11 + uVar2) != '\0') {
            uVar9 = (ulonglong)((int)uVar9 + (uint)*puVar3);
            uVar5 = (ulonglong)((int)uVar5 + 1);
          }
          uVar2 = uVar2 + 1;
          puVar3 = puVar3 + 1;
        } while ((longlong)uVar2 < lVar8);
      }
      iVar14 = (int)uVar9;
      lVar11 = lVar11 + lVar8;
      puVar6 = puVar6 + lVar8;
      uVar12 = uVar12 - 1;
    } while (uVar12 != 0);
    iVar4 = (int)uVar5;
    if (iVar4 != 0) {
      iVar14 = ((iVar4 >> 1) + iVar14) / iVar4;
    }
  }
  FUN_180013ce0(param_2,_Memory,param_3,param_4);
  if (7 < (int)(param_3 - 7)) {
    uVar9 = (ulonglong)(param_3 - 0xe);
    pcVar13 = (char *)(param_1 + 7 + (longlong)(int)(param_4 * 7));
    puVar6 = (ushort *)(_Memory + (longlong)(int)(param_4 * 7) + 7);
    uVar5 = uVar7;
    do {
      if (7 < (int)(param_4 - 7)) {
        uVar12 = (ulonglong)(param_4 - 0xe);
        pcVar1 = pcVar13;
        puVar3 = puVar6;
        do {
          if (*pcVar1 != '\0') {
            iVar10 = *puVar3 - 0x2000;
            if (iVar10 < 1) {
              iVar10 = 0x2000 - (uint)*puVar3;
            }
            uVar5 = (ulonglong)(uint)((int)uVar5 + iVar10);
            uVar7 = (ulonglong)((int)uVar7 + 1);
          }
          puVar3 = puVar3 + 1;
          pcVar1 = pcVar1 + 1;
          uVar12 = uVar12 - 1;
        } while (uVar12 != 0);
      }
      iVar10 = (int)uVar5;
      puVar6 = puVar6 + lVar8;
      pcVar13 = pcVar13 + lVar8;
      uVar9 = uVar9 - 1;
    } while (uVar9 != 0);
    iVar4 = (int)uVar7;
    if (iVar4 != 0) {
      iVar10 = ((iVar4 >> 1) + iVar10) / iVar4;
    }
  }
  *param_5 = iVar14;
  *param_6 = iVar10 * 3;
                    // WARNING: Could not recover jumptable at 0x000180014350. Too many branches
                    // WARNING: Treating indirect jump as call
  free(_Memory);
  return;
}



void FUN_180014360(int *param_1,uint param_2,uint *param_3,uint *param_4)

{
  int *piVar1;
  ulonglong uVar2;
  uint uVar3;
  longlong lVar4;
  uint uVar5;
  ulonglong uVar6;
  uint uVar7;
  longlong lVar9;
  uint uVar10;
  ulonglong uVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  int iVar18;
  int iVar19;
  ulonglong uVar8;

  uVar6 = 0;
  uVar10 = 0;
  uVar11 = (ulonglong)param_2;
  uVar5 = 0;
  *param_3 = 0;
  *param_4 = 0;
  uVar7 = uVar5;
  uVar3 = uVar10;
  if ((0 < (int)param_2) && (uVar3 = 0, 7 < param_2)) {
    iVar12 = 0;
    iVar14 = 0;
    iVar16 = 0;
    iVar18 = 0;
    iVar13 = 0;
    iVar15 = 0;
    iVar17 = 0;
    iVar19 = 0;
    uVar3 = param_2 & 0x80000007;
    if ((int)uVar3 < 0) {
      uVar3 = (uVar3 - 1 | 0xfffffff8) + 1;
    }
    uVar2 = uVar6;
    uVar8 = uVar6;
    do {
      piVar1 = param_1 + uVar2;
      uVar7 = (int)uVar8 + 8;
      uVar8 = (ulonglong)uVar7;
      iVar12 = *piVar1 + iVar12;
      iVar14 = piVar1[1] + iVar14;
      iVar16 = piVar1[2] + iVar16;
      iVar18 = piVar1[3] + iVar18;
      piVar1 = param_1 + uVar2 + 4;
      uVar2 = uVar2 + 8;
      iVar13 = *piVar1 + iVar13;
      iVar15 = piVar1[1] + iVar15;
      iVar17 = piVar1[2] + iVar17;
      iVar19 = piVar1[3] + iVar19;
    } while ((longlong)uVar2 < (longlong)(int)(param_2 - uVar3));
    uVar3 = iVar13 + iVar12 + iVar17 + iVar16 + iVar15 + iVar14 + iVar19 + iVar18;
  }
  lVar4 = (longlong)(int)uVar7;
  lVar9 = (longlong)(int)param_2;
  if (lVar4 < lVar9) {
    if (1 < lVar9 - lVar4) {
      uVar2 = uVar6;
      uVar8 = uVar6;
      do {
        uVar5 = (int)uVar2 + param_1[lVar4];
        uVar2 = (ulonglong)uVar5;
        uVar10 = (int)uVar8 + param_1[lVar4 + 1];
        uVar8 = (ulonglong)uVar10;
        lVar4 = lVar4 + 2;
      } while (lVar4 < lVar9 + -1);
    }
    if (lVar4 < lVar9) {
      uVar3 = uVar3 + param_1[lVar4];
    }
    uVar3 = uVar3 + uVar10 + uVar5;
  }
  *param_3 = uVar3;
  if (param_2 != 0) {
    uVar3 = (int)(((int)param_2 >> 1) + uVar3) / (int)param_2;
  }
  *param_3 = uVar3;
  if (0 < (int)param_2) {
    do {
      iVar12 = *param_1 - uVar3;
      if ((int)(*param_1 - uVar3) < 1) {
        iVar12 = uVar3 - *param_1;
      }
      uVar7 = (int)uVar6 + iVar12;
      uVar6 = (ulonglong)uVar7;
      uVar11 = uVar11 - 1;
      param_1 = param_1 + 1;
    } while (uVar11 != 0);
    *param_4 = uVar7;
  }
  if (param_2 == 0) {
    param_2 = *param_4;
  }
  else {
    param_2 = (int)(((int)param_2 >> 1) + *param_4) / (int)param_2;
  }
  *param_4 = param_2;
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_1800144b0(longlong param_1,longlong param_2,ushort *param_3,undefined8 param_4,
                  undefined4 *param_5,int param_6,uint param_7)

{
  longlong lVar1;
  size_t _Size;
  longlong lVar2;
  longlong lVar3;
  longlong lVar4;
  uint uVar5;
  uint uVar6;
  int *piVar7;
  undefined *puVar8;
  undefined *puVar9;
  undefined (*pauVar10) [16];
  int *piVar11;
  longlong *plVar12;
  undefined uVar13;
  ulonglong uVar14;
  int *_Memory;
  undefined *puVar15;
  longlong lVar16;
  undefined4 uVar17;
  int iVar18;
  int iVar19;
  longlong lVar20;
  uint uVar21;
  int iVar22;
  int iVar23;
  int iVar24;
  int iVar25;
  int iVar26;
  int iVar27;
  int iVar28;
  int iVar29;
  undefined in_XMM1 [16];
  int iVar30;
  undefined in_XMM2 [16];
  int iVar31;
  int iVar32;
  uint uVar33;
  uint uVar34;
  uint uVar35;
  uint uVar36;
  uint uVar37;
  uint uVar38;
  uint uVar39;
  undefined in_XMM5 [16];
  undefined in_XMM6 [16];
  undefined in_XMM7 [16];
  undefined in_XMM8 [16];
  int local_378;
  int local_374;
  undefined8 local_370;
  uint local_368;
  int local_364;
  int local_360;
  undefined *local_358;
  ushort *local_350;
  longlong local_348;
  undefined4 *local_340;
  longlong local_338;
  int local_330;
  int local_32c;
  int local_328;
  int local_324;
  undefined4 local_320;
  undefined *local_318;
  int local_310;
  int local_30c;
  int local_308;
  int local_304;
  undefined4 local_300;
  undefined *local_2f8;
  int local_2e8 [4];
  int local_2d8 [48];
  int local_218 [52];
  int local_148 [52];
  ulonglong local_78;
  undefined local_68 [16];
  undefined local_58 [16];
  undefined local_48 [16];

  local_78 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffc58;
  _Memory = (int *)0x0;
  local_340 = param_5;
  uVar5 = param_7 >> 0x17;
  uVar21 = (int)param_7 >> 0xe & 0x1ff;
  uVar6 = uVar5 * uVar21;
  local_374 = 0;
  local_378 = 0;
  local_368 = uVar21;
  local_350 = param_3;
  local_348 = param_1;
  local_338 = param_2;
  local_358 = (undefined *)malloc((ulonglong)uVar6);
  if ((local_358 != (undefined *)0x0) && (uVar6 != 0)) {
    uVar14 = (ulonglong)uVar6;
    puVar8 = local_358;
    while (uVar14 != 0) {
      uVar14 = uVar14 - 1;
      *puVar8 = 0;
      puVar8 = puVar8 + 1;
    }
  }
  memset(local_2e8,0,200);
  memset(local_218,0,200);
  memset(local_148,0,200);
  piVar11 = *(int **)(param_1 + 0x20);
  iVar19 = piVar11[1];
  iVar22 = *piVar11;
  iVar18 = iVar19 * iVar22 * 2;
  piVar7 = (int *)malloc((longlong)iVar18 + 0x20);
  if (piVar7 != (int *)0x0) {
    piVar7[3] = iVar18;
    *piVar7 = iVar22;
    piVar7[1] = iVar19;
    piVar7[4] = 2;
    piVar7[2] = iVar22 * 2;
    *(int **)(piVar7 + 6) = piVar7 + 8;
    _Memory = piVar7;
  }
  local_360 = piVar11[1];
  local_364 = *piVar11;
  iVar19 = local_364 * local_360;
  _Size = (longlong)local_364 * (longlong)local_360 * 2;
  local_370 = CONCAT44(local_370._4_4_,iVar19);
  puVar8 = (undefined *)malloc(_Size);
  puVar9 = (undefined *)malloc(_Size);
  if ((puVar8 != (undefined *)0x0) && (iVar19 * 2 != 0)) {
    uVar14 = (ulonglong)(uint)(iVar19 * 2);
    puVar15 = puVar8;
    while (uVar14 != 0) {
      uVar14 = uVar14 - 1;
      *puVar15 = 0;
      puVar15 = puVar15 + 1;
    }
  }
  if ((puVar9 != (undefined *)0x0) && (iVar19 * 2 != 0)) {
    uVar14 = (ulonglong)(uint)(iVar19 * 2);
    puVar15 = puVar9;
    while (uVar14 != 0) {
      uVar14 = uVar14 - 1;
      *puVar15 = 0;
      puVar15 = puVar15 + 1;
    }
  }
  lVar20 = (longlong)iVar19;
  if (0 < lVar20) {
    lVar16 = 0;
    do {
      *(ushort *)(puVar8 + lVar16 * 2) =
           (ushort)*(byte *)(lVar16 + *(longlong *)(piVar11 + 6)) * 0xff;
      lVar16 = lVar16 + 1;
      uVar21 = local_368;
    } while (lVar16 < lVar20);
  }
  local_324 = (int)local_370 * 2;
  local_330 = local_364;
  local_328 = local_364 * 2;
  local_310 = local_364;
  local_370 = 0xffffffffffffffff;
  local_32c = local_360;
  local_320 = 2;
  local_30c = local_360;
  local_300 = 2;
  local_318 = puVar8;
  local_308 = local_328;
  local_304 = local_324;
  local_2f8 = puVar9;
  FUN_1800395b0((ulonglong *)&local_330,&local_310,0xffffffffffffffff,8,-1,-1);
  if (0 < lVar20) {
    lVar16 = 0;
    do {
      uVar13 = 0;
      if (0xf9 < *(ushort *)(puVar9 + lVar16 * 2)) {
        uVar13 = 0xff;
      }
      *(undefined *)(lVar16 + *(longlong *)(_Memory + 6)) = uVar13;
      lVar16 = lVar16 + 1;
    } while (lVar16 < lVar20);
  }
  free(puVar8);
  free(puVar9);
  iVar19 = 0;
  if (uVar21 != 0) {
    puVar8 = local_358 + 2;
    do {
      if (2 < (int)(uVar5 - 2)) {
        uVar14 = (ulonglong)(uVar5 - 4);
        lVar20 = 2;
        puVar9 = puVar8;
        do {
          lVar16 = lVar20 >> 1;
          lVar20 = lVar20 + 1;
          *puVar9 = *(undefined *)
                     ((iVar19 >> 1) * *piVar11 + lVar16 + -1 + *(longlong *)(_Memory + 6));
          uVar14 = uVar14 - 1;
          puVar9 = puVar9 + 1;
        } while (uVar14 != 0);
      }
      iVar19 = iVar19 + 1;
      puVar8 = puVar8 + uVar5;
    } while (iVar19 < (int)uVar21);
  }
  FUN_1800141d0((longlong)local_358,local_350,uVar21,uVar5,&local_374,&local_378);
  *(int *)(local_348 + 0x150) = local_374;
  *(int *)(local_348 + 0x14c) = local_378;
  *local_340 = 0;
  if (param_6 == 1) {
    local_48 = in_XMM6;
    uVar21 = *(uint *)(local_338 + 0x1c);
    lVar20 = (longlong)(int)uVar21;
    if (0 < (int)uVar21) {
      plVar12 = (longlong *)(local_338 + 0x28);
      uVar14 = (ulonglong)uVar21;
      lVar16 = 0;
      do {
        lVar1 = *plVar12;
        plVar12 = plVar12 + 1;
        iVar19 = *(int *)(lVar1 + 0x150);
        iVar22 = *(int *)(lVar1 + 0x14c);
        *(int *)((longlong)local_2e8 + lVar16) = iVar22;
        *(int *)((longlong)local_218 + lVar16) = iVar19;
        *(int *)((longlong)local_148 + lVar16) = iVar22 + iVar19;
        uVar14 = uVar14 - 1;
        lVar16 = lVar16 + 4;
      } while (uVar14 != 0);
    }
    iVar18 = 0;
    iVar22 = iVar18;
    iVar19 = 0;
    if ((0 < (int)uVar21) && (iVar22 = 0, iVar19 = 0, 7 < uVar21)) {
      in_XMM2 = in_XMM2 & (undefined  [16])0x0;
      in_XMM1 = in_XMM1 & (undefined  [16])0x0;
      uVar5 = uVar21 & 0x80000007;
      if ((int)uVar5 < 0) {
        uVar5 = (uVar5 - 1 | 0xfffffff8) + 1;
      }
      lVar16 = 0;
      do {
        iVar18 = iVar18 + 8;
        iVar19 = local_2e8[lVar16] + SUB164(in_XMM2,0);
        iVar23 = local_2e8[lVar16 + 1] + SUB164(in_XMM2 >> 0x20,0);
        iVar25 = local_2e8[lVar16 + 2] + SUB164(in_XMM2 >> 0x40,0);
        iVar27 = local_2e8[lVar16 + 3] + SUB164(in_XMM2 >> 0x60,0);
        in_XMM2 = CONCAT412(iVar27,CONCAT48(iVar25,CONCAT44(iVar23,iVar19)));
        piVar11 = local_2d8 + lVar16;
        lVar1 = lVar16 + 1;
        lVar2 = lVar16 + 2;
        lVar3 = lVar16 + 3;
        lVar16 = lVar16 + 8;
        iVar22 = *piVar11 + SUB164(in_XMM1,0);
        iVar24 = local_2d8[lVar1] + SUB164(in_XMM1 >> 0x20,0);
        iVar26 = local_2d8[lVar2] + SUB164(in_XMM1 >> 0x40,0);
        iVar28 = local_2d8[lVar3] + SUB164(in_XMM1 >> 0x60,0);
        in_XMM1 = CONCAT412(iVar28,CONCAT48(iVar26,CONCAT44(iVar24,iVar22)));
      } while (lVar16 < (int)(uVar21 - uVar5));
      iVar26 = iVar26 + iVar25;
      iVar28 = iVar28 + iVar27;
      iVar19 = iVar22 + iVar19 + iVar26 + iVar24 + iVar23 + iVar28;
      in_XMM1 = ZEXT816(CONCAT44(iVar28,iVar26 + iVar28)) << 0x40;
      iVar22 = iVar18;
    }
    iVar18 = 0;
    lVar16 = (longlong)iVar22;
    iVar22 = 0;
    if (lVar16 < lVar20) {
      if (1 < lVar20 - lVar16) {
        do {
          iVar18 = iVar18 + local_2e8[lVar16];
          iVar22 = iVar22 + local_2e8[lVar16 + 1];
          lVar16 = lVar16 + 2;
        } while (lVar16 < lVar20 + -1);
      }
      if (lVar16 < lVar20) {
        iVar19 = iVar19 + local_2e8[lVar16];
      }
      iVar19 = iVar19 + iVar22 + iVar18;
    }
    iVar22 = (int)uVar21 >> 1;
    if (uVar21 != 0) {
      iVar19 = (iVar22 + iVar19) / (int)uVar21;
    }
    iVar24 = 0;
    local_58 = in_XMM7;
    local_68 = in_XMM8;
    iVar23 = iVar24;
    iVar18 = 0;
    if ((0 < (int)uVar21) && (iVar23 = 0, iVar18 = 0, 7 < uVar21)) {
      uVar5 = uVar21 & 0x80000007;
      if ((int)uVar5 < 0) {
        uVar5 = (uVar5 - 1 | 0xfffffff8) + 1;
      }
      in_XMM8 = in_XMM8 & (undefined  [16])0x0;
      in_XMM7 = in_XMM7 & (undefined  [16])0x0;
      in_XMM2 = in_XMM5 & (undefined  [16])0x0;
      pauVar10 = (undefined (*) [16])local_2d8;
      do {
        iVar24 = iVar24 + 8;
        uVar36 = *(int *)pauVar10[-1] - iVar19;
        uVar37 = *(int *)(pauVar10[-1] + 4) - iVar19;
        uVar38 = *(int *)(pauVar10[-1] + 8) - iVar19;
        uVar39 = *(int *)(pauVar10[-1] + 0xc) - iVar19;
        uVar6 = -(uint)(0 < (int)uVar36);
        uVar33 = -(uint)(0 < (int)uVar37);
        iVar27 = SUB164(in_XMM8 >> 0x40,0);
        uVar34 = -(uint)(iVar27 < (int)uVar38);
        uVar35 = -(uint)(0 < (int)uVar39);
        iVar26 = (~uVar6 & iVar19 - *(int *)pauVar10[-1] | uVar6 & uVar36) + SUB164(in_XMM7,0);
        iVar28 = (~uVar33 & iVar19 - *(int *)(pauVar10[-1] + 4) | uVar33 & uVar37) +
                 SUB164(in_XMM7 >> 0x20,0);
        iVar30 = (~uVar34 & iVar19 - *(int *)(pauVar10[-1] + 8) | uVar34 & uVar38) +
                 SUB164(in_XMM7 >> 0x40,0);
        iVar31 = (~uVar35 & iVar19 - *(int *)(pauVar10[-1] + 0xc) | uVar35 & uVar39) +
                 SUB164(in_XMM7 >> 0x60,0);
        in_XMM7 = CONCAT412(iVar31,CONCAT48(iVar30,CONCAT44(iVar28,iVar26)));
        in_XMM1 = *pauVar10;
        iVar18 = SUB164(in_XMM1 >> 0x20,0);
        iVar23 = SUB164(in_XMM1 >> 0x40,0);
        iVar25 = SUB164(in_XMM1 >> 0x60,0);
        uVar36 = SUB164(in_XMM1,0) - iVar19;
        uVar37 = iVar18 - iVar19;
        uVar38 = iVar23 - iVar19;
        uVar39 = iVar25 - iVar19;
        uVar6 = -(uint)(0 < (int)uVar36);
        uVar33 = -(uint)(0 < (int)uVar37);
        uVar34 = -(uint)(iVar27 < (int)uVar38);
        uVar35 = -(uint)(0 < (int)uVar39);
        iVar27 = (~uVar6 & iVar19 - SUB164(in_XMM1,0) | uVar6 & uVar36) + SUB164(in_XMM2,0);
        iVar18 = (~uVar33 & iVar19 - iVar18 | uVar33 & uVar37) + SUB164(in_XMM2 >> 0x20,0);
        iVar23 = (~uVar34 & iVar19 - iVar23 | uVar34 & uVar38) + SUB164(in_XMM2 >> 0x40,0);
        iVar25 = (~uVar35 & iVar19 - iVar25 | uVar35 & uVar39) + SUB164(in_XMM2 >> 0x60,0);
        in_XMM2 = CONCAT412(iVar25,CONCAT48(iVar23,CONCAT44(iVar18,iVar27)));
        pauVar10 = pauVar10[2];
      } while (iVar24 < (int)(uVar21 - uVar5));
      iVar23 = iVar23 + iVar30;
      iVar25 = iVar25 + iVar31;
      iVar18 = iVar27 + iVar26 + iVar23 + iVar18 + iVar28 + iVar25;
      in_XMM5 = ZEXT816(CONCAT44(iVar25,iVar23 + iVar25)) << 0x40;
      iVar23 = iVar24;
    }
    lVar16 = (longlong)iVar23;
    while (lVar16 < lVar20) {
      iVar23 = local_2e8[lVar16] - iVar19;
      if (iVar23 < 1) {
        iVar23 = iVar19 - local_2e8[lVar16];
      }
      lVar16 = lVar16 + 1;
      iVar18 = iVar18 + iVar23;
    }
    if (uVar21 != 0) {
      iVar18 = (iVar22 + iVar18) / (int)uVar21;
    }
    iVar23 = 0;
    iVar25 = 0;
    iVar24 = iVar25;
    if ((0 < (int)uVar21) && (iVar24 = 0, 7 < uVar21)) {
      in_XMM2 = in_XMM2 & (undefined  [16])0x0;
      in_XMM1 = in_XMM1 & (undefined  [16])0x0;
      uVar5 = uVar21 & 0x80000007;
      if ((int)uVar5 < 0) {
        uVar5 = (uVar5 - 1 | 0xfffffff8) + 1;
      }
      lVar16 = 0;
      do {
        iVar25 = iVar25 + 8;
        iVar23 = local_218[lVar16] + SUB164(in_XMM2,0);
        iVar26 = local_218[lVar16 + 1] + SUB164(in_XMM2 >> 0x20,0);
        iVar28 = local_218[lVar16 + 2] + SUB164(in_XMM2 >> 0x40,0);
        iVar31 = local_218[lVar16 + 3] + SUB164(in_XMM2 >> 0x60,0);
        in_XMM2 = CONCAT412(iVar31,CONCAT48(iVar28,CONCAT44(iVar26,iVar23)));
        lVar1 = lVar16 + 4;
        lVar2 = lVar16 + 5;
        lVar3 = lVar16 + 6;
        lVar4 = lVar16 + 7;
        lVar16 = lVar16 + 8;
        iVar24 = local_218[lVar1] + SUB164(in_XMM1,0);
        iVar27 = local_218[lVar2] + SUB164(in_XMM1 >> 0x20,0);
        iVar30 = local_218[lVar3] + SUB164(in_XMM1 >> 0x40,0);
        iVar29 = local_218[lVar4] + SUB164(in_XMM1 >> 0x60,0);
        in_XMM1 = CONCAT412(iVar29,CONCAT48(iVar30,CONCAT44(iVar27,iVar24)));
      } while (lVar16 < (int)(uVar21 - uVar5));
      iVar23 = iVar24 + iVar23 + iVar30 + iVar28 + iVar27 + iVar26 + iVar29 + iVar31;
      iVar24 = iVar25;
    }
    iVar25 = 0;
    lVar16 = (longlong)iVar24;
    iVar24 = 0;
    if (lVar16 < lVar20) {
      if (1 < lVar20 - lVar16) {
        do {
          iVar25 = iVar25 + local_218[lVar16];
          iVar24 = iVar24 + local_218[lVar16 + 1];
          lVar16 = lVar16 + 2;
        } while (lVar16 < lVar20 + -1);
      }
      if (lVar16 < lVar20) {
        iVar23 = iVar23 + local_218[lVar16];
      }
      iVar23 = iVar23 + iVar24 + iVar25;
    }
    if (uVar21 != 0) {
      iVar23 = (iVar22 + iVar23) / (int)uVar21;
    }
    iVar26 = 0;
    iVar25 = iVar26;
    iVar24 = 0;
    if ((0 < (int)uVar21) && (iVar25 = 0, iVar24 = 0, 7 < uVar21)) {
      uVar5 = uVar21 & 0x80000007;
      if ((int)uVar5 < 0) {
        uVar5 = (uVar5 - 1 | 0xfffffff8) + 1;
      }
      in_XMM8 = in_XMM8 & (undefined  [16])0x0;
      in_XMM5 = in_XMM5 & (undefined  [16])0x0;
      piVar11 = local_218 + 4;
      do {
        iVar26 = iVar26 + 8;
        uVar36 = piVar11[-4] - iVar23;
        uVar37 = piVar11[-3] - iVar23;
        uVar38 = piVar11[-2] - iVar23;
        uVar39 = piVar11[-1] - iVar23;
        uVar6 = -(uint)(0 < (int)uVar36);
        uVar33 = -(uint)(0 < (int)uVar37);
        uVar34 = -(uint)(0 < (int)uVar38);
        uVar35 = -(uint)(0 < (int)uVar39);
        iVar24 = (~uVar6 & iVar23 - piVar11[-4] | uVar6 & uVar36) + SUB164(in_XMM8,0);
        iVar27 = (~uVar33 & iVar23 - piVar11[-3] | uVar33 & uVar37) + SUB164(in_XMM8 >> 0x20,0);
        iVar30 = (~uVar34 & iVar23 - piVar11[-2] | uVar34 & uVar38) + SUB164(in_XMM8 >> 0x40,0);
        iVar29 = (~uVar35 & iVar23 - piVar11[-1] | uVar35 & uVar39) + SUB164(in_XMM8 >> 0x60,0);
        in_XMM8 = CONCAT412(iVar29,CONCAT48(iVar30,CONCAT44(iVar27,iVar24)));
        uVar36 = *piVar11 - iVar23;
        uVar37 = piVar11[1] - iVar23;
        uVar38 = piVar11[2] - iVar23;
        uVar39 = piVar11[3] - iVar23;
        uVar6 = -(uint)(0 < (int)uVar36);
        uVar33 = -(uint)(0 < (int)uVar37);
        uVar34 = -(uint)(0 < (int)uVar38);
        uVar35 = -(uint)(0 < (int)uVar39);
        iVar25 = (~uVar6 & iVar23 - *piVar11 | uVar6 & uVar36) + SUB164(in_XMM5,0);
        iVar28 = (~uVar33 & iVar23 - piVar11[1] | uVar33 & uVar37) + SUB164(in_XMM5 >> 0x20,0);
        iVar31 = (~uVar34 & iVar23 - piVar11[2] | uVar34 & uVar38) + SUB164(in_XMM5 >> 0x40,0);
        iVar32 = (~uVar35 & iVar23 - piVar11[3] | uVar35 & uVar39) + SUB164(in_XMM5 >> 0x60,0);
        in_XMM5 = CONCAT412(iVar32,CONCAT48(iVar31,CONCAT44(iVar28,iVar25)));
        piVar11 = piVar11 + 8;
      } while (iVar26 < (int)(uVar21 - uVar5));
      iVar24 = iVar25 + iVar24 + iVar31 + iVar30 + iVar28 + iVar27 + iVar32 + iVar29;
      iVar25 = iVar26;
    }
    lVar16 = (longlong)iVar25;
    while (lVar16 < lVar20) {
      iVar25 = local_218[lVar16] - iVar23;
      if (iVar25 < 1) {
        iVar25 = iVar23 - local_218[lVar16];
      }
      lVar16 = lVar16 + 1;
      iVar24 = iVar24 + iVar25;
    }
    if (((uVar21 != 0) && (iVar24 = (iVar22 + iVar24) / (int)uVar21, 0 < (int)uVar21)) &&
       (7 < uVar21)) {
      uVar5 = uVar21 & 0x80000007;
      if ((int)uVar5 < 0) {
        uVar5 = (uVar5 - 1 | 0xfffffff8) + 1;
      }
      lVar20 = 0;
      do {
        lVar20 = lVar20 + 8;
      } while (lVar20 < (int)(uVar21 - uVar5));
    }
    *local_340 = 0;
    iVar22 = iVar19 / 6 + (iVar19 >> 0x1f);
    uVar17 = *local_340;
    uVar21 = local_378 - iVar19 >> 0x1f;
    if (((iVar22 >> 1) + iVar18 * 3) - (iVar22 >> 0x1f) <
        (int)((local_378 - iVar19 ^ uVar21) - uVar21)) {
      uVar17 = 1;
    }
    iVar19 = iVar23 / 6 + (iVar23 >> 0x1f);
    uVar21 = local_374 - iVar23 >> 0x1f;
    if (((iVar19 >> 1) + iVar24 * 3) - (iVar19 >> 0x1f) <
        (int)((local_374 - iVar23 ^ uVar21) - uVar21)) {
      uVar17 = 1;
    }
    iVar19 = 0;
    *local_340 = uVar17;
    if (0 < *(int *)(local_338 + 0x1c)) {
      plVar12 = (longlong *)(local_338 + 0x28);
      do {
        if ((*(int *)(*plVar12 + 0x150) == 0) || (*(int *)(*plVar12 + 0x14c) == 0)) {
          *local_340 = 0;
        }
        iVar19 = iVar19 + 1;
        plVar12 = plVar12 + 1;
      } while (iVar19 < *(int *)(local_338 + 0x1c));
    }
  }
  free(local_358);
  if (_Memory != (int *)0x0) {
    free(_Memory);
  }
  FUN_18005f100(local_78 ^ (ulonglong)&stack0xfffffffffffffc58);
  return;
}



undefined8
FUN_180014e10(ulonglong param_1,undefined8 param_2,uint param_3,ulonglong param_4,ulonglong param_5,
             undefined8 param_6,undefined4 *param_7,int param_8)

{
  ulonglong uVar1;

  *param_7 = 0;
  FUN_1800144b0(param_4);
  if ((param_8 == 1) &&
     (uVar1 = FUN_18003b0b0(param_1,param_5,(ulonglong)param_3,param_4), (int)uVar1 == 0)) {
    *param_7 = 1;
  }
  return 0;
}



void FUN_180014eb0(longlong param_1,longlong param_2,undefined *param_3,int param_4)

{
  int iVar1;
  longlong lVar2;
  longlong lVar3;
  undefined *puVar4;
  longlong lVar5;
  ulonglong uVar6;
  short sVar7;
  int iVar8;
  undefined8 unaff_RBX;
  undefined8 unaff_RBP;
  int iVar9;
  short *psVar10;
  longlong lVar11;
  uint uVar12;
  longlong lVar13;
  undefined *puVar14;
  int iVar15;
  undefined8 unaff_R12;
  undefined8 unaff_R13;
  undefined8 unaff_R14;
  undefined8 unaff_R15;
  short *psVar16;
  longlong alStackX8 [3];
  undefined auStackX32 [8];
  undefined8 uStack24;

  uStack24 = 0x180014ebd;
  lVar2 = _alloca_probe();
  lVar2 = -lVar2;
  *(ulonglong *)(&stack0x00009940 + lVar2) =
       DAT_1800b04e8 ^ (ulonglong)(&stack0xfffffffffffffff0 + lVar2);
  iVar9 = *(int *)(&stack0x000099a8 + lVar2);
  *(undefined8 *)(&stack0x00009980 + lVar2) = unaff_RBX;
  iVar15 = 0;
  *(undefined8 *)(&stack0x00009988 + lVar2) = unaff_RBP;
  iVar8 = 0;
  iVar1 = *(int *)(&stack0x000099a0 + lVar2);
  *(undefined8 *)(&stack0x00009960 + lVar2) = unaff_R13;
  *(undefined8 *)(&stack0x00009958 + lVar2) = unaff_R14;
  *(undefined **)((longlong)alStackX8 + lVar2) = param_3;
  uVar12 = param_4 + iVar9 * -2;
  *(undefined8 *)(&stack0x00009950 + lVar2) = unaff_R15;
  *(int *)(&stack0xfffffffffffffff4 + lVar2) = iVar1;
  *(uint *)(&stack0xfffffffffffffff0 + lVar2) = uVar12;
  lVar3 = (longlong)((iVar1 + 1) * iVar9);
  *(longlong *)((longlong)alStackX8 + lVar2 + 8) = lVar3;
  puVar14 = auStackX32 + lVar3 * 2 + lVar2;
  psVar16 = (short *)(param_2 + lVar3 * 2);
  lVar3 = param_1 + lVar3 * 2;
  *(undefined **)(&stack0xfffffffffffffff8 + lVar2) = puVar14;
  if ((param_3 != (undefined *)0x0) && (iVar1 * param_4 != 0)) {
    uVar6 = (ulonglong)(uint)(iVar1 * param_4);
    while (uVar6 != 0) {
      uVar6 = uVar6 - 1;
      *param_3 = 1;
      param_3 = param_3 + 1;
    }
  }
  lVar11 = (longlong)(iVar1 + iVar9 * -2);
  if (0 < (int)uVar12) {
    *(undefined8 *)(&stack0x00009998 + lVar2) = unaff_R12;
    uVar6 = (ulonglong)uVar12;
    lVar5 = (longlong)iVar1 * 2;
    *(ulonglong *)(auStackX32 + lVar2 + -0x20) = uVar6;
    puVar4 = puVar14;
    do {
      if (0 < lVar11) {
        psVar10 = psVar16;
        lVar13 = lVar11;
        do {
          sVar7 = *(short *)((longlong)psVar10 + (lVar3 - (longlong)psVar16));
          uVar12 = (int)*psVar10 - (int)sVar7;
          if ((int)uVar12 < 1) {
            uVar12 = (uint)(ushort)(sVar7 - *psVar10);
          }
          sVar7 = (short)uVar12;
          *(short *)(puVar4 + -(longlong)psVar16 + (longlong)psVar10) = sVar7;
          if (0x32 < sVar7) {
            iVar15 = iVar15 + 1;
            iVar8 = iVar8 + sVar7;
          }
          psVar10 = psVar10 + 1;
          lVar13 = lVar13 + -1;
        } while (lVar13 != 0);
        puVar4 = *(undefined **)(&stack0xfffffffffffffff8 + lVar2);
        uVar6 = *(ulonglong *)(auStackX32 + lVar2 + -0x20);
      }
      puVar4 = puVar4 + lVar5;
      psVar16 = psVar16 + iVar1;
      lVar3 = lVar3 + lVar5;
      *(undefined **)(&stack0xfffffffffffffff8 + lVar2) = puVar4;
      uVar6 = uVar6 - 1;
      *(ulonglong *)(auStackX32 + lVar2 + -0x20) = uVar6;
    } while (uVar6 != 0);
    if (0 < iVar15) {
      iVar8 = iVar8 / (iVar15 * 0x14);
      goto LAB_180015021;
    }
  }
  iVar8 = 5;
LAB_180015021:
  iVar9 = 5;
  if (5 < iVar8) {
    iVar9 = iVar8;
  }
  lVar3 = *(longlong *)((longlong)alStackX8 + lVar2 + 8) +
          *(longlong *)((longlong)alStackX8 + lVar2);
  if (0 < (int)*(uint *)(&stack0xfffffffffffffff0 + lVar2)) {
    iVar1 = *(int *)(&stack0xfffffffffffffff4 + lVar2);
    uVar6 = (ulonglong)*(uint *)(&stack0xfffffffffffffff0 + lVar2);
    do {
      lVar5 = 0;
      if (0 < lVar11) {
        do {
          *(bool *)(lVar5 + lVar3) = iVar9 <= *(short *)(puVar14 + lVar5 * 2);
          lVar5 = lVar5 + 1;
        } while (lVar5 < lVar11);
      }
      lVar3 = lVar3 + iVar1;
      puVar14 = puVar14 + (longlong)iVar1 * 2;
      uVar6 = uVar6 - 1;
    } while (uVar6 != 0);
  }
  *(undefined8 *)((longlong)&uStack24 + lVar2) = 0x1800150b1;
  FUN_18005f100(*(ulonglong *)(&stack0x00009940 + lVar2) ^
                (ulonglong)(&stack0xfffffffffffffff0 + lVar2),
                *(undefined *)((longlong)&uStack24 + lVar2));
  return;
}



void FUN_1800150c0(undefined8 param_1,ushort *param_2,longlong param_3,undefined8 param_4)

{
  ushort uVar1;
  uint *puVar2;
  short *psVar3;
  short sVar4;
  longlong lVar5;
  void *pvVar6;
  uint *_Memory;
  longlong lVar7;
  ulonglong uVar8;
  short *psVar9;
  uint uVar10;
  longlong lVar11;
  uint uVar12;
  ulonglong uVar13;
  ulonglong uVar14;
  uint uVar15;
  undefined *puVar16;
  ushort **ppuVar18;
  short sVar19;
  longlong lVar20;
  undefined4 uVar21;
  uint uVar22;
  longlong lVar23;
  int iVar24;
  int iVar25;
  int iVar26;
  int iVar27;
  int iVar28;
  int iVar29;
  int iVar30;
  int iVar31;
  undefined in_XMM1 [16];
  undefined in_XMM2 [16];
  undefined8 local_res8;
  ushort *local_res10;
  longlong local_res18;
  undefined8 local_res20;
  undefined8 uStack72;
  ulonglong uVar17;

  uStack72 = 0x1800150ea;
  local_res8 = param_1;
  local_res10 = param_2;
  local_res18 = param_3;
  local_res20 = param_4;
  lVar5 = _alloca_probe();
  lVar5 = -lVar5;
  uVar15 = *(uint *)(&stack0x000099a0 + lVar5);
  uVar14 = (ulonglong)uVar15;
  uVar13 = 0;
  uVar22 = *(uint *)(&stack0x000099a8 + lVar5);
  lVar23 = (longlong)(int)uVar22;
  uVar12 = 0;
  *(undefined4 *)(&stack0x000099a0 + lVar5) = 0;
  *(uint *)(&stack0xffffffffffffffe0 + lVar5) = uVar15 * uVar22;
  *(undefined8 *)((longlong)&uStack72 + lVar5) = 0x180015125;
  pvVar6 = malloc((longlong)(int)uVar15 << 2,*(undefined *)((longlong)&uStack72 + lVar5));
  *(void **)(&stack0xfffffffffffffff0 + lVar5) = pvVar6;
  *(undefined8 *)((longlong)&uStack72 + lVar5) = 0x180015138;
  _Memory = (uint *)malloc(lVar23 * 4,*(undefined *)((longlong)&uStack72 + lVar5));
  sVar19 = 300;
  if (*(int *)(&stack0x000099b8 + lVar5) == 0) {
    puVar16 = *(undefined **)(&stack0x00009998 + lVar5);
    sVar19 = 700;
    *(undefined4 *)(&stack0xffffffffffffffe8 + lVar5) = 700;
    if ((puVar16 != (undefined *)0x0) &&
       (uVar8 = (ulonglong)*(uint *)(&stack0xffffffffffffffe0 + lVar5),
       *(uint *)(&stack0xffffffffffffffe0 + lVar5) != 0)) {
      while (uVar8 != 0) {
        uVar8 = uVar8 - 1;
        *puVar16 = 0;
        puVar16 = puVar16 + 1;
      }
      param_2 = *(ushort **)(&stack0x00009988 + lVar5);
    }
    if (0 < (int)uVar15) {
      *(undefined8 *)(&stack0x00000000 + lVar5) = *(undefined8 *)(&stack0xfffffffffffffff0 + lVar5);
      *(ushort **)(&stack0xfffffffffffffff8 + lVar5) = param_2;
      do {
        uVar8 = uVar13;
        if (0 < (int)uVar22) {
          do {
            uVar1 = *param_2;
            param_2 = param_2 + 1;
            _Memory[uVar8] = (uint)uVar1;
            uVar8 = uVar8 + 1;
          } while ((longlong)uVar8 < lVar23);
        }
        *(undefined8 *)((longlong)&uStack72 + lVar5) = 0x1800151dd;
        FUN_180028120(_Memory,uVar22,*(undefined *)((longlong)&uStack72 + lVar5));
        lVar7 = lVar23 + -0x14;
        iVar24 = 0;
        if ((int)(uVar22 - 0x14) < (int)uVar22) {
          in_XMM2 = in_XMM2 & (undefined  [16])0x0;
          lVar7 = lVar23 + -0x14;
          in_XMM1 = in_XMM1 & (undefined  [16])0x0;
          do {
            puVar2 = _Memory + lVar7;
            iVar24 = *puVar2 + SUB164(in_XMM2,0);
            iVar26 = puVar2[1] + SUB164(in_XMM2 >> 0x20,0);
            iVar28 = puVar2[2] + SUB164(in_XMM2 >> 0x40,0);
            iVar30 = puVar2[3] + SUB164(in_XMM2 >> 0x60,0);
            in_XMM2 = CONCAT412(iVar30,CONCAT48(iVar28,CONCAT44(iVar26,iVar24)));
            puVar2 = _Memory + lVar7 + 4;
            lVar7 = lVar7 + 8;
            iVar25 = *puVar2 + SUB164(in_XMM1,0);
            iVar27 = puVar2[1] + SUB164(in_XMM1 >> 0x20,0);
            iVar29 = puVar2[2] + SUB164(in_XMM1 >> 0x40,0);
            iVar31 = puVar2[3] + SUB164(in_XMM1 >> 0x60,0);
            in_XMM1 = CONCAT412(iVar31,CONCAT48(iVar29,CONCAT44(iVar27,iVar25)));
          } while (lVar7 < (int)(uVar22 - 4));
          iVar29 = iVar29 + iVar28;
          iVar31 = iVar31 + iVar30;
          iVar24 = iVar25 + iVar24 + iVar29 + iVar27 + iVar26 + iVar31;
          in_XMM1 = ZEXT816(CONCAT44(iVar31,iVar29 + iVar31)) << 0x40;
        }
        if (lVar7 < lVar23) {
          uVar15 = uVar12;
          uVar10 = uVar12;
          if (1 < lVar23 - lVar7) {
            uVar8 = uVar13;
            uVar17 = uVar13;
            do {
              uVar10 = (int)uVar8 + _Memory[lVar7];
              uVar8 = (ulonglong)uVar10;
              uVar15 = (int)uVar17 + _Memory[lVar7 + 1];
              uVar17 = (ulonglong)uVar15;
              lVar7 = lVar7 + 2;
            } while (lVar7 < lVar23 + -1);
          }
          if (lVar7 < lVar23) {
            iVar24 = iVar24 + _Memory[lVar7];
          }
          iVar24 = iVar24 + uVar15 + uVar10;
        }
        uVar15 = (uint)(iVar24 * 0x13) / 400;
        uVar10 = 0x9c4;
        if (0x9c4 < uVar15) {
          uVar10 = uVar15;
        }
        puVar2 = *(uint **)(&stack0x00000000 + lVar5);
        *puVar2 = uVar10;
        param_2 = (ushort *)(*(longlong *)(&stack0xfffffffffffffff8 + lVar5) + lVar23 * 2);
        *(uint **)(&stack0x00000000 + lVar5) = puVar2 + 1;
        *(ushort **)(&stack0xfffffffffffffff8 + lVar5) = param_2;
        uVar14 = uVar14 - 1;
      } while (uVar14 != 0);
      param_3 = *(longlong *)(&stack0x00009990 + lVar5);
      sVar19 = (short)*(undefined4 *)(&stack0xffffffffffffffe8 + lVar5);
    }
  }
  uVar15 = 0;
  lVar23 = (longlong)*(int *)(&stack0xffffffffffffffe0 + lVar5);
  psVar3 = *(short **)(&stack0x00009988 + lVar5);
  if (*(int *)(&stack0x000099b0 + lVar5) == 0) {
    if (lVar23 < 1) goto LAB_18001539c;
    lVar7 = *(longlong *)(&stack0x00009980 + lVar5);
    psVar9 = psVar3;
    lVar11 = lVar23;
    uVar14 = uVar13;
    uVar8 = uVar13;
    do {
      sVar4 = *(short *)((longlong)psVar9 + (lVar7 - (longlong)psVar3)) - *psVar9;
      *(short *)((longlong)psVar9 + (longlong)&local_res10 + (lVar5 - (longlong)psVar3)) = sVar4;
      if (sVar19 < sVar4) {
        uVar8 = (ulonglong)((int)uVar8 + 1);
        uVar14 = (ulonglong)(uint)((int)uVar14 + (int)sVar4);
      }
      uVar15 = (uint)uVar8;
      uVar21 = (undefined4)uVar14;
      psVar9 = psVar9 + 1;
      lVar11 = lVar11 + -1;
    } while (lVar11 != 0);
    param_3 = *(longlong *)(&stack0x00009990 + lVar5);
  }
  else {
    uVar15 = uVar12;
    if (lVar23 < 1) goto LAB_18001539c;
    lVar7 = *(longlong *)(&stack0x00009980 + lVar5);
    psVar9 = psVar3;
    lVar11 = lVar23;
    uVar14 = uVar13;
    uVar8 = uVar13;
    do {
      sVar4 = *psVar9 - *(short *)((lVar7 - (longlong)psVar3) + (longlong)psVar9);
      *(short *)((longlong)&local_res10 + (lVar5 - (longlong)psVar3) + (longlong)psVar9) = sVar4;
      if (sVar19 < sVar4) {
        uVar8 = (ulonglong)((int)uVar8 + 1);
        uVar14 = (ulonglong)(uint)((int)uVar14 + (int)sVar4);
      }
      uVar15 = (uint)uVar8;
      uVar21 = (undefined4)uVar14;
      psVar9 = psVar9 + 1;
      lVar11 = lVar11 + -1;
    } while (lVar11 != 0);
  }
  *(undefined4 *)(&stack0x000099a0 + lVar5) = uVar21;
  uVar22 = *(uint *)(&stack0x000099a8 + lVar5);
LAB_18001539c:
  if (*(int *)(&stack0x000099b8 + lVar5) == 0) {
    if ((int)uVar15 < 1) {
      iVar24 = 700;
    }
    else {
      iVar25 = (*(int *)(&stack0x000099a0 + lVar5) * 0x17) / (int)(uVar15 * 0x32);
      iVar24 = iVar25;
      if (((int)uVar15 <= (int)(uVar22 * 10)) && (iVar24 = 700, 700 < iVar25)) {
        iVar24 = iVar25;
      }
    }
    if (0 < lVar23) {
      lVar7 = *(longlong *)(&stack0x00009998 + lVar5);
      lVar11 = *(longlong *)(&stack0xfffffffffffffff0 + lVar5);
      ppuVar18 = (ushort **)((longlong)&local_res10 + lVar5);
      lVar20 = param_3;
      do {
        puVar2 = (uint *)(lVar11 + (longlong)((int)uVar13 / (int)uVar22) * 4);
        uVar15 = (uint)*(ushort *)
                        ((longlong)psVar3 + (-2 - (longlong)((longlong)&local_res10 + lVar5)) +
                        (longlong)(ushort **)((longlong)ppuVar18 + 2));
        *(bool *)((lVar7 - param_3) + -1 + lVar20 + 1) = *puVar2 <= uVar15 && uVar15 != *puVar2;
        uVar13 = (ulonglong)((int)uVar13 + 1);
        *(bool *)lVar20 = iVar24 <= *(short *)ppuVar18;
        lVar23 = lVar23 + -1;
        ppuVar18 = (ushort **)((longlong)ppuVar18 + 2);
        lVar20 = lVar20 + 1;
      } while (lVar23 != 0);
    }
  }
  else {
    if ((int)uVar15 < 1) {
      iVar24 = 300;
    }
    else {
      iVar25 = *(int *)(&stack0x000099a0 + lVar5) / (int)(uVar15 * 5);
      iVar24 = iVar25;
      if (((int)uVar15 <= (int)(uVar22 * 10)) && (iVar24 = 300, 300 < iVar25)) {
        iVar24 = iVar25;
      }
    }
    if (0 < lVar23) {
      do {
        *(bool *)(uVar13 + param_3) =
             iVar24 <= *(short *)((longlong)&local_res10 + uVar13 * 2 + lVar5);
        uVar13 = uVar13 + 1;
      } while ((longlong)uVar13 < lVar23);
    }
  }
  *(undefined8 *)((longlong)&uStack72 + lVar5) = 0x1800154b7;
  free(*(void **)(&stack0xfffffffffffffff0 + lVar5),*(undefined *)((longlong)&uStack72 + lVar5));
                    // WARNING: Could not recover jumptable at 0x0001800154cd. Too many branches
                    // WARNING: Treating indirect jump as call
  free(_Memory,(&stack0x00009978)[lVar5]);
  return;
}



void FUN_1800154e0(char *param_1,undefined *param_2,char *param_3,undefined *param_4,char *param_5,
                  uint param_6,uint param_7)

{
  char cVar1;
  char cVar2;
  longlong lVar3;
  ulonglong uVar4;
  char *pcVar5;
  undefined *puVar6;
  char *pcVar7;
  uint uVar8;
  char *pcVar9;
  char *pcVar10;
  ulonglong uVar11;

  uVar11 = (ulonglong)param_6;
  uVar8 = param_6 * param_7;
  if ((param_1 != (char *)0x0) && (uVar8 != 0)) {
    uVar4 = (ulonglong)uVar8;
    pcVar9 = param_1;
    while (uVar4 != 0) {
      uVar4 = uVar4 - 1;
      *pcVar9 = '\0';
      pcVar9 = pcVar9 + 1;
    }
  }
  if ((param_2 != (undefined *)0x0) && (uVar8 != 0)) {
    uVar4 = (ulonglong)uVar8;
    puVar6 = param_2;
    while (uVar4 != 0) {
      uVar4 = uVar4 - 1;
      *puVar6 = 0;
      puVar6 = puVar6 + 1;
    }
  }
  if ((param_3 != (char *)0x0) && (uVar8 != 0)) {
    uVar4 = (ulonglong)uVar8;
    pcVar9 = param_3;
    while (uVar4 != 0) {
      uVar4 = uVar4 - 1;
      *pcVar9 = '\0';
      pcVar9 = pcVar9 + 1;
    }
  }
  if ((param_4 != (undefined *)0x0) && (uVar8 != 0)) {
    uVar4 = (ulonglong)uVar8;
    puVar6 = param_4;
    while (uVar4 != 0) {
      uVar4 = uVar4 - 1;
      *puVar6 = 0;
      puVar6 = puVar6 + 1;
    }
  }
  lVar3 = (longlong)(int)uVar8;
  pcVar5 = param_2 + lVar3 + -1;
  pcVar7 = param_5 + lVar3 + -1;
  pcVar9 = param_5;
  pcVar10 = pcVar7;
  if (0 < (int)param_6) {
    do {
      if (1 < (int)param_7) {
        uVar4 = (ulonglong)(param_7 - 1);
        do {
          cVar1 = *pcVar9;
          pcVar9 = pcVar9 + 1;
          param_1[1] = cVar1 + *param_1;
          param_1 = param_1 + 1;
          cVar1 = *pcVar10;
          pcVar10 = pcVar10 + -1;
          pcVar5[-1] = cVar1 + *pcVar5;
          pcVar5 = pcVar5 + -1;
          uVar4 = uVar4 - 1;
        } while (uVar4 != 0);
      }
      param_1 = param_1 + 1;
      pcVar5 = pcVar5 + -1;
      uVar11 = uVar11 - 1;
      pcVar9 = pcVar9 + 1;
      pcVar10 = pcVar10 + -1;
    } while (uVar11 != 0);
  }
  pcVar9 = param_4 + lVar3 + -1;
  if (1 < (int)param_6) {
    uVar11 = (ulonglong)(param_6 - 1);
    do {
      if (0 < (int)param_7) {
        uVar4 = (ulonglong)param_7;
        do {
          cVar1 = *param_5;
          param_5 = param_5 + 1;
          param_3[(int)param_7] = *param_3 + cVar1;
          cVar2 = *pcVar7;
          pcVar10 = pcVar9 + -(longlong)(int)param_7;
          cVar1 = *pcVar9;
          param_3 = param_3 + 1;
          pcVar7 = pcVar7 + -1;
          pcVar9 = pcVar9 + -1;
          *pcVar10 = cVar2 + cVar1;
          uVar4 = uVar4 - 1;
        } while (uVar4 != 0);
      }
      uVar11 = uVar11 - 1;
    } while (uVar11 != 0);
  }
  return;
}



void FUN_180015830(longlong param_1,longlong param_2,byte *param_3,int *param_4)

{
  undefined4 uVar1;
  void *_Memory;
  void *_Memory_00;
  longlong lVar2;
  byte bVar3;
  uint uVar4;
  longlong lVar5;
  byte *_Memory_01;
  undefined *_Memory_02;
  char *_Memory_03;
  undefined *puVar6;
  ulonglong uVar7;
  byte *pbVar8;
  uint uVar9;
  undefined8 unaff_RBP;
  uint uVar10;
  undefined8 unaff_RSI;
  undefined8 unaff_R13;
  uint uVar11;
  undefined8 unaff_R14;
  uint auStackX8 [6];
  void *pvStackX32;
  undefined8 uStack40;

  uStack40 = 0x180015841;
  lVar5 = _alloca_probe();
  lVar5 = -lVar5;
  *(ulonglong *)(&stack0x00004cc0 + lVar5) =
       DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffe0 + lVar5);
  if ((((param_1 != 0) && (param_2 != 0)) && (param_3 != (byte *)0x0)) && (param_4 != (int *)0x0)) {
    *(undefined8 *)(&stack0x00004cf0 + lVar5) = unaff_RBP;
    *(undefined8 *)(&stack0x00004ce8 + lVar5) = unaff_RSI;
    uVar4 = *(uint *)(&stack0x00004d40 + lVar5);
    *(undefined8 *)(&stack0x00004ce0 + lVar5) = unaff_R13;
    *(undefined8 *)(&stack0x00004cd8 + lVar5) = unaff_R14;
    uVar9 = (int)uVar4 >> 0xe & 0x1ff;
    *(uint *)((longlong)&pvStackX32 + lVar5) = uVar4 & 1;
    uVar11 = uVar4 >> 0x17;
    uVar10 = (int)uVar4 >> 3 & 0x3f;
    *(undefined8 *)((longlong)&uStack40 + lVar5) = 0x1800158eb;
    memset(&stack0x00000030 + lVar5,0,0x4c90,*(undefined *)((longlong)&uStack40 + lVar5));
    if (uVar10 - 0x3e < 2) {
      uVar1 = *(undefined4 *)((longlong)&pvStackX32 + lVar5);
      *(uint *)((longlong)auStackX8 + lVar5 + 0x10) = (int)uVar4 >> 2 & 1;
      *(undefined4 *)((longlong)auStackX8 + lVar5 + 8) = uVar1;
      *(uint *)((longlong)auStackX8 + lVar5) = uVar11;
      *(uint *)((longlong)&pvStackX32 + lVar5 + -0x20) = uVar9;
      *(undefined8 *)((longlong)&uStack40 + lVar5) = 0x1800159d1;
      FUN_1800150c0(param_1,param_2,&stack0x00000030 + lVar5,param_3);
      uVar4 = uVar9 * uVar11;
      uVar7 = (ulonglong)uVar4;
      *(undefined8 *)((longlong)&uStack40 + lVar5) = 0x1800159e1;
      _Memory_01 = (byte *)malloc((ulonglong)uVar4,*(undefined *)((longlong)&uStack40 + lVar5));
      *(undefined8 *)((longlong)&uStack40 + lVar5) = 0x1800159ec;
      _Memory_02 = (undefined *)malloc(uVar7,*(undefined *)((longlong)&uStack40 + lVar5));
      *(undefined8 *)((longlong)&uStack40 + lVar5) = 0x1800159f7;
      _Memory_03 = (char *)malloc((ulonglong)uVar4,*(undefined *)((longlong)&uStack40 + lVar5));
      *(char **)(&stack0x00000028 + lVar5) = _Memory_03;
      *(undefined8 *)((longlong)&uStack40 + lVar5) = 0x180015a07;
      puVar6 = (undefined *)malloc(uVar7,*(undefined *)((longlong)&uStack40 + lVar5));
      *(undefined **)((longlong)&pvStackX32 + lVar5) = puVar6;
      if (((_Memory_01 == (byte *)0x0) || (_Memory_02 == (undefined *)0x0)) ||
         ((_Memory_03 == (char *)0x0 || (puVar6 == (undefined *)0x0)))) {
        *(undefined8 *)((longlong)&uStack40 + lVar5) = 0x180015b05;
        free(_Memory_01,*(undefined *)((longlong)&uStack40 + lVar5));
        *(undefined8 *)((longlong)&uStack40 + lVar5) = 0x180015b0e;
        free(_Memory_02,*(undefined *)((longlong)&uStack40 + lVar5));
        *(undefined8 *)((longlong)&uStack40 + lVar5) = 0x180015b17;
        free(_Memory_03,*(undefined *)((longlong)&uStack40 + lVar5));
        *(undefined8 *)((longlong)&uStack40 + lVar5) = 0x180015b22;
        free(*(void **)((longlong)&pvStackX32 + lVar5),*(undefined *)((longlong)&uStack40 + lVar5));
      }
      else {
        *(uint *)((longlong)auStackX8 + lVar5 + 8) = uVar11;
        *(uint *)((longlong)auStackX8 + lVar5) = uVar9;
        *(undefined **)((longlong)&pvStackX32 + lVar5 + -0x20) = &stack0x00000030 + lVar5;
        *(undefined8 *)((longlong)&uStack40 + lVar5) = 0x180015a54;
        FUN_1800154e0((char *)_Memory_01,_Memory_02,_Memory_03,puVar6,
                      *(char **)((longlong)&pvStackX32 + lVar5 + -0x20),
                      *(uint *)((longlong)auStackX8 + lVar5),
                      *(uint *)((longlong)auStackX8 + lVar5 + 8));
        _Memory = *(void **)(&stack0x00000028 + lVar5);
        _Memory_00 = *(void **)((longlong)&pvStackX32 + lVar5);
        *param_4 = 0;
        if (uVar7 != 0) {
          pbVar8 = _Memory_01;
          do {
            if ((((param_3 + -(longlong)_Memory_01)[(longlong)pbVar8] == 0) &&
                ((&stack0x00000030 + (lVar5 - (longlong)_Memory_01))[(longlong)pbVar8] == '\0')) &&
               (((2 < *pbVar8 && (2 < (byte)(_Memory_02 + -(longlong)_Memory_01)[(longlong)pbVar8]))
                || ((2 < *(byte *)((longlong)((longlong)_Memory - (longlong)_Memory_01) +
                                  (longlong)pbVar8) &&
                    (2 < *(byte *)((longlong)((longlong)_Memory_00 - (longlong)_Memory_01) +
                                  (longlong)pbVar8))))))) {
              bVar3 = 0;
            }
            else {
              bVar3 = 1;
            }
            (param_3 + -(longlong)_Memory_01)[(longlong)pbVar8] = bVar3;
            pbVar8 = pbVar8 + 1;
            *param_4 = *param_4 + (bVar3 ^ 1);
            uVar7 = uVar7 - 1;
          } while (uVar7 != 0);
        }
        *(undefined8 *)((longlong)&uStack40 + lVar5) = 0x180015ad9;
        free(_Memory_01,*(undefined *)((longlong)&uStack40 + lVar5));
        *(undefined8 *)((longlong)&uStack40 + lVar5) = 0x180015ae2;
        free(_Memory_02,*(undefined *)((longlong)&uStack40 + lVar5));
        *(undefined8 *)((longlong)&uStack40 + lVar5) = 0x180015aeb;
        free(_Memory,*(undefined *)((longlong)&uStack40 + lVar5));
        *(undefined8 *)((longlong)&uStack40 + lVar5) = 0x180015af4;
        free(_Memory_00,*(undefined *)((longlong)&uStack40 + lVar5));
      }
    }
    else {
      if ((8 < uVar10) || (uVar10 = 2, (0x132U >> ((int)uVar4 >> 3 & 0x1fU) & 1) == 0)) {
        uVar10 = 1;
      }
      *(uint *)((longlong)auStackX8 + lVar5) = uVar10;
      *(uint *)((longlong)&pvStackX32 + lVar5 + -0x20) = uVar11;
      *(undefined8 *)((longlong)&uStack40 + lVar5) = 0x18001592c;
      FUN_180014eb0(param_1,param_2,&stack0x00000030 + lVar5,uVar9,
                    *(undefined *)((longlong)&uStack40 + lVar5));
      *param_4 = 0;
      uVar7 = (ulonglong)(uVar9 * uVar11);
      if (uVar9 * uVar11 != 0) {
        lVar2 = lVar5 - (longlong)param_3;
        do {
          if ((*param_3 == 0) && ((&stack0x00000030 + lVar2)[(longlong)param_3] == '\0')) {
            bVar3 = 0;
          }
          else {
            bVar3 = 1;
          }
          *param_3 = bVar3;
          param_3 = param_3 + 1;
          *param_4 = *param_4 + (bVar3 ^ 1);
          uVar7 = uVar7 - 1;
        } while (uVar7 != 0);
      }
    }
  }
  *(undefined8 *)((longlong)&uStack40 + lVar5) = 0x18001599a;
  FUN_18005f100(*(ulonglong *)(&stack0x00004cc0 + lVar5) ^
                (ulonglong)(&stack0xffffffffffffffe0 + lVar5),
                *(undefined *)((longlong)&uStack40 + lVar5));
  return;
}



undefined8
FUN_180015b40(longlong param_1,short *param_2,int param_3,uint param_4,undefined8 param_5,
             int *param_6)

{
  longlong lVar1;
  int iVar2;
  int *_Memory;
  int *piVar3;
  short sVar4;
  ulonglong uVar5;
  longlong lVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  short *psVar10;
  int iVar11;
  int iVar12;
  int *piVar13;
  uint uVar14;
  ulonglong uVar15;
  longlong lVar16;
  short *local_res10;

  uVar15 = (ulonglong)param_4;
  lVar16 = (longlong)param_3;
  iVar8 = param_3 + 1;
  iVar11 = (param_4 + 1) * iVar8 * 2;
  _Memory = (int *)malloc((longlong)iVar11 + 0x20);
  if (_Memory == (int *)0x0) {
    return 0x80000004;
  }
  _Memory[1] = param_4 + 1;
  _Memory[2] = iVar8 * 2;
  piVar13 = _Memory + 8;
  _Memory[3] = iVar11;
  *_Memory = iVar8;
  *param_6 = 0;
  _Memory[4] = 2;
  *(int **)(_Memory + 6) = piVar13;
  if ((param_2 != (short *)0x0) && (uVar7 = param_3 * param_4 * 2, uVar7 != 0)) {
    uVar5 = (ulonglong)uVar7;
    psVar10 = param_2;
    while (uVar5 != 0) {
      uVar5 = uVar5 - 1;
      *(undefined *)psVar10 = 0;
      psVar10 = (short *)((longlong)psVar10 + 1);
    }
  }
  if ((piVar13 != (int *)0x0) && (_Memory[3] != 0)) {
    uVar5 = (ulonglong)(uint)_Memory[3];
    piVar3 = piVar13;
    while (uVar5 != 0) {
      uVar5 = uVar5 - 1;
      *(undefined *)piVar3 = 0;
      piVar3 = (int *)((longlong)piVar3 + 1);
    }
  }
  piVar13 = (int *)((longlong)piVar13 + (longlong)(param_3 + 2) * 2);
  if (0 < (int)param_4) {
    lVar1 = (longlong)iVar8 * 2;
    iVar11 = 0;
    uVar5 = uVar15;
    do {
      lVar6 = 0;
      if (0 < param_3) {
        piVar3 = (int *)((longlong)piVar13 + (longlong)iVar8 * -2);
        do {
          sVar4 = *(short *)(lVar1 + -2 + (longlong)piVar3) - *(short *)((longlong)piVar3 + -2);
          if (*(char *)(lVar6 + param_1) == '\0') {
            iVar11 = iVar11 + 1;
            sVar4 = sVar4 + 1;
          }
          lVar6 = lVar6 + 1;
          *(short *)(lVar1 + (longlong)piVar3) = sVar4 + *(short *)piVar3;
          piVar3 = (int *)((longlong)piVar3 + 2);
        } while (lVar6 < lVar16);
      }
      param_1 = param_1 + lVar16;
      piVar13 = (int *)((longlong)piVar13 + lVar1);
      uVar5 = uVar5 - 1;
    } while (uVar5 != 0);
    *param_6 = iVar11;
  }
  if (*param_6 != 0) {
    lVar1 = *(longlong *)(_Memory + 6);
    if (0 < (int)param_4) {
      uVar7 = 3;
      local_res10 = param_2;
      do {
        if (0 < lVar16) {
          uVar14 = uVar7;
          if ((int)param_4 <= (int)uVar7) {
            uVar14 = param_4;
          }
          iVar11 = 3;
          lVar6 = lVar16;
          psVar10 = local_res10;
          do {
            iVar9 = uVar7 - 5;
            iVar12 = iVar11 + -5;
            if (iVar11 + -5 < 1) {
              iVar12 = 0;
            }
            iVar2 = iVar11;
            if (param_3 <= iVar11) {
              iVar2 = param_3;
            }
            if (iVar9 < 1) {
              iVar9 = 0;
            }
            iVar11 = iVar11 + 1;
            *psVar10 = ((*(short *)(lVar1 + (longlong)(int)(uVar14 * iVar8 + iVar2) * 2) -
                        *(short *)(lVar1 + (longlong)(int)(uVar14 * iVar8 + iVar12) * 2)) -
                       *(short *)(lVar1 + (longlong)(iVar9 * iVar8 + iVar2) * 2)) +
                       *(short *)(lVar1 + (longlong)(iVar9 * iVar8 + iVar12) * 2);
            lVar6 = lVar6 + -1;
            psVar10 = psVar10 + 1;
          } while (lVar6 != 0);
        }
        local_res10 = local_res10 + lVar16;
        uVar7 = uVar7 + 1;
        uVar15 = uVar15 - 1;
      } while (uVar15 != 0);
    }
    free(_Memory);
    return 0;
  }
  free(_Memory);
  return 0;
}



void FUN_180015de0(longlong param_1,longlong param_2,int *param_3,int param_4,uint param_5,
                  int param_6)

{
  short *_Memory;
  undefined8 uVar1;
  undefined8 *puVar2;
  undefined8 *puVar3;
  int iVar4;
  ushort *puVar5;
  undefined8 *puVar6;
  int iVar7;
  longlong lVar8;
  ushort *puVar9;
  undefined8 in_stack_ffffffffffffffd8;

  if ((((param_1 != 0) && (param_2 != 0)) && (param_3 != (int *)0x0)) &&
     (iVar4 = *param_3, 0 < iVar4)) {
    _Memory = (short *)malloc(0x9920);
    iVar7 = 0;
    param_6 = 0;
    uVar1 = FUN_180015b40(param_2,_Memory,param_4,param_5,in_stack_ffffffffffffffd8,&param_6);
    if ((((int)uVar1 == 0) && (param_6 != 0)) && (0x31 < param_6)) {
      if (0 < iVar4) {
        puVar9 = (ushort *)(param_1 + 2);
        puVar5 = (ushort *)(param_1 + 4);
        do {
          if (1 < (ushort)_Memory[(int)((*puVar9 + 0x80 >> 8) + (*puVar5 + 0x80 >> 8) * param_4)]) {
            iVar4 = iVar4 + -1;
            puVar2 = (undefined8 *)((longlong)iVar4 * 0x38 + param_1);
            if (iVar7 != iVar4) {
              puVar6 = (undefined8 *)((longlong)iVar7 * 0x38 + param_1);
              if (puVar6 != (undefined8 *)0x0) {
                if (puVar2 == (undefined8 *)0x0) goto LAB_180015f4a;
                if ((puVar2 + 7 <= puVar6) || (puVar6 + 7 <= puVar2)) {
                  lVar8 = 0x1c;
                  puVar3 = puVar2;
                  do {
                    *(undefined *)
                     ((longlong)(undefined8 *)((longlong)puVar6 - (longlong)puVar2) +
                     (longlong)puVar3) = *(undefined *)puVar3;
                    *(undefined *)
                     ((longlong)(undefined8 *)((longlong)puVar6 - (longlong)puVar2) + 1 +
                     (longlong)puVar3) = *(undefined *)((longlong)puVar3 + 1);
                    puVar3 = (undefined8 *)((longlong)puVar3 + 2);
                    lVar8 = lVar8 + -1;
                  } while (lVar8 != 0);
                }
              }
              if (puVar2 != (undefined8 *)0x0) {
                *puVar2 = 0;
                puVar2[1] = 0;
                puVar2[2] = 0;
                puVar2[3] = 0;
                puVar2[4] = 0;
                puVar2[5] = 0;
                puVar2[6] = 0;
              }
            }
LAB_180015f4a:
            iVar7 = iVar7 + -1;
            puVar5 = puVar5 + -0x1c;
            puVar9 = puVar9 + -0x1c;
          }
          iVar7 = iVar7 + 1;
          puVar5 = puVar5 + 0x1c;
          puVar9 = puVar9 + 0x1c;
        } while (iVar7 < iVar4);
      }
      *param_3 = iVar4;
    }
    free(_Memory);
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180015fa0(longlong param_1,uint param_2,int *param_3)

{
  undefined4 *puVar1;
  uint uVar2;
  byte bVar3;
  longlong lVar4;
  uint uVar5;
  longlong lVar6;
  int *piVar7;
  int iVar8;
  ulonglong uVar9;
  int iVar10;
  longlong lVar11;
  longlong lVar12;
  longlong lVar13;
  uint uVar14;
  int iVar15;
  int *piVar16;
  undefined (*pauVar17) [16];
  uint uVar18;
  undefined auStack200 [32];
  uint local_a8;
  int local_a4;
  longlong local_a0;
  longlong local_98;
  longlong local_90;
  longlong local_88;
  longlong local_80;
  undefined local_78 [12];
  undefined4 uStack108;
  undefined8 local_68;
  undefined local_60 [8];
  int iStack88;
  int iStack84;
  undefined8 local_50;
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)auStack200;
  lVar4 = param_1 + 0x28;
  uVar2 = *(uint *)(param_1 + 0x87d8);
  lVar6 = param_1 + 0x1b8;
  local_80 = (longlong)*(int *)(param_1 + 0x1c);
  uVar9 = SEXT48((int)param_2);
  local_98 = *(longlong *)(lVar4 + uVar9 * 8);
  local_50 = 0x100;
  local_68 = 0x100;
  _local_60 = _DAT_1800a4170;
  _local_78 = _DAT_1800a4170;
  local_a8 = param_2;
  local_a0 = lVar6;
  local_90 = lVar4;
  if (param_2 == uVar2) {
    if (param_3 != (int *)0x0) {
      FUN_180023cd0(param_3,(int *)local_60);
    }
    local_a4 = 0;
    if (0 < (int)param_2) {
      do {
        lVar4 = (longlong)(*(int *)(local_98 + 0x104) + local_a4) * 0x1c;
        if (*(uint *)(lVar4 + lVar6) < 0x80000000) {
          pauVar17 = (undefined (*) [16])(lVar6 + 4 + lVar4);
          if ((pauVar17 != (undefined (*) [16])0x0) && (param_3 != (int *)0x0)) {
            lVar11 = (longlong)*(int *)(*pauVar17 + 4);
            lVar4 = (longlong)*(int *)*pauVar17;
            lVar6 = (longlong)*(int *)pauVar17[1];
            lVar12 = (longlong)*(int *)(*pauVar17 + 0xc);
            local_88 = lVar12 * *param_3;
            local_78 = CONCAT48((int)((ulonglong)(param_3[2] * lVar4 + param_3[5] * lVar11) >> 8) +
                                *(int *)(*pauVar17 + 8),local_78._0_8_);
            bVar3 = 0xf;
            iVar8 = (int)((ulonglong)(local_88 + lVar6 * param_3[3]) >> 8) -
                    (int)((ulonglong)(param_3[1] * lVar4 + param_3[4] * lVar11) >> 8) >> 1;
            iVar15 = (int)((ulonglong)(param_3[1] * lVar12 + lVar6 * param_3[4]) >> 8) +
                     (int)((ulonglong)(lVar4 * *param_3 + lVar11 * param_3[3]) >> 8) >> 1;
            uVar18 = 0;
            uVar5 = 0x8000;
            iVar10 = (int)((ulonglong)(lVar12 * param_3[2] + lVar6 * param_3[5]) >> 8) +
                     *(int *)(pauVar17[1] + 4);
            uVar14 = iVar8 * iVar8 + iVar15 * iVar15;
            uVar2 = uVar14;
            if (1 < uVar14) {
              do {
                uVar2 = uVar5 + uVar18 * 2 << (bVar3 & 0x1f);
                bVar3 = bVar3 - 1;
                if (uVar2 <= uVar14) {
                  uVar18 = uVar18 + uVar5;
                  uVar14 = uVar14 - uVar2;
                }
                uVar5 = uVar5 >> 1;
                uVar2 = uVar18;
              } while (uVar5 != 0);
            }
            if (uVar2 == 0) {
              _local_78 = CONCAT88(stack0xffffffffffffff90,0x100);
              local_68 = CONCAT44(iVar10,0x100);
              _local_78 = _local_78 & (undefined  [16])0xffffffffffffffff;
            }
            else {
              iVar15 = (((int)uVar2 >> 1) + iVar15 * 0x100) / (int)uVar2;
              local_68 = CONCAT44(iVar10,iVar15);
              iVar8 = (((int)uVar2 >> 1) + iVar8 * -0x100) / (int)uVar2;
              local_78._0_8_ = CONCAT44(iVar8,iVar15);
              _local_78 = CONCAT412(-iVar8,local_78);
            }
            uVar9 = (ulonglong)local_a8;
            lVar6 = local_a0;
          }
          if ((pauVar17 != (undefined (*) [16])0x0) &&
             (((undefined (*) [16])local_60 <= pauVar17 || (pauVar17[1] + 8 <= local_78)))) {
            *pauVar17 = _local_78;
            *(undefined8 *)pauVar17[1] = local_68;
          }
        }
        local_a4 = local_a4 + 1;
        lVar4 = local_90;
      } while (local_a4 < (int)uVar9);
    }
    lVar11 = (longlong)((int)uVar9 + 1);
    while (lVar11 < local_80) {
                    // WARNING: Read-only address (ram,0x0001800a4170) is written
      lVar12 = (longlong)(*(int *)(*(longlong *)(lVar4 + lVar11 * 8) + 0x104) + (int)uVar9) * 0x1c;
      if ((*(uint *)(lVar12 + lVar6) < 0x80000000) &&
         (pauVar17 = (undefined (*) [16])(lVar6 + 4 + lVar12), pauVar17 != (undefined (*) [16])0x0))
      {
        lVar4 = (longlong)local_60._4_4_;
        lVar6 = (longlong)local_60._0_4_;
        lVar13 = (longlong)(int)local_50;
        bVar3 = 0xf;
        local_88 = lVar13 * *(int *)(*pauVar17 + 0xc);
        uStack108 = SUB164(_local_78 >> 0x60,0);
        local_78 = CONCAT48((int)((ulonglong)
                                  (lVar6 * *(int *)(*pauVar17 + 8) +
                                  *(int *)(pauVar17[1] + 4) * lVar4) >> 8) + iStack88,local_78._0_8_
                           );
        lVar12 = (longlong)iStack84;
        iVar8 = (int)((ulonglong)(local_88 + lVar12 * *(int *)*pauVar17) >> 8) -
                (int)((ulonglong)(lVar6 * *(int *)(*pauVar17 + 4) + *(int *)pauVar17[1] * lVar4) >>
                     8) >> 1;
        iVar10 = (int)((ulonglong)(*(int *)pauVar17[1] * lVar13 + lVar12 * *(int *)(*pauVar17 + 4))
                      >> 8) +
                 (int)((ulonglong)(lVar6 * *(int *)*pauVar17 + lVar4 * *(int *)(*pauVar17 + 0xc)) >>
                      8) >> 1;
        uVar18 = 0;
        uVar5 = 0x8000;
        local_50._4_4_ =
             (int)((ulonglong)
                   (lVar13 * *(int *)(pauVar17[1] + 4) + lVar12 * *(int *)(*pauVar17 + 8)) >> 8) +
             local_50._4_4_;
        uVar14 = iVar8 * iVar8 + iVar10 * iVar10;
        uVar2 = uVar14;
        if (1 < uVar14) {
          do {
            uVar2 = uVar5 + uVar18 * 2 << (bVar3 & 0x1f);
            bVar3 = bVar3 - 1;
            if (uVar2 <= uVar14) {
              uVar18 = uVar18 + uVar5;
              uVar14 = uVar14 - uVar2;
            }
            uVar5 = uVar5 >> 1;
            uVar2 = uVar18;
          } while (uVar5 != 0);
        }
        if (uVar2 == 0) {
          _local_78 = CONCAT88(stack0xffffffffffffff90,0x100);
          local_68 = CONCAT44(local_50._4_4_,0x100);
          _local_78 = _local_78 & (undefined  [16])0xffffffffffffffff;
        }
        else {
          iVar10 = (((int)uVar2 >> 1) + iVar10 * 0x100) / (int)uVar2;
          local_68 = CONCAT44(local_50._4_4_,iVar10);
          iVar8 = (((int)uVar2 >> 1) + iVar8 * -0x100) / (int)uVar2;
          local_78._0_8_ = CONCAT44(iVar8,iVar10);
          _local_78 = CONCAT412(-iVar8,local_78);
        }
        if (((undefined (*) [16])local_60 <= pauVar17) || (pauVar17[1] + 8 <= local_78)) {
          *pauVar17 = _local_78;
          *(undefined8 *)pauVar17[1] = local_68;
        }
        uVar9 = (ulonglong)local_a8;
        lVar6 = local_a0;
        lVar4 = local_90;
      }
      lVar11 = lVar11 + 1;
    }
  }
  else {
    iVar8 = 0;
    if (0 < (int)param_2) {
      do {
        iVar10 = *(int *)(local_98 + 0x104) + iVar8;
        iVar8 = iVar8 + 1;
        lVar11 = (longlong)iVar10 * 0x1c;
        puVar1 = (undefined4 *)(lVar11 + lVar6);
        *puVar1 = 0xffffffff;
        puVar1[1] = 0x100;
        puVar1[2] = 0;
        puVar1[3] = 0;
        *(undefined8 *)(lVar11 + 0x10 + lVar6) = 0x10000000000;
        *(undefined4 *)(lVar11 + 0x18 + lVar6) = 0;
      } while (iVar8 < (int)param_2);
    }
    lVar11 = (longlong)(int)(param_2 + 1);
    while (lVar11 < local_80) {
      lVar12 = lVar11 * 8;
      lVar11 = lVar11 + 1;
      lVar12 = (longlong)(int)(*(int *)(*(longlong *)(lVar4 + lVar12) + 0x104) + param_2) * 0x1c;
      puVar1 = (undefined4 *)(lVar12 + lVar6);
      *puVar1 = 0xffffffff;
      puVar1[1] = 0x100;
      puVar1[2] = 0;
      puVar1[3] = 0;
      *(undefined8 *)(lVar12 + 0x10 + lVar6) = 0x10000000000;
      *(undefined4 *)(lVar12 + 0x18 + lVar6) = 0;
    }
    if ((int)uVar2 < (int)param_2) {
      lVar4 = (longlong)(int)(*(int *)(local_98 + 0x104) + uVar2) * 0x1c;
      *(undefined4 *)(lVar4 + lVar6) = 0;
      piVar7 = (int *)(param_1 + 0x1bc + lVar4);
      if (((piVar7 != (int *)0x0) && (param_3 != (int *)0x0)) &&
         ((param_3 + 6 <= piVar7 || (piVar7 + 6 <= param_3)))) {
        piVar16 = (int *)((longlong)param_3 - (longlong)piVar7);
        lVar4 = 0x18;
        do {
          *(undefined *)piVar7 = *(undefined *)((longlong)piVar7 + (longlong)piVar16);
          piVar7 = (int *)((longlong)piVar7 + 1);
          lVar4 = lVar4 + -1;
        } while (lVar4 != 0);
      }
    }
    else {
      if (param_3 != (int *)0x0) {
        FUN_180023cd0(param_3,(int *)local_60);
      }
      lVar4 = (longlong)
              (int)(*(int *)(*(longlong *)(lVar4 + (longlong)(int)uVar2 * 8) + 0x104) + param_2) *
              0x1c;
      *(undefined4 *)(lVar4 + lVar6) = 0;
      pauVar17 = (undefined (*) [16])(param_1 + 0x1bc + lVar4);
      if ((pauVar17 != (undefined (*) [16])0x0) &&
         (((undefined (*) [16])&local_48 <= pauVar17 || (pauVar17[1] + 8 <= local_60)))) {
        *pauVar17 = _local_60;
        *(undefined8 *)pauVar17[1] = local_50;
      }
    }
  }
  FUN_18005f100(local_48 ^ (ulonglong)auStack200);
  return;
}



void FUN_180016590(int param_1,int *param_2,int *param_3,int *param_4,undefined *param_5,
                  longlong param_6)

{
  undefined *puVar1;
  undefined4 *puVar2;
  int iVar3;
  int *piVar4;
  ulonglong uVar5;
  longlong lVar6;
  longlong lVar7;
  int iVar8;
  uint uVar9;
  ulonglong uVar10;
  longlong lVar11;
  longlong *plVar12;

  iVar8 = *(int *)(param_6 + 0x20);
  lVar7 = *(longlong *)(param_6 + 0x28 + (longlong)param_1 * 8);
  *(int *)(param_6 + 0x8cf8) = *(int *)(param_6 + 0x8cf8) + 1;
  *(int *)(lVar7 + 0x120) = *(int *)(lVar7 + 0x120) + 1;
  if (param_2 != (int *)0x0) {
    FUN_1800230e0(param_2,(int **)(lVar7 + 8));
  }
  uVar10 = 0;
  if (param_3 == (int *)0x0) {
    *(undefined8 *)(lVar7 + 0x10) = 0;
  }
  else {
    FUN_1800230e0(param_3,(int **)(lVar7 + 0x10));
  }
  if (param_4 == (int *)0x0) {
    *(undefined8 *)(lVar7 + 0x18) = 0;
  }
  else {
    if (*(longlong *)(lVar7 + 0x18) == 0) {
      piVar4 = FUN_180022ff0(*param_4,param_4[1],param_4[4]);
      *(int **)(lVar7 + 0x18) = piVar4;
    }
    FUN_1800230e0(param_4,(int **)(lVar7 + 0x18));
  }
  puVar1 = (undefined *)(lVar7 + 0x28);
  if (((puVar1 != (undefined *)0x0) && (param_5 != (undefined *)0x0)) &&
     ((param_5 + 200 <= puVar1 || ((undefined *)(lVar7 + 0xf0U) <= param_5)))) {
    lVar6 = -(longlong)param_5;
    lVar11 = 100;
    do {
      (puVar1 + lVar6)[(longlong)param_5] = *param_5;
      (puVar1 + lVar6 + 1)[(longlong)param_5] = param_5[1];
      param_5 = param_5 + 2;
      lVar11 = lVar11 + -1;
    } while (lVar11 != 0);
  }
  *(undefined8 *)(lVar7 + 0x20) = 0;
  if (*(int *)(lVar7 + 0x114) != 0) {
    *(undefined4 *)(lVar7 + 0x114) = 2;
  }
  uVar5 = uVar10;
  if (0 < iVar8) {
    do {
      lVar6 = *(longlong *)(param_6 + 0x28 + uVar5 * 8);
      iVar3 = *(int *)(lVar6 + 0x11c);
      if (*(int *)(lVar7 + 0x11c) < iVar3) {
        *(int *)(lVar6 + 0x11c) = iVar3 + -1;
      }
      uVar5 = uVar5 + 1;
    } while ((longlong)uVar5 < (longlong)iVar8);
  }
  *(int *)(lVar7 + 0x11c) = iVar8 + -1;
  if (param_1 != *(int *)(param_6 + 0x87d8)) {
    if (0 < param_1) {
      do {
        iVar8 = (int)uVar10;
        uVar9 = iVar8 + 1;
        uVar10 = (ulonglong)uVar9;
        lVar6 = (longlong)(*(int *)(lVar7 + 0x104) + iVar8) * 0x1c;
        puVar2 = (undefined4 *)(lVar6 + 0x1b8 + param_6);
        *puVar2 = 0xffffffff;
        puVar2[1] = 0x100;
        puVar2[2] = 0;
        puVar2[3] = 0;
        *(undefined8 *)(lVar6 + 0x1c8 + param_6) = 0x10000000000;
        *(undefined4 *)(lVar6 + 0x1d0 + param_6) = 0;
      } while ((int)uVar9 < param_1);
    }
    iVar8 = param_1 + 1;
    if (iVar8 < *(int *)(param_6 + 0x1c)) {
      plVar12 = (longlong *)(param_6 + 0x28 + (longlong)iVar8 * 8);
      do {
        lVar7 = *plVar12;
        plVar12 = plVar12 + 1;
        iVar8 = iVar8 + 1;
        lVar7 = (longlong)(*(int *)(lVar7 + 0x104) + param_1) * 0x1c;
        puVar2 = (undefined4 *)(lVar7 + 0x1b8 + param_6);
        *puVar2 = 0xffffffff;
        puVar2[1] = 0x100;
        puVar2[2] = 0;
        puVar2[3] = 0;
        *(undefined8 *)(lVar7 + 0x1c8 + param_6) = 0x10000000000;
        *(undefined4 *)(lVar7 + 0x1d0 + param_6) = 0;
      } while (iVar8 < *(int *)(param_6 + 0x1c));
    }
  }
  return;
}



ulonglong FUN_1800167d0(undefined4 *param_1,int *param_2)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  undefined4 *puVar5;
  int *piVar6;
  undefined4 *puVar7;
  int *piVar8;
  undefined4 *puVar9;
  longlong lVar10;
  longlong lVar11;

  uVar1 = param_2[7];
  lVar11 = (longlong)(int)uVar1;
  iVar2 = *param_2;
  iVar3 = param_2[9];
  piVar8 = *(int **)(param_1 + 4);
  piVar4 = *(int **)(param_1 + 6);
  puVar5 = *(undefined4 **)(param_2 + lVar11 * 2 + 10);
  piVar6 = *(int **)(param_1 + 2);
  param_2[7] = uVar1 + 1;
  puVar5[0x41] = iVar3;
  if (piVar6 != (int *)0x0) {
    FUN_1800230e0(piVar6,(int **)(puVar5 + 2));
  }
  if (piVar8 == (int *)0x0) {
    *(undefined8 *)(puVar5 + 4) = 0;
  }
  else {
    FUN_1800230e0(piVar8,(int **)(puVar5 + 4));
  }
  if (piVar4 == (int *)0x0) {
    *(undefined8 *)(puVar5 + 6) = 0;
  }
  else {
    FUN_1800230e0(piVar4,(int **)(puVar5 + 6));
  }
  puVar9 = puVar5 + 10;
  puVar7 = param_1 + 10;
  if (((puVar9 != (undefined4 *)0x0) && (puVar7 != (undefined4 *)0x0)) &&
     ((param_1 + 0x3c <= puVar9 || (puVar5 + 0x3c <= puVar7)))) {
    puVar9 = (undefined4 *)((longlong)puVar9 - (longlong)puVar7);
    lVar10 = 100;
    do {
      *(undefined *)((longlong)puVar9 + (longlong)puVar7) = *(undefined *)puVar7;
      *(undefined *)((longlong)puVar9 + 1 + (longlong)puVar7) = *(undefined *)((longlong)puVar7 + 1)
      ;
      puVar7 = (undefined4 *)((longlong)puVar7 + 2);
      lVar10 = lVar10 + -1;
    } while (lVar10 != 0);
  }
  if (*(int **)(param_1 + 0x4c) != (int *)0x0) {
    FUN_1800230e0(*(int **)(param_1 + 0x4c),(int **)(puVar5 + 0x4c));
  }
  *(undefined8 *)(puVar5 + 8) = 0;
  FUN_180005050((longlong)param_1,(longlong)puVar5,param_2[5],(uint)(1 < iVar2 - 9U));
  puVar5[1] = param_1[1];
  *puVar5 = *param_1;
  if (0 < lVar11) {
    piVar8 = param_2 + (longlong)(int)puVar5[0x41] * 7 + 0x6e;
    lVar10 = lVar11;
    do {
      *piVar8 = -1;
      piVar8[1] = 0x100;
      piVar8[2] = 0;
      piVar8[3] = 0;
      *(undefined8 *)(piVar8 + 4) = 0x10000000000;
      piVar8[6] = 0;
      lVar10 = lVar10 + -1;
      piVar8 = piVar8 + 7;
    } while (lVar10 != 0);
  }
  param_2[0x233f] = param_2[0x233f] + 1;
  param_2[9] = iVar3 + -1 + uVar1 + 1;
  param_2[lVar11 + 0x21fa] = uVar1;
  puVar5[0x46] = 0;
  puVar5[0x43] = param_1[0x43];
  puVar5[0x44] = param_1[0x44];
  puVar5[0x45] = 1;
  puVar5[0x48] = 0;
  puVar5[0x47] = uVar1;
  return (ulonglong)uVar1;
}



int FUN_1800169c0(longlong param_1)

{
  byte *pbVar1;
  uint uVar2;
  longlong lVar3;
  uint uVar4;
  longlong lVar5;
  longlong lVar6;
  int iVar7;
  byte *pbVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  int iVar16;

  uVar2 = *(uint *)(param_1 + 0xc);
  lVar6 = (longlong)(int)uVar2;
  lVar3 = *(longlong *)(param_1 + 0x18);
  iVar10 = 0;
  iVar7 = 0;
  iVar9 = iVar7;
  if ((0 < (int)uVar2) && (iVar9 = 0, 7 < uVar2)) {
    iVar9 = 0;
    iVar11 = 0;
    iVar13 = 0;
    iVar15 = 0;
    iVar10 = 0;
    iVar12 = 0;
    iVar14 = 0;
    iVar16 = 0;
    uVar4 = uVar2 & 0x80000007;
    if ((int)uVar4 < 0) {
      uVar4 = (uVar4 - 1 | 0xfffffff8) + 1;
    }
    pbVar8 = (byte *)(lVar3 + 2);
    do {
      iVar7 = iVar7 + 8;
      pbVar1 = pbVar8 + 8;
      iVar9 = *(int *)(&DAT_18007c6f0 + (ulonglong)pbVar8[-2] * 4) + iVar9;
      iVar11 = *(int *)(&DAT_18007c6f0 + (ulonglong)pbVar8[-1] * 4) + iVar11;
      iVar13 = *(int *)(&DAT_18007c6f0 + (ulonglong)*pbVar8 * 4) + iVar13;
      iVar15 = *(int *)(&DAT_18007c6f0 + (ulonglong)pbVar8[1] * 4) + iVar15;
      iVar10 = *(int *)(&DAT_18007c6f0 + (ulonglong)pbVar8[2] * 4) + iVar10;
      iVar12 = *(int *)(&DAT_18007c6f0 + (ulonglong)pbVar8[3] * 4) + iVar12;
      iVar14 = *(int *)(&DAT_18007c6f0 + (ulonglong)pbVar8[4] * 4) + iVar14;
      iVar16 = *(int *)(&DAT_18007c6f0 + (ulonglong)pbVar8[5] * 4) + iVar16;
      pbVar8 = pbVar1;
    } while ((longlong)(pbVar1 + (-2 - lVar3)) < (longlong)(int)(uVar2 - uVar4));
    iVar10 = iVar10 + iVar9 + iVar14 + iVar13 + iVar12 + iVar11 + iVar16 + iVar15;
    iVar9 = iVar7;
  }
  lVar5 = (longlong)iVar9;
  iVar7 = 0;
  iVar9 = 0;
  if (lVar5 < lVar6) {
    if (1 < lVar6 - lVar5) {
      iVar9 = 0;
      do {
        iVar7 = iVar7 + *(int *)(&DAT_18007c6f0 + (ulonglong)*(byte *)(lVar3 + lVar5) * 4);
        pbVar8 = (byte *)(lVar3 + 1 + lVar5);
        lVar5 = lVar5 + 2;
        iVar9 = iVar9 + *(int *)(&DAT_18007c6f0 + (ulonglong)*pbVar8 * 4);
      } while (lVar5 < lVar6 + -1);
    }
    if (lVar5 < lVar6) {
      iVar10 = iVar10 + *(int *)(&DAT_18007c6f0 + (ulonglong)*(byte *)(lVar5 + lVar3) * 4);
    }
    iVar10 = iVar10 + iVar9 + iVar7;
  }
  iVar9 = 0;
  if (0x13 < iVar10) {
    iVar9 = iVar10;
  }
  return iVar9;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180016b60(longlong param_1,longlong param_2,int *param_3,int param_4)

{
  int iVar1;
  int iVar2;
  undefined *puVar3;
  uint uVar4;
  int *piVar5;
  int *_Memory;
  byte bVar6;
  undefined *puVar7;
  uint uVar8;
  ulonglong uVar9;
  longlong lVar10;
  longlong lVar11;
  int iVar12;
  uint uVar13;
  uint uVar14;
  longlong lVar15;
  uint uVar16;
  ulonglong uVar17;
  ulonglong uVar18;
  int iVar19;
  ulonglong uVar20;
  ulonglong uVar21;
  longlong lVar22;
  uint local_8e8;
  int local_8e4;
  int local_8e0;
  uint local_8dc;
  int local_8d8;
  longlong local_8d0;
  longlong local_8c8;
  longlong local_8c0;
  int *local_8b8;
  ulonglong local_8b0;
  ulonglong local_8a8;
  ulonglong local_8a0;
  int local_898 [516];
  undefined8 local_88;
  int iStack128;
  int iStack124;
  ulonglong local_78;
  int local_70;
  int iStack108;
  int iStack104;
  int iStack100;
  undefined8 local_60;
  int local_58;
  undefined4 uStack84;
  int local_50;
  int iStack76;
  undefined8 local_48;
  ulonglong local_40;

  local_40 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffff6e8;
  local_8d8 = *(int *)(param_1 + 0xc);
  local_8e0 = *(int *)(param_1 + 8);
  local_8e4 = *(int *)(param_1 + 4);
  iVar19 = *(int *)(param_1 + 0x1c);
  lVar22 = (longlong)iVar19;
  uVar20 = SEXT48(param_4);
  local_8c0 = param_1 + 0x28;
  local_8d0 = param_1 + 0x1b8;
  local_8dc = *(uint *)(param_1 + 0x87d8);
  if (local_8d8 != 0) {
    local_8e0 = local_8e0 >> 1;
    local_8e4 = local_8e4 >> 1;
  }
  iVar1 = **(int **)(param_2 + 0x130);
  iVar2 = (*(int **)(param_2 + 0x130))[1];
  iVar12 = iVar1 * iVar2;
  local_8b8 = param_3;
  piVar5 = (int *)malloc((longlong)iVar12 + 0x20);
  _Memory = (int *)0x0;
  if (piVar5 != (int *)0x0) {
    piVar5[3] = iVar12;
    *piVar5 = iVar1;
    piVar5[1] = iVar2;
    piVar5[4] = 1;
    piVar5[2] = iVar1;
    *(int **)(piVar5 + 6) = piVar5 + 8;
    _Memory = piVar5;
  }
  piVar5 = *(int **)(param_2 + 0x130);
  if ((piVar5 != (int *)0x0) && (_Memory != (int *)0x0)) {
    if (_Memory[3] < piVar5[3]) {
      free(_Memory);
      _Memory = FUN_180022ff0(*piVar5,piVar5[1],piVar5[4]);
    }
    *_Memory = *piVar5;
    _Memory[1] = piVar5[1];
    _Memory[2] = piVar5[2];
    _Memory[3] = piVar5[3];
    _Memory[4] = piVar5[4];
    puVar7 = *(undefined **)(_Memory + 6);
    uVar8 = piVar5[3];
    uVar9 = (ulonglong)uVar8;
    puVar3 = *(undefined **)(piVar5 + 6);
    if (((((puVar7 != (undefined *)0x0) && (puVar3 != (undefined *)0x0)) && (uVar8 != 0)) &&
        ((puVar3 + uVar9 <= puVar7 || (puVar7 + uVar9 <= puVar3)))) && (uVar8 != 0)) {
      lVar10 = -(longlong)puVar7;
      do {
        *puVar7 = puVar7[(longlong)(puVar3 + lVar10)];
        puVar7 = puVar7 + 1;
        uVar9 = uVar9 - 1;
      } while (uVar9 != 0);
    }
  }
  uVar9 = 0;
  local_8e8 = 0;
  local_8c8 = lVar22;
  if (0 < iVar19) {
    uVar17 = SEXT48((int)local_8dc);
    lVar10 = local_8c0;
    uVar18 = uVar17;
    uVar21 = uVar9;
    local_8a8 = uVar17;
    local_8a0 = uVar20;
    do {
      uVar8 = (uint)uVar9;
      lVar11 = *(longlong *)(lVar10 + uVar21 * 8);
      if (((*(int *)(lVar11 + 0x100) != 0) && (uVar21 != uVar20)) && (*(int *)(lVar11 + 0x114) != 5)
         ) {
        local_60 = 0x100;
        local_78 = 0x100;
        local_70 = 0x100;
        iStack108 = 0;
        iStack104 = 0;
        iStack100 = 0;
        local_88 = 0x100;
        iStack128 = 0;
        iStack124 = 0;
        if ((longlong)uVar17 < (longlong)uVar21) {
          piVar5 = (int *)((longlong)(*(int *)(lVar11 + 0x104) + (int)uVar18) * 0x1c + local_8d0 + 4
                          );
          if (piVar5 != (int *)0x0) {
            FUN_180023cd0(piVar5,&local_70);
          }
        }
        else {
          if ((((longlong)uVar21 < (longlong)uVar17) &&
              (piVar5 = (int *)(local_8d0 + 4 +
                               (longlong)
                               (int)(*(int *)(*(longlong *)(lVar10 + uVar17 * 8) + 0x104) + uVar8) *
                               0x1c), piVar5 != (int *)0x0)) &&
             ((piVar5 + 6 <= &local_70 || (&local_58 <= piVar5)))) {
            local_70 = *piVar5;
            iStack108 = piVar5[1];
            iStack104 = piVar5[2];
            iStack100 = piVar5[3];
            local_60 = *(undefined8 *)(piVar5 + 4);
          }
        }
        if (local_8b8 != (int *)0x0) {
          lVar10 = (longlong)iStack108;
          lVar15 = (longlong)local_70;
          lVar11 = (longlong)iStack100;
          iStack128 = (int)((ulonglong)(local_8b8[5] * lVar10 + local_8b8[2] * lVar15) >> 8) +
                      iStack104;
          lVar22 = (longlong)(int)local_60;
          bVar6 = 0xf;
          uVar13 = (int)((ulonglong)(lVar11 * *local_8b8 + local_8b8[3] * lVar22) >> 8) -
                   (int)((ulonglong)(local_8b8[4] * lVar10 + local_8b8[1] * lVar15) >> 8) >> 1;
          local_8b0 = (ulonglong)uVar13;
          iVar19 = (int)((ulonglong)(local_8b8[1] * lVar11 + local_8b8[4] * lVar22) >> 8) +
                   (int)((ulonglong)(lVar10 * local_8b8[3] + *local_8b8 * lVar15) >> 8) >> 1;
          local_60._4_4_ =
               (int)((ulonglong)(lVar11 * local_8b8[2] + local_8b8[5] * lVar22) >> 8) +
               local_60._4_4_;
          uVar8 = 0x8000;
          uVar14 = 0;
          uVar16 = uVar13 * uVar13 + iVar19 * iVar19;
          uVar4 = uVar16;
          if (1 < uVar16) {
            do {
              uVar4 = uVar8 + uVar14 * 2 << (bVar6 & 0x1f);
              bVar6 = bVar6 - 1;
              if (uVar4 <= uVar16) {
                uVar14 = uVar14 + uVar8;
                uVar16 = uVar16 - uVar4;
              }
              uVar8 = uVar8 >> 1;
              uVar4 = uVar14;
            } while (uVar8 != 0);
          }
          lVar22 = local_8c8;
          uVar8 = local_8e8;
          if (uVar4 == 0) {
            local_88 = 0x100;
            local_78 = CONCAT44(local_60._4_4_,0x100);
            iStack124 = 0;
          }
          else {
            iVar19 = (((int)uVar4 >> 1) + iVar19 * 0x100) / (int)uVar4;
            local_78 = CONCAT44(local_60._4_4_,iVar19);
            iStack124 = (int)(((int)uVar4 >> 1) + uVar13 * -0x100) / (int)uVar4;
            local_88 = CONCAT44(iStack124,iVar19);
            iStack124 = -iStack124;
          }
        }
        if ((&local_70 <= &local_58) || (&local_40 <= &local_88)) {
          local_58 = (int)local_88;
          uStack84 = local_88._4_4_;
          local_50 = iStack128;
          iStack76 = iStack124;
          local_48 = local_78;
        }
        if (local_8d8 != 0) {
          local_50 = local_50 >> 1;
          local_48 = local_48 & 0xffffffff | (ulonglong)(uint)(local_48._4_4_ >> 1) << 0x20;
        }
        FUN_18002d430(local_8e0,local_8e4,local_8e0,local_8e4,&local_58,local_898);
        FUN_18002d5e0(_Memory,local_898);
        uVar18 = (ulonglong)local_8dc;
        uVar17 = local_8a8;
        lVar10 = local_8c0;
        uVar20 = local_8a0;
      }
      local_8e8 = uVar8 + 1;
      uVar9 = (ulonglong)local_8e8;
      uVar21 = uVar21 + 1;
    } while ((longlong)uVar21 < lVar22);
  }
  FUN_1800169c0(_Memory);
  if (_Memory != (int *)0x0) {
    free(_Memory);
  }
  FUN_18005f100(local_40 ^ (ulonglong)&stack0xfffffffffffff6e8);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180017080(longlong param_1,undefined8 param_2,int *param_3,int *param_4,int *param_5)

{
  uint uVar1;
  longlong lVar2;
  ulonglong uVar3;
  byte bVar4;
  int *piVar5;
  longlong lVar6;
  uint uVar7;
  longlong lVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  uint uVar12;
  longlong lVar13;
  uint uVar14;
  int iVar15;
  ulonglong uVar16;
  ulonglong uVar17;
  longlong lVar18;
  int iVar19;
  int iVar20;
  int local_8e8;
  int local_8e4;
  int local_8e0;
  int *local_8d8;
  int *local_8d0;
  longlong local_8c8;
  ulonglong local_8c0;
  longlong local_8b8;
  longlong local_8b0;
  longlong local_8a8;
  int *local_8a0;
  int local_898 [516];
  undefined8 local_88;
  int iStack128;
  int iStack124;
  ulonglong local_78;
  int local_70;
  int iStack108;
  int iStack104;
  int iStack100;
  undefined8 local_60;
  int local_58;
  undefined4 uStack84;
  int local_50;
  int iStack76;
  undefined8 local_48;
  ulonglong local_40;

  local_40 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffff6e8;
  iVar20 = *(int *)(param_1 + 0xc);
  lVar6 = param_1 + 0x28;
  iVar10 = *(int *)(param_1 + 8);
  iVar9 = *(int *)(param_1 + 4);
  iVar11 = *(int *)(param_1 + 0x1c);
  lVar2 = (longlong)iVar11;
  uVar16 = SEXT48(*(int *)(param_1 + 0x87d8));
  lVar8 = param_1 + 0x1b8;
  *param_4 = -1;
  *param_5 = 0;
  local_8d0 = param_5;
  if (iVar20 != 0) {
    iVar10 = iVar10 >> 1;
    iVar9 = iVar9 >> 1;
  }
  iVar19 = 0;
  local_8e8 = iVar9;
  local_8e4 = iVar10;
  local_8e0 = iVar20;
  local_8d8 = param_3;
  local_8c8 = lVar2;
  local_8b8 = lVar6;
  local_8b0 = lVar8;
  local_8a0 = param_4;
  if (0 < iVar11) {
    lVar18 = 0;
    uVar17 = uVar16;
    local_8c0 = uVar16;
    do {
      lVar13 = *(longlong *)(lVar6 + lVar18 * 8);
      if ((*(int *)(lVar13 + 0x100) != 0) && (*(int *)(lVar13 + 0x114) != 5)) {
        local_60 = 0x100;
        local_78 = 0x100;
        local_70 = 0x100;
        iStack108 = 0;
        iStack104 = 0;
        iStack100 = 0;
        local_88 = 0x100;
        iStack128 = 0;
        iStack124 = 0;
        if ((longlong)uVar16 < lVar18) {
          piVar5 = (int *)((longlong)(*(int *)(lVar13 + 0x104) + (int)uVar17) * 0x1c + 4 + lVar8);
          if (piVar5 != (int *)0x0) {
            FUN_180023cd0(piVar5,&local_70);
            param_3 = local_8d8;
          }
        }
        else {
          if (((lVar18 < (longlong)uVar16) &&
              (piVar5 = (int *)(lVar8 + 4 +
                               (longlong)
                               (*(int *)(*(longlong *)(lVar6 + uVar16 * 8) + 0x104) + iVar19) * 0x1c
                               ), piVar5 != (int *)0x0)) &&
             ((piVar5 + 6 <= &local_70 || (&local_58 <= piVar5)))) {
            local_70 = *piVar5;
            iStack108 = piVar5[1];
            iStack104 = piVar5[2];
            iStack100 = piVar5[3];
            local_60 = *(undefined8 *)(piVar5 + 4);
          }
        }
        if (param_3 != (int *)0x0) {
          lVar6 = (longlong)iStack108;
          lVar8 = (longlong)local_70;
          lVar13 = (longlong)(int)local_60;
          bVar4 = 0xf;
          local_8a8 = lVar13 * param_3[3];
          iStack128 = (int)((ulonglong)(lVar8 * param_3[2] + param_3[5] * lVar6) >> 8) + iStack104;
          lVar2 = (longlong)iStack100;
          iVar11 = (int)((ulonglong)(local_8a8 + lVar2 * *param_3) >> 8) -
                   (int)((ulonglong)(lVar8 * param_3[1] + param_3[4] * lVar6) >> 8) >> 1;
          iVar15 = (int)((ulonglong)(param_3[4] * lVar13 + lVar2 * param_3[1]) >> 8) +
                   (int)((ulonglong)(lVar8 * *param_3 + lVar6 * param_3[3]) >> 8) >> 1;
          local_60._4_4_ =
               (int)((ulonglong)(lVar13 * param_3[5] + lVar2 * param_3[2]) >> 8) + local_60._4_4_;
          uVar7 = 0x8000;
          uVar12 = 0;
          uVar14 = iVar11 * iVar11 + iVar15 * iVar15;
          uVar1 = uVar14;
          if (1 < uVar14) {
            do {
              uVar1 = uVar7 + uVar12 * 2 << (bVar4 & 0x1f);
              bVar4 = bVar4 - 1;
              if (uVar1 <= uVar14) {
                uVar12 = uVar12 + uVar7;
                uVar14 = uVar14 - uVar1;
              }
              uVar7 = uVar7 >> 1;
              uVar1 = uVar12;
            } while (uVar7 != 0);
          }
          param_5 = local_8d0;
          lVar2 = local_8c8;
          iVar20 = local_8e0;
          iVar10 = local_8e4;
          iVar9 = local_8e8;
          if (uVar1 == 0) {
            local_88 = 0x100;
            local_78 = CONCAT44(local_60._4_4_,0x100);
            iStack124 = 0;
          }
          else {
            iVar15 = (((int)uVar1 >> 1) + iVar15 * 0x100) / (int)uVar1;
            local_78 = CONCAT44(local_60._4_4_,iVar15);
            iStack124 = (((int)uVar1 >> 1) + iVar11 * -0x100) / (int)uVar1;
            local_88 = CONCAT44(iStack124,iVar15);
            iStack124 = -iStack124;
          }
        }
        if ((&local_70 <= &local_58) || (&local_40 <= &local_88)) {
          local_58 = (int)local_88;
          uStack84 = local_88._4_4_;
          local_50 = iStack128;
          iStack76 = iStack124;
          local_48 = local_78;
        }
        if (iVar20 != 0) {
          local_50 = local_50 >> 1;
          local_48 = local_48 & 0xffffffff | (ulonglong)(uint)(local_48._4_4_ >> 1) << 0x20;
        }
        uVar3 = FUN_18002d430(iVar10,iVar9,iVar10,iVar9,&local_58,local_898);
        uVar17 = local_8c0 & 0xffffffff;
        uVar16 = local_8c0;
        lVar6 = local_8b8;
        lVar8 = local_8b0;
        param_3 = local_8d8;
        if (*param_5 < (int)uVar3) {
          *param_5 = (int)uVar3;
          *local_8a0 = iVar19;
        }
      }
      iVar19 = iVar19 + 1;
      lVar18 = lVar18 + 1;
    } while (lVar18 < lVar2);
  }
  *param_5 = (*param_5 * 100) / (iVar9 * iVar10);
  FUN_18005f100(local_40 ^ (ulonglong)&stack0xfffffffffffff6e8);
  return;
}



// WARNING: Removing unreachable block (ram,0x000180017a2c)
// WARNING: Type propagation algorithm not settling
// WARNING: Could not reconcile some variable overlaps

void FUN_180017490(longlong param_1)

{
  int **ppiVar1;
  undefined *puVar2;
  uint uVar3;
  undefined4 uVar4;
  longlong lVar5;
  uint *_Memory;
  int *piVar6;
  byte bVar7;
  int iVar8;
  undefined *puVar9;
  int *piVar10;
  uint uVar11;
  ulonglong uVar12;
  undefined8 *puVar13;
  longlong lVar14;
  longlong lVar15;
  int iVar16;
  longlong lVar17;
  ulonglong uVar18;
  uint uVar19;
  longlong lVar20;
  uint uVar21;
  int iVar22;
  ulonglong uVar23;
  longlong *plVar24;
  longlong lVar25;
  int local_908;
  longlong local_900;
  uint local_8f8;
  uint local_8f4;
  uint local_8f0;
  int local_8ec;
  uint local_8e8;
  uint local_8e4;
  longlong local_8e0;
  ulonglong local_8d8;
  int local_8d0;
  int local_8cc;
  int *local_8c8;
  longlong local_8c0;
  longlong *local_8b8;
  int local_8a8 [516];
  int local_98;
  int iStack148;
  int iStack144;
  int iStack140;
  undefined8 local_88;
  undefined8 local_80;
  int iStack120;
  int iStack116;
  undefined8 local_70;
  undefined8 local_68;
  int local_60;
  uint local_5c;
  int local_58;
  int iStack84;
  int local_50;
  undefined4 uStack76;
  int local_48;
  uint uStack68;
  undefined8 local_40;
  ulonglong local_38;

  local_38 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffff6c8;
  uVar19 = *(uint *)(param_1 + 8);
  plVar24 = (longlong *)(param_1 + 0x28);
  uVar11 = *(uint *)(param_1 + 4);
  local_8e0 = param_1 + 0x1b8;
  iVar8 = *(int *)(param_1 + 0x1c);
  lVar5 = (longlong)iVar8;
  iVar22 = *(int *)(param_1 + 0xc);
  local_8f0 = *(uint *)(param_1 + 0x87d8);
  local_8f8 = uVar11;
  local_8f4 = uVar19;
  local_8e8 = uVar11;
  local_8e4 = uVar19;
  local_8d0 = iVar22;
  local_8b8 = plVar24;
  if (iVar8 != 0) {
    if (iVar22 != 0) {
      local_8f4 = (int)uVar19 >> 1;
      local_8f8 = (int)uVar11 >> 1;
    }
    local_900 = lVar5;
    if (0 < iVar8) {
      lVar17 = 0;
      do {
        ppiVar1 = (int **)(plVar24[lVar17] + 0x130);
        if (*ppiVar1 == (int *)0x0) {
          _Memory = FUN_18002a710(plVar24[lVar17] + 0x28,iVar22,uVar19,uVar11);
          FUN_180029df0((int *)_Memory,ppiVar1);
          lVar5 = local_900;
          if (_Memory != (uint *)0x0) {
            free(_Memory);
            lVar5 = local_900;
          }
        }
        lVar17 = lVar17 + 1;
      } while (lVar17 < lVar5);
    }
    uVar11 = local_8f4;
    uVar19 = local_8f8;
    iVar8 = **(int **)(*plVar24 + 0x130);
    iVar22 = (*(int **)(*plVar24 + 0x130))[1];
    iVar16 = iVar8 * iVar22;
    piVar6 = (int *)malloc((longlong)iVar16 + 0x20);
    if (piVar6 != (int *)0x0) {
      piVar6[3] = iVar16;
      *piVar6 = iVar8;
      piVar6[1] = iVar22;
      piVar6[4] = 1;
      piVar6[2] = iVar8;
      *(int **)(piVar6 + 6) = piVar6 + 8;
    }
    uVar18 = SEXT48((int)local_8f0);
    local_908 = 0;
    local_8d8 = uVar18;
    local_8c8 = piVar6;
    if (0 < local_900) {
      iVar8 = uVar19 * uVar11;
      local_8c0 = 0;
      lVar5 = local_900;
      uVar23 = uVar18;
      local_8cc = iVar8;
      do {
        lVar14 = local_8c0;
        lVar17 = plVar24[local_8c0];
        *(undefined4 *)(lVar17 + 0x138) = 0;
        *(int *)(lVar17 + 0x118) = iVar8;
        if (*(int *)(lVar17 + 0x100) != 0) {
          piVar10 = *(int **)(lVar17 + 0x130);
          if ((piVar10 != (int *)0x0) && (piVar6 != (int *)0x0)) {
            if (piVar6[3] < piVar10[3]) {
              free(piVar6);
              piVar6 = FUN_180022ff0(*piVar10,piVar10[1],piVar10[4]);
              uVar23 = local_8d8;
              local_8c8 = piVar6;
            }
            *piVar6 = *piVar10;
            piVar6[1] = piVar10[1];
            piVar6[2] = piVar10[2];
            piVar6[3] = piVar10[3];
            piVar6[4] = piVar10[4];
            puVar9 = *(undefined **)(piVar6 + 6);
            uVar19 = piVar10[3];
            uVar12 = (ulonglong)uVar19;
            puVar2 = *(undefined **)(piVar10 + 6);
            if (((((puVar9 != (undefined *)0x0) && (puVar2 != (undefined *)0x0)) && (uVar19 != 0))
                && ((puVar2 + uVar12 <= puVar9 || (puVar9 + uVar12 <= puVar2)))) && (uVar19 != 0)) {
              lVar5 = -(longlong)puVar9;
              do {
                *puVar9 = puVar9[(longlong)(puVar2 + lVar5)];
                puVar9 = puVar9 + 1;
                uVar12 = uVar12 - 1;
              } while (uVar12 != 0);
            }
          }
          uVar12 = 0x100;
          local_88 = 0x100;
          local_98 = 0x100;
          iStack148 = 0;
          iStack144 = 0;
          iStack140 = 0;
          if (lVar14 < (longlong)uVar23) {
            piVar10 = (int *)((longlong)(*(int *)(plVar24[uVar23] + 0x104) + local_908) * 0x1c + 4 +
                             local_8e0);
            if (piVar10 != (int *)0x0) {
              FUN_180023cd0(piVar10,&local_98);
              uVar12 = local_88 & 0xffffffff;
              uVar23 = local_8d8;
            }
          }
          else {
            if ((((longlong)uVar23 < lVar14) &&
                (piVar10 = (int *)(local_8e0 + 4 +
                                  (longlong)(*(int *)(lVar17 + 0x104) + (int)uVar18) * 0x1c),
                piVar10 != (int *)0x0)) && ((piVar10 + 6 <= &local_98 || (&local_80 <= piVar10)))) {
              local_98 = *piVar10;
              iStack148 = piVar10[1];
              iStack144 = piVar10[2];
              iStack140 = piVar10[3];
              local_88 = *(ulonglong *)(piVar10 + 4);
              uVar12 = local_88 & 0xffffffff;
            }
          }
          local_8ec = 0;
          lVar25 = 0;
          lVar5 = local_900;
          do {
            if ((lVar14 != lVar25) && (lVar5 = local_900, *(int *)(plVar24[lVar25] + 0x100) != 0)) {
              local_70 = 0x100;
              local_80._0_4_ = 0x100;
              local_80._4_4_ = 0;
              iStack120 = 0;
              iStack116 = 0;
              if ((longlong)uVar23 < lVar25) {
                piVar6 = (int *)((longlong)(*(int *)(plVar24[lVar25] + 0x104) + (int)uVar18) * 0x1c
                                 + 4 + local_8e0);
                if (piVar6 != (int *)0x0) {
                  FUN_180023cd0(piVar6,(int *)&local_80);
                }
              }
              else {
                if (((lVar25 < (longlong)uVar23) &&
                    (puVar13 = (undefined8 *)
                               (local_8e0 + 4 +
                               (longlong)(*(int *)(plVar24[uVar23] + 0x104) + local_8ec) * 0x1c),
                    puVar13 != (undefined8 *)0x0)) &&
                   ((puVar13 + 3 <= &local_80 || (&local_68 <= puVar13)))) {
                  local_80._0_4_ = *(int *)puVar13;
                  local_80._4_4_ = *(int *)((longlong)puVar13 + 4);
                  iStack120 = *(int *)(puVar13 + 1);
                  iStack116 = *(int *)((longlong)puVar13 + 0xc);
                  local_70 = puVar13[2];
                }
              }
              iVar8 = local_8d0;
              lVar14 = (longlong)(int)local_80;
              lVar20 = (longlong)local_80._4_4_;
              lVar15 = (longlong)(int)local_70;
              local_60 = (int)((ulonglong)(iStack144 * lVar14 + local_88._4_4_ * lVar20) >> 8) +
                         iStack120;
              lVar5 = (longlong)iStack116;
              bVar7 = 0xf;
              iStack84 = (int)((ulonglong)(iStack144 * lVar5 + lVar15 * local_88._4_4_) >> 8) +
                         local_70._4_4_;
              uVar11 = 0x8000;
              iVar16 = (int)((ulonglong)(local_98 * lVar5 + lVar15 * iStack140) >> 8) -
                       (int)((ulonglong)(iStack148 * lVar14 + (int)uVar12 * lVar20) >> 8) >> 1;
              iVar22 = (int)((ulonglong)((int)uVar12 * lVar15 + iStack148 * lVar5) >> 8) +
                       (int)((ulonglong)(local_98 * lVar14 + iStack140 * lVar20) >> 8) >> 1;
              uVar21 = iVar16 * iVar16 + iVar22 * iVar22;
              local_5c = uVar21;
              uVar19 = 0;
              if (1 < uVar21) {
                do {
                  uVar3 = uVar11 + uVar19 * 2 << (bVar7 & 0x1f);
                  bVar7 = bVar7 - 1;
                  local_5c = uVar19;
                  if (uVar3 <= uVar21) {
                    local_5c = uVar19 + uVar11;
                    uVar21 = uVar21 - uVar3;
                  }
                  uVar11 = uVar11 >> 1;
                  uVar19 = local_5c;
                } while (uVar11 != 0);
              }
              if (local_5c == 0) {
                local_68 = 0x100;
                local_58 = 0x100;
              }
              else {
                local_58 = (((int)local_5c >> 1) + iVar22 * 0x100) / (int)local_5c;
                iVar22 = (((int)local_5c >> 1) + iVar16 * -0x100) / (int)local_5c;
                local_68 = CONCAT44(iVar22,local_58);
                local_5c = -iVar22;
              }
              local_50 = (int)local_68;
              uStack76 = local_68._4_4_;
              uStack68 = local_5c;
              local_48 = local_60;
              iVar22 = iStack84;
              if (local_8d0 != 0) {
                local_48 = local_60 >> 1;
                iVar22 = iStack84 >> 1;
              }
              local_40 = CONCAT44(iVar22,local_58);
              uVar18 = FUN_18002d430(local_8f4,local_8f8,local_8f4,local_8f8,&local_50,local_8a8);
              piVar6 = local_8c8;
              iVar22 = (int)uVar18;
              FUN_18002d5e0(local_8c8,local_8a8);
              if (iVar8 != 0) {
                iVar22 = iVar22 * 4;
              }
              uVar18 = (ulonglong)local_8f0;
              iVar22 = iVar22 * 100;
              iVar8 = local_8e8 * local_8e4 * 0x28;
              lVar5 = local_900;
              lVar14 = local_8c0;
              plVar24 = local_8b8;
              if (iVar22 != iVar8 &&
                  SBORROW4(iVar22,iVar8) == (int)(iVar22 + local_8e8 * local_8e4 * -0x28) < 0) {
                *(int *)(lVar17 + 0x138) = *(int *)(lVar17 + 0x138) + 1;
              }
            }
            local_8ec = local_8ec + 1;
            lVar25 = lVar25 + 1;
            uVar12 = local_88 & 0xffffffff;
            uVar23 = local_8d8;
          } while (lVar25 < lVar5);
          uVar4 = FUN_1800169c0();
          *(undefined4 *)(lVar17 + 0x118) = uVar4;
          lVar5 = local_900;
          uVar23 = local_8d8;
          iVar8 = local_8cc;
        }
        local_908 = local_908 + 1;
        local_8c0 = lVar14 + 1;
      } while (local_8c0 < lVar5);
    }
    if (piVar6 != (int *)0x0) {
      free(piVar6);
    }
  }
  FUN_18005f100(local_38 ^ (ulonglong)&stack0xfffffffffffff6c8);
  return;
}



void FUN_180017ba0(longlong param_1,int *param_2,int param_3,int param_4,undefined4 *param_5)

{
  int iVar1;
  int iVar2;
  bool bVar3;
  bool bVar4;
  int iVar5;
  int iVar6;
  longlong lVar7;
  int *piVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  ulonglong uVar14;

  bVar3 = false;
  if (0 < param_4) {
    lVar7 = 4;
    bVar4 = false;
    piVar8 = param_5 + 1;
    do {
      iVar5 = *(int *)((param_1 - (longlong)param_5) + -4 + (longlong)piVar8);
      iVar1 = *(int *)((param_1 - (longlong)param_5) + (longlong)piVar8);
      iVar10 = param_2[4];
      iVar2 = param_2[3];
      iVar6 = param_2[5];
      iVar12 = param_2[2] + 0x80 + param_2[1] * iVar1 + *param_2 * iVar5 >> 8;
      piVar8[-1] = iVar12;
      iVar5 = iVar6 + 0x80 + iVar1 * iVar10 + iVar5 * iVar2 >> 8;
      *piVar8 = iVar5;
      if ((bVar3) ||
         ((((5 < iVar12 && (iVar12 < param_3 + -5)) && (5 < iVar5)) && (iVar5 < param_4 + -5)))) {
        bVar3 = true;
      }
      else {
        bVar3 = false;
      }
      if ((bVar4) ||
         (((-5 < iVar12 && (iVar12 < param_3 + 5)) && ((-5 < iVar5 && (iVar5 < param_4 + 5)))))) {
        bVar4 = true;
      }
      else {
        bVar4 = false;
      }
      piVar8 = piVar8 + 2;
      lVar7 = lVar7 + -1;
    } while (lVar7 != 0);
    param_5[8] = *param_5;
    param_5[9] = param_5[1];
    if (!bVar3) {
      iVar5 = param_2[2];
      iVar1 = *param_2;
      iVar10 = param_2[3];
      iVar2 = param_2[5];
      iVar12 = param_3 >> 1;
      iVar11 = param_2[1] * (param_4 >> 1);
      iVar13 = param_2[4] * (param_4 >> 1);
      iVar9 = iVar5 + 0x80 + iVar1 * iVar12 + iVar11 >> 8;
      iVar6 = iVar2 + 0x80 + iVar10 * iVar12 + iVar13 >> 8;
      if (((iVar9 < 0) || (param_3 <= iVar9)) || ((iVar6 < 0 || (param_4 <= iVar6)))) {
        bVar3 = false;
      }
      else {
        bVar3 = true;
      }
      if ((bVar4) ||
         ((((-5 < iVar9 && (iVar9 < param_3 + 5)) && (-5 < iVar6)) && (iVar6 < param_4 + 5)))) {
        bVar4 = true;
      }
      else {
        bVar4 = false;
      }
      if ((!bVar3) && (bVar4)) {
        if (0 < param_3) {
          iVar13 = iVar2 + 0x80 + iVar13;
          iVar6 = iVar11 + 0x80 + iVar5;
          uVar14 = (ulonglong)((param_3 - 1U >> 4) + 1);
          do {
            if ((bVar3) ||
               (((-1 < iVar6 >> 8 && (iVar6 >> 8 < param_3)) &&
                ((-1 < iVar13 >> 8 && (iVar13 >> 8 < param_4)))))) {
              bVar3 = true;
            }
            else {
              bVar3 = false;
            }
            iVar6 = iVar6 + iVar1 * 0x10;
            iVar13 = iVar13 + iVar10 * 0x10;
            uVar14 = uVar14 - 1;
          } while (uVar14 != 0);
          if (bVar3) {
            return;
          }
        }
        if (0 < param_4) {
          iVar10 = iVar2 + 0x80 + iVar10 * iVar12;
          iVar5 = iVar5 + 0x80 + iVar1 * iVar12;
          uVar14 = (ulonglong)((param_4 - 1U >> 4) + 1);
          do {
            if ((bVar3) ||
               ((((-1 < iVar5 >> 8 && (iVar5 >> 8 < param_3)) && (-1 < iVar10 >> 8)) &&
                (iVar10 >> 8 < param_4)))) {
              bVar3 = true;
            }
            else {
              bVar3 = false;
            }
            iVar5 = iVar5 + param_2[1] * 0x10;
            iVar10 = iVar10 + param_2[4] * 0x10;
            uVar14 = uVar14 - 1;
          } while (uVar14 != 0);
        }
      }
    }
  }
  return;
}



ulonglong FUN_180017e80(int *param_1,int *param_2,int *param_3)

{
  int iVar1;
  int iVar2;

  iVar1 = param_3[1];
  iVar2 = *param_3;
  if (((iVar2 - param_1[4]) * param_2[5] - (iVar1 - param_1[5]) * param_2[4] ^
      (iVar2 - *param_1) * param_2[1] - (iVar1 - param_1[1]) * *param_2) < 0) {
    return 0;
  }
  return (ulonglong)
         (-1 < ((iVar2 - param_1[6]) * param_2[7] - (iVar1 - param_1[7]) * param_2[6] ^
               (iVar2 - param_1[2]) * param_2[3] - (iVar1 - param_1[3]) * param_2[2]));
}



void FUN_180018090(longlong param_1,int *param_2,int param_3)

{
  longlong lVar1;

  lVar1 = *(longlong *)(param_2 + (longlong)param_3 * 2 + 10);
  FUN_180005050(param_1,lVar1,param_2[5],(uint)(1 < *param_2 - 9U));
  FUN_180016590(param_3,*(int **)(param_1 + 8),*(int **)(param_1 + 0x10),*(int **)(param_1 + 0x18),
                (undefined *)(param_1 + 0x28),(longlong)param_2);
  if (*(int **)(param_1 + 0x130) != (int *)0x0) {
    FUN_1800230e0(*(int **)(param_1 + 0x130),(int **)(lVar1 + 0x130));
  }
  *(undefined4 *)(lVar1 + 0x10c) = *(undefined4 *)(param_1 + 0x10c);
  *(undefined4 *)(lVar1 + 0x110) = *(undefined4 *)(param_1 + 0x110);
  *(undefined4 *)(lVar1 + 0x150) = *(undefined4 *)(param_1 + 0x150);
  *(undefined4 *)(lVar1 + 0x14c) = *(undefined4 *)(param_1 + 0x14c);
  return;
}



undefined8 FUN_180018150(int *param_1,undefined4 *param_2,undefined4 *param_3)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  int *piVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  longlong lVar7;

  if ((param_2 != (undefined4 *)0x0) && (param_3 != (undefined4 *)0x0)) {
    iVar1 = *param_1;
    piVar2 = *(int **)(param_2 + 2);
    piVar3 = *(int **)(param_2 + 6);
    piVar4 = *(int **)(param_2 + 4);
    param_3[1] = param_2[1];
    *param_3 = *param_2;
    if (piVar2 != (int *)0x0) {
      FUN_1800230e0(piVar2,(int **)(param_3 + 2));
    }
    if (piVar4 == (int *)0x0) {
      *(undefined8 *)(param_3 + 4) = 0;
    }
    else {
      FUN_1800230e0(piVar4,(int **)(param_3 + 4));
    }
    if (piVar3 == (int *)0x0) {
      *(undefined8 *)(param_3 + 6) = 0;
    }
    else {
      FUN_1800230e0(piVar3,(int **)(param_3 + 6));
    }
    puVar6 = param_3 + 10;
    *(undefined8 *)(param_3 + 8) = 0;
    puVar5 = param_2 + 10;
    if (((puVar6 != (undefined4 *)0x0) && (puVar5 != (undefined4 *)0x0)) &&
       ((param_2 + 0x3c <= puVar6 || (param_3 + 0x3c <= puVar5)))) {
      puVar6 = (undefined4 *)((longlong)puVar6 - (longlong)puVar5);
      lVar7 = 100;
      do {
        *(undefined *)((longlong)puVar6 + (longlong)puVar5) = *(undefined *)puVar5;
        *(undefined *)((longlong)puVar6 + 1 + (longlong)puVar5) =
             *(undefined *)((longlong)puVar5 + 1);
        puVar5 = (undefined4 *)((longlong)puVar5 + 2);
        lVar7 = lVar7 + -1;
      } while (lVar7 != 0);
    }
    if (*(int **)(param_2 + 0x4c) != (int *)0x0) {
      FUN_1800230e0(*(int **)(param_2 + 0x4c),(int **)(param_3 + 0x4c));
    }
    FUN_180005050((longlong)param_2,(longlong)param_3,param_1[5],(uint)(1 < iVar1 - 9U));
    param_3[0x43] = param_2[0x43];
    param_3[0x44] = param_2[0x44];
    param_3[0x54] = param_2[0x54];
    param_3[0x53] = param_2[0x53];
    *(undefined8 *)(param_3 + 0x46) = 0;
    param_3[0x4a] = 0;
    param_3[0x4e] = 0;
    *(undefined8 *)(param_3 + 0x50) = 0;
    param_3[0x45] = 0xffffffff;
    return 1;
  }
  return 0xffffffff;
}



void FUN_1800182f0(int *param_1,undefined4 *param_2,uint *param_3,int *param_4,int param_5,
                  uint param_6)

{
  int *piVar1;
  uint uVar2;
  longlong lVar3;
  byte bVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  ulonglong uVar10;
  ulonglong uVar11;
  uint uVar12;
  longlong *plVar13;
  uint uVar14;
  longlong *plVar15;
  int local_8a8;
  uint local_8a4;
  uint local_8a0;
  int *local_898;
  uint *local_890;
  longlong local_888;
  uint *local_880;
  uint local_878;
  longlong *local_870;
  int local_868 [516];
  ulonglong local_58;

  local_58 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffff728;
  local_880 = param_3 + 0x194;
  uVar10 = SEXT48((int)param_6);
  uVar5 = param_1[7];
  uVar11 = (ulonglong)uVar5;
  uVar12 = 0xffffffff;
  local_8a0 = param_3[0x191];
  plVar13 = (longlong *)(param_1 + (uVar10 + 5) * 2);
  lVar3 = *plVar13;
  local_890 = param_3 + 0x19b;
  local_878 = param_6;
  local_898 = param_4;
  local_888 = lVar3;
  local_870 = plVar13;
  if (uVar5 < (uint)param_1[8]) {
    *param_4 = 1;
    uVar10 = FUN_1800167d0(param_2,param_1);
    piVar1 = param_1 + (longlong)(int)(uint)uVar10 * 2;
    *(undefined4 *)(*(longlong *)(piVar1 + 10) + 0x124) = *(undefined4 *)(*plVar13 + 0x124);
    *(undefined4 *)(*(longlong *)(piVar1 + 10) + 0x100) = *(undefined4 *)(lVar3 + 0x100);
    *(undefined4 *)(*(longlong *)(piVar1 + 10) + 0x14c) = param_2[0x53];
    *(undefined4 *)(*(longlong *)(piVar1 + 10) + 0x150) = param_2[0x54];
    iVar8 = param_1[0x21f9];
    if (iVar8 == 0) {
      param_1[0x21f6] = local_878;
      *(undefined4 *)(lVar3 + 0x100) = 1;
      param_1[0x21f9] = 1;
      *(undefined4 *)(*(longlong *)(piVar1 + 10) + 0x100) = 1;
    }
    if (*(int *)(lVar3 + 0x100) == 1) {
      FUN_180015fa0((longlong)param_1,(uint)uVar10,(int *)(param_3 + 0x19b));
    }
    if ((iVar8 == 0) && (0 < (int)param_3[400])) {
      FUN_180018800((longlong)param_1,param_3);
    }
    if ((param_1[7] == param_1[8]) && (*param_1 != 9 && *param_1 != 10)) {
      FUN_180017490((longlong)param_1);
    }
    goto LAB_180018737;
  }
  if ((param_5 == 0) || ((int)param_2[0x43] < 0x10)) goto LAB_180018737;
  iVar8 = *(int *)(lVar3 + 0x10c);
  bVar4 = 0;
  if ((0x3b < iVar8) &&
     (iVar6 = param_2[0x43] * 10,
     iVar6 == iVar8 * 6 || SBORROW4(iVar6,iVar8 * 6) != iVar6 + iVar8 * -6 < 0)) goto LAB_180018737;
  local_8a4 = param_1[2];
  local_8a8 = param_1[1];
  if (*(int *)(lVar3 + 0x118) != 0) {
    uVar14 = 0xfffff;
    iVar6 = 0;
    iVar8 = 0xfffff;
    uVar7 = 0;
    param_6 = uVar12;
    if (0 < (int)uVar5) {
      plVar13 = (longlong *)(param_1 + 10);
      plVar15 = plVar13;
      do {
        lVar3 = *plVar15;
        if ((*(int *)(lVar3 + 0x100) != 0) && (uVar7 != param_1[0x21f6])) {
          uVar2 = *(uint *)(lVar3 + 0x118);
          uVar10 = (ulonglong)uVar2;
          if (((int)uVar2 < (int)uVar14) ||
             ((uVar2 == uVar14 &&
              ((*(int *)(lVar3 + 0x110) < iVar8 ||
               ((*(int *)(lVar3 + 0x110) == iVar8 &&
                (*(int *)(lVar3 + 0x138) != iVar6 && iVar6 <= *(int *)(lVar3 + 0x138))))))))) {
            iVar8 = *(int *)(lVar3 + 0x110);
            iVar6 = *(int *)(lVar3 + 0x138);
            uVar12 = uVar7;
            uVar14 = uVar2;
          }
        }
        uVar7 = uVar7 + 1;
        plVar15 = plVar15 + 1;
      } while ((int)uVar7 < (int)uVar5);
      param_6 = uVar12;
      if (uVar12 != 0xffffffff) {
        if (local_8a0 == 0) {
          if ((*(int *)(*(longlong *)(param_1 + (longlong)(int)uVar12 * 2 + 10) + 0x118) == 0) &&
             (iVar8 = 0, uVar5 != 0)) {
            do {
              if ((*(int *)(*plVar13 + 0x100) == 1) && (*(int *)(*plVar13 + 0x118) == 0)) {
                iVar8 = iVar8 + 1;
              }
              plVar13 = plVar13 + 1;
              uVar11 = uVar11 - 1;
            } while (uVar11 != 0);
            uVar10 = uVar11;
            if (2 < iVar8) goto LAB_18001860c;
          }
          param_6 = 0xffffffff;
        }
        else {
          uVar5 = FUN_180016b60((longlong)param_1,(longlong)param_2,(int *)local_890,uVar12);
          if (700 < param_1[0x233e]) {
            uVar5 = uVar5 + 0x14;
          }
          uVar10 = (ulonglong)uVar5;
          if (*(uint *)(*(longlong *)(param_1 + (longlong)(int)uVar12 * 2 + 10) + 0x118) != uVar5 &&
              (int)uVar5 <=
              (int)*(uint *)(*(longlong *)(param_1 + (longlong)(int)uVar12 * 2 + 10) + 0x118)) {
            param_6 = 0xffffffff;
          }
        }
      }
    }
  }
LAB_18001860c:
  lVar3 = local_888;
  iVar8 = local_8a8;
  if (param_6 == 0xffffffff) {
    if (local_8a0 == 0) {
      uVar10 = FUN_18002d430(local_8a4,local_8a8,local_8a4,local_8a8,(int *)local_880,local_868);
      iVar9 = (int)uVar10 * 100;
      iVar6 = iVar8 * local_8a4 * 0x50;
      uVar5 = local_878;
      if (iVar9 != iVar6 && SBORROW4(iVar9,iVar6) == (int)(iVar9 + iVar8 * local_8a4 * -0x50) < 0)
      goto LAB_180018695;
    }
    else {
      local_8a4 = 0xffffffff;
      local_8a8 = 0;
      FUN_180017080((longlong)param_1,uVar10,(int *)local_890,(int *)&local_8a4,&local_8a8);
      if ((-1 < (int)local_8a4) &&
         ((uVar5 = local_8a4, 0x4f < local_8a8 ||
          ((0x3b < local_8a8 && (uVar5 = local_8a4, 1000 < param_1[0x233e])))))) {
LAB_180018695:
        param_6 = uVar5;
        bVar4 = 1;
      }
    }
    param_4 = local_898;
    if (param_6 == 0xffffffff) goto LAB_180018737;
  }
  param_4 = local_898;
  if (local_8a0 == 1) {
    *local_898 = 4 - (uint)bVar4;
    *(undefined4 *)(*(longlong *)(param_1 + (longlong)(int)param_6 * 2 + 10) + 0x124) =
         *(undefined4 *)(*local_870 + 0x124);
    FUN_180018090((longlong)param_2,param_1,param_6);
    FUN_180015fa0((longlong)param_1,param_6,(int *)local_890);
  }
  else {
    if (*(int *)(lVar3 + 0x110) + -10 <= (int)param_2[0x44]) {
      *local_898 = 2;
      FUN_180018090((longlong)param_2,param_1,param_6);
      *(undefined4 *)(*(longlong *)(param_1 + (longlong)(int)param_6 * 2 + 10) + 0x100) = 0;
    }
  }
LAB_180018737:
  if ((2 < *param_4) && (1 < *param_1 - 9U)) {
    FUN_180017490((longlong)param_1);
  }
  FUN_18005f100(local_58 ^ (ulonglong)&stack0xfffffffffffff728);
  return;
}



undefined8 FUN_1800187d0(int *param_1)

{
  if (param_1 == (int *)0x0) {
    return 0x80000002;
  }
  if (1 < *param_1 - 9U) {
    FUN_180017490((longlong)param_1);
  }
  return 0;
}



void FUN_180018800(longlong param_1,uint *param_2)

{
  uint uVar1;
  byte bVar2;
  longlong lVar3;
  uint uVar4;
  longlong lVar5;
  longlong lVar6;
  uint uVar7;
  longlong lVar8;
  uint uVar9;
  int iVar10;
  uint *puVar11;
  int iVar12;
  int iVar13;
  undefined auStack168 [32];
  uint local_88;
  longlong local_80;
  undefined8 local_78;
  int local_70;
  int local_6c;
  int local_68;
  int local_64;
  int local_60;
  int local_5c;
  int local_58;
  int local_54;
  int local_50;
  int local_4c;
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)auStack168;
  iVar12 = 0;
  puVar11 = param_2;
  local_80 = param_1;
  if (0 < (int)param_2[400]) {
    do {
      local_88 = *puVar11;
      if (param_2 + (longlong)iVar12 * 8 + 1 != (uint *)0x0) {
        FUN_180023cd0((int *)(param_2 + (longlong)iVar12 * 8 + 1),&local_60);
      }
      if (param_2 + 0x19b != (uint *)0x0) {
        lVar8 = (longlong)(int)param_2[0x19c];
        lVar5 = (longlong)(int)param_2[0x19b];
        lVar6 = (longlong)(int)param_2[0x19f];
        local_70 = (int)((ulonglong)(local_58 * lVar5 + local_4c * lVar8) >> 8) + param_2[0x19d];
        lVar3 = (longlong)(int)param_2[0x19e];
        bVar2 = 0xf;
        local_64 = (int)((ulonglong)(local_58 * lVar3 + lVar6 * local_4c) >> 8) + param_2[0x1a0];
        uVar4 = 0x8000;
        iVar13 = (int)((ulonglong)(local_60 * lVar3 + lVar6 * local_54) >> 8) -
                 (int)((ulonglong)(local_5c * lVar5 + local_50 * lVar8) >> 8) >> 1;
        iVar10 = (int)((ulonglong)(local_50 * lVar6 + local_5c * lVar3) >> 8) +
                 (int)((ulonglong)(local_60 * lVar5 + local_54 * lVar8) >> 8) >> 1;
        uVar7 = 0;
        uVar9 = iVar13 * iVar13 + iVar10 * iVar10;
        uVar1 = uVar9;
        if (1 < uVar9) {
          do {
            uVar1 = uVar4 + uVar7 * 2 << (bVar2 & 0x1f);
            bVar2 = bVar2 - 1;
            if (uVar1 <= uVar9) {
              uVar7 = uVar7 + uVar4;
              uVar9 = uVar9 - uVar1;
            }
            uVar4 = uVar4 >> 1;
            uVar1 = uVar7;
          } while (uVar4 != 0);
        }
        if (uVar1 == 0) {
          local_78 = 0x100;
          local_68 = 0x100;
          local_6c = 0;
        }
        else {
          local_68 = (((int)uVar1 >> 1) + iVar10 * 0x100) / (int)uVar1;
          local_6c = (((int)uVar1 >> 1) + iVar13 * -0x100) / (int)uVar1;
          local_78 = CONCAT44(local_6c,local_68);
          local_6c = -local_6c;
        }
      }
      *(undefined4 *)(*(longlong *)(local_80 + 0x28 + (longlong)(int)local_88 * 8) + 0x100) = 1;
      FUN_180015fa0(local_80,local_88,(int *)&local_78);
      iVar12 = iVar12 + 1;
      puVar11 = puVar11 + 8;
    } while (iVar12 < (int)param_2[400]);
  }
  FUN_18005f100(local_48 ^ (ulonglong)auStack168);
  return;
}



undefined8 FUN_180018a70(uint *param_1,uint *param_2,uint *param_3,int *param_4)

{
  longlong lVar1;
  uint *puVar2;
  uint uVar3;
  longlong lVar4;
  int iVar5;
  int local_58 [2];
  uint *local_50;

  lVar1 = 0;
  uVar3 = 0xffffffff;
  local_58[0] = 0;
  local_50 = param_2;
  if (*param_1 - 9 < 2) {
    iVar5 = 0;
    if (param_3[0x1a2] != 0) {
      uVar3 = FUN_180030410((int *)param_1,param_2,(longlong)param_3,local_58,1);
      iVar5 = local_58[0];
    }
    if (param_1[0x2380] == 0) {
      if (-1 < (int)uVar3) {
        local_58[0] = 0;
        FUN_1800209f0(param_1,uVar3,param_3[0x1a3],local_58);
        if (local_58[0] == 5) {
          iVar5 = 5;
        }
      }
      if ((param_1[0x2380] == 0) && (3 < iVar5)) {
        if (iVar5 == 5) {
          param_1[0x2381] = param_1[0x2381] + 2;
        }
        else {
          param_1[0x2381] = param_1[0x2381] + 1;
        }
        if (0x32 < (int)param_1[0x2381]) {
          param_1[0x2380] = 1;
          if ((undefined8 *)(param_1 + 0x236c) != (undefined8 *)0x0) {
            *(undefined8 *)(param_1 + 0x236c) = 0xffffffffffffffff;
            *(undefined8 *)(param_1 + 0x236e) = 0xffffffffffffffff;
            *(undefined8 *)(param_1 + 0x2370) = 0xffffffffffffffff;
            *(undefined8 *)(param_1 + 0x2372) = 0xffffffffffffffff;
            *(undefined8 *)(param_1 + 0x2374) = 0xffffffffffffffff;
            *(undefined8 *)(param_1 + 0x2376) = 0xffffffffffffffff;
            *(undefined8 *)(param_1 + 0x2378) = 0xffffffffffffffff;
            *(undefined8 *)(param_1 + 0x237a) = 0xffffffffffffffff;
            *(undefined8 *)(param_1 + 0x237c) = 0xffffffffffffffff;
            *(undefined8 *)(param_1 + 0x237e) = 0xffffffffffffffff;
          }
        }
      }
    }
  }
  else {
    if (((0 < (int)param_3[400]) && (param_3[0x191] == 1)) &&
       (FUN_180018800((longlong)param_1,param_3), param_1[7] == param_1[8])) {
      FUN_1800187d0((int *)param_1);
    }
    iVar5 = 0;
    if (((param_3[0x1a2] != 0) && (uVar3 = 0xffffffff, iVar5 = 0, 0xf < (int)param_2[0x43])) &&
       (0x41 < (int)param_2[0x44])) {
      if (param_3[0x192] == 0xffffffff) {
        uVar3 = 0xffffffff;
        iVar5 = 0;
      }
      else {
        uVar3 = FUN_1800182f0((int *)param_1,param_2,param_3,local_58,1,param_3[0x192]);
        iVar5 = local_58[0];
      }
      if ((param_1[0x2380] == 0) && (-1 < (int)uVar3)) {
        local_58[0] = 0;
        FUN_1800209f0(param_1,uVar3,param_3[0x1a3],local_58);
        if (local_58[0] == 5) {
          iVar5 = 5;
        }
      }
    }
    if ((param_1[8] == param_1[7]) && (param_1[0x2380] == 0)) {
      puVar2 = param_1 + 0x236c;
      lVar4 = 0x14;
      param_1[0x2380] = 1;
      do {
        FUN_180004ab0((void **)((longlong)param_1 + lVar1 + 0x8d10));
        lVar1 = lVar1 + 8;
        *puVar2 = 0xffffffff;
        puVar2 = puVar2 + 1;
        lVar4 = lVar4 + -1;
        param_2 = local_50;
      } while (lVar4 != 0);
    }
    if ((((uVar3 == 0xffffffff) && (param_3[0x1a2] == 1)) && (param_1[0x2380] == 0)) &&
       ((0x41 < (int)param_2[0x44] && (0xf < (int)param_2[0x43])))) {
      FUN_180018d40(param_2,(int *)param_1,(longlong)(param_1 + 0x2344),(int *)(param_1 + 0x236c));
    }
    if ((param_3[0x1a1] != 0) && (1 < *param_1 - 9)) {
      FUN_180019bb0((longlong)param_1);
      param_1[0x233d] = param_1[0x233d] + 1;
    }
  }
  if (param_4 != (int *)0x0) {
    param_4[1] = uVar3;
    *param_4 = iVar5;
  }
  return 0;
}



void FUN_180018d40(uint *param_1,int *param_2,longlong param_3,int *param_4)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  longlong lVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int local_88;
  int local_84;
  int local_80;
  int local_7c;
  int local_78 [2];
  int local_70;
  undefined8 local_6c;
  undefined4 local_60;
  undefined4 uStack92;
  undefined4 uStack88;
  undefined4 uStack84;
  undefined8 local_50;
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xffffffffffffff28;
  iVar8 = -1;
  iVar4 = 0;
  iVar7 = -1;
  iVar6 = -100;
  piVar2 = param_4;
  iVar1 = 0x15;
  do {
    iVar3 = *piVar2;
    piVar2 = piVar2 + 1;
    if (iVar6 < iVar3) {
      iVar8 = iVar4;
      iVar6 = iVar3;
    }
    if (iVar3 < iVar1) {
      iVar7 = iVar4;
    }
    iVar4 = iVar4 + 1;
    if (iVar1 <= iVar3) {
      iVar3 = iVar1;
    }
    iVar1 = iVar3;
  } while (iVar4 < 0x14);
  if ((param_2[0x2380] == 0) && (iVar6 != -1)) {
    local_70 = param_2[3];
    local_60 = 0x100;
    uStack92 = 0;
    uStack88 = 0;
    uStack84 = 0;
    local_50 = 0x100;
    local_6c = 0;
    local_78[0] = 0;
    local_7c = 0;
    local_80 = 0;
    local_84 = 0;
    local_88 = 0;
    iVar1 = FUN_18002bd60(param_1,*(uint **)(param_3 + (longlong)iVar8 * 8),(ulonglong *)&local_60,
                          &local_70,local_78,&local_7c,&local_80,&local_84,10,&local_88);
    if (0xbe < iVar1) goto LAB_180018ea7;
  }
  FUN_180018150(param_2,param_1,*(undefined4 **)(param_3 + (longlong)iVar7 * 8));
  if (iVar6 == 0x13) {
    lVar5 = 0x14;
    piVar2 = param_4;
    do {
      if (*piVar2 != -1) {
        *piVar2 = *piVar2 + -1;
      }
      piVar2 = piVar2 + 1;
      lVar5 = lVar5 + -1;
    } while (lVar5 != 0);
    iVar6 = 0x12;
  }
  param_4[iVar7] = iVar6 + 1;
LAB_180018ea7:
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xffffffffffffff28);
  return;
}



void FUN_180018ed0(longlong param_1,longlong param_2,undefined8 *param_3,int param_4,int param_5,
                  undefined8 *param_6)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  byte bVar6;
  int *piVar7;
  longlong lVar8;
  uint uVar9;
  longlong lVar10;
  longlong lVar11;
  int iVar12;
  uint uVar13;
  longlong lVar14;
  uint uVar15;
  int iVar16;
  int iVar17;
  int iVar18;
  undefined8 *puVar19;
  undefined auStack120 [32];
  int local_58;
  int local_54;
  int local_50;
  int local_4c;
  int local_48;
  int local_44;
  ulonglong local_40;

  local_40 = DAT_1800b04e8 ^ (ulonglong)auStack120;
  if (param_5 < param_4) {
    if (param_6 != (undefined8 *)0x0) {
      FUN_180023510((int *)((longlong)
                            (*(int *)(*(longlong *)(param_1 + (longlong)param_4 * 8) + 0x104) +
                            param_5) * 0x1c + param_2 + 4),(int *)param_3,param_6);
    }
  }
  else {
    if (param_4 < param_5) {
      piVar7 = (int *)((longlong)
                       (*(int *)(*(longlong *)(param_1 + (longlong)param_5 * 8) + 0x104) + param_4)
                       * 0x1c + 4 + param_2);
      if (piVar7 != (int *)0x0) {
        FUN_180023cd0(piVar7,&local_58);
      }
      if ((param_6 != (undefined8 *)0x0) && (param_3 != (undefined8 *)0x0)) {
        iVar1 = *(int *)(param_3 + 2);
        iVar16 = *(int *)((longlong)param_3 + 0xc);
        iVar17 = *(int *)param_3;
        lVar10 = (longlong)local_54;
        lVar8 = (longlong)local_58;
        lVar14 = (longlong)local_48;
        iVar2 = *(int *)((longlong)param_3 + 0x14);
        iVar3 = *(int *)((longlong)param_3 + 4);
        iVar4 = *(int *)(param_3 + 1);
        iVar12 = (int)((ulonglong)(lVar10 * iVar1 + lVar8 * iVar3) >> 8);
        *(int *)((longlong)param_6 + 4) = iVar12;
        *(int *)(param_6 + 1) = (int)((ulonglong)(lVar10 * iVar2 + lVar8 * iVar4) >> 8) + local_50;
        lVar11 = (longlong)local_4c;
        iVar18 = (int)((ulonglong)(lVar8 * iVar17 + lVar10 * iVar16) >> 8);
        *(int *)param_6 = iVar18;
        iVar16 = (int)((ulonglong)(lVar11 * iVar17 + lVar14 * iVar16) >> 8);
        *(int *)((longlong)param_6 + 0xc) = iVar16;
        iVar17 = iVar16 - iVar12 >> 1;
        iVar1 = (int)((ulonglong)(lVar14 * iVar1 + lVar11 * iVar3) >> 8);
        iVar16 = iVar1 + iVar18 >> 1;
        uVar9 = 0x8000;
        *(int *)(param_6 + 2) = iVar1;
        bVar6 = 0xf;
        *(int *)((longlong)param_6 + 0x14) =
             (int)((ulonglong)(lVar14 * iVar2 + lVar11 * iVar4) >> 8) + local_44;
        uVar13 = 0;
        uVar15 = iVar17 * iVar17 + iVar16 * iVar16;
        uVar5 = uVar15;
        if (1 < uVar15) {
          do {
            uVar5 = uVar9 + uVar13 * 2 << (bVar6 & 0x1f);
            bVar6 = bVar6 - 1;
            if (uVar5 <= uVar15) {
              uVar13 = uVar13 + uVar9;
              uVar15 = uVar15 - uVar5;
            }
            uVar9 = uVar9 >> 1;
            uVar5 = uVar13;
          } while (uVar9 != 0);
        }
        if (uVar5 == 0) {
          *param_6 = 0x100;
          *(undefined4 *)(param_6 + 2) = 0x100;
          *(undefined4 *)((longlong)param_6 + 0xc) = 0;
        }
        else {
          iVar1 = (((int)uVar5 >> 1) + iVar16 * 0x100) / (int)uVar5;
          *(int *)param_6 = iVar1;
          *(int *)(param_6 + 2) = iVar1;
          iVar1 = (((int)uVar5 >> 1) + iVar17 * -0x100) / (int)uVar5;
          *(int *)((longlong)param_6 + 4) = iVar1;
          *(int *)((longlong)param_6 + 0xc) = -iVar1;
        }
      }
    }
    else {
      if (((param_6 != (undefined8 *)0x0) && (param_3 != (undefined8 *)0x0)) &&
         ((param_3 + 3 <= param_6 || (param_6 + 3 <= param_3)))) {
        puVar19 = (undefined8 *)((longlong)param_3 - (longlong)param_6);
        lVar8 = 0x18;
        do {
          *(undefined *)param_6 = *(undefined *)((longlong)puVar19 + (longlong)param_6);
          param_6 = (undefined8 *)((longlong)param_6 + 1);
          lVar8 = lVar8 + -1;
        } while (lVar8 != 0);
      }
    }
  }
  FUN_18005f100(local_40 ^ (ulonglong)auStack120);
  return;
}



ulonglong FUN_180019150(ulonglong *param_1,undefined (*param_2) [16],uint param_3)

{
  ulonglong *puVar1;
  undefined auVar2 [16];
  short sVar3;
  uint uVar4;
  ulonglong *puVar5;
  int *piVar6;
  int iVar7;
  undefined (*pauVar8) [16];
  ulonglong uVar9;
  int iVar10;
  int iVar11;
  int iVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  undefined in_XMM1 [16];
  undefined auVar12 [16];
  int iVar18;
  int iVar19;
  uint uVar20;
  uint uVar21;
  uint uVar22;
  uint uVar23;
  uint uVar24;
  int iVar25;
  uint uVar26;
  uint uVar27;
  uint uVar28;
  undefined in_XMM4 [16];
  undefined auVar29 [16];
  uint uVar30;
  uint uVar31;
  uint uVar32;
  uint uVar33;
  undefined in_XMM7 [16];
  undefined auVar13 [16];

  uVar4 = 0;
  iVar25 = 0;
  iVar7 = 0;
  if (0 < (int)param_3) {
    iVar10 = iVar7;
    if ((7 < param_3) && (uVar4 = 0, iVar10 = 0, 1 < DAT_1800b04f8)) {
      uVar4 = param_3 & 0x80000007;
      if ((int)uVar4 < 0) {
        uVar4 = (uVar4 - 1 | 0xfffffff8) + 1;
      }
      auVar13 = in_XMM7 & (undefined  [16])0x0;
      uVar30 = 0;
      uVar31 = 0;
      uVar32 = 0;
      uVar33 = 0;
      uVar24 = 0;
      uVar26 = 0;
      uVar27 = 0;
      uVar28 = 0;
      puVar5 = param_1;
      pauVar8 = param_2;
      auVar29 = in_XMM4 & (undefined  [16])0x0;
      do {
        auVar2 = *pauVar8;
        iVar7 = iVar7 + 8;
        auVar12 = pmovsxwd(in_XMM1,ZEXT816(*puVar5));
        auVar12 = pmulld(auVar12,auVar2);
        uVar20 = -(uint)(SUB164(auVar2,0) == 0);
        uVar21 = -(uint)(SUB164(auVar2 >> 0x20,0) == 0);
        uVar22 = -(uint)(SUB164(auVar2 >> 0x40,0) == 0);
        uVar23 = -(uint)(SUB164(auVar2 >> 0x60,0) == 0);
        iVar10 = SUB164(auVar12,0) + SUB164(auVar13,0);
        iVar14 = SUB164(auVar12 >> 0x20,0) + SUB164(auVar13 >> 0x20,0);
        iVar16 = SUB164(auVar12 >> 0x40,0) + SUB164(auVar13 >> 0x40,0);
        iVar18 = SUB164(auVar12 >> 0x60,0) + SUB164(auVar13 >> 0x60,0);
        auVar13 = CONCAT412(iVar18,CONCAT48(iVar16,CONCAT44(iVar14,iVar10)));
        puVar1 = puVar5 + 1;
        uVar30 = uVar30 + 1 & ~uVar20 | uVar20 & uVar30;
        uVar31 = uVar31 + 1 & ~uVar21 | uVar21 & uVar31;
        uVar32 = uVar32 + 1 & ~uVar22 | uVar22 & uVar32;
        uVar33 = uVar33 + 1 & ~uVar23 | uVar23 & uVar33;
        puVar5 = puVar5 + 2;
        auVar2 = pauVar8[1];
        auVar12 = pmovsxwd(auVar13,ZEXT816(*puVar1));
        auVar12 = pmulld(auVar12,auVar2);
        uVar20 = -(uint)(SUB164(auVar2,0) == 0);
        uVar21 = -(uint)(SUB164(auVar2 >> 0x20,0) == 0);
        uVar22 = -(uint)(SUB164(auVar2 >> 0x40,0) == 0);
        uVar23 = -(uint)(SUB164(auVar2 >> 0x60,0) == 0);
        iVar11 = SUB164(auVar12,0) + SUB164(auVar29,0);
        iVar15 = SUB164(auVar12 >> 0x20,0) + SUB164(auVar29 >> 0x20,0);
        iVar17 = SUB164(auVar12 >> 0x40,0) + SUB164(auVar29 >> 0x40,0);
        iVar19 = SUB164(auVar12 >> 0x60,0) + SUB164(auVar29 >> 0x60,0);
        in_XMM1 = CONCAT412(iVar19,CONCAT48(iVar17,CONCAT44(iVar15,iVar11)));
        uVar24 = uVar24 + 1 & ~uVar20 | uVar20 & uVar24;
        uVar26 = uVar26 + 1 & ~uVar21 | uVar21 & uVar26;
        uVar27 = uVar27 + 1 & ~uVar22 | uVar22 & uVar27;
        uVar28 = uVar28 + 1 & ~uVar23 | uVar23 & uVar28;
        pauVar8 = pauVar8[2];
        auVar29 = in_XMM1;
      } while (iVar7 < (int)(param_3 - uVar4));
      iVar25 = uVar24 + uVar30 + uVar27 + uVar32 + uVar26 + uVar31 + uVar28 + uVar33;
      uVar4 = iVar11 + iVar10 + iVar17 + iVar16 + iVar15 + iVar14 + iVar19 + iVar18;
      iVar10 = iVar7;
    }
    if (iVar10 < (int)param_3) {
      uVar9 = (ulonglong)(param_3 - iVar10);
      piVar6 = (int *)(*param_2 + (longlong)iVar10 * 4);
      param_1 = (ulonglong *)((longlong)param_1 + (longlong)iVar10 * 2);
      do {
        iVar7 = *piVar6;
        piVar6 = piVar6 + 1;
        sVar3 = *(short *)param_1;
        param_1 = (ulonglong *)((longlong)param_1 + 2);
        uVar4 = uVar4 + sVar3 * iVar7;
        iVar10 = iVar25 + 1;
        if (iVar7 == 0) {
          iVar10 = iVar25;
        }
        iVar25 = iVar10;
        uVar9 = uVar9 - 1;
      } while (uVar9 != 0);
    }
    if (0 < iVar25) {
      return (longlong)(int)((iVar25 >> 1) + uVar4) / (longlong)iVar25 & 0xffffffff;
    }
  }
  return (ulonglong)(uVar4 & 0xffff);
}



undefined8 FUN_180019330(short *param_1,int *param_2,int param_3,uint param_4,int param_5)

{
  short sVar1;
  short sVar2;
  ulonglong uVar3;
  longlong lVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  uint uVar8;
  short sVar10;
  ulonglong uVar11;
  short *psVar12;
  int iVar13;
  int *piVar14;
  int iVar15;
  ulonglong uVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  uint uVar20;
  uint uVar21;
  uint uVar22;
  uint uVar23;
  uint uVar24;
  ulonglong uVar9;

  uVar11 = 0;
  uVar16 = 0xffffffff;
  sVar10 = 0;
  iVar5 = 0x3044;
  if (param_5 == 0) {
    iVar5 = 0x6088;
  }
  uVar8 = 0;
  iVar6 = 0x200;
  if (param_5 == 0) {
    iVar6 = 0x400;
  }
  uVar3 = uVar11;
  if ((0 < (int)param_4) && (uVar3 = 0, 7 < param_4)) {
    uVar21 = 0;
    uVar22 = 0;
    uVar23 = 0;
    uVar24 = 0;
    uVar17 = 0;
    uVar18 = 0;
    uVar19 = 0;
    uVar20 = 0;
    uVar7 = param_4 & 0x80000007;
    if ((int)uVar7 < 0) {
      uVar7 = (uVar7 - 1 | 0xfffffff8) + 1;
    }
    uVar3 = uVar11;
    uVar9 = uVar11;
    do {
      piVar14 = param_2 + uVar3;
      uVar8 = (int)uVar9 + 8;
      uVar9 = (ulonglong)uVar8;
      uVar21 = uVar21 + 1 & -(uint)(0 < *piVar14) | ~-(uint)(0 < *piVar14) & uVar21;
      uVar22 = uVar22 + 1 & -(uint)(0 < piVar14[1]) | ~-(uint)(0 < piVar14[1]) & uVar22;
      uVar23 = uVar23 + 1 & -(uint)(0 < piVar14[2]) | ~-(uint)(0 < piVar14[2]) & uVar23;
      uVar24 = uVar24 + 1 & -(uint)(0 < piVar14[3]) | ~-(uint)(0 < piVar14[3]) & uVar24;
      piVar14 = param_2 + uVar3 + 4;
      uVar3 = uVar3 + 8;
      uVar17 = uVar17 + 1 & -(uint)(0 < *piVar14) | ~-(uint)(0 < *piVar14) & uVar17;
      uVar18 = uVar18 + 1 & -(uint)(0 < piVar14[1]) | ~-(uint)(0 < piVar14[1]) & uVar18;
      uVar19 = uVar19 + 1 & -(uint)(0 < piVar14[2]) | ~-(uint)(0 < piVar14[2]) & uVar19;
      uVar20 = uVar20 + 1 & -(uint)(0 < piVar14[3]) | ~-(uint)(0 < piVar14[3]) & uVar20;
    } while ((longlong)uVar3 < (longlong)(int)(param_4 - uVar7));
    uVar3 = (ulonglong)(uVar17 + uVar21 + uVar19 + uVar23 + uVar18 + uVar22 + uVar20 + uVar24);
  }
  uVar7 = (uint)uVar3;
  lVar4 = (longlong)(int)uVar8;
  while (lVar4 < (int)param_4) {
    uVar7 = (uint)uVar3 + 1;
    if (param_2[lVar4] < 1) {
      uVar7 = (uint)uVar3;
    }
    lVar4 = lVar4 + 1;
    uVar3 = (ulonglong)uVar7;
  }
  if (0 < (int)uVar7) {
    sVar2 = FUN_180019150();
    psVar12 = param_1;
    piVar14 = param_2;
    if (0 < param_3) {
      do {
        if (*piVar14 != 0) {
          sVar1 = *psVar12;
          iVar13 = (int)sVar1 - (int)sVar2;
          uVar8 = (int)sVar10 >> 0x1f;
          iVar15 = iVar13;
          if (iVar13 < 1) {
            iVar15 = (int)sVar2 - (int)sVar1;
          }
          if ((int)(((int)sVar10 ^ uVar8) - uVar8) < iVar15) {
            uVar16 = uVar11;
            sVar10 = sVar2 - sVar1;
            if (0 < iVar13) {
              sVar10 = sVar1 - sVar2;
            }
          }
        }
        uVar8 = (int)uVar11 + 1;
        uVar11 = (ulonglong)uVar8;
        psVar12 = psVar12 + 1;
        piVar14 = piVar14 + 1;
      } while ((int)uVar8 < param_3);
      iVar15 = (int)uVar16;
      if (iVar15 != -1) {
        param_2[iVar15] = 0;
        sVar10 = param_1[iVar15];
        sVar2 = FUN_180019150(param_1,param_2,param_3);
        iVar13 = (int)sVar10 - (int)sVar2;
        if (iVar13 < 1) {
          iVar13 = (int)sVar2 - (int)sVar10;
        }
        if ((iVar6 < iVar13) && (iVar13 < iVar5)) {
          return 1;
        }
        param_2[iVar15] = 1;
      }
    }
    return 0;
  }
  return 0;
}



void FUN_180019570(longlong param_1,longlong param_2,longlong param_3,int *param_4,uint param_5,
                  int param_6)

{
  short sVar1;
  longlong lVar2;
  longlong lVar3;
  longlong lVar4;
  short sVar5;
  short sVar6;
  ulonglong uVar7;
  longlong lVar8;
  uint uVar9;
  ulonglong uVar10;
  longlong lVar11;
  int *piVar12;
  ulonglong uVar13;
  ulonglong uVar14;
  ulonglong uVar15;
  undefined auVar16 [16];
  int iVar18;
  undefined in_XMM2 [16];
  undefined auVar17 [16];
  int iVar19;
  undefined in_XMM3 [16];
  undefined auStack296 [32];
  int local_108;
  int local_104;
  int local_100;
  longlong local_f8;
  int *local_f0;
  longlong local_e8;
  longlong local_e0;
  int local_d8 [32];
  ulonglong local_58;

  local_58 = DAT_1800b04e8 ^ (ulonglong)auStack296;
  lVar11 = (longlong)(int)param_5;
  local_f8 = param_3;
  local_f0 = param_4;
  local_e8 = param_1;
  local_e0 = param_2;
  memset(local_d8,0,0x7c);
  local_108 = 0x1f;
  if (0 < (int)param_5) {
    lVar8 = lVar11;
    piVar12 = local_d8;
    while (lVar8 != 0) {
      lVar8 = lVar8 + -1;
      *piVar12 = 1;
      piVar12 = piVar12 + 1;
    }
  }
  local_100 = 0x3044;
  if (param_6 == 0) {
    local_100 = 0x6088;
  }
  local_104 = 0x200;
  if (param_6 == 0) {
    local_104 = 0x400;
  }
  while( true ) {
    uVar13 = 0;
    uVar15 = 0xffffffff;
    uVar14 = 0xffffffffffffffff;
    sVar6 = 0;
    uVar7 = uVar13;
    uVar10 = uVar13;
    if ((0 < (int)param_5) && (uVar7 = 0, uVar10 = 0, 7 < param_5)) {
      in_XMM3 = in_XMM3 & (undefined  [16])0x0;
      auVar17 = in_XMM2 & (undefined  [16])0x0;
      uVar9 = param_5 & 0x80000007;
      if ((int)uVar9 < 0) {
        uVar9 = (uVar9 - 1 | 0xfffffff8) + 1;
      }
      uVar7 = uVar13;
      do {
        auVar16 = CONCAT412(-(uint)(0 < local_d8[uVar7 + 3]),
                            CONCAT48(-(uint)(0 < local_d8[uVar7 + 2]),
                                     CONCAT44(-(uint)(0 < local_d8[uVar7 + 1]),
                                              -(uint)(0 < local_d8[uVar7]))));
        in_XMM3 = CONCAT412(SUB164(in_XMM3 >> 0x60,0) + 1,
                            CONCAT48(SUB164(in_XMM3 >> 0x40,0) + 1,
                                     CONCAT44(SUB164(in_XMM3 >> 0x20,0) + 1,SUB164(in_XMM3,0) + 1)))
                  & auVar16 | ~auVar16 & in_XMM3;
        lVar8 = uVar7 + 4;
        lVar2 = uVar7 + 5;
        lVar3 = uVar7 + 6;
        lVar4 = uVar7 + 7;
        uVar7 = uVar7 + 8;
        auVar16 = CONCAT412(-(uint)(0 < local_d8[lVar4]),
                            CONCAT48(-(uint)(0 < local_d8[lVar3]),
                                     CONCAT44(-(uint)(0 < local_d8[lVar2]),
                                              -(uint)(0 < local_d8[lVar8]))));
        auVar17 = CONCAT412(SUB164(auVar17 >> 0x60,0) + 1,
                            CONCAT48(SUB164(auVar17 >> 0x40,0) + 1,
                                     CONCAT44(SUB164(auVar17 >> 0x20,0) + 1,SUB164(auVar17,0) + 1)))
                  & auVar16 | ~auVar16 & auVar17;
      } while ((longlong)uVar7 < (longlong)(int)(param_5 - uVar9));
      iVar18 = SUB164(auVar17 >> 0x40,0) + SUB164(in_XMM3 >> 0x40,0);
      iVar19 = SUB164(auVar17 >> 0x60,0) + SUB164(in_XMM3 >> 0x60,0);
      in_XMM2 = ZEXT816(CONCAT44(iVar19,iVar18 + iVar19)) << 0x40;
      uVar10 = (ulonglong)
               (uint)(SUB164(auVar17,0) + SUB164(in_XMM3,0) + iVar18 +
                     SUB164(auVar17 >> 0x20,0) + SUB164(in_XMM3 >> 0x20,0) + iVar19);
    }
    uVar9 = (uint)uVar10;
    while ((longlong)uVar7 < lVar11) {
      uVar9 = (uint)uVar10 + 1;
      if (local_d8[uVar7] < 1) {
        uVar9 = (uint)uVar10;
      }
      uVar7 = uVar7 + 1;
      uVar10 = (ulonglong)uVar9;
    }
    if ((int)uVar9 < 1) goto LAB_1800197de;
    sVar5 = FUN_180019150(param_3,local_d8,param_5);
    param_4 = local_f0;
    param_3 = local_f8;
    uVar10 = uVar13;
    if ((int)param_5 < 1) goto LAB_180019819;
    do {
      if (local_d8[uVar13] != 0) {
        sVar1 = *(short *)(local_f8 + uVar13 * 2);
        iVar19 = (int)sVar1 - (int)sVar5;
        uVar9 = (int)sVar6 >> 0x1f;
        iVar18 = iVar19;
        if (iVar19 < 1) {
          iVar18 = (int)sVar5 - (int)sVar1;
        }
        if ((int)(((int)sVar6 ^ uVar9) - uVar9) < iVar18) {
          uVar14 = uVar13;
          uVar15 = uVar10;
          sVar6 = sVar5 - sVar1;
          if (0 < iVar19) {
            sVar6 = sVar1 - sVar5;
          }
        }
      }
      uVar9 = (int)uVar10 + 1;
      uVar13 = uVar13 + 1;
      uVar10 = (ulonglong)uVar9;
    } while ((int)uVar9 < (int)param_5);
    if ((int)uVar15 == -1) goto LAB_1800197de;
    local_d8[uVar14] = 0;
    iVar19 = (int)*(short *)(local_f8 + uVar14 * 2);
    sVar6 = FUN_180019150(local_f8,local_d8,param_5);
    iVar18 = iVar19 - sVar6;
    if (iVar18 < 1) {
      iVar18 = sVar6 - iVar19;
    }
    if ((iVar18 <= local_104) || (local_100 <= iVar18)) break;
    local_108 = local_108 + -1;
    if (local_108 < 1) {
LAB_1800197de:
      if (0 < (int)param_5) {
        lVar8 = -0xd8 - (longlong)param_4;
        do {
          if (*(int *)((longlong)register0x00000020 + lVar8 + (longlong)param_4) == 0) {
            *(undefined4 *)(local_e8 + (longlong)*param_4 * 4) = 0xffffffff;
            *(undefined4 *)(local_e0 + (longlong)*param_4 * 4) = 0xffffffff;
          }
          param_4 = param_4 + 1;
          lVar11 = lVar11 + -1;
        } while (lVar11 != 0);
      }
LAB_180019819:
      FUN_18005f100(local_58 ^ (ulonglong)auStack296);
      return;
    }
  }
  local_d8[uVar14] = 1;
  goto LAB_1800197de;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180019840(longlong param_1,longlong param_2,longlong param_3,int *param_4,short *param_5,
                  int *param_6,int param_7,int param_8)

{
  undefined8 *puVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  longlong lVar5;
  short *psVar6;
  int iVar7;
  int iVar8;
  longlong lVar9;
  longlong local_68;
  undefined8 local_60;
  undefined8 local_58;
  undefined8 local_50;
  undefined8 local_48;
  int local_40;
  ulonglong local_38;

  local_38 = DAT_1800b04e8 ^ (ulonglong)&local_68;
  local_68 = *(longlong *)(param_2 + 0xf8);
  iVar4 = 0;
  iVar7 = 0;
  lVar9 = *(longlong *)(param_1 + 0xf8);
  iVar3 = 0x1922;
  if (param_8 == 0) {
    iVar3 = 0x3244;
  }
  if (0 < param_7) {
    lVar5 = param_3 - (longlong)param_4;
    psVar6 = param_5;
    iVar7 = iVar4;
    do {
      iVar8 = *(int *)((longlong)param_4 + lVar5);
      if (iVar8 != -1) {
        iVar8 = (int)*(short *)((longlong)iVar8 * 0x38 + 6 + lVar9) -
                (int)*(short *)((longlong)*param_4 * 0x38 + 6 + local_68);
        if (iVar3 < iVar8) {
          iVar8 = iVar8 + iVar3 * -2;
        }
        else {
          if (SBORROW4(iVar8,-iVar3) != iVar8 + iVar3 < 0) {
            iVar8 = iVar8 + iVar3 * 2;
          }
        }
        *psVar6 = (short)iVar8;
        iVar7 = iVar7 + 1;
        psVar6 = psVar6 + 1;
        *param_6 = iVar4;
        param_6 = param_6 + 1;
      }
      iVar4 = iVar4 + 1;
      param_4 = param_4 + 1;
    } while (iVar4 < param_7);
  }
  lVar9 = 0;
  if ((param_8 != 0) && (0 < iVar7)) {
    local_60 = 0;
    local_58 = 0;
    local_50 = 0;
    local_48 = 0;
    local_40 = 0;
    if (0 < iVar7) {
      lVar5 = lVar9;
      do {
        uVar2 = ((param_5[lVar5] + iVar3) * 9) / (iVar3 * 2);
        if (8 < (int)uVar2) {
          uVar2 = 8;
        }
        lVar5 = lVar5 + 1;
        puVar1 = (undefined8 *)((longlong)&local_60 + (longlong)(int)uVar2 * 4);
        *(int *)puVar1 = *(int *)puVar1 + 1;
      } while (lVar5 < iVar7);
    }
    iVar4 = local_60._4_4_;
    if (local_60._4_4_ <= (int)local_60) {
      iVar4 = (int)local_60;
    }
    uVar2 = (uint)((int)local_60 < local_60._4_4_);
    if (iVar4 < (int)local_58) {
      uVar2 = 2;
      iVar4 = (int)local_58;
    }
    if (iVar4 < local_58._4_4_) {
      uVar2 = 3;
      iVar4 = local_58._4_4_;
    }
    if (iVar4 < (int)local_50) {
      uVar2 = 4;
      iVar4 = (int)local_50;
    }
    if (iVar4 < local_50._4_4_) {
      uVar2 = 5;
      iVar4 = local_50._4_4_;
    }
    if (iVar4 < (int)local_48) {
      uVar2 = 6;
      iVar4 = (int)local_48;
    }
    if (iVar4 < local_48._4_4_) {
      uVar2 = 7;
      iVar4 = local_48._4_4_;
    }
    if (iVar4 < local_40) {
      uVar2 = 8;
    }
    if (0 < iVar7) {
      do {
        iVar4 = (int)param_5[lVar9] - (int)((uVar2 - 4) * iVar3 * 2 + 4) / 9;
        if (iVar3 < iVar4) {
          iVar4 = iVar4 + iVar3 * -2;
        }
        else {
          if (SBORROW4(iVar4,-iVar3) != iVar4 + iVar3 < 0) {
            iVar4 = iVar4 + iVar3 * 2;
          }
        }
        param_5[lVar9] = (short)iVar4;
        lVar9 = lVar9 + 1;
      } while (lVar9 < iVar7);
    }
  }
  FUN_18005f100(local_38 ^ (ulonglong)&local_68);
  return;
}



void FUN_180019bb0(longlong param_1)

{
  longlong lVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  longlong lVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  uint uVar10;
  uint uVar11;
  int *piVar12;
  int iVar13;
  int iVar14;

  uVar2 = *(uint *)(param_1 + 0x1c);
  lVar1 = param_1 + 0x87e8;
  if (1 < uVar2) {
    uVar11 = 1;
    do {
      uVar7 = uVar11 - 1;
      iVar3 = *(int *)(lVar1 + (ulonglong)uVar7 * 4);
      uVar10 = uVar11 - 1;
      lVar6 = *(longlong *)(param_1 + 0x28 + (longlong)iVar3 * 8);
      iVar14 = *(int *)(lVar6 + 0x124);
      iVar9 = *(int *)(lVar6 + 0x11c);
      iVar13 = *(int *)(lVar6 + 0x100);
      if (uVar11 < uVar2) {
        piVar12 = (int *)(lVar1 + (ulonglong)uVar11 * 4);
        uVar8 = uVar11;
        do {
          lVar6 = *(longlong *)(param_1 + 0x28 + (longlong)*piVar12 * 8);
          iVar4 = *(int *)(lVar6 + 0x100);
          if ((iVar13 < iVar4) ||
             ((iVar4 == iVar13 &&
              ((*(int *)(lVar6 + 0x124) < iVar14 ||
               ((*(int *)(lVar6 + 0x124) == iVar14 && (*(int *)(lVar6 + 0x11c) < iVar9)))))))) {
            iVar14 = *(int *)(lVar6 + 0x124);
            iVar9 = *(int *)(lVar6 + 0x11c);
            iVar13 = iVar4;
            uVar10 = uVar8;
          }
          uVar8 = uVar8 + 1;
          piVar12 = piVar12 + 1;
        } while (uVar8 < uVar2);
      }
      uVar11 = uVar11 + 1;
      uVar5 = *(undefined4 *)(lVar1 + (longlong)(int)uVar10 * 4);
      *(int *)(lVar1 + (longlong)(int)uVar10 * 4) = iVar3;
      *(undefined4 *)(lVar1 + (ulonglong)uVar7 * 4) = uVar5;
    } while (uVar11 < uVar2);
  }
  return;
}



ulonglong FUN_180019dd0(longlong param_1,longlong param_2,int param_3,longlong param_4,
                       longlong param_5,longlong param_6,longlong param_7,longlong param_8,
                       longlong param_9,undefined4 *param_10)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  longlong lVar4;
  longlong lVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  uint *puVar9;
  longlong lVar10;
  longlong lVar11;
  longlong lVar12;
  longlong lVar13;

  if (param_3 < 0x32) {
    lVar13 = *(longlong *)(*(longlong *)(param_2 + 0x28 + (longlong)param_3 * 8) + 0xf8);
  }
  else {
    lVar13 = *(longlong *)(*(longlong *)(param_2 + 0x8d10 + (longlong)(param_3 + -0x32) * 8) + 0xf8)
    ;
  }
  uVar8 = 0;
  lVar4 = *(longlong *)(param_1 + 0xf8);
  iVar7 = 0;
  lVar11 = param_9 - (longlong)param_10;
  lVar12 = param_7 - (longlong)param_10;
  lVar5 = param_8 - (longlong)param_10;
  puVar9 = (uint *)(param_6 + 4);
  do {
    iVar6 = iVar7 * 2;
    iVar2 = *(int *)(param_4 + (longlong)iVar6 * 4);
    piVar1 = (int *)(param_4 + (longlong)iVar6 * 4);
    if (-1 < iVar2) {
      uVar8 = uVar8 + 1;
      iVar3 = *(int *)(param_4 + (longlong)(iVar6 + 1) * 4);
      *(uint *)((param_5 - param_6) + -4 + (longlong)puVar9) =
           (uint)*(ushort *)((longlong)iVar2 * 0x38 + 2 + lVar13);
      lVar10 = (longlong)iVar3 * 0x38 + lVar4;
      *(uint *)((param_5 - param_6) + (longlong)puVar9) =
           (uint)*(ushort *)((longlong)*piVar1 * 0x38 + 4 + lVar13);
      puVar9[-1] = (uint)*(ushort *)(lVar10 + 2);
      *puVar9 = (uint)*(ushort *)(lVar10 + 4);
      puVar9 = puVar9 + 2;
      *(int *)(lVar11 + (longlong)param_10) = *piVar1;
      *param_10 = *(undefined4 *)(param_4 + (longlong)(iVar6 + 1) * 4);
      *(int *)((longlong)param_10 + lVar12) = (int)*(short *)((longlong)*piVar1 * 0x38 + 6 + lVar13)
      ;
      *(int *)(lVar5 + (longlong)param_10) = (int)*(short *)(lVar10 + 6);
      param_10 = param_10 + 1;
    }
    iVar7 = iVar7 + 1;
  } while (iVar7 < 0x1f);
  return (ulonglong)uVar8;
}



undefined8 FUN_180019f20(uint param_1,uint *param_2,undefined4 *param_3,undefined4 *param_4)

{
  uint uVar1;
  uint uVar2;
  undefined4 uVar3;
  uint uVar4;
  uint uVar5;

  uVar3 = 0;
  uVar1 = (int)param_1 >> 8 & 0xf;
  uVar2 = param_1 & 0xf;
  if (((2 < uVar2) || (2 < uVar1)) || (uVar1 * uVar2 != 0)) {
    *param_2 = 0;
    *param_3 = 0;
    return 0x80000003;
  }
  uVar4 = 0;
  if ((uVar2 == 1) || (uVar4 = uVar2, uVar5 = 0, uVar2 == 2)) {
    uVar3 = 1;
    uVar5 = uVar4;
  }
  if (uVar1 != 1) {
    if (uVar1 == 2) {
      uVar5 = 0xfffffffe;
      uVar3 = 0;
    }
    *param_4 = 5;
    *param_2 = uVar5;
    *param_3 = uVar3;
    return 0;
  }
  *param_4 = 5;
  *param_2 = 0xffffffff;
  *param_3 = 0;
  return 0;
}



void FUN_180019fc0(longlong param_1,longlong param_2,int param_3,undefined8 param_4,int param_5,
                  int param_6,longlong param_7,ulonglong *param_8)

{
  code *pcVar1;
  int iVar2;
  undefined8 *puVar3;
  longlong lVar4;
  longlong lVar5;
  ulonglong uVar6;
  longlong lVar7;
  longlong lVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  int *piVar11;
  undefined8 *puVar12;
  uint uVar13;
  ulonglong uVar14;
  int iVar15;
  ulonglong uVar16;
  int local_488 [2];
  ulonglong *local_480;
  longlong local_478;
  longlong local_470;
  undefined8 local_468;
  undefined8 local_460;
  undefined8 local_458;
  undefined8 local_450;
  undefined8 local_448;
  undefined8 local_440;
  undefined8 local_438;
  undefined4 local_430;
  undefined2 local_42c;
  int local_3e8 [32];
  int local_368 [32];
  int local_2e8 [32];
  undefined8 local_268;
  undefined8 local_168;
  undefined8 local_68;
  undefined8 local_60;
  undefined8 local_58;
  undefined4 local_50;
  undefined2 local_4c;
  undefined local_4a;
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffb28;
  local_480 = param_8;
  uVar6 = 0;
  lVar4 = 0x7c;
  piVar11 = local_3e8;
  while (lVar4 != 0) {
    lVar4 = lVar4 + -1;
    *(undefined *)piVar11 = 0xff;
    piVar11 = (int *)((longlong)piVar11 + 1);
  }
  lVar4 = 0x7c;
  piVar11 = local_2e8;
  while (lVar4 != 0) {
    lVar4 = lVar4 + -1;
    *(undefined *)piVar11 = 0xff;
    piVar11 = (int *)((longlong)piVar11 + 1);
  }
  lVar4 = 3;
  lVar7 = 3;
  puVar12 = &local_268;
  do {
    puVar3 = puVar12;
    *puVar3 = 0xffffffffffffffff;
    puVar3[1] = 0xffffffffffffffff;
    puVar3[2] = 0xffffffffffffffff;
    puVar3[3] = 0xffffffffffffffff;
    puVar3[4] = 0xffffffffffffffff;
    puVar3[5] = 0xffffffffffffffff;
    puVar3[6] = 0xffffffffffffffff;
    puVar3[7] = 0xffffffffffffffff;
    lVar7 = lVar7 + -1;
    puVar12 = puVar3 + 8;
  } while (lVar7 != 0);
  puVar3[8] = 0xffffffffffffffff;
  puVar3[9] = 0xffffffffffffffff;
  puVar3[10] = 0xffffffffffffffff;
  puVar3[0xb] = 0xffffffffffffffff;
  puVar3[0xc] = 0xffffffffffffffff;
  puVar3[0xd] = 0xffffffffffffffff;
  puVar3[0xe] = 0xffffffffffffffff;
  puVar12 = &local_168;
  do {
    puVar3 = puVar12;
    *puVar3 = 0xffffffffffffffff;
    puVar3[1] = 0xffffffffffffffff;
    puVar3[2] = 0xffffffffffffffff;
    puVar3[3] = 0xffffffffffffffff;
    puVar3[4] = 0xffffffffffffffff;
    puVar3[5] = 0xffffffffffffffff;
    puVar3[6] = 0xffffffffffffffff;
    puVar3[7] = 0xffffffffffffffff;
    lVar4 = lVar4 + -1;
    puVar12 = puVar3 + 8;
  } while (lVar4 != 0);
  puVar3[8] = 0xffffffffffffffff;
  puVar3[9] = 0xffffffffffffffff;
  lVar4 = 0x7c;
  puVar3[10] = 0xffffffffffffffff;
  puVar3[0xb] = 0xffffffffffffffff;
  puVar3[0xc] = 0xffffffffffffffff;
  puVar3[0xd] = 0xffffffffffffffff;
  puVar3[0xe] = 0xffffffffffffffff;
  piVar11 = local_368;
  while (lVar4 != 0) {
    lVar4 = lVar4 + -1;
    *(undefined *)piVar11 = 0xff;
    piVar11 = (int *)((longlong)piVar11 + 1);
  }
  lVar4 = 0x7c;
  puVar12 = &local_468;
  while (lVar4 != 0) {
    lVar4 = lVar4 + -1;
    *(undefined *)puVar12 = 0xff;
    puVar12 = (undefined8 *)((longlong)puVar12 + 1);
  }
  if (param_3 < 0x32) {
    lVar4 = *(longlong *)(*(longlong *)(param_1 + 0x28 + (longlong)param_3 * 8) + 0xf8);
  }
  else {
    lVar4 = *(longlong *)(*(longlong *)(param_1 + 0x8d10 + (longlong)(param_3 + -0x32) * 8) + 0xf8);
  }
  lVar7 = *(longlong *)(param_2 + 0xf8);
  uVar10 = uVar6;
  uVar9 = uVar6;
  uVar14 = uVar6;
  uVar16 = uVar6;
  do {
    iVar2 = (int)uVar9 * 2;
    iVar15 = *(int *)(param_7 + (longlong)iVar2 * 4);
    if (-1 < iVar15) {
      lVar8 = (longlong)iVar15 * 0x38;
      *(int *)((longlong)local_3e8 + uVar14) = iVar15;
      uVar16 = (ulonglong)((int)uVar16 + 1);
      iVar15 = *(int *)(param_7 + (longlong)(iVar2 + 1) * 4);
      *(uint *)((longlong)&local_268 + uVar10) = (uint)*(ushort *)(lVar8 + 2 + lVar4);
      *(uint *)((longlong)&local_268 + uVar10 + 4) = (uint)*(ushort *)(lVar8 + 4 + lVar4);
      lVar5 = (longlong)iVar15 * 0x38;
      *(int *)((longlong)local_2e8 + uVar14) = iVar15;
      *(uint *)((longlong)&local_168 + uVar10) = (uint)*(ushort *)(lVar5 + 2 + lVar7);
      *(uint *)((longlong)&local_168 + uVar10 + 4) = (uint)*(ushort *)(lVar5 + 4 + lVar7);
      uVar10 = uVar10 + 8;
      *(int *)((longlong)local_368 + uVar14) = (int)*(short *)(lVar8 + 6 + lVar4);
      *(int *)((longlong)&local_468 + uVar14) = (int)*(short *)(lVar5 + 6 + lVar7);
      uVar14 = uVar14 + 4;
    }
    uVar13 = (int)uVar9 + 1;
    uVar9 = (ulonglong)uVar13;
  } while ((int)uVar13 < 0x1f);
  iVar15 = (int)uVar16;
  local_478 = param_1;
  local_470 = param_2;
  if (param_5 < iVar15) {
    local_68 = 0;
    local_60 = 0;
    local_58 = 0;
    local_50 = 0;
    local_4c = 0;
    local_4a = 0;
    local_488[0] = 0;
    FUN_180030c60((longlong)&local_168,(longlong)&local_268,(longlong)local_368,(longlong)&local_468
                  ,iVar15,param_8,(undefined1 (*) [9])&local_68,local_488,param_6,1);
    lVar4 = (longlong)iVar15;
    uVar10 = uVar6;
    if (0 < iVar15) {
      do {
        if (*(char *)((longlong)&local_68 + uVar10) == '\0') {
          local_3e8[uVar10] = -1;
          local_2e8[uVar10] = -1;
        }
        uVar10 = uVar10 + 1;
      } while ((longlong)uVar10 < lVar4);
    }
    local_468 = 0;
    local_460 = 0;
    lVar7 = *(longlong *)(local_478 + 0x28 + (longlong)param_3 * 8);
    local_458 = 0;
    local_450 = 0;
    local_448 = 0;
    local_440 = 0;
    local_438 = 0;
    local_430 = 0;
    local_42c = 0;
    memset(local_368,0,0x7c);
    iVar2 = FUN_180019840(lVar7,local_470,(longlong)local_3e8,local_2e8,(short *)&local_468,
                          local_368,iVar15,1);
    if (0 < iVar2) {
      FUN_180019570(local_3e8,local_2e8,&local_468);
    }
    uVar10 = uVar6;
    if (0 < iVar15) {
      do {
        if (local_3e8[uVar10] == -1) {
          if (0x1e < uVar10) {
            __report_rangecheckfailure();
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          *(undefined *)((longlong)&local_68 + uVar10) = 0;
        }
        uVar10 = uVar10 + 1;
        uVar9 = uVar6;
      } while ((longlong)uVar10 < lVar4);
      do {
        uVar13 = (uint)uVar9 + 1;
        if (*(char *)((longlong)&local_68 + uVar6) == '\0') {
          uVar13 = (uint)uVar9;
        }
        uVar6 = uVar6 + 1;
        uVar9 = (ulonglong)uVar13;
      } while ((longlong)uVar6 < lVar4);
      if ((3 < (int)uVar13) && (0x4000 < local_488[0])) {
        FUN_180033600((longlong)&local_168,(longlong)&local_268,(longlong)&local_68,iVar15,
                      local_488[0],param_8);
      }
    }
  }
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xfffffffffffffb28);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18001a470(int *param_1,longlong param_2,int param_3,undefined8 param_4,int param_5,
                  int param_6,longlong param_7,ulonglong *param_8,undefined1 (*param_9) [9],
                  undefined8 param_10,undefined8 *param_11)

{
  code *pcVar1;
  int iVar2;
  undefined8 *puVar3;
  ulonglong uVar4;
  longlong lVar5;
  longlong lVar6;
  ulonglong uVar7;
  longlong lVar8;
  longlong lVar9;
  int *piVar10;
  undefined8 *puVar11;
  uint uVar12;
  ulonglong uVar13;
  ulonglong uVar14;
  int iVar15;
  ulonglong uVar16;
  int local_498 [2];
  int local_490;
  longlong local_488;
  ulonglong *local_480;
  undefined1 (*local_478) [9];
  int *local_470;
  undefined8 local_468;
  undefined8 local_460;
  undefined8 local_458;
  undefined8 local_450;
  undefined8 local_448;
  undefined8 local_440;
  undefined8 local_438;
  undefined4 local_430;
  undefined2 local_42c;
  int local_3e8 [32];
  int local_368 [32];
  int local_2e8 [32];
  undefined8 local_268;
  undefined8 local_168;
  undefined8 local_68;
  undefined8 local_60;
  undefined8 local_58;
  undefined4 local_50;
  undefined2 local_4c;
  undefined local_4a;
  undefined1 local_49;
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffb18;
  uVar7 = 0;
  lVar5 = 0x7c;
  local_480 = param_8;
  piVar10 = local_368;
  while (lVar5 != 0) {
    lVar5 = lVar5 + -1;
    *(undefined *)piVar10 = 0xff;
    piVar10 = (int *)((longlong)piVar10 + 1);
  }
  lVar5 = 0x7c;
  piVar10 = local_2e8;
  while (lVar5 != 0) {
    lVar5 = lVar5 + -1;
    *(undefined *)piVar10 = 0xff;
    piVar10 = (int *)((longlong)piVar10 + 1);
  }
  lVar8 = 3;
  local_478 = param_9;
  lVar5 = 3;
  puVar11 = &local_268;
  do {
    puVar3 = puVar11;
    *puVar3 = 0xffffffffffffffff;
    puVar3[1] = 0xffffffffffffffff;
    puVar3[2] = 0xffffffffffffffff;
    puVar3[3] = 0xffffffffffffffff;
    puVar3[4] = 0xffffffffffffffff;
    puVar3[5] = 0xffffffffffffffff;
    puVar3[6] = 0xffffffffffffffff;
    puVar3[7] = 0xffffffffffffffff;
    lVar5 = lVar5 + -1;
    puVar11 = puVar3 + 8;
  } while (lVar5 != 0);
  puVar3[8] = 0xffffffffffffffff;
  puVar3[9] = 0xffffffffffffffff;
  puVar3[10] = 0xffffffffffffffff;
  puVar3[0xb] = 0xffffffffffffffff;
  puVar3[0xc] = 0xffffffffffffffff;
  puVar3[0xd] = 0xffffffffffffffff;
  puVar3[0xe] = 0xffffffffffffffff;
  puVar11 = &local_168;
  do {
    puVar3 = puVar11;
    *puVar3 = 0xffffffffffffffff;
    puVar3[1] = 0xffffffffffffffff;
    puVar3[2] = 0xffffffffffffffff;
    puVar3[3] = 0xffffffffffffffff;
    puVar3[4] = 0xffffffffffffffff;
    puVar3[5] = 0xffffffffffffffff;
    puVar3[6] = 0xffffffffffffffff;
    puVar3[7] = 0xffffffffffffffff;
    lVar8 = lVar8 + -1;
    puVar11 = puVar3 + 8;
  } while (lVar8 != 0);
  puVar3[8] = 0xffffffffffffffff;
  puVar3[9] = 0xffffffffffffffff;
  puVar3[10] = 0xffffffffffffffff;
  puVar3[0xb] = 0xffffffffffffffff;
  puVar3[0xc] = 0xffffffffffffffff;
  puVar3[0xd] = 0xffffffffffffffff;
  puVar3[0xe] = 0xffffffffffffffff;
  lVar5 = 0x7c;
  piVar10 = local_3e8;
  while (lVar5 != 0) {
    lVar5 = lVar5 + -1;
    *(undefined *)piVar10 = 0xff;
    piVar10 = (int *)((longlong)piVar10 + 1);
  }
  lVar5 = 0x7c;
  puVar11 = &local_468;
  while (lVar5 != 0) {
    lVar5 = lVar5 + -1;
    *(undefined *)puVar11 = 0xff;
    puVar11 = (undefined8 *)((longlong)puVar11 + 1);
  }
  if (param_11 != (undefined8 *)0x0) {
    lVar5 = 2;
    puVar11 = param_11;
    do {
      puVar3 = puVar11;
      *puVar3 = 0;
      puVar3[1] = 0;
      puVar3[2] = 0;
      puVar3[3] = 0;
      puVar3[4] = 0;
      puVar3[5] = 0;
      puVar3[6] = 0;
      puVar3[7] = 0;
      lVar5 = lVar5 + -1;
      puVar11 = puVar3 + 8;
    } while (lVar5 != 0);
    puVar3[8] = 0;
    puVar3[9] = 0;
    puVar3[10] = 0;
    puVar3[0xb] = 0;
    puVar3[0xc] = 0;
    puVar3[0xd] = 0;
    *(undefined4 *)(puVar3 + 0xe) = 0;
  }
  if (param_3 < 0x32) {
    lVar5 = *(longlong *)(*(longlong *)(param_1 + (longlong)param_3 * 2 + 10) + 0xf8);
  }
  else {
    lVar5 = *(longlong *)(*(longlong *)(param_1 + (longlong)(param_3 + -0x32) * 2 + 0x2344) + 0xf8);
  }
  lVar8 = *(longlong *)(param_2 + 0xf8);
  uVar4 = uVar7;
  uVar13 = uVar7;
  uVar14 = uVar7;
  uVar16 = uVar7;
  do {
    iVar2 = (int)uVar4 * 2;
    iVar15 = *(int *)(param_7 + (longlong)iVar2 * 4);
    if (-1 < iVar15) {
      lVar9 = (longlong)iVar15 * 0x38;
      *(int *)((longlong)local_368 + uVar13) = iVar15;
      uVar16 = (ulonglong)((int)uVar16 + 1);
      iVar15 = *(int *)(param_7 + (longlong)(iVar2 + 1) * 4);
      *(uint *)((longlong)&local_268 + uVar14) = (uint)*(ushort *)(lVar9 + 2 + lVar5);
      *(uint *)((longlong)&local_268 + uVar14 + 4) = (uint)*(ushort *)(lVar9 + 4 + lVar5);
      lVar6 = (longlong)iVar15 * 0x38;
      *(int *)((longlong)local_2e8 + uVar13) = iVar15;
      *(uint *)((longlong)&local_168 + uVar14) = (uint)*(ushort *)(lVar6 + 2 + lVar8);
      *(uint *)((longlong)&local_168 + uVar14 + 4) = (uint)*(ushort *)(lVar6 + 4 + lVar8);
      uVar14 = uVar14 + 8;
      *(int *)((longlong)local_3e8 + uVar13) = (int)*(short *)(lVar9 + 6 + lVar5);
      *(int *)((longlong)&local_468 + uVar13) = (int)*(short *)(lVar6 + 6 + lVar8);
      uVar13 = uVar13 + 4;
    }
    uVar12 = (int)uVar4 + 1;
    uVar4 = (ulonglong)uVar12;
  } while ((int)uVar12 < 0x1f);
  local_68 = 0;
  local_60 = 0;
  local_58 = 0;
  local_50 = 0;
  local_4c = 0;
  local_4a = 0;
  iVar15 = (int)uVar16;
  local_490 = param_3;
  local_488 = param_2;
  local_470 = param_1;
  if (param_5 < iVar15) {
    local_498[0] = 0;
    uVar12 = (uint)(1 < *param_1 - 9U);
    FUN_180030c60((longlong)&local_168,(longlong)&local_268,(longlong)local_3e8,(longlong)&local_468
                  ,iVar15,param_8,(undefined1 (*) [9])&local_68,local_498,param_6,uVar12);
    uVar4 = uVar7;
    do {
      if (*(char *)((longlong)&local_68 + uVar4) == '\0') {
        local_368[uVar4] = -1;
        local_2e8[uVar4] = -1;
      }
      uVar4 = uVar4 + 1;
    } while ((longlong)uVar4 < 0x1f);
    if (local_490 < 0x32) {
      lVar5 = *(longlong *)(param_1 + (longlong)local_490 * 2 + 10);
    }
    else {
      lVar5 = *(longlong *)(param_1 + (longlong)(local_490 + -0x32) * 2 + 0x2344);
    }
    local_468 = 0;
    local_460 = 0;
    local_458 = 0;
    local_450 = 0;
    local_448 = 0;
    local_440 = 0;
    local_438 = 0;
    local_430 = 0;
    local_42c = 0;
    memset(local_3e8,0,0x7c);
    iVar2 = FUN_180019840(lVar5,local_488,(longlong)local_368,local_2e8,(short *)&local_468,
                          local_3e8,0x1f,uVar12);
    uVar4 = uVar7;
    if (0 < iVar2) {
      FUN_180019570(local_368,local_2e8,&local_468);
    }
    do {
      if (local_368[uVar4] == -1) {
        if (0x1e < uVar4) {
          __report_rangecheckfailure();
          pcVar1 = (code *)swi(3);
          (*pcVar1)();
          return;
        }
        *(undefined *)((longlong)&local_68 + uVar4) = 0;
      }
      uVar4 = uVar4 + 1;
    } while ((longlong)uVar4 < 0x1f);
    uVar4 = uVar7;
    if ((param_9 != (undefined1 (*) [9])0x0) &&
       (((undefined1 (*) [9])&local_49 <= param_9 || (param_9[3] + 4 <= &local_68)))) {
      *(undefined4 *)*param_9 = (undefined4)local_68;
      *(undefined4 *)(*param_9 + 4) = local_68._4_4_;
      *(undefined4 *)(*param_9 + 8) = (undefined4)local_60;
      *(undefined4 *)(param_9[1] + 3) = local_60._4_4_;
      *(undefined8 *)(param_9[1] + 7) = local_58;
      *(undefined4 *)(param_9[2] + 6) = local_50;
      *(undefined2 *)(param_9[3] + 1) = local_4c;
      param_9[3][3] = local_4a;
    }
    do {
      if ((*(char *)((longlong)&local_68 + uVar7) != '\0') &&
         (uVar4 = (ulonglong)((int)uVar4 + 1), param_11 != (undefined8 *)0x0)) {
        *(undefined *)((longlong)*(int *)(param_7 + uVar7 * 8) + (longlong)param_11) = 1;
      }
      uVar7 = uVar7 + 1;
    } while ((longlong)uVar7 < 0x1f);
    if ((3 < (int)uVar4) && (0x4000 < local_498[0])) {
      FUN_180033600((longlong)&local_168,(longlong)&local_268,(longlong)&local_68,iVar15,
                    local_498[0],local_480);
    }
  }
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xfffffffffffffb18);
  return;
}



void FUN_18001aa70(int *param_1,uint *param_2,undefined8 *param_3,undefined8 *param_4,
                  undefined8 param_5,longlong param_6,int param_7,ulonglong *param_8,int *param_9)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  undefined8 *puVar6;
  longlong lVar7;
  longlong lVar8;
  int iVar9;
  undefined8 *puVar10;
  ulonglong *puVar11;
  bool bVar12;
  bool bVar13;
  int local_188;
  int local_184;
  longlong local_180;
  undefined8 local_178;
  undefined4 uStack368;
  undefined4 uStack364;
  undefined4 local_168;
  undefined4 uStack356;
  ulonglong local_160;
  undefined8 local_158 [32];
  ulonglong local_58;

  local_58 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffe38;
  lVar7 = 3;
  local_180 = param_6;
  puVar10 = local_158;
  do {
    puVar6 = puVar10;
    *puVar6 = 0xffffffffffffffff;
    puVar6[1] = 0xffffffffffffffff;
    puVar6[2] = 0xffffffffffffffff;
    puVar6[3] = 0xffffffffffffffff;
    puVar6[4] = 0xffffffffffffffff;
    puVar6[5] = 0xffffffffffffffff;
    puVar6[6] = 0xffffffffffffffff;
    puVar6[7] = 0xffffffffffffffff;
    lVar7 = lVar7 + -1;
    puVar10 = puVar6 + 8;
  } while (lVar7 != 0);
  puVar6[8] = 0xffffffffffffffff;
  lVar7 = 0x1fa;
  puVar6[9] = 0xffffffffffffffff;
  puVar6[10] = 0xffffffffffffffff;
  puVar6[0xb] = 0xffffffffffffffff;
  puVar6[0xc] = 0xffffffffffffffff;
  puVar6[0xd] = 0xffffffffffffffff;
  puVar6[0xe] = 0xffffffffffffffff;
  if (param_3 != (undefined8 *)0x0) {
    lVar8 = 0x1fa;
    puVar10 = param_3;
    do {
      puVar6 = puVar10;
      *puVar6 = 0xffffffffffffffff;
      puVar6[1] = 0xffffffffffffffff;
      puVar6[2] = 0xffffffffffffffff;
      puVar6[3] = 0xffffffffffffffff;
      puVar6[4] = 0xffffffffffffffff;
      puVar6[5] = 0xffffffffffffffff;
      puVar6[6] = 0xffffffffffffffff;
      puVar6[7] = 0xffffffffffffffff;
      lVar8 = lVar8 + -1;
      puVar10 = puVar6 + 8;
    } while (lVar8 != 0);
    puVar6[8] = 0xffffffffffffffff;
    puVar6[9] = 0xffffffffffffffff;
  }
  puVar10 = param_4;
  if (param_4 != (undefined8 *)0x0) {
    do {
      puVar6 = puVar10;
      *puVar6 = 0;
      puVar6[1] = 0;
      puVar6[2] = 0;
      puVar6[3] = 0;
      puVar6[4] = 0;
      puVar6[5] = 0;
      puVar6[6] = 0;
      puVar6[7] = 0;
      lVar7 = lVar7 + -1;
      puVar10 = puVar6 + 8;
    } while (lVar7 != 0);
    puVar6[8] = 0;
    puVar6[9] = 0;
  }
  piVar1 = param_1 + (longlong)param_7 * 2;
  puVar10 = local_158;
  FUN_180032d90(*(undefined4 **)(piVar1 + 10),(longlong)param_2,param_6 + 0x18,(longlong)puVar10,
                (undefined4 *)(param_6 + 0x18),*param_1,param_3,param_4);
  iVar4 = FUN_180019fc0((longlong)param_1,(longlong)param_2,param_7,puVar10,2,2,(longlong)local_158,
                        param_8);
  *param_9 = iVar4;
  param_9[1] = iVar4;
  if (0xe < iVar4 - 1U) goto LAB_18001ae10;
  uStack364 = 0x26;
  local_178._0_4_ = 0x17;
  local_178._4_4_ = 0x2f;
  uStack368 = 0x28;
  if (*param_1 == 0x3f) {
    uStack364 = 0x20;
  }
  local_168 = 0;
  uStack356 = 0x10;
  puVar11 = param_8;
  FUN_180033390(*(int **)(piVar1 + 10),(longlong)param_2,(longlong)local_158,(int *)param_8,
                (int *)&local_178,*param_1,(longlong)param_3);
  iVar5 = FUN_180019fc0((longlong)param_1,(longlong)param_2,param_7,puVar11,2,2,(longlong)local_158,
                        &local_178);
  if (iVar5 <= iVar4) goto LAB_18001ae10;
  local_188 = 0;
  local_184 = 0;
  FUN_18002a930(param_2,*(uint **)(piVar1 + 10),param_8,param_1[3],&local_188,&local_184);
  iVar9 = *(int *)(local_180 + 0x30) * local_188 >> 8;
  FUN_180034a50(*(int **)(piVar1 + 10),(longlong)param_2,(int *)&local_178,iVar5,
                (undefined8 *)(param_9 + 0x42),0,*param_1);
  param_9[10] = param_9[0x44];
  param_9[0xb] = param_9[0x45];
  if ((param_8 != (ulonglong *)0x0) && ((&local_160 <= param_8 || (param_8 + 3 <= &local_178)))) {
    *(int *)param_8 = (int)local_178;
    *(undefined4 *)((longlong)param_8 + 4) = local_178._4_4_;
    *(undefined4 *)(param_8 + 1) = uStack368;
    *(undefined4 *)((longlong)param_8 + 0xc) = uStack364;
    param_8[2] = CONCAT44(uStack356,local_168);
  }
  iVar2 = param_9[0x44];
  iVar3 = param_9[0x45];
  if ((iVar9 < 0x91) || (iVar2 < 0x28)) {
    if (iVar9 < 0x69) {
      if (0x41 < iVar2) {
        bVar13 = SBORROW4(iVar3,0x32);
        iVar9 = -0x32;
        bVar12 = iVar3 == 0x32;
        goto LAB_18001adff;
      }
    }
    else {
      if (0x2c < iVar2) {
        bVar13 = SBORROW4(iVar3,0x19);
        iVar9 = -0x19;
        bVar12 = iVar3 == 0x19;
LAB_18001adff:
        if (!bVar12 && bVar13 == iVar3 + iVar9 < 0) goto LAB_18001ae0c;
      }
    }
    if ((iVar3 < 0x51) && (iVar5 < 0x13)) goto LAB_18001ae10;
  }
LAB_18001ae0c:
  param_9[1] = iVar5;
LAB_18001ae10:
  if ((4 < iVar4) && (param_9[10] < 0x1e)) {
    FUN_180034a50(*(int **)(piVar1 + 10),(longlong)param_2,(int *)param_8,iVar4,
                  (undefined8 *)(param_9 + 0x42),0,*param_1);
    param_9[10] = param_9[0x44];
    param_9[0xb] = param_9[0x45];
  }
  FUN_18005f100(local_58 ^ (ulonglong)&stack0xfffffffffffffe38);
  return;
}



// WARNING: Removing unreachable block (ram,0x00018001b218)
// WARNING: Could not reconcile some variable overlaps
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18001ae80(int *param_1,longlong param_2,longlong param_3,longlong param_4,longlong param_5,
                  int param_6,undefined (*param_7) [16],int *param_8)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  undefined8 *puVar6;
  longlong lVar7;
  ulonglong uVar8;
  longlong lVar9;
  ulonglong uVar10;
  undefined4 *puVar11;
  int *piVar12;
  undefined8 *puVar13;
  undefined auVar14 [16];
  undefined8 in_stack_fffffffffffff0b0;
  int local_f38;
  uint local_f34;
  undefined4 local_f30;
  int local_f28;
  int local_f24;
  int local_f20;
  uint local_f1c;
  undefined4 local_f18;
  undefined4 local_f14;
  undefined4 local_f10;
  undefined4 local_f0c;
  undefined4 local_f08;
  longlong local_f00;
  int local_ef8;
  int iStack3828;
  int iStack3824;
  int iStack3820;
  undefined8 local_ee8;
  undefined local_ee0 [16];
  undefined8 local_ed0;
  ulonglong local_ec8;
  int iStack3776;
  undefined4 uStack3772;
  undefined8 local_eb8;
  undefined local_eb0 [16];
  undefined8 local_ea0;
  undefined8 local_e98 [32];
  undefined8 local_d98 [32];
  undefined8 local_c98 [32];
  int local_b98 [360];
  undefined4 local_5f8 [360];
  ulonglong local_58;

  local_58 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffff088;
  lVar7 = 3;
  lVar9 = 3;
  local_f38 = param_6;
  puVar13 = local_e98;
  do {
    puVar6 = puVar13;
    *puVar6 = 0xffffffffffffffff;
    puVar6[1] = 0xffffffffffffffff;
    puVar6[2] = 0xffffffffffffffff;
    puVar6[3] = 0xffffffffffffffff;
    puVar6[4] = 0xffffffffffffffff;
    puVar6[5] = 0xffffffffffffffff;
    puVar6[6] = 0xffffffffffffffff;
    puVar6[7] = 0xffffffffffffffff;
    lVar9 = lVar9 + -1;
    puVar13 = puVar6 + 8;
  } while (lVar9 != 0);
  puVar6[8] = 0xffffffffffffffff;
  lVar9 = 3;
  puVar6[9] = 0xffffffffffffffff;
  puVar6[10] = 0xffffffffffffffff;
  puVar6[0xb] = 0xffffffffffffffff;
  puVar6[0xc] = 0xffffffffffffffff;
  puVar6[0xd] = 0xffffffffffffffff;
  puVar6[0xe] = 0xffffffffffffffff;
  puVar13 = local_d98;
  do {
    puVar6 = puVar13;
    *puVar6 = 0xffffffffffffffff;
    puVar6[1] = 0xffffffffffffffff;
    puVar6[2] = 0xffffffffffffffff;
    puVar6[3] = 0xffffffffffffffff;
    puVar6[4] = 0xffffffffffffffff;
    puVar6[5] = 0xffffffffffffffff;
    puVar6[6] = 0xffffffffffffffff;
    puVar6[7] = 0xffffffffffffffff;
    lVar9 = lVar9 + -1;
    puVar13 = puVar6 + 8;
  } while (lVar9 != 0);
  puVar6[8] = 0xffffffffffffffff;
  puVar6[9] = 0xffffffffffffffff;
  puVar6[10] = 0xffffffffffffffff;
  puVar6[0xb] = 0xffffffffffffffff;
  puVar6[0xc] = 0xffffffffffffffff;
  puVar6[0xd] = 0xffffffffffffffff;
  puVar6[0xe] = 0xffffffffffffffff;
  puVar13 = local_c98;
  do {
    puVar6 = puVar13;
    *puVar6 = 0xffffffffffffffff;
    puVar6[1] = 0xffffffffffffffff;
    puVar6[2] = 0xffffffffffffffff;
    puVar6[3] = 0xffffffffffffffff;
    puVar6[4] = 0xffffffffffffffff;
    puVar6[5] = 0xffffffffffffffff;
    puVar6[6] = 0xffffffffffffffff;
    puVar6[7] = 0xffffffffffffffff;
    lVar7 = lVar7 + -1;
    puVar13 = puVar6 + 8;
  } while (lVar7 != 0);
  iVar4 = *param_8;
  iVar5 = 0;
  puVar6[8] = 0xffffffffffffffff;
  puVar6[9] = 0xffffffffffffffff;
  puVar6[10] = 0xffffffffffffffff;
  puVar6[0xb] = 0xffffffffffffffff;
  puVar6[0xc] = 0xffffffffffffffff;
  puVar6[0xd] = 0xffffffffffffffff;
  puVar6[0xe] = 0xffffffffffffffff;
  local_ee0 = _DAT_1800a4170;
  local_ed0 = 0x100;
  local_eb0 = _DAT_1800a4170;
  local_ea0 = 0x100;
  if ((iVar4 < 9) && (iVar4 = param_8[1], iVar4 < 9)) {
    auVar14 = _DAT_1800a4170;
    if (iVar4 < 4) {
      puVar13 = local_d98;
      FUN_1800340c0(*(undefined4 **)(param_1 + (longlong)param_6 * 2 + 10),param_2,local_e98,puVar13
                    ,param_5 + 0x18,in_stack_fffffffffffff0b0,param_3,param_4);
      local_eb8 = 0x100;
      local_ec8 = 0x100;
      iStack3776 = 0;
      uStack3772 = 0;
      local_ee8 = 0x100;
      local_ef8 = 0x100;
      iStack3828 = 0;
      iStack3824 = 0;
      iStack3820 = 0;
      iVar3 = FUN_180019fc0((longlong)param_1,param_2,param_6,puVar13,2,2,(longlong)local_e98,
                            &local_ec8);
      iVar4 = FUN_180019fc0((longlong)param_1,param_2,param_6,puVar13,2,2,(longlong)local_d98,
                            (ulonglong *)&local_ef8);
      if (iVar4 < iVar3) {
        local_ee0._0_12_ = CONCAT48(iStack3776,local_ec8);
        local_ee0 = CONCAT412(uStack3772,local_ee0._0_12_);
        local_ed0 = local_eb8;
        iVar4 = iVar3;
      }
      else {
        local_ee0._0_12_ = CONCAT48(iStack3824,CONCAT44(iStack3828,local_ef8));
        local_ee0 = CONCAT412(iStack3820,local_ee0._0_12_);
        local_ed0 = local_ee8;
      }
      if (*param_8 < iVar4) {
        *param_8 = iVar4;
      }
    }
    else {
      if ((param_7 != (undefined (*) [16])0x0) &&
         ((param_7[1] + 8 <= local_ee0 || ((undefined (*) [16])&local_ec8 <= param_7)))) {
        local_ee0 = *param_7;
        local_ed0 = *(undefined8 *)param_7[1];
      }
    }
    if (2 < iVar4) {
      piVar1 = *(int **)(param_1 + (longlong)param_6 * 2 + 10);
      iStack3820 = 0x26;
      local_f00 = *(longlong *)(param_2 + 0xf8);
      local_ec8 = *(ulonglong *)(piVar1 + 0x3e);
      local_f24 = piVar1[1];
      local_f28 = *piVar1;
      local_ef8 = 0x17;
      iStack3828 = 0x2f;
      iStack3824 = 0x28;
      local_ee8 = 0x1000000000;
      if (*param_1 == 0x3f) {
        iStack3820 = 0x20;
      }
      local_f30 = *(undefined4 *)(param_2 + 0xf0);
      local_f34 = piVar1[0x3c];
      iVar5 = local_f34 * 2;
      if (0 < iVar5) {
        uVar10 = (longlong)iVar5 & 0x3fffffffffffffff;
        uVar8 = (longlong)iVar5 & 0x3fffffffffffffff;
        puVar11 = local_5f8;
        while (uVar8 != 0) {
          uVar8 = uVar8 - 1;
          *puVar11 = 0xc0;
          puVar11 = puVar11 + 1;
        }
        piVar12 = local_b98;
        while (param_6 = local_f38, uVar10 != 0) {
          uVar10 = uVar10 - 1;
          *piVar12 = -1;
          piVar12 = piVar12 + 1;
        }
      }
      local_f1c = piVar1[0x42];
      local_f14 = *(undefined4 *)(param_2 + 0x108);
      local_f20 = 0;
      local_f18 = 0;
      local_f10 = 0x17;
      local_f0c = 0x2f;
      local_f08 = 0x10;
      FUN_180034540(local_ec8,local_f00,(int *)local_ee0,&local_f28,(longlong)local_5f8,
                    (longlong)local_b98);
      uVar2 = local_f34;
      local_f20 = piVar1[0x42];
      local_f18 = *(undefined4 *)(param_2 + 0x108);
      local_f14 = local_f30;
      puVar11 = local_5f8;
      local_f1c = local_f34;
      FUN_180034540(local_ec8,local_f00,(int *)local_ee0,&local_f28,(longlong)puVar11,
                    (longlong)local_b98);
      uVar8 = (ulonglong)uVar2;
      FUN_180032530(local_f00,(longlong)local_5f8,local_b98,uVar2,puVar11,(longlong)&local_ef8,
                    (longlong)local_c98);
      iVar5 = FUN_180019fc0((longlong)param_1,param_2,param_6,uVar8,2,2,(longlong)local_c98,
                            (ulonglong *)local_eb0);
      auVar14 = local_eb0;
    }
    if (iVar4 < iVar5) {
      FUN_180034a50(*(int **)(param_1 + (longlong)param_6 * 2 + 10),param_2,(int *)local_eb0,iVar5,
                    (undefined8 *)&local_ef8,0,*param_1);
      FUN_18002c510((int *)local_eb0,(int *)&local_ec8);
      if (((iStack3776 < 0x28f6) && ((int)local_ec8 - 0xeaU < 0x30)) &&
         (((0x28 < iStack3824 && (0x17 < iStack3828)) ||
          ((((0x2d < iStack3824 && (0xb < iStack3828)) || (0x4b < iStack3824)) || (0x10 < iVar5)))))
         ) {
        if ((param_7 != (undefined (*) [16])0x0) &&
           (((undefined (*) [16])local_e98 <= param_7 || (param_7[1] + 8 <= local_eb0)))) {
          *param_7 = auVar14;
          *(undefined8 *)param_7[1] = local_ea0;
        }
        param_8[10] = iStack3824;
        piVar1 = param_8 + 0x42;
        param_8[0xb] = iStack3820;
        param_8[2] = iVar5;
        if ((piVar1 != (int *)0x0) && ((local_ee0 <= piVar1 || (param_8 + 0x48 <= &local_ef8)))) {
          *piVar1 = local_ef8;
          param_8[0x43] = iStack3828;
          param_8[0x44] = iStack3824;
          param_8[0x45] = iStack3820;
          *(undefined8 *)(param_8 + 0x46) = local_ee8;
        }
      }
    }
  }
  if (0x1e < param_8[10]) {
    if (param_8[0x46] < 10) {
      *param_8 = *param_8 + 1;
      param_8[1] = param_8[1] + 1;
    }
    iVar4 = *param_8;
    if (0x1f < iVar4) {
      iVar4 = 0x1f;
    }
    *param_8 = iVar4;
    iVar4 = param_8[1];
    if (0x1f < iVar4) {
      iVar4 = 0x1f;
    }
    param_8[1] = iVar4;
  }
  FUN_18005f100(local_58 ^ (ulonglong)&stack0xfffffffffffff088);
  return;
}



// WARNING: Removing unreachable block (ram,0x00018001b769)
// WARNING: Type propagation algorithm not settling

void FUN_18001b5a0(int *param_1,undefined8 param_2,undefined8 param_3,int *param_4,
                  undefined4 *param_5,uint *param_6)

{
  int iVar1;
  int iVar2;
  int iVar3;
  bool bVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  int iVar9;
  int iVar10;
  int iVar11;
  int local_128 [4];
  undefined4 local_118;
  undefined4 uStack276;
  undefined4 uStack272;
  undefined4 uStack268;
  undefined8 local_108;
  undefined4 local_100 [4];
  undefined4 local_f0;
  undefined4 local_ec;
  undefined8 local_e8;
  undefined8 local_e0;
  int local_d8 [4];
  undefined4 local_c8;
  undefined4 local_c4;
  undefined8 local_c0;
  undefined8 local_b8;
  undefined8 local_b0;
  undefined4 uStack168;
  undefined4 uStack164;
  undefined4 local_a0;
  undefined4 local_9c;
  undefined8 local_98;
  undefined8 local_90;
  undefined4 local_88;
  undefined8 local_84;
  undefined8 local_7c;
  undefined4 local_74;
  undefined4 uStack112;
  undefined4 uStack108;
  undefined4 uStack104;
  undefined4 uStack100;
  undefined4 local_60 [4];
  undefined4 local_50;
  undefined4 local_4c;
  undefined8 local_48;
  undefined8 local_40;
  ulonglong local_38 [2];
  longlong lVar8;

  local_38[0] = DAT_1800b04e8 ^ (ulonglong)local_128;
  iVar1 = *param_1;
  iVar10 = 0;
  iVar2 = param_1[9];
  iVar7 = param_4[0xf];
  iVar3 = param_1[1];
  local_b0._0_4_ = 0xfffffff;
  local_b0._4_4_ = 0xcf;
  uStack168 = 0xcd;
  uStack164 = 200;
  local_a0 = 199;
  local_128[0] = 0xfffffff;
  local_128[1] = 0xc3;
  local_128[2] = 0xc3;
  local_128[3] = 0xc3;
  local_9c = 0xc1;
  local_d8[0] = 0xfffffff;
  local_d8[1] = 0x5a;
  local_d8[2] = 0x55;
  local_d8[3] = 0x50;
  local_98 = 0xb9000000b9;
  local_90 = 0xb9000000b9;
  local_118 = 0xb9;
  uStack276 = 0xaf;
  uStack272 = 0xaa;
  uStack268 = 0xaa;
  local_108 = 0xa0000000a0;
  local_c8 = 0x49;
  local_c4 = 0x3f;
  local_c0 = 0x3700000037;
  local_b8 = 0x3700000037;
  if (param_4[0x10] == 0) {
    local_e0 = 0xb4000000c0;
    if (iVar1 < 5) {
      local_128[0] = 0xfffffff;
      local_128[1] = 0xcd;
      local_128[2] = 0xcd;
      local_128[3] = 0xcd;
      local_108 = 0xb4000000c0;
      local_118 = 0xcc;
      uStack276 = 0xcc;
      uStack272 = 0xcb;
      uStack268 = 200;
    }
    if (iVar3 < 0xe) {
      iVar9 = 0;
      if (iVar2 < 0x5b) {
        iVar9 = 3;
      }
      iVar10 = 0;
      if (iVar2 < 0x4c) {
        iVar10 = 3;
      }
      iVar10 = (param_1[0xe] + param_1[0xd]) * 5 + iVar9 + iVar10;
    }
  }
  else {
    local_48 = 0xb9000000b9;
    local_40 = 0xb9000000b9;
    local_84 = 0xcb000000cb;
    local_7c = 0xcb000000cb;
    local_e8 = 0x3700000037;
    local_e0 = 0x3700000037;
    local_50 = 0xc9;
    local_4c = 0xc3;
    local_88 = 0xfffffff;
    uStack100 = 0xb8;
    local_f0 = 0x4b;
    local_ec = 0x41;
    local_74 = 0xca;
    uStack112 = 0xc9;
    uStack108 = 200;
    uStack104 = 0xc0;
    if ((local_38 <= &local_b0) || (&local_88 <= local_60)) {
      local_b0._0_4_ = 0xfffffff;
      local_b0._4_4_ = 0xcf;
      uStack168 = 0xcd;
      uStack164 = 0xca;
      local_a0 = 0xc9;
      local_9c = 0xc3;
      local_98 = 0xb9000000b9;
      local_90 = 0xb9000000b9;
    }
    if ((local_60 <= local_128) || (local_100 <= &local_88)) {
      local_128[0] = 0xfffffff;
      local_128[1] = 0xcb;
      local_128[2] = 0xcb;
      local_128[3] = 0xcb;
      local_108 = 0xb8000000c0;
      local_118 = 0xcb;
      uStack276 = 0xca;
      uStack272 = 0xc9;
      uStack268 = 200;
    }
    local_c8 = 0x4b;
    local_c4 = 0x41;
    local_c0 = 0x3700000037;
    local_d8[0] = 0xfffffff;
    local_d8[1] = 0x5f;
    local_d8[2] = 0x58;
    local_d8[3] = 0x52;
    local_b8 = 0x3700000037;
    if ((iVar3 < 0xb) || (iVar1 < 4)) {
      iVar10 = ((uint)(iVar1 < 4) + param_1[0xd]) * 5;
    }
  }
  local_98 = 0xb9000000b9;
  local_c0 = 0x3700000037;
  local_90 = 0xb9000000b9;
  uStack168 = 0xcd;
  local_b0._4_4_ = 0xcf;
  local_b0._0_4_ = 0xfffffff;
  local_b8 = 0x3700000037;
  local_d8[0] = 0xfffffff;
  local_128[0] = 0xfffffff;
  iVar9 = (iVar3 - param_4[1]) + -4;
  if (iVar9 < 0) {
    iVar9 = 0;
  }
  iVar11 = param_1[8] - iVar10;
  iVar10 = param_1[5] - iVar10;
  iVar5 = 9;
  if (iVar9 < 9) {
    iVar5 = iVar9;
  }
  lVar8 = (longlong)iVar5;
  if (((iVar11 - *param_4 < *(int *)((longlong)&local_b0 + lVar8 * 4)) ||
      (iVar10 - *param_4 < local_128[lVar8])) || (uVar6 = 1, iVar2 < local_d8[lVar8])) {
    uVar6 = 0;
  }
  *param_6 = uVar6;
  if ((iVar7 == 0x3f) &&
     (((iVar3 < 8 && ((iVar10 < 0xd7 || (iVar11 < 0xd4)))) || ((iVar3 < 10 && (iVar11 < 0xcc)))))) {
    bVar4 = true;
  }
  else {
    bVar4 = false;
  }
  iVar7 = iVar3 + -4;
  if (iVar7 < 0) {
    iVar7 = 0;
  }
  iVar9 = 9;
  if (iVar7 < 9) {
    iVar9 = iVar7;
  }
  iVar7 = 100;
  if (local_d8[iVar9] + 10 < 100) {
    iVar7 = local_d8[iVar9] + 10;
  }
  if (((iVar1 < 6) && (iVar3 < 0x10)) ||
     ((bVar4 || (((iVar11 < *(int *)((longlong)&local_b0 + (longlong)iVar9 * 4) + 2 ||
                  (iVar10 < 0xce)) || (iVar2 < iVar7)))))) {
    *param_5 = 0;
    *param_6 = *param_6;
  }
  else {
    *param_5 = 1;
    *param_6 = *param_6 | 1;
  }
  FUN_18005f100(local_38[0] ^ (ulonglong)local_128);
  return;
}



void FUN_18001b960(int *param_1,undefined8 param_2,undefined8 param_3,int *param_4,int param_5,
                  int *param_6,int *param_7,undefined4 *param_8)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int local_88 [4];
  undefined8 local_78;
  undefined8 local_70;
  int local_68 [4];
  undefined4 local_58;
  undefined4 uStack84;
  undefined4 uStack80;
  undefined4 uStack76;
  int local_48 [4];
  undefined4 local_38;
  undefined4 uStack52;
  undefined4 uStack48;
  undefined4 uStack44;

  iVar5 = param_1[5];
  iVar7 = *param_1;
  iVar8 = iVar5 - *param_4;
  iVar1 = param_1[10];
  iVar9 = param_1[1];
  iVar3 = iVar5 + -4;
  if (4 < iVar7) {
    iVar3 = iVar5;
  }
  iVar5 = param_1[9];
  local_78 = 0xb9000000b9;
  local_70 = 0xb9000000b9;
  local_88[0] = 0xfffffff;
  local_88[1] = 0xce;
  local_88[2] = 0xc9;
  local_88[3] = 0xc4;
  local_68[0] = 0xfffffff;
  local_68[1] = 0xfffffff;
  local_68[2] = 0xfffffff;
  local_68[3] = 0xcf;
  local_58 = 0xcd;
  uStack84 = 0xcb;
  uStack80 = 0xc4;
  uStack76 = 0xbb;
  local_48[0] = 0xfffffff;
  local_48[1] = 0xfffffff;
  local_48[2] = 0xd1;
  local_48[3] = 0xd0;
  local_38 = 0xd0;
  uStack52 = 0xcf;
  uStack48 = 0xcf;
  uStack44 = 0xcf;
  if ((0x3c < iVar1) && (4 < iVar7)) {
    iVar2 = (iVar1 + -0x3c) / 5;
    iVar9 = iVar9 + 1 + iVar2;
    iVar7 = iVar7 + 1 + iVar2;
  }
  if ((param_5 != 0) && (iVar5 < 0x80)) {
    iVar2 = (0x80 - iVar5) / 10;
    iVar9 = iVar9 + (-1 - iVar2);
    iVar7 = iVar7 + (-1 - iVar2);
  }
  iVar2 = iVar9 + -7;
  if (iVar2 < 0) {
    iVar2 = 0;
  }
  iVar10 = 7;
  if (iVar2 < 7) {
    iVar10 = iVar2;
  }
  iVar2 = (iVar7 - param_4[1]) + -7;
  if (iVar2 < 0) {
    iVar2 = 0;
  }
  iVar6 = 7;
  if (iVar2 < 7) {
    iVar6 = iVar2;
  }
  iVar2 = (iVar9 - param_4[1]) + -7;
  if (iVar2 < 0) {
    iVar2 = 0;
  }
  iVar11 = 7;
  if (iVar2 < 7) {
    iVar11 = iVar2;
  }
  if ((param_4[0x10] != 0) && (iVar9 < 0xb)) {
    iVar8 = iVar8 + (param_1[0xd] + param_1[0xc]) * -4;
    iVar3 = iVar3 + (param_1[0xd] + param_1[0xc]) * -4;
  }
  iVar2 = local_88[iVar6];
  if (((iVar2 < iVar8) || (local_68[iVar11] < iVar8)) || (iVar6 = 0, 0xd < iVar7)) {
    iVar6 = 1;
  }
  iVar4 = param_4[0xf];
  *param_7 = iVar6;
  if (iVar4 == 7) {
    if (((iVar9 <= iVar7) || (7 < iVar7)) || (iVar4 = 6, param_1[0xd] == 0)) {
      iVar4 = 0;
    }
    if (((100 < iVar5) || (0xb < iVar9)) || (iVar5 = 2, 0x41 < iVar1)) {
      iVar5 = 0;
    }
    iVar3 = iVar3 - (iVar5 + iVar4);
  }
  iVar5 = 1;
  if (((iVar6 == 0) || (((iVar7 < 5 && (param_1[4] < 0xeb)) && (iVar3 < 0xd9)))) ||
     ((((iVar3 <= local_48[iVar10] && ((iVar3 < 0xc3 || (iVar7 < 0x10)))) &&
       ((((iVar3 < 0xbe || (iVar7 < 0x12)) && (((iVar9 < 0x13 || (iVar7 < 0xb)) || (iVar3 < 0xc4))))
        && (((iVar1 < 0x3d || (iVar8 < 0xc6)) || (iVar7 < 0xd)))))) &&
      (((iVar9 < 0x11 || (iVar7 < 0xb)) || (iVar8 < 0xc9)))))) {
    iVar5 = 0;
  }
  *param_6 = iVar5;
  if (param_8 != (undefined4 *)0x0) {
    if (((iVar6 == 0) || ((0x14 < iVar7 && (0xb8 < iVar8)))) ||
       ((0xcc < iVar8 || ((iVar2 + 10 <= iVar8 || (local_68[iVar11] + 10 <= iVar8)))))) {
      *param_8 = 0;
    }
    else {
      *param_8 = 1;
    }
  }
  if ((((iVar5 != 1) || (*param_1 < 8)) || (param_1[1] < 0xc)) || (iVar7 = 2, param_1[0xb] < 0x24))
  {
    iVar7 = iVar5;
  }
  *param_6 = iVar7;
  return;
}



void FUN_18001bc60(int *param_1,longlong param_2,int *param_3)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  bool bVar7;

  iVar1 = param_1[5];
  iVar2 = param_1[1];
  iVar3 = *param_1;
  iVar4 = param_1[9];
  iVar5 = *(int *)(param_2 + 0x40);
  iVar6 = param_1[8] + iVar1;
  if (((iVar2 < 0xb) && (param_1[8] < 0xb4)) ||
     ((*param_3 != 0 &&
      (((((((iVar4 < 0x2d && (iVar2 < 9)) && (iVar6 < 0x1bf)) ||
          (((iVar4 < 0x41 && (iVar2 < 7)) && (iVar6 < 0x1bd)))) ||
         (((iVar4 < 0x4b && (iVar2 < 0x10)) && (iVar6 < 0x1af)))) ||
        (((iVar4 < 0x80 && (iVar2 < 0xc)) && (iVar6 < 0x1aa)))) ||
       ((((iVar4 < 0x69 && (iVar3 < 9)) && (iVar6 < 0x1b5)) ||
        (((((iVar4 < 0x80 && (iVar3 < 8)) && (iVar6 < 0x19b)) || ((iVar4 < 0x1e && (iVar3 < 10))))
         || ((iVar3 < iVar2 &&
             ((((iVar3 < 8 && (iVar2 < 0xd)) && (iVar1 < 0xd8)) &&
              ((param_1[10] < 0x42 && (iVar6 < 0x1a5)))))))))))))))) {
    *param_3 = 0;
  }
  if (iVar5 == 0) {
    if ((*param_3 != 0) && (((iVar2 < 0x11 && (iVar6 < 0x191)) || ((iVar2 < 9 && (iVar6 < 0x1a5)))))
       ) {
      *param_3 = 0;
    }
    if (param_1[0xc] == 0) {
      return;
    }
    if (6 < iVar3) {
      return;
    }
    if (0x199 < iVar6) {
      return;
    }
    if (0xe < iVar2) {
      return;
    }
    bVar7 = SBORROW4(param_1[0xb],0x14);
    iVar6 = param_1[0xb] + -0x14;
  }
  else {
    if (iVar5 != 1) {
      return;
    }
    if (((*param_3 != 0) && (iVar3 < iVar2)) &&
       ((iVar3 < 8 && (((iVar1 < 0xdb && (param_1[10] < 0x42)) && (iVar6 < 0x1a5)))))) {
      *param_3 = 0;
    }
    if (param_1[4] == 0x80) {
      if (0x185 < iVar6) {
        return;
      }
      if (iVar2 < 0xf) {
        *param_3 = 0;
      }
    }
    if (0x185 < iVar6) {
      return;
    }
    if (0xc < iVar2) {
      return;
    }
    if (0x13 < param_1[0xb]) {
      return;
    }
    bVar7 = SBORROW4(param_1[10],0x28);
    iVar6 = param_1[10] + -0x28;
  }
  if (bVar7 != iVar6 < 0) {
    *param_3 = 0;
  }
  return;
}



void FUN_18001be10(int *param_1,int *param_2,int *param_3,int *param_4)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  bool bVar6;
  int iVar7;
  int iVar8;
  int iVar9;

  iVar2 = *param_1;
  iVar7 = param_1[5] - *param_2;
  iVar8 = iVar2 - param_2[1];
  iVar9 = param_1[1] - param_2[1];
  iVar3 = param_1[8];
  iVar4 = param_1[0xd];
  iVar5 = param_1[9];
  iVar1 = iVar3 + iVar7;
  if ((((iVar4 == 1) || (iVar2 < 7)) && (iVar1 < 0x186)) && (iVar9 < 0xf)) {
    *param_4 = 0;
    *param_3 = 0;
  }
  if (((param_1[4] == 0x80) && (iVar3 < 0xaf)) &&
     (((iVar2 < 6 || (iVar4 != 0)) || ((iVar2 < 0xd && (iVar5 < 0xb4)))))) {
    bVar6 = true;
  }
  else {
    bVar6 = false;
    if (param_1[4] != 0x80) goto LAB_18001bed0;
  }
  if (param_2[0x11] != 0) {
    *param_4 = 0;
    *param_3 = 0;
  }
  if (bVar6) {
    *param_4 = 0;
    *param_3 = 0;
  }
LAB_18001bed0:
  if (((iVar8 < iVar9) &&
      ((((iVar8 < 6 && (iVar7 < 0xcb)) && (iVar3 < 0xca)) ||
       ((((iVar5 < 0x56 && (iVar8 < 6)) && ((iVar7 < 0xd5 && (iVar3 < 0xca)))) ||
        (((iVar5 < 0x29 && (iVar8 < 7)) && ((iVar7 < 0xdb && (iVar3 < 0xcc)))))))))) ||
     ((*param_4 != 0 &&
      (((((((iVar5 < 0x80 && (iVar8 < 7)) && (iVar1 < 0x191)) ||
          (((iVar5 < 0x28 && (iVar9 < 6)) && (iVar1 < 0x1b8)))) ||
         (((iVar5 < 0x4b && (iVar9 < 8)) && (iVar1 < 0x1ae)))) ||
        ((iVar5 < 0x5f && (((iVar9 < 7 && (iVar1 < 0x1a0)) || ((iVar9 < 0xc && (iVar1 < 0x19a)))))))
        ) || ((((((iVar5 < 0x69 && (iVar9 < 0x10)) && (iVar1 < 0x18b)) ||
                (((iVar9 < 9 && (iVar1 < 0x187)) && (iVar7 < 0xd8)))) ||
               (((iVar9 < 0xc && (iVar1 < 0x182)) && (iVar7 < 0xd2)))) ||
              (((iVar9 < 0x10 && (iVar1 < 0x17d)) && (iVar7 < 0xcd)))))))))) {
    *param_4 = 0;
    *param_3 = 0;
  }
  if ((param_2[0x10] == 0) && (*param_4 != 0)) {
    if (((((iVar5 < 0x4b) &&
          (((iVar9 < 9 && (iVar1 < 0x1a1)) || ((iVar9 < 0xb && (iVar1 < 0x19d)))))) ||
         ((iVar5 < 0x69 && (((iVar9 < 9 && (iVar1 < 0x19a)) || ((iVar9 < 0xb && (iVar1 < 0x195))))))
         )) || (((iVar5 < 0x80 &&
                 (((iVar9 < 7 && (iVar1 < 0x1a0)) ||
                  ((iVar8 < 6 && ((iVar9 < 10 && (iVar1 < 0x1a0)))))))) ||
                ((iVar9 < 0x11 && ((iVar1 < 0x182 && (iVar7 < 0xd8)))))))) ||
       (((((iVar9 < 0xd &&
           (((iVar1 < 0x191 && (iVar7 < 200)) || ((iVar1 < 0x187 && (iVar7 < 0xd8)))))) ||
          ((((iVar9 < 0xb && (iVar1 < 0x18c)) && (iVar7 < 0xd8)) ||
           (((iVar9 < 9 && (iVar1 < 0x191)) && (iVar7 < 0xdc)))))) ||
         (((iVar9 < 8 && (iVar1 < 0x199)) && (iVar7 < 0xdc)))) ||
        ((iVar8 < iVar9 &&
         (((((((iVar8 < 5 && (iVar9 < 0xd)) && (iVar1 < 0x19b)) && (iVar7 < 0xd3)) ||
            (((iVar8 < 7 && (iVar9 < 0xd)) && ((iVar1 < 0x196 && (iVar7 < 0xd1)))))) ||
           (((iVar8 < 9 && (iVar9 < 0xd)) && ((iVar1 < 0x191 && (iVar7 < 0xce)))))) ||
          ((((iVar8 < 10 && (iVar9 < 0x13)) && (iVar1 < 0x175)) && (iVar7 < 0xc5)))))))))) {
      *param_4 = 0;
      *param_3 = 0;
    }
    if (((iVar8 < 6) && (iVar9 < 10)) &&
       (((iVar5 < 0x23 && (iVar1 < 0x1b8)) ||
        (((iVar5 < 0x80 && (iVar1 < 0x1ae)) || (*param_2 < 0x1a4)))))) {
      *param_4 = 0;
      *param_3 = 0;
    }
    if (((iVar8 < 10) && (iVar1 < 0x181)) && (iVar7 < 0xcd)) {
      *param_4 = 0;
      *param_3 = 0;
    }
    else {
      if (((*param_4 != 0) && (*param_3 == 0)) && (param_2[0xf] == 0)) {
        iVar3 = param_1[0xb];
        if (((iVar3 < 0x23) && (iVar2 < 10)) &&
           ((param_1[1] < 0x12 && ((iVar1 < 0x19f && (iVar7 < 0xd3)))))) {
          *param_4 = 0;
          *param_3 = 0;
        }
        if (((iVar2 == 3) && (iVar1 < 0x18e)) && (iVar3 < 0x14)) {
          *param_4 = 0;
          *param_3 = 0;
        }
      }
    }
  }
  return;
}



void FUN_18001c270(int *param_1,undefined8 param_2,undefined8 param_3,int *param_4,uint *param_5,
                  uint *param_6)

{
  uint *puVar1;
  uint *puVar2;
  uint local_res10 [2];
  uint local_res18 [2];

  puVar2 = param_6;
  puVar1 = param_5;
  local_res18[0] = (uint)param_3;
  local_res10[0] = (uint)param_2;
  if ((*param_6 == 0) || (*param_5 == 0)) {
    local_res18[0] = 0;
    local_res10[0] = 0;
    FUN_18001b960(param_1,param_2,param_3,param_4,0,(int *)local_res10,(int *)local_res18,
                  (undefined4 *)0x0);
    *puVar2 = *puVar2 | local_res18[0];
    *puVar1 = *puVar1 | local_res10[0];
  }
  if (*puVar2 == 0) {
    local_res18[0] = 0;
    FUN_18001b5a0(param_1,param_2,param_3,param_4,puVar1,local_res18);
    *puVar2 = *puVar2 | local_res18[0];
  }
  if (*puVar1 != 0) {
    FUN_18001bc60(param_1,(longlong)param_4,(int *)puVar1);
  }
  if (*puVar2 != 0) {
    FUN_18001be10(param_1,param_4,(int *)puVar1,(int *)puVar2);
  }
  return;
}



ulonglong FUN_18001c350(longlong param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;

  iVar1 = *(int *)(param_1 + 4);
  iVar2 = *(int *)(param_1 + 0x14);
  iVar3 = *(int *)(param_1 + 0x24);
  iVar4 = *(int *)(param_1 + 0x20);
  if (((iVar1 < 5) ||
      ((((iVar2 < 0xe2 || (iVar4 < 0xb0)) || (iVar3 < 0x5b)) &&
       (((iVar2 < 0xd8 || (iVar4 < 0xb0)) || (iVar3 < 0x83)))))) &&
     ((((iVar1 < 7 || (iVar2 < 0xd6)) || ((iVar4 < 0xb0 || (iVar3 < 0x8d)))) &&
      (((iVar1 < 8 ||
        ((((iVar2 < 0xd1 || (iVar4 < 0xbf)) || (iVar3 < 0x6a)) &&
         ((iVar4 + iVar2 < 0x1a0 || (iVar3 < 0x38)))))) &&
       ((iVar1 < 7 || ((iVar4 + iVar2 < 0x1aa || (iVar3 < 0x38)))))))))) {
    return 0;
  }
  return (ulonglong)(uint)(((iVar1 * 0x100 + 0xf) / 0x1f) * 100 >> 8);
}



undefined8 FUN_18001c420(int *param_1,int param_2)

{
  int iVar1;
  bool bVar2;
  int iVar3;
  longlong lVar4;
  int *piVar5;
  int local_58 [4];
  undefined8 local_48;
  undefined4 local_40;
  undefined4 uStack60;
  undefined4 uStack56;
  undefined4 uStack52;
  undefined4 local_30;
  int aiStack44 [4];
  undefined4 uStack28;
  undefined4 uStack24;
  undefined4 uStack20;

  bVar2 = false;
  local_48 = 0x100;
  local_58[0] = 0x100;
  local_58[1] = 0;
  local_58[2] = 0;
  local_58[3] = 0;
  local_40 = 0xf;
  uStack60 = 10;
  uStack56 = 0x300;
  uStack52 = 10;
  aiStack44[3] = 0x700;
  uStack28 = 0x14;
  uStack24 = 0x19;
  uStack20 = 0x700;
  local_30 = 0xf;
  aiStack44[0] = 0x300;
  aiStack44[1] = 0x19;
  aiStack44[2] = 0x14;
  if (param_2 - 1U < 3) {
    lVar4 = 6;
    piVar5 = param_1;
    do {
      iVar1 = *(int *)((longlong)register0x00000020 + (-0x58 - (longlong)param_1) + (longlong)piVar5
                      );
      iVar3 = *piVar5 - iVar1;
      if (iVar3 < 1) {
        iVar3 = iVar1 - *piVar5;
      }
      bVar2 = (bool)(bVar2 | *(int *)((longlong)register0x00000020 + (-0x2c - (longlong)param_1) +
                                     (longlong)(piVar5 + 1)) < iVar3);
      lVar4 = lVar4 + -1;
      piVar5 = piVar5 + 1;
    } while (lVar4 != 0);
    if (!bVar2) {
      return 1;
    }
  }
  return 0;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18001c4e0(int *param_1,uint *param_2,longlong param_3,longlong param_4,int *param_5,
                  int *param_6)

{
  uint *puVar1;
  undefined8 *puVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  undefined8 *puVar6;
  undefined8 uVar7;
  int *piVar8;
  uint *_Memory;
  uint *_Memory_00;
  ulonglong uVar9;
  longlong lVar10;
  uint uVar11;
  int iVar12;
  int *piVar13;
  uint uVar14;
  int *piVar15;
  int *piVar16;
  int *piVar17;
  int iVar18;
  undefined4 uVar19;
  uint uVar20;
  int local_298;
  uint local_294;
  uint local_290;
  int local_28c;
  uint **local_288;
  int local_280 [2];
  longlong local_278;
  uint *local_270;
  int local_268;
  uint local_264;
  int local_260;
  int local_25c;
  int local_258;
  int local_254;
  int local_250;
  int local_24c;
  int local_248;
  undefined4 local_244;
  undefined4 local_240;
  int *local_238;
  longlong local_230;
  int *local_228;
  int *local_218;
  undefined8 local_210;
  uint *local_208;
  uint *local_200;
  undefined *local_1f0;
  undefined4 local_1e0;
  int local_1c8;
  int iStack452;
  int local_1b8;
  uint uStack436;
  int iStack420;
  uint local_198;
  uint uStack404;
  uint local_190;
  undefined auStack396 [8];
  undefined4 uStack388;
  undefined4 local_180;
  undefined8 uStack380;
  undefined8 auStack372 [25];
  undefined local_a8 [12];
  undefined4 uStack156;
  ulonglong local_98;
  int local_90;
  undefined4 uStack140;
  undefined4 uStack136;
  undefined4 uStack132;
  undefined8 local_80;
  ulonglong local_78 [7];

  local_78[0] = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffd18;
  piVar8 = (int *)0x0;
  uVar5 = 0;
  uVar14 = 0;
  local_228 = param_5;
  local_25c = param_5[2];
  local_248 = *(int *)(param_4 + 0xc);
  local_250 = *param_5 + 0xcf;
  local_244 = 0;
  local_240 = 1;
  local_260 = 0;
  local_290 = 0;
  local_28c = 0;
  local_278 = param_4;
  local_270 = param_2;
  local_238 = param_1;
  local_230 = param_3;
  if (param_2[0x3c] == 0) {
    *param_1 = 0;
    goto LAB_18001ca6b;
  }
  local_24c = param_5[0x10];
  lVar10 = 4;
  puVar2 = (undefined8 *)&local_1c8;
  do {
    puVar6 = puVar2;
    *puVar6 = 0;
    puVar6[1] = 0;
    puVar6[2] = 0;
    puVar6[3] = 0;
    puVar6[4] = 0;
    puVar6[5] = 0;
    puVar6[6] = 0;
    puVar6[7] = 0;
    lVar10 = lVar10 + -1;
    puVar2 = puVar6 + 8;
  } while (lVar10 != 0);
  puVar6[8] = 0;
  iVar3 = -1;
  puVar6[9] = 0;
  puVar6[10] = 0;
  puVar6[0xb] = 0;
  local_254 = param_5[0xc];
  local_298 = -1;
  if (*(int *)(param_4 + 0x1c) < 1) {
LAB_18001ca1a:
    if (local_260 == 1) goto LAB_18001ca21;
LAB_18001ca2f:
    uVar20 = uVar14;
  }
  else {
    uVar19 = (undefined4)uStack380;
    uVar20 = (uint)((ulonglong)uStack380 >> 0x20);
    local_288 = (uint **)(param_4 + 0x28);
    local_294 = 0;
    piVar13 = piVar8;
    piVar15 = piVar8;
    piVar16 = piVar8;
    piVar17 = piVar8;
    do {
      local_90 = 0x100;
      uStack140 = 0;
      uStack136 = 0;
      uStack132 = 0;
      local_80 = 0x100;
      iVar12 = (int)piVar13;
      uVar11 = (uint)piVar8;
      if (*param_6 != 0) {
        iVar3 = FUN_180019fc0(local_278,(longlong)param_2,iVar12,piVar16,local_25c,4,
                              local_230 + (longlong)(int)(uint)piVar8 * 4,(ulonglong *)&local_90);
        if ((4 < iVar3) &&
           ((local_228[0x11] == 0 ||
            (uVar7 = FUN_18001c420(&local_90,local_228[0x11]), (int)uVar7 == 0)))) {
          piVar16 = &local_248;
          local_280[0] = 0;
          local_258 = 0;
          local_264 = 0;
          local_268 = 0;
          local_260 = 1;
          local_280[0] = FUN_18002bd60(local_270,*local_288,(ulonglong *)&local_90,piVar16,local_280
                                       ,&local_258,(int *)&local_264,&local_268,iVar3,(int *)0x0);
          iVar18 = local_268 * local_254 >> 8;
          FUN_18002c510(&local_90,(int *)local_a8);
          if ((local_250 < local_280[0]) && (0xc3 < (int)local_264)) {
            uVar11 = local_264;
            if (local_24c != 0) {
              piVar16 = (int *)&DAT_00000004;
              uVar11 = uVar14;
              if (0x2f < local_a8._0_4_ - 0xeaU) {
                uVar11 = 4;
              }
              uVar4 = uVar14;
              if (0x147a < local_a8._8_4_) {
                uVar4 = 4;
              }
              uVar11 = local_264 - (uVar11 + uVar4);
            }
            if ((((int)uStack436 < (int)uVar11) ||
                ((uVar11 == uStack436 &&
                 ((local_1c8 < iVar3 || ((iVar3 == local_1c8 && (iStack420 < iVar18)))))))) &&
               ((local_1b8 = local_280[0], iStack420 = iVar18, uStack436 = uVar11,
                local_298 = iVar12, local_1c8 = iVar3, local_78 <= auStack396 ||
                (auStack372 <= &local_90)))) {
              uVar19 = (undefined4)local_80;
              uVar20 = (uint)((ulonglong)local_80 >> 0x20);
              auStack396._0_4_ = local_90;
              auStack396._4_4_ = uStack140;
              uStack388 = uStack136;
              local_180 = uStack132;
            }
            local_28c = local_28c + iVar3;
            local_290 = local_290 + 1;
            if ((int)piVar17 < (int)uVar11) {
              piVar17 = (int *)(ulonglong)uVar11;
            }
          }
        }
        piVar15 = (int *)(ulonglong)local_290;
        param_4 = local_278;
        param_2 = local_270;
        iVar3 = local_298;
        uVar11 = local_294;
      }
      iVar18 = local_248;
      local_294 = uVar11 + 0x3e;
      piVar8 = (int *)(ulonglong)local_294;
      local_288 = local_288 + 1;
      param_6 = param_6 + 1;
      piVar13 = (int *)(ulonglong)(iVar12 + 1U);
    } while ((int)(iVar12 + 1U) < *(int *)(param_4 + 0x1c));
    uStack380 = CONCAT44(uVar20,uVar19);
    _auStack396 = CONCAT412(local_180,
                            CONCAT48(uStack388,CONCAT44(auStack396._4_4_,auStack396._0_4_)));
    if (0 < (int)piVar15) {
      local_a8 = ZEXT812(0x100);
      _local_a8 = ZEXT1216(local_a8);
      local_98 = 0x100;
      puVar1 = *(uint **)(param_4 + 0x28 + (longlong)iVar3 * 8);
      if ((auStack372 <= local_a8) || (uVar11 = uVar14, &local_90 <= auStack396)) {
        local_98 = CONCAT44(uVar20,uVar19);
        _local_a8 = CONCAT412(local_180,
                              CONCAT48(uStack388,CONCAT44(auStack396._4_4_,auStack396._0_4_)));
        uVar11 = uVar20;
      }
      if (local_248 != 0) {
        local_a8 = CONCAT48((local_a8._8_4_ + 1) / 2,local_a8._0_8_);
        local_98 = local_98 & 0xffffffff | (ulonglong)(uint)((int)(uVar11 + 1) / 2) << 0x20;
      }
      _Memory = FUN_18002a710(param_2 + 10,local_248,param_2[1],*param_2);
      _Memory_00 = FUN_18002a710(puVar1 + 10,iVar18,puVar1[1],*puVar1);
      local_1f0 = local_a8;
      local_218 = *(int **)(local_270 + 6);
      local_210 = *(undefined8 *)(puVar1 + 6);
      local_1e0 = local_244;
      local_208 = _Memory;
      local_200 = _Memory_00;
      FUN_18002c0b0(&local_218,(longlong)&local_1c8);
      if (_Memory != (uint *)0x0) {
        free(_Memory);
      }
      if (_Memory_00 != (uint *)0x0) {
        free(_Memory_00);
      }
      FUN_18002c510((int *)auStack396,(int *)local_a8);
      local_190 = (uint)(0x28f5 < local_a8._8_4_);
      uStack404 = (uint)(0x147a < local_a8._8_4_);
      iStack452 = local_1c8;
      local_198 = (uint)(0x2f < local_a8._0_4_ - 0xeaU);
      uVar9 = FUN_18001c350((longlong)&local_1c8);
      iVar3 = (int)uVar9;
      if (0 < iVar3) {
        if (100 < iVar3) {
          iVar3 = 100;
        }
        *local_238 = iVar3;
        goto LAB_18001ca6b;
      }
    }
    if ((local_260 != 1) || (0xcf < (int)piVar17)) goto LAB_18001ca1a;
    uVar5 = 2;
LAB_18001ca21:
    uVar20 = 1;
    if (0x7f < iStack420) goto LAB_18001ca2f;
  }
  if (local_28c < 6) {
    uVar14 = 4;
  }
  *local_238 = -(uVar14 | uVar5 | uVar20);
LAB_18001ca6b:
  FUN_18005f100(local_78[0] ^ (ulonglong)&stack0xfffffffffffffd18);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18001ca90(longlong param_1,longlong param_2,longlong param_3,int *param_4,longlong param_5)

{
  undefined *puVar1;
  longlong lVar2;
  longlong lVar3;
  int iVar4;
  int *piVar5;
  int *_Memory;
  int iVar6;
  uint uVar7;
  undefined *puVar8;
  uint uVar9;
  ulonglong uVar10;
  uint uVar11;
  int *piVar12;
  ulonglong uVar13;
  uint uVar14;
  int iVar15;
  longlong lVar16;
  longlong lVar17;
  int *piVar18;
  int iVar19;
  int *piVar20;
  undefined auVar21 [16];
  undefined in_XMM2 [16];
  undefined in_XMM3 [16];
  uint local_998;
  uint local_994;
  int local_990;
  int local_98c;
  int local_988;
  int local_984;
  int local_980;
  int local_97c;
  int local_978;
  longlong local_970;
  int *local_968;
  longlong local_960;
  int *local_958;
  int local_948 [516];
  int local_138;
  undefined4 uStack308;
  int local_130;
  undefined4 uStack300;
  undefined8 local_128;
  int local_120 [2];
  int local_118 [52];
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffff638;
  local_978 = *(int *)(param_1 + 0xc);
  local_970 = param_5;
  local_984 = *(int *)(param_1 + 8);
  local_988 = *(int *)(param_1 + 4);
  local_980 = 1;
  if (local_978 != 0) {
    local_984 = local_984 >> 1;
    local_988 = local_988 >> 1;
    local_980 = 4;
  }
  iVar4 = **(int **)(param_2 + 0x130);
  iVar19 = (*(int **)(param_2 + 0x130))[1];
  iVar15 = iVar4 * iVar19;
  local_960 = param_3;
  local_958 = param_4;
  piVar5 = (int *)malloc((longlong)iVar15 + 0x20);
  piVar12 = (int *)0x0;
  uVar11 = 0;
  _Memory = piVar12;
  if (piVar5 != (int *)0x0) {
    piVar5[3] = iVar15;
    *piVar5 = iVar4;
    piVar5[1] = iVar19;
    piVar5[4] = 1;
    piVar5[2] = iVar4;
    *(int **)(piVar5 + 6) = piVar5 + 8;
    _Memory = piVar5;
  }
  piVar5 = *(int **)(param_2 + 0x130);
  if ((piVar5 != (int *)0x0) && (_Memory != (int *)0x0)) {
    if (_Memory[3] < piVar5[3]) {
      free(_Memory);
      _Memory = FUN_180022ff0(*piVar5,piVar5[1],piVar5[4]);
    }
    *_Memory = *piVar5;
    _Memory[1] = piVar5[1];
    _Memory[2] = piVar5[2];
    _Memory[3] = piVar5[3];
    _Memory[4] = piVar5[4];
    puVar8 = *(undefined **)(_Memory + 6);
    uVar14 = piVar5[3];
    uVar10 = (ulonglong)uVar14;
    puVar1 = *(undefined **)(piVar5 + 6);
    if (((((puVar8 != (undefined *)0x0) && (puVar1 != (undefined *)0x0)) && (uVar14 != 0)) &&
        ((puVar1 + uVar10 <= puVar8 || (puVar8 + uVar10 <= puVar1)))) && (uVar14 != 0)) {
      lVar16 = -(longlong)puVar8;
      do {
        *puVar8 = puVar8[(longlong)(puVar1 + lVar16)];
        puVar8 = puVar8 + 1;
        uVar10 = uVar10 - 1;
      } while (uVar10 != 0);
    }
  }
  iVar4 = -1;
  memset(local_118,0,200);
  local_97c = FUN_1800169c0();
  iVar19 = 0;
  local_990 = 0;
  local_998 = 0;
  local_98c = 0;
  uVar14 = uVar11;
  if (*(int *)(param_1 + 0x1c) != 0) {
    local_968 = local_118;
    piVar5 = piVar12;
    piVar18 = piVar12;
    piVar20 = piVar12;
    iVar4 = -1;
    do {
      iVar19 = *(int *)(param_1 + 0x87e8 + (longlong)piVar5 * 4);
      lVar16 = (longlong)iVar19 * 0x120 + local_960;
      uVar11 = *(uint *)(lVar16 + 4);
      if (4 < (int)uVar11) {
        iVar15 = *(int *)(lVar16 + 0x14);
        if (iVar15 < 0xbe) {
          piVar20 = (int *)(ulonglong)local_998;
        }
        else {
          piVar20 = (int *)(lVar16 + 0x3c);
          if ((int)uVar11 <= (int)(uint)piVar12) {
            uVar11 = (uint)piVar12;
            iVar19 = iVar4;
          }
          piVar12 = (int *)(ulonglong)uVar11;
          if ((piVar20 != (int *)0x0) &&
             (((int *)(lVar16 + 0x54U) <= &local_138 || (local_120 <= piVar20)))) {
            local_138 = *piVar20;
            uStack308 = *(undefined4 *)(lVar16 + 0x40);
            local_130 = *(int *)(lVar16 + 0x44);
            uStack300 = *(undefined4 *)(lVar16 + 0x48);
            local_128 = *(ulonglong *)(lVar16 + 0x4c);
          }
          if (local_978 != 0) {
            local_130 = local_130 >> 1;
            local_128 = local_128 & 0xffffffff | (ulonglong)(uint)(local_128._4_4_ >> 1) << 0x20;
          }
          FUN_18002d430(local_984,local_988,local_984,local_988,&local_138,local_948);
          FUN_18002d5e0(_Memory,local_948);
          iVar4 = FUN_1800169c0();
          piVar18 = (int *)(ulonglong)((int)piVar18 + 1);
          iVar6 = (local_97c - iVar4) * local_980;
          *local_968 = iVar6;
          local_990 = local_990 + iVar15 * iVar6;
          local_998 = local_998 + iVar6;
          piVar20 = (int *)(ulonglong)local_998;
          local_98c = local_98c + *(int *)(lVar16 + 4);
          local_968 = local_968 + 1;
          local_97c = iVar4;
          iVar4 = iVar19;
        }
      }
      iVar19 = (int)piVar20;
      uVar11 = (uint)piVar18;
      uVar14 = (int)piVar5 + 1;
      piVar5 = (int *)(ulonglong)uVar14;
    } while (uVar14 < *(uint *)(param_1 + 0x1c));
    uVar14 = (uint)piVar12;
    local_994 = uVar14;
  }
  uVar10 = 0;
  if (_Memory != (int *)0x0) {
    free(_Memory);
  }
  if ((((1 < (int)uVar11) && (iVar19 != 0)) && (0xcf < local_990 / iVar19)) &&
     (6 < local_98c / (int)uVar11)) {
    uVar9 = 0;
    if (7 < uVar11) {
      in_XMM3 = in_XMM3 & (undefined  [16])0x0;
      in_XMM2 = in_XMM2 & (undefined  [16])0x0;
      uVar7 = uVar11 & 0x80000007;
      if ((int)uVar7 < 0) {
        uVar7 = (uVar7 - 1 | 0xfffffff8) + 1;
      }
      uVar13 = uVar10;
      do {
        uVar9 = (int)uVar10 + 8;
        uVar10 = (ulonglong)uVar9;
        auVar21 = CONCAT412(-(uint)(0x578 < local_118[uVar13 + 3]),
                            CONCAT48(-(uint)(0x578 < local_118[uVar13 + 2]),
                                     CONCAT44(-(uint)(0x578 < local_118[uVar13 + 1]),
                                              -(uint)(0x578 < local_118[uVar13]))));
        in_XMM3 = CONCAT412(SUB164(in_XMM3 >> 0x60,0) + 1,
                            CONCAT48(SUB164(in_XMM3 >> 0x40,0) + 1,
                                     CONCAT44(SUB164(in_XMM3 >> 0x20,0) + 1,SUB164(in_XMM3,0) + 1)))
                  & auVar21 | ~auVar21 & in_XMM3;
        lVar16 = uVar13 + 4;
        lVar17 = uVar13 + 5;
        lVar2 = uVar13 + 6;
        lVar3 = uVar13 + 7;
        uVar13 = uVar13 + 8;
        auVar21 = CONCAT412(-(uint)(0x578 < local_118[lVar3]),
                            CONCAT48(-(uint)(0x578 < local_118[lVar2]),
                                     CONCAT44(-(uint)(0x578 < local_118[lVar17]),
                                              -(uint)(0x578 < local_118[lVar16]))));
        in_XMM2 = CONCAT412(SUB164(in_XMM2 >> 0x60,0) + 1,
                            CONCAT48(SUB164(in_XMM2 >> 0x40,0) + 1,
                                     CONCAT44(SUB164(in_XMM2 >> 0x20,0) + 1,SUB164(in_XMM2,0) + 1)))
                  & auVar21 | ~auVar21 & in_XMM2;
      } while ((longlong)uVar13 < (longlong)(int)(uVar11 - uVar7));
      uVar10 = (ulonglong)
               (uint)(SUB164(in_XMM2,0) + SUB164(in_XMM3,0) +
                      SUB164(in_XMM2 >> 0x40,0) + SUB164(in_XMM3 >> 0x40,0) +
                     SUB164(in_XMM2 >> 0x20,0) + SUB164(in_XMM3 >> 0x20,0) +
                     SUB164(in_XMM2 >> 0x60,0) + SUB164(in_XMM3 >> 0x60,0));
    }
    uVar7 = (uint)uVar10;
    lVar16 = (longlong)(int)uVar9;
    while (lVar16 < (int)uVar11) {
      uVar7 = (uint)uVar10 + 1;
      if (local_118[lVar16] < 0x579) {
        uVar7 = (uint)uVar10;
      }
      lVar16 = lVar16 + 1;
      uVar10 = (ulonglong)uVar7;
    }
    if (1 < (int)uVar7) {
      if (((0x28 < *local_958) || (2 < (int)uVar7)) && (iVar4 != -1)) {
        *(undefined4 *)(local_970 + 0x688) = 1;
        *(int *)(local_970 + 0x648) = iVar4;
        uVar10 = local_960 + 0x3c + (longlong)iVar4 * 0x120;
        puVar8 = (undefined *)(local_970 + 0x650);
        if (((puVar8 != (undefined *)0x0) && (uVar10 != 0)) &&
           (((undefined *)(uVar10 + 0x18) <= puVar8 || (local_970 + 0x668U <= uVar10)))) {
          lVar16 = uVar10 - (longlong)puVar8;
          lVar17 = 0x18;
          do {
            *puVar8 = puVar8[lVar16];
            puVar8 = puVar8 + 1;
            lVar17 = lVar17 + -1;
          } while (lVar17 != 0);
        }
      }
      *(undefined4 *)(local_970 + 0x684) = 1;
      *(int *)(local_970 + 0x648) = iVar4;
      *local_958 = (int)(uVar14 * 100) / 0x1f;
    }
  }
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xfffffffffffff638);
  return;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Could not reconcile some variable overlaps

void FUN_18001cfc0(int *param_1,uint *param_2,int *param_3,int *param_4,undefined8 *param_5)

{
  uint uVar1;
  uint *puVar2;
  undefined8 *puVar3;
  uint uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  longlong lVar7;
  undefined8 *puVar8;
  undefined8 *puVar9;
  undefined8 uVar10;
  ulonglong uVar11;
  longlong lVar12;
  longlong lVar13;
  uint **ppuVar14;
  uint **ppuVar15;
  int *piVar16;
  uint **ppuVar17;
  longlong *plVar18;
  int iVar19;
  undefined8 *puVar20;
  ulonglong *puVar21;
  undefined4 *puVar22;
  uint uVar23;
  uint uVar24;
  uint uVar25;
  int iVar26;
  undefined extraout_XMM0 [16];
  int *piStackX8;
  uint uStackX16;
  uint uStackX20;
  uint uStackX24;
  uint auStackX28 [3];
  int *piStack92568;
  uint uStack92560;
  int iStack92556;
  longlong lStack92552;
  undefined4 uStack92544;
  int iStack92540;
  int iStack92536;
  int *piStack92528;
  int aiStack92520 [2];
  int iStack92512;
  uint *puStack92504;
  undefined4 *puStack92496;
  int *piStack92488;
  undefined4 uStack92480;
  undefined4 uStack92476;
  undefined auStack92472 [16];
  int iStack92456;
  int iStack92448;
  undefined4 uStack92444;
  undefined4 uStack92440;
  undefined8 uStack92424;
  uint uStack92404;
  int iStack92388;
  undefined auStack92140 [4];
  undefined8 uStack92136;
  undefined4 uStack92128;
  undefined4 uStack92124;
  undefined8 uStack92120;
  uint *puStack92112;
  int aiStack92104 [52];
  undefined4 auStack91896 [52];
  undefined auStack91688 [12400];
  undefined8 uStack79288;
  uint auStack79280 [13];
  uint *apuStack79228 [28];
  undefined8 auStack79000 [1764];
  undefined8 local_fd78;
  undefined8 local_7ee8 [2447];
  ulonglong auStack12908 [1602];
  ulonglong local_58;
  undefined8 uStack72;

  uStack72 = 0x18001cfdf;
  lVar7 = _alloca_probe();
  puVar3 = param_5;
  lVar7 = -lVar7;
  local_58 = DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffc0 + lVar7);
  iStack92536 = param_4[4];
  iVar19 = 0;
  iStack92448 = param_3[3];
  *(uint **)(&stack0x00000030 + lVar7) = param_2;
  uStack92440 = 1;
  uStack92560 = *param_4 + 0xcf;
  uStack92444 = 0;
  *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d049;
  memset(aiStack92104,0,200,*(undefined *)((longlong)&uStack72 + lVar7));
  *(undefined4 *)((longlong)&uStackX16 + lVar7 + 0x14) = 0;
  *(undefined4 *)((longlong)&param_5 + lVar7) = 0;
  *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d068;
  memset(auStack91896,0,200,*(undefined *)((longlong)&uStack72 + lVar7));
  if (puVar3 != (undefined8 *)0x0) {
    lVar12 = 0x1a;
    puVar20 = puVar3;
    do {
      puVar8 = puVar20;
      *puVar8 = 0;
      puVar8[1] = 0;
      puVar8[2] = 0;
      puVar8[3] = 0;
      puVar8[4] = 0;
      puVar8[5] = 0;
      puVar8[6] = 0;
      puVar8[7] = 0;
      lVar12 = lVar12 + -1;
      puVar20 = puVar8 + 8;
    } while (lVar12 != 0);
    puVar8[8] = 0;
    puVar8[9] = 0;
  }
  *(undefined4 *)(puVar3 + 0xc9) = 0xffffffff;
  *(undefined4 *)((longlong)puVar3 + 0x66c) = 0x100;
  *(undefined4 *)((longlong)puVar3 + 0x67c) = 0x100;
  *(undefined4 *)(puVar3 + 0xca) = 0x100;
  *(undefined4 *)(puVar3 + 0xcc) = 0x100;
  *param_1 = 0;
  if (param_2[0x3c] == 0) goto LAB_18001da70;
  puStack92504 = param_2;
  piStack92488 = &iStack92448;
  uStack92476 = 2;
  auStack92472 = extraout_XMM0 & (undefined  [16])0x0;
  lVar12 = 4;
  puVar20 = &uStack92424;
  do {
    puVar8 = puVar20;
    *puVar8 = 0;
    puVar8[1] = 0;
    puVar8[2] = 0;
    puVar8[3] = 0;
    puVar8[4] = 0;
    puVar8[5] = 0;
    puVar8[6] = 0;
    puVar8[7] = 0;
    lVar12 = lVar12 + -1;
    puVar20 = puVar8 + 8;
  } while (lVar12 != 0);
  puVar8[8] = 0;
  puVar8[9] = 0;
  puVar8[10] = 0;
  puVar8[0xb] = 0;
  iStack92540 = param_4[0xc];
  iStack92456 = param_4[0xc];
  *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d176;
  memset(&uStack79288,0,0x3840,*(undefined *)((longlong)&uStack72 + lVar7));
  local_fd78._0_1_ = 0xff;
  *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d191;
  memset((undefined *)((longlong)&local_fd78 + 1),0,0x7e8f,
         *(undefined *)((longlong)&uStack72 + lVar7));
  *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d1a5;
  memset(local_7ee8,0,0x7e90,*(undefined *)((longlong)&uStack72 + lVar7));
  iStack92556 = 0;
  iVar26 = iVar19;
  if (param_3[7] < 1) {
LAB_18001d966:
    if ((((*(int *)(puVar3 + 0xd1) == 0) && (param_4[0xd] == 1)) &&
        ((param_4[0x11] == 0 && ((0x41 < (int)param_2[0x44] && (0xf < (int)param_2[0x43])))))) &&
       (param_3[0x2380] == 0)) {
      *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d9b2;
      FUN_180018d40(param_2,param_3,(longlong)(param_3 + 0x2344),param_3 + 0x236c,
                    *(undefined *)((longlong)&uStack72 + lVar7));
    }
  }
  else {
    piStack92528 = param_3 + 0x21fa;
    piStack92568 = param_1;
    do {
      iVar26 = *piStack92528;
      lVar12 = (longlong)iVar26;
      *(int *)((longlong)&uStackX16 + lVar7 + 0x10) = iVar26;
      puVar20 = &uStack79288 + lVar12 * 0x24;
      if (puVar20 != (undefined8 *)0x0) {
        lVar13 = 4;
        puVar8 = puVar20;
        do {
          puVar9 = puVar8;
          *puVar9 = 0;
          puVar9[1] = 0;
          puVar9[2] = 0;
          puVar9[3] = 0;
          puVar9[4] = 0;
          puVar9[5] = 0;
          puVar9[6] = 0;
          puVar9[7] = 0;
          lVar13 = lVar13 + -1;
          puVar8 = puVar9 + 8;
        } while (lVar13 != 0);
        puVar9[8] = 0;
        puVar9[9] = 0;
        puVar9[10] = 0;
        puVar9[0xb] = 0;
      }
      if (((param_4[0xd] != 0) || (iVar26 == param_4[0xe])) &&
         (((ppuVar15 = *(uint ***)(param_3 + lVar12 * 2 + 10), param_3[7] != param_3[8] &&
           (*(int *)(puVar3 + 0xd1) != 1)) ||
          ((*(int *)((longlong)puVar3 + 0x644) != 1 ||
           (param_1 = piStack92568, *(int *)(ppuVar15 + 0x20) != 1)))))) {
        puVar2 = *(uint **)(&stack0x00000030 + lVar7);
        lStack92552 = lVar12;
        *(undefined8 **)((longlong)&uStackX16 + lVar7 + -0x10) = puVar20;
        *(undefined8 **)(&stack0xfffffffffffffff8 + lVar7) = &uStack92136;
        *(int *)(&stack0xfffffffffffffff0 + lVar7) = iVar26;
        *(int **)(&stack0xffffffffffffffe8 + lVar7) = param_4;
        uStack92136._0_4_ = 0x100;
        uStack92136._4_4_ = 0;
        uStack92128 = 0;
        uStack92124 = 0;
        uStack92120 = 0x100;
        *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d2bd;
        FUN_18001aa70(param_3,puVar2,&local_fd78,local_7ee8,
                      *(undefined8 *)(&stack0xffffffffffffffe0 + lVar7),
                      *(longlong *)(&stack0xffffffffffffffe8 + lVar7),
                      *(int *)(&stack0xfffffffffffffff0 + lVar7),
                      *(ulonglong **)(&stack0xfffffffffffffff8 + lVar7),
                      *(int **)((longlong)&uStackX16 + lVar7 + -0x10));
        *(undefined8 **)(&stack0xfffffffffffffff8 + lVar7) = puVar20;
        *(undefined8 **)(&stack0xfffffffffffffff0 + lVar7) = &uStack92136;
        *(int *)(&stack0xffffffffffffffe8 + lVar7) = iVar26;
        *(int **)(&stack0xffffffffffffffe0 + lVar7) = param_4;
        *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d2f3;
        FUN_18001ae80(param_3,*(undefined8 *)(&stack0x00000030 + lVar7),&local_fd78,local_7ee8);
        uVar24 = auStack79280[lVar12 * 0x48 + -1];
        if ((int)uVar24 <= (int)auStack79280[lVar12 * 0x48]) {
          uVar24 = auStack79280[lVar12 * 0x48];
        }
        *(uint *)(&stack0x00000038 + lVar7) = uVar24;
        auStack79280[lVar12 * 0x48 + -1] = uVar24;
        if ((4 < (int)uVar24) && (0x1d < (int)auStack79280[lVar12 * 0x48 + 8])) {
          iVar26 = param_4[0x11];
          if (iVar26 != 0) {
            *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d32b;
            uVar10 = FUN_18001c420((int *)&uStack92136,iVar26,
                                   *(undefined *)((longlong)&uStack72 + lVar7));
            param_1 = piStack92568;
            if ((int)uVar10 != 0) goto LAB_18001d8f7;
          }
          *(undefined4 *)((longlong)&uStackX16 + lVar7 + 4) = 0;
          *(undefined4 *)((longlong)&uStackX16 + lVar7 + 0xc) = 0;
          uStack92544 = 0;
          *(undefined4 *)((longlong)&param_5 + lVar7 + 4) = 0;
          *(uint *)((longlong)&uStackX16 + lVar7) = 0;
          *(undefined4 *)((longlong)&uStackX16 + lVar7 + 8) = 0;
          *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d35a;
          FUN_18002c510((int *)&uStack92136,aiStack92520,*(undefined *)((longlong)&uStack72 + lVar7)
                       );
          uVar6 = *(undefined4 *)(&stack0x00000038 + lVar7);
          puVar2 = *(uint **)(&stack0x00000030 + lVar7);
          *(int **)((longlong)&piStackX8 + lVar7) = (int *)0x0;
          puVar21 = &uStack92136;
          *(undefined4 *)((longlong)&uStackX16 + lVar7 + -0x10) = uVar6;
          *(uint **)(&stack0xfffffffffffffff8 + lVar7) = (uint *)((longlong)&uStackX16 + lVar7);
          *(longlong *)(&stack0xfffffffffffffff0 + lVar7) = (longlong)&uStackX16 + lVar7 + 8;
          *(longlong *)(&stack0xffffffffffffffe8 + lVar7) = (longlong)&param_5 + lVar7 + 4;
          *(undefined4 **)(&stack0xffffffffffffffe0 + lVar7) = &uStack92544;
          *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d3a8;
          ppuVar17 = ppuVar15;
          uVar4 = FUN_18002bd60(puVar2,(uint *)ppuVar15,puVar21,&iStack92448,
                                *(int **)(&stack0xffffffffffffffe0 + lVar7),
                                *(int **)(&stack0xffffffffffffffe8 + lVar7),
                                *(int **)(&stack0xfffffffffffffff0 + lVar7),
                                *(int **)(&stack0xfffffffffffffff8 + lVar7),
                                *(undefined4 *)((longlong)&uStackX16 + lVar7 + -0x10),
                                *(int **)((longlong)&piStackX8 + lVar7));
          uVar24 = *(uint *)((longlong)&uStackX16 + lVar7 + 8);
          auStack79280[lVar12 * 0x48 + 2] = uVar4;
          auStack79280[lVar12 * 0x48 + 3] = uVar24;
          uVar24 = *(uint *)((longlong)&uStackX16 + lVar7);
          *(undefined8 *)(&stack0xfffffffffffffff8 + lVar7) = 0;
          *(undefined4 *)((longlong)&uStackX16 + lVar7 + 8) = 0;
          *(uint *)((longlong)&uStackX16 + lVar7) = 0;
          auStack79280[lVar12 * 0x48 + 7] = (int)(uVar24 * iStack92540) >> 8;
          auStack79280[lVar12 * 0x48 + 10] = (uint)(0x2f < aiStack92520[0] - 0xeaU);
          auStack79280[lVar12 * 0x48 + 0xb] = (uint)(0x147a < iStack92512);
          auStack79280[lVar12 * 0x48 + 0xc] = (uint)(0x28f5 < iStack92512);
          *(uint **)(&stack0xfffffffffffffff0 + lVar7) = (uint *)((longlong)&uStackX16 + lVar7);
          *(longlong *)(&stack0xffffffffffffffe8 + lVar7) = (longlong)&uStackX16 + lVar7 + 8;
          *(undefined4 *)(&stack0xffffffffffffffe0 + lVar7) = 1;
          *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d426;
          FUN_18001b960((int *)puVar20,ppuVar17,puVar21,param_4,
                        *(int *)(&stack0xffffffffffffffe0 + lVar7),
                        *(int **)(&stack0xffffffffffffffe8 + lVar7),
                        *(int **)(&stack0xfffffffffffffff0 + lVar7),
                        *(undefined4 **)(&stack0xfffffffffffffff8 + lVar7));
          if (*(int *)((longlong)&uStackX16 + lVar7 + 8) == 0 ||
              ((int)auStack79280[lVar12 * 0x48 + 2] < (int)uStack92560 ||
              *(uint *)((longlong)&uStackX16 + lVar7) == 0)) {
            uStack92480 = uVar6;
            puStack92496 = (undefined4 *)&uStack92136;
            puVar21 = &uStack92136;
            ppuVar17 = &puStack92504;
            *(int *)(&stack0xffffffffffffffe0 + lVar7) = *param_3;
            *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d47b;
            FUN_18002cee0((uint *)ppuVar15,ppuVar17,(uint *)puVar21,(longlong)puVar20,
                          *(int *)(&stack0xffffffffffffffe0 + lVar7));
          }
          ppuVar14 = apuStack79228 + lVar12 * 0x24;
          if ((ppuVar14 != (uint **)0x0) &&
             ((&puStack92112 <= ppuVar14 ||
              (ppuVar17 = (uint **)&uStack92136, apuStack79228 + lVar12 * 0x24 + 3 <= ppuVar17)))) {
            ppuVar17 = (uint **)&DAT_00000018;
            puVar21 = (ulonglong *)((longlong)&uStack92136 - (longlong)ppuVar14);
            do {
              *(undefined *)ppuVar14 = *(undefined *)((longlong)ppuVar14 + (longlong)puVar21);
              ppuVar14 = (uint **)((longlong)ppuVar14 + 1);
              ppuVar17 = (uint **)((longlong)ppuVar17 + -1);
            } while (ppuVar17 != (uint **)0x0);
          }
          *(undefined4 *)((longlong)&param_5 + lVar7 + 4) = 0;
          *(longlong *)(&stack0xfffffffffffffff8 + lVar7) = (longlong)&param_5 + lVar7 + 4;
          *(longlong *)(&stack0xfffffffffffffff0 + lVar7) = (longlong)&uStackX16 + lVar7 + 0xc;
          *(longlong *)(&stack0xffffffffffffffe8 + lVar7) = (longlong)&uStackX16 + lVar7 + 4;
          *(undefined4 *)(&stack0xffffffffffffffe0 + lVar7) = 1;
          *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d503;
          FUN_18001b960((int *)puVar20,ppuVar17,puVar21,param_4,
                        *(int *)(&stack0xffffffffffffffe0 + lVar7),
                        *(int **)(&stack0xffffffffffffffe8 + lVar7),
                        *(int **)(&stack0xfffffffffffffff0 + lVar7),
                        *(undefined4 **)(&stack0xfffffffffffffff8 + lVar7));
          uVar24 = *(uint *)((longlong)&uStackX16 + lVar7 + 4);
          if (uVar24 == 2) {
            uVar4 = *(uint *)((longlong)&uStackX16 + lVar7 + 0xc);
LAB_18001d613:
            uVar25 = uVar24;
            uVar23 = uVar4;
            if (uVar4 != 1) goto LAB_18001d619;
LAB_18001d632:
            uVar25 = auStack79280[lVar12 * 0x48 + -1];
            piVar16 = (int *)((longlong)&uStackX16 + lVar7 + 0x14);
            *piVar16 = *piVar16 + 1;
            uVar23 = auStack79280[lVar12 * 0x48 + 3];
            uVar1 = auStack79280[lVar12 * 0x48 + 7];
            aiStack92104[lStack92552] = 1;
            *(int *)(undefined8 **)((longlong)&param_5 + lVar7) =
                 *(int *)(undefined8 **)((longlong)&param_5 + lVar7) +
                 (int)(uVar25 * 0x100 + 0xf) / 0x1f;
            if ((((int)uStack92404 < (int)uVar23) ||
                ((uVar23 == uStack92404 &&
                 (((int)uStack92424._4_4_ < (int)uVar25 ||
                  ((uVar25 == uStack92424._4_4_ && (iStack92388 < (int)uVar1)))))))) &&
               ((auStack79000 + lVar12 * 0x24 <= &uStack92424 || (&uStack92136 <= puVar20)))) {
              *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d6bb;
              memcpy_FUN_180061f90
                        (&uStack92424,puVar20,0x120,*(undefined *)((longlong)&uStack72 + lVar7));
            }
          }
          else {
            puVar21 = &uStack92136;
            *(undefined8 **)(&stack0xffffffffffffffe0 + lVar7) = puVar20;
            *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d52f;
            FUN_18002c3b0(*(uint **)(&stack0x00000030 + lVar7),(uint *)ppuVar15,puVar21,&iStack92448
                          ,*(longlong *)(&stack0xffffffffffffffe0 + lVar7));
            uVar4 = *(uint *)((longlong)&uStackX16 + lVar7 + 0xc);
            if ((uVar4 == 0) || (uVar24 == 0)) {
              *(undefined8 *)(&stack0xfffffffffffffff8 + lVar7) = 0;
              *(uint **)(&stack0xfffffffffffffff0 + lVar7) = (uint *)((longlong)&uStackX16 + lVar7);
              *(uint *)((longlong)&uStackX16 + lVar7) = 0;
              *(longlong *)(&stack0xffffffffffffffe8 + lVar7) = (longlong)&uStackX16 + lVar7 + 8;
              *(undefined4 *)(&stack0xffffffffffffffe0 + lVar7) = 0;
              *(undefined4 *)((longlong)&uStackX16 + lVar7 + 8) = 0;
              *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d56e;
              FUN_18001b960((int *)puVar20,ppuVar15,puVar21,param_4,
                            *(int *)(&stack0xffffffffffffffe0 + lVar7),
                            *(int **)(&stack0xffffffffffffffe8 + lVar7),
                            *(int **)(&stack0xfffffffffffffff0 + lVar7),
                            *(undefined4 **)(&stack0xfffffffffffffff8 + lVar7));
              uVar4 = uVar4 | *(uint *)((longlong)&uStackX16 + lVar7);
              uVar24 = uVar24 | *(uint *)((longlong)&uStackX16 + lVar7 + 8);
              *(uint *)((longlong)&uStackX16 + lVar7 + 4) = uVar24;
              *(uint *)((longlong)&uStackX16 + lVar7 + 0xc) = uVar4;
            }
            if (uVar4 == 0) {
              *(uint *)((longlong)&uStackX16 + lVar7) = 0;
              *(uint **)(&stack0xffffffffffffffe8 + lVar7) = (uint *)((longlong)&uStackX16 + lVar7);
              *(longlong *)(&stack0xffffffffffffffe0 + lVar7) = (longlong)&uStackX16 + lVar7 + 4;
              *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d5aa;
              FUN_18001b5a0((int *)puVar20,ppuVar15,puVar21,param_4,
                            *(undefined4 **)(&stack0xffffffffffffffe0 + lVar7),
                            *(uint **)(&stack0xffffffffffffffe8 + lVar7));
              uVar4 = *(uint *)((longlong)&uStackX16 + lVar7);
              uVar24 = *(uint *)((longlong)&uStackX16 + lVar7 + 4);
              *(uint *)((longlong)&uStackX16 + lVar7 + 0xc) = uVar4;
            }
            if (uVar24 != 0) {
              *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d5ce;
              FUN_18001bc60((int *)puVar20,(longlong)param_4,
                            (int *)((longlong)&uStackX16 + lVar7 + 4),
                            *(undefined *)((longlong)&uStack72 + lVar7));
              uVar24 = *(uint *)((longlong)&uStackX16 + lVar7 + 4);
            }
            if (uVar4 != 0) {
              *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d5ed;
              FUN_18001be10((int *)puVar20,param_4,(int *)((longlong)&uStackX16 + lVar7 + 4),
                            (int *)((longlong)&uStackX16 + lVar7 + 0xc),
                            *(undefined *)((longlong)&uStack72 + lVar7));
              uVar24 = *(uint *)((longlong)&uStackX16 + lVar7 + 4);
              uVar4 = *(uint *)((longlong)&uStackX16 + lVar7 + 0xc);
            }
            if ((*(int *)((longlong)&param_5 + lVar7 + 4) == 0) ||
               (uVar25 = 0, uVar23 = 0, 0xae < (int)auStack79280[lVar12 * 0x48 + 6]))
            goto LAB_18001d613;
LAB_18001d619:
            uVar24 = uVar25;
            uVar4 = uVar23;
            if ((auStack79280[lVar12 * 0x48 + 2] != uStack92560 &&
                 (int)uStack92560 <= (int)auStack79280[lVar12 * 0x48 + 2]) &&
               (0xc3 < (int)auStack79280[lVar12 * 0x48 + 3])) goto LAB_18001d632;
          }
          if ((((6 < *(int *)puVar20) && (0xd0 < (int)auStack79280[lVar12 * 0x48 + 3])) ||
              (uVar4 != 0)) &&
             (*(int *)(*(longlong *)(param_3 + lStack92552 * 2 + 10) + 0x100) == 0)) {
            *(undefined4 *)(puVar3 + (longlong)*(int *)(puVar3 + 200) * 4) =
                 *(undefined4 *)((longlong)&uStackX16 + lVar7 + 0x10);
            ppuVar15 = (uint **)((longlong)puVar3 + (longlong)*(int *)(puVar3 + 200) * 0x20 + 4);
            if ((ppuVar15 != (uint **)0x0) &&
               ((&puStack92112 <= ppuVar15 || (ppuVar15 + 3 <= &uStack92136)))) {
              lVar13 = 0x18;
              puVar22 = (undefined4 *)((longlong)&uStack92136 - (longlong)ppuVar15);
              do {
                *(undefined *)ppuVar15 = *(undefined *)((longlong)ppuVar15 + (longlong)puVar22);
                ppuVar15 = (uint **)((longlong)ppuVar15 + 1);
                lVar13 = lVar13 + -1;
              } while (lVar13 != 0);
            }
            *(int *)(puVar3 + 200) = *(int *)(puVar3 + 200) + 1;
          }
          uVar6 = 0;
          if ((*(int *)((longlong)puVar3 + 0x684) != 0) || (uVar5 = uVar6, uVar4 != 0)) {
            uVar5 = 1;
          }
          *(undefined4 *)((longlong)puVar3 + 0x684) = uVar5;
          if ((*(int *)(puVar3 + 0xd1) != 0) || (uVar5 = uVar6, uVar24 != 0)) {
            uVar5 = 1;
          }
          *(undefined4 *)(puVar3 + 0xd1) = uVar5;
          if (uVar4 == 0) {
            iVar26 = *(int *)((longlong)&uStackX16 + lVar7 + 0x10);
            uVar24 = *(uint *)(&stack0x00000038 + lVar7);
          }
          else {
            if ((*(int *)((longlong)puVar3 + 0x644) != 0) ||
               (*(int *)(*(longlong *)(param_3 + lStack92552 * 2 + 10) + 0x100) != 0)) {
              uVar6 = 1;
            }
            *(undefined4 *)((longlong)puVar3 + 0x644) = uVar6;
            if ((*(int *)(*(longlong *)(param_3 + lStack92552 * 2 + 10) + 0x100) == 1) &&
               (*(int *)(puVar3 + 0xcd) < (int)auStack79280[lVar12 * 0x48 + -1])) {
              iVar26 = *(int *)((longlong)&uStackX16 + lVar7 + 0x10);
              lStack92552 = (longlong)iVar26;
              *(uint *)(puVar3 + 0xcd) = auStack79280[lVar12 * 0x48 + -1];
              *(longlong *)(&stack0xffffffffffffffe8 + lVar7) = (longlong)puVar3 + 0x66c;
              *(int *)(&stack0xffffffffffffffe0 + lVar7) = param_3[0x21f6];
              *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d800;
              FUN_180018ed0((longlong)(param_3 + 10),(longlong)(param_3 + 0x6e),&uStack92136,iVar26,
                            *(int *)(&stack0xffffffffffffffe0 + lVar7),
                            *(undefined8 **)(&stack0xffffffffffffffe8 + lVar7));
            }
            else {
              iVar26 = *(int *)((longlong)&uStackX16 + lVar7 + 0x10);
            }
            if (*(int *)((longlong)puVar3 + 0x64c) < (int)auStack79280[lVar12 * 0x48 + -1]) {
              ppuVar15 = (uint **)(puVar3 + 0xca);
              *(uint *)((longlong)puVar3 + 0x64c) = auStack79280[lVar12 * 0x48 + -1];
              if ((ppuVar15 != (uint **)0x0) &&
                 ((&puStack92112 <= ppuVar15 || (puVar3 + 0xcd <= &uStack92136)))) {
                *(int *)ppuVar15 = (int)uStack92136;
                *(undefined4 *)((longlong)puVar3 + 0x654) = uStack92136._4_4_;
                *(undefined4 *)(puVar3 + 0xcb) = uStack92128;
                *(undefined4 *)((longlong)puVar3 + 0x65c) = uStack92124;
                puVar3[0xcc] = uStack92120;
              }
              *(int *)(puVar3 + 0xc9) = iVar26;
            }
            *(int *)(*(longlong *)(param_3 + lStack92552 * 2 + 10) + 0x124) =
                 *(int *)(*(longlong *)(param_3 + lStack92552 * 2 + 10) + 0x124) + 1;
            *piStack92568 =
                 (*(int *)((longlong)&param_5 + lVar7) * 100) /
                 *(int *)((longlong)&uStackX16 + lVar7 + 0x14) >> 8;
            param_1 = piStack92568;
            if (iStack92536 == 0) break;
            uVar24 = *(uint *)(&stack0x00000038 + lVar7);
          }
        }
        param_1 = piStack92568;
        if (((*(int *)((longlong)puVar3 + 0x684) == 0) && (param_4[0xd] == 1)) && (2 < (int)uVar24))
        {
          lVar12 = *(longlong *)(&stack0x00000030 + lVar7);
          auStack91896[iVar26] = 1;
          *(undefined8 **)(&stack0xffffffffffffffe0 + lVar7) = &local_fd78;
          lVar13 = *(longlong *)(param_3 + (longlong)iVar26 * 2 + 10);
          *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d8f1;
          FUN_180033090(lVar13,lVar12,(longlong)(auStack91688 + (longlong)(iVar26 * 0x3e) * 4),
                        (longlong)(param_4 + 6),*(longlong *)(&stack0xffffffffffffffe0 + lVar7));
        }
      }
LAB_18001d8f7:
      iStack92556 = iStack92556 + 1;
      piStack92528 = piStack92528 + 1;
    } while (iStack92556 < param_3[7]);
    if (auStack92472._0_8_ != (void *)0x0) {
      *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d925;
      free(auStack92472._0_8_,*(undefined *)((longlong)&uStack72 + lVar7));
    }
    if (auStack92472._8_8_ != (void *)0x0) {
      *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d934;
      free(auStack92472._8_8_,*(undefined *)((longlong)&uStack72 + lVar7));
    }
    iVar26 = *(int *)((longlong)&uStackX16 + lVar7 + 0x14);
    param_2 = *(uint **)(&stack0x00000030 + lVar7);
    if (iVar26 < 2) goto LAB_18001d966;
    if (*(int *)(puVar3 + 0xd1) == 0) {
      *(undefined8 **)(&stack0xffffffffffffffe0 + lVar7) = puVar3;
      *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d966;
      FUN_18001ca90((longlong)param_3,(longlong)param_2,(longlong)&uStack79288,param_1,
                    *(longlong *)(&stack0xffffffffffffffe0 + lVar7));
      goto LAB_18001d966;
    }
  }
  if ((*param_1 == 0) && (param_4[0xd] != 0)) {
    if ((param_4[0x11] == 0) || (0x40 < (int)param_2[0x44])) {
      if ((0 < iVar26) && (param_4[0x11] == 0)) {
        *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001d9ee;
        uVar11 = FUN_18001c350((longlong)&uStack92424,*(undefined *)((longlong)&uStack72 + lVar7));
        if ((int)uVar11 != 0) {
          if (0 < param_3[7]) {
            piVar16 = aiStack92104;
            plVar18 = (longlong *)(param_3 + 10);
            do {
              if (*piVar16 != 0) {
                *(int *)(*plVar18 + 0x124) = *(int *)(*plVar18 + 0x124) + 1;
              }
              iVar19 = iVar19 + 1;
              plVar18 = plVar18 + 1;
              piVar16 = piVar16 + 1;
            } while (iVar19 < param_3[7]);
          }
          *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001da37;
          FUN_180019bb0((longlong)param_3,*(undefined *)((longlong)&uStack72 + lVar7));
          *param_1 = (*(int *)((longlong)&param_5 + lVar7) * 100) / iVar26 >> 8;
          goto LAB_18001da70;
        }
      }
      *(undefined4 **)(&stack0xffffffffffffffe8 + lVar7) = auStack91896;
      *(int **)(&stack0xffffffffffffffe0 + lVar7) = param_4;
      *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001da70;
      FUN_18001c4e0(param_1,param_2,auStack91688,param_3);
    }
    else {
      *param_1 = -0x20;
    }
  }
LAB_18001da70:
  *(undefined8 *)((longlong)&uStack72 + lVar7) = 0x18001da7f;
  FUN_18005f100(local_58 ^ (ulonglong)(&stack0xffffffffffffffc0 + lVar7),
                *(undefined *)((longlong)&uStack72 + lVar7));
  return;
}



void FUN_18001daa0(longlong param_1,longlong param_2,undefined8 param_3,longlong param_4,
                  int *param_5,undefined1 (*param_6) [9],uint *param_7)

{
  ushort uVar1;
  ushort uVar2;
  longlong lVar3;
  code *pcVar4;
  uint uVar5;
  uint uVar6;
  ulonglong uVar7;
  longlong lVar8;
  int iVar9;
  int *piVar10;
  ulonglong uVar11;
  int iVar12;
  int *piVar13;
  ulonglong uVar14;
  ulonglong uVar15;
  undefined auStack136 [32];
  longlong local_68;
  uint *local_60;
  undefined8 local_58;
  undefined8 local_50;
  undefined8 local_48;
  undefined4 local_40;
  undefined2 local_3c;
  undefined local_3a;
  undefined1 local_39;
  ulonglong local_38;

  local_38 = DAT_1800b04e8 ^ (ulonglong)auStack136;
  uVar14 = 0;
  lVar3 = *(longlong *)(param_2 + 0xf8);
  local_60 = param_7;
  local_68 = *(longlong *)(param_1 + 0xf8);
  local_58 = 0;
  local_50 = 0;
  local_48 = 0;
  local_40 = 0;
  local_3c = 0;
  local_3a = 0;
  if ((param_6 != (undefined1 (*) [9])0x0) &&
     ((param_6[3] + 4 <= &local_58 || ((undefined1 (*) [9])&local_39 <= param_6)))) {
    local_40 = *(undefined4 *)(param_6[2] + 6);
    local_3c = *(undefined2 *)(param_6[3] + 1);
    local_3a = param_6[3][3];
    local_58 = *(undefined8 *)*param_6;
    local_50 = *(undefined8 *)(*param_6 + 8);
    local_48 = *(undefined8 *)(param_6[1] + 7);
  }
  piVar10 = (int *)(param_4 + 0xf8);
  uVar11 = uVar14;
  uVar15 = uVar14;
  do {
    if ((piVar10[1] != -1) && (*piVar10 != -1)) {
      lVar8 = (longlong)piVar10[1] * 0x38;
      uVar1 = *(ushort *)(lVar8 + 2 + lVar3);
      uVar2 = *(ushort *)(lVar8 + 4 + lVar3);
      lVar8 = (longlong)*piVar10 * 0x38;
      iVar12 = ((int)((longlong)*param_5 * (ulonglong)uVar1 +
                      (longlong)param_5[1] * (ulonglong)uVar2 + 0x80 >> 8) + param_5[2]) -
               (uint)*(ushort *)(lVar8 + 2 + local_68);
      iVar9 = ((int)((longlong)param_5[4] * (ulonglong)uVar2 +
                     (longlong)param_5[3] * (ulonglong)uVar1 + 0x80 >> 8) + param_5[5]) -
              (uint)*(ushort *)(lVar8 + 4 + local_68);
      if (iVar9 * iVar9 + iVar12 * iVar12 < 0x64000) {
        uVar15 = (ulonglong)((int)uVar15 + 1);
        piVar13 = (int *)(param_4 + 4);
        uVar7 = uVar14;
        do {
          if (((*(char *)((longlong)&local_58 + uVar7) == '\x01') && (-1 < *piVar13)) &&
             (lVar8 = (longlong)*piVar13 * 0x38,
             iVar12 = (uint)uVar1 - (uint)*(ushort *)(lVar8 + 2 + lVar3),
             iVar9 = (uint)uVar2 - (uint)*(ushort *)(lVar8 + 4 + lVar3),
             iVar9 * iVar9 + iVar12 * iVar12 < 0x400000)) {
            if (0x1e < uVar7) {
              __report_rangecheckfailure();
              pcVar4 = (code *)swi(3);
              (*pcVar4)();
              return;
            }
            *(undefined *)((longlong)&local_58 + uVar7) = 0;
          }
          uVar7 = uVar7 + 1;
          piVar13 = piVar13 + 2;
        } while ((longlong)uVar7 < 0x1f);
      }
    }
    uVar11 = uVar11 + 1;
    piVar10 = piVar10 + 2;
  } while ((longlong)uVar11 < 0x1f);
  do {
    uVar5 = (uint)uVar15 + 1;
    if (*(char *)((longlong)&local_58 + uVar14) != '\x01') {
      uVar5 = (uint)uVar15;
    }
    uVar14 = uVar14 + 1;
    uVar15 = (ulonglong)uVar5;
  } while ((longlong)uVar14 < 0x1f);
  uVar6 = 0x1f;
  if ((int)uVar5 < 0x1f) {
    uVar6 = uVar5;
  }
  *param_7 = uVar6;
  FUN_18005f100(local_38 ^ (ulonglong)auStack136);
  return;
}



void FUN_18001de10(undefined8 *param_1)

{
  longlong lVar1;
  undefined8 *puVar2;
  longlong lVar3;
  undefined *puVar4;
  longlong lVar5;

  *(undefined4 *)(param_1 + 0xc9) = 0xffffffff;
  puVar2 = param_1 + 0xca;
  param_1[200] = 0;
  *(undefined4 *)(param_1 + 0xcd) = 0;
  *(undefined4 *)((longlong)param_1 + 0x64c) = 0;
  *(undefined8 *)((longlong)param_1 + 0x684) = 0;
  lVar5 = 0x18;
  if ((puVar2 != (undefined8 *)0x0) &&
     (((undefined8 *)((longlong)&DAT_18007c6e8 + 3) < puVar2 ||
      (param_1 + 0xcd < (undefined8 *)((longlong)&DAT_18007c6d4 + 1))))) {
    lVar1 = -(longlong)puVar2;
    lVar3 = lVar5;
    do {
      *(undefined *)puVar2 = ((undefined *)((longlong)&DAT_18007c6d4 + lVar1))[(longlong)puVar2];
      puVar2 = (undefined8 *)((longlong)puVar2 + 1);
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
  }
  puVar4 = (undefined *)((longlong)param_1 + 0x66c);
  if ((puVar4 != (undefined *)0x0) &&
     (((undefined *)((longlong)&DAT_18007c6e8 + 3) < puVar4 ||
      ((longlong)param_1 + 0x684U < 0x18007c6d5)))) {
    lVar1 = -(longlong)puVar4;
    do {
      *puVar4 = puVar4[(longlong)((longlong)&DAT_18007c6d4 + lVar1)];
      puVar4 = puVar4 + 1;
      lVar5 = lVar5 + -1;
    } while (lVar5 != 0);
  }
  lVar5 = 0x19;
  puVar2 = param_1;
  do {
    *puVar2 = 0;
    puVar2[1] = 0;
    puVar2[2] = 0;
    puVar2[3] = 0;
    puVar2[4] = 0;
    puVar2[5] = 0;
    puVar2[6] = 0;
    puVar2[7] = 0;
    lVar5 = lVar5 + -1;
    puVar2 = puVar2 + 8;
  } while (lVar5 != 0);
  *(undefined4 *)((longlong)param_1 + 0x68c) = 0;
  return;
}



void FUN_18001df10(int param_1,int param_2,int *param_3,int *param_4,longlong *param_5,
                  undefined4 *param_6,undefined4 *param_7)

{
  int iVar1;
  bool bVar2;
  bool bVar3;
  undefined4 uVar4;
  int iVar5;
  longlong lVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int local_b8 [4];
  undefined4 local_a8;
  undefined4 uStack164;
  undefined4 uStack160;
  undefined4 uStack156;
  undefined4 local_98;
  undefined4 uStack148;
  undefined4 uStack144;
  undefined4 uStack140;
  undefined4 local_88;
  undefined4 uStack132;
  undefined4 uStack128;
  undefined4 uStack124;
  undefined4 local_78;
  undefined4 local_74;
  int local_68 [4];
  undefined4 local_58;
  undefined4 uStack84;
  undefined4 uStack80;
  undefined4 uStack76;
  undefined4 local_48;
  undefined4 uStack68;
  undefined4 uStack64;
  undefined4 uStack60;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;

  iVar5 = 0x14;
  iVar7 = 0x100;
  iVar11 = 0x14;
  local_38 = 0xc9;
  iVar8 = 0x100;
  *param_7 = 0;
  iVar9 = *param_3;
  *param_6 = 0;
  local_34 = 0xc9;
  local_30 = 0xc9;
  local_68[0] = 0xe6;
  local_68[1] = 0xe6;
  local_68[2] = 0xe6;
  local_68[3] = 0xe1;
  local_48 = 0xd7;
  uStack68 = 0xd6;
  uStack64 = 0xd2;
  uStack60 = 0xd0;
  local_b8[0] = 0xe5;
  local_b8[1] = 0xe4;
  local_b8[2] = 0xe2;
  local_b8[3] = 0xe1;
  local_98 = 0xd6;
  uStack148 = 0xd3;
  uStack144 = 0xcf;
  uStack140 = 0xca;
  local_58 = 0xe0;
  uStack84 = 0xde;
  uStack80 = 0xde;
  uStack76 = 0xde;
  local_a8 = 0xe1;
  uStack164 = 0xde;
  uStack160 = 0xdc;
  uStack156 = 0xda;
  local_88 = 0xc9;
  uStack132 = 0xc0;
  uStack128 = 0xc0;
  uStack124 = 0xc0;
  local_78 = 0xc0;
  local_74 = 0xc0;
  if (param_2 == 1) {
    iVar1 = param_3[0xc];
    if (((0x3c < param_3[0xd]) && (4 < iVar9)) && (0x5dc < param_3[6])) {
      iVar9 = iVar9 + 1 + (param_3[0xd] + -0x3c) / 5;
    }
    if (((((iVar9 < 0x10) &&
          ((iVar9 < 5 || (param_3[4] == local_b8[iVar9 + -5] || param_3[4] < local_b8[iVar9 + -5])))
          ) && (iVar1 < 0x12)) &&
        ((iVar1 < 5 || (param_3[4] == local_68[iVar1 + -5] || param_3[4] < local_68[iVar1 + -5]))))
       && ((0x31 < param_3[9] ||
           ((iVar1 < 0x11 &&
            ((iVar1 < 5 ||
             (param_3[4] == local_b8[iVar1 + -5] + -5 || param_3[4] < local_b8[iVar1 + -5] + -5)))))
           ))) {
      bVar2 = false;
    }
    else {
      bVar2 = true;
    }
    if (iVar9 < 0xf) {
      if (iVar9 < 5) goto LAB_18001e17f;
      if (param_3[4] == local_b8[iVar9 + -5] + 7 || param_3[4] < local_b8[iVar9 + -5] + 7) {
        bVar3 = false;
        goto LAB_18001e18d;
      }
    }
LAB_18001e18b:
    bVar3 = true;
  }
  else {
    if (iVar9 < 0x15) {
      if (4 < iVar9) {
        lVar6 = (longlong)(iVar9 + -5);
        if (((*(int *)(*param_5 + lVar6 * 4) < param_3[2]) ||
            (*(int *)(param_5[1] + lVar6 * 4) < param_3[4])) ||
           ((*(int *)(param_5[2] + lVar6 * 4) < param_3[2] &&
            (*(int *)(param_5[3] + lVar6 * 4) < param_3[4])))) goto LAB_18001e118;
      }
      bVar2 = false;
    }
    else {
LAB_18001e118:
      bVar2 = true;
    }
    if (0xe < iVar9) goto LAB_18001e18b;
    if (4 < iVar9) {
      lVar6 = (longlong)(iVar9 + -5) * 4;
      if (((*(int *)(lVar6 + *param_5) + 7 < param_3[2]) ||
          (*(int *)(param_5[1] + lVar6) + 7 < param_3[4])) ||
         ((*(int *)(param_5[2] + lVar6) + 7 < param_3[2] &&
          (*(int *)(param_5[3] + lVar6) + 7 < param_3[4])))) goto LAB_18001e18b;
    }
LAB_18001e17f:
    bVar3 = false;
  }
LAB_18001e18d:
  if (!bVar2) {
    return;
  }
  iVar9 = param_3[7];
  if (((499 < iVar9) && (0x31 < param_3[9])) && (0x31 < param_3[8])) {
    return;
  }
  if ((((0x54 < param_3[0xb]) && (0x54 < param_3[10])) &&
      ((!bVar3 && ((0x45 < param_3[9] && (0x45 < param_3[8])))))) &&
     (*(int *)(&DAT_18007d260 + (longlong)(*param_3 + -5) * 4) <= iVar9)) {
    return;
  }
  *param_7 = 1;
  if (param_2 != 1) {
    return;
  }
  if (param_3[9] < 0x15) {
    return;
  }
  if (param_3[8] < 0x15) {
    return;
  }
  if (299 < iVar9) {
    return;
  }
  iVar9 = param_3[5];
  if (iVar9 < 0xd7) {
    return;
  }
  iVar1 = param_3[1];
  iVar10 = param_3[3];
  if ((((iVar1 < 7) && (param_3[6] < 0x500)) && (0x46 < param_3[9])) && (0x46 < param_3[8])) {
    iVar10 = iVar10 + -4;
    iVar9 = iVar9 + -4;
  }
  if (param_1 == 9) {
    iVar7 = 0xeb;
    iVar5 = 0xc;
    iVar11 = 0xd;
    iVar8 = 0xe8;
  }
  else {
    if (param_1 == 10) {
      iVar7 = 0xee;
      iVar11 = 0x10;
      iVar5 = 0xd;
      iVar8 = 0xeb;
    }
  }
  if (iVar1 <= iVar5) {
    if (iVar1 < 5) {
      return;
    }
    if ((iVar10 <= *(int *)(param_5[4] + (longlong)(iVar1 + -5) * 4)) &&
       (iVar9 <= *(int *)(param_5[5] + (longlong)(iVar1 + -5) * 4))) {
      return;
    }
  }
  if (iVar1 <= iVar11) {
    if (iVar1 < 6) {
LAB_18001e2fa:
      *param_4 = *param_4 + -1;
      goto LAB_18001e306;
    }
    iVar5 = *(int *)(param_5[4] + (longlong)(iVar1 + -5) * 4) + 6;
    if (iVar5 < iVar7) {
      iVar7 = iVar5;
    }
    if (iVar10 <= iVar7) {
      iVar5 = *(int *)(param_5[5] + (longlong)(iVar1 + -5) * 4) + 6;
      if (iVar5 < iVar8) {
        iVar8 = iVar5;
      }
      if (iVar9 <= iVar8) goto LAB_18001e2fa;
    }
  }
  *param_4 = 0;
LAB_18001e306:
  uVar4 = *param_6;
  if (*param_4 == 0) {
    uVar4 = 1;
  }
  *param_6 = uVar4;
  return;
}



// WARNING: Could not reconcile some variable overlaps
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18001e340(int *param_1,longlong param_2,longlong param_3,longlong param_4,longlong *param_5
                  ,undefined4 *param_6)

{
  undefined8 *puVar1;
  int *piVar2;
  bool bVar3;
  uint *_Memory;
  byte bVar4;
  int iVar5;
  int iVar6;
  ulonglong uVar7;
  uint uVar8;
  ulonglong *puVar9;
  longlong lVar10;
  longlong lVar11;
  uint uVar12;
  uint uVar13;
  undefined *puVar14;
  longlong lVar15;
  uint uVar16;
  int iVar17;
  int iVar18;
  longlong lVar19;
  longlong lVar20;
  int iVar21;
  int iVar22;
  longlong lVar23;
  int *piVar24;
  bool bVar25;
  int local_268;
  uint local_264;
  int local_260;
  int local_25c;
  longlong local_258;
  int local_250;
  int local_24c;
  int local_248 [2];
  longlong local_240;
  longlong local_238;
  int local_230 [2];
  longlong local_228;
  int *local_220;
  uint local_218;
  uint local_214;
  longlong local_210;
  int local_208;
  longlong local_200;
  uint *local_1f8;
  int local_1f0;
  int local_1ec;
  int local_1e8;
  int *local_1e0;
  int *local_1d8;
  uint *local_1d0;
  longlong *local_1c8;
  int *local_1c0;
  undefined4 *local_1b8;
  int local_1a8 [4];
  undefined4 local_198;
  undefined4 uStack404;
  undefined4 uStack400;
  undefined4 uStack396;
  undefined local_188 [16];
  undefined local_178 [16];
  undefined4 local_168;
  undefined4 local_164;
  int local_158 [4];
  undefined4 local_148;
  undefined4 uStack324;
  undefined4 uStack320;
  undefined4 uStack316;
  undefined4 local_138;
  undefined4 uStack308;
  undefined4 uStack304;
  undefined4 uStack300;
  undefined4 local_128;
  undefined4 local_124;
  undefined4 local_120;
  int local_118;
  int local_114;
  int local_110;
  int local_10c;
  uint local_108;
  int local_104;
  int local_100;
  int local_fc;
  undefined local_f8 [8];
  int local_f0;
  int local_ec;
  undefined local_e8 [24];
  int local_d0 [2];
  int local_c8;
  int iStack196;
  int local_c0;
  int iStack188;
  int local_b8;
  int iStack180;
  int iStack176;
  undefined4 local_ac;
  int local_a8;
  int iStack164;
  int iStack160;
  int iStack156;
  undefined local_98 [16];
  undefined8 local_88;
  int local_80 [2];
  undefined8 local_78;
  ulonglong uStack112;
  undefined8 local_68;
  int local_60;
  int iStack92;
  int iStack88;
  int iStack84;
  undefined8 local_50;
  ulonglong local_48 [2];

  local_48[0] = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffd58;
  iVar5 = param_1[7];
  lVar11 = (longlong)iVar5;
  local_1b8 = param_6;
  local_1c0 = param_1 + 0x6e;
  local_1e0 = param_1 + 10;
  local_208 = param_1[0x21f6];
  local_1ec = 10;
  local_230[0] = 10;
  bVar25 = *(int *)(param_2 + 0x688) != 0;
  local_214 = param_1[1];
  if (bVar25) {
    local_1ec = 5;
  }
  local_218 = param_1[2];
  local_1e8 = 0xf;
  if (bVar25) {
    local_1e8 = 8;
  }
  uVar12 = local_218 * local_214;
  local_1c8 = param_5;
  local_60 = 0x100;
  iStack92 = 0;
  iStack88 = 0;
  iStack84 = 0;
  local_50 = 0x100;
  local_78 = 0x100;
  uStack112 = 0;
  local_68 = 0x100;
  local_248[0] = -1;
  local_240 = param_4;
  local_210 = param_3;
  local_200 = param_2;
  local_1d8 = param_1;
  _Memory = (uint *)malloc((longlong)(int)uVar12 + 0x20);
  if (_Memory != (uint *)0x0) {
    _Memory[3] = uVar12;
    *_Memory = local_214;
    _Memory[2] = local_214;
    *(uint **)(_Memory + 6) = _Memory + 8;
    _Memory[1] = local_218;
    _Memory[4] = 1;
  }
  local_1d0 = _Memory;
  local_1f8 = (uint *)malloc((longlong)(int)uVar12 + 0x20);
  if (local_1f8 != (uint *)0x0) {
    local_1f8[3] = uVar12;
    *local_1f8 = local_214;
    local_1f8[2] = local_214;
    *(uint **)(local_1f8 + 6) = local_1f8 + 8;
    local_1f8[1] = local_218;
    local_1f8[4] = 1;
  }
  if ((*(undefined **)(_Memory + 6) != (undefined *)0x0) && (_Memory[3] != 0)) {
    uVar7 = (ulonglong)_Memory[3];
    puVar14 = *(undefined **)(_Memory + 6);
    while (uVar7 != 0) {
      uVar7 = uVar7 - 1;
      *puVar14 = 0xff;
      puVar14 = puVar14 + 1;
    }
  }
  puVar14 = *(undefined **)(local_1f8 + 6);
  uVar7 = (ulonglong)_Memory[3];
  if ((puVar14 != (undefined *)0x0) && (_Memory[3] != 0)) {
    while (uVar7 != 0) {
      uVar7 = uVar7 - 1;
      *puVar14 = 0xff;
      puVar14 = puVar14 + 1;
    }
  }
  lVar19 = (longlong)local_208;
  local_25c = 0;
  local_258 = lVar11;
  local_228 = lVar19;
  if (0 < iVar5) {
    uVar7 = (ulonglong)local_108;
    local_268 = local_110;
    local_238 = 0;
    local_264 = local_108;
    lVar10 = local_240;
    do {
      if (1 < *(byte *)(local_238 + lVar10)) {
        piVar24 = (int *)(param_3 + (longlong)local_25c * 0x48);
        if ((piVar24 != (int *)0x0) && ((piVar24 + 0x12 <= &local_118 || (local_d0 <= piVar24)))) {
          local_268 = piVar24[2];
          local_264 = piVar24[4];
          local_118 = *piVar24;
          local_114 = piVar24[1];
          local_110 = local_268;
          local_10c = piVar24[3];
          local_108 = local_264;
          local_104 = piVar24[5];
          local_100 = piVar24[6];
          local_fc = piVar24[7];
          uVar7 = (ulonglong)local_264;
          _local_f8 = *(undefined (*) [16])(piVar24 + 8);
          local_e8._0_16_ = *(undefined (*) [16])(piVar24 + 0xc);
        }
        if ((0xe < local_118) || (lVar11 = local_258, 199 < (int)uVar7)) {
          iVar22 = 0;
          iVar18 = 0;
          local_250 = 0;
          local_24c = 0;
          lVar23 = 0;
          local_260 = 0;
          piVar24 = (int *)(param_3 + 0x24);
          lVar11 = local_258;
          lVar15 = local_238;
          iVar5 = local_268;
          do {
            iVar6 = local_260;
            if (((lVar15 != lVar23) && (*(char *)(lVar10 + lVar23) != '\0')) &&
               (lVar11 = local_258, *(int *)(*(longlong *)(local_1e0 + lVar23 * 2) + 0x100) == 1)) {
              iVar21 = iVar22;
              local_220 = piVar24;
              if (lVar23 == lVar19) {
                puVar1 = (undefined8 *)(param_2 + 0x66c);
                if ((puVar1 != (undefined8 *)0x0) &&
                   (((undefined8 *)(param_2 + 0x684U) <= &local_78 || (&local_60 <= puVar1)))) {
                  local_78 = *puVar1;
                  uStack112 = *(ulonglong *)(param_2 + 0x674);
                  local_68 = *(undefined8 *)(param_2 + 0x67c);
                }
              }
              else {
                if (lVar23 < lVar19) {
                  puVar9 = (ulonglong *)
                           (local_1c0 +
                           (longlong)
                           (*(int *)(*(longlong *)(local_1e0 + lVar19 * 2) + 0x104) + local_260) * 7
                           + 1);
                  if ((puVar9 != (ulonglong *)0x0) &&
                     ((puVar9 + 3 <= &local_60 || (local_48 <= puVar9)))) {
                    local_60 = *(int *)puVar9;
                    iStack92 = *(int *)((longlong)puVar9 + 4);
                    iStack88 = *(int *)(puVar9 + 1);
                    iStack84 = *(int *)((longlong)puVar9 + 0xc);
                    local_50 = puVar9[2];
                  }
                  if ((int *)(param_2 + 0x66c) != (int *)0x0) {
                    lVar20 = (longlong)*(int *)(param_2 + 0x66c);
                    lVar19 = (longlong)iStack92;
                    lVar15 = (longlong)local_60;
                    lVar10 = (longlong)iStack84;
                    uVar12 = (int)((ulonglong)
                                   (*(int *)(param_2 + 0x680) * lVar19 +
                                   *(int *)(param_2 + 0x674) * lVar15) >> 8) + iStack88;
                    lVar11 = (longlong)(int)local_50;
                    bVar4 = 0xf;
                    uVar13 = 0;
                    iVar5 = (int)((ulonglong)
                                  (*(int *)(param_2 + 0x670) * lVar10 +
                                  *(int *)(param_2 + 0x67c) * lVar11) >> 8) +
                            (int)((ulonglong)(lVar19 * *(int *)(param_2 + 0x678) + lVar20 * lVar15)
                                 >> 8) >> 1;
                    iVar22 = (int)((ulonglong)(lVar10 * lVar20 + *(int *)(param_2 + 0x678) * lVar11)
                                  >> 8) -
                             (int)((ulonglong)
                                   (*(int *)(param_2 + 0x67c) * lVar19 +
                                   *(int *)(param_2 + 0x670) * lVar15) >> 8) >> 1;
                    local_50._4_4_ =
                         (int)((ulonglong)
                               (lVar10 * *(int *)(param_2 + 0x674) +
                               *(int *)(param_2 + 0x680) * lVar11) >> 8) + local_50._4_4_;
                    uVar8 = 0x8000;
                    uVar16 = iVar22 * iVar22 + iVar5 * iVar5;
                    uVar7 = (ulonglong)uVar16;
                    if (1 < uVar16) {
                      do {
                        uVar16 = uVar8 + uVar13 * 2 << (bVar4 & 0x1f);
                        bVar4 = bVar4 - 1;
                        if (uVar16 <= (uint)uVar7) {
                          uVar13 = uVar13 + uVar8;
                          uVar7 = (ulonglong)((uint)uVar7 - uVar16);
                        }
                        uVar8 = uVar8 >> 1;
                      } while (uVar8 != 0);
                      uVar7 = (ulonglong)uVar13;
                    }
                    param_5 = local_1c8;
                    if ((int)uVar7 == 0) {
                      local_78 = 0x100;
                      local_68 = CONCAT44(local_50._4_4_,0x100);
                      uStack112 = (ulonglong)uVar12;
                      param_2 = local_200;
                      iVar21 = local_250;
                      iVar18 = local_24c;
                    }
                    else {
                      iVar18 = (int)uVar7 >> 1;
                      iVar5 = iVar18 + iVar5 * 0x100;
                      iVar18 = iVar18 + iVar22 * -0x100;
LAB_18001e99e:
                      iVar5 = iVar5 / (int)uVar7;
                      local_68 = CONCAT44(local_50._4_4_,iVar5);
                      iVar18 = iVar18 / (int)uVar7;
                      local_78 = CONCAT44(iVar18,iVar5);
                      uStack112 = CONCAT44(-iVar18,uVar12);
                      piVar24 = local_220;
                      param_2 = local_200;
                      iVar21 = local_250;
                      iVar18 = local_24c;
                      iVar6 = local_260;
                    }
                  }
                }
                else {
                  if (local_1c0 +
                      (longlong)
                      (*(int *)(*(longlong *)(local_1e0 + lVar23 * 2) + 0x104) + local_208) * 7 + 1
                      != (int *)0x0) {
                    FUN_180023cd0(local_1c0 +
                                  (longlong)
                                  (*(int *)(*(longlong *)(local_1e0 + lVar23 * 2) + 0x104) +
                                  local_208) * 7 + 1,&local_60);
                  }
                  if ((int *)(param_2 + 0x66c) != (int *)0x0) {
                    lVar20 = (longlong)*(int *)(param_2 + 0x66c);
                    lVar15 = (longlong)local_60;
                    lVar10 = (longlong)iStack92;
                    uVar8 = 0x8000;
                    lVar11 = (longlong)iStack84;
                    uVar12 = (int)((ulonglong)
                                   (*(int *)(param_2 + 0x680) * lVar10 +
                                   *(int *)(param_2 + 0x674) * lVar15) >> 8) + iStack88;
                    lVar19 = (longlong)(int)local_50;
                    bVar4 = 0xf;
                    iVar5 = (int)((ulonglong)
                                  (*(int *)(param_2 + 0x67c) * lVar19 +
                                  *(int *)(param_2 + 0x670) * lVar11) >> 8) +
                            (int)((ulonglong)(*(int *)(param_2 + 0x678) * lVar10 + lVar20 * lVar15)
                                 >> 8) >> 1;
                    uVar13 = 0;
                    local_50._4_4_ =
                         (int)((ulonglong)
                               (*(int *)(param_2 + 0x674) * lVar11 +
                               *(int *)(param_2 + 0x680) * lVar19) >> 8) + local_50._4_4_;
                    iVar22 = (int)((ulonglong)(lVar20 * lVar11 + *(int *)(param_2 + 0x678) * lVar19)
                                  >> 8) -
                             (int)((ulonglong)
                                   (*(int *)(param_2 + 0x67c) * lVar10 +
                                   *(int *)(param_2 + 0x670) * lVar15) >> 8) >> 1;
                    uVar16 = iVar22 * iVar22 + iVar5 * iVar5;
                    uVar7 = (ulonglong)uVar16;
                    if (1 < uVar16) {
                      do {
                        uVar16 = uVar8 + uVar13 * 2 << (bVar4 & 0x1f);
                        bVar4 = bVar4 - 1;
                        if (uVar16 <= (uint)uVar7) {
                          uVar13 = uVar13 + uVar8;
                          uVar7 = (ulonglong)((uint)uVar7 - uVar16);
                        }
                        uVar8 = uVar8 >> 1;
                      } while (uVar8 != 0);
                      uVar7 = (ulonglong)uVar13;
                    }
                    if ((int)uVar7 != 0) {
                      iVar18 = (int)uVar7 >> 1;
                      iVar5 = iVar18 + iVar5 * 0x100;
                      iVar18 = iVar18 + iVar22 * -0x100;
                      goto LAB_18001e99e;
                    }
                    local_78 = 0x100;
                    local_68 = CONCAT44(local_50._4_4_,0x100);
                    uStack112 = (ulonglong)uVar12;
                    piVar24 = local_220;
                    param_2 = local_200;
                    iVar21 = local_250;
                    iVar18 = local_24c;
                    iVar6 = local_260;
                  }
                }
              }
              local_220 = (int *)((ulonglong)local_220 & 0xffffffff00000000);
              local_1f0 = 0;
              local_260 = 0;
              local_1f8 = (uint *)FUN_180028500((int *)local_1d0,local_1f8,uVar7,(int *)&local_78,
                                                (int *)&local_220,&local_1f0,&local_260);
              iVar5 = 100 - ((local_260 * 100) / (int)local_218) / (int)local_214;
              if (((iVar5 < 0x33) ||
                  (*(int *)(*(longlong *)(local_1e0 + lVar23 * 2) + 0x10c) < 0x51)) ||
                 (*piVar24 < 0x4c)) {
                if (((iVar5 < 0x2e) ||
                    (*(int *)(*(longlong *)(local_1e0 + lVar23 * 2) + 0x10c) < 0x47)) ||
                   (*piVar24 < 0x47)) {
                  uVar7 = (ulonglong)local_264;
                  lVar11 = local_258;
                  lVar19 = local_228;
                  lVar15 = local_238;
                  lVar10 = local_240;
                  iVar5 = local_268;
                  iVar22 = iVar21;
                }
                else {
                  piVar2 = (int *)(local_210 + (longlong)iVar6 * 0x48);
                  if ((piVar2 != (int *)0x0) &&
                     ((piVar2 + 0x12 <= &local_c8 || (local_80 <= piVar2)))) {
                    local_c8 = *piVar2;
                    iStack196 = piVar2[1];
                    local_c0 = piVar2[2];
                    iStack188 = piVar2[3];
                    local_b8 = piVar2[4];
                    iStack180 = piVar2[5];
                    iStack176 = piVar2[6];
                    local_a8 = piVar2[8];
                    iStack164 = piVar2[9];
                    iStack160 = piVar2[10];
                    iStack156 = piVar2[0xb];
                    local_98 = *(undefined (*) [16])(piVar2 + 0xc);
                    local_88 = *(undefined8 *)(piVar2 + 0x10);
                  }
                  local_b8 = local_b8 + local_1e8;
                  local_c0 = local_c0 + local_1e8;
                  local_ac = 0;
                  local_250 = iVar21 + 1;
                  FUN_18001df10(*local_1d8,1,&local_c8,local_230,param_5,(undefined4 *)&local_220,
                                local_248);
                  uVar7 = (ulonglong)local_264;
                  lVar11 = local_258;
                  lVar19 = local_228;
                  lVar15 = local_238;
                  lVar10 = local_240;
                  iVar5 = local_268;
                  iVar22 = iVar21 + 1;
                  if (local_248[0] == 1) goto LAB_18001ec41;
                }
              }
              else {
                piVar2 = (int *)(local_210 + (longlong)iVar6 * 0x48);
                if ((piVar2 != (int *)0x0) && ((piVar2 + 0x12 <= &local_c8 || (local_80 <= piVar2)))
                   ) {
                  local_c8 = *piVar2;
                  iStack196 = piVar2[1];
                  local_c0 = piVar2[2];
                  iStack188 = piVar2[3];
                  local_b8 = piVar2[4];
                  iStack180 = piVar2[5];
                  iStack176 = piVar2[6];
                  local_a8 = piVar2[8];
                  iStack164 = piVar2[9];
                  iStack160 = piVar2[10];
                  iStack156 = piVar2[0xb];
                  local_98 = *(undefined (*) [16])(piVar2 + 0xc);
                  local_88 = *(undefined8 *)(piVar2 + 0x10);
                }
                local_b8 = local_b8 + local_1ec;
                local_c0 = local_c0 + local_1ec;
                local_ac = 0;
                local_250 = iVar21 + 1;
                FUN_18001df10(*local_1d8,1,&local_c8,local_230,param_5,(undefined4 *)&local_220,
                              local_248);
                uVar7 = (ulonglong)local_264;
                if (local_248[0] == 0) {
                  local_264 = local_264 - 4;
                  uVar7 = (ulonglong)local_264;
                  local_268 = local_268 + -4;
                  lVar11 = local_258;
                  lVar19 = local_228;
                  lVar15 = local_238;
                  lVar10 = local_240;
                  iVar5 = local_268;
                  iVar22 = iVar21 + 1;
                }
                else {
LAB_18001ec41:
                  iVar18 = iVar18 + 1;
                  lVar11 = local_258;
                  lVar19 = local_228;
                  lVar15 = local_238;
                  lVar10 = local_240;
                  iVar5 = local_268;
                  iVar22 = iVar21 + 1;
                  local_24c = iVar18;
                }
              }
            }
            local_260 = iVar6 + 1;
            piVar24 = piVar24 + 0x12;
            lVar23 = lVar23 + 1;
          } while (lVar23 < lVar11);
          if ((0 < iVar22) && (iVar18 * 2 < iVar22)) {
            local_264 = (int)uVar7 - 4;
            uVar7 = (ulonglong)local_264;
            local_268 = iVar5 + -4;
          }
          iVar6 = 0x14;
          iVar22 = 0x100;
          iVar21 = 0x14;
          iVar18 = 0x100;
          local_158[0] = 0xe6;
          local_158[1] = 0xe6;
          local_158[2] = 0xe6;
          local_158[3] = 0xe1;
          local_248[0] = 0;
          local_128 = 0xc9;
          local_124 = 0xc9;
          local_120 = 0xc9;
          local_168 = 0xc0;
          local_164 = 0xc0;
          local_138 = 0xd7;
          uStack308 = 0xd6;
          uStack304 = 0xd2;
          uStack300 = 0xd0;
          local_1a8[0] = 0xe5;
          local_1a8[1] = 0xe4;
          local_1a8[2] = 0xe2;
          local_1a8[3] = 0xe1;
          local_188 = _DAT_1800a4320;
          local_148 = 0xe0;
          uStack324 = 0xde;
          uStack320 = 0xde;
          uStack316 = 0xde;
          local_198 = 0xe1;
          uStack404 = 0xde;
          uStack400 = 0xdc;
          uStack396 = 0xda;
          local_178 = _DAT_1800a42b0;
          iVar5 = local_118;
          if (((0x3c < local_e8._4_4_) && (4 < local_118)) && (0x5dc < local_100)) {
            iVar5 = (local_e8._4_4_ + -0x3c) / 5 + 1 + local_118;
          }
          iVar17 = (int)uVar7;
          if ((((iVar5 < 0x10) && ((iVar5 < 5 || (iVar17 <= local_1a8[iVar5 + -5])))) &&
              (local_e8._0_4_ < 0x12)) &&
             (((local_e8._0_4_ < 5 || (iVar17 <= local_158[local_e8._0_4_ + -5])) &&
              ((0x31 < local_f8._4_4_ ||
               ((local_e8._0_4_ < 0x11 &&
                ((local_e8._0_4_ < 5 || (iVar17 <= local_1a8[local_e8._0_4_ + -5] + -5)))))))))) {
            bVar25 = false;
          }
          else {
            bVar25 = true;
          }
          if ((iVar5 < 0xf) && ((iVar5 < 5 || (iVar17 <= local_1a8[iVar5 + -5] + 7)))) {
            bVar3 = false;
          }
          else {
            bVar3 = true;
          }
          lVar11 = local_258;
          lVar19 = local_228;
          lVar10 = local_240;
          param_3 = local_210;
          local_220 = piVar24;
          if (((bVar25) &&
              (((local_fc < 500 || (local_f8._4_4_ < 0x32)) || (local_f8._0_4_ < 0x32)))) &&
             (((((local_ec < 0x55 || (local_f0 < 0x55)) || (bVar3)) ||
               ((local_f8._4_4_ < 0x46 || (local_f8._0_4_ < 0x46)))) ||
              (local_fc < *(int *)(&DAT_18007d260 + (longlong)(local_118 + -5) * 4))))) {
            local_248[0] = 1;
            if ((((0x14 < local_f8._4_4_) && (0x14 < local_f8._0_4_)) && (local_fc < 300)) &&
               (0xd6 < local_104)) {
              iVar17 = local_104;
              iVar5 = local_10c;
              if (((local_114 < 7) && (local_100 < 0x500)) &&
                 ((0x46 < local_f8._4_4_ && (0x46 < local_f8._0_4_)))) {
                iVar5 = local_10c + -4;
                iVar17 = local_104 + -4;
              }
              if (*local_1d8 == 9) {
                iVar22 = 0xeb;
                iVar6 = 0xd;
                iVar21 = 0xc;
                iVar18 = 0xe8;
              }
              else {
                if (*local_1d8 == 10) {
                  iVar22 = 0xee;
                  iVar6 = 0x10;
                  iVar21 = 0xd;
                  iVar18 = 0xeb;
                }
              }
              if ((iVar21 < local_114) ||
                 ((4 < local_114 &&
                  ((*(int *)(param_5[4] + (longlong)(local_114 + -5) * 4) < iVar5 ||
                   (*(int *)(param_5[5] + (longlong)(local_114 + -5) * 4) < iVar17)))))) {
                if (local_114 <= iVar6) {
                  if (local_114 < 6) {
LAB_18001ef8d:
                    local_230[0] = local_230[0] + -1;
                    goto LAB_18001ef9b;
                  }
                  iVar6 = *(int *)(param_5[4] + (longlong)(local_114 + -5) * 4) + 6;
                  if (iVar6 < iVar22) {
                    iVar22 = iVar6;
                  }
                  if (iVar5 <= iVar22) {
                    iVar5 = *(int *)(param_5[5] + (longlong)(local_114 + -5) * 4) + 6;
                    if (iVar5 < iVar18) {
                      iVar18 = iVar5;
                    }
                    if (iVar17 <= iVar18) goto LAB_18001ef8d;
                  }
                }
                local_230[0] = 0;
              }
            }
LAB_18001ef9b:
            uVar7 = (ulonglong)local_264;
            *local_1b8 = 1;
          }
        }
      }
      local_25c = local_25c + 1;
      local_238 = local_238 + 1;
      _Memory = local_1d0;
    } while (local_238 < lVar11);
  }
  free(_Memory);
  if (local_1f8 != (uint *)0x0) {
    free(local_1f8);
  }
  FUN_18005f100(local_48[0] ^ (ulonglong)&stack0xfffffffffffffd58);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18001f030(int *param_1,uint *param_2,undefined8 param_3,longlong param_4,int param_5,
                  ulonglong *param_6,uint *param_7)

{
  undefined8 *puVar1;
  uint uVar2;
  longlong lVar3;
  uint *puVar4;
  ulonglong uVar5;
  undefined8 *puVar6;
  ulonglong *puVar7;
  uint *puVar8;
  bool bVar9;
  bool bVar10;
  int iVar11;
  undefined8 in_stack_fffffffffffffca0;
  uint local_348;
  uint local_344;
  uint *local_340;
  undefined8 local_338 [62];
  undefined8 local_148;
  undefined4 uStack320;
  undefined4 uStack316;
  ulonglong local_138;
  undefined4 local_130;
  undefined2 local_12c;
  undefined local_12a;
  undefined8 local_128;
  undefined8 local_120;
  undefined8 local_118;
  uint local_110;
  undefined2 local_10c;
  undefined local_10a;
  undefined8 local_108 [22];
  undefined8 local_54;
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffc58;
  local_148._0_4_ = 0;
  local_148._4_4_ = 0;
  uStack320 = 0;
  uStack316 = 0;
  lVar3 = 7;
  local_138 = 0;
  local_130 = 0;
  local_12c = 0;
  local_12a = 0;
  puVar1 = local_338;
  do {
    puVar6 = puVar1;
    *puVar6 = 0xffffffffffffffff;
    puVar6[1] = 0xffffffffffffffff;
    puVar6[2] = 0xffffffffffffffff;
    puVar6[3] = 0xffffffffffffffff;
    puVar6[4] = 0xffffffffffffffff;
    puVar6[5] = 0xffffffffffffffff;
    puVar6[6] = 0xffffffffffffffff;
    puVar6[7] = 0xffffffffffffffff;
    lVar3 = lVar3 + -1;
    puVar1 = puVar6 + 8;
  } while (lVar3 != 0);
  puVar6[8] = 0xffffffffffffffff;
  puVar6[9] = 0xffffffffffffffff;
  puVar6[10] = 0xffffffffffffffff;
  puVar6[0xb] = 0xffffffffffffffff;
  puVar6[0xc] = 0xffffffffffffffff;
  puVar6[0xd] = 0xffffffffffffffff;
  if (param_5 < 0x32) {
    puVar8 = *(uint **)(param_1 + (longlong)param_5 * 2 + 10);
  }
  else {
    puVar8 = *(uint **)(param_1 + (longlong)(param_5 + -0x32) * 2 + 0x2344);
  }
  puVar6 = local_338;
  local_340 = param_2;
  FUN_180032d90(puVar8,(longlong)param_2,param_3,(longlong)puVar6,(undefined4 *)(param_4 + 0x18),
                *param_1,0,0);
  uVar5 = (longlong)param_5 & 0xffffffff;
  puVar1 = (undefined8 *)(param_7 + 0x15);
  uVar2 = FUN_18001a470(param_1,(longlong)param_2,(int)uVar5,puVar6,4,4,(longlong)local_338,param_6,
                        (undefined1 (*) [9])&local_148,in_stack_fffffffffffffca0,puVar1);
  local_348 = 0;
  if (6 < (int)uVar2) {
    FUN_18001daa0((longlong)puVar8,(longlong)local_340,uVar5,(longlong)local_338,(int *)param_6,
                  (undefined1 (*) [9])&local_148,&local_348);
    if ((int)uVar2 < (int)local_348) {
      uVar2 = local_348;
    }
  }
  param_7[3] = local_348;
  *param_7 = uVar2;
  param_7[1] = uVar2;
  if (uVar2 - 1 < 0xf) {
    local_344 = 0;
    local_348 = 0;
    FUN_18002a930(local_340,puVar8,param_6,param_1[3],(int *)&local_348,(int *)&local_344);
    local_148._0_4_ = 0x1e;
    local_148._4_4_ = 0x3d;
    uStack320 = 0x28;
    uStack316 = 0x26;
    local_138 = 0x1000000000;
    puVar7 = param_6;
    FUN_180033390((int *)puVar8,(longlong)local_340,(longlong)local_338,(int *)param_6,
                  (int *)&local_148,*param_1,0);
    memset(local_108,0,0xb4);
    puVar4 = local_340;
    local_128 = 0;
    local_120 = 0;
    local_118 = 0;
    local_110 = 0;
    local_10c = 0;
    local_10a = 0;
    local_344 = FUN_18001a470(param_1,(longlong)local_340,param_5,puVar7,2,2,(longlong)local_338,
                              &local_148,(undefined1 (*) [9])&local_128,in_stack_fffffffffffffca0,
                              local_108);
    FUN_180034a50((int *)puVar8,(longlong)puVar4,(int *)&local_148,local_344,&local_128,
                  (longlong)local_108,*param_1);
    param_7[10] = (uint)local_120;
    param_7[0xb] = local_120._4_4_;
    if ((int)uVar2 < (int)local_344) {
      if ((param_6 != (ulonglong *)0x0) && ((&local_130 <= param_6 || (param_6 + 3 <= &local_148))))
      {
        *(int *)param_6 = (int)local_148;
        *(undefined4 *)((longlong)param_6 + 4) = local_148._4_4_;
        *(undefined4 *)(param_6 + 1) = uStack320;
        *(undefined4 *)((longlong)param_6 + 0xc) = uStack316;
        param_6[2] = local_138;
      }
      if (((int)local_348 < 0x91) || ((int)(uint)local_120 < 0x28)) {
        if ((int)local_348 < 0x69) {
          if (0x41 < (int)(uint)local_120) {
            bVar10 = SBORROW4(local_120._4_4_,0x32);
            iVar11 = -0x32;
            bVar9 = local_120._4_4_ == 0x32;
            goto LAB_18001f3df;
          }
        }
        else {
          if (0x2c < (int)(uint)local_120) {
            bVar10 = SBORROW4(local_120._4_4_,0x19);
            iVar11 = -0x19;
            bVar9 = local_120._4_4_ == 0x19;
LAB_18001f3df:
            if (!bVar9 && bVar10 == (int)(local_120._4_4_ + iVar11) < 0) goto LAB_18001f3f0;
          }
        }
        if (((int)local_120._4_4_ < 0x51) && ((int)local_344 < 0x13)) goto LAB_18001f472;
      }
LAB_18001f3f0:
      param_7[1] = local_344;
      if ((puVar1 != (undefined8 *)0x0) && ((&local_54 <= puVar1 || (param_7 + 0x42 <= local_108))))
      {
        memcpy_FUN_180061f90(puVar1,local_108,0xb4);
      }
      puVar8 = param_7 + 0x42;
      if ((puVar8 != (uint *)0x0) && ((&local_110 <= puVar8 || (param_7 + 0x48 <= &local_128)))) {
        *puVar8 = (uint)local_128;
        param_7[0x43] = local_128._4_4_;
        param_7[0x44] = (uint)local_120;
        param_7[0x45] = local_120._4_4_;
        *(undefined8 *)(param_7 + 0x46) = local_118;
      }
      goto LAB_18001f4cc;
    }
LAB_18001f472:
    iVar11 = *param_1;
  }
  else {
    iVar11 = *param_1;
    puVar4 = local_340;
  }
  FUN_180034a50((int *)puVar8,(longlong)puVar4,(int *)param_6,uVar2,(undefined8 *)(param_7 + 0x42),
                (longlong)puVar1,iVar11);
  param_7[10] = param_7[0x44];
  param_7[0xb] = param_7[0x45];
LAB_18001f4cc:
  *param_7 = *param_7 + param_7[0x47];
  param_7[1] = param_7[1] + param_7[0x47];
  if ((0 < (int)param_7[0x43]) && ((int)param_7[0x46] < 5)) {
    *param_7 = *param_7 + 1;
    param_7[1] = param_7[1] + 1;
  }
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xfffffffffffffc58);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18001f530(undefined4 *param_1,uint *param_2,int *param_3,int *param_4)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  undefined8 *puVar7;
  undefined8 uVar8;
  uint uVar9;
  longlong lVar10;
  longlong lVar11;
  int *piVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  uint uVar16;
  int *piVar17;
  undefined8 *puVar18;
  int *piVar19;
  undefined in_XMM0 [16];
  undefined extraout_XMM0 [16];
  undefined extraout_XMM0_00 [16];
  undefined extraout_XMM0_01 [16];
  undefined extraout_XMM0_02 [16];
  undefined extraout_XMM0_03 [16];
  int *in_stack_fffffffffffffb30;
  uint local_4b8;
  uint local_4b4;
  int local_4b0;
  int local_4ac;
  int local_4a8;
  int local_4a4;
  int *local_4a0;
  int local_498;
  int local_494;
  int local_490;
  int local_48c;
  int local_488;
  int local_484;
  int local_480 [2];
  undefined *local_478;
  undefined *local_470;
  undefined *local_468;
  undefined *local_460;
  undefined *local_458;
  undefined *local_450;
  longlong local_448;
  uint **local_440;
  int *local_438;
  longlong local_430;
  undefined4 *local_428;
  int local_420;
  undefined4 local_41c;
  undefined4 local_418;
  undefined local_408 [16];
  undefined local_3f8 [8];
  undefined8 uStack1008;
  ulonglong local_3e8;
  ulonglong local_3e0;
  undefined8 local_3d8;
  undefined8 local_3d0;
  undefined8 local_3c8;
  undefined8 local_3b8 [2];
  uint local_3a8;
  uint uStack932;
  uint uStack916;
  undefined4 local_298;
  undefined4 uStack660;
  undefined4 uStack656;
  undefined4 uStack652;
  undefined8 local_288;
  undefined8 local_278 [62];
  uint *local_88;
  undefined8 *local_80;
  int *local_78;
  uint local_70;
  uint local_6c;
  undefined local_68 [24];
  ulonglong local_50;

  local_50 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffae8;
  *param_1 = 0;
  local_484 = param_3[1];
  piVar12 = param_4 + 6;
  local_488 = param_3[2];
  local_420 = param_3[3];
  local_478 = (undefined *)0x0;
  local_470 = (undefined *)0x0;
  local_468 = (undefined *)0x0;
  local_460 = (undefined *)0x0;
  local_458 = (undefined *)0x0;
  local_450 = (undefined *)0x0;
  local_41c = 0;
  local_418 = 1;
  if (*param_3 == 9) {
    local_478 = &DAT_18007d030;
    local_470 = &DAT_18007cef0;
    local_468 = &DAT_18007d120;
    local_460 = &DAT_18007d170;
    local_458 = &DAT_18007d080;
    local_450 = &DAT_18007d1c0;
  }
  else {
    if (*param_3 == 10) {
      local_478 = &DAT_18007d2b0;
      local_470 = &DAT_18007cf90;
      local_468 = &DAT_18007d210;
      local_460 = &DAT_18007cf40;
      local_458 = &DAT_18007d0d0;
      local_450 = &DAT_18007cfe0;
    }
  }
  local_48c = *param_4;
  local_430 = (longlong)local_48c;
  local_440 = (uint **)(param_3 + 0x2344);
  local_490 = param_4[1];
  piVar19 = param_3 + 0x236c;
  local_494 = local_48c + 0xcf;
  local_4a8 = 0;
  local_480[0] = 2;
  local_448 = 0;
  local_4b4 = 0x32;
  piVar17 = param_3;
  local_4a0 = piVar12;
  local_438 = param_4;
  local_428 = param_1;
  do {
    lVar11 = local_448;
    uVar3 = local_4b4;
    puVar1 = *local_440;
    if ((*piVar19 != -1) && (puVar1[0x3c] != 0)) {
      local_408 = in_XMM0 & (undefined  [16])0x0;
      local_3e8 = (ulonglong)puVar1[0x43];
      local_3e0 = (ulonglong)puVar1[0x44];
      local_3d8 = 0;
      local_3d0 = 0;
      local_3c8 = 0;
      _local_3f8 = ZEXT816(0);
      if (param_2 != (uint *)0x0) {
        local_3e8 = CONCAT44(param_2[0x43],puVar1[0x43]);
        local_3e0 = CONCAT44(param_2[0x43],puVar1[0x44]);
      }
      local_88 = (uint *)0x0;
      lVar10 = 7;
      local_80 = (undefined8 *)0x0;
      local_78 = (int *)0x0;
      local_70 = 0;
      local_6c = (local_6c >> 0x10 & 0xff00) << 0x10;
      local_298 = 0x100;
      uStack660 = 0;
      uStack656 = 0;
      uStack652 = 0;
      local_288 = 0x100;
      puVar18 = local_278;
      do {
        puVar7 = puVar18;
        *puVar7 = 0xffffffffffffffff;
        puVar7[1] = 0xffffffffffffffff;
        puVar7[2] = 0xffffffffffffffff;
        puVar7[3] = 0xffffffffffffffff;
        puVar7[4] = 0xffffffffffffffff;
        puVar7[5] = 0xffffffffffffffff;
        puVar7[6] = 0xffffffffffffffff;
        puVar7[7] = 0xffffffffffffffff;
        lVar10 = lVar10 + -1;
        puVar18 = puVar7 + 8;
      } while (lVar10 != 0);
      puVar7[8] = 0xffffffffffffffff;
      puVar18 = local_278;
      puVar7[9] = 0xffffffffffffffff;
      puVar7[10] = 0xffffffffffffffff;
      puVar7[0xb] = 0xffffffffffffffff;
      puVar7[0xc] = 0xffffffffffffffff;
      puVar7[0xd] = 0xffffffffffffffff;
      FUN_180032d90(puVar1,(longlong)param_2,piVar17,(longlong)puVar18,piVar12,*param_3,0,0);
      piVar17 = (int *)(ulonglong)uVar3;
      uVar3 = FUN_18001a470(param_3,(longlong)param_2,uVar3,puVar18,4,4,(longlong)local_278,
                            (ulonglong *)&local_298,(undefined1 (*) [9])&local_88,
                            in_stack_fffffffffffffb30,(undefined8 *)0x0);
      local_4b8 = 0;
      in_XMM0 = extraout_XMM0;
      if ((6 < (int)uVar3) &&
         (FUN_18001daa0((longlong)puVar1,(longlong)param_2,piVar17,(longlong)local_278,&local_298,
                        (undefined1 (*) [9])&local_88,&local_4b8), in_XMM0 = extraout_XMM0_00,
         (int)uVar3 < (int)local_4b8)) {
        uVar3 = local_4b8;
      }
      uVar9 = local_4b8;
      piVar12 = local_4a0;
      if ((4 < (int)uVar3) &&
         ((local_438[0x11] == 0 ||
          (uVar8 = FUN_18001c420(&local_298,local_438[0x11]), piVar12 = local_4a0,
          in_XMM0 = extraout_XMM0_01, (int)uVar8 == 0)))) {
        local_4a4 = 0;
        local_498 = 0;
        local_4b8 = 0;
        local_4ac = 0;
        local_4b0 = 0;
        in_stack_fffffffffffffb30 = &local_4b0;
        uVar4 = FUN_18002bd60(param_2,puVar1,(ulonglong *)&local_298,&local_420,&local_4a4,
                              &local_498,(int *)&local_4b8,&local_4ac,uVar3,
                              in_stack_fffffffffffffb30);
        iVar2 = local_4b0;
        piVar17 = (int *)(ulonglong)uVar4;
        piVar12 = local_4a0;
        in_XMM0 = extraout_XMM0_02;
        if (local_494 < (int)uVar4) {
          lVar11 = 4;
          puVar18 = local_3b8;
          do {
            puVar7 = puVar18;
            *puVar7 = 0;
            puVar7[1] = 0;
            puVar7[2] = 0;
            puVar7[3] = 0;
            puVar7[4] = 0;
            puVar7[5] = 0;
            puVar7[6] = 0;
            puVar7[7] = 0;
            lVar11 = lVar11 + -1;
            puVar18 = puVar7 + 8;
          } while (lVar11 != 0);
          puVar7[8] = 0;
          puVar7[9] = 0;
          local_68._0_16_ = extraout_XMM0_02 & (undefined  [16])0x0;
          puVar7[10] = 0;
          puVar7[0xb] = 0;
          uStack932 = local_4b8;
          uStack916 = local_4b0 * 0x10000 + local_4ac;
          local_78 = &local_420;
          local_80 = (undefined8 *)&local_298;
          local_6c = 2;
          local_3a8 = uVar4;
          local_88 = param_2;
          local_70 = uVar3;
          FUN_18002cee0(puVar1,&local_88,&local_298,(longlong)local_3b8,*param_3);
          uVar4 = uStack916;
          if (local_68._0_8_ != (void *)0x0) {
            free(local_68._0_8_);
          }
          if (local_68._8_8_ != (void *)0x0) {
            free(local_68._8_8_);
          }
          iVar13 = uVar3 - local_490;
          iVar15 = 5;
          if (5 < iVar13) {
            iVar15 = iVar13;
          }
          iVar14 = uVar9 - local_490;
          iVar5 = 5;
          if (5 < iVar14) {
            iVar5 = iVar14;
          }
          uVar16 = uStack932 - local_48c;
          local_408._0_8_ = CONCAT44(iVar5,iVar15);
          uVar6 = local_3a8 - local_48c;
          uVar3 = uStack932;
          uVar9 = local_3a8;
          if (0 < local_430) {
            uVar3 = uVar16;
            uVar9 = uVar6;
          }
          local_3f8 = CONCAT44(uVar3,uVar16);
          if (iVar13 < 5) {
            uVar6 = uVar6 - 4;
            _local_3f8 = CONCAT124(stack0xfffffffffffffc0c,uVar16 - 4);
          }
          if (iVar14 < 5) {
            uVar9 = uVar9 - 4;
            local_3f8 = local_3f8 & 0xffffffff | (ulonglong)(uVar3 - 4) << 0x20;
          }
          local_408 = CONCAT412(uVar9,CONCAT48(uVar6,local_408._0_8_));
          piVar17 = (int *)local_408;
          iVar15 = (uVar4 & 0xffff) * local_488 * local_484;
          _local_3f8 = CONCAT412(iVar2,CONCAT48((int)(iVar15 + (iVar15 >> 0x1f & 0xffU)) >> 8,
                                                local_3f8));
          FUN_18001df10(*param_3,0,piVar17,local_480,(longlong *)&local_478,&local_4a4,&local_4a8);
          piVar12 = local_4a0;
          lVar11 = local_448;
          in_XMM0 = extraout_XMM0_03;
          if (local_4a8 == 1) {
            *local_428 = 0x1f5;
            goto LAB_18001fb01;
          }
        }
      }
    }
    local_448 = lVar11 + 1;
    local_4b4 = local_4b4 + 1;
    local_440 = local_440 + 1;
    piVar19 = piVar19 + 1;
    if (0x13 < local_448) {
LAB_18001fb01:
      FUN_18005f100(local_50 ^ (ulonglong)&stack0xfffffffffffffae8);
      return;
    }
  } while( true );
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18001fb30(int *param_1,uint *param_2,int *param_3,int *param_4,undefined8 *param_5)

{
  undefined (*pauVar1) [16];
  undefined4 *puVar2;
  int *piVar3;
  uint *puVar4;
  uint *puVar5;
  undefined8 *puVar6;
  int *piVar7;
  int iVar8;
  int iVar9;
  longlong lVar10;
  undefined8 *puVar11;
  undefined8 *puVar12;
  undefined8 uVar13;
  int iVar14;
  int iVar15;
  longlong lVar16;
  longlong lVar17;
  undefined *puVar18;
  int iVar19;
  int iVar20;
  int iVar21;
  longlong lVar22;
  ulonglong *puVar23;
  int iVar24;
  int iVar25;
  uint uVar26;
  undefined8 unaff_R12;
  undefined8 unaff_R14;
  uint uVar27;
  undefined extraout_XMM0 [16];
  undefined extraout_XMM0_00 [16];
  undefined extraout_XMM0_01 [16];
  undefined extraout_XMM0_02 [16];
  undefined extraout_XMM0_03 [16];
  undefined extraout_XMM0_04 [16];
  undefined auVar28 [16];
  int *piStackX8;
  int aiStackX16 [2];
  int *piStackX24;
  int aiStackX32 [2];
  int local_10f8;
  int local_10f4;
  undefined4 local_10f0;
  int local_10ec;
  int local_10e8;
  int local_10e4;
  int local_10e0;
  int local_10dc;
  int local_10d8;
  undefined4 local_10d4;
  int *local_10d0;
  undefined *local_10c8;
  undefined *local_10c0;
  undefined *local_10b8;
  undefined *local_10b0;
  undefined *local_10a8;
  undefined *local_10a0;
  int *local_1098;
  int *local_1090;
  int local_1088;
  int local_1084;
  int local_1080;
  ulonglong *local_1078;
  uint *local_1070;
  undefined4 *local_1068;
  int *local_1060;
  int local_1058;
  undefined4 local_1054;
  undefined local_1050 [24];
  undefined local_1038 [8];
  undefined4 uStack4144;
  undefined4 uStack4140;
  undefined local_1028 [4];
  undefined auStack4132 [4];
  undefined8 uStack4128;
  undefined8 local_1018;
  undefined8 local_1010;
  undefined8 local_1008;
  undefined8 local_1000;
  ulonglong local_ff8;
  undefined4 local_ff0 [2];
  int local_fe8;
  undefined4 local_fe4;
  undefined4 local_fe0;
  undefined8 local_fd8;
  int iStack4044;
  int local_fc8;
  int iStack4036;
  uint uStack4020;
  undefined4 local_fb0;
  undefined auStack3772 [8];
  undefined4 uStack3764;
  undefined4 uStack3760;
  undefined4 uStack3756;
  undefined8 local_ea8;
  undefined local_ea0 [8];
  undefined4 local_e98 [16];
  ulonglong uStack3672;
  undefined auStack3664 [3528];
  undefined8 local_88;
  undefined8 local_80;
  undefined8 local_78;
  undefined8 local_70;
  undefined8 local_68;
  undefined8 local_60;
  undefined2 local_58;
  ulonglong local_50;
  undefined8 uStack56;

  uStack56 = 0x18001fb4b;
  lVar10 = _alloca_probe();
  puVar6 = param_5;
  lVar10 = -lVar10;
  local_50 = DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffd0 + lVar10);
  local_10d0 = param_4;
  *(uint **)(&stack0x00000038 + lVar10) = param_2;
  local_1090 = param_1;
  puVar11 = param_5 + 0xca;
  param_5[200] = 0;
  *(undefined4 *)(param_5 + 0xcd) = 0;
  *(undefined4 *)(param_5 + 0xc9) = 0xffffffff;
  *(undefined4 *)((longlong)param_5 + 0x64c) = 0;
  *(undefined8 *)((longlong)param_5 + 0x684) = 0;
  if ((puVar11 != (undefined8 *)0x0) &&
     (((undefined8 *)((longlong)&DAT_18007c6e8 + 3) < puVar11 ||
      (param_5 + 0xcd < (undefined8 *)((longlong)&DAT_18007c6d4 + 1))))) {
    lVar16 = -(longlong)puVar11;
    lVar22 = 0x18;
    do {
      *(undefined *)puVar11 = ((undefined *)((longlong)&DAT_18007c6d4 + lVar16))[(longlong)puVar11];
      puVar11 = (undefined8 *)((longlong)puVar11 + 1);
      lVar22 = lVar22 + -1;
    } while (lVar22 != 0);
  }
  puVar18 = (undefined *)((longlong)param_5 + 0x66c);
  if ((puVar18 != (undefined *)0x0) &&
     (((undefined *)((longlong)&DAT_18007c6e8 + 3) < puVar18 ||
      ((longlong)param_5 + 0x684U < 0x18007c6d5)))) {
    lVar16 = -(longlong)puVar18;
    lVar22 = 0x18;
    do {
      *puVar18 = puVar18[(longlong)((longlong)&DAT_18007c6d4 + lVar16)];
      puVar18 = puVar18 + 1;
      lVar22 = lVar22 + -1;
    } while (lVar22 != 0);
  }
  lVar16 = 0x19;
  puVar11 = param_5;
  do {
    *puVar11 = 0;
    puVar11[1] = 0;
    puVar11[2] = 0;
    puVar11[3] = 0;
    puVar11[4] = 0;
    puVar11[5] = 0;
    puVar11[6] = 0;
    puVar11[7] = 0;
    lVar16 = lVar16 + -1;
    puVar11 = puVar11 + 8;
  } while (lVar16 != 0);
  iVar24 = 0;
  *(undefined4 *)((longlong)param_5 + 0x68c) = 0;
  *param_1 = 0;
  if (param_2[0x3c] == 0) goto LAB_180020526;
  iVar15 = param_4[4];
  local_10dc = param_3[1];
  local_10e0 = param_3[2];
  local_fe8 = param_3[3];
  *(undefined8 *)(&stack0x00001110 + lVar10) = unaff_R12;
  local_10c8 = (undefined *)0x0;
  local_10c0 = (undefined *)0x0;
  local_10b8 = (undefined *)0x0;
  local_10b0 = (undefined *)0x0;
  local_10a8 = (undefined *)0x0;
  local_10a0 = (undefined *)0x0;
  iVar20 = *param_3;
  *(undefined8 *)(&stack0x00001108 + lVar10) = unaff_R14;
  *(int *)((longlong)&param_5 + lVar10) = iVar15;
  local_fe4 = 0;
  local_fe0 = 1;
  if (iVar20 == 9) {
    local_10c8 = &DAT_18007d030;
    local_10c0 = &DAT_18007cef0;
    local_10b8 = &DAT_18007d120;
    local_10b0 = &DAT_18007d170;
    local_10a8 = &DAT_18007d080;
    local_10a0 = &DAT_18007d1c0;
LAB_18001fd6b:
  }
  else {
    if (iVar20 == 10) {
      local_10c8 = &DAT_18007d2b0;
      local_10c0 = &DAT_18007cf90;
      local_10b8 = &DAT_18007d210;
      local_10b0 = &DAT_18007cf40;
      local_10a8 = &DAT_18007d0d0;
      local_10a0 = &DAT_18007cfe0;
      goto LAB_18001fd6b;
    }
  }
  iVar14 = param_3[7];
  local_10e4 = *param_4;
  puVar23 = (ulonglong *)(longlong)local_10e4;
  local_10e8 = param_4[1];
  local_88 = 0;
  local_10ec = local_10e4 + 0xcf;
  *(undefined4 *)((longlong)&param_5 + lVar10 + 4) = 0;
  local_80 = 0;
  local_78 = 0;
  local_70 = 0;
  local_68 = 0;
  local_60 = 0;
  local_58 = 0;
  *(int *)((longlong)aiStackX32 + lVar10) = 0;
  *(undefined4 *)(&stack0x00000030 + lVar10) = 0;
  local_10d8 = 2;
  *(undefined4 *)(&stack0x0000004c + lVar10) = 0;
  local_10f8 = 0;
  local_10f4 = 0;
  iVar20 = iVar24;
  iVar8 = iVar24;
  if (0 < iVar14) {
    local_1098 = param_3 + 0x21fa;
    local_1078 = puVar23;
    auVar28 = extraout_XMM0;
LAB_18001fe00:
    iVar24 = *local_1098;
    lVar22 = (longlong)iVar24;
    lVar16 = *(longlong *)(param_3 + lVar22 * 2 + 10);
    if (*(int *)(lVar16 + 0xf0) == 0) goto LAB_18002038e;
    if ((param_4[0xd] == 0) && (iVar24 != param_4[0xe])) {
      *(undefined4 *)(lVar22 * 0x20 + 0x1c + (longlong)puVar6) = 0xfffffffe;
      goto LAB_18002038e;
    }
    if (((*(int *)(puVar6 + 0xd1) == 1) && (*(int *)((longlong)puVar6 + 0x644) == 1)) &&
       (*(int *)(lVar16 + 0x100) == 1)) goto LAB_18002038e;
    lVar17 = 4;
    _local_1038 = auVar28 & (undefined  [16])0x0;
    local_1018 = CONCAT44(param_2[0x43],*(undefined4 *)(lVar16 + 0x10c));
    local_1010 = CONCAT44(param_2[0x43],*(undefined4 *)(lVar16 + 0x110));
    *(undefined *)((longlong)&local_88 + lVar22) = 1;
    local_1008 = 0;
    local_1000 = 0;
    local_ff8 = 0;
    _local_1028 = ZEXT816(0);
    auStack3772._4_4_ = 0x100;
    uStack3764 = 0;
    uStack3760 = 0;
    uStack3756 = 0;
    local_ea8 = 0x100;
    puVar11 = &local_fd8;
    do {
      puVar12 = puVar11;
      *puVar12 = 0;
      puVar12[1] = 0;
      puVar12[2] = 0;
      puVar12[3] = 0;
      puVar12[4] = 0;
      puVar12[5] = 0;
      puVar12[6] = 0;
      puVar12[7] = 0;
      lVar17 = lVar17 + -1;
      puVar11 = puVar12 + 8;
    } while (lVar17 != 0);
    puVar12[8] = 0;
    puVar12[9] = 0;
    puVar12[10] = 0;
    puVar12[0xb] = 0;
    *(undefined8 **)((longlong)aiStackX32 + lVar10 + -0x20) = &local_fd8;
    *(undefined4 **)(&stack0xfffffffffffffff8 + lVar10) =
         (undefined4 *)((longlong)register0x00000020 + -0xeb8);
    *(int *)(&stack0xfffffffffffffff0 + lVar10) = iVar24;
    *(undefined8 *)((longlong)&uStack56 + lVar10) = 0x18001ff32;
    FUN_18001f030(param_3,param_2,puVar23,(longlong)param_4,
                  *(int *)(&stack0xfffffffffffffff0 + lVar10),
                  *(ulonglong **)(&stack0xfffffffffffffff8 + lVar10),
                  *(uint **)((longlong)aiStackX32 + lVar10 + -0x20));
    iVar20 = iStack4044;
    iVar15 = (int)local_fd8;
    auVar28 = extraout_XMM0_00;
    if ((int)local_fd8 < 5) {
LAB_18002032d:
      puVar2 = local_e98 + lVar22 * 0x12;
      if ((puVar2 != (undefined4 *)0x0) &&
         ((local_ff0 <= puVar2 || (auStack3664 + lVar22 * 0x48 <= local_1038)))) {
        *puVar2 = local_1038._0_4_;
        local_e98[lVar22 * 0x12 + 1] = local_1038._4_4_;
        local_e98[lVar22 * 0x12 + 2] = uStack4144;
        local_e98[lVar22 * 0x12 + 3] = uStack4140;
        local_e98[lVar22 * 0x12 + 4] = local_1028;
        local_e98[lVar22 * 0x12 + 5] = auStack4132;
        local_e98[lVar22 * 0x12 + 6] = (undefined4)uStack4128;
        local_e98[lVar22 * 0x12 + 7] = uStack4128._4_4_;
        local_e98[lVar22 * 0x12 + 8] = (undefined4)local_1018;
        local_e98[lVar22 * 0x12 + 9] = local_1018._4_4_;
        local_e98[lVar22 * 0x12 + 10] = (undefined4)local_1010;
        local_e98[lVar22 * 0x12 + 0xb] = local_1010._4_4_;
        auVar28 = ZEXT816(local_ff8);
        local_e98[lVar22 * 0x12 + 0xc] = (undefined4)local_1008;
        local_e98[lVar22 * 0x12 + 0xd] = local_1008._4_4_;
        local_e98[lVar22 * 0x12 + 0xe] = (undefined4)local_1000;
        local_e98[lVar22 * 0x12 + 0xf] = local_1000._4_4_;
        (&uStack3672)[lVar22 * 9] = local_ff8;
      }
    }
    else {
      iVar8 = param_4[0x11];
      if (iVar8 == 0) {
LAB_18001ff64:
        puVar4 = *(uint **)(param_3 + lVar22 * 2 + 10);
        puVar5 = *(uint **)(&stack0x00000038 + lVar10);
        puVar23 = (ulonglong *)((longlong)register0x00000020 + -0xeb8);
        *(int *)((longlong)aiStackX32 + lVar10) = 1;
        local_10f0 = 0;
        local_10d4 = 0;
        *(undefined4 *)(&stack0x00000040 + lVar10) = 0;
        *(undefined4 *)(&stack0x00000048 + lVar10) = 0;
        *(undefined4 *)(&stack0x00000044 + lVar10) = 0;
        *(undefined **)((longlong)&piStackX24 + lVar10) = &stack0x00000044 + lVar10;
        *(int *)((longlong)aiStackX16 + lVar10) = iVar15;
        *(undefined **)((longlong)&piStackX8 + lVar10) = &stack0x00000048 + lVar10;
        *(undefined **)((longlong)aiStackX32 + lVar10 + -0x20) = &stack0x00000040 + lVar10;
        *(undefined4 **)(&stack0xfffffffffffffff8 + lVar10) = &local_10d4;
        *(undefined4 **)(&stack0xfffffffffffffff0 + lVar10) = &local_10f0;
        *(undefined8 *)((longlong)&uStack56 + lVar10) = 0x18001ffce;
        iVar8 = FUN_18002bd60(puVar5,puVar4,puVar23,&local_fe8,
                              *(int **)(&stack0xfffffffffffffff0 + lVar10),
                              *(int **)(&stack0xfffffffffffffff8 + lVar10),
                              *(int **)((longlong)aiStackX32 + lVar10 + -0x20),
                              *(int **)((longlong)&piStackX8 + lVar10),
                              *(int *)((longlong)aiStackX16 + lVar10),
                              *(int **)((longlong)&piStackX24 + lVar10));
        auVar28 = extraout_XMM0_02;
        if (local_10ec < iVar8) {
          puVar4 = *(uint **)(param_3 + lVar22 * 2 + 10);
          local_fc8 = iVar8;
          iStack4036 = *(int *)(&stack0x00000040 + lVar10);
          uStack4020 = *(int *)(&stack0x00000044 + lVar10) * 0x10000 +
                       *(int *)(&stack0x00000048 + lVar10);
          local_1070 = *(uint **)(&stack0x00000038 + lVar10);
          local_1060 = &local_fe8;
          local_1068 = (undefined4 *)((longlong)register0x00000020 + -0xeb8);
          *(int *)(&stack0xfffffffffffffff0 + lVar10) = *param_3;
          local_1054 = 2;
          local_1050._0_16_ = extraout_XMM0_02 & (undefined  [16])0x0;
          local_1058 = iVar15;
          *(undefined8 *)((longlong)&uStack56 + lVar10) = 0x18002004b;
          FUN_18002cee0(puVar4,&local_1070,(uint *)((longlong)register0x00000020 + -0xeb8),
                        (longlong)&local_fd8,*(int *)(&stack0xfffffffffffffff0 + lVar10));
          uVar27 = uStack4020 & 0xffff;
          uVar26 = uStack4020 >> 0x10;
          if (local_1050._0_8_ != (void *)0x0) {
            *(undefined8 *)((longlong)&uStack56 + lVar10) = 0x180020069;
            free(local_1050._0_8_,*(undefined *)((longlong)&uStack56 + lVar10));
          }
          if (local_1050._8_8_ != (void *)0x0) {
            *(undefined8 *)((longlong)&uStack56 + lVar10) = 0x180020078;
            free(local_1050._8_8_,*(undefined *)((longlong)&uStack56 + lVar10));
          }
          *(undefined8 *)((longlong)&uStack56 + lVar10) = 0x180020088;
          FUN_18002c510((int *)((longlong)register0x00000020 + -0xeb8),&local_1088,
                        *(undefined *)((longlong)&uStack56 + lVar10));
          local_1000 = (ulonglong)CONCAT14(0x4f < local_1084,(uint)(0x2f < local_1088 - 0xeaU));
          iVar14 = iVar15 - local_10e8;
          local_ff8 = (ulonglong)CONCAT14(0x28f5 < local_1080,(uint)(0x147a < local_1080));
          local_1008 = CONCAT44(local_fb0,local_fd8._4_4_);
          iVar8 = 5;
          if (5 < iVar14) {
            iVar8 = iVar14;
          }
          iVar25 = iVar20 - local_10e8;
          iVar21 = 5;
          if (5 < iVar25) {
            iVar21 = iVar25;
          }
          iVar19 = iStack4036 - local_10e4;
          local_1038 = CONCAT44(iVar21,iVar8);
          iVar9 = local_fc8 - local_10e4;
          iVar8 = iStack4036;
          iVar21 = local_fc8;
          if (0 < (longlong)local_1078) {
            iVar8 = iVar19;
            iVar21 = iVar9;
          }
          _local_1028 = CONCAT44(iVar8,iVar19);
          if (iVar14 < 5) {
            iVar9 = iVar9 + -4;
            _local_1028 = CONCAT124(_auStack4132,iVar19 + -4);
          }
          if (iVar25 < 5) {
            iVar21 = iVar21 + -4;
            _local_1028 = CONCAT44(iVar8 + -4,local_1028);
          }
          _local_1038 = CONCAT412(iVar21,CONCAT48(iVar9,local_1038));
          iVar8 = *param_3;
          puVar23 = (ulonglong *)local_1038;
          _local_1028 = CONCAT412(uVar26,_local_1028);
          iVar21 = uVar27 * local_10e0 * local_10dc;
          iVar14 = *(int *)((longlong)&param_5 + lVar10);
          _local_1028 = CONCAT48((int)(iVar21 + (iVar21 >> 0x1f & 0xffU)) >> 8,_local_1028);
          _local_1028 = CONCAT412(uVar26,_local_1028);
          iVar21 = iVar20;
          if (*(int *)(&stack0x00000030 + lVar10) != iVar20 &&
              iVar20 <= *(int *)(&stack0x00000030 + lVar10)) {
            iVar21 = *(int *)(&stack0x00000030 + lVar10);
          }
          *(int *)(&stack0x00000030 + lVar10) = iVar21;
          *(undefined **)((longlong)aiStackX32 + lVar10 + -0x20) = &stack0x0000004c + lVar10;
          *(int **)(&stack0xfffffffffffffff8 + lVar10) = &local_10f8;
          *(undefined ***)(&stack0xfffffffffffffff0 + lVar10) = &local_10c8;
          *(undefined8 *)((longlong)&uStack56 + lVar10) = 0x1800201c0;
          FUN_18001df10(iVar8,iVar14,(int *)puVar23,&local_10d8,
                        *(longlong **)(&stack0xfffffffffffffff0 + lVar10),
                        *(undefined4 **)(&stack0xfffffffffffffff8 + lVar10),
                        *(undefined4 **)((longlong)aiStackX32 + lVar10 + -0x20));
          lVar16 = lVar22 * 0x20;
          auVar28 = extraout_XMM0_03;
          if (*(int *)(&stack0x0000004c + lVar10) == 1) {
            *(int *)(lVar16 + 0x1c + (longlong)puVar6) = iVar20;
            puVar18 = (undefined *)((longlong)puVar6 + lVar16 + 4);
            if ((puVar18 != (undefined *)0x0) &&
               ((local_ea0 <= puVar18 ||
                (puVar18 + 0x18 <= (undefined4 *)((longlong)register0x00000020 + -0xeb8))))) {
              lVar16 = 0x18;
              puVar23 = (ulonglong *)
                        ((longlong)((longlong)register0x00000020 + -0xeb8) - (longlong)puVar18);
              do {
                *puVar18 = puVar18[(longlong)puVar23];
                puVar18 = puVar18 + 1;
                lVar16 = lVar16 + -1;
              } while (lVar16 != 0);
            }
            piVar3 = (int *)((longlong)&param_5 + lVar10 + 4);
            *piVar3 = *piVar3 + 1;
            *(undefined *)((longlong)&local_88 + lVar22) = 2;
            *local_1090 = 0x65;
            param_3[0x233d] = param_3[0x233d] + 1;
            *(int *)(*(longlong *)(param_3 + lVar22 * 2 + 10) + 0x124) =
                 *(int *)(*(longlong *)(param_3 + lVar22 * 2 + 10) + 0x124) + 1;
            *(undefined4 *)((longlong)puVar6 + 0x684) = 1;
            if (local_10f8 == 1) {
              *(undefined4 *)(puVar6 + 0xd1) = 1;
            }
            if ((*(int *)(*(longlong *)(param_3 + lVar22 * 2 + 10) + 0x100) == 1) &&
               (*(undefined4 *)((longlong)puVar6 + 0x644) = 1, *(int *)(puVar6 + 0xcd) < iVar15)) {
              *(int *)(puVar6 + 0xcd) = iVar15;
              *(longlong *)(&stack0xfffffffffffffff8 + lVar10) = (longlong)puVar6 + 0x66c;
              *(int *)(&stack0xfffffffffffffff0 + lVar10) = param_3[0x21f6];
              puVar23 = (ulonglong *)((longlong)register0x00000020 + -0xeb8);
              *(undefined8 *)((longlong)&uStack56 + lVar10) = 0x1800202b9;
              FUN_180018ed0((longlong)(param_3 + 10),(longlong)(param_3 + 0x6e),puVar23,iVar24,
                            *(int *)(&stack0xfffffffffffffff0 + lVar10),
                            *(undefined8 **)(&stack0xfffffffffffffff8 + lVar10));
              auVar28 = extraout_XMM0_04;
            }
            if (*(int *)((longlong)puVar6 + 0x64c) < iVar15) {
              pauVar1 = (undefined (*) [16])(puVar6 + 0xca);
              *(int *)((longlong)puVar6 + 0x64c) = iVar15;
              if ((pauVar1 != (undefined (*) [16])0x0) &&
                 (((undefined (*) [16])local_ea0 <= pauVar1 ||
                  (puVar6 + 0xcd <= (undefined8 *)((longlong)register0x00000020 + -0xeb8))))) {
                auVar28 = CONCAT412(uStack3756,
                                    CONCAT48(uStack3760,CONCAT44(uStack3764,auStack3772._4_4_)));
                *pauVar1 = auVar28;
                puVar6[0xcc] = local_ea8;
              }
              *(int *)(puVar6 + 0xc9) = iVar24;
            }
            iVar15 = *(int *)((longlong)&param_5 + lVar10);
            param_4 = local_10d0;
            if (iVar15 != 0) goto LAB_18002032d;
            goto LAB_1800203af;
          }
          *(undefined4 *)(lVar16 + 0x1c + (longlong)puVar6) = 0xfffffffe;
          param_4 = local_10d0;
        }
        goto LAB_18002032d;
      }
      *(undefined8 *)((longlong)&uStack56 + lVar10) = 0x18001ff5c;
      uVar13 = FUN_18001c420((int *)((longlong)register0x00000020 + -0xeb8),iVar8,
                             *(undefined *)((longlong)&uStack56 + lVar10));
      auVar28 = extraout_XMM0_01;
      if ((int)uVar13 == 0) goto LAB_18001ff64;
    }
    param_2 = *(uint **)(&stack0x00000038 + lVar10);
LAB_18002038e:
    local_10f4 = local_10f4 + 1;
    local_1098 = local_1098 + 1;
    if (param_3[7] <= local_10f4) goto code_r0x0001800203ab;
    goto LAB_18001fe00;
  }
  goto LAB_1800203cc;
code_r0x0001800203ab:
  iVar15 = *(int *)((longlong)&param_5 + lVar10);
LAB_1800203af:
  param_2 = *(uint **)(&stack0x00000038 + lVar10);
  iVar24 = *(int *)((longlong)&param_5 + lVar10 + 4);
  iVar20 = *(int *)(&stack0x00000030 + lVar10);
  iVar8 = *(int *)((longlong)aiStackX32 + lVar10);
LAB_1800203cc:
  piVar7 = local_1090;
  piVar3 = local_10d0;
  iVar14 = 1;
  if (0 < *local_1090) {
    if (iVar15 == 1) {
      if (*(int *)(puVar6 + 0xd1) == 1) goto LAB_1800203f0;
      if (1 < iVar24) goto LAB_1800203e7;
LAB_1800203f5:
      iVar24 = *(int *)((longlong)puVar6 + 0x644);
      *(int *)((longlong)aiStackX32 + lVar10) = 0;
      if (iVar24 != 0) {
        *(int **)(&stack0xfffffffffffffff8 + lVar10) = (int *)((longlong)aiStackX32 + lVar10);
        *(undefined ***)(&stack0xfffffffffffffff0 + lVar10) = &local_10c8;
        *(undefined8 *)((longlong)&uStack56 + lVar10) = 0x18002042f;
        FUN_18001e340(param_3,(longlong)puVar6,(longlong)local_e98,(longlong)&local_88,
                      *(longlong **)(&stack0xfffffffffffffff0 + lVar10),
                      *(undefined4 **)(&stack0xfffffffffffffff8 + lVar10));
        iVar14 = *(int *)((longlong)aiStackX32 + lVar10);
        if (iVar14 == 0) {
          *(undefined8 *)((longlong)puVar6 + 0x684) = 0;
          *piVar7 = -0x68;
          goto LAB_18002045a;
        }
      }
      *piVar7 = 0x68;
    }
    else {
LAB_1800203e7:
      if (*(int *)(puVar6 + 0xd1) == 1) {
LAB_1800203f0:
        if (iVar20 < 7) goto LAB_1800203f5;
      }
    }
    *(undefined8 *)((longlong)&uStack56 + lVar10) = 0x18002045a;
    FUN_180019bb0((longlong)param_3,*(undefined *)((longlong)&uStack56 + lVar10));
  }
LAB_18002045a:
  if (*(int *)(puVar6 + 0xd1) == 1) {
    *piVar7 = 0x6f;
  }
  else {
    if (*piVar7 < 1) {
      if (*piVar7 == -0x68) {
        *piVar7 = -0x68;
      }
      else {
        if ((int)param_2[0x44] < 0x32) {
          *piVar7 = -0x65;
        }
        else {
          if ((iVar8 == 1) && ((int)param_2[0x43] < 0x19)) {
            *piVar7 = -0x66;
          }
          else {
            *piVar7 = -100;
          }
        }
      }
      if ((((0x28 < (int)param_2[0x43]) && (iVar14 == 1)) && (piVar3[0xd] == 1)) &&
         (param_3[0x2380] == 0)) {
        *(undefined8 *)((longlong)&uStack56 + lVar10) = 0x1800204e9;
        FUN_180018d40(param_2,param_3,(longlong)(param_3 + 0x2344),param_3 + 0x236c,
                      *(undefined *)((longlong)&uStack56 + lVar10));
      }
      if (((*piVar7 < 1) && (iVar14 == 1)) && ((piVar3[0xd] == 1 && (param_3[0x2380] == 1)))) {
        *(undefined8 *)((longlong)&uStack56 + lVar10) = 0x180020514;
        FUN_18001f530(piVar7,param_2,param_3,piVar3);
      }
    }
  }
LAB_180020526:
  *(undefined8 *)((longlong)&uStack56 + lVar10) = 0x180020535;
  FUN_18005f100(local_50 ^ (ulonglong)(&stack0xffffffffffffffd0 + lVar10),
                *(undefined *)((longlong)&uStack56 + lVar10));
  return;
}



undefined8 FUN_180020550(uint *param_1,uint *param_2,uint param_3,int param_4)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  undefined8 uVar4;
  uint uVar5;
  uint *puVar6;

  uVar1 = param_1[1];
  uVar2 = param_1[2];
  puVar6 = param_2;
  uVar4 = FUN_180019f20(param_3,param_2,param_2 + 1,param_2 + 2);
  if ((int)uVar4 != 0) {
    return uVar4;
  }
  puVar6[3] = 0xda;
  if (param_4 == 0) {
    uVar3 = 0;
LAB_1800205b6:
    uVar5 = 0;
  }
  else {
    uVar3 = 1;
    uVar5 = uVar3;
    if ((param_4 != 1) && (param_4 == 2)) goto LAB_1800205b6;
  }
  puVar6[4] = uVar3;
  puVar6[5] = uVar5;
  puVar6[6] = 0x17;
  puVar6[7] = 0x2f;
  puVar6[8] = 0x28;
  puVar6[9] = 0x26;
  puVar6[10] = 0xffffffff;
  puVar6[0xb] = 0x10;
  if (*param_1 == 9) {
    puVar6[10] = 0x78;
  }
  else {
    if (*param_1 != 10) goto LAB_180020613;
    puVar6[10] = 100;
  }
  puVar6[7] = 0x2d;
  puVar6[6] = 0x16;
LAB_180020613:
  puVar6[0xd] = 1;
  param_2[0xc] = (int)(uVar2 * uVar1 * 0x100) / 0x2520;
  param_2[0xf] = *param_1;
  switch(*param_1) {
  default:
    param_2[0x10] = 0;
    break;
  case 6:
  case 7:
  case 0x3f:
    param_2[0x10] = 1;
  }
  return 0;
}



void FUN_1800206e0(int *param_1,uint *param_2,uint *param_3,uint param_4,int param_5,
                  undefined8 *param_6)

{
  uint uVar1;
  undefined8 uVar2;
  uint local_88 [17];
  uint local_44;
  ulonglong local_38;

  local_38 = DAT_1800b04e8 ^ (ulonglong)&stack0xffffffffffffff48;
  uVar2 = FUN_180020550(param_3,local_88,param_4,param_5);
  local_44 = param_2[0x52];
  if ((int)uVar2 == 0) {
    uVar1 = *param_3;
    if (uVar1 - 9 < 2) {
      FUN_18001fb30(param_1,param_2,param_3,local_88);
      *(uint *)((longlong)param_6 + 0x68c) = param_4;
    }
    else {
      if ((uVar1 < 0x40) && ((0xc0000000000000cdU >> ((longlong)(int)uVar1 & 0x3fU) & 1) != 0)) {
        uVar1 = 0;
        if (param_3[7] != 0) {
          do {
            if (*(int *)(*(longlong *)(param_3 + (ulonglong)uVar1 * 2 + 10) + 0x114) == 5) {
              *(undefined4 *)(*(longlong *)(param_3 + (ulonglong)uVar1 * 2 + 10) + 0x114) = 0;
            }
            uVar1 = uVar1 + 1;
          } while (uVar1 < param_3[7]);
        }
        *(uint *)((longlong)param_6 + 0x68c) = param_4;
        FUN_18001cfc0(param_1,param_2,(int *)param_3,(int *)local_88,param_6);
      }
    }
  }
  FUN_18005f100(local_38 ^ (ulonglong)&stack0xffffffffffffff48);
  return;
}



void FUN_180020800(int *param_1,uint *param_2,uint *param_3,undefined8 param_4,undefined8 param_5,
                  int param_6,undefined4 *param_7)

{
  uint uVar1;
  int iVar2;
  int local_718;
  undefined4 local_714;
  undefined8 local_708;
  undefined4 local_700;
  undefined4 local_6fc;
  int local_6f8;
  int local_6f4;
  undefined4 local_6f0;
  undefined4 local_6ec;
  undefined4 local_6e8;
  undefined4 local_6e4;
  undefined4 local_6e0;
  undefined8 local_6b8 [210];
  ulonglong local_28;

  local_28 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffff8b8;
  uVar1 = *param_3;
  if ((uVar1 < 9) && ((0x132U >> (uVar1 & 0x1f) & 1) != 0)) goto LAB_1800209be;
  local_700 = 5;
  local_6f8 = 0;
  if (uVar1 - 9 < 2) {
    local_6fc = 0xcc;
    local_708 = 0xffffffff;
    if (param_6 == 0) {
LAB_180020922:
      local_6f4 = 0;
    }
    else {
      if ((param_6 != 1) && (param_6 == 2)) {
        local_6f8 = 1;
        goto LAB_180020922;
      }
      local_6f4 = 1;
      local_6f8 = 1;
    }
    local_6f0 = 0x17;
    local_6ec = 0x2f;
    local_6e8 = 0x28;
    local_6e4 = 0x26;
    local_6e0 = 0xffffffff;
    if (uVar1 == 9) {
      local_6e0 = 0x78;
LAB_180020972:
      local_6ec = 0x2d;
      local_6f0 = 0x16;
    }
    else {
      if (uVar1 == 10) {
        local_6e0 = 100;
        goto LAB_180020972;
      }
    }
    *param_7 = 0xffffffff;
    FUN_18001fb30(param_1,param_2,param_3,&local_708);
  }
  else {
    local_6fc = 0xda;
    local_708 = 0;
    iVar2 = local_6f8;
    if ((param_6 != 0) && ((iVar2 = param_6 + -1, iVar2 == 0 || (iVar2 != 1)))) {
      local_6f8 = 1;
      iVar2 = 1;
    }
    local_6f0 = 0x17;
    local_6ec = 0x2f;
    local_6e8 = 0x28;
    local_6e4 = 0x26;
    local_6e0 = 0xffffffff;
    *param_7 = 0xffffffff;
    local_6f4 = local_6f8;
    local_6f8 = iVar2;
    FUN_18001cfc0(param_1,param_2,(int *)param_3,(int *)&local_708,local_6b8);
  }
  FUN_180018a70(param_3,param_2,(uint *)local_6b8,&local_718);
  *param_7 = local_714;
LAB_1800209be:
  FUN_18005f100(local_28 ^ (ulonglong)&stack0xfffffffffffff8b8);
  return;
}



void FUN_1800209f0(uint *param_1,uint param_2,uint param_3,int *param_4)

{
  uint uVar1;
  bool bVar2;
  uint uVar3;
  undefined8 uVar4;
  uint *puVar5;
  uint uVar6;
  longlong lVar7;
  uint **ppuVar8;
  uint *puVar9;
  int iVar10;
  longlong lVar11;
  uint local_798;
  int local_794;
  int local_790;
  int local_78c;
  int *local_788;
  uint local_778 [5];
  int local_764;
  undefined4 local_744;
  uint local_740;
  undefined4 local_734;
  undefined8 local_728 [201];
  uint local_e0;
  int local_a0;
  uint local_98;
  undefined8 local_94;
  undefined8 local_8c;
  undefined8 local_84;
  undefined8 local_7c;
  undefined8 local_74;
  undefined8 local_6c;
  undefined8 local_64;
  undefined8 local_5c;
  undefined8 local_54;
  undefined4 local_4c;
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffff838;
  local_790 = 0;
  uVar6 = *param_1;
  iVar10 = 1;
  *param_4 = 0;
  bVar2 = 1 < uVar6 - 9;
  local_94 = 0;
  local_8c = 0;
  local_84 = 0;
  local_7c = 0;
  local_74 = 0;
  local_6c = 0;
  local_64 = 0;
  local_5c = 0;
  local_54 = 0;
  local_4c = 0;
  local_788 = param_4;
  local_98 = param_2;
  uVar4 = FUN_180020550(param_1,local_778,param_3,1);
  local_734 = 0;
  if ((int)uVar4 == 0) {
    local_744 = 0;
    local_78c = 0;
    do {
      ppuVar8 = (uint **)(param_1 + 0x2344);
      puVar9 = param_1 + 0x236c;
      uVar6 = (&local_98)[local_78c];
      local_78c = (local_78c + 1) % 0x14;
      lVar11 = 0;
      local_798 = uVar6;
      do {
        if (*puVar9 != 0xffffffff) {
          puVar5 = *ppuVar8;
          local_794 = 0;
          local_740 = uVar6;
          if (bVar2) {
            FUN_18001cfc0(&local_794,puVar5,(int *)param_1,(int *)local_778,local_728);
          }
          else {
            FUN_18001fb30();
          }
          uVar6 = local_798;
          if (local_a0 != 0) {
            if (bVar2) {
              if (local_e0 == 0xffffffff) goto LAB_180020c40;
              uVar3 = FUN_1800182f0((int *)param_1,puVar5,(uint *)local_728,&local_790,local_764,
                                    local_e0);
            }
            else {
              uVar3 = FUN_180030410((int *)param_1,puVar5,(longlong)local_728,&local_790,local_764);
            }
            uVar6 = local_798;
            if ((uVar3 < 0x80000000) || (!bVar2)) {
              lVar7 = 0x14;
              *local_788 = ((int)uVar3 >> 0x1f & 0xfffffffbU) + 5;
              puVar5 = param_1 + 0x236c;
              uVar1 = *puVar9;
              do {
                if ((int)uVar1 < (int)*puVar5) {
                  *puVar5 = *puVar5 - 1;
                }
                puVar5 = puVar5 + 1;
                lVar7 = lVar7 + -1;
              } while (lVar7 != 0);
              *puVar9 = 0xffffffff;
              if (-1 < (int)uVar3) {
                (&local_98)[iVar10] = uVar3;
                iVar10 = (iVar10 + 1) % 0x14;
                if (uVar3 == local_798) break;
              }
            }
          }
        }
LAB_180020c40:
        lVar11 = lVar11 + 1;
        ppuVar8 = ppuVar8 + 1;
        puVar9 = puVar9 + 1;
      } while (lVar11 < 0x14);
    } while (local_78c != iVar10);
  }
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xfffffffffffff838);
  return;
}



void FUN_180020ce0(int *param_1,int *param_2)

{
  ushort uVar1;
  ushort uVar2;
  uint uVar3;
  undefined *puVar4;
  longlong lVar5;
  undefined2 *puVar6;
  ushort uVar7;
  ushort *_Memory;
  ushort uVar8;
  undefined *puVar9;
  ushort uVar10;
  ulonglong uVar11;
  ushort *puVar12;
  longlong lVar13;
  undefined2 *puVar14;
  ushort *puVar15;
  ushort *puVar16;
  int iVar17;
  int iVar18;
  ushort *puVar19;
  undefined2 *puVar20;
  undefined2 *puVar21;
  ushort *local_res18;

  iVar18 = *param_1;
  lVar13 = *(longlong *)(param_1 + 6);
  puVar21 = (undefined2 *)(lVar13 + (longlong)iVar18 * 2);
  puVar14 = (undefined2 *)(*(longlong *)(param_2 + 6) + (longlong)*param_2 * 2);
  _Memory = (ushort *)malloc((longlong)(iVar18 * 2) * 2);
  uVar3 = param_1[2];
  uVar11 = (ulonglong)uVar3;
  puVar4 = *(undefined **)(param_1 + 6);
  puVar9 = *(undefined **)(param_2 + 6);
  local_res18 = _Memory + *param_1;
  if ((((puVar9 != (undefined *)0x0) && (puVar4 != (undefined *)0x0)) && (uVar3 != 0)) &&
     (((puVar4 + uVar11 <= puVar9 || (puVar9 + uVar11 <= puVar4)) && (uVar3 != 0)))) {
    lVar5 = -(longlong)puVar9;
    do {
      *puVar9 = puVar9[(longlong)(puVar4 + lVar5)];
      puVar9 = puVar9 + 1;
      uVar11 = uVar11 - 1;
    } while (uVar11 != 0);
  }
  iVar17 = 1;
  if (1 < *param_2 + -1) {
    lVar13 = lVar13 - (longlong)puVar21;
    puVar12 = puVar21 + 2;
    puVar16 = local_res18;
    do {
      puVar16 = puVar16 + 1;
      uVar7 = *(ushort *)(lVar13 + -2 + (longlong)puVar12);
      uVar1 = *(ushort *)(lVar13 + -4 + (longlong)puVar12);
      uVar8 = uVar1;
      if (uVar7 <= uVar1) {
        uVar8 = uVar7;
        uVar7 = uVar1;
      }
      uVar1 = *(ushort *)(lVar13 + (longlong)puVar12);
      if ((uVar8 <= uVar1) && (uVar8 = uVar7, uVar1 < uVar7)) {
        uVar8 = uVar1;
      }
      *(ushort *)((longlong)((longlong)_Memory - (longlong)local_res18) + (longlong)puVar16) = uVar8
      ;
      uVar7 = puVar12[-1];
      uVar1 = puVar12[-2];
      uVar8 = uVar1;
      if (uVar7 <= uVar1) {
        uVar8 = uVar7;
        uVar7 = uVar1;
      }
      uVar1 = *puVar12;
      if ((uVar8 <= uVar1) && (uVar8 = uVar7, uVar1 < uVar7)) {
        uVar8 = uVar1;
      }
      *puVar16 = uVar8;
      puVar12 = puVar12 + 1;
      iVar17 = iVar17 + 1;
    } while (iVar17 < *param_2 + -1);
  }
  iVar17 = 1;
  puVar6 = puVar21 + iVar18;
  puVar12 = _Memory;
  puVar20 = puVar21;
  if (1 < param_2[1] + -1) {
    do {
      puVar16 = puVar12;
      puVar21 = puVar6;
      puVar12 = puVar14 + 1;
      *puVar14 = *puVar20;
      lVar13 = 1;
      iVar18 = 1;
      if (1 < *param_2 + -1) {
        puVar19 = puVar21 + 2;
        puVar15 = puVar16;
        do {
          puVar15 = puVar15 + 1;
          uVar7 = puVar19[-1];
          uVar1 = puVar19[-2];
          uVar8 = *puVar15;
          uVar2 = *(ushort *)
                   ((longlong)((longlong)local_res18 - (longlong)puVar16) + (longlong)puVar15);
          uVar10 = uVar1;
          if (uVar7 <= uVar1) {
            uVar10 = uVar7;
            uVar7 = uVar1;
          }
          uVar1 = *puVar19;
          if ((uVar10 <= uVar1) && (uVar10 = uVar7, uVar1 < uVar7)) {
            uVar10 = uVar1;
          }
          *puVar15 = uVar10;
          uVar7 = uVar8;
          if (uVar2 <= uVar8) {
            uVar7 = uVar2;
            uVar2 = uVar8;
          }
          if ((uVar7 <= uVar10) && (uVar7 = uVar2, uVar10 < uVar2)) {
            uVar7 = uVar10;
          }
          *puVar12 = uVar7;
          puVar19 = puVar19 + 1;
          puVar12 = puVar12 + 1;
          iVar18 = iVar18 + 1;
          lVar13 = lVar13 + 1;
        } while (iVar18 < *param_2 + -1);
      }
      iVar17 = iVar17 + 1;
      *puVar12 = puVar20[lVar13];
      puVar14 = puVar14 + *param_2;
      puVar6 = puVar21 + *param_1;
      puVar12 = local_res18;
      puVar20 = puVar21;
      local_res18 = puVar16;
    } while (iVar17 < param_2[1] + -1);
  }
  uVar3 = param_1[2];
  uVar11 = (ulonglong)uVar3;
  if (((((puVar14 != (undefined2 *)0x0) && (puVar21 != (undefined2 *)0x0)) && (uVar3 != 0)) &&
      (((undefined2 *)(uVar11 + (longlong)puVar21) <= puVar14 ||
       ((undefined2 *)(uVar11 + (longlong)puVar14) <= puVar21)))) && (uVar3 != 0)) {
    puVar21 = (undefined2 *)((longlong)puVar21 - (longlong)puVar14);
    do {
      *(undefined *)puVar14 = *(undefined *)((longlong)puVar21 + (longlong)puVar14);
      puVar14 = (undefined2 *)((longlong)puVar14 + 1);
      uVar11 = uVar11 - 1;
    } while (uVar11 != 0);
  }
                    // WARNING: Could not recover jumptable at 0x000180020fd6. Too many branches
                    // WARNING: Treating indirect jump as call
  free(_Memory);
  return;
}



bool FUN_180020fe0(ushort *param_1,undefined8 param_2,undefined8 param_3,uint param_4,uint param_5)

{
  longlong lVar1;
  int iVar2;
  ulonglong *puVar3;
  ulonglong uVar4;
  byte bVar5;
  ushort *puVar6;
  ulonglong uVar7;
  longlong lVar8;
  longlong lVar9;
  uint uVar10;
  longlong lVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  ulonglong uVar16;
  ushort *puVar17;
  ulonglong uVar18;
  ulonglong uVar19;
  int iVar20;
  int iVar21;
  int iVar23;
  int iVar24;
  int iVar25;
  int iVar26;
  undefined in_XMM1 [16];
  undefined auVar22 [16];
  int iVar27;
  int iVar28;
  undefined in_XMM2 [16];
  undefined auVar29 [16];
  undefined in_XMM4 [16];
  ulonglong local_38;

  lVar11 = (longlong)(int)param_5;
  uVar16 = 0;
  uVar15 = 0;
  uVar13 = uVar15;
  if (0 < (int)param_4) {
    local_38 = (ulonglong)param_4;
    puVar17 = param_1;
    uVar18 = uVar16;
    uVar19 = uVar16;
    do {
      uVar14 = 0;
      uVar7 = uVar16;
      uVar13 = uVar15;
      uVar12 = uVar15;
      if (1 < lVar11) {
        lVar9 = (lVar11 - 2U >> 1) + 1;
        uVar7 = lVar9 * 2;
        puVar6 = puVar17;
        uVar4 = uVar16;
        do {
          uVar12 = (int)uVar4 + (uint)*puVar6;
          uVar4 = (ulonglong)uVar12;
          uVar13 = uVar13 + puVar6[1];
          lVar9 = lVar9 + -1;
          puVar6 = puVar6 + 2;
        } while (lVar9 != 0);
      }
      uVar10 = uVar14;
      if ((longlong)uVar7 < lVar11) {
        uVar10 = (uint)param_1[uVar18 + uVar7];
      }
      iVar2 = (int)(((int)param_5 >> 1) + uVar13 + uVar12 + uVar10) / (int)param_5;
      uVar13 = uVar14;
      iVar20 = 0;
      if (((0 < (int)param_5) && (iVar20 = 0, 7 < param_5)) && (1 < DAT_1800b04f8)) {
        in_XMM4 = in_XMM4 & (undefined  [16])0x0;
        uVar12 = param_5 & 0x80000007;
        if ((int)uVar12 < 0) {
          uVar12 = (uVar12 - 1 | 0xfffffff8) + 1;
        }
        puVar3 = (ulonglong *)(puVar17 + 4);
        uVar7 = uVar16;
        uVar4 = uVar16;
        auVar29 = in_XMM2 & (undefined  [16])0x0;
        do {
          auVar22 = pmovzxwd(in_XMM1,ZEXT816(puVar3[-1]));
          auVar22 = CONCAT412(SUB164(auVar22 >> 0x60,0) - iVar2,
                              CONCAT48(SUB164(auVar22 >> 0x40,0) - iVar2,
                                       CONCAT44(SUB164(auVar22 >> 0x20,0) - iVar2,
                                                SUB164(auVar22,0) - iVar2)));
          auVar22 = pmulld(auVar22,auVar22);
          iVar20 = SUB164(auVar22,0) + SUB164(in_XMM4,0);
          iVar23 = SUB164(auVar22 >> 0x20,0) + SUB164(in_XMM4 >> 0x20,0);
          iVar25 = SUB164(auVar22 >> 0x40,0) + SUB164(in_XMM4 >> 0x40,0);
          iVar27 = SUB164(auVar22 >> 0x60,0) + SUB164(in_XMM4 >> 0x60,0);
          in_XMM4 = CONCAT412(iVar27,CONCAT48(iVar25,CONCAT44(iVar23,iVar20)));
          uVar13 = (int)uVar4 + 8;
          uVar4 = (ulonglong)uVar13;
          uVar7 = uVar7 + 8;
          auVar22 = pmovzxwd(in_XMM4,ZEXT816(*puVar3));
          auVar22 = CONCAT412(SUB164(auVar22 >> 0x60,0) - iVar2,
                              CONCAT48(SUB164(auVar22 >> 0x40,0) - iVar2,
                                       CONCAT44(SUB164(auVar22 >> 0x20,0) - iVar2,
                                                SUB164(auVar22,0) - iVar2)));
          auVar22 = pmulld(auVar22,auVar22);
          iVar21 = SUB164(auVar22,0) + SUB164(auVar29,0);
          iVar24 = SUB164(auVar22 >> 0x20,0) + SUB164(auVar29 >> 0x20,0);
          iVar26 = SUB164(auVar22 >> 0x40,0) + SUB164(auVar29 >> 0x40,0);
          iVar28 = SUB164(auVar22 >> 0x60,0) + SUB164(auVar29 >> 0x60,0);
          in_XMM1 = CONCAT412(iVar28,CONCAT48(iVar26,CONCAT44(iVar24,iVar21)));
          puVar3 = puVar3 + 2;
          auVar29 = in_XMM1;
        } while ((longlong)uVar7 < (longlong)(int)(param_5 - uVar12));
        iVar26 = iVar26 + iVar25;
        iVar28 = iVar28 + iVar27;
        iVar20 = iVar21 + iVar20 + iVar26 + iVar24 + iVar23 + iVar28;
        in_XMM2 = ZEXT816(CONCAT44(iVar28,iVar26 + iVar28)) << 0x40;
      }
      lVar9 = (longlong)(int)uVar13;
      if (lVar9 < lVar11) {
        uVar13 = uVar15;
        if (1 < lVar11 - lVar9) {
          lVar1 = lVar9 + uVar18;
          lVar8 = ((lVar11 - lVar9) - 2U >> 1) + 1;
          lVar9 = lVar9 + lVar8 * 2;
          puVar6 = param_1 + lVar1;
          uVar7 = uVar16;
          uVar4 = uVar16;
          do {
            uVar13 = (int)uVar7 + ((uint)*puVar6 - iVar2) * ((uint)*puVar6 - iVar2);
            uVar7 = (ulonglong)uVar13;
            uVar14 = (int)uVar4 + ((uint)puVar6[1] - iVar2) * ((uint)puVar6[1] - iVar2);
            uVar4 = (ulonglong)uVar14;
            lVar8 = lVar8 + -1;
            puVar6 = puVar6 + 2;
          } while (lVar8 != 0);
        }
        if (lVar9 < lVar11) {
          iVar20 = iVar20 + ((uint)param_1[uVar18 + lVar9] - iVar2) *
                            ((uint)param_1[uVar18 + lVar9] - iVar2);
        }
        iVar20 = iVar20 + uVar14 + uVar13;
      }
      bVar5 = 0xf;
      uVar4 = (longlong)(((int)param_5 >> 1) + iVar20) / (longlong)(int)param_5 & 0xffffffff;
      uVar13 = 0x8000;
      uVar12 = (uint)uVar4;
      uVar7 = uVar16;
      if (1 < uVar12) {
        do {
          uVar12 = uVar13 + (int)uVar7 * 2 << (bVar5 & 0x1f);
          bVar5 = bVar5 - 1;
          if (uVar12 <= (uint)uVar4) {
            uVar7 = (ulonglong)((int)uVar7 + uVar13);
            uVar4 = (ulonglong)((uint)uVar4 - uVar12);
          }
          uVar13 = uVar13 >> 1;
        } while (uVar13 != 0);
        uVar12 = (uint)uVar7;
      }
      puVar17 = puVar17 + lVar11;
      uVar13 = (uint)uVar19 + 1;
      if ((int)uVar12 < 0x33) {
        uVar13 = (uint)uVar19;
      }
      uVar18 = uVar18 + lVar11;
      local_38 = local_38 - 1;
      uVar19 = (ulonglong)uVar13;
    } while (local_38 != 0);
  }
  return 4 < (int)uVar13;
}



ulonglong FUN_180021290(longlong param_1,int param_2,int param_3,int param_4,int param_5)

{
  ushort uVar1;
  short sVar2;
  int iVar3;
  int iVar4;
  ulonglong uVar5;
  int iVar6;
  ulonglong uVar7;
  uint uVar8;
  bool bVar9;

  uVar5 = 0;
  iVar6 = param_4 * param_5;
  uVar8 = 0;
  if (param_3 == 0) {
    if (0 < iVar6) {
      iVar3 = 0x1068;
      uVar7 = uVar5;
      if (param_4 != 0x3c) {
        iVar3 = 100;
        uVar7 = 0;
      }
      do {
        sVar2 = *(short *)(param_1 + uVar5 * 2);
        iVar4 = (int)sVar2;
        if (sVar2 < 1) {
          iVar4 = -iVar4;
        }
        uVar8 = (uint)uVar7 + 1;
        if (iVar4 <= iVar3) {
          uVar8 = (uint)uVar7;
        }
        uVar5 = uVar5 + 1;
        uVar7 = (ulonglong)uVar8;
      } while ((longlong)uVar5 < (longlong)iVar6);
    }
  }
  else {
    uVar7 = uVar5;
    if (0 < iVar6) {
      do {
        uVar1 = *(ushort *)(param_1 + uVar5 * 2);
        if (param_2 == 0) {
          bVar9 = 10 < uVar1;
        }
        else {
          bVar9 = uVar1 < 0xff5;
        }
        uVar8 = (uint)uVar7 + 1;
        if (!bVar9) {
          uVar8 = (uint)uVar7;
        }
        uVar5 = uVar5 + 1;
        uVar7 = (ulonglong)uVar8;
      } while ((longlong)uVar5 < (longlong)iVar6);
    }
  }
  return (ulonglong)(iVar6 * 0xcd >> 8 < (int)uVar8);
}



void FUN_180021370(undefined8 param_1,undefined2 *param_2,int param_3,int param_4)

{
  longlong lVar1;

  if (0 < param_3 * param_4) {
    lVar1 = (longlong)(param_3 * param_4);
    while (lVar1 != 0) {
      lVar1 = lVar1 + -1;
      *param_2 = 0x2000;
      param_2 = param_2 + 1;
    }
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8
FUN_1800213a0(longlong param_1,undefined8 param_2,int param_3,int param_4,undefined8 param_5,
             uint param_6,uint param_7,int param_8)

{
  longlong lVar1;
  short sVar2;
  ulonglong uVar3;
  undefined8 uVar4;
  ulonglong uVar5;
  uint uVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  longlong lVar9;
  int iVar10;

  uVar8 = 0;
  iVar10 = param_6 * param_7;
  uVar6 = 0;
  lVar9 = (longlong)iVar10;
  uVar3 = uVar8;
  uVar7 = uVar8;
  if (0 < iVar10) {
    do {
      uVar5 = uVar3 + 1;
      uVar6 = (int)uVar7 + (uint)*(ushort *)(param_1 + uVar3 * 2);
      uVar3 = uVar5;
      uVar7 = (ulonglong)uVar6;
    } while ((longlong)uVar5 < lVar9);
  }
  lVar1 = (longlong)(int)((iVar10 >> 1) + uVar6);
  uVar3 = lVar1 / (longlong)iVar10 & 0xffffffff;
  _DAT_1800e9700 = (undefined4)uVar3;
  if ((param_8 - 0x3eU < 2) &&
     (iVar10 = FUN_180020fe0(param_1,lVar1 % (longlong)iVar10 & 0xffffffff,param_7,param_6,param_7),
     iVar10 != 0)) {
    uVar4 = 0;
  }
  else {
    if (0 < lVar9) {
      do {
        sVar2 = *(short *)(param_1 + uVar8 * 2);
        if ((param_4 != 0) && (sVar2 = sVar2 - (short)uVar3, param_3 != 0)) {
          sVar2 = sVar2 + 0xfff;
        }
        *(short *)((longlong)&DAT_1800bb9d4 + uVar8 * 2) = sVar2;
        uVar8 = uVar8 + 1;
      } while ((longlong)uVar8 < lVar9);
    }
    uVar4 = 1;
  }
  return uVar4;
}



void FUN_1800214a0(ushort *param_1,int *param_2,longlong param_3,int *param_4,longlong param_5,
                  int param_6,int param_7,ushort *param_8,longlong param_9)

{
  longlong lVar1;
  ulonglong uVar2;
  ushort uVar3;
  uint uVar4;
  int iVar5;
  ulonglong uVar6;
  uint uVar7;
  longlong lVar8;
  ulonglong uVar9;
  uint uVar10;
  ushort *puVar11;
  longlong lVar12;
  ulonglong uVar13;
  longlong lVar14;
  longlong lVar15;
  ulonglong *local_res20;

  lVar1 = *(longlong *)(param_2 + 6);
  uVar4 = param_6 * param_7;
  local_res20 = (ulonglong *)malloc((longlong)(int)(uVar4 * 2) + 0x20);
  uVar9 = 0;
  if (local_res20 == (ulonglong *)0x0) {
    local_res20 = (ulonglong *)0x0;
  }
  else {
    *(uint *)((longlong)local_res20 + 0xc) = uVar4 * 2;
    *(int *)local_res20 = param_7;
    *(int *)((longlong)local_res20 + 4) = param_6;
    *(undefined4 *)(local_res20 + 2) = 2;
    *(int *)(local_res20 + 1) = param_7 * 2;
    local_res20[3] = (ulonglong)(local_res20 + 4);
  }
  lVar8 = (longlong)(int)uVar4;
  uVar7 = 0;
  uVar2 = local_res20[3];
  if (0 < lVar8) {
    uVar6 = uVar9;
    puVar11 = param_1;
    uVar13 = uVar9;
    do {
      uVar3 = *(ushort *)((param_3 - (longlong)param_1) + (longlong)puVar11);
      if (uVar3 == 0) {
        uVar7 = (uint)*puVar11 << 0xd;
      }
      else {
        uVar7 = ((uint)*puVar11 * 0x2000 + (uint)(uVar3 >> 1)) / (uint)uVar3;
      }
      *(uint *)(param_9 + uVar13 * 4) = uVar7;
      uVar7 = (int)uVar6 + uVar7;
      uVar6 = (ulonglong)uVar7;
      uVar13 = uVar13 + 1;
      puVar11 = puVar11 + 1;
    } while ((longlong)uVar13 < lVar8);
  }
  if (param_5 == 0) {
    uVar6 = uVar9;
    if (0 < lVar8) {
      do {
        *(undefined2 *)(uVar2 + uVar6 * 2) = *(undefined2 *)(param_9 + uVar6 * 4);
        uVar6 = uVar6 + 1;
      } while ((longlong)uVar6 < lVar8);
    }
  }
  else {
    if (0 < lVar8) {
      lVar14 = param_5 - (longlong)param_1;
      lVar15 = uVar2 - (longlong)param_1;
      lVar12 = lVar8;
      do {
        puVar11 = (ushort *)(lVar14 + (longlong)param_1);
        uVar6 = (ulonglong)*param_1 << 0xd;
        uVar10 = (uint)*(ushort *)((longlong)puVar11 + (param_3 - param_5)) * (uint)*puVar11 +
                 0x1000;
        if (uVar10 >> 0xd != 0) {
          uVar6 = (ulonglong)((int)uVar6 + (uVar10 >> 0xe)) / (ulonglong)(uVar10 >> 0xd);
        }
        *(short *)(lVar15 + (longlong)param_1) = (short)uVar6;
        param_1 = param_1 + 1;
        lVar12 = lVar12 + -1;
      } while (lVar12 != 0);
    }
  }
  uVar6 = (ulonglong)(((int)uVar4 >> 1) + uVar7) / (ulonglong)uVar4;
  if ((int)uVar6 == 0) {
    uVar6 = (ulonglong)DAT_1800b055c;
  }
  iVar5 = DAT_1800b055c * 0x2000;
  FUN_1800395b0(local_res20,param_2,0xffffffffffffffff,9,-1,-1);
  if (0 < lVar8) {
    lVar12 = uVar2 - (longlong)param_8;
    do {
      *(int *)(param_9 + uVar9 * 4) =
           (int)((longlong)
                 ((ulonglong)*(uint *)(param_9 + uVar9 * 4) *
                  ((uint)(iVar5 + (int)(uVar6 >> 1)) / uVar6) + 0x1000) >> 0xd);
      puVar11 = (ushort *)(lVar12 + (longlong)param_8);
      uVar3 = *(ushort *)((longlong)puVar11 + (lVar1 - uVar2));
      if (uVar3 == 0) {
        uVar3 = 0x2000;
      }
      else {
        uVar3 = (ushort)((ulonglong)((uint)*puVar11 * 0x2000 + (uint)(uVar3 >> 1)) /
                        (ulonglong)uVar3);
      }
      uVar4 = (int)(uVar3 - 0x2000) >> 0x1f;
      if ((int)((uVar3 - 0x2000 ^ uVar4) - uVar4) < 0x148) {
        uVar4 = *param_4 + 1;
        *param_8 = (ushort)((((int)uVar4 >> 1) + (uint)*param_8 * *param_4 + (uint)uVar3) / uVar4);
      }
      uVar9 = uVar9 + 1;
      param_8 = param_8 + 1;
    } while ((longlong)uVar9 < lVar8);
  }
  *param_4 = *param_4 + 1;
  iVar5 = *param_4;
  if (0x1e < iVar5) {
    iVar5 = 0x1e;
  }
  *param_4 = iVar5;
                    // WARNING: Could not recover jumptable at 0x0001800217b0. Too many branches
                    // WARNING: Treating indirect jump as call
  free(local_res20);
  return;
}



void FUN_1800217c0(longlong param_1,longlong param_2,undefined8 param_3,undefined2 *param_4,
                  int *param_5)

{
  int iVar1;
  int iVar2;
  int iVar3;
  ulonglong uVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  int *piVar8;
  undefined2 *puVar9;
  uint uVar10;
  ulonglong uVar11;
  int *_Memory;
  int *piVar12;
  int *piVar13;
  longlong lVar14;
  int iVar15;
  int local_48;
  int local_44;
  int local_40;
  uint local_3c;
  undefined4 local_38;
  undefined2 *local_30;

  iVar6 = DAT_1800b055c;
  iVar5 = DAT_1800b0558;
  _Memory = (int *)0x0;
  uVar7 = 0;
  iVar1 = *param_5;
  iVar2 = param_5[1];
  iVar15 = iVar1 * iVar2;
  lVar14 = (longlong)iVar15;
  piVar8 = _Memory;
  piVar12 = _Memory;
  if (0 < iVar15) {
    do {
      iVar3 = *(int *)(param_2 + (longlong)piVar12 * 4);
      uVar7 = iVar3 - iVar6;
      uVar10 = (int)uVar7 >> 0x1f;
      if ((int)((uVar7 ^ uVar10) - uVar10) < iVar5) {
        *(short *)(param_1 + (longlong)piVar12 * 2) =
             (short)(((DAT_1800b20b0 + 1 >> 1) +
                     *(ushort *)(param_1 + (longlong)piVar12 * 2) * DAT_1800b20b0 + iVar3) /
                    (DAT_1800b20b0 + 1));
      }
      piVar13 = (int *)((longlong)piVar12 + 1);
      uVar7 = (int)piVar8 + (uint)*(ushort *)(param_1 + (longlong)piVar12 * 2);
      piVar8 = (int *)(ulonglong)uVar7;
      piVar12 = piVar13;
    } while ((longlong)piVar13 < lVar14);
  }
  DAT_1800b20b0 = DAT_1800b20b0 + 1;
  iVar5 = (int)((iVar15 >> 1) + uVar7) / iVar15;
  if (400 < DAT_1800b20b0) {
    DAT_1800b20b0 = 400;
  }
  if ((DAT_1800b0554 < DAT_1800b20b0) && (iVar5 != 0)) {
    if (0 < iVar15) {
      puVar9 = param_4;
      do {
        *puVar9 = (short)((int)((uint)*(ushort *)((param_1 - (longlong)param_4) + (longlong)puVar9)
                                * 0x2000 + (iVar5 >> 1)) / iVar5);
        lVar14 = lVar14 + -1;
        puVar9 = puVar9 + 1;
      } while (lVar14 != 0);
    }
    if (DAT_1800b20b0 < 0xc9) {
      iVar5 = (int)(0x320000 / (ulonglong)DAT_1800b20b0);
      uVar7 = iVar15 * 2;
      local_38 = 2;
      local_48 = iVar1;
      local_44 = iVar2;
      local_40 = iVar1 * 2;
      local_3c = uVar7;
      local_30 = param_4;
      piVar8 = (int *)malloc((longlong)(int)uVar7 + 0x20);
      if (piVar8 != (int *)0x0) {
        piVar8[3] = uVar7;
        *piVar8 = iVar1;
        piVar8[1] = iVar2;
        *(int **)(piVar8 + 6) = piVar8 + 8;
        piVar8[4] = 2;
        piVar8[2] = iVar1 * 2;
        _Memory = piVar8;
      }
      FUN_1800395b0((ulonglong *)&local_48,_Memory,0x500000005,-1,iVar5,iVar5);
      uVar4 = *(ulonglong *)(_Memory + 6);
      if ((((param_4 != (undefined2 *)0x0) && (uVar4 != 0)) && (uVar7 != 0)) &&
         (((uVar11 = (ulonglong)uVar7, (undefined2 *)(uVar7 + uVar4) <= param_4 ||
           ((ulonglong)uVar7 + (longlong)param_4 <= uVar4)) && (uVar7 != 0)))) {
        lVar14 = uVar4 - (longlong)param_4;
        do {
          *(undefined *)param_4 = *(undefined *)(lVar14 + (longlong)param_4);
          param_4 = (undefined2 *)((longlong)param_4 + 1);
          uVar11 = uVar11 - 1;
        } while (uVar11 != 0);
      }
      free(_Memory);
    }
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180021a20(int param_1,uint param_2,undefined param_3,undefined param_4,undefined param_5,
                  undefined param_6,undefined param_7,undefined param_8,undefined2 *param_9)

{
  int iVar1;
  uint uVar2;
  undefined2 *puVar3;
  longlong lVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  ulonglong uVar7;
  longlong lVar8;
  uint uVar9;
  ulonglong uVar10;
  uint uVar11;
  uint uVar12;

  uVar6 = 0;
  lVar8 = (longlong)(int)param_2;
  uVar12 = 0;
  uVar9 = DAT_1800b0554;
  if (_DAT_1800d854c == 0) {
    if (param_1 == 0) {
      DAT_1800b055c = 8000;
      uVar9 = 10;
      DAT_1800b0558 = 0x1900;
    }
    else {
      DAT_1800b055c = 2000;
      uVar9 = 0x1e;
      DAT_1800b0558 = 0x640;
    }
    uVar11 = uVar12;
    DAT_1800b0554 = uVar9;
    if ((0 < (int)param_2) && (7 < param_2)) {
      lVar4 = (longlong)(int)(param_2 - 1);
      if (((((undefined *)((longlong)&DAT_1800fd420 + lVar4 * 2) < &DAT_1800ea1e0) ||
           ((undefined *)((longlong)&DAT_1800ea1e0 + lVar4 * 2) < &DAT_1800fd420)) &&
          (((undefined *)((longlong)&DAT_1800f3b00 + lVar4 * 2) < &DAT_1800ea1e0 ||
           ((undefined *)((longlong)&DAT_1800ea1e0 + lVar4 * 2) < &DAT_1800f3b00)))) &&
         (((undefined *)((longlong)&DAT_1800f3b00 + lVar4 * 2) < &DAT_1800fd420 ||
          ((undefined *)((longlong)&DAT_1800fd420 + lVar4 * 2) < &DAT_1800f3b00)))) {
        uVar2 = param_2 & 0x80000007;
        if ((int)uVar2 < 0) {
          uVar2 = (uVar2 - 1 | 0xfffffff8) + 1;
        }
        uVar5 = uVar6;
        do {
          uVar11 = (int)uVar5 + 8;
          uVar5 = (ulonglong)uVar11;
        } while ((int)uVar11 < (int)(param_2 - uVar2));
        iVar1 = (param_2 - uVar2) + 7;
        uVar7 = (longlong)((int)(iVar1 + (iVar1 >> 0x1f & 7U)) >> 3) << 4;
        uVar5 = uVar7 >> 1;
        puVar3 = &DAT_1800f3b00;
        while (uVar5 != 0) {
          uVar5 = uVar5 - 1;
          *puVar3 = 0x2000;
          puVar3 = puVar3 + 1;
        }
        uVar5 = uVar7 >> 1;
        puVar3 = &DAT_1800fd420;
        while (uVar5 != 0) {
          uVar5 = uVar5 - 1;
          *puVar3 = 0x2000;
          puVar3 = puVar3 + 1;
        }
        uVar7 = uVar7 >> 1;
        puVar3 = &DAT_1800ea1e0;
        while (uVar7 != 0) {
          uVar7 = uVar7 - 1;
          *puVar3 = 0x2000;
          puVar3 = puVar3 + 1;
        }
      }
    }
    lVar4 = (longlong)(int)uVar11;
    if (lVar4 < lVar8) {
      uVar7 = lVar8 - lVar4;
      uVar5 = uVar7 & 0x7fffffffffffffff;
      puVar3 = (undefined2 *)((longlong)&DAT_1800ea1e0 + lVar4 * 2);
      while (uVar5 != 0) {
        uVar5 = uVar5 - 1;
        *puVar3 = 0x2000;
        puVar3 = puVar3 + 1;
      }
      uVar5 = uVar7 & 0x7fffffffffffffff;
      puVar3 = (undefined2 *)((longlong)&DAT_1800fd420 + lVar4 * 2);
      while (uVar5 != 0) {
        uVar5 = uVar5 - 1;
        *puVar3 = 0x2000;
        puVar3 = puVar3 + 1;
      }
      uVar7 = uVar7 & 0x7fffffffffffffff;
      puVar3 = (undefined2 *)((longlong)&DAT_1800f3b00 + lVar4 * 2);
      while (uVar7 != 0) {
        uVar7 = uVar7 - 1;
        *puVar3 = 0x2000;
        puVar3 = puVar3 + 1;
      }
    }
  }
  if (DAT_1800b20b0 == 0) {
    if ((0 < (int)param_2) && (7 < param_2)) {
      lVar4 = (longlong)(int)(param_2 - 1);
      puVar3 = param_9 + lVar4;
      if (((puVar3 < &DAT_1800ea1e0) ||
          ((undefined2 *)((longlong)&DAT_1800ea1e0 + lVar4 * 2) < param_9)) &&
         (((puVar3 < &DAT_1800fd420 ||
           ((undefined2 *)((longlong)&DAT_1800fd420 + lVar4 * 2) < param_9)) &&
          (((undefined2 *)((longlong)&DAT_1800f3b00 + lVar4 * 2) < param_9 ||
           (puVar3 < &DAT_1800f3b00)))))) {
        uVar9 = param_2 & 0x80000007;
        if ((int)uVar9 < 0) {
          uVar9 = (uVar9 - 1 | 0xfffffff8) + 1;
        }
        do {
          uVar12 = (int)uVar6 + 8;
          uVar6 = (ulonglong)uVar12;
        } while ((int)uVar12 < (int)(param_2 - uVar9));
        iVar1 = (param_2 - uVar9) + 7;
        uVar5 = (longlong)((int)(iVar1 + (iVar1 >> 0x1f & 7U)) >> 3) << 4;
        uVar6 = uVar5 >> 1;
        puVar3 = &DAT_1800f3b00;
        while (uVar6 != 0) {
          uVar6 = uVar6 - 1;
          *puVar3 = 0x2000;
          puVar3 = puVar3 + 1;
        }
        uVar6 = uVar5 >> 1;
        puVar3 = param_9;
        while (uVar6 != 0) {
          uVar6 = uVar6 - 1;
          *puVar3 = 0;
          puVar3 = puVar3 + 1;
        }
        uVar6 = uVar5 >> 1;
        puVar3 = &DAT_1800fd420;
        while (uVar6 != 0) {
          uVar6 = uVar6 - 1;
          *puVar3 = 0x2000;
          puVar3 = puVar3 + 1;
        }
        uVar5 = uVar5 >> 1;
        puVar3 = &DAT_1800ea1e0;
        while (uVar5 != 0) {
          uVar5 = uVar5 - 1;
          *puVar3 = 0x2000;
          puVar3 = puVar3 + 1;
        }
      }
    }
    lVar4 = (longlong)(int)uVar12;
    if (lVar4 < lVar8) {
      puVar3 = param_9 + lVar4;
      do {
        *(undefined2 *)
         ((undefined *)((longlong)&DAT_1800f3b00 + -(longlong)param_9) + (longlong)puVar3) = 0x2000;
        lVar4 = lVar4 + 1;
        *puVar3 = 0;
        *(undefined2 *)
         ((undefined *)((longlong)&DAT_1800fd420 + -(longlong)param_9) + (longlong)puVar3) = 0x2000;
        *(undefined2 *)((longlong)puVar3 + (longlong)((longlong)&DAT_1800ea1e0 - (longlong)param_9))
             = 0x2000;
        puVar3 = puVar3 + 1;
      } while (lVar4 < lVar8);
    }
    DAT_1800e96f8 = 0;
  }
  else {
    if (uVar9 < DAT_1800b20b0) {
      if (_DAT_1800d854c != 0) {
        return;
      }
      uVar5 = uVar6;
      uVar7 = uVar6;
      uVar10 = uVar6;
      uVar9 = uVar12;
      uVar11 = uVar12;
      if (1 < lVar8) {
        do {
          uVar11 = (int)uVar7 + (uint)(ushort)param_9[uVar5];
          uVar7 = (ulonglong)uVar11;
          uVar9 = (int)uVar10 + (uint)(ushort)param_9[uVar5 + 1];
          uVar10 = (ulonglong)uVar9;
          uVar5 = uVar5 + 2;
        } while ((longlong)uVar5 < lVar8 + -1);
      }
      if ((longlong)uVar5 < lVar8) {
        uVar12 = (uint)(ushort)param_9[uVar5];
      }
      iVar1 = (int)(((int)param_2 >> 1) + uVar9 + uVar11 + uVar12) / (int)param_2;
      if (iVar1 == 0) {
        DAT_1800b20b0 = 0;
      }
      else {
        if (0 < (int)param_2) {
          do {
            *(short *)((longlong)&DAT_1800f3b00 + uVar6 * 2) =
                 (short)((int)((uint)(ushort)param_9[uVar6] * 0x2000 + (iVar1 >> 1)) / iVar1);
            uVar6 = uVar6 + 1;
          } while ((longlong)uVar6 < lVar8);
        }
      }
    }
    else {
      if (0 < (int)param_2) {
        puVar3 = &DAT_1800f3b00;
        while (lVar8 != 0) {
          lVar8 = lVar8 + -1;
          *puVar3 = 0x2000;
          puVar3 = puVar3 + 1;
        }
      }
      if (_DAT_1800d854c != 0) {
        return;
      }
    }
  }
  _DAT_1800d854c = 1;
  return;
}



void FUN_180022240(undefined8 *param_1)

{
  ulonglong *puVar1;
  undefined8 *puVar2;
  undefined8 *puVar3;
  ushort uVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  undefined8 *puVar8;
  ushort *puVar9;
  ushort *puVar10;
  ushort uVar11;
  short sVar12;
  uint uVar13;
  int iVar14;
  undefined8 *puVar15;
  int *piVar16;
  void *pvVar17;
  undefined8 *puVar18;
  int iVar19;
  int iVar20;
  ulonglong uVar21;
  ulonglong *puVar22;
  uint uVar23;
  longlong lVar24;
  int *piVar26;
  uint uVar27;
  int *piVar28;
  int *piVar29;
  int iVar30;
  undefined8 *puVar31;
  longlong lVar32;
  longlong lVar33;
  undefined8 *puVar34;
  ulonglong uVar35;
  int *piVar36;
  undefined8 *puVar37;
  ulonglong uVar38;
  undefined8 *puVar39;
  bool bVar40;
  undefined auVar41 [16];
  undefined in_XMM1 [16];
  undefined auVar42 [16];
  undefined8 uVar43;
  undefined in_XMM2 [16];
  undefined auVar44 [16];
  undefined in_XMM3 [16];
  undefined auVar45 [16];
  undefined auVar46 [16];
  ushort **in_stack_00000028;
  int *in_stack_00000030;
  undefined8 local_80;
  int *local_78;
  undefined8 *local_70;
  ulonglong local_68;
  longlong local_58;
  undefined8 *local_50;
  undefined8 *local_48;
  void *local_40;
  int *piVar25;

  piVar25 = (int *)0x0;
  iVar20 = 0;
  piVar28 = (int *)0x0;
  iVar5 = in_stack_00000030[1];
  uVar6 = in_stack_00000030[2];
  lVar32 = (longlong)(int)uVar6;
  iVar7 = *in_stack_00000030;
  iVar19 = in_stack_00000030[3];
  puVar34 = (undefined8 *)in_stack_00000028[1];
  puVar8 = (undefined8 *)in_stack_00000028[2];
  local_48 = (undefined8 *)in_stack_00000028[6];
  puVar15 = (undefined8 *)in_stack_00000028[5];
  puVar39 = (undefined8 *)*in_stack_00000028;
  puVar9 = in_stack_00000028[4];
  puVar10 = in_stack_00000028[3];
  if (0 < (int)uVar6) {
    puVar31 = param_1;
    lVar24 = lVar32;
    do {
      uVar11 = *(short *)((longlong)((longlong)puVar10 - (longlong)param_1) + (longlong)puVar31) -
               *(ushort *)puVar31;
      if ((short)uVar11 < 1) {
        uVar11 = 0;
      }
      *(ushort *)puVar31 = uVar11;
      lVar24 = lVar24 + -1;
      puVar31 = (undefined8 *)((longlong)puVar31 + 2);
    } while (lVar24 != 0);
  }
  iVar30 = iVar7 * iVar5;
  if (0 < iVar30) {
    lVar24 = (longlong)iVar30;
    puVar31 = puVar39;
    while (lVar24 != 0) {
      lVar24 = lVar24 + -1;
      *(ushort *)puVar31 = 0x2000;
      puVar31 = (undefined8 *)((longlong)puVar31 + 2);
    }
  }
  uVar13 = 0;
  local_40 = (void *)0x0;
  puVar31 = (undefined8 *)(longlong)iVar30;
  if (in_stack_00000030[4] == 0) {
    if (0 < (longlong)puVar31) {
      iVar19 = 0x1068;
      piVar36 = piVar25;
      piVar29 = piVar25;
      if (iVar5 != 0x3c) {
        iVar19 = 100;
      }
      do {
        uVar11 = *(ushort *)((longlong)param_1 + (longlong)piVar29 * 2);
        iVar14 = (int)(short)uVar11;
        if ((short)uVar11 < 1) {
          iVar14 = -iVar14;
        }
        uVar13 = (uint)piVar36 + 1;
        if (iVar14 <= iVar19) {
          uVar13 = (uint)piVar36;
        }
        piVar29 = (int *)((longlong)piVar29 + 1);
        piVar36 = (int *)(ulonglong)uVar13;
      } while ((longlong)piVar29 < (longlong)puVar31);
    }
  }
  else {
    if (0 < (longlong)puVar31) {
      local_80 = CONCAT44(local_80._4_4_,0xff5);
      piVar36 = piVar25;
      piVar29 = piVar25;
      do {
        uVar11 = *(ushort *)((longlong)param_1 + (longlong)piVar29 * 2);
        if (iVar19 == 0) {
          bVar40 = 10 < uVar11;
        }
        else {
          bVar40 = uVar11 < 0xff5;
        }
        uVar13 = (uint)piVar36 + 1;
        if (!bVar40) {
          uVar13 = (uint)piVar36;
        }
        piVar29 = (int *)((longlong)piVar29 + 1);
        piVar36 = (int *)(ulonglong)uVar13;
      } while ((longlong)piVar29 < (longlong)puVar31);
    }
  }
  uVar23 = 0;
  uVar27 = uVar23;
  if (in_stack_00000030[7] != 2) {
    uVar27 = (uint)(iVar30 * 0xcd >> 8 < (int)uVar13);
  }
  local_70 = puVar15;
  local_50 = puVar34;
  if (uVar27 == 0) goto LAB_1800226ce;
  iVar19 = iVar30 * 2;
  local_78 = (int *)malloc((longlong)iVar19 + 0x20);
  if (local_78 == (int *)0x0) {
    local_78 = (int *)0x0;
  }
  else {
    local_78[3] = iVar19;
    *local_78 = iVar7;
    local_78[1] = iVar5;
    local_78[2] = iVar7 * 2;
    *(int **)(local_78 + 6) = local_78 + 8;
    local_78[4] = 2;
  }
  local_68 = *(ulonglong *)(local_78 + 6);
  piVar29 = (int *)malloc((longlong)iVar19 + 0x20);
  piVar36 = piVar25;
  if (piVar29 != (int *)0x0) {
    piVar29[3] = iVar19;
    *piVar29 = iVar7;
    piVar29[1] = iVar5;
    piVar29[2] = iVar7 * 2;
    *(int **)(piVar29 + 6) = piVar29 + 8;
    piVar29[4] = 2;
    piVar36 = piVar29;
  }
  lVar24 = (longlong)iVar30;
  uVar21 = *(ulonglong *)(piVar36 + 6);
  if (0 < lVar24) {
    puVar31 = param_1;
    lVar33 = lVar24;
    do {
      uVar11 = *(ushort *)((longlong)((longlong)puVar39 - (longlong)param_1) + (longlong)puVar31);
      if (uVar11 == 0) {
        sVar12 = *(ushort *)puVar31 << 0xd;
      }
      else {
        sVar12 = (short)((ulonglong)((uint)(uVar11 >> 1) + (uint)*(ushort *)puVar31 * 0x2000) /
                        (ulonglong)uVar11);
      }
      *(short *)((uVar21 - (longlong)param_1) + (longlong)puVar31) = sVar12;
      puVar31 = (undefined8 *)((longlong)puVar31 + 2);
      lVar33 = lVar33 + -1;
    } while (lVar33 != 0);
  }
  local_80 = uVar21;
  FUN_180020ce0(piVar36,local_78);
  if (0 < lVar24) {
    local_80 = uVar21 - local_68;
    puVar34 = puVar39;
    do {
      uVar11 = *(ushort *)((longlong)puVar34 + (local_68 - (longlong)puVar39));
      puVar31 = (undefined8 *)(ulonglong)uVar11;
      uVar4 = *(ushort *)((longlong)puVar34 + local_80 + (local_68 - (longlong)puVar39));
      iVar19 = (uint)uVar4 - (uint)uVar11;
      if (iVar19 < 1) {
        iVar19 = (uint)uVar11 - (uint)uVar4;
      }
      if (((600 < iVar19) && (uVar4 != 0)) && (uVar11 != 0)) {
        *(ushort *)puVar34 =
             (ushort)((ulonglong)((uint)(uVar11 >> 1) + (uint)*(ushort *)puVar34 * (uint)uVar4) /
                     (ulonglong)uVar11);
      }
      puVar34 = (undefined8 *)((longlong)puVar34 + 2);
      lVar24 = lVar24 + -1;
      puVar15 = local_70;
    } while (lVar24 != 0);
  }
  free(piVar36);
  iVar19 = iVar7 / 2;
  uVar38 = SEXT48(iVar19);
  uVar13 = iVar5 / 2;
  uVar21 = local_80 & 0xffffffff00000000;
  local_80 = uVar21 | uVar13;
  if (DAT_1800e96f8 == 0) {
LAB_1800228a5:
    uVar35 = (ulonglong)uVar13;
    if (0 < (int)uVar13) {
      puVar34 = param_1;
      piVar36 = piVar25;
      do {
        piVar29 = piVar25;
        piVar26 = piVar36;
        if (0 < iVar19) {
          do {
            piVar16 = (int *)((longlong)piVar29 + 1);
            *(ushort *)((longlong)puVar9 + (longlong)piVar26) =
                 *(ushort *)((longlong)puVar34 + (longlong)piVar29 * 4);
            piVar29 = piVar16;
            piVar26 = (int *)((longlong)piVar26 + 2);
          } while ((longlong)piVar16 < (longlong)uVar38);
        }
        puVar34 = (undefined8 *)((longlong)puVar34 + (longlong)(iVar7 * 2) * 2);
        piVar36 = (int *)((longlong)piVar36 + uVar38 * 2);
        uVar35 = uVar35 - 1;
      } while (uVar35 != 0);
    }
    DAT_1800e96fc = 0;
LAB_180022907:
    local_80 = uVar21 | DAT_1800e96f8;
    local_40 = malloc((longlong)iVar30 << 2);
    puVar34 = local_50;
    piVar36 = local_78;
    FUN_1800214a0((ushort *)param_1,local_78,(longlong)puVar39,(int *)&DAT_1800e96f8,
                  (longlong)puVar8,iVar5,iVar7,(ushort *)local_50,(longlong)local_40);
    pvVar17 = malloc(lVar32 * 4);
    puVar31 = puVar39;
    FUN_1800214a0((ushort *)param_1,piVar36,(longlong)puVar39,(int *)&local_80,0,iVar5,iVar7,
                  (ushort *)local_48,(longlong)pvVar17);
    free(pvVar17);
  }
  else {
    if (0 < (int)uVar13) {
      local_70 = (undefined8 *)(uVar38 * 2);
      local_58 = (longlong)(iVar7 * 2) * 2;
      piVar36 = piVar25;
      piVar29 = piVar25;
      puVar34 = param_1;
      local_68 = (ulonglong)uVar13;
      do {
        if (0 < iVar19) {
          uVar35 = uVar38 & 0xffffffff;
          piVar26 = piVar29;
          puVar31 = puVar34;
          do {
            iVar14 = (int)*(short *)((longlong)puVar9 + (longlong)piVar26);
            piVar26 = (int *)((longlong)piVar26 + 2);
            uVar11 = *(ushort *)puVar31;
            puVar31 = (undefined8 *)((longlong)puVar31 + 4);
            iVar20 = iVar14 - (short)uVar11;
            if (iVar20 < 1) {
              iVar20 = (short)uVar11 - iVar14;
            }
            piVar36 = (int *)(ulonglong)(uint)((int)piVar36 + iVar20);
            uVar35 = uVar35 - 1;
          } while (uVar35 != 0);
        }
        iVar20 = (int)piVar36;
        puVar34 = (undefined8 *)((longlong)puVar34 + local_58);
        piVar29 = (int *)((longlong)piVar29 + (longlong)local_70);
        local_68 = local_68 - 1;
      } while (local_68 != 0);
    }
    if (0xe < iVar20 / (int)(uVar13 * iVar19)) goto LAB_1800228a5;
    DAT_1800e96fc = DAT_1800e96fc + 1;
    piVar36 = local_78;
    puVar34 = local_50;
    if (DAT_1800e96fc < 0xb) goto LAB_180022907;
  }
  free(piVar36);
LAB_1800226ce:
  pvVar17 = local_40;
  if (((int)DAT_1800e96f8 < 5) && (DAT_1800b0554 < DAT_1800b20b0)) {
    uVar13 = uVar6 * 2;
    uVar21 = (ulonglong)uVar13;
    if ((((puVar15 != (undefined8 *)0x0) && ((puVar39 != (undefined8 *)0x0 && (uVar13 != 0)))) &&
        (((undefined8 *)(uVar21 + (longlong)puVar39) <= puVar15 ||
         ((undefined8 *)(uVar21 + (longlong)puVar15) <= puVar39)))) && (uVar13 != 0)) {
      puVar34 = (undefined8 *)((longlong)puVar39 - (longlong)puVar15);
      do {
        *(undefined *)puVar15 = *(undefined *)((longlong)puVar34 + (longlong)puVar15);
        puVar15 = (undefined8 *)((longlong)puVar15 + 1);
        uVar21 = uVar21 - 1;
      } while (uVar21 != 0);
    }
    if ((((0 < (int)uVar6) && (0xf < uVar6)) && (1 < DAT_1800b04f8)) &&
       (((undefined8 *)((longlong)puVar8 + (longlong)(int)(uVar6 - 1) * 2) < puVar39 ||
        ((undefined8 *)((longlong)puVar39 + (longlong)(int)(uVar6 - 1) * 2) < puVar8)))) {
      uVar13 = uVar6 & 0x8000000f;
      if ((int)uVar13 < 0) {
        uVar13 = (uVar13 - 1 | 0xfffffff0) + 1;
      }
      auVar46 = ZEXT416(0xd);
      puVar15 = (undefined8 *)((longlong)puVar8 - (longlong)puVar39);
      puVar22 = puVar39 + 1;
      piVar28 = piVar25;
      do {
        uVar23 = (int)piVar25 + 0x10;
        piVar25 = (int *)(ulonglong)uVar23;
        auVar41 = ZEXT816(*(ulonglong *)((longlong)((longlong)puVar15 + -8) + (longlong)puVar22));
        puVar1 = puVar22 + 4;
        auVar44 = pmovzxwd(in_XMM2,auVar41);
        auVar41 = pmovzxwd(auVar41,ZEXT816(puVar22[-1]));
        auVar41 = pmulld(auVar41,auVar44);
        piVar28 = piVar28 + 4;
        auVar41 = CONCAT412(SUB164(auVar41 >> 0x60,0) + 0x1000 >> auVar46,
                            CONCAT48(SUB164(auVar41 >> 0x40,0) + 0x1000 >> auVar46,
                                     CONCAT44(SUB164(auVar41 >> 0x20,0) + 0x1000 >> auVar46,
                                              SUB164(auVar41,0) + 0x1000 >> auVar46)));
        auVar41 = pshuflw(auVar41,auVar41,0xd8);
        auVar44 = pshufhw(ZEXT816(puVar22[-1]),auVar41,0xd8);
        auVar41 = ZEXT816(*(ulonglong *)((longlong)((longlong)puVar15 + -0x20) + (longlong)puVar1));
        uVar21 = CONCAT44(SUB164(auVar44 >> 0x40,0),SUB164(auVar44,0));
        puVar22[-1] = uVar21;
        auVar44 = pmovzxwd(CONCAT412(SUB164(auVar44 >> 0x60,0),
                                     CONCAT48(SUB164(auVar44 >> 0x20,0),uVar21)),auVar41);
        auVar41 = pmovzxwd(auVar41,ZEXT816(*puVar22));
        auVar41 = pmulld(auVar41,auVar44);
        auVar41 = CONCAT412(SUB164(auVar41 >> 0x60,0) + 0x1000 >> auVar46,
                            CONCAT48(SUB164(auVar41 >> 0x40,0) + 0x1000 >> auVar46,
                                     CONCAT44(SUB164(auVar41 >> 0x20,0) + 0x1000 >> auVar46,
                                              SUB164(auVar41,0) + 0x1000 >> auVar46)));
        auVar41 = pshuflw(auVar41,auVar41,0xd8);
        auVar44 = pshufhw(ZEXT816(*puVar22),auVar41,0xd8);
        auVar41 = ZEXT816(*(ulonglong *)((longlong)((longlong)puVar15 + -0x18) + (longlong)puVar1));
        uVar21 = CONCAT44(SUB164(auVar44 >> 0x40,0),SUB164(auVar44,0));
        *puVar22 = uVar21;
        auVar44 = pmovzxwd(CONCAT412(SUB164(auVar44 >> 0x60,0),
                                     CONCAT48(SUB164(auVar44 >> 0x20,0),uVar21)),auVar41);
        auVar41 = pmovzxwd(auVar41,ZEXT816(puVar22[1]));
        auVar41 = pmulld(auVar41,auVar44);
        auVar41 = CONCAT412(SUB164(auVar41 >> 0x60,0) + 0x1000 >> auVar46,
                            CONCAT48(SUB164(auVar41 >> 0x40,0) + 0x1000 >> auVar46,
                                     CONCAT44(SUB164(auVar41 >> 0x20,0) + 0x1000 >> auVar46,
                                              SUB164(auVar41,0) + 0x1000 >> auVar46)));
        auVar41 = pshuflw(auVar41,auVar41,0xd8);
        auVar44 = pshufhw(ZEXT816(puVar22[1]),auVar41,0xd8);
        auVar41 = ZEXT816(*(ulonglong *)((longlong)((longlong)puVar15 + -0x10) + (longlong)puVar1));
        uVar21 = CONCAT44(SUB164(auVar44 >> 0x40,0),SUB164(auVar44,0));
        puVar22[1] = uVar21;
        auVar44 = pmovzxwd(CONCAT412(SUB164(auVar44 >> 0x60,0),
                                     CONCAT48(SUB164(auVar44 >> 0x20,0),uVar21)),auVar41);
        auVar41 = pmovzxwd(auVar41,ZEXT816(puVar22[2]));
        auVar41 = pmulld(auVar41,auVar44);
        auVar41 = CONCAT412(SUB164(auVar41 >> 0x60,0) + 0x1000 >> auVar46,
                            CONCAT48(SUB164(auVar41 >> 0x40,0) + 0x1000 >> auVar46,
                                     CONCAT44(SUB164(auVar41 >> 0x20,0) + 0x1000 >> auVar46,
                                              SUB164(auVar41,0) + 0x1000 >> auVar46)));
        auVar41 = pshuflw(auVar41,auVar41,0xd8);
        auVar41 = pshufhw(ZEXT816(puVar22[2]),auVar41,0xd8);
        uVar21 = CONCAT44(SUB164(auVar41 >> 0x40,0),SUB164(auVar41,0));
        in_XMM2 = CONCAT412(SUB164(auVar41 >> 0x60,0),CONCAT48(SUB164(auVar41 >> 0x20,0),uVar21));
        puVar22[2] = uVar21;
        puVar22 = puVar1;
      } while ((longlong)piVar28 < (longlong)(int)(uVar6 - uVar13));
    }
    lVar24 = (longlong)(int)uVar23;
    puVar31 = puVar8;
    if (lVar24 < lVar32) {
      lVar32 = lVar32 - lVar24;
      puVar15 = (undefined8 *)((longlong)puVar39 + lVar24 * 2);
      do {
        *(ushort *)puVar15 =
             (ushort)((int)((uint)*(ushort *)
                                   ((longlong)puVar15 +
                                   (longlong)((longlong)puVar8 - (longlong)puVar39)) *
                            (uint)*(ushort *)puVar15 + 0x1000) >> 0xd);
        lVar32 = lVar32 + -1;
        puVar15 = (undefined8 *)((longlong)puVar15 + 2);
      } while (lVar32 != 0);
    }
  }
  else {
    piVar36 = piVar28;
    if (((0 < (int)uVar6) && (3 < uVar6)) && (1 < DAT_1800b04f8)) {
      lVar24 = (longlong)(int)(uVar6 - 1);
      puVar37 = (undefined8 *)(lVar24 * 2 + (longlong)puVar34);
      puVar18 = (undefined8 *)((longlong)puVar39 + lVar24 * 2);
      if ((((puVar37 < puVar39) || (puVar18 < puVar34)) &&
          (((puVar2 = (undefined8 *)((longlong)puVar8 + lVar24 * 2), piVar36 = piVar25,
            puVar2 < puVar39 || (puVar18 < puVar8)) &&
           ((puVar31 = (undefined8 *)((longlong)local_48 + lVar24 * 2), puVar31 < puVar39 ||
            (puVar18 < local_48)))))) &&
         (((puVar3 = (undefined8 *)((longlong)puVar15 + lVar24 * 2), puVar3 < puVar39 ||
           (puVar18 < puVar15)) &&
          ((((puVar37 < puVar15 || (piVar36 = piVar28, puVar3 < puVar34)) &&
            ((puVar2 < puVar15 || (piVar36 = piVar28, puVar3 < puVar8)))) &&
           ((puVar31 < puVar15 || (piVar36 = piVar28, puVar3 < local_48)))))))) {
        uVar13 = uVar6 & 0x80000003;
        if ((int)uVar13 < 0) {
          uVar13 = (uVar13 - 1 | 0xfffffffc) + 1;
        }
        auVar46 = ZEXT416(0xd);
        puVar31 = (undefined8 *)((longlong)puVar39 - (longlong)puVar15);
        puVar18 = puVar15;
        do {
          puVar37 = puVar18 + 1;
          auVar45 = pmovzxwd(in_XMM3,ZEXT816(*(ulonglong *)((longlong)puVar31 + (longlong)puVar18)))
          ;
          auVar41 = ZEXT816(*(ulonglong *)
                             ((longlong)local_48 + (-8 - (longlong)puVar15) + (longlong)puVar37));
          uVar27 = (int)piVar25 + 4;
          piVar25 = (int *)(ulonglong)uVar27;
          auVar44 = pmovzxwd(in_XMM1,auVar41);
          auVar44 = pmulld(auVar44,auVar45);
          auVar44 = CONCAT412(SUB164(auVar44 >> 0x60,0) + 0x1000 >> auVar46,
                              CONCAT48(SUB164(auVar44 >> 0x40,0) + 0x1000 >> auVar46,
                                       CONCAT44(SUB164(auVar44 >> 0x20,0) + 0x1000 >> auVar46,
                                                SUB164(auVar44,0) + 0x1000 >> auVar46)));
          auVar41 = pshuflw(auVar41,auVar44,0xd8);
          auVar44 = pshufhw(auVar44,auVar41,0xd8);
          auVar41 = ZEXT816(*(ulonglong *)
                             ((longlong)puVar34 + (-8 - (longlong)puVar15) + (longlong)puVar37));
          uVar43 = CONCAT44(SUB164(auVar44 >> 0x40,0),SUB164(auVar44,0));
          auVar42 = ZEXT816(*(ulonglong *)
                             ((longlong)puVar8 + (-8 - (longlong)puVar15) + (longlong)puVar37));
          *puVar18 = uVar43;
          auVar44 = pmovzxwd(CONCAT412(SUB164(auVar44 >> 0x60,0),
                                       CONCAT48(SUB164(auVar44 >> 0x20,0),uVar43)),auVar41);
          auVar41 = pmovzxwd(auVar41,auVar42);
          auVar45 = pmulld(auVar45,auVar41);
          auVar44 = pmulld(CONCAT412(SUB164(auVar45 >> 0x60,0) + 0x1000 >> auVar46,
                                     CONCAT48(SUB164(auVar45 >> 0x40,0) + 0x1000 >> auVar46,
                                              CONCAT44(SUB164(auVar45 >> 0x20,0) + 0x1000 >> auVar46
                                                       ,SUB164(auVar45,0) + 0x1000 >> auVar46))),
                           auVar44);
          in_XMM3 = CONCAT412(SUB164(auVar44 >> 0x60,0) + 0x1000 >> auVar46,
                              CONCAT48(SUB164(auVar44 >> 0x40,0) + 0x1000 >> auVar46,
                                       CONCAT44(SUB164(auVar44 >> 0x20,0) + 0x1000 >> auVar46,
                                                SUB164(auVar44,0) + 0x1000 >> auVar46)));
          auVar41 = pshuflw(auVar41,in_XMM3,0xd8);
          in_XMM1 = pshufhw(auVar42,auVar41,0xd8);
          *(ulonglong *)((longlong)((longlong)puVar31 + -8) + (longlong)puVar37) =
               CONCAT44(SUB164(in_XMM1 >> 0x40,0),SUB164(in_XMM1,0));
          puVar18 = puVar37;
          piVar36 = piVar25;
        } while ((int)uVar27 < (int)(uVar6 - uVar13));
      }
    }
    lVar24 = (longlong)(int)piVar36;
    if (lVar24 < lVar32) {
      puVar39 = (undefined8 *)((longlong)puVar39 - (longlong)puVar15);
      lVar32 = lVar32 - lVar24;
      puVar18 = (undefined8 *)((longlong)puVar15 + lVar24 * 2);
      do {
        puVar37 = (undefined8 *)((longlong)puVar18 + 2);
        *(ushort *)puVar18 =
             (ushort)((int)((uint)*(ushort *)
                                   ((longlong)puVar18 +
                                   (longlong)((longlong)local_48 - (longlong)puVar15)) *
                            (uint)*(ushort *)((longlong)puVar39 + (longlong)puVar18) + 0x1000) >>
                     0xd);
        *(short *)((longlong)((longlong)puVar39 + -2) + (longlong)puVar37) =
             (short)((int)(((int)((uint)*(ushort *)
                                         ((longlong)puVar18 +
                                         (longlong)((longlong)puVar8 - (longlong)puVar15)) *
                                  (uint)*(ushort *)
                                         ((longlong)((longlong)puVar39 + -2) + (longlong)puVar37) +
                                 0x1000) >> 0xd) *
                           (uint)*(ushort *)
                                  ((longlong)puVar18 +
                                  (longlong)((longlong)puVar34 - (longlong)puVar15)) + 0x1000) >>
                    0xd);
        lVar32 = lVar32 + -1;
        puVar18 = puVar37;
      } while (lVar32 != 0);
    }
  }
  if (local_40 != (void *)0x0) {
    FUN_1800217c0((longlong)&DAT_1800b20b4,(longlong)local_40,puVar31,(undefined2 *)puVar8,
                  in_stack_00000030);
    free(pvVar17);
  }
  return;
}



undefined8
FUN_180022c70(ulonglong param_1,undefined8 param_2,ulonglong param_3,void **param_4,
             longlong *param_5,int *param_6)

{
  ushort *puVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  size_t _Size;
  uint uVar6;
  short sVar7;
  ushort uVar8;
  void *_Memory;
  void *_Memory_00;
  ushort *_Memory_01;
  ushort *puVar9;
  ulonglong uVar10;
  longlong lVar11;
  ulonglong uVar12;
  ulonglong uVar13;
  longlong lVar14;
  undefined in_stack_ffffffffffffff98;
  undefined in_stack_ffffffffffffffa0;
  undefined in_stack_ffffffffffffffa8;
  undefined in_stack_ffffffffffffffb0;

  iVar2 = param_6[5];
  iVar3 = *param_6;
  uVar4 = param_6[2];
  lVar14 = (longlong)(int)uVar4;
  lVar11 = 0;
  if (param_5 != (longlong *)0x0) {
    lVar11 = *param_5;
  }
  iVar5 = param_6[1];
  _Size = (longlong)(iVar3 * iVar5) * 2;
  _Memory = malloc(_Size);
  _Memory_00 = malloc(_Size);
  _Memory_01 = (ushort *)malloc(_Size);
  *(undefined4 *)(param_4 + 7) = DAT_1800e96f8;
  uVar6 = iVar3 * iVar5 * 2;
  uVar12 = (ulonglong)uVar6;
  *param_4 = _Memory;
  param_4[1] = &DAT_1800fd420;
  param_4[2] = &DAT_1800f3b00;
  param_4[4] = &DAT_1800e70b0;
  param_4[5] = _Memory_00;
  param_4[6] = &DAT_1800ea1e0;
  param_4[3] = &DAT_1800dd790;
  uVar13 = uVar12;
  if ((_Memory_01 != (ushort *)0x0) && (param_1 != 0)) {
    if (uVar6 == 0) goto LAB_180022dce;
    if (((ushort *)(uVar12 + param_1) <= _Memory_01) || (uVar12 + (longlong)_Memory_01 <= param_1))
    {
      if (uVar6 == 0) goto LAB_180022dce;
      puVar9 = _Memory_01;
      uVar10 = uVar12;
      do {
        *(undefined *)puVar9 = *(undefined *)((param_1 - (longlong)_Memory_01) + (longlong)puVar9);
        puVar9 = (ushort *)((longlong)puVar9 + 1);
        uVar10 = uVar10 - 1;
      } while (uVar10 != 0);
    }
  }
  if ((uVar6 != 0) &&
     (((param_3 = uVar12,
       (undefined *)((longlong)&DAT_1800bb9d4 + uVar12) < (undefined *)0x1800dd791 ||
       (&DAT_1800dd790 + uVar12 < (undefined *)0x1800bb9d5)) && (uVar6 != 0)))) {
    memcpy_FUN_180061f90((undefined8 *)&DAT_1800dd790,(undefined8 *)&DAT_1800bb9d4,uVar12);
    param_3 = uVar12;
  }
LAB_180022dce:
  FUN_180021a20(iVar2,uVar4,(char)param_3,(char)uVar13,in_stack_ffffffffffffff98,
                in_stack_ffffffffffffffa0,in_stack_ffffffffffffffa8,in_stack_ffffffffffffffb0,
                &DAT_1800b20b4);
  FUN_180022240(_Memory_01);
  if (0 < (int)uVar4) {
    puVar9 = _Memory_01;
    do {
      puVar1 = (ushort *)((longlong)puVar9 + (longlong)((longlong)_Memory - (longlong)_Memory_01));
      if (*(short *)((longlong)puVar1 + (longlong)((longlong)&DAT_1800b20b4 - (longlong)_Memory)) ==
          0) {
        *(ushort *)((longlong)puVar1 + (longlong)(&DAT_1800c52f4 + -(longlong)_Memory)) = *puVar9;
        if (lVar11 != 0) {
          uVar8 = *puVar9;
          goto LAB_180022eb6;
        }
      }
      else {
        uVar8 = *puVar1;
        if (uVar8 == 0) {
          sVar7 = *puVar9 << 0xd;
        }
        else {
          sVar7 = (short)((ulonglong)((uint)(uVar8 >> 1) + (uint)*puVar9 * 0x2000) /
                         (ulonglong)uVar8);
        }
        *(short *)((longlong)puVar1 + (longlong)(&DAT_1800c52f4 + -(longlong)_Memory)) = sVar7;
        if (lVar11 != 0) {
          uVar8 = *(ushort *)
                   ((longlong)puVar1 + (longlong)((longlong)_Memory_00 - (longlong)_Memory));
          if (uVar8 == 0) {
            uVar8 = *puVar9 << 0xd;
          }
          else {
            uVar8 = (ushort)((ulonglong)((uint)(uVar8 >> 1) + (uint)*puVar9 * 0x2000) /
                            (ulonglong)uVar8);
          }
LAB_180022eb6:
          *(ushort *)((longlong)puVar9 + (lVar11 - (longlong)_Memory_01)) = uVar8;
        }
      }
      puVar9 = puVar9 + 1;
      lVar14 = lVar14 + -1;
    } while (lVar14 != 0);
  }
  free(_Memory_00);
  free(_Memory);
  free(_Memory_01);
  return 1;
}



undefined8 FUN_180022f20(int **param_1,undefined *param_2,int param_3,int param_4)

{
  longlong lVar1;
  int *piVar2;
  undefined *puVar3;
  undefined8 uVar4;
  ulonglong uVar5;
  uint uVar6;

  if ((param_1 == (int **)0x0) || (param_2 == (undefined *)0x0)) {
    uVar4 = 0x80000002;
  }
  else {
    if (*param_1 == (int *)0x0) {
      piVar2 = FUN_180022ff0(param_3,param_4,1);
      *param_1 = piVar2;
      if (piVar2 == (int *)0x0) {
        return 0x80000004;
      }
    }
    uVar6 = param_3 * param_4;
    uVar5 = (ulonglong)uVar6;
    puVar3 = *(undefined **)(*param_1 + 6);
    if ((((puVar3 != (undefined *)0x0) && (uVar6 != 0)) &&
        ((param_2 + uVar5 <= puVar3 || (puVar3 + uVar5 <= param_2)))) && (uVar6 != 0)) {
      lVar1 = -(longlong)puVar3;
      do {
        *puVar3 = (param_2 + lVar1)[(longlong)puVar3];
        puVar3 = puVar3 + 1;
        uVar5 = uVar5 - 1;
      } while (uVar5 != 0);
    }
    uVar4 = 0;
  }
  return uVar4;
}



int * FUN_180022ff0(int param_1,int param_2,int param_3)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int iVar5;

  if (param_3 == 8) {
    iVar4 = -1;
    iVar5 = param_1 * param_2;
    iVar1 = (int)(iVar5 + (iVar5 >> 0x1f & 7U)) >> 3;
    iVar3 = iVar1 + 1;
    if (iVar5 <= iVar1 * 8) {
      iVar3 = iVar1;
    }
  }
  else {
    iVar4 = param_1 * param_3;
    iVar3 = param_1 * param_2 * param_3;
  }
  piVar2 = (int *)malloc((longlong)iVar3 + 0x20);
  if (piVar2 != (int *)0x0) {
    piVar2[3] = iVar3;
    *piVar2 = param_1;
    piVar2[1] = param_2;
    piVar2[4] = param_3;
    piVar2[2] = iVar4;
    *(int **)(piVar2 + 6) = piVar2 + 8;
  }
  return piVar2;
}



undefined8 FUN_1800230a0(void **param_1)

{
  if ((param_1 != (void **)0x0) && (*param_1 != (void *)0x0)) {
    free(*param_1);
    *param_1 = (void *)0x0;
    return 0;
  }
  return 0x80000002;
}



void FUN_1800230e0(int *param_1,int **param_2)

{
  uint uVar1;
  undefined *puVar2;
  longlong lVar3;
  int *_Memory;
  undefined *puVar4;
  ulonglong uVar5;

  if ((param_2 != (int **)0x0) && (_Memory = *param_2, _Memory != (int *)0x0)) {
    if (_Memory[3] < param_1[3]) {
      free(_Memory);
      _Memory = FUN_180022ff0(*param_1,param_1[1],param_1[4]);
      *param_2 = _Memory;
    }
    *_Memory = *param_1;
    _Memory[1] = param_1[1];
    _Memory[2] = param_1[2];
    _Memory[3] = param_1[3];
    _Memory[4] = param_1[4];
    puVar4 = *(undefined **)(_Memory + 6);
    uVar1 = param_1[3];
    uVar5 = (ulonglong)uVar1;
    puVar2 = *(undefined **)(param_1 + 6);
    if ((((puVar4 != (undefined *)0x0) && (puVar2 != (undefined *)0x0)) && (uVar1 != 0)) &&
       (((puVar2 + uVar5 <= puVar4 || (puVar4 + uVar5 <= puVar2)) && (uVar1 != 0)))) {
      lVar3 = -(longlong)puVar4;
      do {
        *puVar4 = puVar4[(longlong)(puVar2 + lVar3)];
        puVar4 = puVar4 + 1;
        uVar5 = uVar5 - 1;
      } while (uVar5 != 0);
    }
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_1800231c0(int *param_1,int *param_2,longlong param_3)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  longlong lVar7;
  int iVar8;
  longlong lVar9;
  int iVar10;
  int *local_118 [2];
  longlong alStack264 [6];
  longlong local_d8;
  longlong alStack184 [6];
  longlong local_88;
  undefined local_68 [4];
  int aiStack100 [3];
  undefined8 local_58;
  int local_50 [6];
  ulonglong local_38;

  local_38 = DAT_1800b04e8 ^ (ulonglong)local_118;
  iVar1 = *param_2;
  lVar9 = 0;
  iVar2 = param_2[1];
  iVar6 = param_2[4];
  iVar3 = param_2[5];
  iVar8 = param_2[2];
  iVar10 = param_2[3];
  local_58 = 0;
  _local_68 = ZEXT816(0);
  local_50[0] = iVar1;
  local_50[1] = iVar2;
  local_50[2] = iVar8;
  local_50[3] = iVar10;
  local_50[4] = iVar6;
  local_50[5] = iVar3;
  lVar7 = lVar9;
  do {
    iVar5 = *(int *)((longlong)local_50 + lVar9);
    *(int *)(local_68 + lVar9) = *(int *)(lVar9 + param_3) << 10;
    iVar4 = *(int *)((longlong)local_50 + lVar9 + 4);
    *(int *)((longlong)aiStack100 + lVar9) = *(int *)(lVar9 + param_3 + 4) << 10;
    lVar9 = lVar9 + 8;
    *(longlong *)((longlong)alStack264 + lVar7) = (longlong)(iVar5 - iVar1);
    *(longlong *)((longlong)alStack184 + lVar7) = (longlong)(iVar4 - iVar2);
    *(longlong *)((longlong)alStack264 + lVar7 + 8) = (longlong)(iVar5 - iVar8);
    *(longlong *)((longlong)alStack184 + lVar7 + 8) = (longlong)(iVar4 - iVar10);
    *(longlong *)((longlong)alStack264 + lVar7 + 0x10) = (longlong)(iVar5 - iVar6);
    *(longlong *)((longlong)alStack184 + lVar7 + 0x10) = (longlong)(iVar4 - iVar3);
    lVar7 = lVar7 + 0x18;
  } while (lVar9 < 0x18);
  iVar8 = 0x7fffffff;
  lVar7 = alStack264[3] * local_88 - local_d8 * alStack184[3];
  if (lVar7 == 0) {
    iVar10 = 0x7fffffff;
  }
  else {
    iVar10 = (int)(((aiStack100[2] - aiStack100[0]) * local_88 -
                   (local_58._4_4_ - aiStack100[0]) * alStack184[3]) / lVar7);
  }
  param_1[3] = iVar10;
  if (-lVar7 == 0) {
    iVar5 = 0x7fffffff;
  }
  else {
    iVar5 = (int)(((aiStack100[2] - aiStack100[0]) * local_d8 -
                  (local_58._4_4_ - aiStack100[0]) * alStack264[3]) / -lVar7);
  }
  param_1[3] = iVar10 >> 2;
  param_1[4] = iVar5 >> 2;
  param_1[5] = (int)(((longlong)local_58._4_4_ - (longlong)iVar5 * (longlong)iVar3) -
                     (longlong)iVar10 * (longlong)iVar6 >> 10);
  lVar7 = alStack264[1] * alStack184[5] - alStack264[5] * alStack184[1];
  if (lVar7 == 0) {
    iVar6 = 0x7fffffff;
  }
  else {
    iVar6 = (int)(((local_68 - aiStack100[1]) * alStack184[5] -
                  (aiStack100[1] - (int)local_58) * alStack184[1]) / lVar7);
  }
  *param_1 = iVar6;
  if (-lVar7 != 0) {
    iVar8 = (int)(((local_68 - aiStack100[1]) * alStack264[5] -
                  (aiStack100[1] - (int)local_58) * alStack264[1]) / -lVar7);
  }
  *param_1 = iVar6 >> 2;
  param_1[1] = iVar8 >> 2;
  param_1[2] = (int)(((longlong)local_68 - (longlong)iVar8 * (longlong)iVar2) -
                     (longlong)iVar6 * (longlong)iVar1 >> 10);
  local_118[0] = param_1;
  FUN_18005f100(local_38 ^ (ulonglong)local_118);
  return;
}



void FUN_180023460(undefined8 *param_1)

{
  uint uVar1;
  byte bVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  int iVar8;

  uVar3 = 0x8000;
  bVar2 = 0xf;
  iVar8 = *(int *)param_1 + *(int *)(param_1 + 2) >> 1;
  iVar4 = *(int *)((longlong)param_1 + 0xc) - *(int *)((longlong)param_1 + 4) >> 1;
  uVar7 = iVar4 * iVar4 + iVar8 * iVar8;
  uVar6 = uVar7;
  uVar5 = 0;
  if (1 < uVar7) {
    do {
      uVar1 = uVar3 + uVar5 * 2 << (bVar2 & 0x1f);
      bVar2 = bVar2 - 1;
      uVar6 = uVar5;
      if (uVar1 <= uVar7) {
        uVar6 = uVar5 + uVar3;
        uVar7 = uVar7 - uVar1;
      }
      uVar3 = uVar3 >> 1;
      uVar5 = uVar6;
    } while (uVar3 != 0);
  }
  if (uVar6 != 0) {
    iVar8 = (((int)uVar6 >> 1) + iVar8 * 0x100) / (int)uVar6;
    *(int *)param_1 = iVar8;
    *(int *)(param_1 + 2) = iVar8;
    iVar4 = (((int)uVar6 >> 1) + iVar4 * -0x100) / (int)uVar6;
    *(int *)((longlong)param_1 + 4) = iVar4;
    *(int *)((longlong)param_1 + 0xc) = -iVar4;
    return;
  }
  *param_1 = 0x100;
  *(undefined4 *)(param_1 + 2) = 0x100;
  *(undefined4 *)((longlong)param_1 + 0xc) = 0;
  return;
}



void FUN_180023510(int *param_1,int *param_2,undefined8 *param_3)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  byte bVar8;
  longlong lVar9;
  uint uVar10;
  longlong lVar11;
  longlong lVar12;
  uint uVar13;
  uint uVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  longlong lVar18;
  int iVar19;

  if ((param_1 != (int *)0x0) && (param_2 != (int *)0x0)) {
    iVar15 = param_2[3];
    iVar19 = param_2[1];
    lVar12 = (longlong)param_1[3];
    iVar1 = param_2[5];
    iVar2 = param_2[4];
    iVar3 = param_2[2];
    lVar11 = (longlong)*param_1;
    iVar4 = *param_2;
    lVar18 = (longlong)param_1[1];
    iVar5 = param_1[2];
    lVar9 = (longlong)param_1[4];
    uVar10 = 0x8000;
    bVar8 = 0xf;
    iVar6 = param_1[5];
    iVar17 = (int)((ulonglong)(iVar4 * lVar11 + iVar15 * lVar18) >> 8);
    *(int *)param_3 = iVar17;
    iVar16 = (int)((ulonglong)(lVar12 * iVar19 + lVar9 * iVar2) >> 8);
    iVar17 = iVar17 + iVar16 >> 1;
    iVar15 = (int)((ulonglong)(iVar4 * lVar12 + iVar15 * lVar9) >> 8);
    *(int *)((longlong)param_3 + 0xc) = iVar15;
    iVar19 = (int)((ulonglong)(lVar11 * iVar19 + iVar2 * lVar18) >> 8);
    iVar15 = iVar15 - iVar19 >> 1;
    *(int *)(param_3 + 2) = iVar16;
    *(int *)((longlong)param_3 + 4) = iVar19;
    uVar13 = 0;
    *(int *)(param_3 + 1) = (int)((ulonglong)(iVar3 * lVar11 + iVar1 * lVar18) >> 8) + iVar5;
    uVar14 = iVar15 * iVar15 + iVar17 * iVar17;
    *(int *)((longlong)param_3 + 0x14) =
         (int)((ulonglong)(lVar12 * iVar3 + lVar9 * iVar1) >> 8) + iVar6;
    uVar7 = uVar14;
    if (1 < uVar14) {
      do {
        uVar7 = uVar10 + uVar13 * 2 << (bVar8 & 0x1f);
        bVar8 = bVar8 - 1;
        if (uVar7 <= uVar14) {
          uVar13 = uVar13 + uVar10;
          uVar14 = uVar14 - uVar7;
        }
        uVar10 = uVar10 >> 1;
        uVar7 = uVar13;
      } while (uVar10 != 0);
    }
    if (uVar7 == 0) {
      *param_3 = 0x100;
      *(undefined4 *)(param_3 + 2) = 0x100;
      *(undefined4 *)((longlong)param_3 + 0xc) = 0;
      return;
    }
    iVar19 = (((int)uVar7 >> 1) + iVar17 * 0x100) / (int)uVar7;
    *(int *)param_3 = iVar19;
    *(int *)(param_3 + 2) = iVar19;
    iVar15 = (((int)uVar7 >> 1) + iVar15 * -0x100) / (int)uVar7;
    *(int *)((longlong)param_3 + 4) = iVar15;
    *(int *)((longlong)param_3 + 0xc) = -iVar15;
  }
  return;
}



void FUN_180023700(longlong param_1,longlong param_2,int *param_3,int param_4,int param_5,
                  uint param_6,uint param_7,int param_8)

{
  int iVar1;
  undefined uVar2;
  longlong lVar3;
  undefined uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  longlong lVar8;
  ulonglong uVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  uint uVar13;
  int iVar14;
  ulonglong uVar15;
  int iVar16;
  ulonglong uVar17;
  undefined *puVar18;
  undefined *puVar19;
  int local_res18;
  int local_a8;
  int local_a0;
  int local_90;
  int local_88;
  int local_80;
  int local_78;
  int local_70;

  puVar19 = *(undefined **)(param_2 + 0x18);
  lVar3 = *(longlong *)(param_1 + 0x18);
  iVar12 = *param_3;
  iVar6 = param_3[1];
  uVar2 = *puVar19;
  iVar14 = param_3[3];
  iVar5 = param_3[4];
  local_70 = 0;
  local_90 = 0;
  local_88 = 1;
  iVar7 = iVar12 * iVar5 - iVar6 * iVar14;
  local_80 = 1;
  local_78 = 0;
  local_a0 = 0;
  if (iVar7 != 0) {
    lVar8 = (longlong)iVar7;
    local_80 = (int)(((longlong)iVar5 << 0x12) / lVar8);
    local_78 = (int)(((longlong)iVar14 * -0x40000) / lVar8);
    local_70 = (int)(((longlong)iVar6 * -0x40000) / lVar8);
    local_88 = (int)(((longlong)iVar12 << 0x12) / lVar8);
    local_90 = (int)((((longlong)param_3[5] * (longlong)iVar6 -
                      (longlong)iVar5 * (longlong)param_3[2]) * 0x400) / lVar8);
    local_a0 = (int)((((longlong)iVar14 * (longlong)param_3[2] -
                      (longlong)param_3[5] * (longlong)iVar12) * 0x400) / lVar8);
  }
  uVar9 = (ulonglong)param_6;
  if (0 < (int)param_6) {
    local_res18 = 0;
    local_a8 = 0;
    uVar17 = (longlong)(int)param_7;
    do {
      if (0 < (int)uVar17) {
        uVar17 = uVar17 & 0xffffffff;
        puVar18 = puVar19;
        iVar12 = local_res18;
        iVar6 = local_a8;
        do {
          iVar7 = iVar12 + local_90 >> 10;
          iVar5 = iVar6 + local_a0 >> 10;
          iVar14 = iVar7 + 1;
          uVar4 = uVar2;
          if ((((param_8 <= iVar14) && (iVar11 = param_5 - param_8, iVar7 < iVar11)) &&
              (iVar1 = iVar5 + 1, param_8 <= iVar1)) && (iVar16 = param_4 - param_8, iVar5 < iVar16)
             ) {
            iVar10 = iVar5 * param_5 + iVar7;
            if ((char)((iVar16 <= iVar1) + (iVar11 <= iVar14) + (iVar5 < param_8) +
                      (iVar7 < param_8)) == '\0') {
              iVar7 = iVar12 + iVar7 * -0x400 + local_90;
              iVar14 = iVar6 + iVar5 * -0x400 + local_a0;
              uVar4 = (char)((int)((0x400 - iVar14) *
                                   ((uint)*(byte *)((iVar10 + 1) + lVar3) * iVar7 +
                                   (uint)*(byte *)(iVar10 + lVar3) * (0x400 - iVar7)) +
                                  ((uint)*(byte *)((iVar10 + param_5) + lVar3) * (0x400 - iVar7) +
                                  (uint)*(byte *)((param_5 + 1 + iVar10) + lVar3) * iVar7) * iVar14
                                  + 0x80000) >> 0x14);
            }
            else {
              uVar13 = 0;
              uVar15 = 0;
              if (param_8 <= iVar7) {
                if (param_8 <= iVar5) {
                  uVar15 = (ulonglong)*(byte *)(iVar10 + lVar3);
                }
                uVar13 = (uint)(param_8 <= iVar5);
                if (iVar1 < iVar16) {
                  uVar15 = (ulonglong)((int)uVar15 + (uint)*(byte *)((iVar10 + param_5) + lVar3));
                  uVar13 = uVar13 + 1;
                }
              }
              if (iVar14 < iVar11) {
                if (param_8 <= iVar5) {
                  uVar15 = (ulonglong)((int)uVar15 + (uint)*(byte *)((iVar10 + 1) + lVar3));
                  uVar13 = uVar13 + 1;
                }
                if (iVar1 < iVar16) {
                  uVar15 = (ulonglong)
                           ((int)uVar15 + (uint)*(byte *)((param_5 + 1 + iVar10) + lVar3));
                  uVar13 = uVar13 + 1;
                }
              }
              uVar4 = (char)(uVar15 / uVar13);
            }
          }
          iVar12 = iVar12 + local_80;
          *puVar18 = uVar4;
          puVar18 = puVar18 + 1;
          iVar6 = iVar6 + local_78;
          uVar17 = uVar17 - 1;
        } while (uVar17 != 0);
        uVar17 = (ulonglong)param_7;
      }
      puVar19 = puVar19 + (int)param_7;
      local_res18 = local_res18 + local_70;
      local_a8 = local_a8 + local_88;
      uVar9 = uVar9 - 1;
    } while (uVar9 != 0);
  }
  return;
}



void FUN_180023af0(longlong param_1,undefined2 *param_2,int *param_3,int param_4,int param_5,
                  uint param_6,int param_7)

{
  int iVar1;
  int iVar2;
  longlong lVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  int iVar10;
  ulonglong uVar11;
  ulonglong uVar12;
  ulonglong uVar13;
  int local_48;
  int local_40;

  iVar5 = *param_3;
  iVar1 = param_3[1];
  iVar6 = 0;
  iVar2 = param_3[4];
  iVar7 = param_3[3];
  iVar10 = 1;
  uVar13 = 0;
  uVar11 = 0;
  local_48 = 0;
  local_40 = 1;
  iVar4 = iVar5 * iVar2 - iVar1 * iVar7;
  if (iVar4 != 0) {
    lVar3 = (longlong)iVar4;
    iVar10 = (int)(((longlong)iVar2 << 0x12) / lVar3);
    iVar6 = (int)(((longlong)iVar7 * -0x40000) / lVar3);
    local_48 = (int)(((longlong)iVar1 * -0x40000) / lVar3);
    local_40 = (int)(((longlong)iVar5 << 0x12) / lVar3);
    uVar13 = (((longlong)param_3[5] * (longlong)iVar1 - (longlong)iVar2 * (longlong)param_3[2]) *
             0x400) / lVar3;
    uVar11 = (((longlong)iVar7 * (longlong)param_3[2] - (longlong)param_3[5] * (longlong)iVar5) *
             0x400) / lVar3;
  }
  if (0 < (int)param_6) {
    uVar12 = (ulonglong)param_6;
    lVar3 = param_1 - (longlong)param_2;
    do {
      iVar5 = 0;
      uVar8 = uVar13 & 0xffffffff;
      uVar9 = uVar11 & 0xffffffff;
      if (0 < param_7) {
        do {
          iVar2 = (int)uVar8 >> 10;
          iVar1 = (int)uVar9 >> 10;
          if ((((-1 < iVar2) && (iVar2 < param_5)) && (-1 < iVar1)) && (iVar1 < param_4)) break;
          iVar5 = iVar5 + 1;
          uVar8 = (ulonglong)(uint)((int)uVar8 + iVar10);
          uVar9 = (ulonglong)(uint)((int)uVar9 + iVar6);
        } while (iVar5 < param_7);
      }
      iVar7 = param_7 + -1;
      iVar1 = (int)uVar13 + (param_7 + -1) * iVar10;
      iVar2 = (param_7 + -1) * iVar6 + (int)uVar11;
      while (iVar5 <= iVar7) {
        if (((-1 < iVar1 >> 10) && (iVar1 >> 10 < param_5)) &&
           ((-1 < iVar2 >> 10 && (iVar2 >> 10 < param_4)))) break;
        iVar7 = iVar7 + -1;
        iVar1 = iVar1 - iVar10;
        iVar2 = iVar2 - iVar6;
      }
      uVar13 = (ulonglong)(uint)((int)uVar13 + local_48);
      uVar11 = (ulonglong)(uint)((int)uVar11 + local_40);
      *(short *)(lVar3 + (longlong)param_2) = (short)iVar5;
      *param_2 = (short)iVar7;
      param_2 = param_2 + 1;
      uVar12 = uVar12 - 1;
    } while (uVar12 != 0);
  }
  return;
}



void FUN_180023cd0(int *param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  longlong lVar7;
  int iVar8;

  if (param_2 != (int *)0x0) {
    iVar6 = *param_1;
    iVar1 = param_1[3];
    iVar2 = param_1[4];
    iVar3 = param_1[2];
    iVar4 = param_1[5];
    iVar5 = param_1[1];
    iVar8 = iVar6 * iVar2 - iVar5 * iVar1;
    if (iVar8 == 0) {
      *param_2 = iVar6;
      param_2[1] = param_1[1];
      param_2[2] = param_1[2];
      param_2[3] = param_1[3];
      param_2[4] = param_1[4];
      iVar6 = param_1[5];
    }
    else {
      lVar7 = (longlong)iVar8;
      *param_2 = (int)(((longlong)iVar2 << 0x10) / lVar7);
      param_2[1] = (int)(((longlong)iVar5 * -0x10000) / lVar7);
      param_2[2] = (int)((((longlong)iVar4 * (longlong)iVar5 - (longlong)iVar2 * (longlong)iVar3) *
                         0x100) / lVar7);
      param_2[3] = (int)(((longlong)iVar1 * -0x10000) / lVar7);
      param_2[4] = (int)(((longlong)iVar6 << 0x10) / lVar7);
      iVar6 = (int)((((longlong)iVar1 * (longlong)iVar3 - (longlong)iVar4 * (longlong)iVar6) * 0x100
                    ) / lVar7);
    }
    param_2[5] = iVar6;
  }
  return;
}



void FUN_180023de0(byte *param_1,int param_2,int param_3,longlong param_4)

{
  uint uVar1;
  byte *pbVar2;
  ulonglong uVar3;
  uint uVar4;
  uint uVar5;
  longlong lVar6;
  ulonglong uVar7;
  int iVar8;
  ulonglong uVar10;
  longlong lVar11;
  longlong lVar12;
  longlong lVar13;
  int iVar14;
  uint uVar15;
  undefined auStack1160 [32];
  uint local_468;
  int local_464;
  int local_458 [256];
  ulonglong local_58;
  ulonglong uVar9;

  local_58 = DAT_1800b04e8 ^ (ulonglong)auStack1160;
  uVar9 = 0;
  iVar8 = 0;
  uVar15 = 0;
  local_468 = 0;
  local_464 = param_3;
  memset(local_458,0,0x400);
  iVar14 = param_3 * param_2;
  uVar1 = 0;
  if (0 < iVar14) {
    pbVar2 = param_1;
    lVar6 = (longlong)iVar14;
    uVar3 = uVar9;
    uVar7 = uVar9;
    do {
      if (pbVar2[param_4 - (longlong)param_1] != 0) {
        uVar7 = (ulonglong)((int)uVar7 + (uint)*pbVar2);
        uVar3 = (ulonglong)((int)uVar3 + 1);
      }
      iVar8 = (int)uVar7;
      uVar1 = (uint)uVar3;
      pbVar2 = pbVar2 + 1;
      lVar6 = lVar6 + -1;
    } while (lVar6 != 0);
  }
  uVar3 = uVar9;
  uVar7 = uVar9;
  uVar10 = uVar9;
  uVar4 = 0;
  if (0 < iVar14) {
    do {
      uVar4 = (int)uVar7 + (uint)*(byte *)(uVar3 + param_4);
      if (0 < (int)uVar4) {
        uVar4 = (int)uVar10 / param_2;
        break;
      }
      uVar3 = uVar3 + 1;
      uVar7 = (ulonglong)uVar4;
      uVar10 = (ulonglong)((int)uVar10 + 1);
      uVar4 = uVar15;
    } while ((longlong)uVar3 < (longlong)iVar14);
  }
  iVar14 = iVar14 + -1;
  lVar6 = (longlong)iVar14;
  uVar3 = uVar9;
  if (iVar14 < 1) {
    uVar5 = 0;
  }
  else {
    do {
      uVar5 = (int)uVar3 + (uint)*(byte *)(lVar6 + param_4);
      uVar3 = (ulonglong)uVar5;
      if (0 < (int)uVar5) {
        local_468 = iVar14 / param_2;
        uVar5 = local_468;
        break;
      }
      iVar14 = iVar14 + -1;
      lVar6 = lVar6 + -1;
      uVar5 = uVar15;
    } while (0 < lVar6);
  }
  lVar11 = (longlong)(int)uVar4;
  lVar6 = (longlong)(int)uVar5;
  if (lVar11 <= lVar6) {
    iVar14 = param_2 * uVar4;
    do {
      pbVar2 = param_1 + iVar14;
      uVar5 = uVar15;
      if (0 < param_2) {
        lVar13 = (iVar14 + param_4) - (longlong)pbVar2;
        uVar3 = uVar9;
        lVar12 = (longlong)param_2;
        do {
          uVar5 = iVar8 / (int)(uVar1 + 1);
          if (pbVar2[lVar13] != 0) {
            uVar5 = (uint)*pbVar2;
          }
          uVar5 = (int)uVar3 + uVar5;
          uVar3 = (ulonglong)uVar5;
          pbVar2 = pbVar2 + 1;
          lVar12 = lVar12 + -1;
        } while (lVar12 != 0);
      }
      iVar14 = iVar14 + param_2;
      local_458[lVar11] = (int)(uVar5 << 8) / param_2;
      lVar11 = lVar11 + 1;
    } while (lVar11 <= lVar6);
  }
  if (((int)uVar4 < (int)local_468) && (7 < local_468 - uVar4)) {
    uVar1 = local_468 - uVar4 & 0x80000007;
    if ((int)uVar1 < 0) {
      uVar1 = (uVar1 - 1 | 0xfffffff8) + 1;
    }
    do {
      uVar4 = uVar4 + 8;
    } while ((int)uVar4 < (int)(local_468 - uVar1));
  }
  lVar11 = (longlong)(int)uVar4;
  while (lVar11 < lVar6) {
    lVar11 = lVar11 + 1;
  }
  FUN_18005f100(local_58 ^ (ulonglong)auStack1160);
  return;
}



void FUN_1800240f0(byte *param_1,int param_2,ulonglong param_3,longlong param_4)

{
  int iVar1;
  uint uVar2;
  ulonglong uVar3;
  int iVar4;
  char *pcVar5;
  char cVar6;
  int iVar7;
  longlong lVar8;
  ulonglong uVar9;
  longlong lVar10;
  char cVar11;
  byte *pbVar12;
  ulonglong uVar13;
  ulonglong uVar14;
  char cVar15;
  ulonglong uVar16;
  undefined4 *puVar17;
  longlong lVar18;
  undefined auStack1160 [32];
  int local_468;
  int local_464;
  int local_460;
  int local_45c;
  byte *local_458;
  undefined4 local_448 [256];
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)auStack1160;
  uVar9 = 0;
  local_460 = 0;
  lVar18 = (longlong)param_2;
  local_464 = 0;
  local_468 = 0;
  local_458 = param_1;
  memset(local_448,0,0x400);
  iVar7 = (int)(param_3 & 0xffffffff);
  lVar8 = (longlong)(param_2 * iVar7);
  iVar4 = 0;
  if (0 < param_2 * iVar7) {
    lVar10 = param_4 - (longlong)param_1;
    uVar14 = uVar9;
    uVar16 = uVar9;
    do {
      if (param_1[lVar10] != 0) {
        uVar14 = (ulonglong)((int)uVar14 + (uint)*param_1);
        uVar16 = (ulonglong)((int)uVar16 + 1);
      }
      iVar4 = (int)uVar16;
      local_460 = (int)uVar14;
      param_1 = param_1 + 1;
      lVar8 = lVar8 + -1;
    } while (lVar8 != 0);
  }
  local_460 = local_460 / (iVar4 + 1);
  uVar14 = uVar9;
  uVar16 = uVar9;
  iVar4 = local_464;
  if (0 < param_2) {
    do {
      cVar11 = '\0';
      cVar6 = '\0';
      cVar15 = '\0';
      iVar4 = 0;
      if (1 < iVar7) {
        pcVar5 = (char *)(uVar14 + param_4);
        uVar2 = (iVar7 - 2U >> 1) + 1;
        uVar13 = (ulonglong)uVar2;
        iVar4 = uVar2 * 2;
        do {
          cVar11 = cVar11 + *pcVar5;
          cVar6 = cVar6 + pcVar5[lVar18];
          pcVar5 = pcVar5 + param_2 * 2;
          uVar13 = uVar13 - 1;
        } while (uVar13 != 0);
      }
      if (iVar4 < iVar7) {
        cVar15 = *(char *)((longlong)(param_2 * iVar4) + uVar14 + param_4);
      }
      iVar4 = (int)uVar16;
      if ((char)(cVar6 + cVar11 + cVar15) != '\0') break;
      uVar14 = uVar14 + 1;
      uVar16 = (ulonglong)((int)uVar16 + 1);
      iVar4 = local_464;
    } while ((longlong)uVar14 < lVar18);
  }
  local_464 = iVar4;
  local_45c = param_2 + -1;
  uVar16 = SEXT48(local_45c);
  uVar14 = uVar16;
  iVar4 = 0;
  iVar1 = local_468;
  if (0 < local_45c) {
    do {
      cVar11 = '\0';
      cVar6 = '\0';
      cVar15 = '\0';
      iVar4 = 0;
      if (1 < iVar7) {
        pcVar5 = (char *)(uVar16 + param_4);
        uVar2 = (iVar7 - 2U >> 1) + 1;
        uVar13 = (ulonglong)uVar2;
        iVar4 = uVar2 * 2;
        do {
          cVar11 = cVar11 + *pcVar5;
          cVar6 = cVar6 + pcVar5[lVar18];
          pcVar5 = pcVar5 + param_2 * 2;
          uVar13 = uVar13 - 1;
        } while (uVar13 != 0);
      }
      if (iVar4 < iVar7) {
        cVar15 = *(char *)((longlong)(param_2 * iVar4) + uVar16 + param_4);
      }
      iVar4 = (int)uVar14;
      iVar1 = iVar4;
      if ((char)(cVar6 + cVar11 + cVar15) != '\0') break;
      uVar16 = uVar16 - 1;
      uVar14 = (ulonglong)(iVar4 - 1);
      iVar4 = 0;
      iVar1 = local_468;
    } while (0 < (longlong)uVar16);
  }
  local_468 = iVar1;
  lVar8 = (longlong)local_464;
  lVar10 = (longlong)iVar4;
  if (lVar8 <= lVar10) {
    puVar17 = local_448 + lVar8;
    pbVar12 = local_458 + lVar8;
    lVar8 = (lVar10 - lVar8) + 1;
    do {
      uVar14 = uVar9;
      uVar16 = uVar9;
      uVar13 = param_3 & 0xffffffff;
      if (0 < iVar7) {
        do {
          uVar3 = (longlong)local_460;
          if (pbVar12[uVar14 + (param_4 - (longlong)local_458)] != 0) {
            uVar3 = (ulonglong)pbVar12[uVar14];
          }
          uVar16 = uVar16 + uVar3;
          uVar13 = uVar13 - 1;
          uVar14 = uVar14 + lVar18;
        } while (uVar13 != 0);
      }
      pbVar12 = pbVar12 + 1;
      *puVar17 = (int)((longlong)(uVar16 << 8) / (longlong)iVar7);
      puVar17 = puVar17 + 1;
      lVar8 = lVar8 + -1;
      iVar4 = local_468;
    } while (lVar8 != 0);
  }
  iVar7 = local_464;
  if ((local_464 < iVar4) && (7 < (uint)(iVar4 - local_464))) {
    uVar2 = iVar4 - local_464 & 0x80000007;
    if ((int)uVar2 < 0) {
      uVar2 = (uVar2 - 1 | 0xfffffff8) + 1;
    }
    do {
      iVar7 = iVar7 + 8;
    } while (iVar7 < (int)(iVar4 - uVar2));
  }
  lVar8 = (longlong)iVar7;
  while (lVar8 < lVar10) {
    lVar8 = lVar8 + 1;
  }
  FUN_18005f100(local_48 ^ (ulonglong)auStack1160);
  return;
}



void FUN_1800244d0(longlong param_1,uint param_2,int param_3,longlong param_4,longlong param_5)

{
  longlong lVar1;
  ushort uVar2;
  ushort uVar3;
  ushort uVar4;
  ushort uVar5;
  longlong lVar6;
  ushort *puVar7;
  ushort *puVar8;
  ushort *puVar9;
  int iVar10;
  longlong lVar11;
  ushort *puVar12;
  ushort *puVar13;
  ushort *puVar14;
  int iVar15;
  ulonglong local_78;

  if (0 < (int)param_2) {
    puVar9 = (ushort *)(param_5 + 2);
    iVar15 = param_3 + -1;
    lVar1 = (param_4 - param_1) + 0xc;
    lVar6 = (longlong)iVar15;
    local_78 = (ulonglong)param_2;
    do {
      uVar4 = 0;
      uVar5 = 0xffff;
      puVar13 = (ushort *)((longlong)puVar9 + (param_1 - param_5) + -2);
      lVar11 = 6;
      do {
        uVar2 = *puVar13;
        uVar3 = uVar2;
        if (uVar5 <= uVar2) {
          uVar3 = uVar5;
        }
        uVar5 = uVar3;
        if (uVar2 < uVar4) {
          uVar2 = uVar4;
        }
        uVar4 = uVar2;
        puVar13 = puVar13 + 1;
        lVar11 = lVar11 + -1;
      } while (lVar11 != 0);
      *(ushort *)((longlong)puVar9 + (param_4 - param_5) + -2) = uVar5;
      puVar9[-1] = uVar4;
      puVar14 = (ushort *)((param_4 - param_5) + (longlong)puVar9);
      lVar11 = 5;
      iVar10 = 6;
      puVar12 = puVar9;
      do {
        puVar8 = puVar13;
        uVar5 = *puVar8;
        if (puVar14[-1] < uVar5 || puVar14[-1] == uVar5) {
          uVar5 = puVar14[-1];
        }
        *puVar14 = uVar5;
        uVar5 = puVar12[-1];
        if (puVar12[-1] <= *puVar8) {
          uVar5 = *puVar8;
        }
        puVar13 = puVar8 + 1;
        *puVar12 = uVar5;
        puVar14 = puVar14 + 1;
        puVar12 = puVar12 + 1;
        lVar11 = lVar11 + -1;
      } while (lVar11 != 0);
      if (6 < param_3 + -5) {
        puVar8 = puVar8 + -9;
        do {
          uVar5 = puVar14[-1];
          if (uVar5 == puVar8[-1]) {
            lVar11 = 0xb;
            uVar5 = puVar12[-1];
            if (puVar12[-1] <= *puVar13) {
              uVar5 = *puVar13;
            }
            *puVar12 = uVar5;
            uVar5 = 0xffff;
            puVar7 = puVar8;
            do {
              uVar4 = *puVar7;
              if (uVar5 <= *puVar7) {
                uVar4 = uVar5;
              }
              uVar5 = uVar4;
              puVar7 = puVar7 + 1;
              lVar11 = lVar11 + -1;
            } while (lVar11 != 0);
            *puVar14 = uVar5;
          }
          else {
            uVar4 = *puVar13;
            if (puVar12[-1] == puVar8[-1]) {
              lVar11 = 0xb;
              if (uVar5 <= uVar4) {
                uVar4 = uVar5;
              }
              *puVar14 = uVar4;
              uVar5 = 0;
              puVar7 = puVar8;
              do {
                uVar4 = *puVar7;
                if (*puVar7 < uVar5) {
                  uVar4 = uVar5;
                }
                uVar5 = uVar4;
                puVar7 = puVar7 + 1;
                lVar11 = lVar11 + -1;
              } while (lVar11 != 0);
              *puVar12 = uVar5;
            }
            else {
              if (uVar5 <= uVar4) {
                uVar4 = uVar5;
              }
              *puVar14 = uVar4;
              uVar5 = puVar12[-1];
              if (puVar12[-1] <= *puVar13) {
                uVar5 = *puVar13;
              }
              *puVar12 = uVar5;
            }
          }
          puVar13 = puVar13 + 1;
          puVar8 = puVar8 + 1;
          puVar14 = puVar14 + 1;
          puVar12 = puVar12 + 1;
          iVar10 = iVar10 + 1;
        } while (iVar10 < param_3 + -5);
      }
      uVar4 = 0xffff;
      uVar5 = 0;
      puVar13 = (ushort *)((lVar6 * 2 - param_5) + -2 + param_1 + (longlong)puVar9);
      lVar11 = 6;
      do {
        uVar2 = *puVar13;
        puVar13 = puVar13 + -1;
        uVar3 = uVar2;
        if (uVar4 < uVar2) {
          uVar3 = uVar4;
        }
        uVar4 = uVar3;
        if (uVar2 <= uVar5) {
          uVar2 = uVar5;
        }
        uVar5 = uVar2;
        lVar11 = lVar11 + -1;
      } while (lVar11 != 0);
      *(ushort *)(param_4 + (longlong)iVar15 * 2) = uVar4;
      lVar11 = 4;
      *(ushort *)(param_5 + (longlong)iVar15 * 2) = uVar5;
      puVar13 = (ushort *)(param_1 + -10 + (longlong)(iVar15 + -1) * 2);
      do {
        uVar5 = *puVar13;
        puVar12 = (ushort *)(lVar1 + (longlong)puVar13);
        if (*puVar12 < uVar5 || *puVar12 == uVar5) {
          uVar5 = *(ushort *)(lVar1 + (longlong)puVar13);
        }
        *(ushort *)((longlong)puVar13 + (param_4 - param_1) + 10) = uVar5;
        uVar5 = *(ushort *)((param_5 - param_1) + 0xc + (longlong)puVar13);
        if (uVar5 < *puVar13 || uVar5 == *puVar13) {
          uVar5 = *puVar13;
        }
        *(ushort *)((param_5 - param_1) + 10 + (longlong)puVar13) = uVar5;
        puVar13 = puVar13 + -1;
        lVar11 = lVar11 + -1;
      } while (lVar11 != 0);
      puVar9 = puVar9 + param_3;
      iVar15 = iVar15 + param_3;
      local_78 = local_78 - 1;
    } while (local_78 != 0);
  }
  return;
}



void FUN_180024810(ushort *param_1,int param_2,ulonglong param_3,longlong param_4,longlong param_5)

{
  ushort uVar1;
  ushort uVar2;
  ushort uVar3;
  longlong lVar4;
  longlong lVar5;
  int iVar6;
  ushort *puVar7;
  longlong lVar8;
  ulonglong uVar9;
  int iVar10;
  ushort uVar11;
  ushort *puVar12;
  ushort *puVar13;
  longlong lVar14;
  longlong lVar15;
  longlong lVar16;
  ushort *puVar17;
  ushort *puVar18;
  longlong lVar19;
  ulonglong local_68;

  local_68 = param_3 & 0xffffffff;
  iVar10 = (int)local_68;
  if (0 < iVar10) {
    lVar14 = (longlong)iVar10;
    lVar15 = (longlong)((param_2 + -1) * iVar10);
    puVar18 = (ushort *)(lVar14 * 2 + param_4);
    lVar4 = (lVar15 * 2 + lVar14 * -2) - param_4;
    lVar8 = (longlong)param_1 + ((iVar10 * 5 + lVar14) * -2 - param_4);
    lVar5 = lVar4 + (longlong)param_1;
    lVar19 = (param_5 + lVar14 * -2) - param_4;
    do {
      uVar3 = 0;
      uVar11 = 0xffff;
      lVar16 = 6;
      puVar13 = param_1;
      do {
        uVar1 = *puVar13;
        uVar2 = uVar1;
        if (uVar11 < uVar1) {
          uVar2 = uVar11;
        }
        uVar11 = uVar2;
        if (uVar1 <= uVar3) {
          uVar1 = uVar3;
        }
        uVar3 = uVar1;
        puVar13 = puVar13 + lVar14;
        lVar16 = lVar16 + -1;
      } while (lVar16 != 0);
      puVar17 = (ushort *)((longlong)puVar18 + (param_5 - param_4));
      puVar18[-lVar14] = uVar11;
      *(ushort *)((longlong)puVar18 + lVar19) = uVar3;
      lVar16 = 5;
      puVar7 = puVar18;
      do {
        uVar3 = *puVar13;
        if (puVar7[-lVar14] <= *puVar13) {
          uVar3 = puVar7[-lVar14];
        }
        *puVar7 = uVar3;
        uVar3 = puVar17[-lVar14];
        if (uVar3 < *puVar13 || uVar3 == *puVar13) {
          uVar3 = *puVar13;
        }
        puVar13 = puVar13 + lVar14;
        *puVar17 = uVar3;
        puVar7 = puVar7 + lVar14;
        puVar17 = puVar17 + lVar14;
        lVar16 = lVar16 + -1;
      } while (lVar16 != 0);
      if (6 < param_2 + -5) {
        uVar9 = (ulonglong)(param_2 - 0xb);
        do {
          uVar3 = puVar7[-lVar14];
          if (puVar13[-(longlong)(iVar10 * 0xb)] == uVar3) {
            uVar3 = puVar17[-lVar14];
            if (uVar3 < *puVar13 || uVar3 == *puVar13) {
              uVar3 = *puVar13;
            }
            iVar6 = iVar10 * -10;
            *puVar17 = uVar3;
            uVar3 = 0xffff;
            if (iVar6 < 1) {
              puVar12 = puVar13 + iVar6;
              do {
                uVar11 = *puVar12;
                if (uVar3 < *puVar12) {
                  uVar11 = uVar3;
                }
                uVar3 = uVar11;
                iVar6 = iVar6 + iVar10;
                puVar12 = puVar12 + lVar14;
              } while (iVar6 < 1);
            }
            *puVar7 = uVar3;
          }
          else {
            uVar11 = *puVar13;
            if (puVar13[-(longlong)(iVar10 * 0xb)] == puVar17[-lVar14]) {
              if (uVar3 <= uVar11) {
                uVar11 = uVar3;
              }
              iVar6 = iVar10 * -10;
              *puVar7 = uVar11;
              uVar3 = 0;
              if (iVar6 < 1) {
                puVar12 = puVar13 + iVar6;
                do {
                  uVar11 = *puVar12;
                  if (*puVar12 <= uVar3) {
                    uVar11 = uVar3;
                  }
                  uVar3 = uVar11;
                  iVar6 = iVar6 + iVar10;
                  puVar12 = puVar12 + lVar14;
                } while (iVar6 < 1);
              }
              *puVar17 = uVar3;
            }
            else {
              if (uVar3 <= uVar11) {
                uVar11 = uVar3;
              }
              *puVar7 = uVar11;
              uVar3 = puVar17[-lVar14];
              if (uVar3 < *puVar13 || uVar3 == *puVar13) {
                uVar3 = *puVar13;
              }
              *puVar17 = uVar3;
            }
          }
          puVar7 = puVar7 + lVar14;
          puVar17 = puVar17 + lVar14;
          puVar13 = puVar13 + lVar14;
          uVar9 = uVar9 - 1;
        } while (uVar9 != 0);
      }
      uVar11 = 0xffff;
      uVar3 = 0;
      puVar13 = (ushort *)(lVar5 + (longlong)puVar18);
      lVar16 = 6;
      do {
        uVar1 = *puVar13;
        uVar2 = uVar1;
        if (uVar11 < uVar1) {
          uVar2 = uVar11;
        }
        uVar11 = uVar2;
        if (uVar1 <= uVar3) {
          uVar1 = uVar3;
        }
        uVar3 = uVar1;
        puVar13 = puVar13 + -lVar14;
        lVar16 = lVar16 + -1;
      } while (lVar16 != 0);
      puVar13 = puVar18 + (lVar15 - lVar14);
      *puVar13 = uVar11;
      lVar16 = 4;
      *(ushort *)((longlong)puVar18 + param_5 + lVar4) = uVar3;
      do {
        uVar11 = *(ushort *)(lVar8 + (longlong)puVar13);
        uVar3 = uVar11;
        if (*puVar13 < uVar11 || *puVar13 == uVar11) {
          uVar3 = *puVar13;
        }
        puVar13[-lVar14] = uVar3;
        uVar3 = *(ushort *)((param_5 - param_4) + (longlong)puVar13);
        if (uVar3 <= uVar11) {
          uVar3 = uVar11;
        }
        *(ushort *)(lVar19 + (longlong)puVar13) = uVar3;
        puVar13 = puVar13 + -lVar14;
        lVar16 = lVar16 + -1;
      } while (lVar16 != 0);
      param_1 = param_1 + 1;
      puVar18 = puVar18 + 1;
      local_68 = local_68 - 1;
    } while (local_68 != 0);
  }
  return;
}



void FUN_180024b80(ushort *param_1,ushort *param_2,int param_3,uint param_4,ushort *param_5,
                  ushort *param_6)

{
  ushort uVar1;
  ushort *puVar2;
  ushort *puVar3;
  int iVar4;
  ulonglong uVar5;
  ushort *puVar6;
  ushort *puVar7;
  ushort uVar8;
  ushort *puVar9;
  ushort uVar10;
  longlong lVar11;
  ulonglong uVar12;
  ulonglong uVar13;
  ulonglong uVar14;
  ushort *puVar15;

  puVar3 = param_2 + 1;
  uVar5 = SEXT48((int)param_4);
  lVar11 = (longlong)(int)(param_4 + 1);
  iVar4 = param_4 - 1;
  uVar10 = *param_1;
  if (param_1[lVar11] < uVar10 || param_1[lVar11] == uVar10) {
    uVar10 = param_1[lVar11];
  }
  *param_5 = uVar10;
  uVar10 = param_2[lVar11];
  if (uVar10 < *param_2 || uVar10 == *param_2) {
    uVar10 = *param_2;
  }
  puVar2 = param_1 + 1;
  *param_6 = uVar10;
  puVar7 = param_5 + 1;
  puVar9 = param_6 + 1;
  if (1 < iVar4) {
    uVar12 = (ulonglong)(param_4 - 2);
    do {
      uVar10 = *puVar2;
      uVar8 = puVar3[uVar5 - 1];
      if (puVar2[uVar5 - 1] < uVar10 || puVar2[uVar5 - 1] == uVar10) {
        uVar10 = puVar2[uVar5 - 1];
      }
      if (uVar8 < *puVar3 || uVar8 == *puVar3) {
        uVar8 = *puVar3;
      }
      uVar1 = puVar2[uVar5 + 1];
      if (uVar10 < puVar2[uVar5 + 1]) {
        uVar1 = uVar10;
      }
      *puVar7 = uVar1;
      uVar10 = puVar3[uVar5 + 1];
      if (puVar3[uVar5 + 1] <= uVar8) {
        uVar10 = uVar8;
      }
      puVar2 = puVar2 + 1;
      *puVar9 = uVar10;
      puVar3 = puVar3 + 1;
      puVar9 = puVar9 + 1;
      puVar7 = puVar7 + 1;
      uVar12 = uVar12 - 1;
    } while (uVar12 != 0);
  }
  lVar11 = (longlong)iVar4;
  uVar10 = *puVar2;
  if (puVar2[lVar11] < uVar10 || puVar2[lVar11] == uVar10) {
    uVar10 = puVar2[lVar11];
  }
  *puVar7 = uVar10;
  uVar10 = puVar3[lVar11];
  if (uVar10 < *puVar3 || uVar10 == *puVar3) {
    uVar10 = *puVar3;
  }
  puVar2 = puVar2 + 1;
  *puVar9 = uVar10;
  puVar3 = puVar3 + 1;
  puVar9 = puVar9 + 1;
  puVar7 = puVar7 + 1;
  if (1 < param_3 + -1) {
    uVar13 = (ulonglong)(param_3 - 2);
    uVar12 = ~uVar5;
    do {
      uVar10 = puVar2[uVar5 + 1];
      uVar8 = puVar3[1 - uVar5];
      if (puVar2[1 - uVar5] < uVar10 || puVar2[1 - uVar5] == uVar10) {
        uVar10 = puVar2[1 - uVar5];
      }
      if (uVar8 < puVar3[uVar5 + 1] || uVar8 == puVar3[uVar5 + 1]) {
        uVar8 = puVar3[uVar5 + 1];
      }
      if (*puVar2 < uVar10 || *puVar2 == uVar10) {
        uVar10 = *puVar2;
      }
      *puVar7 = uVar10;
      uVar10 = *puVar3;
      if (*puVar3 <= uVar8) {
        uVar10 = uVar8;
      }
      puVar2 = puVar2 + 1;
      *puVar9 = uVar10;
      puVar3 = puVar3 + 1;
      puVar9 = puVar9 + 1;
      puVar7 = puVar7 + 1;
      if (1 < iVar4) {
        puVar6 = puVar3 + (uVar5 - 1);
        puVar15 = puVar2 + (uVar5 - 1);
        uVar14 = (ulonglong)(param_4 - 2);
        do {
          uVar10 = puVar15[uVar5 * -2 + 2];
          uVar8 = *puVar15;
          if (puVar2[uVar12] < uVar10 || puVar2[uVar12] == uVar10) {
            uVar10 = puVar2[uVar12];
          }
          if (puVar15[2] < uVar8 || puVar15[2] == uVar8) {
            uVar8 = puVar15[2];
          }
          puVar15 = puVar15 + 1;
          if (uVar10 <= uVar8) {
            uVar8 = uVar10;
          }
          if (*puVar2 < uVar8 || *puVar2 == uVar8) {
            uVar8 = *puVar2;
          }
          *puVar7 = uVar8;
          uVar10 = puVar3[uVar12];
          uVar8 = puVar6[2];
          if (uVar10 < puVar6[uVar5 * -2 + 2] || uVar10 == puVar6[uVar5 * -2 + 2]) {
            uVar10 = puVar6[uVar5 * -2 + 2];
          }
          if (uVar8 < *puVar6 || uVar8 == *puVar6) {
            uVar8 = *puVar6;
          }
          puVar6 = puVar6 + 1;
          if (uVar10 <= uVar8) {
            uVar10 = uVar8;
          }
          uVar8 = *puVar3;
          if (*puVar3 <= uVar10) {
            uVar8 = uVar10;
          }
          puVar2 = puVar2 + 1;
          *puVar9 = uVar8;
          puVar3 = puVar3 + 1;
          puVar9 = puVar9 + 1;
          puVar7 = puVar7 + 1;
          uVar14 = uVar14 - 1;
        } while (uVar14 != 0);
      }
      uVar10 = puVar2[uVar5 - 1];
      uVar8 = puVar3[uVar12];
      if (puVar2[uVar12] < uVar10 || puVar2[uVar12] == uVar10) {
        uVar10 = puVar2[uVar12];
      }
      if (uVar8 < puVar3[uVar5 - 1] || uVar8 == puVar3[uVar5 - 1]) {
        uVar8 = puVar3[uVar5 - 1];
      }
      if (*puVar2 < uVar10 || *puVar2 == uVar10) {
        uVar10 = *puVar2;
      }
      *puVar7 = uVar10;
      uVar10 = *puVar3;
      if (*puVar3 <= uVar8) {
        uVar10 = uVar8;
      }
      puVar2 = puVar2 + 1;
      *puVar9 = uVar10;
      puVar3 = puVar3 + 1;
      puVar9 = puVar9 + 1;
      puVar7 = puVar7 + 1;
      uVar13 = uVar13 - 1;
    } while (uVar13 != 0);
  }
  lVar11 = (longlong)(int)(1 - param_4);
  uVar10 = *puVar2;
  if (puVar2[lVar11] < uVar10 || puVar2[lVar11] == uVar10) {
    uVar10 = puVar2[lVar11];
  }
  *puVar7 = uVar10;
  uVar10 = puVar3[lVar11];
  if (uVar10 < *puVar3 || uVar10 == *puVar3) {
    uVar10 = *puVar3;
  }
  puVar2 = puVar2 + 1;
  *puVar9 = uVar10;
  puVar3 = puVar3 + 1;
  puVar9 = puVar9 + 1;
  puVar7 = puVar7 + 1;
  if (1 < iVar4) {
    uVar13 = ~uVar5;
    uVar12 = (ulonglong)(param_4 - 2);
    do {
      uVar10 = puVar2[1 - uVar5];
      uVar8 = puVar3[uVar13];
      if (puVar2[uVar13] < uVar10 || puVar2[uVar13] == uVar10) {
        uVar10 = puVar2[uVar13];
      }
      if (uVar8 < puVar3[1 - uVar5] || uVar8 == puVar3[1 - uVar5]) {
        uVar8 = puVar3[1 - uVar5];
      }
      if (*puVar2 < uVar10 || *puVar2 == uVar10) {
        uVar10 = *puVar2;
      }
      *puVar7 = uVar10;
      uVar10 = *puVar3;
      if (*puVar3 <= uVar8) {
        uVar10 = uVar8;
      }
      puVar2 = puVar2 + 1;
      *puVar9 = uVar10;
      puVar3 = puVar3 + 1;
      puVar9 = puVar9 + 1;
      puVar7 = puVar7 + 1;
      uVar12 = uVar12 - 1;
    } while (uVar12 != 0);
  }
  lVar11 = (longlong)(int)~param_4;
  uVar10 = *puVar2;
  if (puVar2[lVar11] < uVar10 || puVar2[lVar11] == uVar10) {
    uVar10 = puVar2[lVar11];
  }
  *puVar7 = uVar10;
  uVar10 = puVar3[lVar11];
  if (uVar10 < *puVar3 || uVar10 == *puVar3) {
    uVar10 = *puVar3;
  }
  *puVar9 = uVar10;
  return;
}



void FUN_180024f30(longlong param_1,ushort *param_2,int *param_3,int *param_4)

{
  int iVar1;
  int iVar2;
  longlong lVar3;
  int iVar4;
  longlong lVar5;
  int iVar6;
  int iVar7;
  int iVar8;

  iVar4 = param_3[6];
  iVar7 = 0;
  iVar1 = *param_3;
  lVar3 = (longlong)param_3[2];
  iVar8 = 0;
  iVar6 = 0x32;
  if (iVar4 - 0x3eU < 2) {
    iVar6 = 300;
    if (param_3[5] == 0) {
      iVar6 = 700;
    }
  }
  else {
    if (iVar4 - 9U < 2) {
      iVar6 = 0x78;
    }
  }
  if (0 < param_3[2]) {
    lVar5 = param_1 - (longlong)param_2;
    do {
      iVar2 = (uint)*param_2 - (uint)*(ushort *)(lVar5 + (longlong)param_2);
      if (iVar6 < iVar2) {
        iVar7 = iVar7 + 1;
        iVar8 = iVar8 + iVar2;
      }
      param_2 = param_2 + 1;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
    if (0 < iVar7) {
      iVar8 = iVar8 / iVar7;
      if ((iVar4 - 0x3eU < 2) && (param_3[5] == 0)) {
        iVar4 = (iVar8 * 0x17) / 0x32 + (iVar8 * 0x17 >> 0x1f);
      }
      else {
        iVar4 = iVar8 / 5 + (iVar8 >> 0x1f);
      }
      iVar4 = iVar4 - (iVar4 >> 0x1f);
      iVar8 = iVar1 * 10;
      *param_4 = iVar4;
      if (iVar7 != iVar8 && SBORROW4(iVar7,iVar8) == iVar7 + iVar1 * -10 < 0) {
        return;
      }
      if (iVar6 < iVar4) {
        iVar6 = iVar4;
      }
    }
  }
  *param_4 = iVar6;
  return;
}



int FUN_180025030(longlong param_1)

{
  int *piVar1;
  longlong lVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  uint uVar15;

  iVar6 = 199;
  iVar3 = 0;
  lVar2 = 0;
  iVar7 = 0;
  iVar9 = 0;
  iVar11 = 0;
  iVar13 = 0;
  iVar8 = 0;
  iVar10 = 0;
  iVar12 = 0;
  iVar14 = 0;
  do {
    piVar1 = (int *)(param_1 + 0x4c98 + lVar2 * 4);
    iVar7 = *piVar1 + iVar7;
    iVar9 = piVar1[1] + iVar9;
    iVar11 = piVar1[2] + iVar11;
    iVar13 = piVar1[3] + iVar13;
    piVar1 = (int *)(param_1 + 0x4ca8 + lVar2 * 4);
    lVar2 = lVar2 + 8;
    iVar8 = *piVar1 + iVar8;
    iVar10 = piVar1[1] + iVar10;
    iVar12 = piVar1[2] + iVar12;
    iVar14 = piVar1[3] + iVar14;
  } while (lVar2 < 200);
  iVar4 = 0;
  lVar2 = 0;
  uVar15 = iVar8 + iVar7 + iVar12 + iVar11 + iVar10 + iVar9 + iVar14 + iVar13;
  do {
    iVar3 = iVar3 + *(int *)(param_1 + 0x4c98 + lVar2 * 4);
    iVar7 = iVar4;
    if (uVar15 * 0x1e < (uint)(iVar3 * 100)) break;
    iVar4 = iVar4 + 1;
    lVar2 = lVar2 + 1;
    iVar7 = 199;
  } while (lVar2 < 200);
  uVar5 = 0;
  lVar2 = 199;
  do {
    uVar5 = uVar5 + *(int *)(param_1 + 0x4c98 + lVar2 * 4);
    if (uVar15 / 10 < uVar5) {
      *(int *)(param_1 + 0x4fbc) = iVar7;
      *(int *)(param_1 + 0x4fb8) = iVar6;
      return uVar15 * -0x33333333;
    }
    iVar6 = iVar6 + -1;
    lVar2 = lVar2 + -1;
  } while (-1 < lVar2);
  *(undefined4 *)(param_1 + 0x4fb8) = 0;
  *(int *)(param_1 + 0x4fbc) = iVar7;
  return uVar15 * -0x33333333;
}



void FUN_180025130(undefined *param_1,undefined *param_2,undefined8 param_3,int *param_4)

{
  longlong lVar1;
  uint uVar2;
  int iVar3;
  int *_Memory;
  ulonglong uVar4;
  undefined *puVar5;
  ulonglong uVar6;
  int local_38;
  int local_34;
  int local_30;
  uint local_2c;
  undefined4 local_28;
  undefined *local_20;

  local_34 = param_4[1];
  local_38 = *param_4;
  uVar2 = param_4[2] * 2;
  uVar6 = (ulonglong)uVar2;
  if ((((param_2 != (undefined *)0x0) && (param_1 != (undefined *)0x0)) && (uVar2 != 0)) &&
     (((param_1 + uVar6 <= param_2 || (param_2 + uVar6 <= param_1)) && (uVar2 != 0)))) {
    uVar4 = uVar6;
    puVar5 = param_2;
    do {
      *puVar5 = (param_1 + -(longlong)param_2)[(longlong)puVar5];
      puVar5 = puVar5 + 1;
      uVar4 = uVar4 - 1;
    } while (uVar4 != 0);
  }
  if (param_4[5] == 0) {
    iVar3 = local_38 * local_34 * 2;
    _Memory = (int *)malloc((longlong)iVar3 + 0x20);
    if (_Memory != (int *)0x0) {
      _Memory[3] = iVar3;
      *_Memory = local_38;
      _Memory[1] = local_34;
      _Memory[4] = 2;
      _Memory[2] = local_38 * 2;
      *(int **)(_Memory + 6) = _Memory + 8;
    }
    local_30 = local_38 * 2;
    local_28 = 2;
    local_2c = uVar2;
    local_20 = param_2;
    FUN_1800395b0((ulonglong *)&local_38,_Memory,0xffffffffffffffff,10,-1,-1);
    puVar5 = *(undefined **)(_Memory + 6);
    if (((param_2 != (undefined *)0x0) && (puVar5 != (undefined *)0x0)) &&
       ((uVar2 != 0 &&
        (((puVar5 + uVar6 <= param_2 || (param_2 + uVar6 <= puVar5)) && (uVar2 != 0)))))) {
      lVar1 = -(longlong)param_2;
      do {
        *param_2 = param_2[(longlong)(puVar5 + lVar1)];
        param_2 = param_2 + 1;
        uVar6 = uVar6 - 1;
      } while (uVar6 != 0);
    }
    free(_Memory);
  }
  return;
}



void FUN_1800252b0(undefined *param_1,undefined8 param_2,uint *param_3,longlong param_4)

{
  ushort *puVar1;
  ushort uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  undefined8 uVar8;
  ushort *puVar9;
  uint uVar10;
  longlong lVar11;
  longlong lVar12;
  void *pvVar13;
  undefined *puVar14;
  undefined *puVar15;
  undefined *puVar16;
  uint *_Memory;
  undefined8 *puVar17;
  ushort uVar18;
  int iVar19;
  ulonglong uVar20;
  ulonglong uVar21;
  undefined *puVar22;
  ushort *puVar23;
  longlong lVar24;
  undefined8 *puVar25;
  longlong lVar26;
  undefined8 *puVar27;
  char cVar28;
  size_t _Size;
  longlong lVar29;
  undefined8 *puVar30;
  undefined4 *puVar31;
  ushort *puVar32;
  ushort *_Memory_00;
  ushort *puVar33;
  ushort *_Memory_01;
  longlong alStackX16 [3];
  undefined8 uStack64;

  uStack64 = 0x1800252ca;
  lVar12 = _alloca_probe();
  lVar12 = -lVar12;
  *(ulonglong *)(&stack0x00009988 + lVar12) =
       DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffc8 + lVar12);
  uVar3 = param_3[1];
  uVar4 = *param_3;
  *(undefined8 *)((longlong)alStackX16 + lVar12 + 0x10) = *(undefined8 *)(&stack0x000099f8 + lVar12)
  ;
  uVar5 = param_3[2];
  *(longlong *)((longlong)alStackX16 + lVar12) = param_4;
  *(undefined8 *)(&stack0x00000008 + lVar12) = param_2;
  *(uint *)((longlong)alStackX16 + lVar12 + -0x10) = uVar5;
  uVar5 = uVar5 * 2;
  uVar21 = (ulonglong)uVar5;
  _Size = SEXT48((int)uVar5);
  *(undefined8 *)((longlong)&uStack64 + lVar12) = 0x18002531a;
  pvVar13 = malloc(_Size,*(undefined *)((longlong)&uStack64 + lVar12));
  *(void **)(&stack0xfffffffffffffff8 + lVar12) = pvVar13;
  *(undefined8 *)((longlong)&uStack64 + lVar12) = 0x180025328;
  puVar14 = (undefined *)malloc(_Size,*(undefined *)((longlong)&uStack64 + lVar12));
  *(undefined **)(&stack0x00000030 + lVar12) = puVar14;
  *(undefined8 *)((longlong)&uStack64 + lVar12) = 0x180025339;
  puVar15 = (undefined *)malloc(_Size,*(undefined *)((longlong)&uStack64 + lVar12));
  *(undefined **)(&stack0x00000028 + lVar12) = puVar15;
  *(undefined8 *)((longlong)&uStack64 + lVar12) = 0x18002534a;
  puVar16 = (undefined *)malloc(_Size,*(undefined *)((longlong)&uStack64 + lVar12));
  *(undefined **)(&stack0x00000038 + lVar12) = puVar16;
  puVar22 = *(undefined **)(&stack0xfffffffffffffff8 + lVar12);
  if ((puVar22 != (undefined *)0x0) && (uVar20 = uVar21, uVar5 != 0)) {
    while (uVar20 != 0) {
      *puVar22 = 0;
      uVar20 = uVar20 - 1;
      puVar22 = puVar22 + 1;
    }
  }
  if ((puVar14 != (undefined *)0x0) && (uVar20 = uVar21, uVar5 != 0)) {
    while (uVar20 != 0) {
      *puVar14 = 0;
      uVar20 = uVar20 - 1;
      puVar14 = puVar14 + 1;
    }
  }
  if ((puVar15 != (undefined *)0x0) && (uVar20 = uVar21, uVar5 != 0)) {
    while (uVar20 != 0) {
      *puVar15 = 0;
      uVar20 = uVar20 - 1;
      puVar15 = puVar15 + 1;
    }
  }
  if ((puVar16 != (undefined *)0x0) && (uVar5 != 0)) {
    while (uVar21 != 0) {
      uVar21 = uVar21 - 1;
      *puVar16 = 0;
      puVar16 = puVar16 + 1;
    }
  }
  *(undefined8 *)((longlong)&uStack64 + lVar12) = 0x1800253b4;
  memset(&stack0x00000068 + lVar12,0,0x9920,*(undefined *)((longlong)&uStack64 + lVar12));
  uVar5 = param_3[1];
  uVar6 = *param_3;
  uVar7 = param_3[5];
  uVar10 = param_3[2] * 2;
  uVar21 = (ulonglong)uVar10;
  if (((((undefined8 *)param_1 != (undefined8 *)0x0) && (uVar10 != 0)) &&
      (((undefined *)(uVar21 + (longlong)param_1) <= &stack0x00000068 + lVar12 ||
       (&stack0x00000068 + uVar21 + lVar12 <= param_1)))) && (uVar10 != 0)) {
    *(undefined8 *)((longlong)&uStack64 + lVar12) = 0x180025405;
    memcpy_FUN_180061f90
              ((undefined8 *)(&stack0x00000068 + lVar12),(undefined8 *)param_1,uVar21,
               *(undefined *)((longlong)&uStack64 + lVar12));
  }
  if (uVar7 == 0) {
    uVar7 = uVar6 * uVar5 * 2;
    *(undefined8 *)((longlong)&uStack64 + lVar12) = 0x180025423;
    _Memory = (uint *)malloc((longlong)(int)uVar7 + 0x20,
                             *(undefined *)((longlong)&uStack64 + lVar12));
    if (_Memory != (uint *)0x0) {
      _Memory[3] = uVar7;
      *_Memory = uVar6;
      _Memory[1] = uVar5;
      _Memory[4] = 2;
      _Memory[2] = uVar6 * 2;
      *(uint **)(_Memory + 6) = _Memory + 8;
    }
    *(undefined8 *)((longlong)alStackX16 + lVar12 + 8) = 0xffffffffffffffff;
    uVar8 = *(undefined8 *)((longlong)alStackX16 + lVar12 + 8);
    *(uint *)(&stack0x00000048 + lVar12) = uVar6 * 2;
    *(undefined4 *)(&stack0xfffffffffffffff0 + lVar12) = 0xffffffff;
    *(undefined **)(&stack0x00000058 + lVar12) = &stack0x00000068 + lVar12;
    *(uint *)(&stack0x00000040 + lVar12) = uVar6;
    *(uint *)(&stack0x00000044 + lVar12) = uVar5;
    *(uint *)(&stack0x0000004c + lVar12) = uVar10;
    *(undefined4 *)(&stack0x00000050 + lVar12) = 2;
    *(undefined4 *)(&stack0xffffffffffffffe8 + lVar12) = 0xffffffff;
    *(undefined8 *)((longlong)&uStack64 + lVar12) = 0x1800254b3;
    FUN_1800395b0((ulonglong *)(&stack0x00000040 + lVar12),(int *)_Memory,uVar8,10,
                  *(int *)(&stack0xffffffffffffffe8 + lVar12),
                  *(int *)(&stack0xfffffffffffffff0 + lVar12));
    puVar16 = *(undefined **)(_Memory + 6);
    puVar22 = &stack0x00000068 + lVar12;
    if (((puVar16 != (undefined *)0x0) && (uVar10 != 0)) &&
       (((puVar16 + uVar21 <= &stack0x00000068 + lVar12 ||
         (&stack0x00000068 + uVar21 + lVar12 <= puVar16)) && (uVar10 != 0)))) {
      do {
        *puVar22 = puVar22[(longlong)(puVar16 + -(longlong)(&stack0x00000068 + lVar12))];
        puVar22 = puVar22 + 1;
        uVar21 = uVar21 - 1;
      } while (uVar21 != 0);
    }
    *(undefined8 *)((longlong)&uStack64 + lVar12) = 0x180025519;
    free(_Memory,*(undefined *)((longlong)&uStack64 + lVar12));
  }
  puVar33 = *(ushort **)(&stack0xfffffffffffffff8 + lVar12);
  _Memory_01 = *(ushort **)(&stack0x00000030 + lVar12);
  *(ushort **)(&stack0xffffffffffffffe8 + lVar12) = _Memory_01;
  *(undefined8 *)((longlong)&uStack64 + lVar12) = 0x18002553e;
  FUN_1800244d0((longlong)(&stack0x00000068 + lVar12),uVar3,uVar4,(longlong)puVar33,
                *(longlong *)(&stack0xffffffffffffffe8 + lVar12));
  _Memory_00 = *(ushort **)(&stack0x00000028 + lVar12);
  puVar9 = *(ushort **)(&stack0x00000038 + lVar12);
  *(ushort **)(&stack0xffffffffffffffe8 + lVar12) = puVar9;
  *(undefined8 *)((longlong)&uStack64 + lVar12) = 0x180025563;
  FUN_180024810((ushort *)(&stack0x00000068 + lVar12),uVar3,(ulonglong)uVar4,(longlong)_Memory_00,
                *(longlong *)(&stack0xffffffffffffffe8 + lVar12));
  lVar26 = (longlong)*(int *)((longlong)alStackX16 + lVar12 + -0x10);
  if (0 < lVar26) {
    puVar32 = (ushort *)((longlong)puVar9 - (longlong)_Memory_01);
    puVar23 = _Memory_01;
    lVar29 = lVar26;
    do {
      uVar18 = *puVar23;
      if (uVar18 < *(ushort *)((longlong)puVar32 + (longlong)puVar23) ||
          uVar18 == *(ushort *)((longlong)puVar32 + (longlong)puVar23)) {
        uVar18 = *(ushort *)((longlong)puVar32 + (longlong)puVar23);
      }
      *puVar23 = uVar18;
      uVar18 = *(ushort *)
                ((longlong)((longlong)_Memory_00 - (longlong)_Memory_01) + (longlong)puVar23);
      puVar1 = (ushort *)
               ((longlong)(ushort *)((longlong)puVar33 - (longlong)_Memory_01) + (longlong)puVar23);
      if (*puVar1 < uVar18 || *puVar1 == uVar18) {
        uVar18 = *(ushort *)
                  ((longlong)(ushort *)((longlong)puVar33 - (longlong)_Memory_01) +
                  (longlong)puVar23);
      }
      *(ushort *)((longlong)puVar32 + (longlong)puVar23) = uVar18;
      puVar23 = puVar23 + 1;
      lVar29 = lVar29 + -1;
    } while (lVar29 != 0);
    puVar33 = *(ushort **)(&stack0xfffffffffffffff8 + lVar12);
  }
  *(ushort **)(&stack0xfffffffffffffff0 + lVar12) = _Memory_00;
  *(ushort **)(&stack0xffffffffffffffe8 + lVar12) = puVar33;
  *(undefined8 *)((longlong)&uStack64 + lVar12) = 0x1800255e0;
  FUN_180024b80(_Memory_01,puVar9,uVar3,uVar4,*(ushort **)(&stack0xffffffffffffffe8 + lVar12),
                *(ushort **)(&stack0xfffffffffffffff0 + lVar12));
  puVar31 = *(undefined4 **)((longlong)alStackX16 + lVar12 + 0x10);
  puVar27 = (undefined8 *)0x0;
  iVar19 = 0;
  puVar25 = puVar27;
  if (puVar31 != (undefined4 *)0x0) {
    *puVar31 = 0;
    puVar31[0x13ee] = 100;
    puVar31[0x13ef] = 100;
    puVar31[0x13f0] = uVar4 * uVar3;
    if ((undefined8 *)(puVar31 + 0x1326) != (undefined8 *)0x0) {
      lVar29 = 0xc;
      puVar25 = (undefined8 *)(puVar31 + 0x1326);
      do {
        puVar30 = puVar25;
        *puVar30 = 0;
        puVar30[1] = 0;
        puVar30[2] = 0;
        puVar30[3] = 0;
        puVar30[4] = 0;
        puVar30[5] = 0;
        puVar30[6] = 0;
        puVar30[7] = 0;
        lVar29 = lVar29 + -1;
        puVar25 = puVar30 + 8;
      } while (lVar29 != 0);
      puVar30[8] = 0;
      puVar30[9] = 0;
      puVar30[10] = 0;
      puVar30[0xb] = 0;
    }
    puVar25 = (undefined8 *)(puVar31 + 2);
    if (puVar25 != (undefined8 *)0x0) {
      lVar29 = 0x132;
      puVar30 = puVar25;
      do {
        puVar17 = puVar30;
        *puVar17 = 0;
        puVar17[1] = 0;
        puVar17[2] = 0;
        puVar17[3] = 0;
        puVar17[4] = 0;
        puVar17[5] = 0;
        puVar17[6] = 0;
        puVar17[7] = 0;
        lVar29 = lVar29 + -1;
        puVar30 = puVar17 + 8;
      } while (lVar29 != 0);
      puVar17[8] = 0;
      puVar17[9] = 0;
    }
  }
  lVar29 = *(longlong *)((longlong)alStackX16 + lVar12) + 0xc;
  *(longlong *)((longlong)alStackX16 + lVar12) = lVar29;
  if (0 < lVar26) {
    lVar11 = lVar12 - (longlong)_Memory_00;
    puVar33 = (ushort *)((longlong)puVar33 - (longlong)_Memory_00);
    *(longlong *)(&stack0x00000008 + lVar12) =
         *(longlong *)(&stack0x00000008 + lVar12) - (longlong)puVar25;
    lVar24 = *(longlong *)(&stack0x00000008 + lVar12);
    puVar30 = puVar25;
    do {
      cVar28 = '\0';
      if (*(char *)((lVar29 - (longlong)puVar25) + (longlong)puVar30) != '\0') {
        uVar18 = *(ushort *)((longlong)puVar33 + (longlong)_Memory_00);
        uVar2 = *_Memory_00;
        if (uVar18 == uVar2) {
          iVar19 = 0xff;
        }
        else {
          iVar19 = (int)(((uint)*(ushort *)(&stack0x00000068 + lVar11 + (longlong)_Memory_00) -
                         (uint)uVar2) * 0xff) / (int)((uint)uVar18 - (uint)uVar2);
        }
        if ((puVar25 != (undefined8 *)0x0) && ((int)((uint)uVar18 - (uint)uVar2) < 0x32)) {
          puVar27 = (undefined8 *)(ulonglong)((int)puVar27 + 1);
          *(undefined *)puVar30 = 0xff;
        }
        lVar24 = *(longlong *)(&stack0x00000008 + lVar12);
        if (iVar19 < 0) {
          cVar28 = '\0';
        }
        else {
          cVar28 = (char)iVar19;
          if (0xff < iVar19) {
            cVar28 = -1;
          }
        }
      }
      iVar19 = (int)puVar27;
      _Memory_00 = _Memory_00 + 1;
      *(char *)(lVar24 + (longlong)puVar30) = -1 - cVar28;
      puVar30 = (undefined8 *)((longlong)puVar30 + 1);
    } while ((longlong)((longlong)puVar30 - (longlong)puVar25) < lVar26);
    puVar31 = *(undefined4 **)((longlong)alStackX16 + lVar12 + 0x10);
    lVar29 = *(longlong *)((longlong)alStackX16 + lVar12);
    _Memory_00 = *(ushort **)(&stack0x00000028 + lVar12);
    _Memory_01 = *(ushort **)(&stack0x00000030 + lVar12);
    puVar33 = *(ushort **)(&stack0xfffffffffffffff8 + lVar12);
  }
  lVar24 = 0;
  if (((puVar31 == (undefined4 *)0x0) ||
      (puVar31[1] = iVar19, iVar19 <= *(int *)((longlong)alStackX16 + lVar12 + -0x10) / 5)) ||
     (*puVar31 = 1, lVar26 < 1)) {
    pvVar13 = *(void **)(&stack0xfffffffffffffff8 + lVar12);
  }
  else {
    pvVar13 = *(void **)(&stack0xfffffffffffffff8 + lVar12);
    do {
      if (*(char *)(lVar24 + lVar29) != '\0') {
        iVar19 = (uint)*puVar33 -
                 (uint)*(ushort *)
                        ((longlong)((longlong)_Memory_00 - (longlong)pvVar13) + (longlong)puVar33);
        if (iVar19 < 200) {
          if (iVar19 < 0) {
            iVar19 = 0;
          }
        }
        else {
          iVar19 = 199;
        }
        puVar31[(longlong)iVar19 + 0x1326] = puVar31[(longlong)iVar19 + 0x1326] + 1;
      }
      lVar24 = lVar24 + 1;
      puVar33 = puVar33 + 1;
    } while (lVar24 < lVar26);
  }
  *(undefined8 *)((longlong)&uStack64 + lVar12) = 0x180025821;
  free(pvVar13,*(undefined *)((longlong)&uStack64 + lVar12));
  *(undefined8 *)((longlong)&uStack64 + lVar12) = 0x18002582a;
  free(_Memory_01,*(undefined *)((longlong)&uStack64 + lVar12));
  *(undefined8 *)((longlong)&uStack64 + lVar12) = 0x180025833;
  free(_Memory_00,*(undefined *)((longlong)&uStack64 + lVar12));
  *(undefined8 *)((longlong)&uStack64 + lVar12) = 0x18002583e;
  free(*(void **)(&stack0x00000038 + lVar12),*(undefined *)((longlong)&uStack64 + lVar12));
  *(undefined8 *)((longlong)&uStack64 + lVar12) = 0x18002584e;
  FUN_18005f100(*(ulonglong *)(&stack0x00009988 + lVar12) ^
                (ulonglong)(&stack0xffffffffffffffc8 + lVar12),
                *(undefined *)((longlong)&uStack64 + lVar12));
  return;
}



void FUN_180025870(longlong param_1,short *param_2,uint param_3,int param_4)

{
  ushort *puVar1;
  short *psVar2;
  longlong lVar3;
  ulonglong uVar4;
  uint uVar5;
  longlong lVar6;
  int iVar7;
  ulonglong uVar8;
  int iVar9;
  longlong lVar10;
  ulonglong uVar11;
  longlong lVar12;

  if (0 < (int)param_3) {
    lVar12 = 0;
    uVar11 = SEXT48(param_4);
    lVar6 = param_1 - (longlong)param_2;
    uVar4 = (ulonglong)param_3;
    do {
      iVar7 = 0;
      iVar9 = 0;
      uVar5 = 0;
      lVar10 = 0;
      if (1 < (longlong)uVar11) {
        lVar3 = (uVar11 - 2 >> 1) + 1;
        lVar10 = lVar3 * 2;
        puVar1 = (ushort *)((longlong)param_2 + lVar6);
        do {
          iVar7 = iVar7 + (uint)*puVar1;
          iVar9 = iVar9 + (uint)puVar1[1];
          lVar3 = lVar3 + -1;
          puVar1 = puVar1 + 2;
        } while (lVar3 != 0);
      }
      if (lVar10 < (longlong)uVar11) {
        uVar5 = (uint)*(ushort *)(param_1 + (lVar12 + lVar10) * 2);
      }
      psVar2 = param_2;
      uVar8 = uVar11;
      if (0 < param_4) {
        do {
          *psVar2 = (*(short *)(lVar6 + (longlong)psVar2) -
                    (short)((ulonglong)(iVar9 + iVar7 + uVar5) / (uVar11 & 0xffffffff))) + 5000;
          uVar8 = uVar8 - 1;
          psVar2 = psVar2 + 1;
        } while (uVar8 != 0);
      }
      lVar12 = lVar12 + uVar11;
      param_2 = param_2 + uVar11;
      uVar4 = uVar4 - 1;
    } while (uVar4 != 0);
  }
  return;
}



void FUN_180025980(longlong param_1,short *param_2,ulonglong param_3,int param_4)

{
  uint uVar1;
  ushort *puVar2;
  short *psVar3;
  int iVar4;
  int iVar5;
  ulonglong uVar6;
  uint uVar7;
  longlong lVar8;
  longlong lVar9;
  int iVar10;
  ulonglong uVar11;
  int iVar12;
  longlong lVar13;

  if (0 < param_4) {
    lVar9 = 0;
    lVar13 = (longlong)param_4;
    lVar8 = param_1 - (longlong)param_2;
    uVar6 = param_3 & 0xffffffff;
    do {
      iVar4 = 0;
      iVar10 = 0;
      uVar7 = 0;
      iVar12 = 0;
      iVar5 = (int)uVar6;
      if (1 < iVar5) {
        puVar2 = (ushort *)((longlong)param_2 + lVar8);
        uVar1 = (iVar5 - 2U >> 1) + 1;
        uVar11 = (ulonglong)uVar1;
        iVar12 = uVar1 * 2;
        do {
          iVar4 = iVar4 + (uint)*puVar2;
          iVar10 = iVar10 + (uint)puVar2[lVar13];
          puVar2 = puVar2 + param_4 * 2;
          uVar11 = uVar11 - 1;
        } while (uVar11 != 0);
      }
      if (iVar12 < iVar5) {
        uVar7 = (uint)*(ushort *)(param_1 + (iVar12 * param_4 + lVar9) * 2);
      }
      psVar3 = param_2;
      uVar11 = uVar6;
      if (0 < iVar5) {
        do {
          *psVar3 = (*(short *)(lVar8 + (longlong)psVar3) -
                    (short)((iVar10 + iVar4 + uVar7) / uVar6)) + 5000;
          uVar11 = uVar11 - 1;
          psVar3 = psVar3 + lVar13;
        } while (uVar11 != 0);
      }
      lVar9 = lVar9 + 1;
      param_2 = param_2 + 1;
    } while (lVar9 < lVar13);
  }
  return;
}



void FUN_180025a90(longlong param_1,short *param_2,char *param_3,uint param_4,int param_5)

{
  char *pcVar1;
  short *psVar2;
  short sVar3;
  ushort *puVar4;
  longlong lVar5;
  ulonglong uVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  longlong lVar10;
  short sVar11;
  longlong lVar12;

  lVar5 = (longlong)param_5;
  if (0 < lVar5) {
    lVar12 = param_1 - (longlong)param_2;
    lVar10 = lVar5;
    do {
      sVar11 = 0;
      uVar8 = 0;
      uVar6 = 0;
      if (0 < (int)param_4) {
        uVar9 = (ulonglong)param_4;
        uVar7 = (ulonglong)param_4;
        puVar4 = (ushort *)((longlong)param_2 + lVar12);
        pcVar1 = param_3;
        do {
          if (*pcVar1 != '\0') {
            uVar8 = (ulonglong)((int)uVar8 + (uint)*puVar4);
            uVar6 = (ulonglong)(ushort)((short)uVar6 + 1);
          }
          puVar4 = puVar4 + lVar5;
          pcVar1 = pcVar1 + lVar5;
          uVar7 = uVar7 - 1;
        } while (uVar7 != 0);
        psVar2 = param_2;
        pcVar1 = param_3;
        if ((short)uVar6 != 0) {
          sVar11 = (short)(uVar8 / uVar6);
        }
        do {
          if (*pcVar1 == '\0') {
            *psVar2 = 5000;
          }
          else {
            sVar3 = (*(short *)(lVar12 + (longlong)psVar2) - sVar11) + 5000;
            if (sVar3 < 1) {
              sVar3 = 0;
            }
            *psVar2 = sVar3;
          }
          uVar9 = uVar9 - 1;
          psVar2 = psVar2 + lVar5;
          pcVar1 = pcVar1 + lVar5;
        } while (uVar9 != 0);
      }
      param_3 = param_3 + 1;
      param_2 = param_2 + 1;
      lVar10 = lVar10 + -1;
    } while (lVar10 != 0);
  }
  return;
}



void FUN_180025b90(longlong param_1,ushort *param_2,longlong param_3,uint param_4,int param_5)

{
  ulonglong uVar1;
  ushort *puVar2;
  ulonglong uVar3;
  longlong lVar4;
  short sVar5;
  ushort uVar6;
  ulonglong uVar7;
  longlong lVar8;
  ulonglong uVar9;

  if (0 < (int)param_4) {
    lVar8 = (longlong)param_5;
    lVar4 = param_1 - (longlong)param_2;
    uVar9 = 0;
    uVar3 = (ulonglong)param_4;
    do {
      sVar5 = 0;
      if (0 < lVar8) {
        puVar2 = (ushort *)((longlong)param_2 + lVar4);
        uVar1 = uVar9;
        uVar7 = uVar9;
        uVar6 = 0;
        do {
          if (*(char *)(param_3 + uVar1) != '\0') {
            uVar7 = (ulonglong)((int)uVar7 + (uint)*puVar2);
            uVar6 = uVar6 + 1;
          }
          uVar1 = uVar1 + 1;
          puVar2 = puVar2 + 1;
        } while ((longlong)uVar1 < lVar8);
        if (uVar6 != 0) {
          sVar5 = (short)(uVar7 / uVar6);
        }
      }
      uVar1 = uVar9;
      puVar2 = param_2;
      if (0 < lVar8) {
        do {
          if (*(char *)(param_3 + uVar1) == '\0') {
            *puVar2 = 5000;
          }
          else {
            uVar6 = (*(short *)(lVar4 + (longlong)puVar2) - sVar5) + 5000;
            if ((short)uVar6 < 1) {
              uVar6 = 0;
            }
            *puVar2 = uVar6;
          }
          uVar1 = uVar1 + 1;
          puVar2 = puVar2 + 1;
        } while ((longlong)uVar1 < lVar8);
      }
      param_2 = param_2 + lVar8;
      param_3 = param_3 + lVar8;
      uVar3 = uVar3 - 1;
    } while (uVar3 != 0);
  }
  return;
}



void FUN_180025d90(undefined8 param_1,int param_2,int param_3,undefined *param_4,undefined4 *param_5
                  ,uint *param_6,longlong param_7)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  ushort *_Memory;
  undefined *puVar9;
  ulonglong uVar10;
  int iVar11;
  ushort *puVar12;
  bool bVar13;

  uVar1 = *param_6;
  uVar2 = param_6[1];
  uVar3 = param_6[2];
  uVar10 = (ulonglong)uVar3;
  if (param_3 == 0) {
    iVar5 = FUN_180023de0(&DAT_1800cec14,uVar1,uVar2,param_7 + 0xc);
  }
  else {
    iVar5 = FUN_1800240f0(&DAT_1800cec14,uVar1,(ulonglong)uVar2,param_7 + 0xc);
  }
  if ((((param_4 != (undefined *)0x0) && (uVar3 != 0)) &&
      ((&DAT_1800cec14 + uVar10 <= param_4 || (param_4 + uVar10 < &DAT_1800cec15)))) && (uVar3 != 0)
     ) {
    puVar9 = param_4;
    do {
      *puVar9 = puVar9[(longlong)(&DAT_1800cec14 + -(longlong)param_4)];
      puVar9 = puVar9 + 1;
      uVar10 = uVar10 - 1;
    } while (uVar10 != 0);
  }
  *param_5 = 0;
  if (iVar5 < param_2) {
    return;
  }
  uVar4 = param_6[6];
  if (((uVar4 - 6 & 0xfffffffc) == 0) && (uVar4 != 8)) {
LAB_180025e9d:
    iVar11 = 0x1838;
    iVar6 = 0xc1c;
  }
  else {
    iVar6 = 0x640;
    if (uVar4 != 0x3e) {
      iVar6 = 2000;
    }
    iVar11 = 0xc80;
    if (uVar4 != 0x3e) {
      iVar11 = 4000;
    }
    if (uVar4 == 10) goto LAB_180025e9d;
  }
  _Memory = (ushort *)malloc((longlong)(int)(uVar1 * uVar2) * 2);
  if ((_Memory != (ushort *)0x0) &&
     (uVar4 = uVar1 * uVar2 * 2, uVar10 = (ulonglong)uVar4, puVar12 = _Memory, uVar4 != 0)) {
    while (uVar10 != 0) {
      uVar10 = uVar10 - 1;
      *(undefined *)puVar12 = 0;
      puVar12 = (ushort *)((longlong)puVar12 + 1);
    }
  }
  if (param_3 == 0) {
    if (*(short *)(param_7 + 10) < 0x60) {
      FUN_180025b90((longlong)&DAT_1800c52f4,_Memory,param_7 + 0xc,uVar2,uVar1);
    }
    else {
      FUN_180025870((longlong)&DAT_1800c52f4,(short *)_Memory,uVar2,uVar1);
    }
  }
  else {
    if (*(short *)(param_7 + 10) < 0x60) {
      FUN_180025a90((longlong)&DAT_1800c52f4,(short *)_Memory,(char *)(param_7 + 0xc),uVar2,uVar1);
    }
    else {
      FUN_180025980((longlong)&DAT_1800c52f4,(short *)_Memory,(ulonglong)uVar2,uVar1);
    }
  }
  FUN_1800252b0((undefined *)_Memory,&DAT_1800d38a4,param_6,param_7);
  free(_Memory);
  iVar7 = FUN_18003bdc0((ulonglong)&DAT_1800cec14,(ulonglong)&DAT_1800d38a4,param_7 + 0xc,uVar2);
  if (param_3 == 0) {
    iVar8 = FUN_180023de0(&DAT_1800d38a4,uVar1,uVar2,param_7 + 0xc);
  }
  else {
    iVar8 = FUN_1800240f0(&DAT_1800d38a4,uVar1,(ulonglong)uVar2,param_7 + 0xc);
  }
  if (iVar5 < iVar6) {
    if (param_2 * 0xcd >> 8 <= iVar8) {
      return;
    }
    bVar13 = SBORROW4(iVar7,0xeb);
    iVar7 = iVar7 + -0xeb;
  }
  else {
    if (iVar5 < iVar11) {
      iVar7 = ((iVar5 - iVar6) * param_2 * 0xb3) / (iVar11 - iVar6) + param_2 * 0xcd >> 8;
    }
    else {
      if (iVar11 + iVar6 <= iVar5) goto LAB_180026080;
      iVar7 = ((iVar5 - iVar11) * param_2 * 2) / (iVar11 - iVar6) + (param_2 * 0x180 >> 8);
    }
    bVar13 = SBORROW4(iVar8,iVar7);
    iVar7 = iVar8 - iVar7;
  }
  if (bVar13 == iVar7 < 0) {
    return;
  }
LAB_180026080:
  FUN_1800090f0(param_4,&DAT_1800d38a4,uVar3);
  *param_5 = 1;
  return;
}



undefined8 FUN_1800260b0(longlong param_1,ushort *param_2,int *param_3,int *param_4)

{
  ushort uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined8 *puVar5;
  int iVar6;
  undefined8 *puVar7;
  int iVar8;
  longlong lVar9;
  ushort *puVar10;
  short sVar11;
  int iVar12;
  short sVar13;
  undefined uVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  longlong lVar18;

  iVar2 = *param_3;
  iVar12 = 0;
  iVar3 = param_3[3];
  iVar4 = param_3[2];
  lVar18 = (longlong)iVar4;
  *param_4 = param_3[1];
  param_4[1] = iVar2;
  param_4[2] = 0;
  if ((undefined8 *)(param_4 + 3) != (undefined8 *)0x0) {
    lVar9 = 0x132;
    puVar5 = (undefined8 *)(param_4 + 3);
    do {
      puVar7 = puVar5;
      *puVar7 = 0;
      puVar7[1] = 0;
      puVar7[2] = 0;
      puVar7[3] = 0;
      puVar7[4] = 0;
      puVar7[5] = 0;
      puVar7[6] = 0;
      puVar7[7] = 0;
      lVar9 = lVar9 + -1;
      puVar5 = puVar7 + 8;
    } while (lVar9 != 0);
    puVar7[8] = 0;
    puVar7[9] = 0;
  }
  iVar16 = param_3[6];
  sVar11 = 0;
  iVar6 = 0x32;
  if (iVar16 - 0x3eU < 2) {
    iVar6 = 300;
    if (param_3[5] == 0) {
      iVar6 = 700;
    }
  }
  else {
    if (iVar16 - 9U < 2) {
      iVar6 = 0x78;
    }
  }
  if (0 < iVar4) {
    puVar10 = param_2;
    iVar17 = iVar12;
    iVar15 = iVar12;
    do {
      iVar8 = (uint)*puVar10 - (uint)*(ushort *)((param_1 - (longlong)param_2) + (longlong)puVar10);
      if (iVar6 < iVar8) {
        iVar17 = iVar17 + 1;
        iVar15 = iVar15 + iVar8;
      }
      puVar10 = puVar10 + 1;
      lVar18 = lVar18 + -1;
    } while (lVar18 != 0);
    if (0 < iVar17) {
      iVar15 = iVar15 / iVar17;
      if ((iVar16 - 0x3eU < 2) && (param_3[5] == 0)) {
        iVar16 = (iVar15 * 0x17) / 0x32 + (iVar15 * 0x17 >> 0x1f);
      }
      else {
        iVar16 = iVar15 / 5 + (iVar15 >> 0x1f);
      }
      iVar16 = iVar16 - (iVar16 >> 0x1f);
      if ((iVar17 != iVar2 * 10 && SBORROW4(iVar17,iVar2 * 10) == iVar17 + iVar2 * -10 < 0) ||
         (iVar6 < iVar16)) goto LAB_180026207;
    }
  }
  iVar16 = iVar6;
LAB_180026207:
  sVar13 = 0;
  *(short *)(param_4 + 2) = (short)iVar16;
  if (0 < iVar4) {
    do {
      lVar18 = (longlong)sVar13;
      uVar14 = 0xff;
      uVar1 = *(ushort *)(param_1 + lVar18 * 2);
      if (iVar3 == 0) {
        if ((int)((uint)uVar1 - (uint)param_2[lVar18]) < iVar16) goto LAB_18002625b;
LAB_180026270:
        if (uVar1 == 0) {
LAB_180026275:
          iVar12 = iVar12 + 1;
          uVar14 = 0;
        }
      }
      else {
        if ((int)((uint)param_2[lVar18] - (uint)uVar1) < iVar16) {
LAB_18002625b:
          iVar12 = iVar12 + 1;
          uVar14 = 0;
          if (iVar3 == 0) goto LAB_180026270;
        }
        if (uVar1 == 0xfff) goto LAB_180026275;
        if (iVar3 == 0) goto LAB_180026270;
      }
      sVar11 = (short)iVar12;
      sVar13 = sVar13 + 1;
      *(undefined *)(lVar18 + 0xc + (longlong)param_4) = uVar14;
    } while (sVar13 < iVar4);
  }
  *(short *)((longlong)param_4 + 10) =
       (short)(((short)((short)iVar4 - sVar11) * 100) / (int)(short)iVar4);
  return 0;
}



undefined8 FUN_1800262c0(longlong param_1)

{
  int *piVar1;
  longlong lVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  uint uVar15;

  iVar6 = 199;
  iVar3 = 0;
  lVar2 = 0;
  iVar7 = 0;
  iVar9 = 0;
  iVar11 = 0;
  iVar13 = 0;
  iVar8 = 0;
  iVar10 = 0;
  iVar12 = 0;
  iVar14 = 0;
  do {
    piVar1 = (int *)(param_1 + 0x4c98 + lVar2 * 4);
    iVar7 = *piVar1 + iVar7;
    iVar9 = piVar1[1] + iVar9;
    iVar11 = piVar1[2] + iVar11;
    iVar13 = piVar1[3] + iVar13;
    piVar1 = (int *)(param_1 + 0x4ca8 + lVar2 * 4);
    lVar2 = lVar2 + 8;
    iVar8 = *piVar1 + iVar8;
    iVar10 = piVar1[1] + iVar10;
    iVar12 = piVar1[2] + iVar12;
    iVar14 = piVar1[3] + iVar14;
  } while (lVar2 < 200);
  iVar4 = 0;
  lVar2 = 0;
  uVar15 = iVar8 + iVar7 + iVar12 + iVar11 + iVar10 + iVar9 + iVar14 + iVar13;
  do {
    iVar3 = iVar3 + *(int *)(param_1 + 0x4c98 + lVar2 * 4);
    iVar7 = iVar4;
    if (uVar15 * 0x1e < (uint)(iVar3 * 100)) break;
    iVar4 = iVar4 + 1;
    lVar2 = lVar2 + 1;
    iVar7 = 199;
  } while (lVar2 < 200);
  uVar5 = 0;
  lVar2 = 199;
  do {
    uVar5 = uVar5 + *(int *)(param_1 + 0x4c98 + lVar2 * 4);
    iVar3 = iVar6;
    if (uVar15 / 10 < uVar5) break;
    iVar6 = iVar6 + -1;
    lVar2 = lVar2 + -1;
    iVar3 = 0;
  } while (-1 < lVar2);
  *(int *)(param_1 + 0x4fb8) = iVar3;
  *(int *)(param_1 + 0x4fbc) = iVar7;
  if (((0x13 < iVar7) &&
      ((iVar3 == iVar7 * 3 || SBORROW4(iVar3,iVar7 * 3) != iVar3 + iVar7 * -3 < 0 || (0x27 < iVar7))
      )) && ((iVar3 = (int)(*(int *)(param_1 + 0x4fc0) + (*(int *)(param_1 + 0x4fc0) >> 0x1f & 3U))
                      >> 2,
             *(int *)(param_1 + 0x4fb4) == iVar3 || *(int *)(param_1 + 0x4fb4) < iVar3 ||
             (0x3b < iVar7)))) {
    return 0;
  }
  return 1;
}



void FUN_180026410(undefined8 param_1,undefined8 param_2,longlong param_3,int *param_4)

{
  char *pcVar1;
  int *piVar2;
  undefined *puVar3;
  longlong lVar4;
  undefined8 *puVar5;
  undefined uVar6;
  int iVar7;
  uint uVar8;
  longlong lVar9;
  ushort *_Memory;
  undefined8 *puVar10;
  longlong lVar11;
  ulonglong uVar12;
  longlong lVar13;
  ulonglong uVar14;
  char *pcVar15;
  byte *pbVar16;
  uint uVar17;
  ulonglong uVar18;
  uint uVar19;
  ulonglong uVar20;
  longlong lVar21;
  int iVar22;
  int iVar23;
  ushort *puVar24;
  undefined *puVar25;
  uint uVar26;
  undefined8 auStackX8 [2];
  undefined8 uStack64;

  uStack64 = 0x18002642a;
  lVar9 = _alloca_probe();
  lVar9 = -lVar9;
  *(ulonglong *)(&stack0x00004e28 + lVar9) =
       DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffc8 + lVar9);
  lVar11 = param_3 + 0xc;
  uVar26 = param_4[1] * *param_4;
  uVar20 = 0;
  uVar19 = 0;
  *(undefined8 *)(&stack0xfffffffffffffff0 + lVar9) = param_1;
  *(undefined8 *)(&stack0xfffffffffffffff8 + lVar9) = param_2;
  lVar21 = (longlong)(int)uVar26;
  *(undefined8 *)((longlong)&uStack64 + lVar9) = 0x18002646a;
  _Memory = (ushort *)malloc(lVar21 * 2,*(undefined *)((longlong)&uStack64 + lVar9));
  if ((_Memory != (ushort *)0x0) &&
     (uVar12 = (ulonglong)(uVar26 * 2), puVar24 = _Memory, uVar26 * 2 != 0)) {
    while (uVar12 != 0) {
      uVar12 = uVar12 - 1;
      *(undefined *)puVar24 = 0;
      puVar24 = (ushort *)((longlong)puVar24 + 1);
    }
  }
  *(undefined8 *)((longlong)&uStack64 + lVar9) = 0x180026493;
  FUN_180025130(*(undefined **)(&stack0xfffffffffffffff0 + lVar9),(undefined *)_Memory,param_3,
                param_4,*(undefined *)((longlong)&uStack64 + lVar9));
  lVar13 = 0x138;
  puVar5 = (undefined8 *)((longlong)auStackX8 + lVar9);
  do {
    puVar10 = puVar5;
    *puVar10 = 0;
    puVar10[1] = 0;
    puVar10[2] = 0;
    puVar10[3] = 0;
    puVar10[4] = 0;
    puVar10[5] = 0;
    puVar10[6] = 0;
    puVar10[7] = 0;
    lVar13 = lVar13 + -1;
    puVar5 = puVar10 + 8;
  } while (lVar13 != 0);
  puVar3 = *(undefined **)(&stack0xfffffffffffffff8 + lVar9);
  puVar10[8] = 0;
  puVar10[9] = 0;
  puVar10[10] = 0;
  puVar10[0xb] = 0;
  if ((puVar3 != (undefined *)0x0) && (uVar26 != 0)) {
    uVar12 = (ulonglong)uVar26;
    puVar25 = puVar3;
    while (uVar12 != 0) {
      uVar12 = uVar12 - 1;
      *puVar25 = 0;
      puVar25 = puVar25 + 1;
    }
  }
  iVar22 = 4999;
  uVar12 = uVar20;
  uVar18 = uVar20;
  uVar8 = 0;
  if (0 < (int)uVar26) {
    do {
      if (*(char *)(uVar12 + lVar11) != '\0') {
        uVar8 = 0;
        if (_Memory[uVar12] >> 2 != 0) {
          uVar8 = (uint)(_Memory[uVar12] >> 2);
        }
        uVar14 = (ulonglong)uVar8;
        if (4999 < uVar8) {
          uVar14 = 4999;
        }
        piVar2 = (int *)((longlong)auStackX8 + uVar14 * 4 + lVar9);
        *piVar2 = *piVar2 + 1;
        uVar18 = (ulonglong)((int)uVar18 + 1);
      }
      uVar8 = (uint)uVar18;
      uVar12 = uVar12 + 1;
    } while ((longlong)uVar12 < lVar21);
  }
  lVar13 = 4999;
  uVar12 = uVar20;
  do {
    uVar17 = (int)uVar12 + *(int *)((longlong)auStackX8 + lVar13 * 4 + lVar9);
    uVar12 = (ulonglong)uVar17;
    if ((int)(uVar8 * 0xf) <= (int)(uVar17 * 100)) goto LAB_18002654b;
    iVar22 = iVar22 + -1;
    lVar13 = lVar13 + -1;
  } while (-1 < lVar13);
  iVar22 = 0;
LAB_18002654b:
  uVar12 = uVar20;
  uVar18 = uVar20;
  uVar14 = uVar20;
  do {
    uVar17 = (int)uVar18 + *(int *)((longlong)auStackX8 + uVar12 * 4 + lVar9);
    uVar18 = (ulonglong)uVar17;
    iVar7 = uVar17 * 100;
    iVar23 = (int)uVar14;
    if (SBORROW4(iVar7,uVar8 * 5) == (int)(iVar7 + uVar8 * -5) < 0) goto LAB_180026583;
    uVar14 = (ulonglong)(iVar23 + 1);
    uVar12 = uVar12 + 1;
  } while ((longlong)uVar12 < 5000);
  iVar23 = 0x7fffffff;
LAB_180026583:
  iVar7 = iVar23 * 4 + 100;
  if (99 < iVar22 * 4 + iVar23 * -4) {
    iVar7 = iVar22 * 4;
  }
  if (iVar23 * 4 < iVar7) {
    if ((int)uVar26 < 1) goto LAB_180026698;
    puVar25 = puVar3;
    puVar24 = _Memory;
    lVar13 = lVar21;
    do {
      if (puVar25[lVar11 - (longlong)puVar3] != '\0') {
        lVar4 = (longlong)(int)(((uint)*puVar24 + iVar23 * -4) * 0xff) /
                (longlong)(iVar7 + iVar23 * -4);
        iVar22 = (int)lVar4;
        if (iVar22 < 0) {
          *puVar25 = 0;
        }
        else {
          uVar6 = (undefined)lVar4;
          if (0xff < iVar22) {
            uVar6 = 0xff;
          }
          *puVar25 = uVar6;
        }
      }
      puVar24 = puVar24 + 1;
      puVar25 = puVar25 + 1;
      lVar13 = lVar13 + -1;
    } while (lVar13 != 0);
  }
  if ((0 < (int)uVar26) && (0x3f < uVar26)) {
    uVar8 = uVar26 & 0x8000003f;
    if ((int)uVar8 < 0) {
      uVar8 = (uVar8 - 1 | 0xffffffc0) + 1;
    }
    pcVar15 = puVar3 + 0x10;
    do {
      pcVar1 = pcVar15 + 0x40;
      uVar19 = (int)uVar20 + 0x40;
      uVar20 = (ulonglong)uVar19;
      pcVar15[-0x10] = -1 - pcVar15[-0x10];
      pcVar15[-0xf] = -1 - pcVar15[-0xf];
      pcVar15[-0xe] = -1 - pcVar15[-0xe];
      pcVar15[-0xd] = -1 - pcVar15[-0xd];
      pcVar15[-0xc] = -1 - pcVar15[-0xc];
      pcVar15[-0xb] = -1 - pcVar15[-0xb];
      pcVar15[-10] = -1 - pcVar15[-10];
      pcVar15[-9] = -1 - pcVar15[-9];
      pcVar15[-8] = -1 - pcVar15[-8];
      pcVar15[-7] = -1 - pcVar15[-7];
      pcVar15[-6] = -1 - pcVar15[-6];
      pcVar15[-5] = -1 - pcVar15[-5];
      pcVar15[-4] = -1 - pcVar15[-4];
      pcVar15[-3] = -1 - pcVar15[-3];
      pcVar15[-2] = -1 - pcVar15[-2];
      pcVar15[-1] = -1 - pcVar15[-1];
      *pcVar15 = -1 - *pcVar15;
      pcVar15[1] = -1 - pcVar15[1];
      pcVar15[2] = -1 - pcVar15[2];
      pcVar15[3] = -1 - pcVar15[3];
      pcVar15[4] = -1 - pcVar15[4];
      pcVar15[5] = -1 - pcVar15[5];
      pcVar15[6] = -1 - pcVar15[6];
      pcVar15[7] = -1 - pcVar15[7];
      pcVar15[8] = -1 - pcVar15[8];
      pcVar15[9] = -1 - pcVar15[9];
      pcVar15[10] = -1 - pcVar15[10];
      pcVar15[0xb] = -1 - pcVar15[0xb];
      pcVar15[0xc] = -1 - pcVar15[0xc];
      pcVar15[0xd] = -1 - pcVar15[0xd];
      pcVar15[0xe] = -1 - pcVar15[0xe];
      pcVar15[0xf] = -1 - pcVar15[0xf];
      pcVar15[0x10] = -1 - pcVar15[0x10];
      pcVar15[0x11] = -1 - pcVar15[0x11];
      pcVar15[0x12] = -1 - pcVar15[0x12];
      pcVar15[0x13] = -1 - pcVar15[0x13];
      pcVar15[0x14] = -1 - pcVar15[0x14];
      pcVar15[0x15] = -1 - pcVar15[0x15];
      pcVar15[0x16] = -1 - pcVar15[0x16];
      pcVar15[0x17] = -1 - pcVar15[0x17];
      pcVar15[0x18] = -1 - pcVar15[0x18];
      pcVar15[0x19] = -1 - pcVar15[0x19];
      pcVar15[0x1a] = -1 - pcVar15[0x1a];
      pcVar15[0x1b] = -1 - pcVar15[0x1b];
      pcVar15[0x1c] = -1 - pcVar15[0x1c];
      pcVar15[0x1d] = -1 - pcVar15[0x1d];
      pcVar15[0x1e] = -1 - pcVar15[0x1e];
      pcVar15[0x1f] = -1 - pcVar15[0x1f];
      pcVar15[0x20] = -1 - pcVar15[0x20];
      pcVar15[0x21] = -1 - pcVar15[0x21];
      pcVar15[0x22] = -1 - pcVar15[0x22];
      pcVar15[0x23] = -1 - pcVar15[0x23];
      pcVar15[0x24] = -1 - pcVar15[0x24];
      pcVar15[0x25] = -1 - pcVar15[0x25];
      pcVar15[0x26] = -1 - pcVar15[0x26];
      pcVar15[0x27] = -1 - pcVar15[0x27];
      pcVar15[0x28] = -1 - pcVar15[0x28];
      pcVar15[0x29] = -1 - pcVar15[0x29];
      pcVar15[0x2a] = -1 - pcVar15[0x2a];
      pcVar15[0x2b] = -1 - pcVar15[0x2b];
      pcVar15[0x2c] = -1 - pcVar15[0x2c];
      pcVar15[0x2d] = -1 - pcVar15[0x2d];
      pcVar15[0x2e] = -1 - pcVar15[0x2e];
      pcVar15[0x2f] = -1 - pcVar15[0x2f];
      pcVar15 = pcVar1;
    } while ((longlong)(pcVar1 + (-0x10 - (longlong)puVar3)) < (longlong)(int)(uVar26 - uVar8));
  }
LAB_180026698:
  lVar11 = (longlong)(int)uVar19;
  if (lVar11 < lVar21) {
    pbVar16 = puVar3 + lVar11;
    lVar21 = lVar21 - lVar11;
    do {
      *pbVar16 = ~*pbVar16;
      pbVar16 = pbVar16 + 1;
      lVar21 = lVar21 + -1;
    } while (lVar21 != 0);
  }
  *(undefined8 *)((longlong)&uStack64 + lVar9) = 0x1800266c5;
  free(_Memory,*(undefined *)((longlong)&uStack64 + lVar9));
  *(undefined8 *)((longlong)&uStack64 + lVar9) = 0x1800266d7;
  FUN_18005f100(*(ulonglong *)(&stack0x00004e28 + lVar9) ^
                (ulonglong)(&stack0xffffffffffffffc8 + lVar9),
                *(undefined *)((longlong)&uStack64 + lVar9));
  return;
}



undefined8 FUN_180026700(ulonglong param_1,uint *param_2,char *param_3)

{
  ushort *puVar1;
  ushort *puVar2;
  ushort uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  char cVar7;
  int iVar8;
  undefined *_Memory;
  ushort *_Memory_00;
  undefined *_Memory_01;
  ushort *_Memory_02;
  ushort *_Memory_03;
  ushort uVar9;
  ulonglong uVar10;
  ushort *puVar11;
  size_t _Size;
  undefined *puVar12;
  ulonglong uVar13;
  longlong lVar14;
  longlong lVar15;
  ushort *puVar16;

  uVar4 = param_2[1];
  uVar5 = *param_2;
  uVar6 = uVar4 * uVar5 * 2;
  uVar13 = (ulonglong)uVar6;
  _Size = SEXT48((int)uVar6);
  _Memory = (undefined *)malloc(_Size);
  _Memory_00 = (ushort *)malloc(_Size);
  _Memory_01 = (undefined *)malloc(_Size);
  _Memory_02 = (ushort *)malloc(_Size);
  _Memory_03 = (ushort *)malloc(0x9920);
  if ((_Memory_03 != (ushort *)0x0) && (uVar10 = uVar13, puVar11 = _Memory_03, uVar6 != 0)) {
    while (uVar10 != 0) {
      *(undefined *)puVar11 = 0;
      uVar10 = uVar10 - 1;
      puVar11 = (ushort *)((longlong)puVar11 + 1);
    }
  }
  if ((_Memory != (undefined *)0x0) && (uVar10 = uVar13, puVar12 = _Memory, uVar6 != 0)) {
    while (uVar10 != 0) {
      *puVar12 = 0;
      uVar10 = uVar10 - 1;
      puVar12 = puVar12 + 1;
    }
  }
  if ((_Memory_00 != (ushort *)0x0) && (uVar10 = uVar13, puVar11 = _Memory_00, uVar6 != 0)) {
    while (uVar10 != 0) {
      *(undefined *)puVar11 = 0;
      uVar10 = uVar10 - 1;
      puVar11 = (ushort *)((longlong)puVar11 + 1);
    }
  }
  if ((_Memory_01 != (undefined *)0x0) && (uVar10 = uVar13, puVar12 = _Memory_01, uVar6 != 0)) {
    while (uVar10 != 0) {
      *puVar12 = 0;
      uVar10 = uVar10 - 1;
      puVar12 = puVar12 + 1;
    }
  }
  if ((_Memory_02 != (ushort *)0x0) && (uVar10 = uVar13, puVar11 = _Memory_02, uVar6 != 0)) {
    while (uVar10 != 0) {
      *(undefined *)puVar11 = 0;
      uVar10 = uVar10 - 1;
      puVar11 = (ushort *)((longlong)puVar11 + 1);
    }
  }
  if ((((_Memory_03 != (ushort *)0x0) && (param_1 != 0)) && (uVar6 != 0)) &&
     ((((ushort *)(uVar13 + param_1) <= _Memory_03 || (uVar13 + (longlong)_Memory_03 <= param_1)) &&
      (uVar6 != 0)))) {
    puVar11 = _Memory_03;
    do {
      *(undefined *)puVar11 = *(undefined *)((param_1 - (longlong)_Memory_03) + (longlong)puVar11);
      puVar11 = (ushort *)((longlong)puVar11 + 1);
      uVar13 = uVar13 - 1;
    } while (uVar13 != 0);
  }
  FUN_1800244d0((longlong)_Memory_03,uVar5,uVar4,(longlong)_Memory,(longlong)_Memory_00);
  FUN_180024810(_Memory_03,uVar5,(ulonglong)uVar4,(longlong)_Memory_01,(longlong)_Memory_02);
  lVar15 = (longlong)(int)(uVar4 * uVar5);
  if (0 < lVar15) {
    puVar16 = (ushort *)((longlong)_Memory_02 - (longlong)_Memory_00);
    puVar11 = _Memory_00;
    lVar14 = lVar15;
    do {
      uVar9 = *puVar11;
      if (uVar9 < *(ushort *)((longlong)puVar16 + (longlong)puVar11) ||
          uVar9 == *(ushort *)((longlong)puVar16 + (longlong)puVar11)) {
        uVar9 = *(ushort *)((longlong)puVar16 + (longlong)puVar11);
      }
      *puVar11 = uVar9;
      puVar1 = (ushort *)(_Memory + -(longlong)_Memory_00 + (longlong)puVar11);
      puVar2 = (ushort *)(_Memory_01 + -(longlong)_Memory_00 + (longlong)puVar11);
      puVar11 = puVar11 + 1;
      uVar9 = *puVar2;
      if (*puVar1 <= *puVar2) {
        uVar9 = *puVar1;
      }
      *(ushort *)((longlong)((longlong)puVar16 + -2) + (longlong)puVar11) = uVar9;
      lVar14 = lVar14 + -1;
    } while (lVar14 != 0);
    lVar14 = 0xc - (longlong)param_3;
    puVar11 = _Memory_02;
    do {
      uVar9 = *(ushort *)
               ((longlong)((longlong)_Memory_00 - (longlong)_Memory_02) + (longlong)puVar11);
      uVar3 = *puVar11;
      if (param_3[(longlong)param_2 + lVar14] == '\0') {
        cVar7 = '\0';
      }
      else {
        if (uVar9 == uVar3) {
          cVar7 = -1;
        }
        else {
          uVar13 = (longlong)
                   (int)(((uint)*(ushort *)
                                 ((longlong)puVar11 +
                                 (longlong)((longlong)_Memory_03 - (longlong)_Memory_02)) -
                         (uint)uVar3) * 0xff) / (longlong)(int)((uint)uVar9 - (uint)uVar3) &
                   0xffffffff;
          iVar8 = (int)uVar13;
          if (iVar8 < 0) {
            cVar7 = '\0';
          }
          else {
            cVar7 = (char)uVar13;
            if (0xff < iVar8) {
              cVar7 = -1;
            }
          }
        }
      }
      puVar11 = puVar11 + 1;
      *param_3 = -1 - cVar7;
      param_3 = param_3 + 1;
      lVar15 = lVar15 + -1;
    } while (lVar15 != 0);
  }
  free(_Memory);
  free(_Memory_00);
  free(_Memory_01);
  free(_Memory_02);
  free(_Memory_03);
  return 0;
}



ulonglong FUN_1800269b0(longlong param_1,longlong param_2,int param_3,int *param_4,uint *param_5,
                       undefined *param_6,int param_7)

{
  char *pcVar1;
  short sVar2;
  uint uVar3;
  uint uVar4;
  longlong lVar5;
  int *piVar6;
  int iVar7;
  uint *_Memory;
  uint *_Memory_00;
  uint *_Memory_01;
  ushort *_Memory_02;
  ulonglong uVar8;
  char *pcVar9;
  ulonglong uVar10;
  undefined *puVar11;
  uint uVar12;
  undefined *puVar14;
  ushort *puVar15;
  undefined8 uVar16;
  int iVar17;
  ulonglong uVar18;
  int local_res18 [2];
  int *local_res20;
  int local_a0;
  int local_68;
  undefined4 uStack100;
  undefined4 uStack96;
  undefined4 uStack92;
  undefined8 local_58;
  undefined4 local_50;
  ulonglong uVar13;

  pcVar1 = (char *)(param_2 + 0xc);
  sVar2 = *(short *)(param_2 + 10);
  iVar17 = 0;
  local_a0 = 0;
  uVar3 = param_5[1];
  uVar4 = *param_5;
  uVar12 = uVar4 * uVar3;
  uVar13 = (ulonglong)uVar12;
  local_res18[0] = param_3;
  local_res20 = param_4;
  _Memory = (uint *)malloc((longlong)(int)uVar12 + 0x20);
  if (_Memory == (uint *)0x0) {
    _Memory = (uint *)0x0;
  }
  else {
    _Memory[3] = uVar12;
    *_Memory = uVar4;
    _Memory[1] = uVar3;
    _Memory[4] = 1;
    _Memory[2] = uVar4;
    *(uint **)(_Memory + 6) = _Memory + 8;
  }
  _Memory_00 = (uint *)malloc((longlong)(int)uVar12 + 0x20);
  if (_Memory_00 != (uint *)0x0) {
    _Memory_00[3] = uVar12;
    *_Memory_00 = uVar4;
    _Memory_00[1] = uVar3;
    _Memory_00[4] = 1;
    _Memory_00[2] = uVar4;
    *(uint **)(_Memory_00 + 6) = _Memory_00 + 8;
  }
  _Memory_01 = (uint *)malloc((longlong)(int)uVar12 + 0x20);
  if (_Memory_01 != (uint *)0x0) {
    _Memory_01[3] = uVar12;
    *_Memory_01 = uVar4;
    _Memory_01[1] = uVar3;
    *(uint **)(_Memory_01 + 6) = _Memory_01 + 8;
    _Memory_01[4] = 1;
    _Memory_01[2] = uVar4;
  }
  if ((*(undefined **)(_Memory + 6) != (undefined *)0x0) && (uVar12 != 0)) {
    uVar8 = (ulonglong)uVar12;
    puVar14 = *(undefined **)(_Memory + 6);
    while (uVar8 != 0) {
      uVar8 = uVar8 - 1;
      *puVar14 = 0;
      puVar14 = puVar14 + 1;
    }
  }
  if ((*(undefined **)(_Memory_00 + 6) != (undefined *)0x0) && (uVar12 != 0)) {
    uVar8 = (ulonglong)uVar12;
    puVar14 = *(undefined **)(_Memory_00 + 6);
    while (uVar8 != 0) {
      uVar8 = uVar8 - 1;
      *puVar14 = 0;
      puVar14 = puVar14 + 1;
    }
  }
  if ((*(undefined **)(_Memory_01 + 6) != (undefined *)0x0) && (uVar12 != 0)) {
    uVar8 = (ulonglong)uVar12;
    puVar14 = *(undefined **)(_Memory_01 + 6);
    while (uVar8 != 0) {
      uVar8 = uVar8 - 1;
      *puVar14 = 0;
      puVar14 = puVar14 + 1;
    }
  }
  if (local_res18[0] == 0) {
    FUN_180026410(param_1,*(undefined8 *)(_Memory_00 + 6),param_2,(int *)param_5);
  }
  else {
    _Memory_02 = (ushort *)malloc((longlong)(int)uVar12 * 2);
    if ((_Memory_02 != (ushort *)0x0) && (uVar12 * 2 != 0)) {
      uVar8 = (ulonglong)(uVar12 * 2);
      puVar15 = _Memory_02;
      while (uVar8 != 0) {
        uVar8 = uVar8 - 1;
        *(undefined *)puVar15 = 0;
        puVar15 = (ushort *)((longlong)puVar15 + 1);
      }
    }
    if (param_7 == 0) {
      if (sVar2 < 0x60) {
        FUN_180025b90(param_1,_Memory_02,(longlong)pcVar1,uVar3,uVar4);
      }
      else {
        FUN_180025870(param_1,(short *)_Memory_02,uVar3,uVar4);
      }
    }
    else {
      if (sVar2 < 0x60) {
        FUN_180025a90(param_1,(short *)_Memory_02,pcVar1,uVar3,uVar4);
      }
      else {
        FUN_180025980(param_1,(short *)_Memory_02,(ulonglong)uVar3,uVar4);
      }
    }
    FUN_180026410(_Memory_02,*(undefined8 *)(_Memory_00 + 6),param_2,(int *)param_5);
    free(_Memory_02);
  }
  uVar16 = 1;
  FUN_180035ae0((int *)_Memory_00,(longlong)_Memory_01,1,0x50,0xff);
  pcVar9 = *(char **)(_Memory + 6);
  if (((((pcVar9 != (char *)0x0) && (pcVar1 != (char *)0x0)) && (uVar12 != 0)) &&
      ((uVar8 = (ulonglong)uVar12, pcVar1 + uVar13 <= pcVar9 || (pcVar9 + uVar13 <= pcVar1)))) &&
     (uVar12 != 0)) {
    lVar5 = -(longlong)pcVar9;
    do {
      *pcVar9 = pcVar9[(longlong)(pcVar1 + lVar5)];
      pcVar9 = pcVar9 + 1;
      uVar8 = uVar8 - 1;
    } while (uVar8 != 0);
  }
  uVar8 = 0;
  if (0 < (int)uVar12) {
    uVar10 = uVar8;
    uVar18 = uVar8;
    do {
      if ((*(char *)(*(longlong *)(_Memory + 6) + uVar10) != '\0') &&
         (uVar18 = (ulonglong)((int)uVar18 + 1),
         *(char *)(uVar10 + *(longlong *)(_Memory_01 + 6)) == '\0')) {
        iVar17 = iVar17 + 1;
      }
      uVar10 = uVar10 + 1;
    } while ((longlong)uVar10 < (longlong)(int)uVar12);
    local_a0 = (int)uVar18;
  }
  iVar17 = iVar17 * 100;
  *local_res20 = 0;
  if (iVar17 != local_a0 * 0x1e && SBORROW4(iVar17,local_a0 * 0x1e) == iVar17 + local_a0 * -0x1e < 0
     ) {
    if (0 < (int)uVar12) {
      do {
        if ((*(char *)(*(longlong *)(_Memory + 6) + uVar8) != '\0') &&
           (*(char *)(uVar8 + *(longlong *)(_Memory_01 + 6)) != '\0')) {
          *(undefined *)(*(longlong *)(_Memory + 6) + uVar8) = 0;
        }
        uVar8 = uVar8 + 1;
      } while ((longlong)uVar8 < (longlong)(int)uVar12);
    }
    if (_Memory_00[4] == 1) {
      local_res18[0] = 0;
      local_58 = 0x1400000046;
      local_68 = 0;
      uStack100 = 1;
      uStack96 = 0;
      uStack92 = 0x14;
      local_50 = 0xf;
      FUN_180013a00(_Memory_00,(int *)_Memory,uVar16,&local_68,local_res18);
      iVar7 = local_res18[0];
      if (100 < local_res18[0]) {
        iVar7 = 100;
      }
      if ((1 < iVar7) && (0xe < iVar7)) goto LAB_180026db9;
    }
    puVar14 = *(undefined **)(_Memory + 6);
    if ((((param_6 != (undefined *)0x0) && ((puVar14 != (undefined *)0x0 && (uVar12 != 0)))) &&
        ((uVar8 = (ulonglong)uVar12, puVar14 + uVar13 <= param_6 || (param_6 + uVar13 <= puVar14))))
       && (uVar12 != 0)) {
      puVar11 = param_6;
      do {
        *puVar11 = puVar11[(longlong)(puVar14 + -(longlong)param_6)];
        puVar11 = puVar11 + 1;
        uVar8 = uVar8 - 1;
      } while (uVar8 != 0);
    }
    *local_res20 = 1;
  }
LAB_180026db9:
  piVar6 = local_res20;
  free(_Memory);
  free(_Memory_00);
  free(_Memory_01);
  if (*piVar6 != 1) {
    iVar17 = local_a0 * 100;
  }
  return (ulonglong)(uint)(iVar17 / (int)uVar12);
}



void FUN_180026e10(longlong param_1,char *param_2,int *param_3,uint *param_4,undefined8 param_5,
                  int param_6)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  ushort *_Memory;
  ulonglong uVar4;
  ushort *puVar5;

  iVar1 = *param_3;
  uVar2 = param_3[1];
  _Memory = (ushort *)malloc((longlong)(int)(iVar1 * uVar2) * 2);
  if ((_Memory != (ushort *)0x0) && (uVar3 = iVar1 * uVar2 * 2, uVar3 != 0)) {
    uVar4 = (ulonglong)uVar3;
    puVar5 = _Memory;
    while (uVar4 != 0) {
      uVar4 = uVar4 - 1;
      *(undefined *)puVar5 = 0;
      puVar5 = (ushort *)((longlong)puVar5 + 1);
    }
  }
  if (param_6 == 0) {
    if (*(short *)((longlong)param_4 + 10) < 0x60) {
      FUN_180025b90(param_1,_Memory,(longlong)(param_4 + 3),uVar2,iVar1);
    }
    else {
      FUN_180025870(param_1,(short *)_Memory,uVar2,iVar1);
    }
  }
  else {
    if (*(short *)((longlong)param_4 + 10) < 0x60) {
      FUN_180025a90(param_1,(short *)_Memory,(char *)(param_4 + 3),uVar2,iVar1);
    }
    else {
      FUN_180025980(param_1,(short *)_Memory,(ulonglong)uVar2,iVar1);
    }
  }
  FUN_180026700((ulonglong)_Memory,param_4,param_2);
                    // WARNING: Could not recover jumptable at 0x000180026eec. Too many branches
                    // WARNING: Treating indirect jump as call
  free(_Memory);
  return;
}



void FUN_180026f00(int *param_1,int *param_2,longlong *param_3)

{
  uint *puVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  longlong lVar5;
  void *pvVar6;
  undefined8 uVar7;
  ushort *_Memory;
  ulonglong uVar8;
  uint uVar9;
  ulonglong uVar10;
  int iVar11;
  undefined4 uVar12;
  byte *pbVar13;
  longlong lVar14;
  ushort *puVar15;
  byte *pbVar16;
  undefined *puVar17;
  longlong lVar18;
  longlong lVar19;
  ulonglong uVar20;
  int iVar21;
  ulonglong uVar22;
  uint uVar23;
  ulonglong uVar24;
  int aiStackX16 [4];
  int *piStackX32;
  undefined8 uStack64;

  uStack64 = 0x180026f1a;
  lVar5 = _alloca_probe();
  lVar5 = -lVar5;
  *(ulonglong *)(&stack0x00004cf8 + lVar5) =
       DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffc8 + lVar5);
  iVar21 = *param_1;
  uVar10 = 0;
  iVar11 = param_2[1];
  pbVar13 = *(byte **)(&stack0x00004d80 + lVar5);
  puVar1 = *(uint **)(&stack0x00004d70 + lVar5);
  iVar4 = param_2[6];
  uVar20 = *param_3;
  *(undefined8 *)(&stack0x00000048 + lVar5) = *(undefined8 *)(&stack0x00004d88 + lVar5);
  *(undefined8 *)(&stack0x00000050 + lVar5) = *(undefined8 *)(&stack0x00004d90 + lVar5);
  *(int *)(&stack0x0000002c + lVar5) = iVar11;
  iVar11 = *param_2;
  *(undefined8 *)(&stack0x00000058 + lVar5) = *(undefined8 *)(&stack0x00004da0 + lVar5);
  iVar3 = param_2[2];
  *(int *)(&stack0x00000028 + lVar5) = iVar11;
  *(int **)((longlong)&piStackX32 + lVar5) = param_2;
  *(byte **)(&stack0x00000038 + lVar5) = pbVar13;
  uVar23 = 0;
  *(undefined4 *)(&stack0x0000000c + lVar5) = 0;
  *(int *)((longlong)aiStackX16 + lVar5 + 8) = iVar3;
  *(undefined8 *)((longlong)&uStack64 + lVar5) = 0x180026fab;
  pvVar6 = malloc((longlong)iVar3,*(undefined *)((longlong)&uStack64 + lVar5));
  iVar11 = *(int *)(&stack0x00004d68 + lVar5);
  *(void **)(&stack0x00000040 + lVar5) = pvVar6;
  *(undefined4 *)((longlong)aiStackX16 + lVar5 + 4) = 0;
  if (uVar20 == 0) {
    *(int *)((longlong)aiStackX16 + lVar5) = -0x7fffffff;
  }
  else {
    *(int *)(&stack0xfffffffffffffff8 + lVar5) = iVar11;
    *(void **)(&stack0xfffffffffffffff0 + lVar5) = pvVar6;
    *(int **)(&stack0xffffffffffffffe8 + lVar5) = param_2;
    *(undefined8 *)((longlong)&uStack64 + lVar5) = 0x180027022;
    uVar8 = FUN_1800269b0(uVar20,(longlong)puVar1,DAT_1800d8534 & 0xffff,
                          (int *)((longlong)aiStackX16 + lVar5 + 4),
                          *(uint **)(&stack0xffffffffffffffe8 + lVar5),
                          *(undefined **)(&stack0xfffffffffffffff0 + lVar5),
                          *(int *)(&stack0xfffffffffffffff8 + lVar5));
    *(int *)((longlong)aiStackX16 + lVar5) = (int)uVar8;
    if (*(int *)((longlong)aiStackX16 + lVar5 + 4) == 1) {
      uVar7 = *(undefined8 *)(&stack0x00000040 + lVar5);
      goto LAB_180026fde;
    }
  }
  uVar7 = *(undefined8 *)(*(longlong *)(&stack0x00004d78 + lVar5) + 0x18);
LAB_180026fde:
  *(undefined8 *)(&stack0x00000030 + lVar5) = uVar7;
  switch(iVar4) {
  case 0:
  case 2:
  case 0x3e:
    iVar3 = 0x32;
    break;
  default:
    iVar3 = 0x46;
    break;
  case 6:
  case 7:
  case 9:
  case 10:
    iVar3 = 0x38;
  }
  *(int *)(&stack0x00000008 + lVar5) = iVar3;
  if ((DAT_1800b20b0 < 100) && (iVar21 == 1)) {
    if ((iVar4 == 8) || ((iVar4 < 6 || (10 < iVar4)))) {
      iVar3 = iVar3 + -0xf;
    }
    else {
      iVar3 = iVar3 + -10;
    }
    *(int *)(&stack0x00000008 + lVar5) = iVar3;
  }
  if (DAT_1800d8534 == 1) {
    uVar9 = param_2[1];
    iVar21 = **(int **)((longlong)&piStackX32 + lVar5);
    *(undefined8 *)((longlong)&uStack64 + lVar5) = 0x18002709c;
    _Memory = (ushort *)
              malloc((longlong)(int)(iVar21 * uVar9) * 2,*(undefined *)((longlong)&uStack64 + lVar5)
                    );
    if ((_Memory != (ushort *)0x0) && (uVar2 = iVar21 * uVar9 * 2, uVar2 != 0)) {
      uVar8 = (ulonglong)uVar2;
      puVar15 = _Memory;
      while (uVar8 != 0) {
        uVar8 = uVar8 - 1;
        *(undefined *)puVar15 = 0;
        puVar15 = (ushort *)((longlong)puVar15 + 1);
      }
    }
    if (iVar11 == 0) {
      if (*(short *)((longlong)puVar1 + 10) < 0x60) {
        *(int *)(&stack0xffffffffffffffe8 + lVar5) = iVar21;
        *(undefined8 *)((longlong)&uStack64 + lVar5) = 0x180027105;
        FUN_180025b90(uVar20,_Memory,(longlong)(puVar1 + 3),uVar9,
                      *(int *)(&stack0xffffffffffffffe8 + lVar5));
      }
      else {
        *(undefined8 *)((longlong)&uStack64 + lVar5) = 0x1800270f7;
        FUN_180025870(uVar20,(short *)_Memory,uVar9,iVar21,
                      *(undefined *)((longlong)&uStack64 + lVar5));
      }
    }
    else {
      if (*(short *)((longlong)puVar1 + 10) < 0x60) {
        *(int *)(&stack0xffffffffffffffe8 + lVar5) = iVar21;
        *(undefined8 *)((longlong)&uStack64 + lVar5) = 0x1800270e4;
        FUN_180025a90(uVar20,(short *)_Memory,(char *)(puVar1 + 3),uVar9,
                      *(int *)(&stack0xffffffffffffffe8 + lVar5));
      }
      else {
        *(undefined8 *)((longlong)&uStack64 + lVar5) = 0x1800270d6;
        FUN_180025980(uVar20,(short *)_Memory,(ulonglong)uVar9,iVar21,
                      *(undefined *)((longlong)&uStack64 + lVar5));
      }
    }
    *(undefined8 *)((longlong)&uStack64 + lVar5) = 0x180027118;
    FUN_180026700((ulonglong)_Memory,puVar1,&stack0x00000068 + lVar5,
                  *(undefined *)((longlong)&uStack64 + lVar5));
    *(undefined8 *)((longlong)&uStack64 + lVar5) = 0x180027121;
    free(_Memory,*(undefined *)((longlong)&uStack64 + lVar5));
    pbVar13 = *(byte **)(&stack0x00000038 + lVar5);
    param_2 = *(int **)((longlong)&piStackX32 + lVar5);
  }
  else {
    *(undefined8 *)((longlong)&uStack64 + lVar5) = 0x180027140;
    FUN_180026700(uVar20,puVar1,&stack0x00000068 + lVar5,*(undefined *)((longlong)&uStack64 + lVar5)
                 );
  }
  uVar2 = DAT_1800b20b0;
  uVar9 = param_2[6];
  uVar20 = (ulonglong)uVar9;
  iVar21 = *param_2;
  lVar18 = (longlong)iVar21;
  if ((uVar9 == 1) || (uVar9 - 7 < 2)) {
    uVar23 = 4;
  }
  else {
    if ((uVar9 == 0) || (uVar9 == 0x14)) {
      uVar23 = 8;
    }
  }
  iVar11 = 0;
  lVar19 = lVar18;
  uVar8 = uVar10;
  if ((int)uVar23 < (int)(param_2[1] - uVar23)) {
    uVar24 = (ulonglong)uVar23;
    uVar8 = (ulonglong)((param_2[1] - uVar23) - uVar23);
    lVar14 = (longlong)(int)(iVar21 * uVar23);
    *(longlong *)(&stack0x00000038 + lVar5) = lVar18;
    uVar22 = uVar10;
    do {
      if ((longlong)uVar24 < (longlong)(int)(iVar21 - uVar23)) {
        pbVar16 = pbVar13 + lVar14 + uVar24;
        lVar19 = (longlong)(int)(iVar21 - uVar23) - uVar24;
        do {
          if (pbVar16[*(longlong *)(&stack0x00000030 + lVar5) - (longlong)pbVar13] != 0) {
            uVar9 = (int)((uint)*pbVar16 -
                         (uint)(byte)(&stack0x00000068 + (lVar5 - (longlong)pbVar13))
                                     [(longlong)pbVar16]) >> 0x1f;
            uVar20 = (ulonglong)uVar9;
            uVar10 = (ulonglong)
                     ((int)uVar10 +
                     (((uint)*pbVar16 -
                       (uint)(byte)(&stack0x00000068 + (lVar5 - (longlong)pbVar13))
                                   [(longlong)pbVar16] ^ uVar9) - uVar9));
            uVar22 = (ulonglong)((int)uVar22 + 1);
          }
          pbVar16 = pbVar16 + 1;
          lVar19 = lVar19 + -1;
        } while (lVar19 != 0);
        lVar18 = *(longlong *)(&stack0x00000038 + lVar5);
      }
      iVar11 = (int)uVar10;
      lVar14 = lVar14 + lVar18;
      uVar8 = uVar8 - 1;
    } while (uVar8 != 0);
    param_2 = *(int **)((longlong)&piStackX32 + lVar5);
    iVar21 = (int)uVar22;
    if (iVar21 != 0) {
      iVar4 = (iVar21 >> 1) + iVar11;
      iVar11 = iVar4 / iVar21;
      uVar20 = (longlong)iVar4 % (longlong)iVar21 & 0xffffffff;
    }
  }
  if (*(int *)(&stack0x00000008 + lVar5) < iVar11) {
    iVar21 = *(int *)((longlong)aiStackX16 + lVar5);
    if ((DAT_1800b20b0 < 100) && (0x5a < iVar21)) {
      *(int **)(&stack0xfffffffffffffff0 + lVar5) = param_2;
      *(ulonglong *)(&stack0xffffffffffffffe8 + lVar5) = uVar8;
      DAT_1800b20b0 = 5;
      *(undefined8 *)((longlong)&uStack64 + lVar5) = 0x18002726b;
      FUN_180022c70(*(ulonglong *)(&stack0x00000050 + lVar5),uVar20,lVar19,
                    *(void ***)(&stack0x00000048 + lVar5),
                    *(longlong **)(&stack0xffffffffffffffe8 + lVar5),
                    *(int **)(&stack0xfffffffffffffff0 + lVar5));
    }
    pbVar16 = &DAT_1800cec14;
    uVar12 = 0x7531;
    if (iVar21 < 0x29) {
      uVar12 = (undefined4)uVar8;
    }
    uVar23 = 2;
    if (iVar21 < 0x29) {
      uVar23 = 4;
    }
    DAT_1800b20b0 = uVar2;
    if (pbVar13 == (byte *)0x0) {
      uVar20 = (ulonglong)*(uint *)((longlong)aiStackX16 + lVar5 + 8);
    }
    else {
      uVar9 = *(uint *)((longlong)aiStackX16 + lVar5 + 8);
      uVar20 = (ulonglong)uVar9;
      if ((uVar9 != 0) &&
         (((pbVar13 + uVar20 < &DAT_1800cec15 || (&DAT_1800cec14 + uVar20 <= pbVar13)) &&
          (uVar9 != 0)))) {
        uVar10 = uVar20;
        do {
          *pbVar16 = (pbVar13 + -0x1800cec14)[(longlong)pbVar16];
          pbVar16 = pbVar16 + 1;
          uVar10 = uVar10 - 1;
        } while (uVar10 != 0);
      }
    }
    *(undefined4 *)(&stack0x0000000c + lVar5) = uVar12;
    puVar17 = &DAT_1800d38a4;
    uVar8 = (ulonglong)uVar23;
    if (pbVar13 != (byte *)0x0) {
      *(undefined4 *)(&stack0x0000000c + lVar5) = uVar12;
      if (((int)uVar20 != 0) &&
         ((pbVar13 + uVar20 < &DAT_1800d38a5 ||
          (*(undefined4 *)(&stack0x0000000c + lVar5) = uVar12, &DAT_1800d38a4 + uVar20 <= pbVar13)))
         ) {
        *(undefined4 *)(&stack0x0000000c + lVar5) = uVar12;
        uVar8 = (ulonglong)uVar23;
        if ((int)uVar20 != 0) {
          do {
            *puVar17 = puVar17[(longlong)(pbVar13 + -0x1800d38a4)];
            puVar17 = puVar17 + 1;
            uVar20 = uVar20 - 1;
          } while (uVar20 != 0);
          *(undefined4 *)(&stack0x0000000c + lVar5) = uVar12;
        }
      }
    }
  }
  *(undefined4 *)(&stack0xfffffffffffffff0 + lVar5) =
       *(undefined4 *)((longlong)aiStackX16 + lVar5 + 4);
  *(int *)(&stack0xffffffffffffffe8 + lVar5) = (int)uVar8;
  *(undefined8 *)((longlong)&uStack64 + lVar5) = 0x180027379;
  FUN_18002d6f0(pbVar13,*(longlong *)(&stack0x00000030 + lVar5),*(int *)(&stack0x0000002c + lVar5),
                *(int *)(&stack0x00000028 + lVar5),*(int *)(&stack0xffffffffffffffe8 + lVar5),
                *(int *)(&stack0xfffffffffffffff0 + lVar5));
  pvVar6 = *(void **)(&stack0x00000040 + lVar5);
  **(undefined4 **)(&stack0x00000058 + lVar5) = (int)uVar8;
  *(undefined8 *)((longlong)&uStack64 + lVar5) = 0x18002738f;
  free(pvVar6,*(undefined *)((longlong)&uStack64 + lVar5));
  *(undefined8 *)((longlong)&uStack64 + lVar5) = 0x1800273a3;
  FUN_18005f100(*(ulonglong *)(&stack0x00004cf8 + lVar5) ^
                (ulonglong)(&stack0xffffffffffffffc8 + lVar5),
                *(undefined *)((longlong)&uStack64 + lVar5));
  return;
}



undefined8 FUN_180027410(int *param_1,longlong param_2)

{
  undefined2 *puVar1;
  ushort *puVar2;
  short sVar3;
  uint uVar4;
  int iVar5;
  longlong lVar6;
  longlong lVar7;
  short *psVar8;
  ulonglong uVar9;
  longlong lVar10;
  int iVar11;
  longlong lVar12;
  int iVar13;

  uVar4 = param_1[1];
  uVar9 = (ulonglong)uVar4;
  iVar11 = param_1[2];
  lVar6 = 0;
  iVar5 = *param_1;
  lVar10 = (longlong)iVar5;
  iVar13 = param_1[6];
  if (0 < (longlong)iVar11) {
    do {
      if (0xfff < *(ushort *)(param_2 + lVar6 * 2)) {
        *(undefined2 *)(param_2 + lVar6 * 2) = 0xfff;
      }
      lVar6 = lVar6 + 1;
    } while (lVar6 < iVar11);
  }
  if (iVar13 - 0x3eU < 2) {
    puVar2 = (ushort *)(param_2 + (longlong)((int)((uVar4 - 1) * iVar5) / 2) * 2);
    puVar2[-1] = (ushort)((uint)puVar2[lVar10 + -1] + (uint)puVar2[-1 - lVar10] + (uint)puVar2[-2] +
                          (uint)*puVar2 >> 2);
    return 0;
  }
  lVar6 = (longlong)(iVar5 + -1);
  if (1 < lVar6) {
    iVar13 = (uVar4 - 1) * iVar5;
    psVar8 = (short *)(param_2 + 2 + lVar10 * 2);
    lVar12 = 1;
    iVar11 = iVar13;
    do {
      iVar11 = iVar11 + 1;
      if ((*psVar8 == 0xfff) || (*psVar8 == 0)) {
        *psVar8 = *(short *)(param_2 + (lVar10 * 2 + lVar12) * 2);
      }
      lVar7 = (longlong)(int)(((uVar4 - (uVar4 - 1)) + -2) * iVar5 + iVar11);
      sVar3 = *(short *)(param_2 + lVar7 * 2);
      puVar1 = (undefined2 *)(param_2 + lVar7 * 2);
      if ((sVar3 == 0xfff) || (sVar3 == 0)) {
        *puVar1 = *(undefined2 *)
                   (param_2 + (longlong)(int)(((uVar4 - 3) * iVar5 - iVar13) + iVar11) * 2);
      }
      lVar12 = lVar12 + 1;
      psVar8[-lVar10] = *psVar8;
      psVar8 = psVar8 + 1;
      *(undefined2 *)(param_2 + (longlong)iVar11 * 2) = *puVar1;
    } while (lVar12 < lVar6);
  }
  if (0 < (int)uVar4) {
    lVar12 = (longlong)(iVar5 + -2);
    psVar8 = (short *)(lVar12 * 2 + param_2);
    do {
      if ((psVar8[1 - lVar12] == 0xfff) || (psVar8[1 - lVar12] == 0)) {
        psVar8[1 - lVar12] = psVar8[2 - lVar12];
      }
      if ((*psVar8 == 0xfff) || (*psVar8 == 0)) {
        *psVar8 = psVar8[(iVar5 + -3) - lVar12];
      }
      psVar8[-lVar12] = psVar8[1 - lVar12];
      psVar8[lVar6 - lVar12] = *psVar8;
      psVar8 = psVar8 + lVar10;
      uVar9 = uVar9 - 1;
    } while (uVar9 != 0);
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180027640(uint **param_1,undefined *param_2,undefined8 param_3,undefined8 param_4,
                  uint param_5,undefined8 param_6,undefined8 param_7,int *param_8,int *param_9,
                  int *param_10)

{
  byte *pbVar1;
  int *_Memory;
  uint **ppuVar2;
  int *piVar3;
  short sVar4;
  int iVar5;
  undefined *_Memory_00;
  undefined8 uVar6;
  int *piVar7;
  int *_Memory_01;
  uint *puVar8;
  ulonglong uVar9;
  byte *pbVar10;
  ulonglong uVar11;
  ulonglong uVar12;
  longlong lVar13;
  longlong lVar14;
  uint uVar15;
  ulonglong uVar16;
  ulonglong uVar17;
  undefined *puVar18;
  uint uVar19;
  uint uVar20;
  void *_Memory_02;
  uint uVar21;
  uint uVar22;
  bool bVar23;
  int iVar24;
  int iVar25;
  int iVar26;
  int iVar27;
  int iVar28;
  int iVar29;
  int iVar30;
  undefined in_XMM1 [16];
  undefined in_XMM2 [16];
  undefined8 local_120;
  void **local_118;
  undefined *local_110;
  int *local_100;
  uint local_f8;
  uint local_f4;
  uint local_f0;
  undefined4 local_ec;
  int local_e8 [2];
  int *local_e0;
  uint **local_d8;
  int local_d0;
  uint local_cc;
  int *local_c8;
  int *local_c0;
  uint local_b8;
  uint local_b4;
  uint local_b0;
  uint local_ac;
  uint local_a8;
  uint local_a4;
  uint local_a0;
  undefined4 local_9c;
  uint local_98;
  uint local_94;
  uint local_90;
  uint local_8c;
  undefined4 local_88;
  undefined *local_80;
  void *local_78 [8];
  void *local_38;
  ulonglong local_30;

  local_30 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffea8;
  uVar12 = 0;
  local_c0 = param_8;
  local_c8 = param_9;
  local_d0 = DAT_1800d8548;
  local_f8 = param_5 >> 0x17;
  local_f4 = (int)param_5 >> 0xe & 0x1ff;
  local_cc = (int)param_5 >> 2 & 1;
  uVar19 = local_f4 * local_f8;
  uVar9 = (ulonglong)uVar19;
  uVar22 = (int)param_5 >> 1 & 1;
  uVar21 = (int)param_5 >> 3 & 0x3f;
  uVar15 = 0;
  local_ec = 0;
  local_9c = DAT_1800d8534;
  local_f0 = uVar21;
  local_d8 = param_1;
  local_b8 = local_f8;
  local_b4 = local_f4;
  local_b0 = uVar19;
  local_ac = param_5 & 1;
  local_a8 = uVar22;
  local_a4 = local_cc;
  local_a0 = uVar21;
  _Memory_00 = (undefined *)malloc(uVar9 * 2);
  if (_Memory_00 != (undefined *)0x0) {
    uVar16 = (ulonglong)(uVar19 * 2);
    if ((((param_2 != (undefined *)0x0) && (uVar19 != 0)) &&
        ((param_2 + uVar16 <= _Memory_00 || (_Memory_00 + uVar16 <= param_2)))) && (uVar19 != 0)) {
      puVar18 = _Memory_00;
      do {
        *puVar18 = (param_2 + -(longlong)_Memory_00)[(longlong)puVar18];
        puVar18 = puVar18 + 1;
        uVar16 = uVar16 - 1;
      } while (uVar16 != 0);
    }
    if (uVar19 != 0) {
      uVar16 = uVar9;
      puVar18 = &DAT_1800cec14;
      while (uVar16 != 0) {
        uVar16 = uVar16 - 1;
        *puVar18 = 0;
        puVar18 = puVar18 + 1;
      }
      if (uVar19 != 0) {
        uVar16 = uVar9;
        puVar18 = &DAT_1800d38a4;
        while (uVar16 != 0) {
          uVar16 = uVar16 - 1;
          *puVar18 = 0;
          puVar18 = puVar18 + 1;
        }
      }
    }
    uVar6 = FUN_180027410((int *)&local_b8,(longlong)_Memory_00);
    if ((int)uVar6 == 0) {
      if (DAT_1800d8544 == 0) {
        uVar16 = uVar12;
        uVar17 = uVar12;
        if (uVar9 != 0) {
          do {
            uVar11 = uVar16 + 1;
            uVar15 = (int)uVar17 + (uint)*(ushort *)(_Memory_00 + uVar16 * 2);
            uVar16 = uVar11;
            uVar17 = (ulonglong)uVar15;
          } while ((longlong)uVar11 < (longlong)uVar9);
        }
        lVar13 = (longlong)(int)((uVar19 >> 1) + uVar15);
        uVar16 = lVar13 / (longlong)(int)uVar19 & 0xffffffff;
        _DAT_1800e9700 = (undefined4)uVar16;
        if ((1 < uVar21 - 0x3e) ||
           (iVar5 = FUN_180020fe0(_Memory_00,lVar13 % (longlong)(int)uVar19 & 0xffffffff),
           iVar5 == 0)) {
          if (uVar9 != 0) {
            do {
              sVar4 = *(short *)(_Memory_00 + uVar12 * 2);
              if ((uVar22 != 0) && (sVar4 = sVar4 - (short)uVar16, (param_5 & 1) != 0)) {
                sVar4 = sVar4 + 0xfff;
              }
              *(short *)((longlong)&DAT_1800bb9d4 + uVar12 * 2) = sVar4;
              uVar12 = uVar12 + 1;
            } while ((longlong)uVar12 < (longlong)uVar9);
          }
          DAT_1800d8544 = 1;
        }
        *local_c0 = 0;
        *local_c8 = 0;
        free(_Memory_00);
      }
      else {
        local_e8[0] = 0;
        piVar7 = (int *)malloc(0x4c9c);
        local_e0 = piVar7;
        _Memory_01 = (int *)malloc(0x4fc4);
        ppuVar2 = local_d8;
        if ((piVar7 == (int *)0x0) || (_Memory_01 == (int *)0x0)) {
          free(_Memory_00);
        }
        else {
          if (*local_d8 == (uint *)0x0) {
            puVar8 = (uint *)FUN_180022ff0(local_f8,local_f4,1);
            *ppuVar2 = puVar8;
          }
          puVar18 = *(undefined **)(*ppuVar2 + 6);
          if ((puVar18 != (undefined *)0x0) && (uVar16 = uVar9, uVar19 != 0)) {
            while (uVar16 != 0) {
              *puVar18 = 0;
              uVar16 = uVar16 - 1;
              puVar18 = puVar18 + 1;
            }
          }
          puVar8 = &local_b8;
          puVar18 = (undefined *)&DAT_1800bb9d4;
          FUN_1800260b0((longlong)_Memory_00,&DAT_1800bb9d4,(int *)puVar8,piVar7);
          bVar23 = local_f0 != 0x14;
          local_38 = (void *)0x0;
          if (bVar23) {
            local_38 = malloc(uVar9 * 2);
          }
          _Memory_02 = local_38;
          FUN_180022c70((ulonglong)_Memory_00,puVar18,puVar8,local_78,(longlong *)&local_38,
                        (int *)&local_b8);
          FUN_1800252b0(&DAT_1800c52f4,&DAT_1800cec14,&local_b8,(longlong)local_e0);
          local_80 = &DAT_1800cec14;
          local_98 = local_f8;
          local_94 = local_f4;
          local_90 = local_f8;
          local_88 = 1;
          local_8c = uVar19;
          piVar7 = FUN_180022ff0(local_f8,local_f4,1);
          puVar8 = &local_98;
          FUN_180035ae0((int *)puVar8,(longlong)piVar7,1,100,0xff);
          iVar5 = 1;
          if ((local_f0 < 0x15) &&
             (puVar8 = (uint *)0x10000d, (0x10000dU >> (local_f0 & 0x1f) & 1) != 0)) {
            iVar5 = 0;
          }
          FUN_180025d90(puVar8,local_d0,iVar5,*(undefined **)(*local_d8 + 6),&DAT_1800d8534,
                        &local_b8,(longlong)local_e0);
          _Memory = local_e0;
          if (bVar23) {
            local_100 = local_e8;
            local_118 = local_78;
            local_120 = *(undefined8 *)(*local_d8 + 6);
            local_110 = _Memory_00;
            local_ec = FUN_180026f00(param_10,(int *)&local_b8,(longlong *)&local_38);
            _Memory_02 = local_38;
          }
          if (_Memory_02 != (void *)0x0) {
            free(_Memory_02);
          }
          if (piVar7 != (int *)0x0) {
            free(piVar7);
          }
          piVar3 = local_c0;
          piVar7 = local_c8;
          ppuVar2 = local_d8;
          FUN_180013600(*local_d8,param_5,local_c0,local_c8);
          if (*piVar7 < 6) {
            *piVar3 = 0;
          }
          if ((((local_cc != 0) && (*piVar3 < 0x23)) && (local_f0 != 0x14)) &&
             ((local_e8[0] == 0 && (*_Memory_01 != 0)))) {
            uVar19 = 199;
            in_XMM2 = in_XMM2 & (undefined  [16])0x0;
            in_XMM1 = in_XMM1 & (undefined  [16])0x0;
            uVar9 = uVar12;
            do {
              piVar7 = _Memory_01 + uVar9 + 0x1326;
              iVar5 = *piVar7 + SUB164(in_XMM2,0);
              iVar25 = piVar7[1] + SUB164(in_XMM2 >> 0x20,0);
              iVar27 = piVar7[2] + SUB164(in_XMM2 >> 0x40,0);
              iVar29 = piVar7[3] + SUB164(in_XMM2 >> 0x60,0);
              in_XMM2 = CONCAT412(iVar29,CONCAT48(iVar27,CONCAT44(iVar25,iVar5)));
              piVar7 = _Memory_01 + uVar9 + 0x132a;
              uVar9 = uVar9 + 8;
              iVar24 = *piVar7 + SUB164(in_XMM1,0);
              iVar26 = piVar7[1] + SUB164(in_XMM1 >> 0x20,0);
              iVar28 = piVar7[2] + SUB164(in_XMM1 >> 0x40,0);
              iVar30 = piVar7[3] + SUB164(in_XMM1 >> 0x60,0);
              in_XMM1 = CONCAT412(iVar30,CONCAT48(iVar28,CONCAT44(iVar26,iVar24)));
            } while ((longlong)uVar9 < 200);
            uVar21 = iVar24 + iVar5 + iVar28 + iVar27 + iVar26 + iVar25 + iVar30 + iVar29;
            uVar9 = uVar12;
            uVar16 = uVar12;
            uVar17 = uVar12;
            do {
              uVar22 = (int)uVar16 + _Memory_01[uVar9 + 0x1326];
              uVar16 = (ulonglong)uVar22;
              iVar5 = (int)uVar17;
              if (uVar21 * 0x1e < uVar22 * 100) break;
              uVar17 = (ulonglong)((int)uVar17 + 1);
              uVar9 = uVar9 + 1;
              iVar5 = 199;
            } while ((longlong)uVar9 < 200);
            lVar13 = 199;
            do {
              uVar20 = (int)uVar12 + _Memory_01[lVar13 + 0x1326];
              uVar12 = (ulonglong)uVar20;
              uVar22 = uVar19;
              if (uVar21 / 10 < uVar20) break;
              uVar19 = uVar19 - 1;
              lVar13 = lVar13 + -1;
              uVar22 = uVar15;
            } while (-1 < lVar13);
            _Memory_01[0x13ee] = uVar22;
            _Memory_01[0x13ef] = iVar5;
            if (((iVar5 < 0x14) ||
                ((uVar22 != iVar5 * 3 &&
                  SBORROW4(uVar22,iVar5 * 3) == (int)(uVar22 + iVar5 * -3) < 0 && (iVar5 < 0x28))))
               || ((iVar24 = (int)(_Memory_01[0x13f0] + (_Memory_01[0x13f0] >> 0x1f & 3U)) >> 2,
                   _Memory_01[0x13ed] != iVar24 && iVar24 <= _Memory_01[0x13ed] && (iVar5 < 0x3c))))
            {
              pbVar1 = *(byte **)(*ppuVar2 + 6);
              uVar12 = (ulonglong)local_f8;
              lVar13 = uVar12 - 8;
              if (0 < lVar13) {
                lVar14 = (uVar12 - 9 >> 1) + 1;
                pbVar10 = pbVar1;
                do {
                  *pbVar10 = *pbVar10 & 0xfe;
                  pbVar10 = pbVar10 + 2;
                  lVar14 = lVar14 + -1;
                } while (lVar14 != 0);
              }
              if (1 < lVar13) {
                pbVar10 = pbVar1 + 1;
                lVar14 = (uVar12 - 10 >> 1) + 1;
                do {
                  *pbVar10 = *pbVar10 | 1;
                  pbVar10 = pbVar10 + 2;
                  lVar14 = lVar14 + -1;
                } while (lVar14 != 0);
              }
              pbVar1[lVar13] = pbVar1[lVar13] | 1;
              pbVar1[(ulonglong)local_f8 - 7] = pbVar1[(ulonglong)local_f8 - 7] & 0xfe;
              pbVar1[(ulonglong)local_f8 - 6] = pbVar1[(ulonglong)local_f8 - 6] & 0xfe;
              local_ec = 0x7531;
            }
          }
          free(_Memory_01);
          free(_Memory);
          free(_Memory_00);
        }
      }
    }
    else {
      *local_c0 = 0;
      *local_c8 = 0;
      free(_Memory_00);
    }
  }
  FUN_18005f100(local_30 ^ (ulonglong)&stack0xfffffffffffffea8);
  return;
}



undefined8 FUN_180027ce0(undefined4 *param_1,undefined2 *param_2,longlong param_3,ulonglong param_4)

{
  undefined *puVar1;
  ushort uVar2;
  uint uVar3;
  int iVar4;
  ushort *_Memory;
  undefined *_Memory_00;
  undefined *puVar5;
  ushort *puVar6;
  ulonglong uVar7;
  longlong lVar8;
  ulonglong uVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  undefined2 *puVar13;
  ulonglong uVar14;
  ulonglong uVar15;
  uint uVar16;
  int iVar17;
  uint local_44;

  uVar14 = (param_4 & 0xffffffff) >> 0x17;
  iVar12 = (int)uVar14;
  uVar16 = (int)param_4 >> 0xe & 0x1ff;
  uVar3 = uVar16 * iVar12;
  iVar10 = 0;
  local_44 = 0;
  iVar17 = 0;
  uVar15 = (ulonglong)uVar3;
  _Memory = (ushort *)malloc((ulonglong)uVar3 * 2);
  if (_Memory == (ushort *)0x0) {
    return 0x80000004;
  }
  _Memory_00 = (undefined *)malloc((ulonglong)uVar3 * 2);
  if (_Memory_00 != (undefined *)0x0) {
    uVar9 = (ulonglong)(uVar3 * 2);
    puVar1 = (undefined *)(param_3 + 0x9924);
    if ((((puVar1 != (undefined *)0x0) && (uVar3 != 0)) &&
        ((puVar1 + uVar9 <= _Memory_00 || (_Memory_00 + uVar9 <= puVar1)))) && (uVar3 != 0)) {
      puVar5 = _Memory_00;
      uVar7 = uVar9;
      do {
        *puVar5 = puVar5[(longlong)(puVar1 + -(longlong)_Memory_00)];
        puVar5 = puVar5 + 1;
        uVar7 = uVar7 - 1;
      } while (uVar7 != 0);
    }
    if (iVar12 != 0) {
      iVar11 = (uVar16 - 1) * iVar12;
      puVar13 = param_2;
      uVar7 = uVar14;
      do {
        *puVar13 = puVar13[uVar14];
        puVar13 = puVar13 + 1;
        iVar4 = ((uVar16 - (uVar16 - 1)) + -2) * iVar12 + iVar11;
        lVar8 = (longlong)iVar11;
        iVar11 = iVar11 + 1;
        param_2[lVar8] = param_2[iVar4];
        uVar7 = uVar7 - 1;
      } while (uVar7 != 0);
    }
    if (uVar16 != 0) {
      lVar8 = (longlong)(iVar12 + -1);
      puVar13 = param_2 + lVar8;
      uVar7 = (ulonglong)uVar16;
      do {
        puVar13[-lVar8] = puVar13[1 - lVar8];
        *puVar13 = puVar13[(iVar12 + -2) - lVar8];
        puVar13 = puVar13 + uVar14;
        uVar7 = uVar7 - 1;
      } while (uVar7 != 0);
    }
    iVar11 = 0;
    iVar12 = 0;
    lVar8 = 0;
    if (1 < uVar15) {
      iVar12 = 0;
      iVar11 = 0;
      do {
        iVar11 = iVar11 + (uint)*(ushort *)(_Memory_00 + lVar8 * 2);
        iVar12 = iVar12 + (uint)*(ushort *)(_Memory_00 + lVar8 * 2 + 2);
        lVar8 = lVar8 + 2;
      } while (lVar8 < (longlong)(uVar15 - 1));
    }
    if (lVar8 < (longlong)uVar15) {
      local_44 = (uint)*(ushort *)(_Memory_00 + lVar8 * 2);
    }
    if (iVar12 + iVar11 + local_44 != 0) {
      if (((param_2 != (undefined2 *)0x0) && (uVar3 != 0)) &&
         ((((ushort *)(uVar9 + (longlong)param_2) <= _Memory ||
           ((undefined2 *)(uVar9 + (longlong)_Memory) <= param_2)) && (uVar3 != 0)))) {
        puVar6 = _Memory;
        do {
          *(undefined *)puVar6 =
               *(undefined *)((longlong)((longlong)param_2 - (longlong)_Memory) + (longlong)puVar6);
          puVar6 = (ushort *)((longlong)puVar6 + 1);
          uVar9 = uVar9 - 1;
        } while (uVar9 != 0);
      }
      if (uVar15 != 0) {
        puVar6 = _Memory;
        uVar14 = uVar15;
        do {
          uVar16 = (uint)*(ushort *)(_Memory_00 + -(longlong)_Memory + (longlong)puVar6);
          iVar12 = *puVar6 - uVar16;
          if (iVar12 < 1) {
            iVar12 = uVar16 - *puVar6;
          }
          if (0x32 < iVar12) {
            iVar10 = iVar10 + 1;
            iVar17 = iVar17 + iVar12;
          }
          puVar6 = puVar6 + 1;
          uVar14 = uVar14 - 1;
        } while (uVar14 != 0);
        if (0 < iVar10) {
          iVar12 = 0;
          puVar6 = _Memory;
          do {
            uVar2 = *puVar6;
            uVar16 = (uint)*(ushort *)
                            ((longlong)puVar6 + (longlong)(_Memory_00 + -(longlong)_Memory));
            iVar11 = uVar16 - uVar2;
            if (iVar11 < 1) {
              iVar11 = uVar2 - uVar16;
            }
            if ((iVar11 < (iVar17 / iVar10) / 5) || (((param_4 & 2) != 0 && (uVar2 == 0xfff)))) {
              iVar12 = iVar12 + 1;
            }
            puVar6 = puVar6 + 1;
            uVar15 = uVar15 - 1;
          } while (uVar15 != 0);
          if (SBORROW4(iVar12 * 10,uVar3 * 4) != (int)(iVar12 * 10 + uVar3 * -4) < 0) {
            free(_Memory);
            free(_Memory_00);
            *param_1 = 0;
            return 0;
          }
        }
      }
    }
    free(_Memory);
    free(_Memory_00);
    *param_1 = 1;
    return 0;
  }
  free(_Memory);
  return 0x80000004;
}



void FUN_180028020(longlong param_1,int param_2)

{
  undefined8 uVar1;
  undefined8 *puVar2;
  ulonglong uVar3;
  longlong lVar4;
  longlong lVar5;
  int iStackX28;

  if (1 < param_2) {
    lVar5 = 1;
    uVar3 = (ulonglong)(param_2 - 1);
    do {
      uVar1 = *(undefined8 *)(param_1 + lVar5 * 8);
      lVar4 = lVar5;
      if (0 < lVar5) {
        iStackX28 = (int)((ulonglong)uVar1 >> 0x20);
        puVar2 = (undefined8 *)(param_1 + -8 + lVar5 * 8);
        do {
          if ((*(int *)puVar2 <= (int)uVar1) &&
             ((*(int *)puVar2 != (int)uVar1 ||
              (*(int *)((longlong)puVar2 + 4) == iStackX28 ||
               *(int *)((longlong)puVar2 + 4) < iStackX28)))) break;
          lVar4 = lVar4 + -1;
          puVar2[1] = *puVar2;
          puVar2 = puVar2 + -1;
        } while (0 < lVar4);
      }
      lVar5 = lVar5 + 1;
      *(undefined8 *)(param_1 + lVar4 * 8) = uVar1;
      uVar3 = uVar3 - 1;
    } while (uVar3 != 0);
  }
  return;
}



void FUN_1800280a0(longlong param_1,int param_2)

{
  undefined8 uVar1;
  undefined8 *puVar2;
  ulonglong uVar3;
  longlong lVar4;
  longlong lVar5;
  int iStackX28;

  if (1 < param_2) {
    lVar5 = 1;
    uVar3 = (ulonglong)(param_2 - 1);
    do {
      uVar1 = *(undefined8 *)(param_1 + lVar5 * 8);
      lVar4 = lVar5;
      if (0 < lVar5) {
        iStackX28 = (int)((ulonglong)uVar1 >> 0x20);
        puVar2 = (undefined8 *)(param_1 + -8 + lVar5 * 8);
        do {
          if ((*(int *)puVar2 <= (int)uVar1) &&
             ((*(int *)puVar2 != (int)uVar1 ||
              (*(int *)((longlong)puVar2 + 4) == iStackX28 ||
               *(int *)((longlong)puVar2 + 4) < iStackX28)))) break;
          lVar4 = lVar4 + -1;
          puVar2[1] = *puVar2;
          puVar2 = puVar2 + -1;
        } while (0 < lVar4);
      }
      lVar5 = lVar5 + 1;
      *(undefined8 *)(param_1 + lVar4 * 8) = uVar1;
      uVar3 = uVar3 - 1;
    } while (uVar3 != 0);
  }
  return;
}



void FUN_180028120(uint *param_1,uint param_2)

{
  uint uVar1;
  uint uVar2;
  ulonglong uVar3;
  uint *puVar4;
  uint uVar5;
  ulonglong uVar6;

  if (1 < param_2) {
    do {
      uVar1 = *param_1;
      uVar2 = param_2 - 1;
      uVar3 = (ulonglong)uVar2;
      uVar6 = 0;
      if (uVar2 != 0) {
        if (uVar2 == 0) goto LAB_18002815c;
LAB_180028150:
        do {
          if (uVar1 <= param_1[uVar3]) {
            uVar2 = (int)uVar3 - 1;
            uVar3 = (ulonglong)uVar2;
            if ((uint)uVar6 < uVar2) goto LAB_180028150;
          }
LAB_18002815c:
          uVar2 = param_1[uVar6];
          puVar4 = param_1 + uVar6;
          *puVar4 = param_1[uVar3];
          param_1[uVar3] = uVar2;
          uVar5 = (uint)uVar6;
          while ((uVar5 < (uint)uVar3 && (*puVar4 < uVar1))) {
            uVar5 = (uint)uVar6 + 1;
            uVar6 = (ulonglong)uVar5;
            puVar4 = puVar4 + 1;
          }
          uVar5 = param_1[uVar6];
          param_1[uVar6] = uVar2;
          param_1[uVar3] = uVar5;
        } while ((uint)uVar6 < (uint)uVar3);
      }
      FUN_180028120(param_1,(uint)uVar6);
      param_1 = param_1 + uVar6 + 1;
      param_2 = param_2 + (-1 - (uint)uVar6);
    } while (1 < param_2);
  }
  return;
}



undefined8
FUN_1800281f0(int *param_1,int param_2,int param_3,int param_4,int param_5,int param_6,int *param_7,
             int *param_8)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int *piVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  longlong lVar14;
  int iVar15;
  uint uVar16;
  int *piVar17;

  uVar16 = 0;
  iVar7 = param_1[1];
  iVar11 = param_7[2];
  iVar6 = param_7[5];
  piVar8 = param_8 + 8;
  iVar4 = param_7[3] * (param_3 + -1);
  iVar2 = *param_1;
  iVar15 = *param_7 * (param_3 + -1);
  iVar13 = param_7[4] * (param_2 + -1);
  iVar12 = iVar11 + 0x80 >> 8;
  iVar1 = iVar6 + 0x80 + iVar4 >> 8;
  iVar10 = iVar6 + 0x80 >> 8;
  iVar9 = iVar11 + 0x80 + iVar15 >> 8;
  iVar5 = param_7[1] * (param_2 + -1);
  iVar3 = iVar6 + iVar13 + iVar4 + 0x80 >> 8;
  iVar15 = iVar15 + 0x80 + iVar11 + iVar5 >> 8;
  iVar4 = iVar11 + 0x80 + iVar5 >> 8;
  iVar6 = iVar13 + 0x80 + iVar6 >> 8;
  iVar11 = iVar3;
  if (iVar6 <= iVar3) {
    iVar11 = iVar6;
  }
  iVar5 = iVar1;
  if ((iVar11 <= iVar1) && (iVar5 = iVar6, iVar3 < iVar6)) {
    iVar5 = iVar3;
  }
  iVar13 = iVar10;
  if (((iVar5 <= iVar10) && (iVar13 = iVar1, iVar11 <= iVar1)) && (iVar13 = iVar6, iVar3 < iVar6)) {
    iVar13 = iVar3;
  }
  iVar11 = iVar3;
  if (iVar3 <= iVar6) {
    iVar11 = iVar6;
  }
  iVar5 = iVar1;
  if ((iVar1 <= iVar11) && (iVar5 = iVar6, iVar6 < iVar3)) {
    iVar5 = iVar3;
  }
  if (((iVar10 <= iVar5) && (iVar10 = iVar1, iVar1 <= iVar11)) && (iVar10 = iVar6, iVar6 < iVar3)) {
    iVar10 = iVar3;
  }
  iVar11 = iVar15;
  if (iVar4 <= iVar15) {
    iVar11 = iVar4;
  }
  iVar6 = iVar9;
  if ((iVar11 <= iVar9) && (iVar6 = iVar4, iVar15 < iVar4)) {
    iVar6 = iVar15;
  }
  iVar1 = iVar12;
  if (((iVar6 <= iVar12) && (iVar1 = iVar9, iVar11 <= iVar9)) && (iVar1 = iVar4, iVar15 < iVar4)) {
    iVar1 = iVar15;
  }
  iVar11 = iVar15;
  if (iVar15 <= iVar4) {
    iVar11 = iVar4;
  }
  iVar6 = iVar9;
  if ((iVar9 <= iVar11) && (iVar6 = iVar4, iVar4 < iVar15)) {
    iVar6 = iVar15;
  }
  if (((iVar12 <= iVar6) && (iVar12 = iVar9, iVar9 <= iVar11)) && (iVar12 = iVar4, iVar4 < iVar15))
  {
    iVar12 = iVar15;
  }
  iVar6 = (iVar12 - iVar1) + 1;
  iVar11 = (iVar10 - iVar13) + 1;
  if ((iVar6 < 0x201) && (iVar11 < 0x201)) {
    if ((piVar8 != (int *)0x0) && ((param_7 + 6 <= piVar8 || (param_8 + 0xe <= param_7)))) {
      piVar17 = (int *)((longlong)param_7 - (longlong)piVar8);
      lVar14 = 0x18;
      do {
        *(undefined *)piVar8 = *(undefined *)((longlong)piVar17 + (longlong)piVar8);
        piVar8 = (int *)((longlong)piVar8 + 1);
        lVar14 = lVar14 + -1;
      } while (lVar14 != 0);
    }
    param_8[10] = param_8[10] + iVar1 * -0x100;
    param_8[0xd] = param_8[0xd] + iVar13 * -0x100;
    iVar13 = param_4 + iVar13;
    iVar12 = -iVar13;
    if (-1 < iVar13) {
      iVar12 = 0;
    }
    iVar10 = 0;
    if (-1 < iVar13) {
      iVar10 = iVar13;
    }
    iVar1 = iVar1 + param_5;
    iVar4 = iVar1;
    if (iVar1 < 0) {
      iVar4 = 0;
      uVar16 = -iVar1;
      if (param_6 != 0) {
        iVar4 = (((int)(uVar16 + 7) >> 0x1f & 7U) + uVar16 + 7 & 0xfffffff8) + iVar1;
      }
    }
    iVar1 = iVar10 + iVar11;
    if (iVar10 + iVar11 <= iVar7 + iVar12) {
      iVar1 = iVar7 + iVar12;
    }
    if (param_6 == 0) {
      iVar2 = iVar2 + uVar16;
      iVar3 = 1;
      iVar7 = iVar6 + iVar4;
      if (iVar6 + iVar4 <= iVar2) {
        iVar7 = iVar2;
      }
    }
    else {
      iVar3 = 8;
      uVar16 = ((int)(uVar16 + 7) >> 0x1f & 7U) + uVar16 + 7 & 0xfffffff8;
      iVar7 = uVar16 + iVar2 * 8;
      iVar2 = iVar6 + iVar4;
      if (iVar6 + iVar4 <= iVar7) {
        iVar2 = iVar7;
      }
      iVar7 = (int)((iVar2 + 7 >> 0x1f & 7U) + iVar2 + 7) >> 3;
    }
    if ((iVar1 < 0x4b1) && (iVar3 * iVar7 < 0x321)) {
      *param_8 = iVar4;
      param_8[1] = iVar10;
      param_8[2] = uVar16;
      param_8[3] = iVar12;
      param_8[5] = iVar6;
      param_8[4] = iVar11;
      param_8[6] = iVar7;
      param_8[7] = iVar1;
      return 1;
    }
  }
  return 0;
}



void FUN_180028500(int *param_1,uint *param_2,undefined8 param_3,int *param_4,int *param_5,
                  int *param_6,int *param_7)

{
  char cVar1;
  int iVar2;
  longlong lVar3;
  longlong lVar4;
  char *pcVar5;
  undefined8 uVar6;
  int *_Memory;
  int *piVar7;
  int iVar8;
  ulonglong uVar9;
  undefined *puVar10;
  uint uVar11;
  int *piVar12;
  uint uVar13;
  int *piVar14;
  undefined *puVar15;
  undefined *puVar16;
  uint uVar17;
  int iVar18;
  int *_Memory_00;
  int local_a8;
  int local_a4;
  int local_a0;
  int local_9c;
  uint *local_98;
  int *local_90;
  int *local_88;
  int *local_80;
  int local_78;
  int local_74;
  int local_70;
  int local_6c;
  uint local_68;
  uint local_64;
  int local_60;
  int local_5c;
  int local_58 [6];
  ulonglong local_40;

  local_40 = DAT_1800b04e8 ^ (ulonglong)&stack0xffffffffffffff18;
  iVar8 = param_1[1];
  iVar2 = *param_1;
  piVar12 = (int *)0x0;
  local_90 = param_6;
  uVar11 = 0;
  local_88 = param_5;
  local_80 = param_7;
  local_98 = param_2;
  uVar6 = FUN_1800281f0((int *)param_2,iVar8,iVar2,*param_6,*param_5,0,param_4,&local_78);
  if ((int)uVar6 == 0) {
    *param_7 = 0;
  }
  else {
    local_9c = local_74;
    local_a0 = local_78;
    local_a8 = local_6c;
    local_a4 = local_70;
    _Memory = FUN_180022ff0(local_64,local_68,param_1[4]);
    if ((*(undefined **)(_Memory + 6) != (undefined *)0x0) && (_Memory[3] != 0)) {
      uVar9 = (ulonglong)(uint)_Memory[3];
      puVar16 = *(undefined **)(_Memory + 6);
      while (uVar9 != 0) {
        uVar9 = uVar9 - 1;
        *puVar16 = 0;
        puVar16 = puVar16 + 1;
      }
    }
    FUN_180023700((longlong)param_1,(longlong)_Memory,local_58,iVar8,iVar2,local_68,local_64,0);
    piVar7 = (int *)malloc((longlong)(local_60 * local_5c) + 0x20);
    _Memory_00 = piVar12;
    if (piVar7 != (int *)0x0) {
      piVar7[3] = local_60 * local_5c;
      *piVar7 = local_60;
      piVar7[1] = local_5c;
      piVar7[4] = 1;
      piVar7[2] = local_60;
      *(int **)(piVar7 + 6) = piVar7 + 8;
      _Memory_00 = piVar7;
    }
    if ((*(undefined **)(_Memory_00 + 6) != (undefined *)0x0) && (_Memory_00[3] != 0)) {
      uVar9 = (ulonglong)(uint)_Memory_00[3];
      puVar16 = *(undefined **)(_Memory_00 + 6);
      while (uVar9 != 0) {
        uVar9 = uVar9 - 1;
        *puVar16 = 0;
        puVar16 = puVar16 + 1;
      }
    }
    puVar16 = *(undefined **)(local_98 + 6);
    puVar15 = (undefined *)
              ((longlong)(local_a8 * *_Memory_00) + (longlong)local_a4 +
              *(longlong *)(_Memory_00 + 6));
    piVar7 = piVar12;
    if (0 < (int)local_98[1]) {
      do {
        uVar17 = *local_98;
        uVar9 = (ulonglong)uVar17;
        if ((((puVar15 != (undefined *)0x0) && (puVar16 != (undefined *)0x0)) && (uVar17 != 0)) &&
           (((puVar16 + uVar9 <= puVar15 || (puVar15 + uVar9 <= puVar16)) && (uVar17 != 0)))) {
          puVar10 = puVar15;
          do {
            *puVar10 = puVar10[(longlong)(puVar16 + -(longlong)puVar15)];
            puVar10 = puVar10 + 1;
            uVar9 = uVar9 - 1;
          } while (uVar9 != 0);
        }
        uVar17 = (int)piVar7 + 1;
        piVar7 = (int *)(ulonglong)uVar17;
        puVar16 = puVar16 + (int)*local_98;
        puVar15 = puVar15 + *_Memory_00;
      } while ((int)uVar17 < (int)local_98[1]);
    }
    if (0 < _Memory[1]) {
      piVar7 = piVar12;
      do {
        iVar8 = *_Memory;
        iVar18 = (int)piVar7;
        iVar2 = *_Memory_00;
        lVar3 = *(longlong *)(_Memory + 6);
        lVar4 = *(longlong *)(_Memory_00 + 6);
        piVar7 = piVar12;
        piVar14 = piVar12;
        if (0 < iVar8) {
          do {
            cVar1 = *(char *)((longlong)piVar7 + iVar8 * iVar18 + lVar3);
            if (cVar1 != '\0') {
              *(char *)((longlong)piVar7 + (iVar18 + local_9c) * iVar2 + lVar4 + (longlong)local_a0)
                   = cVar1;
            }
            uVar17 = (int)piVar14 + 1;
            piVar14 = (int *)(ulonglong)uVar17;
            piVar7 = (int *)((longlong)piVar7 + 1);
          } while ((int)uVar17 < *_Memory);
        }
        piVar7 = (int *)(ulonglong)(iVar18 + 1U);
      } while ((int)(iVar18 + 1U) < _Memory[1]);
    }
    *local_90 = *local_90 + local_a8;
    *local_88 = *local_88 + local_a4;
    iVar8 = _Memory_00[3];
    pcVar5 = *(char **)(_Memory_00 + 6);
    uVar17 = uVar11;
    piVar7 = piVar12;
    while (0 < iVar8) {
      cVar1 = *pcVar5;
      pcVar5 = pcVar5 + 1;
      uVar17 = (uint)piVar7 + 1;
      if (cVar1 == '\0') {
        uVar17 = (uint)piVar7;
      }
      iVar8 = iVar8 + -1;
      piVar7 = (int *)(ulonglong)uVar17;
    }
    uVar13 = local_98[3];
    pcVar5 = *(char **)(local_98 + 6);
    while (0 < (int)uVar13) {
      cVar1 = *pcVar5;
      pcVar5 = pcVar5 + 1;
      uVar11 = (uint)piVar12 + 1;
      if (cVar1 == '\0') {
        uVar11 = (uint)piVar12;
      }
      uVar13 = uVar13 - 1;
      piVar12 = (int *)(ulonglong)uVar11;
    }
    *local_80 = uVar17 - uVar11;
    free(_Memory);
    free(_Memory_00);
  }
  FUN_18005f100(local_40 ^ (ulonglong)&stack0xffffffffffffff18);
  return;
}



void FUN_180028820(longlong param_1,longlong param_2,int param_3)

{
  int iVar1;
  byte *pbVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  longlong lVar6;
  undefined auStack1080 [32];
  int local_418 [256];
  ulonglong local_18;

  local_18 = DAT_1800b04e8 ^ (ulonglong)auStack1080;
  iVar5 = 0;
  memset(local_418,0,0x400);
  iVar3 = *(int *)(param_1 + 0xc);
  pbVar2 = *(byte **)(param_1 + 0x18);
  if (0 < iVar3) {
    lVar6 = *(longlong *)(param_2 + 0x18) - (longlong)pbVar2;
    do {
      if (pbVar2[lVar6] != 0) {
        local_418[*pbVar2] = local_418[*pbVar2] + 1;
        iVar5 = iVar5 + 1;
      }
      iVar3 = iVar3 + -1;
      pbVar2 = pbVar2 + 1;
    } while (0 < iVar3);
  }
  iVar3 = 0x32;
  if (param_3 == 0) {
    iVar3 = 0xcd;
  }
  iVar1 = 1;
  do {
    iVar4 = local_418[iVar1] + local_418[iVar1 + -1];
    local_418[iVar1] = iVar4;
    if ((int)(iVar3 * iVar5 + 0x80U >> 8) <= iVar4) break;
    iVar1 = iVar1 + 1;
  } while (iVar1 < 0x100);
  FUN_18005f100(local_18 ^ (ulonglong)auStack1080);
  return;
}



void FUN_180028930(int *param_1,longlong param_2,int **param_3,int param_4,int param_5)

{
  int iVar1;
  int *piVar2;
  char cVar3;
  byte *pbVar4;
  int iVar5;
  longlong lVar6;
  byte *pbVar7;
  int iVar8;
  ulonglong uVar9;
  byte bVar10;
  int iVar11;
  undefined *puVar12;
  uint uVar13;
  ulonglong uVar14;
  int iVar15;
  undefined auStack1144 [32];
  int local_458;
  longlong local_450;
  int local_448 [256];
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)auStack1144;
  if (param_1 != (int *)0x0) {
    iVar5 = *param_1;
    iVar15 = param_1[1];
    if (*param_3 == (int *)0x0) {
      iVar11 = iVar15 * iVar5;
      iVar1 = (int)(iVar11 + (iVar11 >> 0x1f & 7U)) >> 3;
      iVar8 = iVar1 + 1;
      if (iVar11 <= iVar1 * 8) {
        iVar8 = iVar1;
      }
      piVar2 = (int *)malloc((longlong)iVar8 + 0x20);
      if (piVar2 == (int *)0x0) {
        *param_3 = (int *)0x0;
        goto LAB_180028be0;
      }
      piVar2[3] = iVar8;
      *piVar2 = iVar5;
      piVar2[1] = iVar15;
      piVar2[4] = 8;
      piVar2[2] = -1;
      *(int **)(piVar2 + 6) = piVar2 + 8;
      *param_3 = piVar2;
    }
    uVar14 = 0;
    iVar15 = iVar15 * iVar5;
    pbVar7 = *(byte **)(param_1 + 6);
    local_450 = *(longlong *)(*param_3 + 6);
    local_458 = (int)(iVar15 + (iVar15 >> 0x1f & 7U)) >> 3;
    if ((param_4 == 0) || (param_2 == 0)) {
      bVar10 = 0x37;
      if (param_5 == 0) {
        bVar10 = 200;
      }
    }
    else {
      bVar10 = 0;
      iVar8 = 0;
      memset(local_448,0,0x400);
      iVar5 = param_1[3];
      lVar6 = *(longlong *)(param_2 + 0x18);
      if (0 < iVar5) {
        pbVar4 = pbVar7;
        uVar9 = uVar14;
        do {
          if (pbVar4[lVar6 - (longlong)pbVar7] != 0) {
            local_448[*pbVar4] = local_448[*pbVar4] + 1;
            uVar9 = (ulonglong)((int)uVar9 + 1);
          }
          iVar8 = (int)uVar9;
          iVar5 = iVar5 + -1;
          pbVar4 = pbVar4 + 1;
        } while (0 < iVar5);
      }
      iVar1 = 1;
      iVar5 = 0x32;
      if (param_5 == 0) {
        iVar5 = 0xcd;
      }
      uVar13 = iVar5 * iVar8 + 0x80U >> 8;
      do {
        iVar5 = local_448[iVar1] + local_448[iVar1 + -1];
        local_448[iVar1] = iVar5;
        if ((int)uVar13 <= iVar5) {
          bVar10 = (byte)iVar1;
          if ((int)(uVar13 - local_448[iVar1 + -1]) < (int)(iVar5 - uVar13)) {
            bVar10 = bVar10 - 1;
          }
          break;
        }
        iVar1 = iVar1 + 1;
      } while (iVar1 < 0x100);
    }
    if (0 < local_458) {
      puVar12 = &DAT_18007d2f9 + -(longlong)pbVar7;
      do {
        cVar3 = '\0';
        lVar6 = 8;
        do {
          if (param_5 < 0) {
            if (*pbVar7 < bVar10) goto LAB_180028c07;
LAB_180028b69:
            pbVar4 = &DAT_18007d2f8;
          }
          else {
            if (*pbVar7 < bVar10 || *pbVar7 == bVar10) goto LAB_180028b69;
LAB_180028c07:
            pbVar4 = pbVar7 + (longlong)puVar12;
          }
          cVar3 = cVar3 + *pbVar4;
          pbVar7 = pbVar7 + 1;
          lVar6 = lVar6 + -1;
        } while (lVar6 != 0);
        *(char *)(uVar14 + local_450) = cVar3;
        puVar12 = puVar12 + -8;
        uVar14 = uVar14 + 1;
      } while ((longlong)uVar14 < (longlong)local_458);
    }
    if (local_458 * 8 < iVar15) {
      cVar3 = '\0';
      lVar6 = -(longlong)pbVar7;
      uVar14 = (ulonglong)(uint)(iVar15 + local_458 * -8);
      do {
        if (param_5 < 0) {
          if (*pbVar7 < bVar10) goto LAB_180028c15;
LAB_180028bac:
          pbVar4 = &DAT_18007d2f8;
        }
        else {
          if (*pbVar7 < bVar10 || *pbVar7 == bVar10) goto LAB_180028bac;
LAB_180028c15:
          pbVar4 = pbVar7 + (longlong)(&DAT_18007d2f9 + lVar6);
        }
        cVar3 = cVar3 + *pbVar4;
        pbVar7 = pbVar7 + 1;
        uVar14 = uVar14 - 1;
      } while (uVar14 != 0);
      *(char *)(local_458 + local_450) = cVar3;
    }
  }
LAB_180028be0:
  FUN_18005f100(local_48 ^ (ulonglong)auStack1144);
  return;
}



void FUN_180028c20(int param_1,int *param_2,int *param_3,int *param_4,longlong param_5)

{
  undefined *puVar1;
  int iVar2;
  int *_Memory;
  int *piVar3;
  longlong lVar4;
  char *pcVar5;
  char *pcVar6;
  int iVar7;
  undefined *puVar8;
  byte bVar9;
  char *pcVar10;
  int iVar11;
  char cVar12;
  int iVar13;
  int iVar14;
  uint uVar15;
  ulonglong uVar16;
  byte *pbVar17;
  byte *pbVar18;
  longlong lVar19;
  longlong lVar20;
  int iVar21;
  undefined auStack1160 [32];
  int local_468;
  longlong local_460;
  int local_458;
  longlong local_450;
  int local_448 [256];
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)auStack1160;
  local_450 = param_5;
  if (param_3 == (int *)0x0) {
    param_3 = param_2;
  }
  iVar11 = *param_3;
  iVar7 = param_3[1];
  if (param_1 == 0) {
    _Memory = FUN_180022ff0(iVar11,iVar7,param_3[4]);
    if (*(longlong *)(param_5 + 0x20) == 0) {
      piVar3 = FUN_180022ff0(iVar11,iVar7,param_4[4]);
      *(int **)(param_5 + 0x20) = piVar3;
    }
    if (_Memory != (int *)0x0) {
      if (_Memory[3] < param_3[3]) {
        free(_Memory);
        _Memory = FUN_180022ff0(*param_3,param_3[1],param_3[4]);
      }
      *_Memory = *param_3;
      _Memory[1] = param_3[1];
      _Memory[2] = param_3[2];
      _Memory[3] = param_3[3];
      _Memory[4] = param_3[4];
      puVar8 = *(undefined **)(_Memory + 6);
      uVar15 = param_3[3];
      puVar1 = *(undefined **)(param_3 + 6);
      if ((((puVar8 != (undefined *)0x0) && (puVar1 != (undefined *)0x0)) && (uVar15 != 0)) &&
         (((uVar16 = (ulonglong)uVar15, puVar1 + uVar15 <= puVar8 || (puVar8 + uVar15 <= puVar1)) &&
          (uVar15 != 0)))) {
        lVar20 = -(longlong)puVar8;
        do {
          *puVar8 = puVar8[(longlong)(puVar1 + lVar20)];
          puVar8 = puVar8 + 1;
          uVar16 = uVar16 - 1;
        } while (uVar16 != 0);
      }
    }
    if (param_4 != (int *)0x0) {
      FUN_1800230e0(param_4,(int **)(param_5 + 0x20));
    }
  }
  else {
    iVar11 = iVar11 >> 1;
    iVar7 = iVar7 >> 1;
    _Memory = FUN_180022ff0(iVar11,iVar7,param_3[4]);
    if (*(longlong *)(param_5 + 0x20) == 0) {
      piVar3 = FUN_180022ff0(iVar11,iVar7,param_4[4]);
      *(int **)(param_5 + 0x20) = piVar3;
    }
    iVar21 = 0;
    if (0 < iVar7) {
      do {
        iVar2 = 0;
        if (0 < iVar11) {
          do {
            *(undefined *)((longlong)(iVar21 * _Memory[2] + iVar2) + *(longlong *)(_Memory + 6)) =
                 *(undefined *)
                  ((longlong)((iVar21 * param_3[2] + iVar2) * 2) + *(longlong *)(param_3 + 6));
            piVar3 = *(int **)(param_5 + 0x20);
            iVar13 = param_4[2] * iVar21 + iVar2;
            iVar14 = piVar3[2] * iVar21 + iVar2;
            iVar2 = iVar2 + 1;
            *(undefined *)((longlong)iVar14 + *(longlong *)(piVar3 + 6)) =
                 *(undefined *)((longlong)(iVar13 * 2) + *(longlong *)(param_4 + 6));
          } while (iVar2 < iVar11);
        }
        iVar21 = iVar21 + 1;
      } while (iVar21 < iVar7);
    }
  }
  lVar20 = *(longlong *)(param_5 + 0x20);
  iVar11 = 1;
  pcVar10 = &DAT_18007d2f9;
  if (_Memory != (int *)0x0) {
    local_468 = _Memory[1];
    iVar7 = *_Memory;
    if (*(longlong *)(param_5 + 8) == 0) {
      iVar13 = local_468 * iVar7;
      iVar2 = (int)(iVar13 + (iVar13 >> 0x1f & 7U)) >> 3;
      iVar21 = iVar2 + 1;
      if (iVar13 <= iVar2 * 8) {
        iVar21 = iVar2;
      }
      piVar3 = (int *)malloc((longlong)iVar21 + 0x20);
      if (piVar3 == (int *)0x0) {
        *(undefined8 *)(param_5 + 8) = 0;
        goto LAB_18002901e;
      }
      piVar3[3] = iVar21;
      piVar3[1] = local_468;
      *piVar3 = iVar7;
      piVar3[4] = 8;
      piVar3[2] = -1;
      *(int **)(piVar3 + 6) = piVar3 + 8;
      *(int **)(param_5 + 8) = piVar3;
    }
    pbVar17 = *(byte **)(_Memory + 6);
    local_468 = local_468 * iVar7;
    local_458 = (int)(local_468 + (local_468 >> 0x1f & 7U)) >> 3;
    local_460 = *(longlong *)(*(longlong *)(local_450 + 8) + 0x18);
    if (lVar20 == 0) {
      bVar9 = 200;
    }
    else {
      bVar9 = 0;
      iVar21 = 0;
      memset(local_448,0,0x400);
      iVar7 = _Memory[3];
      lVar20 = *(longlong *)(lVar20 + 0x18);
      if (0 < iVar7) {
        pbVar18 = pbVar17;
        do {
          if (pbVar18[lVar20 - (longlong)pbVar17] != 0) {
            local_448[*pbVar18] = local_448[*pbVar18] + 1;
            iVar21 = iVar21 + 1;
          }
          iVar7 = iVar7 + -1;
          pbVar18 = pbVar18 + 1;
        } while (0 < iVar7);
      }
      iVar7 = 1;
      uVar15 = iVar21 * 0xcd + 0x80U >> 8;
      do {
        iVar21 = local_448[iVar7] + local_448[iVar7 + -1];
        local_448[iVar7] = iVar21;
        if ((int)uVar15 <= iVar21) {
          bVar9 = (byte)iVar7;
          if ((int)(uVar15 - local_448[iVar7 + -1]) < (int)(iVar21 - uVar15)) {
            bVar9 = bVar9 - 1;
          }
          break;
        }
        iVar7 = iVar7 + 1;
      } while (iVar7 < 0x100);
    }
    lVar20 = (longlong)local_458;
    pbVar18 = pbVar17;
    if (0 < local_458) {
      lVar19 = 0;
      pbVar18 = pbVar17 + lVar20 * 8;
      pbVar17 = pbVar17 + -0x18007d2f9;
      do {
        cVar12 = '\0';
        lVar4 = 0;
        do {
          pcVar5 = &DAT_18007d2f9 + lVar4;
          pcVar6 = "";
          if (bVar9 <= pbVar17[(longlong)pcVar5] && pbVar17[(longlong)pcVar5] != bVar9) {
            pcVar6 = pcVar5;
          }
          lVar4 = lVar4 + 1;
          cVar12 = cVar12 + *pcVar6;
        } while (lVar4 < 8);
        pbVar17 = pbVar17 + 8;
        *(char *)(lVar19 + local_460) = cVar12;
        lVar19 = lVar19 + 1;
      } while (lVar19 < lVar20);
    }
    if (local_458 * 8 < local_468) {
      cVar12 = '\0';
      pcVar6 = &DAT_18007d2f9;
      uVar16 = (ulonglong)(uint)(local_468 + local_458 * -8);
      do {
        pcVar5 = "";
        if (bVar9 <= (byte)pcVar6[(longlong)(pbVar18 + -0x18007d2f9)] &&
            pcVar6[(longlong)(pbVar18 + -0x18007d2f9)] != bVar9) {
          pcVar5 = pcVar6;
        }
        pcVar6 = pcVar6 + 1;
        cVar12 = cVar12 + *pcVar5;
        uVar16 = uVar16 - 1;
      } while (uVar16 != 0);
      *(char *)(lVar20 + local_460) = cVar12;
    }
  }
LAB_18002901e:
  lVar19 = local_450;
  lVar20 = *(longlong *)(param_5 + 0x20);
  if (_Memory == (int *)0x0) goto LAB_180029223;
  iVar7 = *_Memory;
  iVar21 = _Memory[1];
  if (*(longlong *)(local_450 + 0x10) == 0) {
    iVar14 = iVar21 * iVar7;
    iVar13 = (int)(iVar14 + (iVar14 >> 0x1f & 7U)) >> 3;
    iVar2 = iVar13 + 1;
    if (iVar14 <= iVar13 * 8) {
      iVar2 = iVar13;
    }
    piVar3 = (int *)malloc((longlong)iVar2 + 0x20);
    if (piVar3 != (int *)0x0) {
      piVar3[3] = iVar2;
      *piVar3 = iVar7;
      piVar3[1] = iVar21;
      piVar3[4] = 8;
      piVar3[2] = -1;
      *(int **)(piVar3 + 6) = piVar3 + 8;
      *(int **)(lVar19 + 0x10) = piVar3;
      goto LAB_1800290a2;
    }
    *(undefined8 *)(lVar19 + 0x10) = 0;
  }
  else {
LAB_1800290a2:
    pbVar17 = *(byte **)(_Memory + 6);
    iVar21 = iVar21 * iVar7;
    local_460 = *(longlong *)(*(longlong *)(local_450 + 0x10) + 0x18);
    local_468 = (int)(iVar21 + (iVar21 >> 0x1f & 7U)) >> 3;
    if (lVar20 == 0) {
      bVar9 = 0x37;
    }
    else {
      bVar9 = 0;
      iVar2 = 0;
      memset(local_448,0,0x400);
      iVar7 = _Memory[3];
      lVar20 = *(longlong *)(lVar20 + 0x18);
      if (0 < iVar7) {
        pbVar18 = pbVar17;
        do {
          if (pbVar18[lVar20 - (longlong)pbVar17] != 0) {
            local_448[*pbVar18] = local_448[*pbVar18] + 1;
            iVar2 = iVar2 + 1;
          }
          iVar7 = iVar7 + -1;
          pbVar18 = pbVar18 + 1;
        } while (0 < iVar7);
      }
      uVar15 = iVar2 * 0x32 + 0x80U >> 8;
      do {
        iVar7 = local_448[iVar11] + local_448[iVar11 + -1];
        local_448[iVar11] = iVar7;
        if ((int)uVar15 <= iVar7) {
          bVar9 = (byte)iVar11;
          if ((int)(uVar15 - local_448[iVar11 + -1]) < (int)(iVar7 - uVar15)) {
            bVar9 = bVar9 - 1;
          }
          break;
        }
        iVar11 = iVar11 + 1;
      } while (iVar11 < 0x100);
    }
    lVar20 = (longlong)local_468;
    if (0 < local_468) {
      lVar19 = 0;
      pbVar18 = pbVar17 + -0x18007d2f9;
      pbVar17 = pbVar17 + lVar20 * 8;
      do {
        cVar12 = '\0';
        lVar4 = 0;
        do {
          pcVar6 = "";
          if ((byte)(&DAT_18007d2f9 + lVar4)[(longlong)pbVar18] < bVar9) {
            pcVar6 = &DAT_18007d2f9 + lVar4;
          }
          lVar4 = lVar4 + 1;
          cVar12 = cVar12 + *pcVar6;
        } while (lVar4 < 8);
        *(char *)(lVar19 + local_460) = cVar12;
        pbVar18 = pbVar18 + 8;
        lVar19 = lVar19 + 1;
      } while (lVar19 < lVar20);
    }
    if (local_468 * 8 < iVar21) {
      cVar12 = '\0';
      uVar16 = (ulonglong)(uint)(iVar21 + local_468 * -8);
      do {
        pcVar6 = "";
        if ((pbVar17 + -0x18007d2f9)[(longlong)pcVar10] < bVar9) {
          pcVar6 = pcVar10;
        }
        pcVar10 = pcVar10 + 1;
        cVar12 = cVar12 + *pcVar6;
        uVar16 = uVar16 - 1;
      } while (uVar16 != 0);
      *(char *)(lVar20 + local_460) = cVar12;
    }
  }
  free(_Memory);
LAB_180029223:
  FUN_18005f100(local_48 ^ (ulonglong)auStack1160);
  return;
}



void FUN_180029250(int param_1,int *param_2,int *param_3,int *param_4,longlong param_5)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  int *piVar4;
  int iVar5;
  char *pcVar6;
  char *pcVar7;
  byte *pbVar8;
  int iVar9;
  ulonglong uVar10;
  int iVar11;
  int iVar12;
  char *pcVar13;
  byte bVar14;
  char cVar15;
  byte bVar16;
  int iVar17;
  uint uVar18;
  byte *pbVar19;
  ulonglong uVar20;
  ulonglong uVar21;
  longlong lVar22;
  longlong lVar23;
  int local_478;
  int local_474;
  byte *local_470;
  int *local_468;
  byte *local_460;
  int *local_458;
  int local_448 [256];
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffb58;
  local_468 = param_4;
  local_458 = param_2;
  if (param_1 == 0) {
    uVar20 = 0;
    pcVar13 = &DAT_18007d2f9;
    iVar12 = 1;
    iVar11 = 0;
    if (param_2 != (int *)0x0) {
      local_478 = param_2[1];
      iVar9 = *param_2;
      if (*(longlong *)(param_5 + 8) == 0) {
        iVar1 = local_478 * iVar9;
        iVar2 = (int)(iVar1 + (iVar1 >> 0x1f & 7U)) >> 3;
        iVar5 = iVar2 + 1;
        if (iVar1 <= iVar2 * 8) {
          iVar5 = iVar2;
        }
        piVar3 = (int *)malloc((longlong)iVar5 + 0x20);
        if (piVar3 == (int *)0x0) {
          *(undefined8 *)(param_5 + 8) = 0;
          goto LAB_18002984e;
        }
        piVar3[3] = iVar5;
        piVar3[1] = local_478;
        *piVar3 = iVar9;
        piVar3[4] = 8;
        piVar3[2] = -1;
        *(int **)(piVar3 + 6) = piVar3 + 8;
        *(int **)(param_5 + 8) = piVar3;
      }
      local_460 = *(byte **)(local_458 + 6);
      local_478 = local_478 * iVar9;
      local_474 = (int)(local_478 + (local_478 >> 0x1f & 7U)) >> 3;
      local_470 = *(byte **)(*(longlong *)(param_5 + 8) + 0x18);
      if (local_468 == (int *)0x0) {
        bVar14 = 200;
      }
      else {
        bVar14 = 0;
        memset(local_448,0,0x400);
        iVar9 = local_458[3];
        lVar23 = *(longlong *)(local_468 + 6);
        iVar5 = iVar11;
        if (0 < iVar9) {
          pbVar8 = local_460;
          uVar21 = uVar20;
          do {
            if (pbVar8[lVar23 - (longlong)local_460] != 0) {
              local_448[*pbVar8] = local_448[*pbVar8] + 1;
              uVar21 = (ulonglong)((int)uVar21 + 1);
            }
            iVar5 = (int)uVar21;
            iVar9 = iVar9 + -1;
            pbVar8 = pbVar8 + 1;
          } while (0 < iVar9);
        }
        uVar18 = iVar5 * 0xcd + 0x80U >> 8;
        iVar9 = iVar12;
        do {
          iVar5 = local_448[iVar9] + local_448[iVar9 + -1];
          local_448[iVar9] = iVar5;
          if ((int)uVar18 <= iVar5) {
            bVar14 = (byte)iVar9;
            if ((int)(uVar18 - local_448[iVar9 + -1]) < (int)(iVar5 - uVar18)) {
              bVar14 = bVar14 - 1;
            }
            break;
          }
          iVar9 = iVar9 + 1;
        } while (iVar9 < 0x100);
      }
      lVar23 = (longlong)local_474;
      pbVar8 = local_460;
      if (0 < local_474) {
        pbVar19 = local_460 + -0x18007d2f9;
        pbVar8 = local_460 + lVar23 * 8;
        uVar21 = uVar20;
        do {
          bVar16 = 0;
          uVar10 = uVar20;
          do {
            pcVar6 = &DAT_18007d2f9 + uVar10;
            pcVar7 = "";
            if (bVar14 <= pbVar19[(longlong)pcVar6] && pbVar19[(longlong)pcVar6] != bVar14) {
              pcVar7 = pcVar6;
            }
            uVar10 = uVar10 + 1;
            bVar16 = bVar16 + *pcVar7;
          } while ((longlong)uVar10 < 8);
          pbVar19 = pbVar19 + 8;
          local_470[uVar21] = bVar16;
          uVar21 = uVar21 + 1;
        } while ((longlong)uVar21 < lVar23);
      }
      if (local_474 * 8 < local_478) {
        bVar16 = 0;
        uVar21 = (ulonglong)(uint)(local_478 + local_474 * -8);
        pcVar7 = &DAT_18007d2f9;
        do {
          pcVar6 = "";
          if (bVar14 <= (byte)pcVar7[(longlong)(pbVar8 + -0x18007d2f9)] &&
              pcVar7[(longlong)(pbVar8 + -0x18007d2f9)] != bVar14) {
            pcVar6 = pcVar7;
          }
          pcVar7 = pcVar7 + 1;
          bVar16 = bVar16 + *pcVar6;
          uVar21 = uVar21 - 1;
        } while (uVar21 != 0);
        local_470[lVar23] = bVar16;
      }
    }
LAB_18002984e:
    if (param_3 != (int *)0x0) {
      local_478 = param_3[1];
      iVar9 = *param_3;
      if (*(longlong *)(param_5 + 0x10) == 0) {
        iVar1 = local_478 * iVar9;
        iVar2 = (int)(iVar1 + (iVar1 >> 0x1f & 7U)) >> 3;
        iVar5 = iVar2 + 1;
        if (iVar1 <= iVar2 * 8) {
          iVar5 = iVar2;
        }
        piVar3 = (int *)malloc((longlong)iVar5 + 0x20);
        if (piVar3 == (int *)0x0) {
          *(undefined8 *)(param_5 + 0x10) = 0;
          goto LAB_180029a5e;
        }
        piVar3[1] = local_478;
        piVar3[3] = iVar5;
        *piVar3 = iVar9;
        piVar3[4] = 8;
        piVar3[2] = -1;
        *(int **)(piVar3 + 6) = piVar3 + 8;
        *(int **)(param_5 + 0x10) = piVar3;
      }
      local_470 = *(byte **)(param_3 + 6);
      local_478 = local_478 * iVar9;
      local_474 = (int)(local_478 + (local_478 >> 0x1f & 7U)) >> 3;
      local_460 = *(byte **)(*(longlong *)(param_5 + 0x10) + 0x18);
      if (local_468 == (int *)0x0) {
        bVar14 = 200;
      }
      else {
        bVar14 = 0;
        memset(local_448,0,0x400);
        iVar9 = param_3[3];
        lVar23 = *(longlong *)(local_468 + 6);
        if (0 < iVar9) {
          pbVar8 = local_470;
          uVar21 = uVar20;
          do {
            if (pbVar8[lVar23 - (longlong)local_470] != 0) {
              local_448[*pbVar8] = local_448[*pbVar8] + 1;
              uVar21 = (ulonglong)((int)uVar21 + 1);
            }
            iVar11 = (int)uVar21;
            iVar9 = iVar9 + -1;
            pbVar8 = pbVar8 + 1;
          } while (0 < iVar9);
        }
        uVar18 = iVar11 * 0xcd + 0x80U >> 8;
        do {
          iVar11 = local_448[iVar12] + local_448[iVar12 + -1];
          local_448[iVar12] = iVar11;
          if ((int)uVar18 <= iVar11) {
            bVar14 = (byte)iVar12;
            if ((int)(uVar18 - local_448[iVar12 + -1]) < (int)(iVar11 - uVar18)) {
              bVar14 = bVar14 - 1;
            }
            break;
          }
          iVar12 = iVar12 + 1;
        } while (iVar12 < 0x100);
      }
      lVar23 = (longlong)local_474;
      pbVar8 = local_470;
      if (0 < local_474) {
        pbVar19 = local_470 + -0x18007d2f9;
        pbVar8 = local_470 + lVar23 * 8;
        uVar21 = uVar20;
        do {
          bVar16 = 0;
          uVar10 = uVar20;
          do {
            pcVar6 = &DAT_18007d2f9 + uVar10;
            pcVar7 = "";
            if (bVar14 <= pbVar19[(longlong)pcVar6] && pbVar19[(longlong)pcVar6] != bVar14) {
              pcVar7 = pcVar6;
            }
            uVar10 = uVar10 + 1;
            bVar16 = bVar16 + *pcVar7;
          } while ((longlong)uVar10 < 8);
          pbVar19 = pbVar19 + 8;
          local_460[uVar21] = bVar16;
          uVar21 = uVar21 + 1;
        } while ((longlong)uVar21 < lVar23);
      }
      if (local_474 * 8 < local_478) {
        bVar16 = 0;
        uVar20 = (ulonglong)(uint)(local_478 + local_474 * -8);
        do {
          pcVar7 = "";
          if (bVar14 <= (byte)pcVar13[(longlong)(pbVar8 + -0x18007d2f9)] &&
              pcVar13[(longlong)(pbVar8 + -0x18007d2f9)] != bVar14) {
            pcVar7 = pcVar13;
          }
          pcVar13 = pcVar13 + 1;
          bVar16 = bVar16 + *pcVar7;
          uVar20 = uVar20 - 1;
        } while (uVar20 != 0);
        local_460[lVar23] = bVar16;
      }
    }
LAB_180029a5e:
    piVar4 = local_458;
    piVar3 = local_468;
    FUN_180028930(local_458,(longlong)local_468,(int **)(param_5 + 0x18),0,1);
    if (*(longlong *)(param_5 + 0x20) == 0) {
      piVar4 = FUN_180022ff0(*piVar3,piVar4[1],piVar3[4]);
      *(int **)(param_5 + 0x20) = piVar4;
    }
    if (piVar3 != (int *)0x0) {
      FUN_1800230e0(piVar3,(int **)(param_5 + 0x20));
    }
    goto LAB_180029aac;
  }
  iVar12 = param_2[1] >> 1;
  iVar11 = *param_2 >> 1;
  piVar3 = FUN_180022ff0(iVar11,iVar12,param_2[4]);
  if (*(longlong *)(param_5 + 0x20) == 0) {
    piVar4 = FUN_180022ff0(iVar11,iVar12,param_2[4]);
    *(int **)(param_5 + 0x20) = piVar4;
  }
  uVar21 = 0;
  iVar9 = 0;
  uVar20 = uVar21;
  if (0 < iVar12) {
    do {
      iVar5 = (int)uVar20;
      uVar20 = uVar21;
      if (0 < iVar11) {
        do {
          iVar2 = (int)uVar20;
          *(undefined *)((longlong)(iVar5 * piVar3[2] + iVar2) + *(longlong *)(piVar3 + 6)) =
               *(undefined *)
                ((longlong)((param_2[2] * iVar5 + iVar2) * 2) + *(longlong *)(param_2 + 6));
          *(undefined *)
           ((longlong)(*(int *)(*(longlong *)(param_5 + 0x20) + 8) * iVar5 + iVar2) +
           *(longlong *)(*(longlong *)(param_5 + 0x20) + 0x18)) =
               *(undefined *)
                ((longlong)((param_4[2] * iVar5 + iVar2) * 2) + *(longlong *)(param_4 + 6));
          uVar20 = (ulonglong)(iVar2 + 1U);
        } while ((int)(iVar2 + 1U) < iVar11);
      }
      uVar20 = (ulonglong)(iVar5 + 1U);
    } while ((int)(iVar5 + 1U) < iVar12);
  }
  FUN_180028930(piVar3,*(longlong *)(param_5 + 0x20),(int **)(param_5 + 8),0,0);
  iVar11 = 1;
  FUN_180028930(piVar3,*(longlong *)(param_5 + 0x20),(int **)(param_5 + 0x18),0,1);
  if (param_3 == (int *)0x0) {
LAB_1800295ec:
    *(undefined8 *)(param_5 + 0x10) = 0;
  }
  else {
    if (0 < piVar3[1]) {
      iVar12 = *piVar3;
      uVar20 = uVar21;
      do {
        iVar5 = (int)uVar20;
        uVar20 = uVar21;
        if (0 < iVar12) {
          do {
            iVar2 = (int)uVar20;
            *(undefined *)((longlong)(iVar5 * piVar3[2] + iVar2) + *(longlong *)(piVar3 + 6)) =
                 *(undefined *)
                  ((longlong)((param_3[2] * iVar5 + iVar2) * 2) + *(longlong *)(param_3 + 6));
            iVar12 = *piVar3;
            uVar20 = (ulonglong)(iVar2 + 1U);
          } while ((int)(iVar2 + 1U) < iVar12);
        }
        uVar20 = (ulonglong)(iVar5 + 1U);
      } while ((int)(iVar5 + 1U) < piVar3[1]);
    }
    local_470 = *(byte **)(param_5 + 0x20);
    iVar12 = *piVar3;
    iVar5 = piVar3[1];
    if (*(longlong *)(param_5 + 0x10) == 0) {
      iVar17 = iVar5 * iVar12;
      iVar1 = (int)(iVar17 + (iVar17 >> 0x1f & 7U)) >> 3;
      iVar2 = iVar1 + 1;
      if (iVar17 <= iVar1 * 8) {
        iVar2 = iVar1;
      }
      piVar4 = (int *)malloc((longlong)iVar2 + 0x20);
      if (piVar4 == (int *)0x0) goto LAB_1800295ec;
      piVar4[3] = iVar2;
      *piVar4 = iVar12;
      piVar4[1] = iVar5;
      piVar4[4] = 8;
      piVar4[2] = -1;
      *(int **)(piVar4 + 6) = piVar4 + 8;
      *(int **)(param_5 + 0x10) = piVar4;
    }
    pbVar19 = local_470;
    pbVar8 = *(byte **)(piVar3 + 6);
    local_474 = iVar5 * iVar12;
    lVar23 = *(longlong *)(*(longlong *)(param_5 + 0x10) + 0x18);
    local_478 = (int)(local_474 + (local_474 >> 0x1f & 7U)) >> 3;
    if (local_470 == (byte *)0x0) {
      bVar14 = 200;
    }
    else {
      bVar14 = 0;
      memset(local_448,0,0x400);
      iVar12 = piVar3[3];
      lVar22 = *(longlong *)(pbVar19 + 0x18);
      if (0 < iVar12) {
        pbVar19 = pbVar8;
        uVar20 = uVar21;
        do {
          if (pbVar19[lVar22 - (longlong)pbVar8] != 0) {
            local_448[*pbVar19] = local_448[*pbVar19] + 1;
            uVar20 = (ulonglong)((int)uVar20 + 1);
          }
          iVar9 = (int)uVar20;
          iVar12 = iVar12 + -1;
          pbVar19 = pbVar19 + 1;
        } while (0 < iVar12);
      }
      uVar18 = iVar9 * 0xcd + 0x80U >> 8;
      do {
        iVar12 = local_448[iVar11] + local_448[iVar11 + -1];
        local_448[iVar11] = iVar12;
        if ((int)uVar18 <= iVar12) {
          bVar14 = (byte)iVar11;
          if ((int)(uVar18 - local_448[iVar11 + -1]) < (int)(iVar12 - uVar18)) {
            bVar14 = bVar14 - 1;
          }
          break;
        }
        iVar11 = iVar11 + 1;
      } while (iVar11 < 0x100);
    }
    lVar22 = (longlong)local_478;
    pcVar13 = &DAT_18007d2f9;
    if (0 < local_478) {
      pbVar19 = pbVar8 + -0x18007d2f9;
      pbVar8 = pbVar8 + lVar22 * 8;
      uVar20 = uVar21;
      do {
        cVar15 = '\0';
        uVar10 = uVar21;
        do {
          pcVar6 = &DAT_18007d2f9 + uVar10;
          pcVar7 = "";
          if (bVar14 <= pbVar19[(longlong)pcVar6] && pbVar19[(longlong)pcVar6] != bVar14) {
            pcVar7 = pcVar6;
          }
          uVar10 = uVar10 + 1;
          cVar15 = cVar15 + *pcVar7;
        } while ((longlong)uVar10 < 8);
        *(char *)(uVar20 + lVar23) = cVar15;
        pbVar19 = pbVar19 + 8;
        uVar20 = uVar20 + 1;
      } while ((longlong)uVar20 < lVar22);
    }
    if (local_478 * 8 < local_474) {
      cVar15 = '\0';
      uVar20 = (ulonglong)(uint)(local_474 + local_478 * -8);
      do {
        pcVar7 = "";
        if (bVar14 <= (byte)pcVar13[(longlong)(pbVar8 + -0x18007d2f9)] &&
            pcVar13[(longlong)(pbVar8 + -0x18007d2f9)] != bVar14) {
          pcVar7 = pcVar13;
        }
        pcVar13 = pcVar13 + 1;
        cVar15 = cVar15 + *pcVar7;
        uVar20 = uVar20 - 1;
      } while (uVar20 != 0);
      *(char *)(lVar22 + lVar23) = cVar15;
    }
  }
  if (piVar3 != (int *)0x0) {
    free(piVar3);
  }
LAB_180029aac:
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xfffffffffffffb58);
  return;
}



int * FUN_180029ae0(uint *param_1,int param_2)

{
  uint uVar1;
  undefined uVar2;
  undefined uVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  int *piVar7;
  longlong lVar8;
  undefined *puVar9;
  ulonglong uVar10;
  undefined *puVar11;
  int iVar12;
  longlong lVar13;
  ulonglong uVar14;
  ulonglong uVar15;
  undefined *puVar16;
  undefined *puVar17;
  longlong lVar18;

  uVar4 = *param_1;
  uVar14 = (ulonglong)uVar4;
  uVar5 = param_1[1];
  uVar10 = (ulonglong)uVar5;
  iVar6 = (int)(uVar4 + ((int)uVar4 >> 0x1f & 7U)) >> 3;
  iVar12 = uVar4 + iVar6 * -8;
  if ((iVar12 != 0) && (param_2 != 0)) {
    iVar6 = iVar6 + 1;
  }
  uVar1 = iVar6 * 8;
  piVar7 = FUN_180022ff0(uVar1,uVar5,param_1[4]);
  if (iVar12 == 0) {
    puVar16 = *(undefined **)(piVar7 + 6);
    uVar4 = param_1[3];
    uVar10 = (ulonglong)uVar4;
    puVar11 = *(undefined **)(param_1 + 6);
    if (((puVar16 != (undefined *)0x0) && (puVar11 != (undefined *)0x0)) &&
       ((uVar4 != 0 &&
        (((puVar11 + uVar10 <= puVar16 || (puVar16 + uVar10 <= puVar11)) && (uVar4 != 0)))))) {
      lVar13 = -(longlong)puVar16;
      do {
        *puVar16 = puVar16[(longlong)(puVar11 + lVar13)];
        puVar16 = puVar16 + 1;
        uVar10 = uVar10 - 1;
      } while (uVar10 != 0);
    }
  }
  else {
    puVar16 = *(undefined **)(param_1 + 6);
    puVar11 = *(undefined **)(piVar7 + 6);
    if (param_2 == 0) {
      puVar16 = puVar16 + ((longlong)iVar12 >> 1);
      if (0 < (int)uVar5) {
        do {
          if ((((puVar11 != (undefined *)0x0) && (puVar16 != (undefined *)0x0)) && (uVar1 != 0)) &&
             (((uVar14 = (ulonglong)uVar1, puVar16 + uVar1 <= puVar11 ||
               (puVar11 + uVar1 <= puVar16)) && (uVar1 != 0)))) {
            puVar17 = puVar11;
            do {
              *puVar17 = puVar17[(longlong)(puVar16 + -(longlong)puVar11)];
              puVar17 = puVar17 + 1;
              uVar14 = uVar14 - 1;
            } while (uVar14 != 0);
          }
          puVar16 = puVar16 + (int)uVar4;
          puVar11 = puVar11 + (int)uVar1;
          uVar10 = uVar10 - 1;
        } while (uVar10 != 0);
      }
    }
    else {
      lVar18 = (longlong)(int)uVar4;
      lVar13 = (longlong)(8 - iVar12) >> 1;
      puVar11 = puVar11 + lVar13;
      puVar17 = puVar11 + lVar18 + -1;
      if (0 < (int)uVar5) {
        do {
          uVar2 = *puVar16;
          uVar3 = puVar16[lVar18 + -1];
          if ((((puVar11 != (undefined *)0x0) && (uVar4 != 0)) &&
              ((puVar16 + uVar14 <= puVar11 || (puVar11 + uVar14 <= puVar16)))) && (uVar4 != 0)) {
            puVar9 = puVar11;
            uVar15 = uVar14;
            do {
              *puVar9 = (puVar16 + -(longlong)puVar11)[(longlong)puVar9];
              puVar9 = puVar9 + 1;
              uVar15 = uVar15 - 1;
            } while (uVar15 != 0);
          }
          lVar8 = 1;
          puVar9 = puVar11;
          if (0 < lVar13) {
            do {
              puVar9[-1] = uVar2;
              puVar17[lVar8] = uVar3;
              lVar8 = lVar8 + 1;
              puVar9 = puVar9 + -1;
            } while (lVar8 <= lVar13);
          }
          puVar16 = puVar16 + lVar18;
          puVar11 = puVar11 + (int)uVar1;
          puVar17 = puVar17 + (int)uVar1;
          uVar10 = uVar10 - 1;
        } while (uVar10 != 0);
      }
    }
  }
  return piVar7;
}



void FUN_180029d00(longlong param_1,longlong param_2,uint param_3)

{
  char cVar1;
  uint uVar2;
  uint uVar3;
  char *pcVar4;
  uint uVar5;
  byte bVar6;
  byte *pbVar7;

  uVar3 = 0;
  uVar5 = param_3 & 0xfffffff8;
  if (0 < (int)uVar5) {
    pbVar7 = (byte *)(param_1 + 6);
    uVar2 = uVar3;
    do {
      uVar3 = uVar2 + 8;
      *(byte *)((ulonglong)(uVar2 >> 3) + param_2) =
           ((((((pbVar7[1] * '\x02' | *pbVar7) * '\x02' | pbVar7[-1]) * '\x02' | pbVar7[-2]) *
              '\x02' | pbVar7[-3]) * '\x02' | pbVar7[-4]) * '\x02' | pbVar7[-5]) * '\x02' |
           pbVar7[-6];
      pbVar7 = pbVar7 + 8;
      uVar2 = uVar3;
    } while ((int)uVar3 < (int)uVar5);
  }
  uVar2 = param_3 & 0x80000007;
  if ((int)uVar2 < 0) {
    uVar2 = (uVar2 - 1 | 0xfffffff8) + 1;
  }
  if ((uVar2 != 0) &&
     (*(undefined *)(((int)(uVar3 + ((int)uVar3 >> 0x1f & 7U)) >> 3) + param_2) = 0,
     (int)uVar5 < (int)param_3)) {
    pcVar4 = (char *)((int)uVar5 + param_1);
    bVar6 = 0;
    do {
      uVar3 = uVar5;
      if ((int)uVar5 < 0) {
        uVar3 = uVar5 + 7;
      }
      cVar1 = *pcVar4;
      uVar5 = uVar5 + 1;
      pcVar4 = pcVar4 + 1;
      pbVar7 = (byte *)(((int)uVar3 >> 3) + param_2);
      *pbVar7 = *pbVar7 | cVar1 << (bVar6 & 0x1f);
      bVar6 = bVar6 + 1;
    } while ((int)uVar5 < (int)param_3);
  }
  return;
}



void FUN_180029df0(int *param_1,int **param_2)

{
  byte *pbVar1;
  char *pcVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte *pbVar7;
  byte *pbVar8;
  uint uVar9;
  byte bVar10;
  int iVar11;
  int *piVar12;
  longlong lVar13;
  byte bVar14;
  longlong lVar15;
  longlong lVar16;
  int iVar17;
  ulonglong uVar18;
  byte bVar19;
  longlong lVar20;
  longlong lVar21;
  longlong lVar22;
  int iVar23;

  uVar9 = param_1[1];
  uVar18 = (ulonglong)uVar9;
  lVar16 = *(longlong *)(param_1 + 6);
  iVar23 = *param_1;
  lVar22 = (longlong)iVar23;
  iVar17 = iVar23 >> 3;
  iVar23 = iVar23 + iVar17 * -8;
  iVar11 = iVar17 + 1;
  if (iVar23 < 1) {
    iVar11 = iVar17;
  }
  if (*param_2 == (int *)0x0) {
    piVar12 = (int *)malloc((longlong)(int)(iVar11 * uVar9) + 0x20);
    if (piVar12 != (int *)0x0) {
      piVar12[3] = iVar11 * uVar9;
      *piVar12 = iVar11;
      piVar12[1] = uVar9;
      piVar12[4] = 1;
      piVar12[2] = iVar11;
      *(int **)(piVar12 + 6) = piVar12 + 8;
    }
    *param_2 = piVar12;
  }
  lVar21 = (longlong)iVar17;
  lVar20 = *(longlong *)(*param_2 + 6);
  if (0 < (int)uVar9) {
    do {
      lVar13 = 0;
      lVar15 = 0;
      if (0 < lVar21) {
        do {
          pcVar2 = (char *)(lVar16 + 7 + lVar13);
          pbVar3 = (byte *)(lVar16 + 6 + lVar13);
          pbVar4 = (byte *)(lVar16 + 5 + lVar13);
          pbVar5 = (byte *)(lVar16 + 4 + lVar13);
          pbVar6 = (byte *)(lVar16 + 3 + lVar13);
          pbVar7 = (byte *)(lVar16 + 2 + lVar13);
          pbVar8 = (byte *)(lVar16 + 1 + lVar13);
          pbVar1 = (byte *)(lVar16 + lVar13);
          lVar13 = lVar13 + 8;
          *(byte *)(lVar15 + lVar20) =
               ((((((*pcVar2 * '\x02' | *pbVar3) * '\x02' | *pbVar4) * '\x02' | *pbVar5) * '\x02' |
                 *pbVar6) * '\x02' | *pbVar7) * '\x02' | *pbVar8) * '\x02' | *pbVar1;
          lVar15 = lVar15 + 1;
        } while (lVar15 < lVar21);
      }
      if (0 < iVar23) {
        bVar14 = 0;
        *(undefined *)(lVar21 + lVar20) = 0;
        if (lVar13 < lVar22) {
          bVar19 = 0;
          do {
            pcVar2 = (char *)(lVar13 + lVar16);
            lVar13 = lVar13 + 1;
            bVar10 = bVar14 & 0x1f;
            bVar14 = bVar14 + 1;
            bVar19 = bVar19 | *pcVar2 << bVar10;
            *(byte *)(lVar21 + lVar20) = bVar19;
          } while (lVar13 < lVar22);
        }
      }
      lVar16 = lVar16 + lVar22;
      lVar20 = lVar20 + iVar11;
      uVar18 = uVar18 - 1;
    } while (uVar18 != 0);
  }
  return;
}



int * FUN_180029f40(int *param_1)

{
  int iVar1;
  int iVar2;
  longlong lVar3;
  int iVar4;
  int *piVar5;
  int *piVar6;
  int iVar7;
  byte bVar8;
  byte *pbVar9;
  int *piVar10;

  iVar1 = param_1[1];
  iVar2 = *param_1;
  iVar7 = iVar1 * iVar2;
  iVar4 = (int)(iVar7 + (iVar7 >> 0x1f & 7U)) >> 3;
  piVar5 = (int *)malloc((longlong)iVar7 + 0x20);
  piVar6 = (int *)0x0;
  piVar10 = piVar6;
  if (piVar5 != (int *)0x0) {
    piVar5[3] = iVar7;
    *piVar5 = iVar2;
    piVar5[1] = iVar1;
    piVar5[4] = 1;
    piVar5[2] = iVar2;
    *(int **)(piVar5 + 6) = piVar5 + 8;
    piVar10 = piVar5;
  }
  lVar3 = *(longlong *)(param_1 + 6);
  pbVar9 = *(byte **)(piVar10 + 6);
  piVar5 = piVar6;
  if (0 < iVar4) {
    do {
      bVar8 = *(byte *)((longlong)piVar5 + lVar3);
      piVar5 = (int *)((longlong)piVar5 + 1);
      *pbVar9 = bVar8 & 1;
      pbVar9[1] = bVar8 >> 1 & 1;
      pbVar9[2] = bVar8 >> 2 & 1;
      pbVar9[3] = bVar8 >> 3 & 1;
      pbVar9[4] = bVar8 >> 4 & 1;
      pbVar9[5] = bVar8 >> 5 & 1;
      pbVar9[6] = bVar8 >> 6 & 1;
      pbVar9[7] = bVar8 >> 7;
      pbVar9 = pbVar9 + 8;
    } while ((longlong)piVar5 < (longlong)iVar4);
  }
  iVar7 = iVar7 + iVar4 * -8;
  if (0 < iVar7) {
    bVar8 = *(byte *)(iVar4 + lVar3);
    do {
      *(byte *)((longlong)piVar6 + (longlong)pbVar9) = bVar8 & 1;
      piVar6 = (int *)((longlong)piVar6 + 1);
      bVar8 = bVar8 >> 1;
    } while ((longlong)piVar6 < (longlong)iVar7);
  }
  return piVar10;
}



void FUN_18002a080(int *param_1,undefined8 *param_2)

{
  undefined8 *puVar1;
  byte bVar2;
  byte bVar3;
  byte bVar4;
  byte bVar5;
  longlong lVar6;
  longlong lVar7;
  int iVar8;
  longlong lVar9;
  ulonglong uVar10;
  undefined8 unaff_RBX;
  int iVar11;
  undefined8 unaff_RBP;
  ulonglong uVar12;
  ulonglong uVar13;
  int iVar14;
  undefined8 unaff_RSI;
  longlong lVar15;
  uint uVar16;
  byte *pbVar17;
  ulonglong uVar18;
  uint uVar19;
  longlong lVar20;
  byte *pbVar21;
  int iVar22;
  int iVar23;
  byte *pbVar24;
  int iVar25;
  longlong lVar26;
  byte *pbVar27;
  undefined8 unaff_R12;
  ulonglong uVar28;
  undefined8 unaff_R13;
  int iVar29;
  int iVar30;
  uint uVar31;
  undefined8 unaff_R14;
  uint uVar32;
  uint uVar33;
  undefined8 unaff_R15;
  undefined *puVar34;
  longlong lVar35;
  int aiStackX24 [4];
  undefined8 uStack16;

  uStack16 = 0x18002a08c;
  lVar7 = _alloca_probe();
  lVar7 = -lVar7;
  *(ulonglong *)(&stack0x00001068 + lVar7) =
       DAT_1800b04e8 ^ (ulonglong)(&stack0xfffffffffffffff8 + lVar7);
  *(undefined8 *)(&stack0x000010c8 + lVar7) = unaff_RBX;
  lVar6 = *(longlong *)(param_1 + 6);
  *(undefined8 *)(&stack0x000010a0 + lVar7) = unaff_RBP;
  iVar23 = param_1[1];
  *(undefined8 *)(&stack0x00001098 + lVar7) = unaff_RSI;
  iVar14 = *param_1;
  lVar15 = (longlong)iVar14;
  *(undefined8 **)(&stack0x00000058 + lVar7) = param_2;
  *(int *)(&stack0x00000044 + lVar7) = iVar14;
  *(undefined8 *)(&stack0x00001078 + lVar7) = unaff_R15;
  *(int *)((longlong)aiStackX24 + lVar7 + 0xc) = iVar23;
  *(undefined8 *)((longlong)&uStack16 + lVar7) = 0x18002a0ed;
  memset(&stack0x00000068 + lVar7,0,0x1000,*(undefined *)((longlong)&uStack16 + lVar7));
  uVar16 = iVar23 >> 2;
  iVar22 = iVar14 + 3 >> 2;
  iVar25 = iVar14 >> 2;
  uVar32 = iVar23 + 3 >> 2;
  *(uint *)(&stack0x00000028 + lVar7) = uVar16;
  *(int *)(&stack0x0000002c + lVar7) = iVar25;
  *(uint *)((longlong)aiStackX24 + lVar7 + 8) = uVar32;
  *(int *)((longlong)aiStackX24 + lVar7 + 4) = iVar22;
  if (param_2 != (undefined8 *)0x0) {
    lVar9 = 3;
    do {
      *param_2 = 0xffffffffffffffff;
      param_2[1] = 0xffffffffffffffff;
      param_2[2] = 0xffffffffffffffff;
      puVar1 = param_2 + 8;
      param_2[3] = 0xffffffffffffffff;
      param_2[4] = 0xffffffffffffffff;
      param_2[5] = 0xffffffffffffffff;
      param_2[6] = 0xffffffffffffffff;
      param_2[7] = 0xffffffffffffffff;
      lVar9 = lVar9 + -1;
      param_2 = puVar1;
    } while (lVar9 != 0);
    *puVar1 = 0xffffffffffffffff;
  }
  iVar29 = 0;
  *(undefined8 *)(&stack0x00001090 + lVar7) = unaff_R12;
  *(undefined8 *)(&stack0x00001088 + lVar7) = unaff_R13;
  *(int *)((longlong)aiStackX24 + lVar7) = 0;
  *(undefined8 *)(&stack0x00001080 + lVar7) = unaff_R14;
  if (0 < (int)uVar16) {
    lVar9 = (longlong)iVar22;
    lVar26 = (longlong)iVar25;
    *(longlong *)(&stack0x00000050 + lVar7) = lVar9;
    puVar34 = &stack0x00000068 + lVar26 + lVar7;
    iVar23 = iVar14 * 2;
    *(int *)(&stack0x00000034 + lVar7) = iVar23;
    *(int *)(&stack0x00000030 + lVar7) = iVar14 * -2;
    uVar10 = (ulonglong)uVar16;
    *(ulonglong *)(&stack0x00000038 + lVar7) = uVar10;
    lVar35 = lVar15;
    do {
      lVar20 = 0;
      iVar22 = 0;
      if (0 < lVar26) {
        iVar22 = (int)lVar35;
        *(int *)(&stack0x00000048 + lVar7) = iVar25 * 4;
        iVar23 = iVar14 + 2 + iVar23;
        iVar29 = -iVar22;
        iVar14 = iVar22 * -2;
        iVar22 = iVar22 * -3;
        do {
          if (0xf < ((uint)*(byte *)((iVar23 + -2 + iVar14) + lVar6) +
                     (uint)*(byte *)((iVar22 + -2 + iVar23) + lVar6) +
                     (uint)*(byte *)((iVar22 + -1 + iVar23) + lVar6) +
                     (uint)*(byte *)((iVar29 + -2 + iVar23) + lVar6) +
                     (uint)*(byte *)((iVar22 + 1 + iVar23) + lVar6) +
                     (uint)*(byte *)((iVar22 + iVar23) + lVar6) +
                     (uint)*(byte *)((iVar14 + -1 + iVar23) + lVar6) +
                     (uint)*(byte *)((iVar23 + iVar14 + 1) + lVar6) +
                     (uint)*(byte *)((iVar23 + iVar14) + lVar6) +
                     (uint)*(byte *)((iVar29 + -1 + iVar23) + lVar6) +
                     (uint)*(byte *)((iVar29 + 1 + iVar23) + lVar6) +
                     (uint)*(byte *)((iVar29 + iVar23) + lVar6) +
                     (uint)*(byte *)((iVar23 + -2) + lVar6) + (uint)*(byte *)((iVar23 + -1) + lVar6)
                     + (uint)*(byte *)((iVar23 + 1) + lVar6) + (uint)*(byte *)(iVar23 + lVar6)) * 2)
          {
            puVar34[lVar20 - lVar26] = 1;
          }
          lVar20 = lVar20 + 1;
          iVar23 = iVar23 + 4;
        } while (lVar20 < lVar26);
        lVar15 = (longlong)*(int *)(&stack0x00000044 + lVar7);
        iVar23 = *(int *)(&stack0x00000034 + lVar7);
        iVar22 = *(int *)(&stack0x00000048 + lVar7);
        iVar29 = *(int *)((longlong)aiStackX24 + lVar7);
        lVar9 = *(longlong *)(&stack0x00000050 + lVar7);
        uVar10 = *(ulonglong *)(&stack0x00000038 + lVar7);
        lVar35 = lVar15;
      }
      iVar30 = 0;
      iVar14 = (int)lVar35;
      if (lVar26 != lVar9) {
        lVar20 = (longlong)iVar22;
        iVar11 = 0;
        if (lVar20 < lVar15) {
          iVar29 = iVar22 + iVar23;
          iVar11 = ((int)lVar15 - iVar22) * 4;
          do {
            iVar22 = iVar14 + iVar29;
            iVar8 = iVar29 - iVar14;
            lVar9 = (longlong)iVar29;
            iVar29 = iVar29 + 1;
            pbVar17 = (byte *)((*(int *)(&stack0x00000030 + lVar7) + iVar23) + lVar6 + lVar20);
            lVar20 = lVar20 + 1;
            iVar30 = iVar30 + (uint)*pbVar17 +
                     (uint)*(byte *)(iVar22 + lVar6) + (uint)*(byte *)(iVar8 + lVar6) +
                     (uint)*(byte *)(lVar9 + lVar6);
          } while (lVar20 < lVar15);
          lVar9 = *(longlong *)(&stack0x00000050 + lVar7);
        }
        iVar29 = *(int *)((longlong)aiStackX24 + lVar7);
        uVar10 = *(ulonglong *)(&stack0x00000038 + lVar7);
        if (iVar11 <= iVar30 * 2) {
          *puVar34 = 1;
        }
      }
      iVar29 = iVar29 + 4;
      iVar23 = iVar23 + iVar14 * 4;
      *(int *)((longlong)aiStackX24 + lVar7) = iVar29;
      puVar34 = puVar34 + lVar9;
      *(int *)(&stack0x00000034 + lVar7) = iVar23;
      uVar10 = uVar10 - 1;
      *(ulonglong *)(&stack0x00000038 + lVar7) = uVar10;
    } while (uVar10 != 0);
    iVar23 = *(int *)((longlong)aiStackX24 + lVar7 + 0xc);
    iVar22 = *(int *)((longlong)aiStackX24 + lVar7 + 4);
    uVar16 = *(uint *)(&stack0x00000028 + lVar7);
    iVar25 = *(int *)(&stack0x0000002c + lVar7);
    uVar32 = *(uint *)((longlong)aiStackX24 + lVar7 + 8);
  }
  uVar10 = 0;
  uVar19 = 0;
  if (uVar16 != uVar32) {
    uVar32 = uVar16;
    if (0 < iVar25) {
      uVar13 = uVar10;
      uVar18 = uVar10;
      do {
        uVar33 = uVar19;
        uVar31 = uVar19;
        if ((int)(uVar16 * 4) < iVar23) {
          iVar22 = uVar16 * 4 * iVar14 + (int)uVar13;
          pbVar17 = (byte *)(iVar22 + lVar6);
          pbVar21 = (byte *)((iVar22 + 1) + lVar6);
          pbVar24 = (byte *)((iVar22 + 2) + lVar6);
          pbVar27 = (byte *)((iVar22 + 3) + lVar6);
          uVar32 = iVar23 + uVar16 * -4;
          uVar12 = (ulonglong)uVar32;
          *(uint *)(&stack0x00000030 + lVar7) = uVar32 * 4;
          uVar28 = uVar10;
          do {
            bVar2 = *pbVar21;
            pbVar21 = pbVar21 + lVar15;
            bVar3 = *pbVar27;
            pbVar27 = pbVar27 + lVar15;
            bVar4 = *pbVar24;
            pbVar24 = pbVar24 + lVar15;
            bVar5 = *pbVar17;
            pbVar17 = pbVar17 + lVar15;
            uVar31 = (int)uVar28 + (uint)bVar5 + (uint)bVar3 + (uint)bVar2 + (uint)bVar4;
            uVar28 = (ulonglong)uVar31;
            uVar12 = uVar12 - 1;
          } while (uVar12 != 0);
          uVar33 = *(uint *)(&stack0x00000030 + lVar7);
          iVar23 = *(int *)((longlong)aiStackX24 + lVar7 + 0xc);
          uVar32 = *(uint *)(&stack0x00000028 + lVar7);
          iVar25 = *(int *)(&stack0x0000002c + lVar7);
        }
        iVar22 = *(int *)((longlong)aiStackX24 + lVar7 + 4);
        if ((int)uVar33 <= (int)(uVar31 * 2)) {
          (&stack0x00000068)[(int)(iVar22 * uVar32 + (int)uVar18) + lVar7] = 1;
        }
        uVar33 = (int)uVar18 + 1;
        uVar18 = (ulonglong)uVar33;
        uVar13 = (ulonglong)((int)uVar13 + 4);
      } while ((int)uVar33 < iVar25);
    }
    uVar16 = uVar32;
    uVar32 = *(uint *)((longlong)aiStackX24 + lVar7 + 8);
  }
  if ((iVar25 != iVar22) && (uVar16 != uVar32)) {
    iVar23 = *(int *)((longlong)aiStackX24 + lVar7 + 0xc);
    uVar33 = uVar19;
    uVar31 = uVar19;
    if ((int)(uVar16 * 4) < iVar23) {
      lVar35 = (longlong)(iVar25 * 4);
      uVar28 = (ulonglong)(iVar23 + uVar16 * -4);
      lVar9 = (longlong)(int)(uVar16 * 4 * iVar14);
      uVar13 = uVar10;
      uVar18 = uVar10;
      do {
        iVar23 = (int)uVar18;
        if (lVar35 < lVar15) {
          lVar26 = lVar35;
          uVar16 = uVar19;
          uVar32 = uVar19;
          if (1 < lVar15 - lVar35) {
            uVar13 = (ulonglong)
                     ((int)uVar13 + (((int)(lVar15 + -1) + iVar25 * -4) - 1U & 0xfffffffe) + 2);
            uVar18 = uVar10;
            uVar12 = uVar10;
            do {
              uVar32 = (int)uVar18 + (uint)*(byte *)(lVar26 + lVar6 + lVar9);
              uVar18 = (ulonglong)uVar32;
              uVar16 = (int)uVar12 + (uint)*(byte *)(lVar26 + 1 + lVar6 + lVar9);
              uVar12 = (ulonglong)uVar16;
              lVar26 = lVar26 + 2;
            } while (lVar26 < lVar15 + -1);
          }
          if (lVar26 < lVar15) {
            iVar23 = iVar23 + (uint)*(byte *)(lVar26 + lVar9 + lVar6);
            uVar13 = (ulonglong)((int)uVar13 + 1);
          }
          uVar18 = (ulonglong)(iVar23 + uVar16 + uVar32);
        }
        uVar31 = (uint)uVar18;
        uVar33 = (uint)uVar13;
        lVar9 = lVar9 + lVar15;
        uVar28 = uVar28 - 1;
      } while (uVar28 != 0);
      iVar22 = *(int *)((longlong)aiStackX24 + lVar7 + 4);
      uVar16 = *(uint *)(&stack0x00000028 + lVar7);
      iVar25 = *(int *)(&stack0x0000002c + lVar7);
      uVar32 = *(uint *)((longlong)aiStackX24 + lVar7 + 8);
    }
    if ((int)uVar33 <= (int)(uVar31 * 2)) {
      (&stack0x00000068)[(int)(iVar22 * uVar16 + iVar25) + lVar7] = 1;
    }
  }
  lVar6 = *(longlong *)(&stack0x00000058 + lVar7);
  uVar32 = iVar22 * uVar32;
  uVar16 = uVar32 & 0xfffffff8;
  if (0 < (int)uVar16) {
    pbVar17 = &stack0x0000006e + lVar7;
    uVar13 = uVar10;
    do {
      uVar19 = (int)uVar13 + 8;
      *(byte *)((uVar13 >> 3) + lVar6) =
           ((((((pbVar17[1] * '\x02' | *pbVar17) * '\x02' | pbVar17[-1]) * '\x02' | pbVar17[-2]) *
              '\x02' | pbVar17[-3]) * '\x02' | pbVar17[-4]) * '\x02' | pbVar17[-5]) * '\x02' |
           pbVar17[-6];
      pbVar17 = pbVar17 + 8;
      uVar13 = (ulonglong)uVar19;
    } while ((int)uVar19 < (int)uVar16);
  }
  uVar33 = uVar32 & 0x80000007;
  if ((int)uVar33 < 0) {
    uVar33 = (uVar33 - 1 | 0xfffffff8) + 1;
  }
  if (uVar33 != 0) {
    lVar15 = (longlong)(int)uVar16;
    *(undefined *)(((int)(uVar19 + ((int)uVar19 >> 0x1f & 7U)) >> 3) + lVar6) = 0;
    while (lVar15 < (int)uVar32) {
      uVar19 = uVar16;
      if ((int)uVar16 < 0) {
        uVar19 = uVar16 + 7;
      }
      lVar9 = lVar15 + lVar7;
      uVar16 = uVar16 + 1;
      lVar15 = lVar15 + 1;
      pbVar17 = (byte *)(((int)uVar19 >> 3) + lVar6);
      *pbVar17 = *pbVar17 | (&stack0x00000068)[lVar9] << ((byte)uVar10 & 0x1f);
      uVar10 = (ulonglong)((int)uVar10 + 1);
    }
  }
  *(undefined8 *)((longlong)&uStack16 + lVar7) = 0x18002a700;
  FUN_18005f100(*(ulonglong *)(&stack0x00001068 + lVar7) ^
                (ulonglong)(&stack0xfffffffffffffff8 + lVar7),
                *(undefined *)((longlong)&uStack16 + lVar7));
  return;
}



uint * FUN_18002a710(undefined8 param_1,int param_2,uint param_3,uint param_4)

{
  undefined uVar1;
  longlong lVar2;
  int *_Memory;
  uint *puVar3;
  undefined *puVar4;
  ulonglong uVar5;
  undefined *puVar6;
  longlong lVar7;
  int iVar8;
  uint uVar9;
  uint uVar10;
  uint *puVar11;
  longlong lVar12;
  ulonglong uVar13;
  int iVar14;
  uint *puVar15;
  int local_48;
  int local_44;
  undefined4 local_40;
  int local_3c;
  undefined4 local_38;
  undefined8 local_30;

  local_40 = 0xffffffff;
  iVar14 = (int)(param_4 + 3) >> 2;
  local_44 = (int)(param_3 + 3) >> 2;
  local_38 = 8;
  local_3c = (int)(iVar14 * local_44 + (iVar14 * local_44 >> 0x1f & 7U)) >> 3;
  local_48 = iVar14;
  local_30 = param_1;
  _Memory = FUN_180029f40(&local_48);
  lVar2 = *(longlong *)(_Memory + 6);
  if (param_2 == 1) {
    param_3 = (int)param_3 >> 1;
    param_4 = (int)param_4 >> 1;
  }
  puVar3 = (uint *)malloc((longlong)(int)(param_4 * param_3) + 0x20);
  puVar11 = (uint *)0x0;
  puVar15 = puVar11;
  if (puVar3 != (uint *)0x0) {
    puVar3[3] = param_4 * param_3;
    *puVar3 = param_4;
    puVar3[1] = param_3;
    puVar3[4] = 1;
    puVar3[2] = param_4;
    *(uint **)(puVar3 + 6) = puVar3 + 8;
    puVar15 = puVar3;
  }
  if ((*(undefined **)(puVar15 + 6) != (undefined *)0x0) && (puVar15[3] != 0)) {
    uVar5 = (ulonglong)puVar15[3];
    puVar4 = *(undefined **)(puVar15 + 6);
    while (uVar5 != 0) {
      uVar5 = uVar5 - 1;
      *puVar4 = 0xff;
      puVar4 = puVar4 + 1;
    }
  }
  lVar12 = *(longlong *)(puVar15 + 6);
  if (param_2 == 1) {
    uVar5 = SEXT48((int)param_4);
    uVar13 = uVar5 & 0xfffffffffffffffe;
    if (0 < (int)param_3) {
      do {
        iVar8 = ((int)puVar11 >> 1) * iVar14;
        if (0 < (longlong)uVar13) {
          puVar4 = (undefined *)(lVar12 + 1);
          lVar7 = (uVar13 - 1 >> 1) + 1;
          puVar6 = (undefined *)(iVar8 + lVar2);
          iVar8 = iVar8 + (int)lVar7;
          do {
            uVar1 = *puVar6;
            puVar6 = puVar6 + 1;
            puVar4[-1] = uVar1;
            *puVar4 = uVar1;
            puVar4 = puVar4 + 2;
            lVar7 = lVar7 + -1;
          } while (lVar7 != 0);
        }
        if (uVar13 != uVar5) {
          *(undefined *)(uVar13 + lVar12) = *(undefined *)(iVar8 + lVar2);
        }
        uVar9 = (int)puVar11 + 1;
        puVar11 = (uint *)(ulonglong)uVar9;
        lVar12 = lVar12 + uVar5;
      } while ((int)uVar9 < (int)param_3);
    }
  }
  else {
    uVar9 = param_4 & 0xfffffffc;
    if (0 < (int)param_3) {
      do {
        iVar8 = ((int)puVar11 >> 2) * iVar14;
        if (0 < (int)uVar9) {
          puVar4 = (undefined *)(lVar12 + 1);
          lVar7 = ((longlong)(int)uVar9 - 1U >> 2) + 1;
          puVar6 = (undefined *)(iVar8 + lVar2);
          iVar8 = iVar8 + (int)lVar7;
          do {
            uVar1 = *puVar6;
            puVar6 = puVar6 + 1;
            puVar4[-1] = uVar1;
            *puVar4 = uVar1;
            puVar4[1] = uVar1;
            puVar4[2] = uVar1;
            puVar4 = puVar4 + 4;
            lVar7 = lVar7 + -1;
          } while (lVar7 != 0);
        }
        if ((uVar9 != param_4) && (uVar1 = *(undefined *)(iVar8 + lVar2), (int)uVar9 < (int)param_4)
           ) {
          lVar7 = (longlong)(int)(param_4 - uVar9);
          puVar4 = (undefined *)((int)uVar9 + lVar12);
          while (lVar7 != 0) {
            lVar7 = lVar7 + -1;
            *puVar4 = uVar1;
            puVar4 = puVar4 + 1;
          }
        }
        uVar10 = (int)puVar11 + 1;
        puVar11 = (uint *)(ulonglong)uVar10;
        lVar12 = lVar12 + (int)param_4;
      } while ((int)uVar10 < (int)param_3);
    }
  }
  free(_Memory);
  return puVar15;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18002a930(uint *param_1,uint *param_2,ulonglong *param_3,int param_4,int *param_5,
                  int *param_6)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  uint *_Memory;
  ulonglong uVar4;
  int iVar5;
  ulonglong uVar6;
  int iVar7;
  int iVar8;
  char *pcVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  undefined auStack184 [32];
  int local_98;
  int local_94;
  int local_90;
  int local_8c;
  char *local_88;
  ulonglong local_80;
  uint *local_78;
  uint *local_70;
  int *local_68;
  int *local_60;
  int local_58;
  int iStack84;
  int iStack80;
  int iStack76;
  undefined8 local_48;
  ulonglong local_40;

  local_40 = DAT_1800b04e8 ^ (ulonglong)auStack184;
  local_60 = param_5;
  iVar8 = 0;
  local_68 = param_6;
  local_58 = 0x100;
  iStack84 = 0;
  iStack80 = 0;
  iStack76 = 0;
  local_94 = 0x100;
  local_8c = param_4;
  local_78 = FUN_18002a710(param_1 + 10,param_4,param_1[1],*param_1);
  _Memory = FUN_18002a710(param_2 + 10,param_4,param_2[1],*param_2);
  uVar1 = *local_78;
  uVar2 = local_78[1];
  uVar4 = (ulonglong)uVar2;
  local_88 = *(char **)(local_78 + 6);
  local_90 = uVar1 * uVar2;
  local_48._4_4_ = 0;
  if ((param_3 != (ulonglong *)0x0) &&
     ((param_3 + 3 <= &local_58 || (local_48._4_4_ = 0, &local_40 <= param_3)))) {
    local_58 = *(int *)param_3;
    iStack84 = *(int *)((longlong)param_3 + 4);
    iStack80 = *(int *)(param_3 + 1);
    iStack76 = *(int *)((longlong)param_3 + 0xc);
    local_48 = param_3[2];
    local_48._4_4_ = (int)(local_48 >> 0x20);
    local_94 = (int)local_48;
  }
  local_98 = iStack80;
  if (param_4 != 0) {
    local_48._4_4_ = (local_48._4_4_ + 1) / 2;
    local_98 = (iStack80 + 1) / 2;
  }
  if (0 < (int)uVar2) {
    iVar7 = 0;
    iVar12 = 0;
    do {
      if (0 < (int)uVar1) {
        iVar10 = 0;
        uVar6 = (ulonglong)uVar1;
        iVar11 = 0;
        pcVar9 = local_88;
        do {
          if (*pcVar9 != '\0') {
            iVar5 = iVar11 + 0x80 + iVar12 + local_98 >> 8;
            iVar3 = iVar10 + 0x80 + iVar7 + local_48._4_4_ >> 8;
            if ((((-1 < iVar5) && (iVar5 < (int)uVar1)) && (-1 < iVar3)) &&
               ((iVar3 < (int)uVar2 &&
                (*(char *)((longlong)(int)(iVar3 * uVar1 + iVar5) + *(longlong *)(_Memory + 6)) !=
                 '\0')))) {
              iVar8 = iVar8 + 1;
            }
          }
          iVar11 = iVar11 + local_58;
          iVar10 = iVar10 + iStack76;
          pcVar9 = pcVar9 + 1;
          uVar6 = uVar6 - 1;
        } while (uVar6 != 0);
      }
      iVar12 = iVar12 + iStack84;
      local_88 = local_88 + (int)uVar1;
      iVar7 = iVar7 + local_94;
      uVar4 = uVar4 - 1;
      param_6 = local_68;
      param_5 = local_60;
      param_4 = local_8c;
      local_80 = uVar4;
    } while (uVar4 != 0);
  }
  if (local_90 < 1) {
    iVar8 = 0;
    *param_6 = 0;
  }
  else {
    if (param_4 == 0) {
      *param_6 = iVar8;
      iVar8 = ((local_90 >> 1) + iVar8 * 0x100) / local_90;
    }
    else {
      *param_6 = iVar8 * 4;
      iVar8 = ((local_90 >> 1) + iVar8 * 0x100) / local_90;
    }
  }
  *param_5 = iVar8;
  local_70 = _Memory;
  free(local_78);
  free(_Memory);
  FUN_18005f100(local_40 ^ (ulonglong)auStack184);
  return;
}



void FUN_18002abc0(int *param_1,longlong param_2,int *param_3,uint **param_4,uint **param_5,
                  int *param_6)

{
  uint **ppuVar1;
  int iVar2;
  int *piVar3;
  uint *puVar4;
  ulonglong uVar5;
  int iVar6;
  longlong lVar7;
  int iVar8;
  int *piVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  undefined *puVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  int iVar18;
  int local_a8;
  int local_a4;
  int local_a0;
  int local_9c;
  int local_98;
  int *local_90;
  int *local_88;
  int *local_80;
  uint **local_78;
  longlong local_70;
  uint **local_68;
  int local_60;
  undefined4 uStack92;
  undefined4 uStack88;
  undefined4 uStack84;
  undefined8 local_50;
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xffffffffffffff18;
  iVar16 = param_3[5];
  local_68 = param_5;
  local_90 = param_6;
  local_a4 = *param_1;
  iVar17 = param_6[4];
  iVar12 = param_3[4] * iVar17;
  iVar8 = (param_6[3] - iVar17) + -1;
  local_a0 = param_1[1];
  local_a8 = param_6[5];
  iVar18 = (local_a0 - iVar17) + -1;
  local_60 = 0x100;
  uStack92 = 0;
  uStack88 = 0;
  uStack84 = 0;
  local_50 = 0x100;
  iVar6 = param_3[1] * iVar17;
  iVar2 = param_3[2];
  iVar10 = param_3[3] * (param_6[2] + iVar17);
  iVar14 = param_3[3] * iVar8;
  iVar11 = param_3[1] * iVar18;
  iVar18 = param_3[4] * iVar18;
  iVar15 = *param_3 * (param_6[2] + iVar17);
  local_98 = iVar16 + 0x80 + iVar10 + iVar12 >> 8;
  iVar8 = *param_3 * iVar8;
  local_9c = iVar16 + iVar14 + iVar12 + 0x80 >> 8;
  iVar14 = iVar16 + iVar18 + iVar14 + 0x80 >> 8;
  iVar17 = iVar6 + 0x80 + iVar2 + iVar15 >> 8;
  iVar10 = iVar16 + 0x80 + iVar18 + iVar10 >> 8;
  iVar12 = iVar6 + 0x80 + iVar2 + iVar8 >> 8;
  iVar6 = iVar8 + 0x80 + iVar2 + iVar11 >> 8;
  iVar2 = iVar2 + iVar11 + iVar15 + 0x80 >> 8;
  iVar16 = iVar14;
  if (iVar10 <= iVar14) {
    iVar16 = iVar10;
  }
  iVar8 = local_9c;
  if ((iVar16 <= local_9c) && (iVar8 = iVar10, iVar14 < iVar10)) {
    iVar8 = iVar14;
  }
  iVar11 = local_98;
  if (((iVar8 <= local_98) && (iVar11 = local_9c, iVar16 <= local_9c)) &&
     (iVar11 = iVar10, iVar14 < iVar10)) {
    iVar11 = iVar14;
  }
  iVar16 = iVar14;
  if (iVar14 <= iVar10) {
    iVar16 = iVar10;
  }
  iVar8 = local_9c;
  if ((local_9c <= iVar16) && (iVar8 = iVar10, iVar10 < iVar14)) {
    iVar8 = iVar14;
  }
  iVar15 = local_98;
  if (((local_98 <= iVar8) && (iVar15 = local_9c, local_9c <= iVar16)) &&
     (iVar15 = iVar10, iVar10 < iVar14)) {
    iVar15 = iVar14;
  }
  iVar16 = iVar6;
  if (iVar2 <= iVar6) {
    iVar16 = iVar2;
  }
  iVar10 = iVar12;
  if ((iVar16 <= iVar12) && (iVar10 = iVar2, iVar6 < iVar2)) {
    iVar10 = iVar6;
  }
  iVar8 = iVar17;
  if (((iVar10 <= iVar17) && (iVar8 = iVar12, iVar16 <= iVar12)) && (iVar8 = iVar2, iVar6 < iVar2))
  {
    iVar8 = iVar6;
  }
  iVar16 = iVar6;
  if (iVar6 <= iVar2) {
    iVar16 = iVar2;
  }
  iVar10 = iVar12;
  if ((iVar12 <= iVar16) && (iVar10 = iVar2, iVar2 < iVar6)) {
    iVar10 = iVar6;
  }
  if (((iVar17 <= iVar10) && (iVar17 = iVar12, iVar12 <= iVar16)) && (iVar17 = iVar2, iVar2 < iVar6)
     ) {
    iVar17 = iVar6;
  }
  iVar16 = 0;
  if (0 < iVar8) {
    iVar16 = iVar8;
  }
  iVar2 = 0;
  if (0 < iVar11) {
    iVar2 = iVar11;
  }
  iVar10 = *param_6 + -1;
  if (iVar17 <= *param_6 + -1) {
    iVar10 = iVar17;
  }
  iVar10 = (iVar10 - iVar16) + 1;
  iVar17 = param_6[1] + -1;
  if (iVar15 <= param_6[1] + -1) {
    iVar17 = iVar15;
  }
  iVar17 = (iVar17 - iVar2) + 1;
  local_88 = param_3;
  local_80 = param_1;
  local_78 = param_4;
  local_70 = param_2;
  if ((0 < iVar10) && (0 < iVar17)) {
    piVar9 = &local_60;
    if (*(int **)(param_6 + 8) != (int *)0x0) {
      piVar9 = *(int **)(param_6 + 8);
    }
    if ((piVar9 != (int *)0x0) && ((param_3 + 6 <= piVar9 || (piVar9 + 6 <= param_3)))) {
      lVar7 = 0x18;
      piVar3 = piVar9;
      do {
        *(undefined *)piVar3 =
             *(undefined *)((longlong)((longlong)param_3 - (longlong)piVar9) + (longlong)piVar3);
        piVar3 = (int *)((longlong)piVar3 + 1);
        lVar7 = lVar7 + -1;
      } while (lVar7 != 0);
    }
    piVar9[2] = piVar9[2] + iVar16 * -0x100;
    piVar9[5] = piVar9[5] + iVar2 * -0x100;
    puVar4 = (uint *)FUN_180022ff0(iVar10,iVar17,param_1[4]);
    if ((*(undefined **)(puVar4 + 6) != (undefined *)0x0) && (puVar4[3] != 0)) {
      uVar5 = (ulonglong)puVar4[3];
      puVar13 = *(undefined **)(puVar4 + 6);
      while (uVar5 != 0) {
        uVar5 = uVar5 - 1;
        *puVar13 = 0xff;
        puVar13 = puVar13 + 1;
      }
    }
    FUN_180023700((longlong)param_1,(longlong)puVar4,piVar9,local_a0,local_a4,puVar4[1],*puVar4,
                  local_a8);
    ppuVar1 = local_68;
    lVar7 = local_70;
    *local_78 = puVar4;
    if ((local_70 != 0) && (local_68 != (uint **)0x0)) {
      puVar4 = (uint *)FUN_180022ff0(iVar10,iVar17,*(int *)(local_70 + 0x10));
      puVar13 = *(undefined **)(puVar4 + 6);
      if ((puVar13 != (undefined *)0x0) && (uVar5 = (ulonglong)puVar4[3], puVar4[3] != 0)) {
        while (uVar5 != 0) {
          uVar5 = uVar5 - 1;
          *puVar13 = 0xff;
          puVar13 = puVar13 + 1;
        }
      }
      FUN_180023700(lVar7,(longlong)puVar4,piVar9,local_a0,local_a4,puVar4[1],*puVar4,local_a8);
      *ppuVar1 = puVar4;
    }
    local_90[6] = iVar16;
    local_90[7] = iVar2;
  }
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xffffffffffffff18);
  return;
}



void FUN_18002afc0(undefined *param_1,undefined *param_2)

{
  undefined *puVar1;
  uint uVar2;
  longlong lVar3;
  longlong lVar4;
  longlong lVar5;
  longlong lVar6;
  int iVar7;
  ulonglong uVar8;
  undefined8 unaff_RBX;
  longlong lVar9;
  int iVar10;
  int iVar11;
  undefined *puVar12;
  uint uVar13;
  longlong lVar14;
  uint uVar15;
  int iVar16;
  undefined8 unaff_R12;
  ulonglong uVar17;
  undefined8 unaff_R13;
  undefined8 unaff_R14;
  undefined8 unaff_R15;
  longlong lVar18;
  undefined8 uStack32;

  uStack32 = 0x18002afce;
  lVar3 = _alloca_probe();
  lVar3 = -lVar3;
  *(ulonglong *)(&stack0x00009918 + lVar3) =
       DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffe8 + lVar3);
  iVar16 = *(int *)(&stack0x00009980 + lVar3);
  uVar2 = *(uint *)(&stack0x00009978 + lVar3);
  uVar15 = iVar16 * uVar2;
  uVar8 = (ulonglong)uVar15;
  iVar10 = iVar16 + 2;
  uVar13 = iVar10 * (uVar2 + 2);
  if ((((param_2 != (undefined *)0x0) && (param_1 != (undefined *)0x0)) && (uVar15 != 0)) &&
     (((param_1 + uVar8 <= param_2 || (param_2 + uVar8 <= param_1)) && (uVar15 != 0)))) {
    puVar12 = param_2;
    do {
      *puVar12 = (param_1 + -(longlong)param_2)[(longlong)puVar12];
      puVar12 = puVar12 + 1;
      uVar8 = uVar8 - 1;
    } while (uVar8 != 0);
  }
  if (uVar13 != 0) {
    uVar8 = (ulonglong)uVar13;
    puVar12 = &stack0x00004c88 + lVar3;
    while (uVar8 != 0) {
      uVar8 = uVar8 - 1;
      *puVar12 = 0;
      puVar12 = puVar12 + 1;
    }
    if (uVar13 != 0) {
      uVar8 = (ulonglong)uVar13;
      puVar12 = &stack0xfffffffffffffff8 + lVar3;
      while (uVar8 != 0) {
        uVar8 = uVar8 - 1;
        *puVar12 = 0;
        puVar12 = puVar12 + 1;
      }
    }
  }
  if (1 < (int)(uVar2 + 1)) {
    *(undefined8 *)(&stack0x00009958 + lVar3) = unaff_RBX;
    *(undefined8 *)(&stack0x00009968 + lVar3) = unaff_R12;
    puVar12 = &stack0xfffffffffffffff8 + lVar3;
    *(undefined8 *)(&stack0x00009970 + lVar3) = unaff_R13;
    *(undefined8 *)(&stack0x00009930 + lVar3) = unaff_R14;
    *(undefined8 *)(&stack0x00009928 + lVar3) = unaff_R15;
    lVar9 = (longlong)(iVar16 + 1);
    lVar18 = (longlong)iVar10;
    uVar17 = (ulonglong)uVar2;
    lVar14 = 0;
    *(longlong *)(&stack0xfffffffffffffff0 + lVar3) = (longlong)iVar16;
    *(ulonglong *)(&stack0xffffffffffffffe8 + lVar3) = uVar17;
    uVar8 = (ulonglong)uVar2;
    do {
      puVar12 = puVar12 + lVar18;
      lVar6 = 1;
      if (1 < lVar9) {
        iVar7 = 0;
        do {
          lVar4 = (longlong)iVar7;
          iVar7 = iVar7 + 1;
          puVar12[lVar6] = param_2[lVar4 + lVar14];
          lVar6 = lVar6 + 1;
        } while (lVar6 < lVar9);
      }
      lVar14 = lVar14 + iVar16;
      uVar8 = uVar8 - 1;
    } while (uVar8 != 0);
    iVar16 = 0;
    lVar14 = -lVar18 + 1;
    lVar6 = lVar18;
    do {
      lVar4 = lVar6;
      if (1 < lVar9) {
        do {
          if ((&stack0xfffffffffffffff9)[lVar4 + lVar3] == -1) {
            (&stack0x00004c89)[lVar4 + lVar3] = 0xff;
            iVar11 = -1;
            iVar7 = iVar16;
            do {
              lVar5 = -1;
              do {
                if ((&stack0xfffffffffffffff8)[lVar5 + iVar7 + lVar14 + lVar4 + lVar3] == '\0') {
                  (&stack0x00004c89)[lVar4 + lVar3] = 0;
                  goto LAB_18002b179;
                }
                lVar5 = lVar5 + 1;
              } while (lVar5 < 1);
              iVar11 = iVar11 + 1;
              iVar7 = iVar7 + iVar10;
            } while (iVar11 < 1);
          }
LAB_18002b179:
          lVar4 = lVar4 + 1;
        } while (lVar14 + lVar4 < lVar9);
      }
      lVar6 = lVar6 + lVar18;
      lVar14 = lVar14 + -lVar18;
      iVar16 = iVar16 + iVar10;
      uVar17 = uVar17 - 1;
    } while (uVar17 != 0);
    lVar6 = *(longlong *)(&stack0xffffffffffffffe8 + lVar3);
    puVar12 = &stack0x00004c88 + lVar3;
    lVar14 = *(longlong *)(&stack0xfffffffffffffff0 + lVar3);
    lVar4 = 0;
    do {
      puVar12 = puVar12 + lVar18;
      lVar5 = 1;
      if (1 < lVar9) {
        iVar16 = 0;
        do {
          puVar1 = puVar12 + lVar5;
          lVar5 = lVar5 + 1;
          lVar6 = (longlong)iVar16;
          iVar16 = iVar16 + 1;
          param_2[lVar6 + lVar4] = *puVar1;
        } while (lVar5 < lVar9);
        lVar6 = *(longlong *)(&stack0xffffffffffffffe8 + lVar3);
      }
      lVar4 = lVar4 + lVar14;
      lVar6 = lVar6 + -1;
      *(longlong *)(&stack0xffffffffffffffe8 + lVar3) = lVar6;
    } while (lVar6 != 0);
  }
  *(undefined8 *)((longlong)&uStack32 + lVar3) = 0x18002b22c;
  FUN_18005f100(*(ulonglong *)(&stack0x00009918 + lVar3) ^
                (ulonglong)(&stack0xffffffffffffffe8 + lVar3),
                *(undefined *)((longlong)&uStack32 + lVar3));
  return;
}



void FUN_18002b240(undefined *param_1,undefined *param_2)

{
  undefined *puVar1;
  uint uVar2;
  longlong lVar3;
  longlong lVar4;
  longlong lVar5;
  longlong lVar6;
  int iVar7;
  ulonglong uVar8;
  int iVar9;
  undefined8 unaff_RSI;
  longlong lVar10;
  int iVar11;
  undefined *puVar12;
  uint uVar13;
  longlong lVar14;
  uint uVar15;
  int iVar16;
  undefined8 unaff_R12;
  ulonglong uVar17;
  undefined8 unaff_R13;
  undefined8 unaff_R14;
  undefined8 unaff_R15;
  longlong lVar18;
  undefined8 uStack32;

  uStack32 = 0x18002b24e;
  lVar3 = _alloca_probe();
  lVar3 = -lVar3;
  *(ulonglong *)(&stack0x00009918 + lVar3) =
       DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffe8 + lVar3);
  iVar16 = *(int *)(&stack0x00009980 + lVar3);
  uVar2 = *(uint *)(&stack0x00009978 + lVar3);
  uVar15 = iVar16 * uVar2;
  uVar8 = (ulonglong)uVar15;
  iVar9 = iVar16 + 2;
  uVar13 = iVar9 * (uVar2 + 2);
  if ((((param_2 != (undefined *)0x0) && (param_1 != (undefined *)0x0)) && (uVar15 != 0)) &&
     (((param_1 + uVar8 <= param_2 || (param_2 + uVar8 <= param_1)) && (uVar15 != 0)))) {
    puVar12 = param_2;
    do {
      *puVar12 = (param_1 + -(longlong)param_2)[(longlong)puVar12];
      puVar12 = puVar12 + 1;
      uVar8 = uVar8 - 1;
    } while (uVar8 != 0);
  }
  if (uVar13 != 0) {
    uVar8 = (ulonglong)uVar13;
    puVar12 = &stack0x00004c88 + lVar3;
    while (uVar8 != 0) {
      uVar8 = uVar8 - 1;
      *puVar12 = 0;
      puVar12 = puVar12 + 1;
    }
    if (uVar13 != 0) {
      uVar8 = (ulonglong)uVar13;
      puVar12 = &stack0xfffffffffffffff8 + lVar3;
      while (uVar8 != 0) {
        uVar8 = uVar8 - 1;
        *puVar12 = 0;
        puVar12 = puVar12 + 1;
      }
    }
  }
  if (1 < (int)(uVar2 + 1)) {
    *(undefined8 *)(&stack0x00009958 + lVar3) = unaff_RSI;
    *(undefined8 *)(&stack0x00009968 + lVar3) = unaff_R12;
    puVar12 = &stack0xfffffffffffffff8 + lVar3;
    *(undefined8 *)(&stack0x00009970 + lVar3) = unaff_R13;
    *(undefined8 *)(&stack0x00009930 + lVar3) = unaff_R14;
    *(undefined8 *)(&stack0x00009928 + lVar3) = unaff_R15;
    lVar10 = (longlong)(iVar16 + 1);
    lVar18 = (longlong)iVar9;
    uVar17 = (ulonglong)uVar2;
    lVar14 = 0;
    *(longlong *)(&stack0xfffffffffffffff0 + lVar3) = (longlong)iVar16;
    *(ulonglong *)(&stack0xffffffffffffffe8 + lVar3) = uVar17;
    uVar8 = (ulonglong)uVar2;
    do {
      puVar12 = puVar12 + lVar18;
      lVar6 = 1;
      if (1 < lVar10) {
        iVar7 = 0;
        do {
          lVar4 = (longlong)iVar7;
          iVar7 = iVar7 + 1;
          puVar12[lVar6] = param_2[lVar4 + lVar14];
          lVar6 = lVar6 + 1;
        } while (lVar6 < lVar10);
      }
      lVar14 = lVar14 + iVar16;
      uVar8 = uVar8 - 1;
    } while (uVar8 != 0);
    iVar16 = 0;
    lVar14 = -lVar18 + 1;
    lVar6 = lVar18;
    do {
      lVar4 = lVar6;
      if (1 < lVar10) {
        do {
          if ((&stack0xfffffffffffffff9)[lVar4 + lVar3] == -1) {
LAB_18002b3e0:
            (&stack0x00004c89)[lVar4 + lVar3] = 0xff;
          }
          else {
            iVar11 = -1;
            iVar7 = iVar16;
            do {
              lVar5 = -1;
              do {
                if ((&stack0xfffffffffffffff8)[lVar5 + iVar7 + lVar14 + lVar4 + lVar3] == -1)
                goto LAB_18002b3e0;
                lVar5 = lVar5 + 1;
              } while (lVar5 < 1);
              iVar11 = iVar11 + 1;
              iVar7 = iVar7 + iVar9;
            } while (iVar11 < 1);
          }
          lVar4 = lVar4 + 1;
        } while (lVar14 + lVar4 < lVar10);
      }
      lVar6 = lVar6 + lVar18;
      lVar14 = lVar14 + -lVar18;
      iVar16 = iVar16 + iVar9;
      uVar17 = uVar17 - 1;
    } while (uVar17 != 0);
    lVar6 = *(longlong *)(&stack0xffffffffffffffe8 + lVar3);
    puVar12 = &stack0x00004c88 + lVar3;
    lVar14 = *(longlong *)(&stack0xfffffffffffffff0 + lVar3);
    lVar4 = 0;
    do {
      puVar12 = puVar12 + lVar18;
      lVar5 = 1;
      if (1 < lVar10) {
        iVar16 = 0;
        do {
          puVar1 = puVar12 + lVar5;
          lVar5 = lVar5 + 1;
          lVar6 = (longlong)iVar16;
          iVar16 = iVar16 + 1;
          param_2[lVar6 + lVar4] = *puVar1;
        } while (lVar5 < lVar10);
        lVar6 = *(longlong *)(&stack0xffffffffffffffe8 + lVar3);
      }
      lVar4 = lVar4 + lVar14;
      lVar6 = lVar6 + -1;
      *(longlong *)(&stack0xffffffffffffffe8 + lVar3) = lVar6;
    } while (lVar6 != 0);
  }
  *(undefined8 *)((longlong)&uStack32 + lVar3) = 0x18002b48c;
  FUN_18005f100(*(ulonglong *)(&stack0x00009918 + lVar3) ^
                (ulonglong)(&stack0xffffffffffffffe8 + lVar3),
                *(undefined *)((longlong)&uStack32 + lVar3));
  return;
}



void FUN_18002b4a0(undefined *param_1,undefined *param_2,int param_3,undefined param_4,
                  undefined param_5,undefined4 param_6,undefined4 param_7)

{
  if (param_3 == 0) {
    FUN_18002afc0(param_1,param_2);
  }
  else {
    if (param_3 == 1) {
      FUN_18002b240(param_1,param_2);
      return;
    }
  }
  return;
}



void FUN_18002b4f0(int *param_1,int *param_2,longlong param_3,longlong param_4,int param_5,
                  int param_6,undefined8 *param_7,int *param_8,int *param_9)

{
  undefined8 *puVar1;
  byte bVar2;
  byte bVar3;
  char cVar4;
  int iVar5;
  longlong lVar6;
  longlong lVar7;
  char *pcVar8;
  int *piVar9;
  byte *pbVar10;
  int iVar11;
  ulonglong uVar12;
  int iVar13;
  int *_Memory;
  int iVar14;
  longlong lVar15;
  uint uVar16;
  undefined *puVar17;
  int iVar18;
  longlong lVar19;
  int *piVar20;
  longlong lVar21;
  longlong local_68;

  iVar13 = *param_1;
  iVar5 = *param_2;
  iVar14 = iVar13 - param_6;
  if (iVar5 < iVar13 - param_6) {
    iVar14 = iVar5;
  }
  iVar11 = param_1[1] - param_5;
  if (param_2[1] < iVar11) {
    iVar11 = param_2[1];
  }
  piVar20 = (int *)0x0;
  _Memory = piVar20;
  if (param_9 != (int *)0x0) {
    uVar16 = iVar11 * iVar14;
    piVar9 = (int *)malloc((longlong)(int)uVar16 + 0x20);
    if (piVar9 != (int *)0x0) {
      piVar9[3] = uVar16;
      *piVar9 = iVar14;
      piVar9[1] = iVar11;
      piVar9[4] = 1;
      piVar9[2] = iVar14;
      *(int **)(piVar9 + 6) = piVar9 + 8;
      _Memory = piVar9;
    }
    if ((*(undefined **)(_Memory + 6) != (undefined *)0x0) && (uVar16 != 0)) {
      uVar12 = (ulonglong)uVar16;
      puVar17 = *(undefined **)(_Memory + 6);
      while (uVar12 != 0) {
        uVar12 = uVar12 - 1;
        *puVar17 = 0;
        puVar17 = puVar17 + 1;
      }
    }
  }
  *param_8 = 0;
  if (param_7 != (undefined8 *)0x0) {
    *param_7 = 0;
    param_7[1] = 0;
  }
  if (0 < iVar11) {
    local_68 = 0;
    lVar21 = (longlong)(iVar13 * param_5);
    do {
      iVar18 = 0;
      lVar6 = *(longlong *)(param_1 + 6);
      lVar7 = *(longlong *)(param_3 + 0x18);
      pbVar10 = (byte *)(*(longlong *)(param_2 + 6) + local_68);
      if (0 < (longlong)iVar14) {
        lVar19 = -(longlong)pbVar10;
        lVar15 = (*(longlong *)(param_4 + 0x18) + local_68) - (longlong)pbVar10;
        do {
          bVar2 = pbVar10[param_6 + lVar19 + lVar6 + lVar21];
          bVar3 = *pbVar10;
          if ((((bVar2 < 2) && (bVar3 < 2)) && (pbVar10[lVar7 + lVar21 + lVar19 + param_6] != 0)) &&
             (pbVar10[lVar15] != 0)) {
            *param_8 = *param_8 + 1;
            puVar1 = (undefined8 *)
                     ((longlong)param_7 + (ulonglong)((uint)bVar2 + (uint)bVar3 * 2) * 4);
            *(int *)puVar1 = *(int *)puVar1 + 1;
            if ((param_9 != (int *)0x0) && (bVar3 != bVar2)) {
              *(undefined *)
               ((longlong)(*_Memory * (int)piVar20 + iVar18) + *(longlong *)(_Memory + 6)) = 0xff;
            }
          }
          pbVar10 = pbVar10 + 1;
          iVar18 = iVar18 + 1;
        } while ((longlong)(pbVar10 + lVar19) < (longlong)iVar14);
      }
      lVar21 = lVar21 + iVar13;
      uVar16 = (int)piVar20 + 1;
      piVar20 = (int *)(ulonglong)uVar16;
      local_68 = local_68 + iVar5;
    } while ((int)uVar16 < iVar11);
  }
  if (param_9 != (int *)0x0) {
    FUN_18002afc0(*(undefined **)(_Memory + 6),*(undefined **)(_Memory + 6));
    FUN_18002b240(*(undefined **)(_Memory + 6),*(undefined **)(_Memory + 6));
    iVar13 = _Memory[3];
    pcVar8 = *(char **)(_Memory + 6);
    iVar5 = 0;
    while (0 < iVar13) {
      cVar4 = *pcVar8;
      pcVar8 = pcVar8 + 1;
      iVar14 = iVar5 + 1;
      if (cVar4 == '\0') {
        iVar14 = iVar5;
      }
      iVar13 = iVar13 + -1;
      iVar5 = iVar14;
    }
    *param_9 = iVar5;
    free(_Memory);
  }
  return;
}



ulonglong FUN_18002b810(int param_1,int param_2,int param_3,int param_4,int *param_5)

{
  int iVar1;
  uint uVar2;

  if (param_1 == 0) {
    return 0x80;
  }
  iVar1 = (param_1 >> 1) + param_3 * 0x100;
  if (param_2 >> 1 < param_1) {
    uVar2 = *param_5 + 0x26 + iVar1 / param_1;
  }
  else {
    uVar2 = iVar1 / (param_1 + 1) + (param_1 * 0x13) / (param_2 >> 1) + param_5[1] + 0x13;
  }
  if (param_1 < 1) {
    iVar1 = 0;
  }
  else {
    iVar1 = ((param_1 >> 1) + param_4 * 0x100) / param_1 + param_5[2];
    if (0x17 < iVar1) goto LAB_18002b8a3;
  }
  if (((int)uVar2 < 0xe7) || (iVar1 < 0x11)) {
    return 0x80;
  }
LAB_18002b8a3:
  return (ulonglong)uVar2;
}



ulonglong FUN_18002b8c0(int param_1,int param_2,int param_3,int param_4,longlong param_5)

{
  int *piVar1;
  int iVar2;
  uint uVar3;

  piVar1 = *(int **)(param_5 + 0x30);
  if (param_1 != 0) {
    iVar2 = (param_1 >> 1) + param_3 * 0x100;
    if (param_2 >> 1 < param_1) {
      uVar3 = *piVar1 + 0x26 + iVar2 / param_1;
    }
    else {
      uVar3 = iVar2 / (param_1 + 1) + (param_1 * 0x13) / (param_2 >> 1) + piVar1[1] + 0x13;
    }
    if (param_1 < 1) {
      iVar2 = 0;
    }
    else {
      iVar2 = ((param_1 >> 1) + param_4 * 0x100) / param_1 + piVar1[2];
    }
    *(uint *)(param_5 + 0x44) = uVar3;
    if ((((0x17 < iVar2) || ((0x12 < iVar2 && (0x3e < *(int *)(param_5 + 0x40))))) ||
        ((0x13 < iVar2 && (0x32 < *(int *)(param_5 + 0x40))))) ||
       (((0x11 < iVar2 &&
         (((0x28 < *(int *)(param_5 + 0x40) && (7 < *(int *)(param_5 + 0x3c))) ||
          (8 < *(int *)(param_5 + 0x3c))))) || ((0xe6 < (int)uVar3 && (0x10 < iVar2)))))) {
      return (ulonglong)uVar3;
    }
  }
  return 0x80;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18002b9b0(int **param_1,int param_2,int *param_3,int *param_4,int *param_5,int *param_6)

{
  int *piVar1;
  uint *_Memory;
  int iVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  int *_Memory_00;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  uint *_Memory_01;
  int local_c8;
  int local_c4;
  uint *local_c0;
  uint *local_b8;
  int local_b0;
  int local_ac;
  undefined4 local_a8;
  int local_a4;
  undefined4 local_a0;
  undefined4 local_9c;
  int local_98;
  int local_94;
  undefined8 local_90;
  int *local_88;
  int *local_80;
  int *local_78;
  int *local_70;
  int *local_68;
  int *local_60;
  undefined8 local_58;
  undefined8 local_50;
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffee8;
  piVar5 = *param_1;
  local_68 = param_5;
  _Memory_01 = (uint *)param_1[4];
  iVar3 = piVar5[1];
  piVar1 = param_1[1];
  iVar4 = *piVar5;
  local_80 = param_6;
  local_88 = param_1[2];
  local_78 = param_1[3];
  local_58 = 0;
  local_50 = 0;
  local_c0 = (uint *)0x0;
  iVar9 = 0;
  local_c8 = 0;
  local_c4 = param_2;
  local_b8 = _Memory_01;
  local_70 = param_4;
  local_60 = param_3;
  piVar5 = FUN_180029f40(piVar5);
  _Memory_00 = FUN_180029f40(piVar1);
  local_b0 = *piVar1;
  local_ac = piVar1[1];
  local_a4 = *piVar5;
  local_9c = *(undefined4 *)(param_1 + 7);
  local_a8 = 0;
  local_a0 = 0;
  local_90 = 0;
  if (_Memory_01 == (uint *)0x0) {
    FUN_18002abc0(piVar5,(longlong)local_88,param_1[5],&local_c0,&local_b8,&local_b0);
    _Memory_01 = local_b8;
  }
  else {
    FUN_18002abc0(piVar5,0,param_1[5],&local_c0,(uint **)0x0,&local_b0);
  }
  _Memory = local_c0;
  param_1[4] = (int *)_Memory_01;
  if ((local_c0 == (uint *)0x0) || (_Memory_01 == (uint *)0x0)) {
    free(piVar5);
    if (_Memory_00 != (int *)0x0) {
      free(_Memory_00);
    }
    if (_Memory != (uint *)0x0) {
      free(_Memory);
    }
    if (_Memory_01 != (uint *)0x0) {
      free(_Memory_01);
    }
    param_1[4] = (int *)0x0;
    goto LAB_18002bd2e;
  }
  FUN_18002b4f0(_Memory_00,(int *)local_c0,(longlong)local_78,(longlong)_Memory_01,local_94,local_98
                ,&local_58,&local_c8,local_80);
  free(piVar5);
  if (_Memory_00 != (int *)0x0) {
    free(_Memory_00);
  }
  free(_Memory);
  iVar8 = local_58._4_4_ + (int)local_50 + local_50._4_4_;
  iVar7 = (int)local_58;
  iVar10 = iVar8 + iVar7;
  iVar2 = iVar3 * iVar4 >> 1;
  if (local_70 != (int *)0x0) {
    *local_70 = (iVar2 + local_c8 * 0x100) / (iVar3 * iVar4);
  }
  iVar3 = iVar10 >> 1;
  if (local_68 != (int *)0x0) {
    iVar6 = local_58._4_4_ + (int)local_50 + iVar7;
    iVar4 = iVar9;
    if (0 < iVar6) {
      iVar4 = (iVar7 * 0x100 + (iVar6 >> 1)) / (iVar6 + 1);
    }
    *local_68 = iVar4;
    iVar6 = (iVar3 + local_50._4_4_ * 0x100) / (iVar10 + 1);
    if (iVar6 < 0xf) {
      *local_68 = (iVar4 - (0xf - iVar6 >> 1)) + -3;
    }
  }
  if (local_c4 == 0) {
    piVar5 = param_1[6];
    if (iVar10 == 0) goto LAB_18002bce3;
    iVar7 = iVar3 + iVar7 * 0x100;
    if (iVar2 < iVar10) {
      iVar7 = iVar7 / iVar10;
      iVar4 = *piVar5 + 0x26;
    }
    else {
      iVar7 = iVar7 / (iVar10 + 1) + (iVar10 * 0x13) / iVar2;
      iVar4 = piVar5[1] + 0x13;
    }
    iVar7 = iVar7 + iVar4;
    if ((iVar10 < 1) ||
       (iVar9 = (iVar3 + local_50._4_4_ * 0x100) / iVar10 + piVar5[2], iVar9 < 0x18)) {
LAB_18002bcd6:
      if ((iVar7 < 0xe7) || (iVar9 < 0x11)) goto LAB_18002bce3;
    }
  }
  else {
    if (*(int *)(param_1 + 8) < 0) {
      *(int *)(param_1 + 8) = (local_50._4_4_ << 8) / (iVar8 + 1);
    }
    iVar4 = *(int *)(param_1 + 8);
    piVar5 = param_1[6];
    if (iVar10 != 0) {
      iVar9 = iVar3 + iVar7 * 0x100;
      if (iVar2 < iVar10) {
        iVar7 = *piVar5 + 0x26 + iVar9 / iVar10;
      }
      else {
        iVar7 = piVar5[1] + 0x13 + iVar9 / (iVar10 + 1) + (iVar10 * 0x13) / iVar2;
      }
      iVar9 = 0;
      if (0 < iVar10) {
        iVar9 = (iVar3 + local_50._4_4_ * 0x100) / iVar10 + piVar5[2];
      }
      *(int *)((longlong)param_1 + 0x44) = iVar7;
      if ((((iVar9 < 0x18) && ((iVar9 < 0x13 || (iVar4 < 0x3f)))) &&
          ((iVar9 < 0x14 || (iVar4 < 0x33)))) &&
         ((iVar9 < 0x12 ||
          (((iVar4 < 0x29 || (*(int *)((longlong)param_1 + 0x3c) < 8)) &&
           (*(int *)((longlong)param_1 + 0x3c) < 9)))))) goto LAB_18002bcd6;
      goto LAB_18002bce8;
    }
LAB_18002bce3:
    iVar7 = 0x80;
  }
LAB_18002bce8:
  *local_60 = iVar7;
LAB_18002bd2e:
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xfffffffffffffee8);
  return;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Could not reconcile some variable overlaps

void FUN_18002bd60(uint *param_1,uint *param_2,ulonglong *param_3,int *param_4,int *param_5,
                  int *param_6,int *param_7,int *param_8,undefined4 param_9,int *param_10)

{
  int iVar1;
  int iVar2;
  int iVar3;
  uint *_Memory;
  uint *_Memory_00;
  bool bVar4;
  bool bVar5;
  int local_f8;
  int local_f4;
  int local_f0;
  int local_ec;
  int local_e8 [2];
  uint *local_e0;
  int *local_d8;
  int *local_d0;
  uint *local_c8;
  int *local_b8;
  longlong local_b0;
  uint *local_a8;
  uint *local_a0;
  void *local_98;
  undefined4 *local_90;
  undefined8 *local_88;
  int local_80;
  undefined4 local_7c;
  undefined4 local_78;
  undefined8 local_68;
  undefined4 local_60;
  undefined8 local_58;
  int iStack80;
  undefined4 uStack76;
  undefined8 local_48;
  ulonglong local_40;

  local_40 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffed8;
  iVar3 = *param_4;
  iVar1 = param_4[2];
  local_d0 = param_5;
  local_d8 = param_8;
  local_f0 = param_4[1];
  local_48._4_4_ = 0;
  local_48 = 0x100;
  local_68 = 0;
  local_60 = 0;
  local_f8 = 0;
  local_e8[0] = 0;
  local_f4 = 0;
  local_ec = 0;
  local_58._0_4_ = 0x100;
  local_58._4_4_ = 0;
  iStack80 = 0;
  uStack76 = 0;
  if ((param_3 != (ulonglong *)0x0) && ((param_3 + 3 <= &local_58 || (&local_40 <= param_3)))) {
    local_58._0_4_ = *(undefined4 *)param_3;
    local_58._4_4_ = *(undefined4 *)((longlong)param_3 + 4);
    iStack80 = *(int *)(param_3 + 1);
    uStack76 = *(undefined4 *)((longlong)param_3 + 0xc);
    local_48 = param_3[2];
    local_48._4_4_ = (int)(local_48 >> 0x20);
  }
  if (iVar3 != 0) {
    local_68 = 0x200000003;
    local_60 = 3;
    iStack80 = (iStack80 + 1) / 2;
    local_48 = local_48 & 0xffffffff | (ulonglong)(uint)((local_48._4_4_ + 1) / 2) << 0x20;
  }
  local_e0 = param_2;
  local_c8 = param_1;
  _Memory = FUN_18002a710(param_1 + 10,iVar3,param_1[1],*param_1);
  _Memory_00 = FUN_18002a710(local_e0 + 10,iVar3,local_e0[1],*local_e0);
  local_b8 = *(int **)(param_1 + 2);
  local_90 = (undefined4 *)&local_58;
  local_88 = &local_68;
  local_b0 = *(longlong *)(local_e0 + 2);
  local_80 = local_f0;
  local_7c = param_9;
  local_98 = (void *)0x0;
  local_78 = 0xffffffff;
  local_a8 = _Memory;
  local_a0 = _Memory_00;
  iVar2 = FUN_18002b9b0(&local_b8,iVar1,&local_f8,local_d8,param_7,&local_f4);
  iVar3 = local_f8;
  if (param_10 != (int *)0x0) {
    *param_10 = local_f4;
  }
  if (iVar2 == 0) {
    if (local_98 != (void *)0x0) {
      free(local_98);
    }
    if (_Memory != (uint *)0x0) {
      free(_Memory);
    }
    if (_Memory_00 != (uint *)0x0) {
      free(_Memory_00);
    }
    goto LAB_18002c07a;
  }
  if (local_d0 != (int *)0x0) {
    *local_d0 = local_f8;
  }
  if ((*(int **)(local_c8 + 4) == (int *)0x0) || (*(longlong *)(local_e0 + 4) == 0)) {
    if (param_6 != (int *)0x0) {
      *param_6 = 0;
    }
    if (local_98 != (void *)0x0) {
      free(local_98);
    }
    if (_Memory != (uint *)0x0) {
      free(_Memory);
    }
    if (_Memory_00 != (uint *)0x0) {
      free(_Memory_00);
    }
    goto LAB_18002c07a;
  }
  local_f8 = 0;
  local_b8 = *(int **)(local_c8 + 4);
  local_b0 = *(longlong *)(local_e0 + 4);
  local_f0 = FUN_18002b9b0(&local_b8,iVar1,local_e8,(int *)0x0,&local_f8,&local_ec);
  if (local_98 != (void *)0x0) {
    free(local_98);
  }
  if (_Memory != (uint *)0x0) {
    free(_Memory);
  }
  if (_Memory_00 != (uint *)0x0) {
    free(_Memory_00);
  }
  if (local_f0 == 0) goto LAB_18002c07a;
  if (param_10 == (int *)0x0) {
    if (((param_7 != (int *)0x0) && (iVar1 != 0)) && (*param_7 < local_f8)) {
      bVar5 = SBORROW4(iVar3,0xdc);
      iVar1 = iVar3 + -0xdc;
      bVar4 = iVar3 == 0xdc;
      goto LAB_18002c022;
    }
  }
  else {
    iVar3 = local_ec;
    if (local_ec < local_f4) {
      iVar3 = local_f4;
    }
    *param_10 = iVar3;
    if ((param_7 != (int *)0x0) && (iVar1 != 0)) {
      bVar5 = SBORROW4(local_f8,*param_7);
      iVar1 = local_f8 - *param_7;
      bVar4 = local_f8 == *param_7;
LAB_18002c022:
      if (!bVar4 && bVar5 == iVar1 < 0) {
        *param_7 = local_f8;
      }
    }
  }
  if (param_6 != (int *)0x0) {
    *param_6 = local_e8[0];
  }
LAB_18002c07a:
  FUN_18005f100(local_40 ^ (ulonglong)&stack0xfffffffffffffed8);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18002c0b0(int **param_1,longlong param_2)

{
  undefined8 *puVar1;
  uint uVar2;
  int *piVar3;
  int *piVar4;
  int *piVar5;
  uint *_Memory;
  uint *_Memory_00;
  int iVar6;
  int *piVar7;
  int *_Memory_01;
  byte *pbVar8;
  uint uVar9;
  uint uVar10;
  ulonglong uVar11;
  int iVar12;
  longlong lVar13;
  longlong lVar14;
  longlong lVar15;
  int iVar16;
  int iVar17;
  int iVar18;
  longlong lVar19;
  byte *pbVar20;
  int iVar21;
  uint *local_a8;
  uint *local_a0;
  int *local_98;
  int *local_90;
  longlong local_88;
  int local_80;
  int local_7c;
  undefined4 local_78;
  int local_74;
  undefined4 local_70;
  undefined4 local_6c;
  int local_68;
  int local_64;
  undefined8 local_60;
  undefined8 local_58;
  undefined8 local_50;
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xffffffffffffff28;
  piVar3 = param_1[1];
  piVar4 = param_1[2];
  piVar5 = param_1[3];
  local_a0 = (uint *)0x0;
  local_a8 = (uint *)0x0;
  local_88 = param_2;
  piVar7 = FUN_180029f40(*param_1);
  local_90 = piVar7;
  _Memory_01 = FUN_180029f40(piVar3);
  local_80 = *piVar3;
  local_7c = piVar3[1];
  local_74 = *piVar7;
  local_6c = *(undefined4 *)(param_1 + 7);
  iVar17 = 0;
  local_78 = 0;
  local_70 = 0;
  local_60 = 0;
  local_98 = _Memory_01;
  FUN_18002abc0(piVar7,(longlong)piVar4,param_1[5],&local_a0,&local_a8,&local_80);
  _Memory_00 = local_a0;
  _Memory = local_a8;
  if ((local_a0 == (uint *)0x0) || (local_a8 == (uint *)0x0)) {
    free(local_90);
    if (_Memory_01 != (int *)0x0) {
      free(_Memory_01);
    }
    if (_Memory_00 != (uint *)0x0) {
      free(_Memory_00);
    }
    if (_Memory != (uint *)0x0) {
      free(_Memory);
    }
  }
  else {
    uVar2 = *local_a0;
    iVar21 = *_Memory_01;
    local_58 = 0;
    uVar9 = iVar21 - local_68;
    if ((int)uVar2 < iVar21 - local_68) {
      uVar9 = uVar2;
    }
    local_50 = 0;
    uVar10 = _Memory_01[1] - local_64;
    if ((int)local_a0[1] < (int)uVar10) {
      uVar10 = local_a0[1];
    }
    uVar11 = (ulonglong)uVar10;
    iVar12 = iVar17;
    if (0 < (int)uVar10) {
      pbVar20 = *(byte **)(local_a0 + 6);
      lVar15 = -(longlong)pbVar20;
      lVar13 = *(longlong *)(local_98 + 6) + (longlong)(iVar21 * local_64);
      lVar19 = *(longlong *)(piVar5 + 6) + (longlong)(iVar21 * local_64) + (longlong)local_68;
      lVar14 = *(longlong *)(local_a8 + 6) - (longlong)pbVar20;
      do {
        if (0 < (longlong)(int)uVar9) {
          pbVar8 = pbVar20;
          do {
            if ((((pbVar8[local_68 + lVar13 + lVar15] < 2) && (*pbVar8 < 2)) &&
                (pbVar8[lVar15 + lVar19] != 0)) && (pbVar8[lVar14] != 0)) {
              puVar1 = (undefined8 *)
                       ((longlong)&local_58 +
                       (ulonglong)((uint)pbVar8[local_68 + lVar13 + lVar15] + (uint)*pbVar8 * 2) * 4
                       );
              *(int *)puVar1 = *(int *)puVar1 + 1;
            }
            pbVar8 = pbVar8 + 1;
          } while ((longlong)(pbVar8 + lVar15) < (longlong)(int)uVar9);
        }
        lVar13 = lVar13 + iVar21;
        lVar19 = lVar19 + iVar21;
        pbVar20 = pbVar20 + (int)uVar2;
        lVar15 = lVar15 - (int)uVar2;
        uVar11 = uVar11 - 1;
      } while (uVar11 != 0);
      iVar17 = (int)local_50;
      iVar12 = (int)local_58;
      _Memory_01 = local_98;
      param_2 = local_88;
    }
    free(local_90);
    free(_Memory_01);
    free(_Memory_00);
    free(local_a8);
    iVar18 = local_50._4_4_ + iVar17 + local_58._4_4_;
    iVar16 = iVar18 + iVar12;
    iVar21 = 0;
    iVar6 = iVar21;
    if (0 < iVar16) {
      iVar6 = ((local_50._4_4_ + iVar12) * 0x100 + (iVar16 >> 1)) / iVar16;
    }
    *(int *)(param_2 + 0x18) = iVar6;
    iVar17 = iVar17 + local_58._4_4_ + iVar12;
    if (iVar17 < 1) {
      iVar17 = 0;
    }
    else {
      iVar17 = ((iVar17 >> 1) + iVar12 * 0x100) / iVar17;
    }
    *(int *)(param_2 + 0x1c) = iVar17;
    if (0 < iVar18) {
      iVar21 = ((iVar18 >> 1) + local_50._4_4_ * 0x100) / iVar18;
    }
    *(int *)(param_2 + 0x20) = iVar21;
  }
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xffffffffffffff28);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18002c3b0(uint *param_1,uint *param_2,ulonglong *param_3,int *param_4,longlong param_5)

{
  int iVar1;
  uint *_Memory;
  uint *_Memory_00;
  undefined auStack184 [32];
  int *local_98;
  undefined8 local_90;
  uint *local_88;
  uint *local_80;
  undefined4 *local_70;
  int local_60;
  undefined8 local_48;
  int iStack64;
  undefined4 uStack60;
  undefined8 local_38;
  ulonglong local_30;

  local_30 = DAT_1800b04e8 ^ (ulonglong)auStack184;
  iVar1 = *param_4;
  local_60 = param_4[1];
  local_48._0_4_ = 0x100;
  local_48._4_4_ = 0;
  iStack64 = 0;
  uStack60 = 0;
  local_38 = 0x100;
  local_38._4_4_ = 0;
  if ((param_3 != (ulonglong *)0x0) &&
     ((param_3 + 3 <= &local_48 || (local_38._4_4_ = 0, &local_30 <= param_3)))) {
    local_48._0_4_ = *(undefined4 *)param_3;
    local_48._4_4_ = *(undefined4 *)((longlong)param_3 + 4);
    iStack64 = *(int *)(param_3 + 1);
    uStack60 = *(undefined4 *)((longlong)param_3 + 0xc);
    local_38 = param_3[2];
    local_38._4_4_ = (int)(local_38 >> 0x20);
  }
  if (iVar1 != 0) {
    iStack64 = (iStack64 + 1) / 2;
    local_38 = local_38 & 0xffffffff | (ulonglong)(uint)((local_38._4_4_ + 1) / 2) << 0x20;
  }
  _Memory = FUN_18002a710(param_1 + 10,iVar1,param_1[1],*param_1);
  _Memory_00 = FUN_18002a710(param_2 + 10,iVar1,param_2[1],*param_2);
  local_98 = *(int **)(param_1 + 6);
  local_90 = *(undefined8 *)(param_2 + 6);
  local_70 = (undefined4 *)&local_48;
  local_88 = _Memory;
  local_80 = _Memory_00;
  FUN_18002c0b0(&local_98,param_5);
  if (_Memory != (uint *)0x0) {
    free(_Memory);
  }
  if (_Memory_00 != (uint *)0x0) {
    free(_Memory_00);
  }
  FUN_18005f100(local_30 ^ (ulonglong)auStack184);
  return;
}



void FUN_18002c510(int *param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  short sVar6;
  uint uVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  byte bVar10;
  int iVar11;
  uint uVar12;
  ulonglong uVar13;
  uint uVar14;
  uint uVar15;
  ulonglong uVar16;
  uint uVar17;
  byte bVar18;
  uint uVar19;
  uint local_res8 [2];
  uint local_res10 [2];

  iVar1 = *param_1;
  uVar9 = 0;
  iVar2 = param_1[3];
  iVar3 = param_1[1];
  iVar4 = param_1[4];
  bVar18 = 0xf;
  uVar15 = 0x8000;
  bVar10 = 0xf;
  uVar14 = 0;
  uVar12 = 0x8000;
  uVar19 = iVar2 * iVar2 + iVar1 * iVar1;
  uVar8 = uVar9;
  local_res10[0] = uVar19;
  uVar17 = uVar19;
  if (1 < uVar19) {
    do {
      uVar7 = uVar12 + (int)uVar8 * 2 << (bVar10 & 0x1f);
      bVar10 = bVar10 - 1;
      if (uVar7 <= uVar17) {
        uVar8 = (ulonglong)((int)uVar8 + uVar12);
        uVar17 = uVar17 - uVar7;
      }
      uVar12 = uVar12 >> 1;
    } while (uVar12 != 0);
    local_res10[0] = (uint)uVar8;
  }
  uVar12 = iVar4 * iVar4 + iVar3 * iVar3;
  uVar8 = uVar9;
  uVar17 = uVar12;
  if (1 < uVar12) {
    do {
      uVar7 = uVar15 + (int)uVar8 * 2 << (bVar18 & 0x1f);
      bVar18 = bVar18 - 1;
      if (uVar7 <= uVar17) {
        uVar8 = (ulonglong)((int)uVar8 + uVar15);
        uVar17 = uVar17 - uVar7;
      }
      uVar15 = uVar15 >> 1;
    } while (uVar15 != 0);
    uVar17 = (uint)uVar8;
  }
  *param_2 = (int)(uVar17 + local_res10[0]) >> 1;
  if (local_res10[0] == 0) {
    *(undefined8 *)(param_2 + 1) = 0;
  }
  else {
    local_res8[0] = (iVar1 << 8) / (int)local_res10[0];
    local_res10[0] = (iVar2 << 8) / (int)local_res10[0];
    uVar8 = FUN_1800350d0(local_res10,local_res8);
    sVar6 = (short)uVar8;
    if (sVar6 < 0) {
      sVar6 = sVar6 + 0x6488;
    }
    iVar11 = (int)((ulonglong)((longlong)sVar6 * 0x395) >> 0x10);
    iVar5 = iVar11 + -0xb4;
    if (iVar11 < 0xb4) {
      iVar5 = iVar11;
    }
    bVar10 = 0x1f;
    iVar11 = 0xb4 - iVar5;
    if (iVar5 <= 0xb4 - iVar5) {
      iVar11 = iVar5;
    }
    uVar13 = 0x80000000;
    param_2[1] = iVar11;
    uVar16 = (longlong)(int)uVar12 * (longlong)(int)uVar19;
    uVar8 = uVar16;
    if (1 < uVar16) {
      do {
        uVar16 = uVar9;
        uVar9 = (uint)((int)uVar16 * 2) + uVar13 << (bVar10 & 0x3f);
        bVar10 = bVar10 - 1;
        if (uVar9 <= uVar8) {
          uVar16 = (ulonglong)(uint)((int)uVar16 + (int)uVar13);
          uVar8 = uVar8 - uVar9;
        }
        uVar13 = uVar13 >> 1;
        uVar9 = uVar16;
      } while (uVar13 != 0);
    }
    if ((int)uVar16 != 0) {
      uVar14 = (uint)(((longlong)(iVar4 * iVar2 + iVar3 * iVar1) << 0x10) /
                     (longlong)(uVar16 & 0xffffffff));
    }
    param_2[2] = (uVar14 ^ (int)uVar14 >> 0x1f) - ((int)uVar14 >> 0x1f);
  }
  return;
}



void FUN_18002c6c0(int *param_1,longlong param_2,longlong param_3)

{
  byte bVar1;
  uint uVar2;
  byte *pbVar3;
  uint uVar4;
  longlong lVar5;
  ulonglong uVar6;
  int iVar7;
  byte *pbVar8;
  undefined *puVar9;
  uint uVar10;
  int iVar11;
  undefined auStack1368 [32];
  int local_538 [256];
  undefined local_138 [256];
  ulonglong local_38;

  local_38 = DAT_1800b04e8 ^ (ulonglong)auStack1368;
  iVar11 = 0;
  iVar7 = 0;
  memset(local_538,0,0x400);
  memset(local_138 + 1,0,0xff);
  uVar10 = param_1[1] * *param_1;
  pbVar8 = *(byte **)(param_1 + 6);
  puVar9 = *(undefined **)(param_2 + 0x18);
  lVar5 = *(longlong *)(param_3 + 0x18);
  if (uVar10 != 0) {
    pbVar3 = pbVar8;
    uVar4 = uVar10;
    do {
      if (pbVar3[lVar5 - (longlong)pbVar8] != 0) {
        local_538[*pbVar3] = local_538[*pbVar3] + 1;
        iVar7 = iVar7 + 1;
      }
      pbVar3 = pbVar3 + 1;
      uVar4 = uVar4 - 1;
    } while (uVar4 != 0);
    if (iVar7 != 0) {
      iVar7 = ((iVar7 >> 1) + 0xff00) / iVar7;
      goto LAB_18002c776;
    }
  }
  iVar7 = 0xff00;
LAB_18002c776:
  lVar5 = 0;
  do {
    iVar11 = iVar11 + local_538[lVar5];
    uVar2 = iVar11 * iVar7 >> 8;
    uVar4 = uVar2;
    if (((uVar2 & 0xffffff00) != 0) && (uVar4 = 0, 0 < (int)uVar2)) {
      uVar4 = 0xff;
    }
    local_138[lVar5] = (char)uVar4;
    lVar5 = lVar5 + 1;
  } while (lVar5 < 0x100);
  local_138[0] = 0;
  if (0 < (int)uVar10) {
    uVar6 = (ulonglong)uVar10;
    do {
      bVar1 = *pbVar8;
      pbVar8 = pbVar8 + 1;
      *puVar9 = local_138[bVar1];
      uVar6 = uVar6 - 1;
      puVar9 = puVar9 + 1;
    } while (uVar6 != 0);
  }
  FUN_18005f100(local_38 ^ (ulonglong)auStack1368);
  return;
}



void FUN_18002c810(int *param_1,longlong param_2,int param_3,int param_4)

{
  int iVar1;
  int iVar2;
  undefined2 *puVar3;
  int iVar4;
  int iVar5;
  ulonglong uVar6;
  longlong lVar7;
  uint uVar8;
  int iVar9;
  ushort *puVar10;
  uint uVar11;
  undefined2 *puVar12;
  int iVar13;
  int iVar14;
  int iVar15;

  iVar2 = *param_1;
  puVar3 = *(undefined2 **)(param_1 + 6);
  uVar11 = iVar2 * param_1[1];
  iVar1 = param_1[1] + -1;
  if (0 < (int)uVar11) {
    uVar6 = (ulonglong)uVar11;
    puVar12 = puVar3;
    while (uVar6 != 0) {
      uVar6 = uVar6 - 1;
      *puVar12 = 0xffff;
      puVar12 = puVar12 + 1;
    }
  }
  iVar15 = 0;
  if (0 < param_3) {
    puVar10 = (ushort *)(param_2 + 4);
    do {
      uVar8 = puVar10[-1] + 0x80 >> 8;
      uVar11 = *puVar10 + 0x80 >> 8;
      iVar4 = uVar8 - param_4;
      iVar14 = uVar8 + param_4;
      iVar9 = uVar11 - param_4;
      iVar5 = uVar11 + param_4;
      iVar13 = 0;
      if (0 < iVar4) {
        iVar13 = iVar4;
      }
      if (iVar2 + -1 < iVar14) {
        iVar14 = iVar2 + -1;
      }
      iVar4 = 0;
      if (0 < iVar9) {
        iVar4 = iVar9;
      }
      if (iVar1 < iVar5) {
        iVar5 = iVar1;
      }
      if (iVar4 <= iVar5) {
        iVar9 = iVar4 * iVar2 + iVar13;
        uVar6 = (ulonglong)((iVar5 - iVar4) + 1);
        do {
          if (iVar13 <= iVar14) {
            lVar7 = (longlong)((iVar14 - iVar13) + 1);
            puVar12 = puVar3 + iVar9;
            while (lVar7 != 0) {
              lVar7 = lVar7 + -1;
              *puVar12 = (short)iVar15;
              puVar12 = puVar12 + 1;
            }
          }
          iVar9 = iVar9 + iVar2;
          uVar6 = uVar6 - 1;
        } while (uVar6 != 0);
      }
      iVar15 = iVar15 + 1;
      puVar10 = puVar10 + 0x1c;
    } while (iVar15 < param_3);
  }
  return;
}



void FUN_18002c920(longlong param_1,int *param_2,int param_3,int *param_4,longlong param_5,
                  undefined4 *param_6,undefined4 *param_7)

{
  short sVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  ulonglong uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  ulonglong uVar9;
  int iVar10;
  ushort *puVar11;
  ulonglong uVar12;
  undefined auStack136 [32];
  int local_68;
  longlong local_60;
  undefined4 *local_58;
  undefined4 *local_50;
  int local_48;
  int local_44;
  int local_40;
  int iStack60;
  int local_38;
  int local_34;
  ulonglong local_30;
  ulonglong uVar5;

  local_30 = DAT_1800b04e8 ^ (ulonglong)auStack136;
  local_68 = param_4[1];
  uVar5 = 0;
  iVar2 = *param_4;
  uVar7 = 0;
  local_60 = *(longlong *)(param_4 + 6);
  local_58 = param_6;
  local_50 = param_7;
  if (param_2 != (int *)0x0) {
    FUN_180023cd0(param_2,&local_48);
  }
  uVar8 = uVar7;
  if (0 < param_3) {
    puVar11 = (ushort *)(param_1 + 4);
    uVar6 = uVar5;
    uVar9 = uVar5;
    uVar12 = uVar5;
    do {
      iVar10 = local_40 + 0x80 +
               (int)((ulonglong)puVar11[-1] * (longlong)local_48 + 0x80 +
                     (ulonglong)*puVar11 * (longlong)local_44 >> 8) >> 8;
      if ((((-1 < iVar10) && (iVar10 < iVar2)) &&
          (iVar3 = local_34 + 0x80 +
                   (int)((longlong)iStack60 * (ulonglong)puVar11[-1] + 0x80 +
                         (longlong)local_38 * (ulonglong)*puVar11 >> 8) >> 8, -1 < iVar3)) &&
         (iVar3 < local_68)) {
        uVar9 = (ulonglong)((int)uVar9 + 1);
        sVar1 = *(short *)(local_60 + (longlong)(iVar3 * iVar2 + iVar10) * 2);
        if (-1 < sVar1) {
          iVar10 = (int)uVar6;
          uVar6 = (ulonglong)(iVar10 + 1);
          *(int *)(param_5 + (longlong)(iVar10 * 2) * 4) = (int)uVar5;
          *(int *)(uVar12 + 4 + param_5) = (int)sVar1;
          uVar12 = uVar12 + 8;
        }
      }
      uVar8 = (undefined4)uVar9;
      uVar7 = (undefined4)uVar6;
      uVar4 = (int)uVar5 + 1;
      uVar5 = (ulonglong)uVar4;
      puVar11 = puVar11 + 0x1c;
      param_6 = local_58;
      param_7 = local_50;
    } while ((int)uVar4 < param_3);
  }
  *param_6 = uVar8;
  *param_7 = uVar7;
  FUN_18005f100(local_30 ^ (ulonglong)auStack136);
  return;
}



void FUN_18002cac0(longlong param_1,longlong param_2,longlong param_3,int param_4,
                  undefined4 *param_5)

{
  ushort uVar1;
  ushort uVar2;
  int iVar3;
  uint uVar4;
  ulonglong uVar5;
  longlong lVar6;
  longlong lVar7;
  ulonglong uVar8;
  int iVar9;
  int *piVar10;
  longlong lVar11;
  uint uVar12;
  longlong lVar14;
  longlong lVar15;
  uint uVar16;
  ulonglong uVar17;
  undefined4 uVar18;
  ulonglong uVar19;
  longlong lVar20;
  uint uVar21;
  longlong lVar23;
  uint uVar24;
  longlong lVar26;
  uint uVar27;
  longlong lVar29;
  ulonglong local_58;
  ulonglong local_50;
  ulonglong uVar13;
  ulonglong uVar22;
  ulonglong uVar25;
  ulonglong uVar28;

  uVar5 = 0;
  local_58 = 0;
  local_50 = 0;
  uVar4 = 0;
  uVar27 = 0;
  uVar8 = uVar5;
  uVar17 = uVar5;
  uVar19 = uVar5;
  uVar24 = uVar4;
  uVar21 = uVar27;
  if (0 < param_4) {
    piVar10 = (int *)(param_3 + 4);
    uVar13 = uVar5;
    uVar22 = uVar5;
    uVar25 = uVar5;
    uVar28 = uVar5;
    do {
      iVar9 = *piVar10;
      piVar10 = piVar10 + 2;
      iVar3 = (int)uVar13;
      uVar12 = iVar3 + 1;
      uVar13 = (ulonglong)uVar12;
      uVar1 = *(ushort *)((longlong)iVar9 * 0x38 + 4 + param_2);
      uVar2 = *(ushort *)((longlong)iVar9 * 0x38 + 2 + param_2);
      uVar17 = (ulonglong)uVar2;
      uVar24 = (int)uVar25 + (uint)uVar1;
      uVar25 = (ulonglong)uVar24;
      uVar4 = (int)uVar5 + (uint)uVar2;
      uVar5 = (ulonglong)uVar4;
      lVar7 = (longlong)*(int *)(param_3 + (longlong)(iVar3 * 2) * 4) * 0x38;
      uVar2 = *(ushort *)(lVar7 + 2 + param_1);
      uVar27 = (int)uVar28 + (uint)uVar2;
      uVar28 = (ulonglong)uVar27;
      uVar16 = (uint)*(ushort *)(lVar7 + 4 + param_1);
      uVar21 = (int)uVar22 + uVar16;
      uVar22 = (ulonglong)uVar21;
      uVar19 = uVar19 + (ulonglong)(uint)uVar1 * (ulonglong)uVar1 + uVar17 * uVar17;
      uVar8 = uVar2 * uVar17 + (ulonglong)uVar16 * (ulonglong)uVar1 + local_58;
      uVar17 = (ulonglong)(uint)uVar2 * (longlong)(int)-(uint)uVar1 + uVar16 * uVar17 + local_50;
      local_58 = uVar8;
      local_50 = uVar17;
    } while ((int)uVar12 < param_4);
  }
  lVar11 = (longlong)param_4;
  lVar15 = (longlong)(int)(uVar4 + 0x80) >> 8;
  lVar14 = (longlong)(int)(uVar24 + 0x80) >> 8;
  lVar7 = (longlong)(uVar17 + 0x8000) >> 0x10;
  lVar6 = lVar14 * lVar14 + lVar15 * lVar15;
  lVar26 = (longlong)(int)(uVar27 + 0x80) >> 8;
  lVar29 = (longlong)(int)(uVar21 + 0x80) >> 8;
  lVar23 = (longlong)(uVar8 + 0x8000) >> 0x10;
  lVar20 = ((longlong)(uVar19 + 0x8000) >> 0x10) * lVar11 - lVar6;
  if (lVar20 != 0) {
    lVar20 = ((lVar20 >> 1) + 0x800000000) / lVar20;
    lVar6 = (lVar20 * lVar6 + 0x800000000) / lVar11;
    uVar18 = (undefined4)(((lVar11 * lVar23 - lVar29 * lVar14) - lVar26 * lVar15) * lVar20 >> 0x1b);
    *param_5 = uVar18;
    param_5[4] = uVar18;
    iVar9 = (int)(((lVar11 * lVar7 - lVar29 * lVar15) + lVar26 * lVar14) * lVar20 >> 0x1b);
    param_5[3] = iVar9;
    param_5[1] = -iVar9;
    param_5[2] = (int)((-(lVar20 * lVar15) * lVar23 - -(lVar20 * lVar14) * lVar7) + lVar6 * lVar26
                      >> 0x1b);
    param_5[5] = (int)(-(lVar20 * lVar15) * lVar7 + -(lVar20 * lVar14) * lVar23 + lVar6 * lVar29 >>
                      0x1b);
  }
  return;
}



void FUN_18002cee0(uint *param_1,uint **param_2,uint *param_3,longlong param_4,int param_5)

{
  uint uVar1;
  uint uVar2;
  uint *puVar3;
  bool bVar4;
  int iVar5;
  uint *puVar6;
  uint *puVar7;
  longlong lVar8;
  uint *puVar9;
  int iVar10;
  uint local_648;
  uint local_644;
  int local_640;
  uint local_63c;
  int local_638;
  uint *local_630;
  size_t local_628;
  uint *local_620;
  undefined8 local_618;
  uint uStack1552;
  uint uStack1548;
  undefined8 local_608;
  uint local_600 [2];
  int local_5f8 [360];
  ulonglong local_58;

  local_58 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffff968;
  puVar7 = param_2[4];
  puVar9 = (uint *)0x0;
  local_630 = param_2[1];
  local_638 = *(int *)(param_2 + 6);
  puVar3 = *param_2;
  puVar6 = param_2[5];
  local_620 = param_3;
  if (puVar7 == (uint *)0x0) {
    local_648 = param_1[1];
    local_644 = *param_1;
    local_640 = *(int *)((longlong)param_2 + 0x1c);
    uVar1 = local_648 * local_644 * 2;
    local_628 = (longlong)(int)uVar1 + 0x20;
    local_63c = uVar1;
    puVar6 = (uint *)malloc(local_628);
    puVar7 = puVar9;
    if (puVar6 != (uint *)0x0) {
      puVar6[3] = uVar1;
      *puVar6 = local_644;
      puVar6[2] = local_644 * 2;
      *(uint **)(puVar6 + 6) = puVar6 + 8;
      puVar6[1] = local_648;
      puVar6[4] = 2;
      puVar7 = puVar6;
    }
    puVar6 = (uint *)malloc(local_628);
    if (puVar6 != (uint *)0x0) {
      puVar6[3] = local_63c;
      *puVar6 = local_644;
      puVar6[2] = local_644 * 2;
      *(uint **)(puVar6 + 6) = puVar6 + 8;
      puVar6[1] = local_648;
      puVar6[4] = 2;
      puVar9 = puVar6;
    }
    FUN_18002c810((int *)puVar7,*(longlong *)(puVar3 + 0x3e),puVar3[0x42],local_640);
    FUN_18002c810((int *)puVar9,(longlong)(int)puVar3[0x42] * 0x38 + *(longlong *)(puVar3 + 0x3e),
                  puVar3[0x3c] - puVar3[0x42],local_640);
    param_2[4] = puVar7;
    param_2[5] = puVar9;
    puVar6 = puVar9;
  }
  local_63c = 0;
  local_640 = 0;
  local_648 = 0;
  local_644 = 0;
  FUN_18002c920(*(longlong *)(param_1 + 0x3e),(int *)local_630,param_1[0x42],(int *)puVar7,
                (longlong)local_5f8,&local_63c,&local_640);
  puVar7 = local_630;
  iVar10 = local_640;
  lVar8 = (longlong)local_640;
  FUN_18002c920((longlong)(int)param_1[0x42] * 0x38 + *(longlong *)(param_1 + 0x3e),(int *)local_630
                ,param_1[0x3c] - param_1[0x42],(int *)puVar6,(longlong)(local_5f8 + local_640 * 2),
                &local_648,&local_644);
  iVar10 = local_644 + iVar10;
  if (lVar8 < iVar10) {
    uVar1 = param_1[0x42];
    uVar2 = puVar3[0x42];
    do {
      local_5f8[lVar8 * 2] = local_5f8[lVar8 * 2] + uVar1;
      local_5f8[lVar8 * 2 + 1] = local_5f8[lVar8 * 2 + 1] + uVar2;
      lVar8 = lVar8 + 1;
    } while (lVar8 < iVar10);
  }
  if ((puVar7 != (uint *)0x0) && ((puVar7 + 6 <= &local_618 || (local_600 <= puVar7)))) {
    local_618._0_4_ = *puVar7;
    local_618._4_4_ = puVar7[1];
    uStack1552 = puVar7[2];
    uStack1548 = puVar7[3];
    local_608 = *(undefined8 *)(puVar7 + 4);
  }
  if (2 < iVar10) {
    FUN_18002cac0(*(longlong *)(param_1 + 0x3e),*(longlong *)(puVar3 + 0x3e),(longlong)local_5f8,
                  iVar10,(undefined4 *)&local_618);
  }
  local_644 = 0;
  local_648 = 0;
  local_640 = 0;
  bVar4 = param_5 - 9U < 2;
  if (bVar4) {
    iVar5 = FUN_18002bd60(puVar3,param_1,&local_618,(int *)param_2[2],(int *)0x0,(int *)0x0,
                          (int *)&local_644,(int *)&local_648,*(undefined4 *)(param_2 + 3),
                          &local_640);
    iVar10 = local_640;
  }
  else {
    iVar5 = FUN_18002bd60(puVar3,param_1,&local_618,(int *)param_2[2],(int *)0x0,(int *)0x0,
                          (int *)&local_644,(int *)&local_648,*(undefined4 *)(param_2 + 3),
                          (int *)0x0);
    iVar10 = 0;
  }
  if ((iVar5 != 0x80) &&
     ((*(int *)(param_4 + 0x10) == 0x80 || (*(int *)(param_4 + 0x14) < (int)local_644)))) {
    *(int *)(param_4 + 0x10) = iVar5;
    *(uint *)(param_4 + 0x14) = local_644;
    if (bVar4) {
      *(uint *)(param_4 + 0x24) = iVar10 * 0x10000 + local_648;
    }
    else {
      *(int *)(param_4 + 0x24) = (int)(local_648 * local_638) >> 8;
    }
    FUN_180034a50((int *)param_1,(longlong)puVar3,(int *)&local_618,*(int *)(param_4 + 4),
                  (undefined8 *)(param_4 + 0x108),param_4 + 0x54,param_5);
    *(undefined4 *)(param_4 + 0x28) = *(undefined4 *)(param_4 + 0x110);
    *(undefined4 *)(param_4 + 0x2c) = *(undefined4 *)(param_4 + 0x114);
    if ((local_620 != (uint *)0x0) && ((local_600 <= local_620 || (local_620 + 6 <= &local_618)))) {
      *local_620 = (uint)local_618;
      local_620[1] = local_618._4_4_;
      local_620[2] = uStack1552;
      local_620[3] = uStack1548;
      *(undefined8 *)(local_620 + 4) = local_608;
    }
  }
  FUN_18005f100(local_58 ^ (ulonglong)&stack0xfffffffffffff968);
  return;
}



void FUN_18002d2f0(int param_1,int param_2,int param_3,int param_4,int *param_5,int *param_6)

{
  int iVar1;
  ulonglong uVar2;
  int iVar3;
  int iVar4;
  int iVar5;

  iVar5 = param_3 * 0x100 + -0x100;
  if (param_2 < 1) {
    if (param_2 < 0) {
      iVar4 = (iVar5 - param_1) / param_2;
      iVar1 = -(param_1 / param_2);
      iVar3 = iVar4 * param_2 + param_1;
      while ((iVar5 < iVar3 && (iVar4 < param_4))) {
        iVar3 = iVar3 + param_2;
        iVar4 = iVar4 + 1;
      }
      iVar5 = iVar1 * param_2 + param_1;
      if (iVar5 < 0) {
        while (-1 < iVar1) {
          iVar1 = iVar1 + -1;
          iVar5 = iVar5 - param_2;
          if (-1 < iVar5) {
            *param_5 = iVar4;
            *param_6 = iVar1;
            return;
          }
        }
      }
    }
    else {
      if ((-1 < param_1) && (param_1 <= iVar5)) {
        *param_5 = 0;
        *param_6 = param_4 + -1;
        return;
      }
      iVar1 = -0xfffffff;
      iVar4 = 0xfffffff;
    }
  }
  else {
    iVar4 = -(param_1 / param_2);
    uVar2 = (longlong)(iVar5 - param_1) / (longlong)param_2 & 0xffffffff;
    iVar1 = (int)uVar2;
    iVar3 = iVar4 * param_2 + param_1;
    while ((iVar3 < 0 && (iVar4 < param_4))) {
      iVar4 = iVar4 + 1;
      iVar3 = iVar3 + param_2;
    }
    iVar3 = iVar1 * param_2 + param_1;
    if (iVar5 < iVar3) {
      while (iVar1 = (int)uVar2, -1 < iVar1) {
        iVar3 = iVar3 - param_2;
        uVar2 = (ulonglong)(iVar1 - 1U);
        if (iVar3 <= iVar5) {
          *param_5 = iVar4;
          *param_6 = iVar1 - 1U;
          return;
        }
      }
    }
  }
  *param_5 = iVar4;
  *param_6 = iVar1;
  return;
}



ulonglong FUN_18002d430(int param_1,int param_2,int param_3,int param_4,int *param_5,int *param_6)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  int local_res8 [2];
  int local_res10 [2];
  int local_res18;
  int local_res20;
  int local_68;
  int local_64;
  int local_60;
  int local_5c;
  int local_58;
  int local_54;
  int local_50;

  local_res10[0] = 0;
  local_res8[0] = 0;
  local_68 = 0;
  local_64 = 0;
  piVar5 = param_6 + 0x102;
  iVar6 = 0;
  uVar8 = 0;
  iVar3 = 0;
  local_5c = param_5[3];
  local_58 = *param_5;
  local_54 = param_5[1];
  local_50 = param_5[2];
  param_5._0_4_ = param_5[4];
  local_60 = param_5[5];
  iVar4 = param_1;
  if (0 < param_1) {
    local_res18 = param_3;
    local_res20 = param_4;
    do {
      iVar7 = param_2;
      FUN_18002d2f0(iVar3 * local_54 + local_50,local_58,local_res20,param_2,local_res10,&local_68);
      FUN_18002d2f0(iVar3 * (int)param_5 + local_60,local_5c,local_res18,iVar7,local_res8,&local_64)
      ;
      iVar7 = local_res8[0];
      if (local_res8[0] < local_res10[0]) {
        iVar7 = local_res10[0];
      }
      iVar2 = 0;
      if (0 < iVar7) {
        iVar2 = iVar7;
      }
      iVar7 = local_68;
      if (local_64 < local_68) {
        iVar7 = local_64;
      }
      if (param_2 + -1 < iVar7) {
        iVar7 = param_2 + -1;
      }
      if (iVar2 <= iVar7) {
        piVar5[-0x100] = iVar2;
        *piVar5 = iVar7;
        iVar1 = iVar3;
        if (iVar4 < iVar3) {
          iVar1 = iVar4;
        }
        iVar4 = iVar1;
        if (iVar6 < iVar3) {
          iVar6 = iVar3;
        }
        uVar8 = uVar8 + (iVar7 - iVar2) + 1;
      }
      iVar3 = iVar3 + 1;
      piVar5 = piVar5 + 1;
    } while (iVar3 < param_1);
  }
  *param_6 = iVar4;
  param_6[1] = iVar6;
  return (ulonglong)uVar8;
}



void FUN_18002d5e0(int *param_1,int *param_2)

{
  byte *pbVar1;
  int iVar2;
  longlong lVar3;
  longlong lVar4;
  int *piVar5;
  longlong lVar6;
  undefined *puVar7;
  int iVar8;
  uint uVar9;
  int iVar10;
  undefined4 local_res8;
  undefined4 local_resc;
  undefined4 local_res10;
  undefined4 local_res14;

  lVar6 = (longlong)*param_2;
  iVar2 = *param_1;
  local_res8 = 0xf1f3f7f;
  local_resc = 0x10307;
  local_res10 = 0xf8fcfeff;
  lVar4 = (longlong)(*param_2 * iVar2) + *(longlong *)(param_1 + 6);
  local_res14 = 0x80c0e0f0;
  if (lVar6 <= param_2[1]) {
    piVar5 = param_2 + lVar6 + 0x102;
    lVar6 = (param_2[1] - lVar6) + 1;
    do {
      iVar10 = piVar5[-0x100] >> 3;
      iVar8 = (int)(*piVar5 + 1U) >> 3;
      uVar9 = *piVar5 + 1U & 7;
      lVar3 = (longlong)(int)(7 - (piVar5[-0x100] & 7U));
      if (iVar10 == iVar8) {
        pbVar1 = (byte *)(iVar10 + lVar4);
        *pbVar1 = *pbVar1 & (*(byte *)((longlong)&local_res10 + (ulonglong)uVar9) |
                            *(byte *)((longlong)&local_res8 + lVar3));
      }
      else {
        pbVar1 = (byte *)(iVar10 + lVar4);
        *pbVar1 = *pbVar1 & *(byte *)((longlong)&local_res8 + lVar3);
        if (uVar9 != 0) {
          *(byte *)(iVar8 + lVar4) =
               *(byte *)(iVar8 + lVar4) & *(byte *)((longlong)&local_res10 + (ulonglong)uVar9);
        }
        iVar10 = iVar10 + 1;
        if (iVar10 < iVar8) {
          lVar3 = (longlong)(iVar8 - iVar10);
          puVar7 = (undefined *)(iVar10 + lVar4);
          while (lVar3 != 0) {
            lVar3 = lVar3 + -1;
            *puVar7 = 0;
            puVar7 = puVar7 + 1;
          }
        }
      }
      piVar5 = piVar5 + 1;
      lVar4 = lVar4 + iVar2;
      lVar6 = lVar6 + -1;
    } while (lVar6 != 0);
  }
  return;
}



void FUN_18002d6f0(byte *param_1,longlong param_2,int param_3,int param_4,int param_5,int param_6)

{
  longlong lVar1;
  byte *pbVar2;
  longlong lVar3;

  if (param_5 == 0) {
    return;
  }
  lVar3 = (longlong)(param_4 + -8);
  if (0 < param_4 + -8) {
    lVar1 = (lVar3 - 1U >> 1) + 1;
    pbVar2 = param_1;
    do {
      *pbVar2 = *pbVar2 & 0xfe;
      pbVar2 = pbVar2 + 2;
      lVar1 = lVar1 + -1;
    } while (lVar1 != 0);
  }
  if (1 < lVar3) {
    pbVar2 = param_1 + 1;
    do {
      *pbVar2 = *pbVar2 | 1;
      pbVar2 = pbVar2 + 2;
    } while ((longlong)(pbVar2 + -(longlong)param_1) < lVar3);
  }
  if (param_5 == 1) {
    param_1[lVar3] = param_1[lVar3] | 1;
  }
  else {
    if (param_5 == 2) {
      param_1[lVar3] = param_1[lVar3] | 1;
      param_1[param_4 + -7] = param_1[param_4 + -7] | 1;
      goto LAB_18002d790;
    }
    param_1[lVar3] = param_1[lVar3] & 0xfe;
  }
  param_1[param_4 + -7] = param_1[param_4 + -7] & 0xfe;
LAB_18002d790:
  if (param_6 == 0) {
    param_1[param_4 + -6] = param_1[param_4 + -6] & 0xfe;
  }
  else {
    param_1[param_4 + -6] = param_1[param_4 + -6] | 1;
    lVar3 = (longlong)param_4;
    if (lVar3 < param_3 * param_4) {
      pbVar2 = param_1 + lVar3;
      lVar3 = param_3 * param_4 - lVar3;
      do {
        if (pbVar2[param_2 - (longlong)param_1] == 0) {
          *pbVar2 = *pbVar2 | 1;
        }
        else {
          *pbVar2 = *pbVar2 & 0xfe;
        }
        pbVar2 = pbVar2 + 1;
        lVar3 = lVar3 + -1;
      } while (lVar3 != 0);
      return;
    }
  }
  return;
}



ulonglong FUN_18002d800(longlong param_1,undefined8 *param_2,int param_3,uint param_4,
                       undefined4 *param_5)

{
  uint *puVar1;
  uint *puVar2;
  byte bVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  bool bVar12;
  longlong lVar13;
  undefined *puVar14;
  char cVar15;
  ulonglong uVar16;
  uint *puVar17;
  uint *puVar18;
  int iVar19;
  ulonglong uVar20;
  uint uVar21;
  longlong lVar22;
  undefined *puVar23;

  uVar20 = SEXT48((int)param_4);
  lVar13 = 0;
  lVar22 = (longlong)(int)(param_4 - 8);
  bVar12 = true;
  if (0 < (int)(param_4 - 8)) {
    do {
      bVar12 = false;
      if ((*(byte *)(lVar13 + param_1) & 1) != 0) break;
      lVar13 = lVar13 + 2;
      bVar12 = true;
    } while (lVar13 < lVar22);
  }
  if (1 < lVar22) {
    lVar13 = 1;
    do {
      if ((*(byte *)(lVar13 + param_1) & 1) == 0) goto LAB_18002d864;
      lVar13 = lVar13 + 2;
    } while (lVar13 < lVar22);
  }
  if (bVar12) {
    cVar15 = (*(byte *)(lVar22 + param_1) & 1) +
             (*(byte *)((int)(param_4 - 7) + param_1) & 1) * '\x02';
    if (cVar15 == '\x01') {
      *param_5 = 1;
    }
    else {
      if (cVar15 == '\x03') {
        *param_5 = 2;
      }
      else {
        *param_5 = 0;
      }
    }
    bVar3 = *(byte *)((int)(param_4 - 6) + param_1);
    if ((bVar3 & 1) != 0) {
      iVar19 = param_3 * param_4;
      puVar14 = (undefined *)malloc((longlong)iVar19);
      *param_2 = puVar14;
      uVar16 = uVar20;
      puVar23 = puVar14;
      if (0 < (int)param_4) {
        while (uVar16 != 0) {
          *puVar23 = 1;
          uVar16 = uVar16 - 1;
          puVar23 = puVar23 + 1;
        }
      }
      if (((int)param_4 < iVar19) && (0x3f < iVar19 - param_4)) {
        if (((undefined *)((iVar19 + -1) + param_1) < puVar14 + uVar20) ||
           (puVar14 + (iVar19 + -1) < (undefined *)(uVar20 + param_1))) {
          uVar21 = iVar19 - param_4 & 0x8000003f;
          if ((int)uVar21 < 0) {
            uVar21 = (uVar21 - 1 | 0xffffffc0) + 1;
          }
          puVar17 = (uint *)((undefined *)(uVar20 + param_1) + 0x10);
          puVar18 = (uint *)(puVar14 + uVar20 + 0x20);
          do {
            uVar4 = puVar17[-3];
            uVar5 = puVar17[-2];
            uVar6 = puVar17[-1];
            param_4 = (int)uVar20 + 0x40;
            uVar20 = (ulonglong)param_4;
            puVar1 = puVar17 + 0x10;
            puVar2 = (uint *)(puVar14 + (-0x10 - param_1) + (longlong)puVar17);
            *puVar2 = puVar17[-4] & 0x1010101;
            puVar2[1] = uVar4 & 0x1010101;
            puVar2[2] = uVar5 & 0x1010101;
            puVar2[3] = uVar6 & 0x1010101;
            uVar4 = puVar17[1];
            uVar5 = puVar17[2];
            uVar6 = puVar17[3];
            uVar8 = puVar17[4];
            uVar9 = puVar17[5];
            uVar10 = puVar17[6];
            uVar11 = puVar17[7];
            puVar18[-4] = *puVar17 & 0x1010101;
            puVar18[-3] = uVar4 & 0x1010101;
            puVar18[-2] = uVar5 & 0x1010101;
            puVar18[-1] = uVar6 & 0x1010101;
            uVar4 = puVar17[8];
            uVar5 = puVar17[9];
            uVar6 = puVar17[10];
            uVar7 = puVar17[0xb];
            *puVar18 = uVar8 & 0x1010101;
            puVar18[1] = uVar9 & 0x1010101;
            puVar18[2] = uVar10 & 0x1010101;
            puVar18[3] = uVar11 & 0x1010101;
            puVar18[4] = uVar4 & 0x1010101;
            puVar18[5] = uVar5 & 0x1010101;
            puVar18[6] = uVar6 & 0x1010101;
            puVar18[7] = uVar7 & 0x1010101;
            puVar17 = puVar1;
            puVar18 = puVar18 + 0x10;
          } while ((-0x10 - param_1) + (longlong)puVar1 < (longlong)(int)(iVar19 - uVar21));
        }
      }
      lVar13 = (longlong)(int)param_4;
      while (lVar13 < iVar19) {
        puVar14[lVar13] = *(byte *)(lVar13 + param_1) & 1;
        lVar13 = lVar13 + 1;
      }
    }
    uVar20 = (ulonglong)(bVar3 & 1);
  }
  else {
LAB_18002d864:
    *param_5 = 0;
    uVar20 = 0;
  }
  return uVar20;
}



undefined8
FUN_18002da00(longlong param_1,longlong param_2,longlong param_3,uint param_4,uint param_5,
             uint param_6,int param_7,undefined8 *param_8,undefined4 *param_9)

{
  int *piVar1;
  longlong lVar2;
  longlong lVar3;
  undefined8 *puVar4;
  undefined8 *puVar5;

  lVar3 = (longlong)(int)param_5;
  if (((int)param_5 < 0) || (lVar2 = (longlong)(int)param_6, (int)param_6 < 0)) {
    return 0xffffffff;
  }
  if (param_7 == 0) {
    *param_9 = 0xffffffff;
    if (param_8 != (undefined8 *)0x0) {
      *param_8 = 0;
      param_8[1] = 0;
      param_8[2] = 0;
    }
    if (param_6 == param_4) {
      if (param_3 != 0) {
        puVar4 = (undefined8 *)(param_3 + 4 + lVar3 * 0x1c);
        if (((param_8 != (undefined8 *)0x0) && (puVar4 != (undefined8 *)0x0)) &&
           ((puVar4 + 3 <= param_8 || (param_8 + 3 <= puVar4)))) {
          puVar4 = (undefined8 *)((longlong)puVar4 - (longlong)param_8);
          lVar2 = 0x18;
          do {
            *(undefined *)param_8 = *(undefined *)((longlong)puVar4 + (longlong)param_8);
            param_8 = (undefined8 *)((longlong)param_8 + 1);
            lVar2 = lVar2 + -1;
          } while (lVar2 != 0);
        }
        *param_9 = *(undefined4 *)(lVar3 * 0x1c + param_3);
        return 1;
      }
    }
    else {
      if (param_5 != param_4) {
        if ((int)param_6 <= (int)param_5) {
          lVar3 = (longlong)(int)(*(int *)(*(longlong *)(param_1 + lVar3 * 8) + 0x104) + param_6) *
                  0x1c;
          piVar1 = (int *)(param_2 + 4 + lVar3);
          if (piVar1 != (int *)0x0) {
            FUN_180023cd0(piVar1,(int *)param_8);
          }
          *param_9 = *(undefined4 *)(lVar3 + param_2);
          return 1;
        }
        lVar3 = (longlong)(int)(*(int *)(*(longlong *)(param_1 + lVar2 * 8) + 0x104) + param_5) *
                0x1c;
        puVar4 = (undefined8 *)(param_2 + 4 + lVar3);
        if (((param_8 != (undefined8 *)0x0) && (puVar4 != (undefined8 *)0x0)) &&
           ((puVar4 + 3 <= param_8 || (param_8 + 3 <= puVar4)))) {
          puVar4 = (undefined8 *)((longlong)puVar4 - (longlong)param_8);
          lVar2 = 0x18;
          do {
            *(undefined *)param_8 = *(undefined *)((longlong)puVar4 + (longlong)param_8);
            param_8 = (undefined8 *)((longlong)param_8 + 1);
            lVar2 = lVar2 + -1;
          } while (lVar2 != 0);
        }
        *param_9 = *(undefined4 *)(lVar3 + param_2);
        return 1;
      }
      if (param_3 != 0) {
        piVar1 = (int *)(param_3 + 4 + lVar2 * 0x1c);
        if (piVar1 != (int *)0x0) {
          FUN_180023cd0(piVar1,(int *)param_8);
        }
        *param_9 = *(undefined4 *)(lVar2 * 0x1c + param_3);
        return 1;
      }
    }
  }
  else {
    if (param_7 == 1) {
      if (param_6 == param_4) {
        if (param_3 != 0) {
          puVar4 = (undefined8 *)(param_3 + 4 + lVar3 * 0x1c);
          if (((puVar4 != (undefined8 *)0x0) && (param_8 != (undefined8 *)0x0)) &&
             ((param_8 + 3 <= puVar4 || (puVar4 + 3 <= param_8)))) {
            puVar5 = (undefined8 *)((longlong)param_8 - (longlong)puVar4);
            lVar2 = 0x18;
            do {
              *(undefined *)puVar4 = *(undefined *)((longlong)puVar4 + (longlong)puVar5);
              puVar4 = (undefined8 *)((longlong)puVar4 + 1);
              lVar2 = lVar2 + -1;
            } while (lVar2 != 0);
          }
          *(undefined4 *)(lVar3 * 0x1c + param_3) = *param_9;
          return 1;
        }
      }
      else {
        if (param_5 == param_4) {
          if (param_3 != 0) {
            if (param_8 != (undefined8 *)0x0) {
              FUN_180023cd0((int *)param_8,(int *)(lVar2 * 0x1c + 4 + param_3));
            }
            *(undefined4 *)(lVar2 * 0x1c + param_3) = *param_9;
            return 1;
          }
        }
        else {
          if ((int)param_5 < (int)param_6) {
            lVar3 = (longlong)(int)(*(int *)(*(longlong *)(param_1 + lVar2 * 8) + 0x104) + param_5)
                    * 0x1c;
            puVar4 = (undefined8 *)(param_2 + 4 + lVar3);
            if (((puVar4 != (undefined8 *)0x0) && (param_8 != (undefined8 *)0x0)) &&
               ((param_8 + 3 <= puVar4 || (puVar4 + 3 <= param_8)))) {
              puVar5 = (undefined8 *)((longlong)param_8 - (longlong)puVar4);
              lVar2 = 0x18;
              do {
                *(undefined *)puVar4 = *(undefined *)((longlong)puVar4 + (longlong)puVar5);
                puVar4 = (undefined8 *)((longlong)puVar4 + 1);
                lVar2 = lVar2 + -1;
              } while (lVar2 != 0);
            }
          }
          else {
            lVar3 = (longlong)(int)(*(int *)(*(longlong *)(param_1 + lVar3 * 8) + 0x104) + param_6)
                    * 0x1c;
            puVar4 = (undefined8 *)(param_2 + 4 + lVar3);
            if (((puVar4 != (undefined8 *)0x0) && (param_8 != (undefined8 *)0x0)) &&
               ((param_8 + 3 <= puVar4 || (puVar4 + 3 <= param_8)))) {
              puVar5 = (undefined8 *)((longlong)param_8 - (longlong)puVar4);
              lVar2 = 0x18;
              do {
                *(undefined *)puVar4 = *(undefined *)((longlong)puVar4 + (longlong)puVar5);
                puVar4 = (undefined8 *)((longlong)puVar4 + 1);
                lVar2 = lVar2 + -1;
              } while (lVar2 != 0);
            }
          }
          *(undefined4 *)(lVar3 + param_2) = *param_9;
        }
      }
    }
  }
  return 1;
}



void FUN_18002dda0(longlong param_1,undefined8 *param_2,undefined8 *param_3)

{
  int iVar1;
  int iVar2;
  undefined8 *puVar3;
  int *piVar4;
  longlong lVar5;
  longlong lVar6;
  int iVar7;
  ulonglong uVar8;
  undefined8 *puVar9;
  longlong lVar10;
  undefined8 *puVar11;
  int iVar12;
  int iVar13;
  undefined8 *puVar14;
  ulonglong uVar15;
  ulonglong uVar16;
  undefined auStack600 [32];
  int local_238;
  longlong local_230;
  ulonglong local_228;
  longlong local_220;
  int local_218;
  undefined8 *local_210;
  undefined8 *local_208;
  undefined8 *local_200;
  undefined8 local_1f8;
  undefined8 local_1f0;
  undefined8 local_1e8;
  undefined8 local_1e0;
  undefined8 local_1d8 [50];
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)auStack600;
  iVar12 = *(int *)(param_1 + 0x1c);
  uVar8 = SEXT48(iVar12);
  local_220 = param_1 + 0x28;
  lVar6 = param_1 + 0x1b8;
  local_230 = lVar6;
  local_210 = param_2;
  local_208 = param_3;
  memset(local_1d8,0,400);
  iVar13 = 0;
  local_1f8 = 0;
  local_1f0 = 0;
  local_1e8 = 0;
  lVar5 = 3;
  if (local_210 != (undefined8 *)0x0) {
    lVar10 = 3;
    puVar3 = local_210;
    do {
      *puVar3 = 0xffffffffffffffff;
      puVar3[1] = 0xffffffffffffffff;
      puVar3[2] = 0xffffffffffffffff;
      puVar9 = puVar3 + 8;
      puVar3[3] = 0xffffffffffffffff;
      puVar3[4] = 0xffffffffffffffff;
      puVar3[5] = 0xffffffffffffffff;
      puVar3[6] = 0xffffffffffffffff;
      puVar3[7] = 0xffffffffffffffff;
      lVar10 = lVar10 + -1;
      puVar3 = puVar9;
    } while (lVar10 != 0);
    *puVar9 = 0xffffffffffffffff;
  }
  puVar3 = local_208;
  if (local_208 != (undefined8 *)0x0) {
    do {
      *puVar3 = 0xffffffffffffffff;
      puVar3[1] = 0xffffffffffffffff;
      puVar3[2] = 0xffffffffffffffff;
      puVar9 = puVar3 + 8;
      puVar3[3] = 0xffffffffffffffff;
      puVar3[4] = 0xffffffffffffffff;
      puVar3[5] = 0xffffffffffffffff;
      puVar3[6] = 0xffffffffffffffff;
      puVar3[7] = 0xffffffffffffffff;
      lVar5 = lVar5 + -1;
      puVar3 = puVar9;
    } while (lVar5 != 0);
    *puVar9 = 0xffffffffffffffff;
  }
  local_238 = 0;
  if (0 < iVar12) {
    local_228 = 0;
    uVar16 = uVar8;
    puVar3 = local_208;
    puVar9 = local_210;
    do {
      iVar12 = local_238;
      if (0x7fffffff < *(uint *)((longlong)puVar9 + local_228 * 4)) {
        *(int *)((longlong)puVar9 + local_228 * 4) = local_238;
        lVar5 = 6;
        puVar14 = local_1d8;
        do {
          puVar11 = puVar14;
          *puVar11 = 0;
          puVar11[1] = 0;
          puVar11[2] = 0;
          puVar11[3] = 0;
          puVar11[4] = 0;
          puVar11[5] = 0;
          puVar11[6] = 0;
          puVar11[7] = 0;
          lVar5 = lVar5 + -1;
          puVar14 = puVar11 + 8;
        } while (lVar5 != 0);
        puVar11[8] = 0;
        lVar5 = 1;
        puVar11[9] = 0;
        iVar2 = (int)uVar16 + -1;
        local_1d8[0]._0_4_ = local_238;
        local_218 = iVar2;
        do {
          iVar1 = *(int *)((longlong)local_1d8 + lVar5 * 4 + -4);
          uVar16 = uVar8 - 1;
          lVar5 = lVar5 + -1;
          if (-1 < iVar2) {
            puVar11 = (undefined8 *)((longlong)puVar3 - (longlong)puVar9);
            puVar14 = (undefined8 *)((longlong)puVar9 + uVar16 * 4);
            iVar7 = iVar2;
            local_200 = puVar11;
            do {
              if ((0x7fffffff < *(uint *)puVar14) && (iVar7 != iVar1)) {
                if ((-1 < iVar1) && (-1 < iVar7)) {
                  local_1f8 = 0;
                  local_1f0 = 0;
                  local_1e8 = 0;
                  iVar13 = -1;
                  if ((uVar16 == uVar8) || (iVar13 = -1, (longlong)iVar1 == uVar8))
                  goto LAB_18002e0af;
                  if (iVar1 < iVar7) {
                    lVar10 = (longlong)
                             (*(int *)(*(longlong *)(local_220 + uVar16 * 8) + 0x104) + iVar1) *
                             0x1c;
                    puVar3 = (undefined8 *)(lVar6 + 4 + lVar10);
                    if ((puVar3 != (undefined8 *)0x0) &&
                       ((puVar3 + 3 <= &local_1f8 || (&local_1e0 <= puVar3)))) {
                      local_1f8 = *puVar3;
                      local_1f0 = puVar3[1];
                      local_1e8 = puVar3[2];
                    }
                    iVar13 = *(int *)(lVar10 + lVar6);
                  }
                  else {
                    lVar6 = (longlong)
                            (*(int *)(*(longlong *)(local_220 + (longlong)iVar1 * 8) + 0x104) +
                            iVar7) * 0x1c;
                    piVar4 = (int *)(local_230 + 4 + lVar6);
                    if (piVar4 != (int *)0x0) {
                      FUN_180023cd0(piVar4,(int *)&local_1f8);
                      puVar11 = local_200;
                      iVar12 = local_238;
                    }
                    iVar13 = *(int *)(lVar6 + local_230);
                    lVar6 = local_230;
                  }
                }
                if (2 < iVar13) {
                  *(int *)((longlong)local_1d8 + lVar5 * 4) = iVar7;
                  lVar5 = lVar5 + 1;
                  *(int *)puVar14 = iVar12;
                  *(int *)((longlong)puVar11 + (longlong)puVar14) = iVar1;
                }
              }
LAB_18002e0af:
              uVar16 = uVar16 - 1;
              puVar14 = (undefined8 *)((longlong)puVar14 + -4);
              iVar7 = iVar7 + -1;
              puVar3 = local_208;
              puVar9 = local_210;
              iVar2 = local_218;
            } while (-1 < iVar7);
          }
          uVar16 = 0;
        } while (0 < lVar5);
        puVar3 = (undefined8 *)((longlong)puVar3 - (longlong)puVar9);
        uVar15 = uVar16;
        do {
          lVar6 = local_230;
          if (0x7fffffff < *(uint *)puVar9) {
            if (((local_228 != uVar16) && (-1 < iVar12)) && (-1 < (longlong)uVar16)) {
              local_1f8 = 0;
              local_1f0 = 0;
              local_1e8 = 0;
              iVar13 = -1;
              if ((uVar16 == uVar8) || (iVar13 = -1, local_228 == uVar8)) goto LAB_18002e1e3;
              if ((longlong)local_228 < (longlong)uVar16) {
                lVar6 = (longlong)(*(int *)(*(longlong *)(local_220 + uVar16 * 8) + 0x104) + iVar12)
                        * 0x1c;
                puVar14 = (undefined8 *)(local_230 + 4 + lVar6);
                if ((puVar14 != (undefined8 *)0x0) &&
                   ((puVar14 + 3 <= &local_1f8 || (&local_1e0 <= puVar14)))) {
                  local_1f8 = *puVar14;
                  local_1f0 = puVar14[1];
                  local_1e8 = puVar14[2];
                }
                iVar13 = *(int *)(lVar6 + local_230);
              }
              else {
                lVar5 = (longlong)
                        (*(int *)(*(longlong *)(local_220 + local_228 * 8) + 0x104) + (int)uVar15);
                piVar4 = (int *)(local_230 + 4 + lVar5 * 0x1c);
                if (piVar4 != (int *)0x0) {
                  FUN_180023cd0(piVar4,(int *)&local_1f8);
                  iVar12 = local_238;
                }
                iVar13 = *(int *)(lVar5 * 0x1c + lVar6);
              }
            }
            if (-1 < iVar13) {
              *(int *)puVar9 = iVar12;
              *(int *)((longlong)puVar9 + (longlong)puVar3) = iVar12;
            }
          }
LAB_18002e1e3:
          uVar15 = (ulonglong)((int)uVar15 + 1);
          uVar16 = uVar16 + 1;
          puVar9 = (undefined8 *)((longlong)puVar9 + 4);
        } while ((longlong)uVar16 < (longlong)uVar8);
        uVar16 = uVar8 & 0xffffffff;
        lVar6 = local_230;
        puVar3 = local_208;
        puVar9 = local_210;
      }
      local_238 = iVar12 + 1;
      local_228 = local_228 + 1;
    } while ((longlong)local_228 < (longlong)uVar8);
  }
  FUN_18005f100(local_48 ^ (ulonglong)auStack600);
  return;
}



void FUN_18002e260(longlong param_1)

{
  undefined8 *puVar1;
  uint uVar2;
  uint uVar3;
  undefined8 *puVar4;
  ulonglong uVar5;
  longlong lVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  uint uVar9;
  ulonglong uVar10;
  int iVar11;
  longlong lVar12;
  undefined auStack488 [32];
  undefined8 local_1c8 [26];
  undefined8 local_f8 [26];
  ulonglong local_28;

  local_28 = DAT_1800b04e8 ^ (ulonglong)auStack488;
  lVar12 = (longlong)*(int *)(param_1 + 0x1c);
  uVar8 = 0;
  iVar11 = -1;
  *(undefined4 *)(param_1 + 0x87e4) = 0;
  *(undefined4 *)(param_1 + 0x87d8) = 0xffffffff;
  uVar7 = uVar8;
  if (0 < lVar12) {
    do {
      uVar5 = uVar7 + 1;
      *(undefined4 *)(*(longlong *)(param_1 + 0x28 + uVar7 * 8) + 0x100) = 0;
      uVar7 = uVar5;
    } while ((longlong)uVar5 < lVar12);
  }
  FUN_18002dda0(param_1,local_f8,local_1c8);
  lVar6 = 3;
  puVar4 = local_1c8;
  do {
    *puVar4 = 0;
    puVar4[1] = 0;
    puVar4[2] = 0;
    puVar1 = puVar4 + 8;
    puVar4[3] = 0;
    puVar4[4] = 0;
    puVar4[5] = 0;
    puVar4[6] = 0;
    puVar4[7] = 0;
    lVar6 = lVar6 + -1;
    puVar4 = puVar1;
  } while (lVar6 != 0);
  *puVar1 = 0;
  uVar7 = uVar8;
  if (0 < lVar12) {
    do {
      uVar5 = uVar7 + 1;
      puVar4 = (undefined8 *)
               ((longlong)local_1c8 + (longlong)*(int *)((longlong)local_f8 + uVar7 * 4) * 4);
      *(int *)puVar4 = *(int *)puVar4 + 1;
      uVar7 = uVar5;
    } while ((longlong)uVar5 < lVar12);
  }
  uVar7 = uVar8;
  uVar5 = uVar8;
  uVar10 = uVar8;
  if (0 < lVar12) {
    do {
      uVar2 = *(uint *)((longlong)local_1c8 + uVar7 * 4);
      uVar9 = (uint)uVar10;
      uVar3 = uVar2;
      if ((int)uVar2 <= (int)uVar9) {
        uVar3 = uVar9;
      }
      if ((int)uVar9 < (int)uVar2) {
        iVar11 = (int)uVar5;
      }
      uVar7 = uVar7 + 1;
      uVar5 = (ulonglong)((int)uVar5 + 1);
      uVar10 = (ulonglong)uVar3;
    } while ((longlong)uVar7 < lVar12);
    if (1 < (int)uVar3) {
      *(undefined4 *)(param_1 + 0x87e4) = 1;
      *(int *)(param_1 + 0x87d8) = iVar11;
      *(undefined4 *)(*(longlong *)(param_1 + 0x28 + (longlong)iVar11 * 8) + 0x100) = 1;
      do {
        if (*(int *)((longlong)local_f8 + uVar8 * 4) == iVar11) {
          *(undefined4 *)(*(longlong *)(param_1 + 0x28 + uVar8 * 8) + 0x100) = 1;
        }
        uVar8 = uVar8 + 1;
      } while ((longlong)uVar8 < lVar12);
    }
  }
  FUN_18005f100(local_28 ^ (ulonglong)auStack488);
  return;
}



void FUN_18002e3f0(longlong param_1,longlong param_2)

{
  longlong lVar1;
  int iVar2;
  int iVar3;
  longlong lVar4;
  longlong lVar5;
  uint uVar6;
  ulonglong uVar7;
  longlong lVar8;
  int iVar9;
  int iVar10;
  undefined auStack472 [32];
  undefined8 local_1b8 [26];
  undefined8 local_e8 [26];
  ulonglong local_18;

  local_18 = DAT_1800b04e8 ^ (ulonglong)auStack472;
  uVar7 = 0;
  if (*(int *)(param_1 + 0x24) != 0) {
    do {
      *(undefined *)(uVar7 + param_2) = 1;
      uVar6 = (int)uVar7 + 1;
      uVar7 = (ulonglong)uVar6;
    } while (uVar6 < *(uint *)(param_1 + 0x24));
  }
  lVar5 = (longlong)*(int *)(param_1 + 0x1c);
  lVar1 = param_1 + 0x28;
  FUN_18002dda0(param_1,local_1b8,local_e8);
  iVar10 = 0;
  if (0 < lVar5) {
    lVar8 = 0;
    do {
      if (iVar10 == *(int *)((longlong)local_1b8 + lVar8 * 4)) {
        iVar9 = 0;
        lVar4 = 0;
        do {
          if ((lVar4 != lVar8) && (iVar9 == *(int *)((longlong)local_1b8 + lVar4 * 4))) {
            if (lVar8 < lVar4) {
              iVar2 = *(int *)(*(longlong *)(lVar1 + lVar4 * 8) + 0x104) + iVar10;
            }
            else {
              iVar2 = *(int *)(*(longlong *)(lVar1 + lVar8 * 8) + 0x104) + iVar9;
            }
            *(undefined *)(iVar2 + param_2) = 0;
          }
          iVar9 = iVar9 + 1;
          lVar4 = lVar4 + 1;
        } while (lVar4 < lVar5);
      }
      iVar9 = *(int *)((longlong)local_e8 + lVar8 * 4);
      iVar2 = 0;
      lVar4 = 0;
      do {
        if ((lVar4 != iVar9) && (iVar10 != *(int *)((longlong)local_e8 + lVar4 * 4))) {
          if (lVar8 < lVar4) {
            iVar3 = *(int *)(*(longlong *)(lVar1 + lVar4 * 8) + 0x104) + iVar10;
          }
          else {
            if (lVar8 <= lVar4) goto LAB_18002e4e9;
            iVar3 = *(int *)(*(longlong *)(lVar1 + lVar8 * 8) + 0x104) + iVar2;
          }
          *(undefined *)(iVar3 + param_2) = 0;
        }
LAB_18002e4e9:
        iVar2 = iVar2 + 1;
        lVar4 = lVar4 + 1;
      } while (lVar4 < lVar5);
      iVar10 = iVar10 + 1;
      lVar8 = lVar8 + 1;
    } while (lVar8 < lVar5);
  }
  FUN_18005f100(local_18 ^ (ulonglong)auStack472);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18002e530(longlong param_1,longlong param_2)

{
  int iVar1;
  longlong lVar2;
  longlong lVar3;
  undefined8 *puVar4;
  uint uVar5;
  longlong lVar6;
  undefined8 *puVar7;
  byte bVar8;
  longlong lVar9;
  longlong lVar10;
  uint uVar11;
  longlong lVar12;
  longlong lVar13;
  ulonglong uVar14;
  ulonglong uVar15;
  uint uVar16;
  uint *puVar17;
  longlong lVar18;
  uint uVar19;
  ulonglong uVar20;
  int iVar21;
  ulonglong uVar22;
  int iVar23;
  uint uVar24;
  undefined8 unaff_R14;
  ulonglong uVar25;
  ulonglong uVar26;
  uint uVar27;
  ulonglong uVar28;
  int *apiStackX8 [2];
  int aiStackX24 [2];
  ulonglong uStackX32;
  longlong local_2ca8;
  longlong local_2ca0;
  int *local_2c98;
  longlong local_2c90;
  int local_2c88 [2];
  longlong local_2c80;
  longlong local_2c78;
  longlong local_2c70;
  uint local_2c68 [100];
  undefined8 local_2ad8;
  int iStack10960;
  uint uStack10956;
  undefined8 local_2ac8;
  int local_2ac0;
  int iStack10940;
  int iStack10936;
  int iStack10932;
  undefined8 local_2ab0;
  int local_2aa8;
  int iStack10916;
  int iStack10912;
  int iStack10908;
  undefined8 local_2a98;
  uint uStack10892;
  undefined8 local_2a88 [50];
  int local_28f8 [2604];
  ulonglong local_48;
  undefined8 uStack64;

  uStack64 = 0x18002e54d;
  lVar6 = _alloca_probe();
  lVar6 = -lVar6;
  local_48 = DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffc8 + lVar6);
  lVar10 = param_1 + 0x28;
  iVar21 = *(int *)(param_1 + 0x1c);
  uVar14 = SEXT48(iVar21);
  local_2ca0 = param_1 + 0x1b8;
  local_2c80 = lVar10;
  *(int *)(&stack0x0000003c + lVar6) = iVar21;
  *(undefined4 *)(&stack0x00000028 + lVar6) = 0;
  local_2aa8 = 0x100;
  iStack10916 = 0;
  iStack10912 = 0;
  iStack10908 = 0;
  iVar23 = 0;
  *(undefined4 *)((longlong)aiStackX24 + lVar6 + 4) = 0;
  local_2ac0 = 0x100;
  iStack10940 = 0;
  iStack10936 = 0;
  iStack10932 = 0;
  *(undefined4 *)(&stack0x00000038 + lVar6) = 0;
  local_2ad8 = 0x100;
  iStack10960 = 0;
  uStack10956 = 0;
  local_2a98 = 0x100;
  local_2ab0 = 0x100;
  local_2ac8 = 0x100;
  local_2c88[0] = 2;
  *(undefined8 *)((longlong)&uStack64 + lVar6) = 0x18002e5ef;
  memset(local_28f8,0,0x28a4,*(undefined *)((longlong)&uStack64 + lVar6));
  uVar20 = 0;
  *(int *)((longlong)aiStackX24 + lVar6) = 0;
  if (0 < iVar21) {
    *(undefined8 *)(&stack0x00002d08 + lVar6) = unaff_R14;
    *(ulonglong *)((longlong)&uStackX32 + lVar6) = 0;
    *(undefined8 *)(&stack0x00000030 + lVar6) = 0;
    uVar15 = uVar14;
    uVar22 = uVar20;
    uVar25 = uVar20;
    local_2ca8 = param_2;
    do {
      if (0 < iVar21 + 1) {
        lVar9 = (longlong)(iVar21 + 1);
        puVar17 = local_2c68;
        while (lVar9 != 0) {
          lVar9 = lVar9 + -1;
          *puVar17 = 0xffffffff;
          puVar17 = puVar17 + 1;
        }
        iVar23 = *(int *)((longlong)aiStackX24 + lVar6 + 4);
      }
      uVar24 = (uint)uVar25;
      local_2c68[uVar20] = uVar24;
      lVar9 = 6;
      puVar4 = local_2a88;
      do {
        puVar7 = puVar4;
        *puVar7 = 0;
        puVar7[1] = 0;
        puVar7[2] = 0;
        puVar7[3] = 0;
        puVar7[4] = 0;
        puVar7[5] = 0;
        puVar7[6] = 0;
        puVar7[7] = 0;
        lVar9 = lVar9 + -1;
        puVar4 = puVar7 + 8;
      } while (lVar9 != 0);
      puVar7[8] = 0;
      puVar7[9] = 0;
      local_2c90 = 1;
      local_2a88[0]._0_4_ = uVar24;
      do {
        lVar2 = local_2ca0;
        lVar9 = local_2ca8;
        uVar27 = (&uStack10892)[local_2c90];
        uVar25 = SEXT48((int)uVar27);
        local_2c90 = local_2c90 + -1;
        *(uint *)(&stack0x0000002c + lVar6) = uVar27;
        uVar19 = (uint)uVar15;
        if (uVar27 != uVar24) {
          *(undefined **)((longlong)apiStackX8 + lVar6) = &stack0x00000028 + lVar6;
          *(int **)((longlong)&uStackX32 + lVar6 + -0x20) = &local_2aa8;
          *(undefined4 *)(&stack0xfffffffffffffff8 + lVar6) = 0;
          *(uint *)(&stack0xfffffffffffffff0 + lVar6) = uVar27;
          *(uint *)(&stack0xffffffffffffffe8 + lVar6) = uVar24;
          *(undefined8 *)((longlong)&uStack64 + lVar6) = 0x18002e6df;
          FUN_18002da00(lVar10,lVar2,lVar9,uVar19,*(uint *)(&stack0xffffffffffffffe8 + lVar6),
                        *(uint *)(&stack0xfffffffffffffff0 + lVar6),
                        *(int *)(&stack0xfffffffffffffff8 + lVar6),
                        *(undefined8 **)((longlong)&uStackX32 + lVar6 + -0x20),
                        *(int **)((longlong)apiStackX8 + lVar6));
          iVar21 = *(int *)(&stack0x00000028 + lVar6);
          uVar22 = *(ulonglong *)(&stack0x00000030 + lVar6);
          uVar20 = *(ulonglong *)((longlong)&uStackX32 + lVar6);
          local_28f8[uVar22 + uVar25] = iVar21;
          local_28f8[uVar25 * 0x33 + uVar20] = iVar21;
          uVar14 = SEXT48((int)uVar19);
        }
        uVar28 = uVar15 & 0xffffffff;
        if (-1 < (int)uVar19) {
          local_2c98 = local_28f8 + uVar14 * 0x33 + uVar20;
          local_2c78 = (uVar25 - uVar20) * 4;
          uVar26 = uVar25;
          do {
            lVar2 = local_2ca0;
            lVar9 = local_2ca8;
            uVar27 = (uint)uVar28;
            if (0x7fffffff < local_2c68[uVar14]) {
              uVar19 = (uint)uVar26;
              if (uVar19 != uVar27) {
                *(int **)((longlong)apiStackX8 + lVar6) = (int *)((longlong)aiStackX24 + lVar6 + 4);
                *(int **)((longlong)&uStackX32 + lVar6 + -0x20) = &local_2ac0;
                *(undefined4 *)(&stack0xfffffffffffffff8 + lVar6) = 0;
                *(uint *)(&stack0xfffffffffffffff0 + lVar6) = uVar27;
                *(uint *)(&stack0xffffffffffffffe8 + lVar6) = uVar19;
                *(undefined8 *)((longlong)&uStack64 + lVar6) = 0x18002e799;
                FUN_18002da00(lVar10,lVar2,lVar9,(uint)uVar15,
                              *(uint *)(&stack0xffffffffffffffe8 + lVar6),
                              *(uint *)(&stack0xfffffffffffffff0 + lVar6),
                              *(int *)(&stack0xfffffffffffffff8 + lVar6),
                              *(undefined8 **)((longlong)&uStackX32 + lVar6 + -0x20),
                              *(int **)((longlong)apiStackX8 + lVar6));
                uVar20 = *(ulonglong *)((longlong)&uStackX32 + lVar6);
                iVar23 = *(int *)((longlong)aiStackX24 + lVar6 + 4);
                uVar25 = SEXT48((int)uVar19);
              }
              lVar2 = local_2ca0;
              lVar9 = local_2ca8;
              if (0 < iVar23) {
                *(int *)(local_2c78 + (longlong)local_2c98) = iVar23;
                iVar21 = *(int *)(&stack0x00000028 + lVar6);
                local_2c68[uVar14] = uVar24;
                if (iVar23 < iVar21) {
                  iVar21 = iVar23;
                }
                local_28f8[uVar25 * 0x33 + uVar14] = iVar23;
                *(int *)(&stack0x00000040 + lVar6) = iVar21;
                *(uint *)((longlong)local_2a88 + local_2c90 * 4) = uVar27;
                local_2c90 = local_2c90 + 1;
                if (uVar24 != uVar27) {
                  *(undefined **)((longlong)apiStackX8 + lVar6) = &stack0x00000038 + lVar6;
                  *(undefined8 **)((longlong)&uStackX32 + lVar6 + -0x20) = &local_2ad8;
                  *(undefined4 *)(&stack0xfffffffffffffff8 + lVar6) = 0;
                  *(uint *)(&stack0xfffffffffffffff0 + lVar6) = uVar27;
                  *(uint *)(&stack0xffffffffffffffe8 + lVar6) = uVar24;
                  *(undefined8 *)((longlong)&uStack64 + lVar6) = 0x18002e82a;
                  FUN_18002da00(lVar10,lVar2,lVar9,(uint)uVar15,
                                *(uint *)(&stack0xffffffffffffffe8 + lVar6),
                                *(uint *)(&stack0xfffffffffffffff0 + lVar6),
                                *(int *)(&stack0xfffffffffffffff8 + lVar6),
                                *(undefined8 **)((longlong)&uStackX32 + lVar6 + -0x20),
                                *(int **)((longlong)apiStackX8 + lVar6));
                  iVar21 = *(int *)(&stack0x00000040 + lVar6);
                }
                lVar3 = local_2c80;
                lVar2 = local_2ca0;
                lVar9 = local_2ca8;
                if (uVar24 != uVar19) {
                  if ((*(int *)(&stack0x00000038 + lVar6) < 2) ||
                     ((uVar22 = *(ulonglong *)(&stack0x00000030 + lVar6),
                      *(int *)(&stack0x00000038 + lVar6) == 2 &&
                      (local_28f8[uVar22 + uVar14] < iVar21)))) {
                    lVar12 = (longlong)iStack10916;
                    lVar18 = (longlong)local_2aa8;
                    lVar13 = (longlong)(int)local_2a98;
                    uVar16 = 0;
                    iStack10960 = (int)((ulonglong)
                                        (local_2ab0._4_4_ * lVar12 + iStack10936 * lVar18) >> 8) +
                                  iStack10912;
                    lVar10 = (longlong)iStack10908;
                    local_2c70 = local_2ac0 * lVar10;
                    bVar8 = 0xf;
                    iVar21 = (int)((ulonglong)((int)local_2ab0 * lVar13 + iStack10940 * lVar10) >> 8
                                  ) + (int)((ulonglong)(lVar12 * iStack10932 + local_2ac0 * lVar18)
                                           >> 8) >> 1;
                    iVar23 = (int)((ulonglong)(local_2ac0 * lVar10 + lVar13 * iStack10932) >> 8) -
                             (int)((ulonglong)((int)local_2ab0 * lVar12 + iStack10940 * lVar18) >> 8
                                  ) >> 1;
                    local_2a98._4_4_ =
                         (int)((ulonglong)(iStack10936 * lVar10 + lVar13 * local_2ab0._4_4_) >> 8) +
                         local_2a98._4_4_;
                    uVar11 = 0x8000;
                    uStack10956 = iVar23 * iVar23 + iVar21 * iVar21;
                    uVar19 = uStack10956;
                    if (1 < uStack10956) {
                      do {
                        uVar5 = uVar11 + uVar16 * 2 << (bVar8 & 0x1f);
                        bVar8 = bVar8 - 1;
                        uStack10956 = uVar16;
                        if (uVar5 <= uVar19) {
                          uStack10956 = uVar16 + uVar11;
                          uVar19 = uVar19 - uVar5;
                        }
                        uVar11 = uVar11 >> 1;
                        uVar16 = uStack10956;
                      } while (uVar11 != 0);
                    }
                    if (uStack10956 == 0) {
                      local_2ad8 = 0x100;
                      local_2ac8 = CONCAT44(local_2a98._4_4_,0x100);
                    }
                    else {
                      iVar1 = (((int)uStack10956 >> 1) + iVar21 * 0x100) / (int)uStack10956;
                      local_2ac8 = CONCAT44(local_2a98._4_4_,iVar1);
                      iVar21 = (((int)uStack10956 >> 1) + iVar23 * -0x100) / (int)uStack10956;
                      local_2ad8 = CONCAT44(iVar21,iVar1);
                      uStack10956 = -iVar21;
                    }
                    uVar19 = *(uint *)(&stack0x0000003c + lVar6);
                    uVar15 = (ulonglong)uVar19;
                    if (uVar24 != uVar27) {
                      *(int **)((longlong)apiStackX8 + lVar6) = local_2c88;
                      *(undefined8 **)((longlong)&uStackX32 + lVar6 + -0x20) = &local_2ad8;
                      *(undefined4 *)(&stack0xfffffffffffffff8 + lVar6) = 1;
                      *(uint *)(&stack0xfffffffffffffff0 + lVar6) = uVar27;
                      *(uint *)(&stack0xffffffffffffffe8 + lVar6) = uVar24;
                      *(undefined8 *)((longlong)&uStack64 + lVar6) = 0x18002ea2c;
                      FUN_18002da00(lVar3,lVar2,lVar9,uVar19,
                                    *(uint *)(&stack0xffffffffffffffe8 + lVar6),
                                    *(uint *)(&stack0xfffffffffffffff0 + lVar6),
                                    *(int *)(&stack0xfffffffffffffff8 + lVar6),
                                    *(undefined8 **)((longlong)&uStackX32 + lVar6 + -0x20),
                                    *(int **)((longlong)apiStackX8 + lVar6));
                    }
                    iVar21 = *(int *)(&stack0x00000040 + lVar6);
                    uVar22 = *(ulonglong *)(&stack0x00000030 + lVar6);
                    uVar20 = *(ulonglong *)((longlong)&uStackX32 + lVar6);
                    local_28f8[uVar22 + uVar14] = iVar21;
                    *local_2c98 = iVar21;
                    lVar10 = lVar3;
                    if ((int)uVar27 < (int)uVar19) {
                      lVar9 = *(longlong *)(lVar3 + uVar14 * 8);
                      *(int *)((longlong)aiStackX24 + lVar6) = 1;
                      if ((*(int *)(lVar9 + 0x100) == 1) ||
                         (*(int *)(*(longlong *)(lVar3 + uVar20 * 8) + 0x100) == 1)) {
                        *(undefined4 *)(lVar9 + 0x100) = 1;
                        *(undefined4 *)(*(longlong *)(lVar3 + uVar20 * 8) + 0x100) = 1;
                      }
                      iVar23 = *(int *)((longlong)aiStackX24 + lVar6 + 4);
                      uVar26 = (ulonglong)*(uint *)(&stack0x0000002c + lVar6);
                    }
                    else {
                      iVar23 = *(int *)((longlong)aiStackX24 + lVar6 + 4);
                      uVar26 = (ulonglong)*(uint *)(&stack0x0000002c + lVar6);
                    }
                  }
                  else {
                    uVar20 = *(ulonglong *)((longlong)&uStackX32 + lVar6);
                  }
                  goto LAB_18002eab3;
                }
                uVar20 = *(ulonglong *)((longlong)&uStackX32 + lVar6);
              }
              uVar22 = *(ulonglong *)(&stack0x00000030 + lVar6);
            }
LAB_18002eab3:
            local_2c98 = local_2c98 + -0x33;
            uVar14 = uVar14 - 1;
            uVar28 = (ulonglong)(uVar27 - 1);
            uVar25 = SEXT48((int)uVar26);
          } while (-1 < (int)(uVar27 - 1));
          uVar14 = SEXT48((int)uVar15);
        }
      } while (0 < local_2c90);
      uVar20 = uVar20 + 1;
      iVar21 = (int)uVar15;
      uVar22 = uVar22 + 0x33;
      *(ulonglong *)((longlong)&uStackX32 + lVar6) = uVar20;
      uVar25 = (ulonglong)(uVar24 + 1);
      *(ulonglong *)(&stack0x00000030 + lVar6) = uVar22;
    } while ((int)(uVar24 + 1) < iVar21);
  }
  *(undefined8 *)((longlong)&uStack64 + lVar6) = 0x18002eb30;
  FUN_18005f100(local_48 ^ (ulonglong)(&stack0xffffffffffffffc8 + lVar6),
                *(undefined *)((longlong)&uStack64 + lVar6));
  return;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Could not reconcile some variable overlaps
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18002eb50(longlong param_1,uint *param_2,int *param_3,undefined8 param_4,uint *param_5,
                  int param_6)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  ulonglong uVar4;
  undefined8 *puVar5;
  byte bVar6;
  longlong lVar7;
  uint uVar8;
  longlong lVar9;
  uint *puVar10;
  undefined8 *puVar11;
  undefined (*pauVar12) [16];
  ulonglong uVar13;
  uint uVar14;
  uint *puVar15;
  longlong lVar16;
  ulonglong uVar17;
  uint uVar18;
  uint *puVar19;
  ulonglong uVar20;
  int iVar21;
  int *piVar22;
  int iVar23;
  longlong lVar24;
  uint uVar25;
  uint uVar26;
  undefined4 uVar27;
  undefined4 uVar28;
  undefined auVar29 [16];
  uint local_518 [2];
  longlong local_510;
  int local_508;
  int local_504;
  int local_500 [2];
  uint *local_4f8;
  undefined4 local_4f0 [2];
  longlong local_4e8;
  longlong local_4e0;
  uint *local_4d8;
  int local_4d0;
  int local_4cc;
  int local_4c8;
  longlong local_4c0;
  uint *local_4b8;
  longlong local_4b0;
  longlong local_4a8;
  uint local_4a0;
  uint uStack1180;
  uint uStack1176;
  uint uStack1172;
  undefined8 local_490;
  undefined8 local_488;
  int iStack1152;
  uint uStack1148;
  undefined8 local_478;
  int local_470;
  int iStack1132;
  int iStack1128;
  int iStack1124;
  undefined8 local_460;
  uint local_458;
  int aiStack1108 [62];
  int iStack860;
  undefined8 local_358 [26];
  undefined8 local_288;
  undefined8 local_188;
  undefined8 local_88;
  undefined8 local_80;
  undefined8 local_78;
  undefined4 local_70;
  undefined2 local_6c;
  undefined local_6a;
  ulonglong local_68;

  auVar29 = _DAT_1800a4170;
  local_68 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffa98;
  local_4a8 = *(longlong *)(param_2 + 0x3e);
  local_4b0 = param_1 + 0x28;
  local_4d0 = *param_3;
  local_4cc = param_3[1];
  local_4c8 = param_3[2];
  iVar21 = 0;
  uVar25 = 0;
  local_4b8 = param_5;
  local_78 = 0x100;
  local_4f8 = (uint *)0x0;
  if (param_6 == 1) {
    uVar25 = *(int *)(param_1 + 0x1c) - 1;
    local_4f8 = (uint *)(param_1 + 0x1b8 +
                        (longlong)
                        *(int *)(*(longlong *)(local_4b0 + (longlong)(int)uVar25 * 8) + 0x104) *
                        0x1c);
  }
  else {
    if (param_6 == 2) {
      uVar25 = *(uint *)(param_1 + 0x1c);
      local_4f8 = param_5;
    }
  }
  local_510 = (longlong)(int)uVar25;
  if (0 < (int)uVar25) {
    puVar19 = local_4f8;
    lVar24 = local_510;
    do {
      uVar14 = *(uint *)((longlong)((longlong)param_5 - (longlong)local_4f8) + (longlong)puVar19);
      if ((0 < (int)uVar14) && (param_6 == 1)) {
        *puVar19 = uVar14;
        puVar15 = param_5 + (longlong)iVar21 * 7 + 1;
        puVar10 = local_4f8 + (longlong)iVar21 * 7 + 1;
        if (((puVar10 != (uint *)0x0) && (puVar15 != (uint *)0x0)) &&
           ((puVar15 + 6 <= puVar10 || (puVar10 + 6 <= puVar15)))) {
          puVar15 = (uint *)((longlong)puVar15 - (longlong)puVar10);
          lVar7 = 0x18;
          do {
            *(undefined *)puVar10 = *(undefined *)((longlong)puVar10 + (longlong)puVar15);
            puVar10 = (uint *)((longlong)puVar10 + 1);
            lVar7 = lVar7 + -1;
          } while (lVar7 != 0);
        }
      }
      iVar21 = iVar21 + 1;
      puVar19 = puVar19 + 7;
      lVar24 = lVar24 + -1;
    } while (lVar24 != 0);
  }
  lVar24 = param_1 + 0x28;
  lVar7 = 3;
  puVar11 = local_358;
  do {
    puVar5 = puVar11;
    *puVar5 = 0;
    puVar5[1] = 0;
    puVar5[2] = 0;
    puVar5[3] = 0;
    puVar5[4] = 0;
    puVar5[5] = 0;
    puVar5[6] = 0;
    puVar5[7] = 0;
    lVar7 = lVar7 + -1;
    puVar11 = puVar5 + 8;
  } while (lVar7 != 0);
  puVar5[8] = 0;
  lVar7 = 3;
  *(undefined4 *)(puVar5 + 9) = 0;
  puVar11 = (undefined8 *)&local_458;
  do {
    puVar5 = puVar11;
    *puVar5 = 0;
    puVar5[1] = 0;
    puVar5[2] = 0;
    puVar5[3] = 0;
    puVar5[4] = 0;
    puVar5[5] = 0;
    puVar5[6] = 0;
    puVar5[7] = 0;
    lVar7 = lVar7 + -1;
    puVar11 = puVar5 + 8;
  } while (lVar7 != 0);
  lVar7 = 1;
  puVar5[8] = 0;
  *(undefined4 *)(puVar5 + 9) = 0;
  local_458 = uVar25;
  local_4a0 = 0x100;
  uStack1180 = 0;
  uStack1176 = 0;
  uStack1172 = 0;
  local_490 = 0x100;
  local_470 = 0x100;
  iStack1132 = 0;
  iStack1128 = 0;
  iStack1124 = 0;
  local_460 = 0x100;
  local_488 = 0x100;
  iStack1152 = 0;
  uStack1148 = 0;
  local_478 = 0x100;
  local_4f0[0] = 0;
  local_504 = 0;
  local_500[0] = 0;
  local_508 = 2;
  puVar19 = local_4f8;
  local_4e0 = param_1;
  local_4d8 = param_2;
  while( true ) {
    uVar14 = *(uint *)((longlong)&local_460 + lVar7 * 4 + 4);
    lVar7 = lVar7 + -1;
    uVar26 = uVar25 - 1;
    local_518[0] = uVar14;
    if (uVar14 != uVar25) {
      FUN_18002da00(lVar24,param_1 + 0x1b8,(longlong)puVar19,uVar25,uVar25,uVar14,0,
                    (undefined8 *)&local_4a0,local_4f0);
    }
    if (-1 < (int)uVar26) {
      piVar22 = &iStack860 + (int)uVar25;
      do {
        if (*piVar22 != 1) {
          if (uVar14 != uVar26) {
            FUN_18002da00(param_1 + 0x28,param_1 + 0x1b8,(longlong)puVar19,uVar25,uVar14,uVar26,0,
                          (undefined8 *)&local_470,&local_504);
          }
          if (local_504 - 1U < 0x1f) {
            *(uint *)((longlong)&local_458 + lVar7 * 4) = uVar26;
            lVar7 = lVar7 + 1;
            *piVar22 = 1;
            local_4e8 = lVar7;
            if (uVar25 != uVar26) {
              FUN_18002da00(param_1 + 0x28,param_1 + 0x1b8,(longlong)puVar19,uVar25,uVar25,uVar26,0,
                            &local_488,local_500);
            }
            if ((uVar25 != uVar14) && (local_500[0] < 2)) {
              lVar7 = (longlong)(int)local_4a0;
              lVar16 = (longlong)(int)uStack1180;
              lVar9 = (longlong)(int)local_490;
              iStack1152 = (int)((ulonglong)(iStack1128 * lVar7 + local_460._4_4_ * lVar16) >> 8) +
                           uStack1176;
              lVar24 = (longlong)(int)uStack1172;
              local_4c0 = local_470 * lVar24;
              bVar6 = 0xf;
              iVar21 = (int)((ulonglong)((int)local_460 * lVar9 + iStack1132 * lVar24) >> 8) +
                       (int)((ulonglong)(lVar7 * local_470 + lVar16 * iStack1124) >> 8) >> 1;
              iVar23 = (int)((ulonglong)(local_4c0 + lVar9 * iStack1124) >> 8) -
                       (int)((ulonglong)(iStack1132 * lVar7 + (int)local_460 * lVar16) >> 8) >> 1;
              local_490._4_4_ =
                   (int)((ulonglong)(iStack1128 * lVar24 + lVar9 * local_460._4_4_) >> 8) +
                   local_490._4_4_;
              uVar8 = 0x8000;
              uVar18 = iVar23 * iVar23 + iVar21 * iVar21;
              uStack1148 = uVar18;
              uVar14 = 0;
              if (1 < uVar18) {
                do {
                  uVar3 = uVar8 + uVar14 * 2 << (bVar6 & 0x1f);
                  bVar6 = bVar6 - 1;
                  uStack1148 = uVar14;
                  if (uVar3 <= uVar18) {
                    uStack1148 = uVar14 + uVar8;
                    uVar18 = uVar18 - uVar3;
                  }
                  uVar8 = uVar8 >> 1;
                  uVar14 = uStack1148;
                } while (uVar8 != 0);
              }
              if (uStack1148 == 0) {
                local_488 = 0x100;
                local_478 = CONCAT44(local_490._4_4_,0x100);
              }
              else {
                iVar1 = (((int)uStack1148 >> 1) + iVar21 * 0x100) / (int)uStack1148;
                local_478 = CONCAT44(local_490._4_4_,iVar1);
                iVar21 = (((int)uStack1148 >> 1) + iVar23 * -0x100) / (int)uStack1148;
                local_488 = CONCAT44(iVar21,iVar1);
                uStack1148 = -iVar21;
              }
              lVar7 = local_4e8;
              param_1 = local_4e0;
              puVar19 = local_4f8;
              uVar14 = local_518[0];
              if (uVar25 != uVar26) {
                FUN_18002da00(local_4e0 + 0x28,local_4e0 + 0x1b8,(longlong)local_4f8,uVar25,uVar25,
                              uVar26,1,&local_488,&local_508);
                lVar7 = local_4e8;
                uVar14 = local_518[0];
              }
            }
          }
        }
        piVar22 = piVar22 + -1;
        uVar26 = uVar26 - 1;
      } while (-1 < (int)uVar26);
    }
    if (lVar7 < 1) break;
    lVar24 = param_1 + 0x28;
  }
  uVar17 = 0;
  uVar4 = uVar17;
  puVar10 = local_4b8;
  if (0 < (longlong)(int)uVar25) {
    do {
      if ((*(int *)((longlong)local_358 + uVar4 * 4) != 0) || (uVar27 = 0, *puVar10 == 0xfffffffe))
      {
        uVar27 = 1;
      }
      *(undefined4 *)((longlong)local_358 + uVar4 * 4) = uVar27;
      uVar4 = uVar4 + 1;
      puVar10 = puVar10 + 7;
    } while ((longlong)uVar4 < (longlong)(int)uVar25);
  }
  if (0 < local_510) {
    uVar27 = (undefined4)local_78;
    uVar28 = (undefined4)((ulonglong)local_78 >> 0x20);
    lVar24 = local_510;
    uVar4 = uVar17;
    do {
      iVar21 = 0;
      iVar23 = (int)uVar17;
      if (*(int *)((longlong)local_358 + uVar4 * 4) != 1) {
        lVar24 = 3;
        puVar10 = *(uint **)(local_4b0 + uVar4 * 8);
        puVar11 = (undefined8 *)&local_458;
        do {
          puVar5 = puVar11;
          *puVar5 = 0xffffffffffffffff;
          puVar5[1] = 0xffffffffffffffff;
          puVar5[2] = 0xffffffffffffffff;
          puVar5[3] = 0xffffffffffffffff;
          puVar5[4] = 0xffffffffffffffff;
          puVar5[5] = 0xffffffffffffffff;
          puVar5[6] = 0xffffffffffffffff;
          puVar5[7] = 0xffffffffffffffff;
          lVar24 = lVar24 + -1;
          puVar11 = puVar5 + 8;
        } while (lVar24 != 0);
        puVar5[8] = 0xffffffffffffffff;
        lVar24 = 3;
        puVar5[9] = 0xffffffffffffffff;
        puVar5[10] = 0xffffffffffffffff;
        puVar5[0xb] = 0xffffffffffffffff;
        puVar5[0xc] = 0xffffffffffffffff;
        puVar5[0xd] = 0xffffffffffffffff;
        puVar5[0xe] = 0xffffffffffffffff;
        puVar11 = &local_288;
        do {
          puVar5 = puVar11;
          *puVar5 = 0;
          puVar5[1] = 0;
          puVar5[2] = 0;
          puVar5[3] = 0;
          puVar5[4] = 0;
          puVar5[5] = 0;
          puVar5[6] = 0;
          puVar5[7] = 0;
          lVar24 = lVar24 + -1;
          puVar11 = puVar5 + 8;
        } while (lVar24 != 0);
        puVar5[8] = 0;
        lVar24 = 3;
        puVar5[9] = 0;
        puVar5[10] = 0;
        puVar5[0xb] = 0;
        puVar5[0xc] = 0;
        puVar5[0xd] = 0;
        puVar5[0xe] = 0;
        puVar11 = &local_188;
        do {
          puVar5 = puVar11;
          *puVar5 = 0;
          puVar5[1] = 0;
          puVar5[2] = 0;
          puVar5[3] = 0;
          puVar5[4] = 0;
          puVar5[5] = 0;
          puVar5[6] = 0;
          puVar5[7] = 0;
          lVar24 = lVar24 + -1;
          puVar11 = puVar5 + 8;
        } while (lVar24 != 0);
        puVar5[8] = 0;
        puVar5[9] = 0;
        puVar5[10] = 0;
        puVar5[0xb] = 0;
        puVar5[0xc] = 0;
        puVar5[0xd] = 0;
        puVar5[0xe] = 0;
        FUN_1800329f0((longlong)puVar10,(longlong)local_4d8,(undefined8 *)&local_458);
        puVar15 = local_4f8;
        piVar22 = (int *)((longlong)&local_458 + 4);
        uVar13 = 0;
        uVar17 = uVar13;
        uVar20 = uVar13;
        do {
          iVar1 = *(int *)((longlong)&local_458 + (longlong)((int)uVar20 * 2) * 4);
          if (-1 < iVar1) {
            iVar2 = *piVar22;
            iVar21 = iVar21 + 1;
            *(uint *)((longlong)&local_188 + uVar17) =
                 (uint)*(ushort *)((longlong)iVar2 * 0x38 + 2 + local_4a8);
            *(uint *)((longlong)&local_188 + uVar17 + 4) =
                 (uint)*(ushort *)((longlong)iVar2 * 0x38 + 4 + local_4a8);
            lVar24 = (longlong)iVar1 * 0x38 + *(longlong *)(puVar10 + 0x3e);
            *(uint *)((longlong)&local_288 + uVar17) = (uint)*(ushort *)(lVar24 + 2);
            *(uint *)((longlong)&local_288 + uVar17 + 4) = (uint)*(ushort *)(lVar24 + 4);
            uVar17 = uVar17 + 8;
          }
          uVar25 = (int)uVar20 + 1;
          uVar20 = (ulonglong)uVar25;
          piVar22 = piVar22 + 2;
        } while ((int)uVar25 < 0x1f);
        if (4 < iVar21) {
          local_490 = 0x100;
          local_88 = 0;
          local_80 = 0;
          local_78 = 0;
          local_70 = 0;
          local_6c = 0;
          local_6a = 0;
          local_4a0 = 0x100;
          uStack1180 = 0;
          uStack1176 = 0;
          uStack1172 = 0;
          local_508 = 0;
          FUN_180030800(&local_188,(longlong)&local_288,iVar21,(undefined8 *)&local_4a0,
                        (undefined1 (*) [9])&local_88,&local_508);
          lVar24 = 0;
          iVar21 = 0;
          do {
            uVar25 = (uint)uVar13 + 1;
            if (*(char *)((longlong)&local_88 + lVar24) == '\0') {
              uVar25 = (uint)uVar13;
            }
            lVar24 = lVar24 + 1;
            uVar13 = (ulonglong)uVar25;
          } while (lVar24 < 0x1f);
          local_518[0] = 0;
          if (4 < (int)uVar25) {
            iVar21 = FUN_18002bd60(local_4d8,puVar10,(ulonglong *)&local_4a0,&local_4d0,(int *)0x0,
                                   (int *)0x0,(int *)local_518,(int *)0x0,0,(int *)0x0);
          }
          if ((((0xe < (int)uVar25) ||
               ((9 < (int)uVar25 && ((0xd2 < iVar21 || (0xcc < (int)local_518[0])))))) ||
              ((6 < (int)uVar25 && ((0xdc < iVar21 || (0xd1 < (int)local_518[0])))))) ||
             ((4 < (int)uVar25 && ((0xe4 < iVar21 || (0xd6 < (int)local_518[0])))))) {
            *puVar19 = uVar25;
            puVar11 = (undefined8 *)(puVar15 + (longlong)iVar23 * 7 + 1);
            lVar24 = local_510;
            if ((puVar11 != (undefined8 *)0x0) &&
               ((&local_488 <= puVar11 || (puVar11 + 3 <= &local_4a0)))) {
              *(uint *)puVar11 = local_4a0;
              *(uint *)((longlong)puVar11 + 4) = uStack1180;
              *(uint *)(puVar11 + 1) = uStack1176;
              *(uint *)((longlong)puVar11 + 0xc) = uStack1172;
              puVar11[2] = local_490;
            }
            goto LAB_18002f497;
          }
        }
        *puVar19 = 0xffffffff;
        pauVar12 = (undefined (*) [16])(puVar15 + (longlong)iVar23 * 7 + 1);
        lVar24 = local_510;
        if ((pauVar12 != (undefined (*) [16])0x0) &&
           (((undefined (*) [16])&local_70 <= pauVar12 || (pauVar12[1] + 8 <= &local_88)))) {
          *pauVar12 = auVar29;
          *(ulonglong *)pauVar12[1] = CONCAT44(uVar28,uVar27);
        }
      }
LAB_18002f497:
      uVar17 = (ulonglong)(iVar23 + 1);
      uVar4 = uVar4 + 1;
      puVar19 = puVar19 + 7;
    } while ((longlong)uVar4 < lVar24);
  }
  FUN_18005f100(local_68 ^ (ulonglong)&stack0xfffffffffffffa98);
  return;
}



ulonglong FUN_18002f540(longlong param_1,int param_2,uint param_3,uint param_4,longlong param_5,
                       longlong param_6,int *param_7,int param_8)

{
  int *piVar1;
  int *piVar2;
  uint uVar3;
  int iVar4;
  longlong lVar5;
  int iVar6;
  uint *_Memory;
  longlong lVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;

  iVar11 = 0;
  iVar12 = 0;
  _Memory = FUN_18002a710(param_1 + 0x28,param_2,param_4,param_3);
  iVar9 = 1;
  if (1 < (int)param_4) {
    do {
      iVar8 = iVar9;
      if (param_2 != 0) {
        iVar8 = iVar9 >> 1;
      }
      uVar3 = *_Memory;
      iVar10 = 1;
      lVar5 = *(longlong *)(_Memory + 6);
      if (1 < (int)param_3) {
        iVar12 = iVar12 + 1 + (param_3 - 2) / 3;
        do {
          iVar6 = iVar10;
          if (param_2 != 0) {
            iVar6 = iVar10 >> 1;
          }
          if (*(char *)((longlong)iVar6 + (int)(uVar3 * iVar8) + lVar5) == '\0') {
            iVar6 = 1;
          }
          else {
            iVar6 = 0;
            lVar7 = 0;
            if (0 < (longlong)param_8) {
              do {
                iVar4 = param_7[lVar7];
                piVar1 = (int *)(param_6 + (longlong)(iVar4 * 4) * 8);
                piVar2 = (int *)(param_5 + (longlong)(iVar4 * 5) * 8);
                if ((-1 < ((iVar10 - *(int *)(param_5 + 0x10 + (longlong)(iVar4 * 5) * 8)) *
                           piVar1[5] - (iVar9 - piVar2[5]) * piVar1[4] ^
                          (iVar10 - *piVar2) * piVar1[1] - (iVar9 - piVar2[1]) * *piVar1)) &&
                   (-1 < ((iVar10 - piVar2[6]) * piVar1[7] - (iVar9 - piVar2[7]) * piVar1[6] ^
                         (iVar10 - piVar2[2]) * piVar1[3] - (iVar9 - piVar2[3]) * piVar1[2]))) {
                  iVar6 = 1;
                  param_7[lVar7] = *param_7;
                  *param_7 = iVar4;
                  break;
                }
                lVar7 = lVar7 + 1;
              } while (lVar7 < param_8);
            }
          }
          iVar11 = iVar11 + iVar6;
          iVar10 = iVar10 + 3;
        } while (iVar10 < (int)param_3);
      }
      iVar9 = iVar9 + 3;
    } while (iVar9 < (int)param_4);
  }
  free(_Memory);
  if (iVar12 < 1) {
    return 100;
  }
  return (longlong)(iVar11 * 100) / (longlong)iVar12 & 0xffffffff;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18002f770(longlong param_1,longlong param_2,uint *param_3,undefined4 *param_4,
                  undefined4 *param_5,int *param_6)

{
  undefined4 *puVar1;
  byte bVar2;
  uint uVar3;
  longlong lVar4;
  ulonglong uVar5;
  undefined8 *puVar6;
  undefined8 *puVar7;
  longlong lVar8;
  int *piVar9;
  int *piVar10;
  undefined (*pauVar11) [16];
  longlong *plVar12;
  int *piVar13;
  int iVar14;
  ulonglong uVar15;
  longlong lVar16;
  int *piVar17;
  int iVar18;
  uint uVar19;
  undefined4 *puVar20;
  undefined4 *puVar21;
  undefined4 uVar22;
  int iVar23;
  ulonglong uVar24;
  ulonglong uVar25;
  int iVar26;
  uint *puVar27;
  bool bVar28;
  longlong alStackX8 [2];
  longlong *aplStackX24 [2];
  longlong local_fc8;
  undefined4 *local_fc0;
  uint *local_fb8;
  undefined4 *local_fb0;
  undefined local_fa8 [16];
  undefined8 local_f98;
  undefined8 local_f90;
  uint local_f88;
  undefined4 local_f84;
  uint local_f80;
  uint local_f7c;
  undefined4 local_f78;
  uint local_f74;
  int local_f68 [52];
  undefined8 local_e98;
  undefined8 local_6c8;
  int local_6c0 [412];
  ulonglong local_50;
  undefined8 uStack72;

  uStack72 = 0x18002f78f;
  local_fc0 = param_4;
  lVar4 = _alloca_probe();
  piVar10 = param_6;
  local_fb0 = param_5;
  lVar4 = -lVar4;
  local_50 = DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffc0 + lVar4);
  uVar3 = *(uint *)(param_1 + 4);
  uVar5 = 0;
  uVar19 = *(uint *)(param_1 + 8);
  lVar16 = (longlong)*(int *)(param_1 + 0x1c);
  *(int **)((longlong)aplStackX24 + lVar4 + 8) = param_6;
  *(uint **)(&stack0x00000038 + lVar4) = param_3;
  *(longlong *)((longlong)alStackX8 + lVar4 + 8) = param_1;
  *(uint *)((longlong)aplStackX24 + lVar4) = uVar3;
  *(uint *)(&stack0x00000004 + lVar4) = uVar19;
  local_f90 = 0;
  local_f88 = uVar3;
  local_f84 = 0;
  local_f80 = uVar3;
  local_f7c = uVar19;
  local_f78 = 0;
  local_f74 = uVar19;
  local_f98 = 0x100;
  *(longlong *)((longlong)alStackX8 + lVar4) = lVar16;
  local_fa8 = _DAT_1800a4170;
  if (param_3 != (uint *)0x0) {
    lVar8 = 0x19;
    *local_fb0 = *(undefined4 *)(param_2 + 0x10c);
    uVar22 = 0;
    *piVar10 = 0;
    puVar6 = &local_6c8;
    do {
      *puVar6 = 0;
      puVar6[1] = 0;
      puVar6[2] = 0;
      puVar6[3] = 0;
      puVar6[4] = 0;
      puVar6[5] = 0;
      puVar6[6] = 0;
      puVar6[7] = 0;
      lVar8 = lVar8 + -1;
      puVar6 = puVar6 + 8;
    } while (lVar8 != 0);
    lVar8 = 0x1f;
    puVar6 = &local_e98;
    do {
      puVar7 = puVar6;
      *puVar7 = 0;
      puVar7[1] = 0;
      puVar7[2] = 0;
      puVar7[3] = 0;
      puVar7[4] = 0;
      puVar7[5] = 0;
      puVar7[6] = 0;
      puVar7[7] = 0;
      lVar8 = lVar8 + -1;
      puVar6 = puVar7 + 8;
    } while (lVar8 != 0);
    puVar7[8] = 0;
    puVar7[9] = 0;
    local_fc8 = param_2;
    *(undefined4 *)((longlong)aplStackX24 + lVar4 + -0x18) = 0;
    if (0 < lVar16) {
      lVar16 = *(longlong *)((longlong)alStackX8 + lVar4);
      piVar10 = local_f68;
      piVar17 = local_6c0 + 1;
      piVar13 = (int *)((longlong)&local_e98 + 4);
      uVar15 = uVar5;
      uVar24 = uVar5;
      uVar25 = uVar5;
      puVar27 = param_3;
      do {
        iVar18 = (int)uVar15;
        if (*puVar27 < 0x80000000) {
          if (param_3 + (longlong)iVar18 * 7 + 1 != (uint *)0x0) {
            *(undefined8 *)((longlong)&uStack72 + lVar4) = 0x18002f913;
            FUN_180023cd0((int *)(param_3 + (longlong)iVar18 * 7 + 1),(int *)local_fa8,
                          *(undefined *)((longlong)&uStack72 + lVar4));
            uVar19 = *(uint *)(&stack0x00000004 + lVar4);
          }
          if (*(int *)((longlong)aplStackX24 + lVar4) < 1) {
            bVar2 = 0;
          }
          else {
            *(undefined8 **)(&stack0xffffffffffffffe0 + lVar4) = &local_e98 + (int)uVar24;
            *(undefined8 *)((longlong)&uStack72 + lVar4) = 0x18002f946;
            bVar2 = FUN_180017ba0((longlong)&local_f90,(int *)local_fa8,
                                  *(int *)((longlong)aplStackX24 + lVar4),uVar19,
                                  *(undefined4 **)(&stack0xffffffffffffffe0 + lVar4));
          }
          piVar9 = *(int **)((longlong)aplStackX24 + lVar4 + 8);
          param_3 = *(uint **)(&stack0x00000038 + lVar4);
          lVar16 = *(longlong *)((longlong)alStackX8 + lVar4);
          piVar17[-2] = piVar13[2] - *piVar13;
          piVar17[-3] = piVar13[1] - piVar13[-1];
          *piVar17 = piVar13[4] - piVar13[2];
          piVar17[-1] = piVar13[3] - piVar13[1];
          piVar17[2] = piVar13[6] - piVar13[4];
          piVar17[1] = piVar13[5] - piVar13[3];
          piVar17[4] = piVar13[8] - piVar13[6];
          piVar17[3] = piVar13[7] - piVar13[5];
          *piVar9 = *piVar9 + (uint)bVar2;
          uVar3 = *(uint *)((longlong)aplStackX24 + lVar4 + -0x18);
          uVar5 = (ulonglong)uVar3;
          uVar19 = *(uint *)(&stack0x00000004 + lVar4);
          if (bVar2 == 1) {
            uVar3 = uVar3 + 1;
            uVar5 = (ulonglong)uVar3;
            *piVar10 = iVar18;
            *(uint *)((longlong)aplStackX24 + lVar4 + -0x18) = uVar3;
            piVar10 = piVar10 + 1;
          }
        }
        uVar22 = (undefined4)uVar5;
        uVar15 = (ulonglong)(iVar18 + 1);
        uVar24 = (ulonglong)((int)uVar24 + 5);
        uVar25 = uVar25 + 1;
        puVar27 = puVar27 + 7;
        piVar17 = piVar17 + 8;
        piVar13 = piVar13 + 10;
      } while ((longlong)uVar25 < lVar16);
      uVar3 = *(uint *)((longlong)aplStackX24 + lVar4);
      lVar16 = *(longlong *)((longlong)alStackX8 + lVar4);
    }
    *(undefined4 *)(&stack0xfffffffffffffff8 + lVar4) = uVar22;
    *(int **)(&stack0xfffffffffffffff0 + lVar4) = local_f68;
    *(undefined8 **)(&stack0xffffffffffffffe8 + lVar4) = &local_6c8;
    *(undefined8 **)(&stack0xffffffffffffffe0 + lVar4) = &local_e98;
    iVar18 = *(int *)(*(longlong *)((longlong)alStackX8 + lVar4 + 8) + 0xc);
    *(undefined8 *)((longlong)&uStack72 + lVar4) = 0x18002fa2d;
    uVar5 = FUN_18002f540(local_fc8,iVar18,uVar3,uVar19,
                          *(longlong *)(&stack0xffffffffffffffe0 + lVar4),
                          *(longlong *)(&stack0xffffffffffffffe8 + lVar4),
                          *(int **)(&stack0xfffffffffffffff0 + lVar4),
                          *(int *)(&stack0xfffffffffffffff8 + lVar4));
    piVar10 = *(int **)((longlong)aplStackX24 + lVar4 + 8);
    uVar19 = *(uint *)(&stack0x00000004 + lVar4);
    param_3 = *(uint **)(&stack0x00000038 + lVar4);
    param_1 = *(longlong *)((longlong)alStackX8 + lVar4 + 8);
    *local_fc0 = (int)uVar5;
  }
  *(undefined4 *)((longlong)aplStackX24 + lVar4 + -0x18) = 0;
  iVar18 = 0;
  if (lVar16 < 1) {
LAB_18002fea3:
    *(undefined8 *)((longlong)&uStack72 + lVar4) = 0x18002feb2;
    FUN_18005f100(local_50 ^ (ulonglong)(&stack0xffffffffffffffc0 + lVar4),
                  *(undefined *)((longlong)&uStack72 + lVar4));
    return;
  }
  local_fb0 = (undefined4 *)((longlong)local_fb0 - (longlong)piVar10);
  plVar12 = (longlong *)(param_1 + 0x28);
  local_fc0 = (undefined4 *)((longlong)local_fc0 - (longlong)piVar10);
  *(longlong **)((longlong)aplStackX24 + lVar4 + 8) = plVar12;
  piVar10 = piVar10 + 1;
  *(int **)((longlong)&param_6 + lVar4) = piVar10;
  puVar20 = local_fb0;
  local_fc8 = lVar16;
  local_fb8 = param_3;
LAB_18002fa90:
  puVar1 = local_fb0;
  puVar21 = (undefined4 *)0x0;
  *(undefined4 *)((longlong)puVar20 + (longlong)piVar10) = *(undefined4 *)(*plVar12 + 0x10c);
  lVar16 = 0x19;
  *piVar10 = 0;
  puVar6 = &local_6c8;
  do {
    *puVar6 = 0;
    puVar6[1] = 0;
    puVar6[2] = 0;
    puVar6[3] = 0;
    puVar6[4] = 0;
    puVar6[5] = 0;
    puVar6[6] = 0;
    puVar6[7] = 0;
    lVar16 = lVar16 + -1;
    puVar6 = puVar6 + 8;
  } while (lVar16 != 0);
  lVar16 = 0x1f;
  puVar6 = &local_e98;
  do {
    puVar7 = puVar6;
    *puVar7 = 0;
    puVar7[1] = 0;
    puVar7[2] = 0;
    puVar7[3] = 0;
    puVar7[4] = 0;
    puVar7[5] = 0;
    puVar7[6] = 0;
    puVar7[7] = 0;
    lVar16 = lVar16 + -1;
    puVar6 = puVar7 + 8;
  } while (lVar16 != 0);
  lVar8 = *(longlong *)((longlong)alStackX8 + lVar4 + 8);
  piVar10 = local_f68;
  puVar7[8] = 0;
  piVar17 = local_6c0 + 1;
  puVar7[9] = 0;
  piVar13 = (int *)((longlong)&local_e98 + 4);
  iVar26 = 0;
  *(undefined4 **)((longlong)&param_5 + lVar4) = (undefined4 *)0x0;
  plVar12 = (longlong *)(lVar8 + 0x28);
  iVar14 = 0;
  *(longlong **)((longlong)aplStackX24 + lVar4) = plVar12;
  lVar16 = *(longlong *)((longlong)alStackX8 + lVar4);
  puVar20 = puVar21;
  do {
    iVar23 = (int)puVar20;
    if (iVar14 == iVar18) {
      if (*(longlong *)(&stack0x00000038 + lVar4) != 0) {
        if (*local_fb8 < 0x80000000) {
          pauVar11 = (undefined (*) [16])
                     (*(longlong *)(&stack0x00000038 + lVar4) + 4 + (longlong)iVar18 * 0x1c);
          if ((pauVar11 != (undefined (*) [16])0x0) &&
             ((pauVar11[1] + 8 <= local_fa8 || ((undefined (*) [16])&local_f90 <= pauVar11)))) {
            local_fa8 = *pauVar11;
            local_f98 = *(undefined8 *)pauVar11[1];
          }
          if ((int)uVar3 < 1) {
            bVar2 = 0;
          }
          else {
            *(undefined8 **)(&stack0xffffffffffffffe0 + lVar4) = &local_e98 + iVar23;
            *(undefined8 *)((longlong)&uStack72 + lVar4) = 0x18002fbeb;
            bVar2 = FUN_180017ba0((longlong)&local_f90,(int *)local_fa8,uVar3,uVar19,
                                  *(undefined4 **)(&stack0xffffffffffffffe0 + lVar4));
            puVar21 = *(undefined4 **)((longlong)&param_5 + lVar4);
          }
          piVar9 = *(int **)((longlong)&param_6 + lVar4);
          iVar18 = *(int *)((longlong)aplStackX24 + lVar4 + -0x18);
          plVar12 = *(longlong **)((longlong)aplStackX24 + lVar4);
          piVar17[-2] = piVar13[2] - *piVar13;
          piVar17[-3] = piVar13[1] - piVar13[-1];
          *piVar17 = piVar13[4] - piVar13[2];
          piVar17[-1] = piVar13[3] - piVar13[1];
          piVar17[2] = piVar13[6] - piVar13[4];
          piVar17[1] = piVar13[5] - piVar13[3];
          piVar17[4] = piVar13[8] - piVar13[6];
          piVar17[3] = piVar13[7] - piVar13[5];
          *piVar9 = *piVar9 + (uint)bVar2;
          lVar16 = *(longlong *)((longlong)alStackX8 + lVar4);
          lVar8 = *(longlong *)((longlong)alStackX8 + lVar4 + 8);
          if (bVar2 == 1) {
            iVar26 = iVar26 + 1;
            *piVar10 = iVar14;
            piVar10 = piVar10 + 1;
          }
          goto LAB_18002fded;
        }
        lVar16 = *(longlong *)((longlong)alStackX8 + lVar4);
      }
      lVar8 = *(longlong *)((longlong)alStackX8 + lVar4 + 8);
    }
    else {
      if (iVar14 < iVar18) {
        lVar16 = (longlong)
                 (*(int *)(**(longlong **)((longlong)aplStackX24 + lVar4 + 8) + 0x104) + iVar14) *
                 0x1c;
        if (0x7fffffff < *(uint *)(lVar16 + 0x1b8 + lVar8)) {
LAB_18002fddc:
          lVar16 = *(longlong *)((longlong)alStackX8 + lVar4);
          goto LAB_18002fded;
        }
        piVar9 = (int *)(lVar16 + 0x1bc + lVar8);
        if (piVar9 != (int *)0x0) {
          *(undefined8 *)((longlong)&uStack72 + lVar4) = 0x18002fcbe;
          FUN_180023cd0(piVar9,(int *)local_fa8,*(undefined *)((longlong)&uStack72 + lVar4));
          puVar21 = *(undefined4 **)((longlong)&param_5 + lVar4);
        }
        if ((int)uVar3 < 1) goto LAB_18002fcfa;
        uVar19 = *(uint *)(&stack0x00000004 + lVar4);
LAB_18002fccd:
        *(undefined8 **)(&stack0xffffffffffffffe0 + lVar4) = &local_e98 + iVar23;
        *(undefined8 *)((longlong)&uStack72 + lVar4) = 0x18002fcf0;
        bVar2 = FUN_180017ba0((longlong)&local_f90,(int *)local_fa8,uVar3,uVar19,
                              *(undefined4 **)(&stack0xffffffffffffffe0 + lVar4));
        puVar21 = *(undefined4 **)((longlong)&param_5 + lVar4);
      }
      else {
        lVar16 = (longlong)(*(int *)(*plVar12 + 0x104) + iVar18) * 0x1c;
        if (0x7fffffff < *(uint *)(lVar16 + 0x1b8 + lVar8)) goto LAB_18002fddc;
        pauVar11 = (undefined (*) [16])(lVar16 + 0x1bc + lVar8);
        if ((pauVar11 != (undefined (*) [16])0x0) &&
           ((pauVar11[1] + 8 <= local_fa8 || ((undefined (*) [16])&local_f90 <= pauVar11)))) {
          local_fa8 = *pauVar11;
          local_f98 = *(undefined8 *)pauVar11[1];
        }
        if (0 < (int)uVar3) goto LAB_18002fccd;
LAB_18002fcfa:
        bVar2 = 0;
      }
      piVar9 = *(int **)((longlong)&param_6 + lVar4);
      iVar18 = *(int *)((longlong)aplStackX24 + lVar4 + -0x18);
      plVar12 = *(longlong **)((longlong)aplStackX24 + lVar4);
      lVar8 = *(longlong *)((longlong)alStackX8 + lVar4 + 8);
      piVar17[-2] = piVar13[2] - *piVar13;
      piVar17[-3] = piVar13[1] - piVar13[-1];
      *piVar17 = piVar13[4] - piVar13[2];
      piVar17[-1] = piVar13[3] - piVar13[1];
      piVar17[2] = piVar13[6] - piVar13[4];
      piVar17[1] = piVar13[5] - piVar13[3];
      piVar17[4] = piVar13[8] - piVar13[6];
      piVar17[3] = piVar13[7] - piVar13[5];
      *piVar9 = *piVar9 + (uint)bVar2;
      lVar16 = *(longlong *)((longlong)alStackX8 + lVar4);
      if (bVar2 == 1) {
        iVar26 = iVar26 + 1;
        *piVar10 = iVar14;
        piVar10 = piVar10 + 1;
      }
    }
LAB_18002fded:
    puVar21 = (undefined4 *)((longlong)puVar21 + 1);
    plVar12 = plVar12 + 1;
    iVar14 = iVar14 + 1;
    *(undefined4 **)((longlong)&param_5 + lVar4) = puVar21;
    puVar20 = (undefined4 *)(ulonglong)(iVar23 + 5);
    *(longlong **)((longlong)aplStackX24 + lVar4) = plVar12;
    piVar17 = piVar17 + 8;
    piVar13 = piVar13 + 10;
    if (lVar16 <= (longlong)puVar21) break;
    uVar19 = *(uint *)(&stack0x00000004 + lVar4);
  } while( true );
  plVar12 = *(longlong **)((longlong)aplStackX24 + lVar4 + 8);
  *(int *)(&stack0xfffffffffffffff8 + lVar4) = iVar26;
  *(int **)(&stack0xfffffffffffffff0 + lVar4) = local_f68;
  lVar16 = *plVar12;
  *(undefined8 **)(&stack0xffffffffffffffe8 + lVar4) = &local_6c8;
  *(undefined8 **)(&stack0xffffffffffffffe0 + lVar4) = &local_e98;
  iVar18 = *(int *)(*(longlong *)((longlong)alStackX8 + lVar4 + 8) + 0xc);
  *(undefined8 *)((longlong)&uStack72 + lVar4) = 0x18002fe58;
  uVar5 = FUN_18002f540(lVar16,iVar18,uVar3,*(uint *)(&stack0x00000004 + lVar4),
                        *(longlong *)(&stack0xffffffffffffffe0 + lVar4),
                        *(longlong *)(&stack0xffffffffffffffe8 + lVar4),
                        *(int **)(&stack0xfffffffffffffff0 + lVar4),
                        *(int *)(&stack0xfffffffffffffff8 + lVar4));
  piVar10 = *(int **)((longlong)&param_6 + lVar4);
  plVar12 = plVar12 + 1;
  iVar18 = *(int *)((longlong)aplStackX24 + lVar4 + -0x18) + 1;
  local_fb8 = local_fb8 + 7;
  uVar19 = *(uint *)(&stack0x00000004 + lVar4);
  *(int *)((longlong)local_fc0 + (longlong)piVar10) = (int)uVar5;
  piVar10 = piVar10 + 1;
  local_fc8 = local_fc8 + -1;
  bVar28 = local_fc8 == 0;
  *(int *)((longlong)aplStackX24 + lVar4 + -0x18) = iVar18;
  *(longlong **)((longlong)aplStackX24 + lVar4 + 8) = plVar12;
  *(int **)((longlong)&param_6 + lVar4) = piVar10;
  puVar20 = puVar1;
  if (bVar28) goto LAB_18002fea3;
  goto LAB_18002fa90;
}



void FUN_18002ff10(int *param_1,undefined4 *param_2,longlong param_3,undefined8 param_4,
                  undefined4 *param_5)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  int *piVar6;
  longlong lVar7;
  longlong lVar8;
  int local_48;
  undefined8 local_44;

  iVar1 = param_1[7];
  lVar8 = (longlong)iVar1;
  iVar2 = *(int *)(param_3 + 0x648);
  lVar7 = 0;
  local_48 = param_1[3];
  iVar3 = param_1[9];
  puVar5 = *(undefined4 **)(param_1 + lVar8 * 2 + 10);
  local_44 = 0;
  FUN_180018150(param_1,param_2,puVar5);
  uVar4 = *(undefined4 *)(*(longlong *)(param_1 + (longlong)iVar2 * 2 + 10) + 0x100);
  puVar5[0x47] = iVar1;
  puVar5[0x40] = uVar4;
  puVar5[0x41] = iVar3;
  puVar5[0x45] = 1;
  puVar5[0x49] = *(undefined4 *)(*(longlong *)(param_1 + (longlong)iVar2 * 2 + 10) + 0x124);
  puVar5[0x48] = 0;
  puVar5[0x4a] = *(undefined4 *)(*(longlong *)(param_1 + (longlong)iVar2 * 2 + 10) + 0x128);
  param_1[9] = param_1[9] + iVar1;
  param_1[7] = iVar1 + 1;
  if (0 < lVar8) {
    piVar6 = param_1 + (longlong)(int)puVar5[0x41] * 7 + 0x6e;
    do {
      lVar7 = lVar7 + 1;
      *piVar6 = -1;
      piVar6[1] = 0x100;
      piVar6[2] = 0;
      piVar6[3] = 0;
      *(undefined8 *)(piVar6 + 4) = 0x10000000000;
      piVar6[6] = 0;
      piVar6 = piVar6 + 7;
    } while (lVar7 < lVar8);
  }
  param_1[0x233f] = param_1[0x233f] + 1;
  param_1[lVar8 + 0x21fa] = iVar1;
  FUN_18002eb50(param_1,puVar5,&local_48);
  FUN_18002e530((longlong)param_1,0);
  *param_5 = 1;
  return;
}



void FUN_180030080(int *param_1,uint *param_2,longlong param_3,uint *param_4,undefined4 *param_5)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  uint *puVar8;
  ulonglong uVar9;
  uint uVar10;
  ulonglong uVar11;
  uint *puVar12;
  ulonglong uVar13;
  int iVar14;
  int iVar15;
  ulonglong uVar16;
  ulonglong uVar17;
  longlong lVar18;
  uint *puVar19;
  longlong lVar20;
  uint *puVar21;
  int local_2f8;
  uint *local_2f0;
  int local_2e8;
  undefined8 local_2e4;
  longlong *local_2d8;
  longlong local_2d0;
  undefined8 local_2c8;
  int local_1f8 [52];
  undefined4 local_128 [52];
  ulonglong local_58;

  local_58 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffcd8;
  uVar13 = 0;
  local_2e4 = 0;
  *param_5 = 0;
  local_2e8 = param_1[3];
  iVar14 = *(int *)(param_3 + 0x648);
  iVar1 = param_1[7];
  local_2f8 = param_1[8];
  local_2f0 = param_4;
  memset(&local_2c8,0,0xcc);
  memset(local_128,0,0xcc);
  memset(local_1f8,0,0xcc);
  local_2d8 = (longlong *)(param_1 + ((longlong)iVar14 + 5) * 2);
  local_2d0 = *local_2d8;
  FUN_18002eb50(param_1,param_2,&local_2e8);
  FUN_18002e530((longlong)param_1,(longlong)param_4);
  FUN_18002f770((longlong)param_1,(longlong)param_2,param_4,(undefined4 *)&local_2c8,local_128,
                local_1f8);
  uVar16 = 0xffffffff;
  iVar15 = -1;
  uVar11 = local_2c8 & 0xffffffff;
  uVar9 = uVar13;
  uVar17 = uVar13;
  if (0 < iVar1) {
    do {
      uVar6 = *(uint *)((longlong)&local_2c8 + uVar9 * 4 + 4);
      uVar10 = (uint)uVar11;
      if ((int)uVar10 < (int)uVar6) {
        uVar16 = uVar17;
      }
      iVar15 = (int)uVar16;
      uVar9 = uVar9 + 1;
      if ((int)uVar6 <= (int)uVar10) {
        uVar6 = uVar10;
      }
      uVar11 = (ulonglong)uVar6;
      uVar17 = (ulonglong)((int)uVar17 + 1);
    } while ((longlong)uVar9 < (longlong)iVar1);
  }
  if ((iVar15 < 0) || (param_1[8] <= iVar15)) {
    if (iVar15 == -1) {
      iVar7 = 0x5a;
      if (0x3b < *(int *)(*local_2d8 + 0x10c)) {
        iVar7 = 0x50;
      }
      iVar2 = *(int *)((longlong)&local_2c8 + (longlong)(iVar14 + 1) * 4);
      if (((0x5f < iVar2) && (0x32 < (int)param_2[0x43])) ||
         ((0x50 < (int)param_2[0x44] &&
          ((iVar5 = (int)local_2c8 * 9, SBORROW4(iVar5,iVar2 * 10) != iVar5 + iVar2 * -10 < 0 &&
           (iVar7 * *(int *)(*local_2d8 + 0x10c) < (int)(param_2[0x43] * 100))))))) {
        *param_5 = 3;
        iVar15 = iVar14;
      }
    }
  }
  else {
    *param_5 = 4;
  }
  if (param_1[0x2380] == 1) {
    if (iVar15 == -1) {
      FUN_180018d40(param_2,param_1,(longlong)(param_1 + 0x2344),param_1 + 0x236c);
      goto LAB_1800303e5;
    }
    FUN_180018d40(*(uint **)(param_1 + (longlong)iVar15 * 2 + 10),param_1,
                  (longlong)(param_1 + 0x2344),param_1 + 0x236c);
  }
  if (iVar15 != -1) {
    lVar20 = (longlong)iVar15;
    uVar3 = *(undefined4 *)(local_2d0 + 0x100);
    puVar4 = *(undefined4 **)(param_1 + lVar20 * 2 + 10);
    puVar4[0x48] = puVar4[0x48] + 1;
    puVar4[0x40] = uVar3;
    puVar4[0x49] = *(undefined4 *)(local_2d0 + 0x124);
    FUN_180018150(param_1,param_2,puVar4);
    puVar4[0x45] = 2;
    uVar9 = uVar13;
    if (0 < local_2f8) {
      do {
        iVar14 = *(int *)(*(longlong *)(param_1 + uVar9 * 2 + 10) + 0x11c);
        if ((int)puVar4[0x47] < iVar14) {
          *(int *)(*(longlong *)(param_1 + uVar9 * 2 + 10) + 0x11c) = iVar14 + -1;
        }
        uVar9 = uVar9 + 1;
      } while ((longlong)uVar9 < (longlong)local_2f8);
    }
    puVar4[0x47] = local_2f8 + -1;
    uVar9 = uVar13;
    puVar19 = local_2f0;
    puVar21 = local_2f0;
    if (0 < iVar1) {
      do {
        iVar14 = (int)uVar9;
        if ((longlong)uVar13 < lVar20) {
          puVar12 = (uint *)(param_1 + (longlong)(puVar4[0x41] + iVar14) * 7 + 0x6e);
          *puVar12 = *puVar21;
          puVar8 = puVar19 + (longlong)iVar14 * 7;
          if (((puVar12 != (uint *)0x0) && (puVar8 != (uint *)0x0)) &&
             ((puVar8 + 7 <= puVar12 || (puVar12 + 7 <= puVar8)))) {
            puVar12 = (uint *)((longlong)puVar12 - (longlong)puVar8);
            lVar18 = 0xe;
            do {
              *(undefined *)((longlong)puVar12 + (longlong)puVar8) = *(undefined *)puVar8;
              ((undefined *)((longlong)puVar12 + 1))[(longlong)puVar8] =
                   *(undefined *)((longlong)puVar8 + 1);
              puVar8 = (uint *)((longlong)puVar8 + 2);
              lVar18 = lVar18 + -1;
              puVar19 = local_2f0;
            } while (lVar18 != 0);
          }
        }
        else {
          if (lVar20 < (longlong)uVar13) {
            iVar7 = *(int *)(*(longlong *)(param_1 + uVar13 * 2 + 10) + 0x104);
            (param_1 + (longlong)(iVar7 + iVar15) * 7)[0x6e] = *puVar21;
            if (puVar19 + (longlong)iVar14 * 7 + 1 != (uint *)0x0) {
              FUN_180023cd0((int *)(puVar19 + (longlong)iVar14 * 7 + 1),
                            param_1 + (longlong)(iVar7 + iVar15) * 7 + 0x6f);
              puVar19 = local_2f0;
            }
          }
        }
        uVar13 = uVar13 + 1;
        uVar9 = (ulonglong)(iVar14 + 1);
        puVar21 = puVar21 + 7;
      } while ((longlong)uVar13 < (longlong)iVar1);
    }
    param_1[0x233e] = param_1[0x233e] + 1;
  }
LAB_1800303e5:
  FUN_18005f100(local_58 ^ (ulonglong)&stack0xfffffffffffffcd8);
  return;
}



void FUN_180030410(int *param_1,uint *param_2,longlong param_3,int *param_4,int param_5)

{
  undefined8 *puVar1;
  undefined8 uVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  uint uVar9;
  undefined8 *puVar10;
  undefined4 *puVar11;
  int *piVar12;
  ulonglong uVar13;
  longlong lVar14;
  undefined4 *puVar15;
  int iVar16;
  uint uVar17;
  ulonglong uVar18;
  uint *puVar19;
  ulonglong uVar20;
  uint *puVar21;
  ulonglong uVar22;
  longlong lVar23;
  undefined4 local_7b0;
  uint *local_7a0;
  int local_798;
  undefined8 local_794;
  int *local_788;
  undefined8 local_778 [26];
  undefined8 local_6a8 [26];
  uint local_5d8;
  undefined4 local_5d4 [351];
  ulonglong local_58;

  local_58 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffff828;
  iVar16 = -1;
  uVar9 = 0xffffffff;
  uVar3 = param_1[8];
  if (0 < (int)uVar3) {
    puVar19 = &local_5d8;
    uVar22 = (ulonglong)uVar3;
    puVar15 = local_5d4;
    puVar21 = (uint *)(param_3 + 0x1c);
    puVar11 = (undefined4 *)(param_3 + 4);
    do {
      *puVar19 = *puVar21;
      if (((puVar15 != (undefined4 *)0x0) && (puVar11 != (undefined4 *)0x0)) &&
         ((puVar11 + 6 <= puVar15 || (puVar15 + 6 <= puVar11)))) {
        uVar6 = puVar11[1];
        uVar7 = puVar11[2];
        uVar8 = puVar11[3];
        uVar2 = *(undefined8 *)(puVar11 + 4);
        *puVar15 = *puVar11;
        puVar15[1] = uVar6;
        puVar15[2] = uVar7;
        puVar15[3] = uVar8;
        *(undefined8 *)(puVar15 + 4) = uVar2;
      }
      puVar11 = puVar11 + 8;
      puVar15 = puVar15 + 7;
      puVar21 = puVar21 + 8;
      puVar19 = puVar19 + 7;
      uVar22 = uVar22 - 1;
    } while (uVar22 != 0);
  }
  uVar17 = param_1[7];
  lVar23 = (longlong)(int)uVar17;
  uVar22 = 0;
  local_7a0 = param_2;
  local_788 = param_4;
  if (uVar17 < uVar3) {
    puVar11 = *(undefined4 **)(param_1 + lVar23 * 2 + 10);
    local_798 = param_1[3];
    iVar4 = *(int *)(param_3 + 0x648);
    iVar5 = param_1[9];
    local_794 = 0;
    FUN_180018150(param_1,param_2,puVar11);
    uVar6 = *(undefined4 *)(*(longlong *)(param_1 + (longlong)iVar4 * 2 + 10) + 0x100);
    puVar11[0x47] = uVar17;
    puVar11[0x40] = uVar6;
    puVar11[0x41] = iVar5;
    puVar11[0x45] = 1;
    puVar11[0x49] = *(undefined4 *)(*(longlong *)(param_1 + (longlong)iVar4 * 2 + 10) + 0x124);
    puVar11[0x48] = 0;
    puVar11[0x4a] = *(undefined4 *)(*(longlong *)(param_1 + (longlong)iVar4 * 2 + 10) + 0x128);
    param_1[9] = param_1[9] + uVar17;
    param_1[7] = uVar17 + 1;
    if (0 < lVar23) {
      piVar12 = param_1 + (longlong)(int)puVar11[0x41] * 7 + 0x6e;
      uVar20 = uVar22;
      do {
        uVar20 = uVar20 + 1;
        *piVar12 = -1;
        piVar12[1] = 0x100;
        piVar12[2] = 0;
        piVar12[3] = 0;
        *(undefined8 *)(piVar12 + 4) = 0x10000000000;
        piVar12[6] = 0;
        piVar12 = piVar12 + 7;
      } while ((longlong)uVar20 < lVar23);
    }
    param_1[0x233f] = param_1[0x233f] + 1;
    local_7b0 = 1;
    param_1[lVar23 + 0x21fa] = uVar17;
    FUN_18002eb50(param_1,puVar11,&local_798);
    FUN_18002e530((longlong)param_1,0);
    *local_788 = 1;
    param_4 = local_788;
    uVar9 = uVar17;
  }
  else {
    if ((param_5 != 0) && (0xf < (int)param_2[0x43])) {
      uVar9 = FUN_180030080(param_1,param_2,param_3,&local_5d8,param_4);
    }
  }
  if ((param_1[0x21f9] == 0) || ((param_1[0x21f9] == 1 && (uVar9 == param_1[0x21f6])))) {
    lVar23 = (longlong)param_1[7];
    param_1[0x21f9] = 0;
    param_1[0x21f6] = -1;
    uVar20 = uVar22;
    if (0 < lVar23) {
      do {
        uVar13 = uVar20 + 1;
        *(undefined4 *)(*(longlong *)(param_1 + uVar20 * 2 + 10) + 0x100) = 0;
        uVar20 = uVar13;
      } while ((longlong)uVar13 < lVar23);
    }
    FUN_18002dda0((longlong)param_1,local_6a8,local_778);
    lVar14 = 3;
    puVar10 = local_778;
    do {
      *puVar10 = 0;
      puVar10[1] = 0;
      puVar10[2] = 0;
      puVar1 = puVar10 + 8;
      puVar10[3] = 0;
      puVar10[4] = 0;
      puVar10[5] = 0;
      puVar10[6] = 0;
      puVar10[7] = 0;
      lVar14 = lVar14 + -1;
      puVar10 = puVar1;
    } while (lVar14 != 0);
    *puVar1 = 0;
    uVar20 = uVar22;
    if (0 < lVar23) {
      do {
        uVar13 = uVar20 + 1;
        puVar10 = (undefined8 *)
                  ((longlong)local_778 + (longlong)*(int *)((longlong)local_6a8 + uVar20 * 4) * 4);
        *(int *)puVar10 = *(int *)puVar10 + 1;
        uVar20 = uVar13;
      } while ((longlong)uVar13 < lVar23);
    }
    uVar20 = uVar22;
    uVar13 = uVar22;
    uVar18 = uVar22;
    if (0 < lVar23) {
      do {
        uVar3 = *(uint *)((longlong)local_778 + uVar20 * 4);
        uVar17 = (uint)uVar18;
        uVar9 = uVar3;
        if ((int)uVar3 <= (int)uVar17) {
          uVar9 = uVar17;
        }
        if ((int)uVar17 < (int)uVar3) {
          iVar16 = (int)uVar13;
        }
        uVar20 = uVar20 + 1;
        uVar13 = (ulonglong)((int)uVar13 + 1);
        uVar18 = (ulonglong)uVar9;
      } while ((longlong)uVar20 < lVar23);
      if (1 < (int)uVar9) {
        param_1[0x21f9] = 1;
        param_1[0x21f6] = iVar16;
        *(undefined4 *)(*(longlong *)(param_1 + (longlong)iVar16 * 2 + 10) + 0x100) = 1;
        do {
          if (*(int *)((longlong)local_6a8 + uVar22 * 4) == iVar16) {
            *(undefined4 *)(*(longlong *)(param_1 + uVar22 * 2 + 10) + 0x100) = 1;
          }
          uVar22 = uVar22 + 1;
        } while ((longlong)uVar22 < lVar23);
      }
    }
  }
  if ((0 < *param_4) && (1 < *param_1 - 9U)) {
    FUN_180017490((longlong)param_1);
  }
  FUN_18005f100(local_58 ^ (ulonglong)&stack0xfffffffffffff828);
  return;
}



// WARNING: Removing unreachable block (ram,0x000180030b0a)
// WARNING: Could not reconcile some variable overlaps

void FUN_180030800(undefined8 *param_1,longlong param_2,int param_3,undefined8 *param_4,
                  undefined1 (*param_5) [9],int *param_6)

{
  code *pcVar1;
  undefined8 *puVar2;
  undefined8 uVar3;
  ulonglong uVar4;
  longlong lVar5;
  uint uVar6;
  ulonglong uVar7;
  int iVar8;
  longlong lVar9;
  ulonglong uVar10;
  ulonglong uVar11;
  longlong lVar12;
  int *piVar13;
  longlong lVar14;
  undefined uVar15;
  undefined2 uVar16;
  undefined4 uVar17;
  undefined8 uVar18;
  int iVar19;
  int iVar20;
  int iVar21;
  int iVar22;
  undefined8 uVar23;
  undefined auStack328 [32];
  uint local_128;
  undefined8 *local_120;
  longlong local_118;
  undefined8 *local_110;
  int *local_108;
  ulonglong local_100;
  undefined8 *local_f8;
  undefined8 *local_f0;
  longlong local_e8;
  undefined8 *local_e0;
  longlong local_d8;
  ulonglong local_d0;
  undefined8 *local_c8;
  ulonglong local_c0;
  longlong local_b8;
  int local_b0;
  int local_ac;
  int local_a8;
  int iStack164;
  int local_a0;
  int iStack156;
  undefined local_98 [8];
  undefined4 local_90;
  undefined4 uStack140;
  undefined8 local_88;
  undefined8 local_80;
  undefined8 local_78;
  undefined8 local_70;
  undefined8 local_68;
  undefined8 local_60;
  undefined8 local_58;
  undefined8 local_50;
  undefined8 local_48;
  undefined8 local_40;
  undefined4 local_38;
  undefined2 local_34;
  undefined local_32;
  undefined1 local_31;
  ulonglong local_30;

  local_30 = DAT_1800b04e8 ^ (ulonglong)auStack328;
  uVar17 = 0;
  uVar11 = 0;
  local_108 = param_6;
  *param_6 = 0x190000;
  uVar16 = 0;
  uVar15 = 0;
  local_50 = 0;
  local_48 = 0;
  local_40 = 0;
  local_38 = 0;
  local_34 = 0;
  local_32 = 0;
  local_128 = 0;
  local_120 = param_4;
  local_e8 = param_2;
  local_c8 = param_1;
  if (0 < param_3 + -2) {
    local_b8 = (longlong)(param_3 + -2);
    lVar14 = (longlong)param_3;
    lVar9 = (longlong)(param_3 + -1);
    local_c0 = uVar11;
    uVar23 = local_88;
    local_118 = lVar9;
    local_110 = param_1;
    do {
      local_c0 = local_c0 + 1;
      puVar2 = local_110;
      if ((longlong)local_c0 < lVar9) {
        local_e0 = local_110 + 1;
        lVar12 = param_2 - (longlong)param_1;
        local_d0 = local_c0;
        lVar5 = local_118;
        local_d8 = lVar12;
        do {
          local_100 = local_d0 + 1;
          local_d0 = local_100;
          if ((longlong)local_100 < lVar14) {
            local_f8 = (undefined8 *)((longlong)local_e0 + lVar12 + 8);
            local_f0 = (undefined8 *)((longlong)param_1 - param_2);
            do {
              local_68 = *puVar2;
              iVar8 = 0;
              uVar7 = 0;
              local_60 = *local_e0;
              local_58 = *(undefined8 *)((longlong)local_f8 + (longlong)local_f0);
              local_80 = *(undefined8 *)((longlong)local_110 + lVar12);
              local_78 = *(undefined8 *)(lVar12 + (longlong)local_e0);
              local_70 = *local_f8;
              FUN_1800231c0(&local_b0,(int *)&local_68,(longlong)&local_80);
              uVar11 = 0;
              if (0 < lVar14) {
                piVar13 = (int *)(local_e8 + 4);
                do {
                  if (0x1e < uVar11) {
                    __report_rangecheckfailure();
                    pcVar1 = (code *)swi(3);
                    (*pcVar1)();
                    return;
                  }
                  *(undefined *)((longlong)&local_50 + uVar11) = 0;
                  lVar9 = (longlong)
                          *(int *)((longlong)((longlong)piVar13 + -4) + (longlong)local_f0);
                  uVar10 = (local_b0 * lVar9 +
                            (longlong)local_ac *
                            (longlong)*(int *)((longlong)piVar13 + (longlong)local_f0) >> 8) +
                           (longlong)local_a8;
                  uVar4 = (iStack164 * lVar9 +
                           (longlong)local_a0 *
                           (longlong)*(int *)((longlong)piVar13 + (longlong)local_f0) >> 8) +
                          (longlong)iStack156;
                  if (((((longlong)
                         ((uVar10 ^ (longlong)uVar10 >> 0x3f) - ((longlong)uVar10 >> 0x3f)) <
                         0x100000000) &&
                       ((longlong)((uVar4 ^ (longlong)uVar4 >> 0x3f) - ((longlong)uVar4 >> 0x3f)) <
                        0x100000000)) &&
                      (uVar10 = uVar10 - (longlong)piVar13[-1],
                      (longlong)((uVar10 ^ (longlong)uVar10 >> 0x3f) - ((longlong)uVar10 >> 0x3f)) <
                      0x281)) &&
                     ((uVar4 = uVar4 - (longlong)*piVar13,
                      (longlong)((uVar4 ^ (longlong)uVar4 >> 0x3f) - ((longlong)uVar4 >> 0x3f)) <
                      0x281 && (lVar9 = uVar4 * uVar4 + uVar10 * uVar10, lVar9 < 0x64000)))) {
                    uVar7 = (ulonglong)((int)uVar7 + 1);
                    *(undefined *)((longlong)&local_50 + uVar11) = 1;
                    iVar8 = iVar8 + (int)lVar9;
                  }
                  uVar11 = uVar11 + 1;
                  piVar13 = piVar13 + 2;
                  uVar16 = local_34;
                  uVar15 = local_32;
                  uVar17 = local_38;
                } while ((longlong)uVar11 < lVar14);
              }
              uVar18 = CONCAT44(iStack156,local_a0);
              if ((local_120 != (undefined8 *)0x0) &&
                 ((local_98 <= local_120 || (local_120 + 3 <= &local_b0)))) {
                *(int *)local_120 = local_b0;
                *(int *)((longlong)local_120 + 4) = local_ac;
                *(int *)(local_120 + 1) = local_a8;
                *(int *)((longlong)local_120 + 0xc) = iStack164;
                local_120[2] = uVar18;
              }
              uVar6 = (uint)uVar7;
              if (uVar6 == 0) {
                iVar8 = 0x190000;
              }
              else {
                iVar8 = (((int)uVar6 >> 1) + iVar8) / (int)uVar6;
              }
              if (((int)local_128 < (int)uVar6) ||
                 ((uVar11 = (ulonglong)local_128, uVar6 == local_128 && (iVar8 < *local_108)))) {
                iVar19 = local_b0;
                iVar20 = local_ac;
                iVar21 = local_a8;
                iVar22 = iStack164;
                uVar3 = FUN_18003ba20();
                if ((int)uVar3 == 0) {
                  uVar11 = (ulonglong)local_128;
                }
                else {
                  *local_108 = iVar8;
                  _local_98 = CONCAT412(iVar22,CONCAT48(iVar21,CONCAT44(iVar20,iVar19)));
                  uVar11 = uVar7;
                  uVar23 = uVar18;
                  local_128 = uVar6;
                  if ((param_5 != (undefined1 (*) [9])0x0) &&
                     (((undefined1 (*) [9])&local_31 <= param_5 || (param_5[3] + 4 <= &local_50))))
                  {
                    *(undefined4 *)*param_5 = (undefined4)local_50;
                    *(undefined4 *)(*param_5 + 4) = local_50._4_4_;
                    *(undefined4 *)(*param_5 + 8) = (undefined4)local_48;
                    *(undefined4 *)(param_5[1] + 3) = local_48._4_4_;
                    *(undefined8 *)(param_5[1] + 7) = local_40;
                    *(undefined4 *)(param_5[2] + 6) = uVar17;
                    *(undefined2 *)(param_5[3] + 1) = uVar16;
                    param_5[3][3] = uVar15;
                  }
                }
              }
              local_100 = local_100 + 1;
              local_f8 = local_f8 + 1;
              puVar2 = local_110;
              lVar5 = local_118;
              param_2 = local_e8;
              param_1 = local_c8;
              param_4 = local_120;
              lVar12 = local_d8;
            } while ((longlong)local_100 < lVar14);
          }
          local_e0 = local_e0 + 1;
          lVar9 = local_118;
        } while ((longlong)local_d0 < lVar5);
      }
      local_110 = puVar2 + 1;
    } while ((longlong)local_c0 < local_b8);
    if ((int)uVar11 != 0) goto LAB_180030bf5;
  }
  local_88 = 0;
  uVar23 = 0;
  _local_98 = ZEXT816(0);
LAB_180030bf5:
  if ((param_4 != (undefined8 *)0x0) && ((&local_80 <= param_4 || (param_4 + 3 <= local_98)))) {
    *(undefined4 *)param_4 = local_98._0_4_;
    *(undefined4 *)((longlong)param_4 + 4) = local_98._4_4_;
    *(undefined4 *)(param_4 + 1) = local_90;
    *(undefined4 *)((longlong)param_4 + 0xc) = uStack140;
    param_4[2] = uVar23;
  }
  FUN_18005f100(local_30 ^ (ulonglong)auStack328);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180030c60(longlong param_1,longlong param_2,longlong param_3,longlong param_4,int param_5,
                  undefined8 *param_6,undefined1 (*param_7) [9],int *param_8,int param_9,
                  int param_10)

{
  code *pcVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  longlong lVar5;
  undefined8 uVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  uint uVar13;
  int iVar14;
  longlong lVar15;
  int iVar16;
  uint uVar17;
  ulonglong uVar18;
  int *piVar19;
  uint uVar20;
  bool bVar21;
  undefined8 uVar22;
  undefined8 uVar23;
  undefined auStack488 [32];
  int local_1c8;
  uint local_1c4;
  int local_1c0;
  int local_1bc;
  undefined (*local_1b8) [16];
  uint local_1b0;
  int local_1ac;
  int local_1a8;
  longlong local_1a0;
  int local_198;
  int local_194;
  int local_190;
  int local_18c;
  int local_188;
  longlong local_180;
  ulonglong local_178;
  ulonglong local_170;
  int *local_168;
  longlong local_160;
  undefined8 *local_158;
  int *local_150;
  longlong local_148;
  longlong local_140;
  longlong local_138;
  longlong local_130;
  ulonglong local_128;
  longlong local_120;
  ulonglong local_118;
  ulonglong local_110;
  undefined8 local_108;
  undefined8 local_100;
  undefined1 (*local_f8) [9];
  longlong local_f0;
  longlong local_e8;
  longlong local_e0;
  ulonglong local_d8;
  int local_d0;
  undefined8 local_c8;
  int local_c0;
  undefined local_b8 [8];
  int local_b0;
  int iStack172;
  undefined8 local_a8;
  int local_a0;
  int local_9c;
  int iStack152;
  int iStack148;
  int local_90;
  int iStack140;
  undefined4 local_88;
  int iStack132;
  int local_80;
  int iStack124;
  undefined8 local_78;
  int local_70;
  int iStack108;
  int local_68;
  int iStack100;
  undefined8 local_60;
  undefined8 local_58;
  undefined8 local_50;
  undefined8 local_48;
  uint local_40;
  undefined2 local_3c;
  undefined local_3a;
  undefined1 local_39;
  ulonglong local_38;

  local_38 = DAT_1800b04e8 ^ (ulonglong)auStack488;
  local_f8 = param_7;
  local_170 = 0;
  local_58 = 0;
  local_50 = 0;
  local_48 = 0;
  local_40 = 0;
  local_3c = 0;
  local_3a = 0;
  local_d8 = 0;
  local_d0 = 0;
  local_c8 = 0;
  local_c0 = 0;
  bVar21 = param_10 == 0;
  lVar5 = (longlong)param_5;
  local_168 = param_8;
  *param_8 = 0x190000;
  iVar7 = 0x400;
  if (bVar21) {
    iVar7 = 0x800;
  }
  local_1b8 = (undefined (*) [16])param_6;
  local_1ac = 0;
  iVar14 = 0x1922;
  if (bVar21) {
    iVar14 = 0x3244;
  }
  iVar4 = 0x3244;
  if (bVar21) {
    iVar4 = 0x6488;
  }
  local_198 = 0;
  local_1c8 = iVar4;
  local_1c0 = iVar7;
  local_1a0 = param_3;
  local_188 = iVar14;
  local_140 = param_2;
  local_138 = param_4;
  local_120 = param_1;
  if (0 < param_5 + -2) {
    local_18c = -iVar14;
    local_e0 = (longlong)(param_5 + -2);
    local_190 = param_5 + -1;
    local_e8 = 0;
    uVar23 = local_a8;
    local_180 = lVar5;
    do {
      local_128 = *(ulonglong *)(param_1 + local_e8 * 8);
      uVar18 = *(ulonglong *)(param_2 + local_e8 * 8);
      local_1b0 = *(int *)(param_3 + local_e8 * 4) - *(int *)(param_4 + local_e8 * 4);
      local_70 = (int)local_128;
      iStack108 = (int)(local_128 >> 0x20);
      local_88 = (undefined4)uVar18;
      iStack132 = (int)(uVar18 >> 0x20);
      if (iVar14 < (int)local_1b0) {
        local_1b0 = local_1b0 - iVar4;
      }
      if ((int)local_1b0 < local_18c) {
        local_1b0 = local_1b0 + iVar4;
      }
      local_d8 = local_d8 & 0xffffffff00000000 | (ulonglong)local_1b0;
      local_194 = local_198 + 1;
      local_130 = local_e8 + 1;
      local_198 = local_194;
      local_178 = uVar18;
      local_e8 = local_130;
      if (local_194 < local_190) {
        local_118 = local_128 >> 0x20;
        local_110 = uVar18 >> 0x20;
        do {
          local_108 = *(undefined8 *)(param_1 + local_130 * 8);
          local_100 = *(undefined8 *)(param_2 + local_130 * 8);
          local_68 = (int)local_108;
          iVar8 = (int)local_128 - local_68;
          local_80 = (int)local_100;
          iStack124 = (int)((ulonglong)local_100 >> 0x20);
          iStack100 = (int)((ulonglong)local_108 >> 0x20);
          iVar10 = (((int)local_118 - iStack100) * ((int)local_118 - iStack100) >> 2) +
                   (iVar8 * iVar8 >> 2);
          iVar9 = (int)uVar18 - local_80;
          iVar8 = iVar10 * 5;
          iVar9 = (((int)local_110 - iStack124) * ((int)local_110 - iStack124) >> 2) +
                  (iVar9 * iVar9 >> 2);
          if ((((iVar8 == iVar9 * 6 || SBORROW4(iVar8,iVar9 * 6) != iVar8 + iVar9 * -6 < 0) &&
               (SBORROW4(iVar10 * 6,iVar9 * 5) == iVar10 * 6 + iVar9 * -5 < 0)) &&
              (0x2ffff < iVar10)) && (0x2ffff < iVar9)) {
            local_1c4 = *(int *)(local_1a0 + local_130 * 4) - *(int *)(param_4 + local_130 * 4);
            if (iVar14 < (int)local_1c4) {
              local_1c4 = local_1c4 - iVar4;
            }
            if ((int)local_1c4 < local_18c) {
              local_1c4 = local_1c4 + iVar4;
            }
            local_d8 = local_d8 & 0xffffffff | (ulonglong)local_1c4 << 0x20;
            local_160 = local_130 + 1;
            uVar18 = local_178;
            if (local_160 < lVar5) {
              local_158 = (undefined8 *)(param_2 + local_160 * 8);
              iVar8 = -iVar14;
              local_148 = local_120 - param_2;
              local_150 = (int *)(local_138 + local_160 * 4);
              local_f0 = local_1a0 - local_138;
              uVar20 = local_1c4;
              local_1bc = iVar8;
              do {
                uVar22 = *(undefined8 *)((longlong)local_158 + local_148);
                iVar9 = 0;
                uVar6 = *local_158;
                local_d0 = *(int *)(local_f0 + (longlong)local_150) - *local_150;
                local_1a8 = 0;
                local_60 = uVar22;
                local_78 = uVar6;
                if (iVar14 < local_d0) {
                  local_d0 = local_d0 - iVar4;
                }
                if (local_d0 < iVar8) {
                  local_d0 = local_d0 + iVar4;
                }
                lVar5 = (longlong)(int)(local_1b0 + uVar20 + local_d0);
                uVar18 = lVar5 / 3 + (lVar5 >> 0x3f) & 0xffffffff;
                iVar11 = (int)uVar18 + (int)(uVar18 >> 0x1f);
                iVar10 = -iVar11;
                iVar16 = local_1b0 + iVar10;
                if ((((iVar7 < iVar16) || (iVar10 = iVar10 + uVar20, iVar7 < iVar10)) ||
                    ((iVar11 = local_d0 - iVar11, iVar7 < iVar11 ||
                     ((iVar3 = -iVar7, SBORROW4(iVar16,iVar3) != iVar16 + iVar7 < 0 ||
                      (SBORROW4(iVar10,iVar3) != iVar10 + iVar7 < 0)))))) ||
                   (SBORROW4(iVar11,iVar3) != iVar11 + iVar7 < 0)) {
                  if (param_10 != 0) {
                    lVar5 = 0;
                    lVar15 = 3;
                    do {
                      iVar10 = *(int *)((longlong)&local_d8 + lVar5) + iVar14;
                      *(int *)((longlong)&local_c8 + lVar5) = iVar10;
                      if (iVar14 < iVar10) {
                        iVar10 = iVar10 - iVar4;
                        *(int *)((longlong)&local_c8 + lVar5) = iVar10;
                      }
                      if (iVar10 < iVar8) {
                        *(int *)((longlong)&local_c8 + lVar5) = iVar4 + iVar10;
                      }
                      lVar5 = lVar5 + 4;
                      lVar15 = lVar15 + -1;
                    } while (lVar15 != 0);
                    lVar5 = (longlong)(local_c8._4_4_ + local_c0 + (int)local_c8);
                    uVar18 = lVar5 / 3 + (lVar5 >> 0x3f) & 0xffffffff;
                    iVar10 = (int)uVar18 + (int)(uVar18 >> 0x1f);
                    local_c8._0_4_ = (int)local_c8 - iVar10;
                    iVar4 = local_1c8;
                    if ((((((int)local_c8 <= iVar7) &&
                          (local_c8._4_4_ = local_c8._4_4_ - iVar10, local_c8._4_4_ <= iVar7)) &&
                         (iVar10 = local_c0 - iVar10, iVar10 <= iVar7)) &&
                        ((iVar11 = -iVar7,
                         SBORROW4((int)local_c8,iVar11) == (int)local_c8 + iVar7 < 0 &&
                         (SBORROW4(local_c8._4_4_,iVar11) == local_c8._4_4_ + iVar7 < 0)))) &&
                       (SBORROW4(iVar10,iVar11) == iVar10 + iVar7 < 0)) goto LAB_180031071;
                  }
                }
                else {
LAB_180031071:
                  iVar11 = -(int)uVar22;
                  iVar4 = (int)local_128 + iVar11;
                  iVar10 = iStack108 + -local_60._4_4_;
                  iVar16 = -(int)uVar6;
                  iVar12 = iStack132 + -local_78._4_4_;
                  iVar3 = (iVar10 * iVar10 >> 2) + (iVar4 * iVar4 >> 2);
                  iVar4 = (int)local_178 + iVar16;
                  iVar12 = (iVar12 * iVar12 >> 2) + (iVar4 * iVar4 >> 2);
                  iVar10 = iVar3 * 5;
                  iVar4 = local_1c8;
                  if (((iVar10 == iVar12 * 6 ||
                        SBORROW4(iVar10,iVar12 * 6) != iVar10 + iVar12 * -6 < 0) &&
                      (SBORROW4(iVar3 * 6,iVar12 * 5) == iVar3 * 6 + iVar12 * -5 < 0)) &&
                     ((0x2ffff < iVar3 && (0x2ffff < iVar12)))) {
                    iVar11 = (int)local_108 + iVar11;
                    iVar4 = iStack100 + -local_60._4_4_;
                    iVar3 = iStack124 + -local_78._4_4_;
                    iVar16 = (int)local_100 + iVar16;
                    iVar11 = iVar4 * iVar4 + iVar11 * iVar11 >> 2;
                    iVar10 = iVar11 * 5;
                    iVar16 = iVar3 * iVar3 + iVar16 * iVar16 >> 2;
                    iVar4 = local_1c8;
                    if ((((iVar10 == iVar16 * 6 ||
                           SBORROW4(iVar10,iVar16 * 6) != iVar10 + iVar16 * -6 < 0) &&
                         (SBORROW4(iVar11 * 6,iVar16 * 5) == iVar11 * 6 + iVar16 * -5 < 0)) &&
                        (0x2ffff < iVar11)) && (0x2ffff < iVar16)) {
                      FUN_1800231c0(&local_a0,&local_70,(longlong)&local_88);
                      piVar2 = local_168;
                      param_6 = (undefined8 *)local_1b8;
                      iVar10 = local_a0 - local_90;
                      if (iVar10 < 0) {
                        iVar10 = local_90 - local_a0;
                      }
                      iVar7 = local_1c0;
                      iVar4 = local_1c8;
                      if (iVar10 < 0x32) {
                        iVar10 = iStack148 + local_9c;
                        if (iVar10 < 0) {
                          iVar10 = -iVar10;
                        }
                        uVar20 = local_1c4;
                        iVar8 = local_1bc;
                        if (iVar10 < 0x32) {
                          iVar10 = local_a0;
                          if (local_a0 < 0) {
                            iVar10 = -local_a0;
                          }
                          if (iVar10 < 300) {
                            iVar10 = iStack148;
                            if (iStack148 < 0) {
                              iVar10 = -iStack148;
                            }
                            if (iVar10 < 300) {
                              iVar10 = local_90;
                              if (local_90 < 0) {
                                iVar10 = -local_90;
                              }
                              if (iVar10 < 300) {
                                iVar10 = local_9c;
                                if (local_9c < 0) {
                                  iVar10 = -local_9c;
                                }
                                if (iVar10 < 300) {
                                  iVar10 = 0;
                                  uVar18 = 0;
                                  if (local_180 < 1) {
                                    uVar13 = (uint)local_170;
                                  }
                                  else {
                                    piVar19 = (int *)(local_140 + 4);
                                    iVar10 = 0;
                                    do {
                                      if (0x1e < uVar18) {
                                        __report_rangecheckfailure();
                                        pcVar1 = (code *)swi(3);
                                        (*pcVar1)();
                                        return;
                                      }
                                      *(undefined *)((longlong)&local_58 + uVar18) = 0;
                                      lVar5 = (longlong)*(int *)(local_148 + -4 + (longlong)piVar19)
                                      ;
                                      uVar17 = ((int)((ulonglong)
                                                      ((longlong)local_9c *
                                                       (longlong)
                                                       *(int *)(local_148 + (longlong)piVar19) +
                                                      local_a0 * lVar5 + 0x80) >> 8) - piVar19[-1])
                                               + iStack152;
                                      uVar13 = ((int)((ulonglong)
                                                      ((longlong)
                                                       *(int *)(local_148 + (longlong)piVar19) *
                                                       (longlong)local_90 + 0x80 + iStack148 * lVar5
                                                      ) >> 8) - *piVar19) + iStack140;
                                      if ((((int)((uVar17 ^ (int)uVar17 >> 0x1f) -
                                                 ((int)uVar17 >> 0x1f)) < 0x281) &&
                                          ((int)((uVar13 ^ (int)uVar13 >> 0x1f) -
                                                ((int)uVar13 >> 0x1f)) < 0x281)) &&
                                         (iVar14 = uVar13 * uVar13 + uVar17 * uVar17,
                                         iVar14 < 0x64000)) {
                                        local_1a8 = local_1a8 + 1;
                                        iVar10 = iVar10 + iVar14;
                                        *(undefined *)((longlong)&local_58 + uVar18) = 1;
                                      }
                                      uVar18 = uVar18 + 1;
                                      piVar19 = piVar19 + 2;
                                    } while ((longlong)uVar18 < local_180);
                                    local_170 = (ulonglong)local_40;
                                    iVar14 = local_188;
                                    iVar9 = local_1a8;
                                    uVar13 = local_40;
                                  }
                                  if (param_9 <= iVar9) {
                                    uVar22 = CONCAT44(iStack140,local_90);
                                    if ((local_1b8 != (undefined (*) [16])0x0) &&
                                       (((undefined (*) [16])&local_88 <= local_1b8 ||
                                        (local_1b8[1] + 8 <= &local_a0)))) {
                                      *(int *)*local_1b8 = local_a0;
                                      *(int *)(*local_1b8 + 4) = local_9c;
                                      *(int *)(*local_1b8 + 8) = iStack152;
                                      *(int *)(*local_1b8 + 0xc) = iStack148;
                                      *(undefined8 *)local_1b8[1] = uVar22;
                                    }
                                    if (iVar9 == 0) {
                                      iVar7 = 0x190000;
                                    }
                                    else {
                                      iVar7 = ((iVar9 >> 1) + iVar10) / iVar9;
                                    }
                                    if (((local_1ac < iVar9) ||
                                        ((iVar9 == local_1ac && (iVar7 < *local_168)))) &&
                                       (iVar4 = local_a0, iVar8 = local_9c, iVar10 = iStack152,
                                       iVar11 = iStack148, uVar6 = FUN_18003ba20(), (int)uVar6 != 0)
                                       ) {
                                      *piVar2 = iVar7;
                                      _local_b8 = CONCAT412(iVar11,CONCAT48(iVar10,CONCAT44(iVar8,
                                                  iVar4)));
                                      param_6 = (undefined8 *)local_1b8;
                                      local_b8._0_4_ = iVar4;
                                      local_b8._4_4_ = iVar8;
                                      local_b0 = iVar10;
                                      iStack172 = iVar11;
                                      uVar23 = uVar22;
                                      local_1ac = iVar9;
                                      if ((local_f8 != (undefined1 (*) [9])0x0) &&
                                         (((undefined1 (*) [9])&local_39 <= local_f8 ||
                                          (local_f8[3] + 4 <= &local_58)))) {
                                        *(undefined4 *)*local_f8 = (undefined4)local_58;
                                        *(undefined4 *)(*local_f8 + 4) = local_58._4_4_;
                                        *(undefined4 *)(*local_f8 + 8) = (undefined4)local_50;
                                        *(undefined4 *)(local_f8[1] + 3) = local_50._4_4_;
                                        *(undefined8 *)(local_f8[1] + 7) = local_48;
                                        *(uint *)(local_f8[2] + 6) = uVar13;
                                        *(undefined2 *)(local_f8[3] + 1) = local_3c;
                                        local_f8[3][3] = local_3a;
                                      }
                                    }
                                    iVar7 = local_1c0;
                                    uVar20 = local_1c4;
                                    iVar8 = local_1bc;
                                    iVar4 = local_1c8;
                                    if (0x14 < local_1ac) goto LAB_1800314f1;
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
                local_160 = local_160 + 1;
                local_158 = local_158 + 1;
                local_150 = local_150 + 1;
                param_2 = local_140;
                lVar5 = local_180;
                param_4 = local_138;
                uVar18 = local_178;
              } while (local_160 < local_180);
            }
          }
          local_194 = local_194 + 1;
          local_130 = local_130 + 1;
          param_1 = local_120;
          param_3 = local_1a0;
        } while (local_130 < local_190);
      }
    } while (local_e8 < local_e0);
    if (local_1ac != 0) goto LAB_1800314f1;
  }
  _local_b8 = ZEXT816(0);
  local_b8._0_4_ = 0;
  local_b8._4_4_ = 0;
  local_b0 = 0;
  iStack172 = 0;
  local_a8 = 0;
  uVar23 = 0;
LAB_1800314f1:
  if (((undefined (*) [16])param_6 != (undefined (*) [16])0x0) &&
     (((undefined (*) [16])&local_a0 <= param_6 ||
      (*(undefined (*) [16])((longlong)param_6 + 0x10) + 8 <= local_b8)))) {
    *(undefined (*) [16])param_6 =
         CONCAT412(iStack172,CONCAT48(local_b0,CONCAT44(local_b8._4_4_,local_b8._0_4_)));
    *(undefined8 *)*(undefined (*) [16])((longlong)param_6 + 0x10) = uVar23;
  }
  FUN_18005f100(local_38 ^ (ulonglong)auStack488);
  return;
}



ulonglong FUN_180031550(longlong param_1,uint *param_2,int param_3)

{
  uint *puVar1;
  uint uVar2;
  longlong lVar3;
  longlong lVar4;
  ulonglong uVar5;
  uint uVar6;

  uVar6 = 0;
  lVar4 = (longlong)param_3;
  if (0 < param_3) {
    lVar3 = param_1 - (longlong)param_2;
    do {
      uVar2 = *param_2;
      puVar1 = (uint *)(lVar3 + (longlong)param_2);
      param_2 = param_2 + 1;
      uVar5 = SEXT48((int)(*puVar1 ^ uVar2));
      uVar6 = uVar6 + *(int *)(&DAT_18007c6f0 + ((longlong)uVar5 >> 0x18 & 0xffU) * 4) +
                      *(int *)(&DAT_18007c6f0 + ((longlong)uVar5 >> 0x10 & 0xffU) * 4) +
                      *(int *)(&DAT_18007c6f0 + ((longlong)uVar5 >> 8 & 0xffU) * 4) +
                      *(int *)(&DAT_18007c6f0 + (uVar5 & 0xff) * 4);
      lVar4 = lVar4 + -1;
    } while (lVar4 != 0);
  }
  return (ulonglong)uVar6;
}



void FUN_1800315e0(longlong param_1,longlong param_2,longlong param_3,longlong param_4,
                  longlong param_5,longlong param_6,int *param_7,uint param_8,int param_9,
                  uint param_10,int param_11)

{
  uint *puVar1;
  ushort uVar2;
  int iVar3;
  int iVar4;
  longlong lVar5;
  longlong lVar6;
  ulonglong uVar7;
  int *piVar8;
  int iVar9;
  int iVar10;
  uint uVar11;
  uint *puVar12;
  longlong lVar13;
  longlong lVar14;
  ulonglong uVar15;
  ushort *puVar16;
  int *piVar17;
  longlong lVar18;
  ulonglong uVar19;
  longlong lVar20;
  int iVar21;
  ulonglong uVar22;

  uVar19 = SEXT48((int)param_8);
  iVar3 = *param_7;
  iVar4 = param_7[1];
  if ((int)param_8 < param_9) {
    lVar14 = param_4 - param_3;
    uVar7 = SEXT48((int)param_10);
    puVar16 = (ushort *)(uVar19 * 0x38 + param_1);
    piVar17 = (int *)(param_3 + 4 + uVar19 * 8);
    lVar6 = (param_4 + 0x5a0) - param_3;
    uVar15 = uVar7;
    do {
      uVar2 = *puVar16;
      uVar22 = uVar15 & 0xffffffff;
      uVar11 = (uint)uVar19;
      if ((int)uVar15 < param_11) {
        lVar5 = param_6 - param_5;
        lVar18 = uVar7 * 0x38 + 0x10 + param_2;
        piVar8 = (int *)(param_5 + 4 + uVar7 * 8);
        do {
          iVar9 = 0;
          lVar13 = lVar18 - (longlong)(puVar16 + 8);
          uVar19 = 2;
          puVar12 = (uint *)(puVar16 + 8);
          do {
            uVar11 = *puVar12;
            puVar1 = (uint *)(lVar13 + (longlong)puVar12);
            puVar12 = puVar12 + 1;
            uVar15 = SEXT48((int)(*puVar1 ^ uVar11));
            iVar9 = iVar9 + *(int *)(&DAT_18007c6f0 + ((longlong)uVar15 >> 0x18 & 0xffU) * 4) +
                            *(int *)(&DAT_18007c6f0 + ((longlong)uVar15 >> 0x10 & 0xffU) * 4) +
                            *(int *)(&DAT_18007c6f0 + ((longlong)uVar15 >> 8 & 0xffU) * 4) +
                            *(int *)(&DAT_18007c6f0 + (uVar15 & 0xff) * 4);
            uVar19 = uVar19 - 1;
          } while (uVar19 != 0);
          iVar21 = (int)uVar22;
          if (iVar9 <= iVar3) {
            puVar12 = (uint *)(puVar16 + 0xc);
            lVar20 = 2;
            do {
              uVar11 = *puVar12;
              puVar1 = (uint *)(lVar13 + (longlong)puVar12);
              puVar12 = puVar12 + 1;
              uVar15 = SEXT48((int)(*puVar1 ^ uVar11));
              uVar11 = (int)uVar19 +
                       *(int *)(&DAT_18007c6f0 + ((longlong)uVar15 >> 0x18 & 0xffU) * 4) +
                       *(int *)(&DAT_18007c6f0 + ((longlong)uVar15 >> 0x10 & 0xffU) * 4) +
                       *(int *)(&DAT_18007c6f0 + ((longlong)uVar15 >> 8 & 0xffU) * 4) +
                       *(int *)(&DAT_18007c6f0 + (uVar15 & 0xff) * 4);
              uVar19 = (ulonglong)uVar11;
              lVar20 = lVar20 + -1;
            } while (lVar20 != 0);
            iVar9 = uVar11 + iVar9;
            if (iVar9 <= iVar4) {
              iVar10 = 0;
              puVar12 = (uint *)(puVar16 + 0x10);
              lVar20 = 2;
              do {
                uVar11 = *puVar12;
                puVar1 = (uint *)(lVar13 + (longlong)puVar12);
                puVar12 = puVar12 + 1;
                uVar19 = SEXT48((int)(*puVar1 ^ uVar11));
                iVar10 = iVar10 + *(int *)(&DAT_18007c6f0 + ((longlong)uVar19 >> 0x18 & 0xffU) * 4)
                                  + *(int *)(&DAT_18007c6f0 + ((longlong)uVar19 >> 0x10 & 0xffU) * 4
                                            ) +
                                  *(int *)(&DAT_18007c6f0 + ((longlong)uVar19 >> 8 & 0xffU) * 4) +
                                  *(int *)(&DAT_18007c6f0 + (uVar19 & 0xff) * 4);
                lVar20 = lVar20 + -1;
              } while (lVar20 != 0);
              iVar9 = iVar9 + iVar10;
              if (iVar9 < piVar17[-1]) {
                *piVar17 = piVar17[-1];
                *(undefined4 *)(lVar14 + (longlong)piVar17) =
                     *(undefined4 *)((longlong)piVar17 + lVar14 + -4);
                piVar17[-1] = iVar9;
                *(int *)((longlong)piVar17 + lVar14 + -4) = iVar21;
              }
              else {
                if (iVar9 < *piVar17) {
                  *piVar17 = iVar9;
                  *(int *)(lVar14 + (longlong)piVar17) = iVar21;
                }
              }
              iVar10 = param_7[4];
              if (((0 < iVar10) && ((int)(uint)(uVar2 >> 2) < iVar10)) &&
                 ((int)(uint)(*(ushort *)(lVar18 + -0x10) >> 2) < iVar10)) {
                if (iVar9 < piVar17[0x167]) {
                  piVar17[0x168] = piVar17[0x167];
                  *(undefined4 *)(lVar6 + (longlong)piVar17) =
                       *(undefined4 *)(lVar6 + -4 + (longlong)piVar17);
                  piVar17[0x167] = iVar9;
                  *(int *)(lVar6 + -4 + (longlong)piVar17) = iVar21;
                }
                else {
                  if (iVar9 < piVar17[0x168]) {
                    piVar17[0x168] = iVar9;
                    *(int *)(lVar6 + (longlong)piVar17) = iVar21;
                  }
                }
              }
              if (iVar9 < piVar8[-1]) {
                *piVar8 = piVar8[-1];
                piVar8[-1] = iVar9;
                *(undefined4 *)(lVar5 + (longlong)piVar8) =
                     *(undefined4 *)(lVar5 + -4 + (longlong)piVar8);
                *(uint *)(lVar5 + -4 + (longlong)piVar8) = param_8;
              }
              else {
                if (iVar9 < *piVar8) {
                  *piVar8 = iVar9;
                  *(uint *)(lVar5 + (longlong)piVar8) = param_8;
                }
              }
            }
          }
          uVar22 = (ulonglong)(iVar21 + 1U);
          lVar18 = lVar18 + 0x38;
          piVar8 = piVar8 + 2;
        } while ((int)(iVar21 + 1U) < param_11);
        uVar15 = (ulonglong)param_10;
        uVar11 = param_8;
      }
      param_8 = uVar11 + 1;
      uVar19 = (ulonglong)param_8;
      puVar16 = puVar16 + 0x1c;
      piVar17 = piVar17 + 2;
    } while ((int)param_8 < param_9);
  }
  return;
}



void FUN_1800319a0(longlong param_1,longlong param_2,longlong param_3,longlong param_4,
                  longlong param_5,longlong param_6,longlong param_7)

{
  uint *puVar1;
  uint uVar2;
  longlong lVar3;
  longlong lVar4;
  int iVar5;
  longlong lVar6;
  uint *puVar7;
  ulonglong uVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int *piVar13;
  uint *local_98;
  int local_90;
  longlong local_88;
  int local_80;
  int local_7c;
  longlong local_78;
  longlong local_70;
  longlong local_68;
  longlong local_60;
  longlong local_58;
  undefined8 local_50;
  undefined8 local_48;
  ulonglong local_40;

  local_40 = DAT_1800b04e8 ^ (ulonglong)&local_98;
  local_80 = *(int *)(param_3 + 0x18);
  lVar3 = (longlong)*(int *)(param_3 + 8);
  local_58 = (longlong)*(int *)(param_3 + 0x14);
  local_90 = *(int *)(param_3 + 0x1c);
  local_7c = *(int *)(param_3 + 0x10);
  local_48 = 0;
  local_50 = 0;
  if (lVar3 < *(int *)(param_3 + 0xc)) {
    local_78 = param_5 - param_4;
    local_60 = param_6 - param_7;
    local_88 = lVar3 * 0xb4 + param_7;
    piVar13 = (int *)(param_4 + 4 + lVar3 * 8);
    local_98 = (uint *)(param_1 + 0x10 + lVar3 * 0x38);
    local_70 = *(int *)(param_3 + 0xc) - lVar3;
    do {
      local_48 = CONCAT44(local_98[6],local_98[4]);
      lVar3 = (longlong)local_7c;
      if (lVar3 < local_58) {
        lVar4 = param_2 + 0x10 + lVar3 * 0x38;
        iVar12 = local_7c;
        do {
          iVar10 = 0;
          lVar6 = 2;
          puVar7 = local_98;
          do {
            uVar2 = *puVar7;
            puVar1 = (uint *)((lVar4 - (longlong)local_98) + (longlong)puVar7);
            puVar7 = puVar7 + 1;
            uVar8 = SEXT48((int)(*puVar1 ^ uVar2));
            iVar10 = iVar10 + *(int *)(&DAT_18007c6f0 + ((longlong)uVar8 >> 0x18 & 0xffU) * 4) +
                              *(int *)(&DAT_18007c6f0 + ((longlong)uVar8 >> 0x10 & 0xffU) * 4) +
                              *(int *)(&DAT_18007c6f0 + ((longlong)uVar8 >> 8 & 0xffU) * 4) +
                              *(int *)(&DAT_18007c6f0 + (uVar8 & 0xff) * 4);
            lVar6 = lVar6 + -1;
          } while (lVar6 != 0);
          if (iVar10 <= local_80) {
            iVar9 = 0;
            puVar7 = local_98 + 2;
            lVar6 = 2;
            do {
              uVar2 = *puVar7;
              puVar1 = (uint *)((lVar4 - (longlong)local_98) + (longlong)puVar7);
              puVar7 = puVar7 + 1;
              uVar8 = SEXT48((int)(*puVar1 ^ uVar2));
              iVar9 = iVar9 + *(int *)(&DAT_18007c6f0 + ((longlong)uVar8 >> 0x18 & 0xffU) * 4) +
                              *(int *)(&DAT_18007c6f0 + ((longlong)uVar8 >> 0x10 & 0xffU) * 4) +
                              *(int *)(&DAT_18007c6f0 + ((longlong)uVar8 >> 8 & 0xffU) * 4) +
                              *(int *)(&DAT_18007c6f0 + (uVar8 & 0xff) * 4);
              lVar6 = lVar6 + -1;
            } while (lVar6 != 0);
            iVar5 = iVar9 + iVar10;
            iVar10 = (iVar10 - iVar9) + 0x40;
            if (local_90 < iVar5) {
              if (local_90 < iVar10) goto LAB_180031d00;
              if (iVar5 <= local_90) goto LAB_180031ba2;
              iVar9 = 0xc0;
            }
            else {
LAB_180031ba2:
              iVar9 = 0;
              lVar6 = 0;
              local_50 = CONCAT44(*(undefined4 *)(lVar4 + 0x18),*(undefined4 *)(lVar4 + 0x10));
              do {
                puVar7 = (uint *)((longlong)&local_48 + lVar6);
                puVar1 = (uint *)((longlong)&local_50 + lVar6);
                lVar6 = lVar6 + 4;
                uVar8 = SEXT48((int)(*puVar1 ^ *puVar7));
                iVar9 = iVar9 + *(int *)(&DAT_18007c6f0 + ((longlong)uVar8 >> 0x18 & 0xffU) * 4) +
                                *(int *)(&DAT_18007c6f0 + ((longlong)uVar8 >> 0x10 & 0xffU) * 4) +
                                *(int *)(&DAT_18007c6f0 + ((longlong)uVar8 >> 8 & 0xffU) * 4) +
                                *(int *)(&DAT_18007c6f0 + (uVar8 & 0xff) * 4);
              } while (lVar6 < 8);
            }
            if (local_90 < iVar10) {
              iVar11 = 0xc0;
            }
            else {
              iVar11 = 0;
              lVar6 = 0;
              local_50 = CONCAT44(*(undefined4 *)(lVar4 + 0x20),*(undefined4 *)(lVar4 + 0x14));
              do {
                puVar7 = (uint *)((longlong)&local_48 + lVar6);
                puVar1 = (uint *)((longlong)&local_50 + lVar6);
                lVar6 = lVar6 + 4;
                uVar8 = SEXT48((int)(*puVar1 ^ *puVar7));
                iVar11 = iVar11 + *(int *)(&DAT_18007c6f0 + ((longlong)uVar8 >> 0x18 & 0xffU) * 4) +
                                  *(int *)(&DAT_18007c6f0 + ((longlong)uVar8 >> 0x10 & 0xffU) * 4) +
                                  *(int *)(&DAT_18007c6f0 + ((longlong)uVar8 >> 8 & 0xffU) * 4) +
                                  *(int *)(&DAT_18007c6f0 + (uVar8 & 0xff) * 4);
              } while (lVar6 < 8);
            }
            iVar5 = iVar5 + iVar9;
            iVar10 = iVar10 + iVar11;
            iVar9 = iVar5;
            if (iVar10 < iVar5) {
              iVar9 = iVar10;
            }
            *(char *)(local_88 + lVar3 + local_60) = (char)iVar9;
            *(bool *)(local_88 + lVar3) = iVar5 < iVar10;
            if (iVar9 < piVar13[-1]) {
              *piVar13 = piVar13[-1];
              *(undefined4 *)(local_78 + (longlong)piVar13) =
                   *(undefined4 *)((longlong)piVar13 + local_78 + -4);
              piVar13[-1] = iVar9;
              *(int *)((longlong)piVar13 + local_78 + -4) = iVar12;
            }
            else {
              if (iVar9 < *piVar13) {
                *piVar13 = iVar9;
                *(int *)(local_78 + (longlong)piVar13) = iVar12;
              }
            }
          }
LAB_180031d00:
          iVar12 = iVar12 + 1;
          lVar3 = lVar3 + 1;
          lVar4 = lVar4 + 0x38;
        } while (lVar3 < local_58);
      }
      local_98 = local_98 + 0xe;
      local_88 = local_88 + 0xb4;
      piVar13 = piVar13 + 2;
      local_70 = local_70 + -1;
    } while (local_70 != 0);
  }
  local_68 = param_2;
  FUN_18005f100(local_40 ^ (ulonglong)&local_98);
  return;
}



void FUN_180031d80(longlong param_1,longlong param_2,longlong param_3,longlong param_4)

{
  int iVar1;
  uint uVar2;
  uint *puVar3;
  uint uVar4;
  longlong lVar5;
  longlong lVar6;
  int *piVar7;
  longlong lVar8;
  int iVar9;
  ulonglong uVar10;
  longlong lVar11;

  uVar10 = SEXT48(*(int *)(param_2 + 8));
  iVar1 = *(int *)(param_2 + 0x14);
  if ((longlong)uVar10 < (longlong)*(int *)(param_2 + 0xc)) {
    lVar5 = uVar10 * 0xb4 + param_1;
    lVar11 = (longlong)*(int *)(param_2 + 0x10);
    lVar6 = (longlong)*(int *)(param_2 + 0xc) - uVar10;
    do {
      iVar9 = (int)uVar10;
      if (lVar11 < iVar1) {
        puVar3 = (uint *)(lVar11 * 8 + 4 + param_3);
        piVar7 = (int *)(param_4 + lVar11 * 8);
        lVar8 = lVar11;
        do {
          uVar2 = *(uint *)((param_3 - param_4) + (longlong)piVar7);
          uVar4 = (uint)*(byte *)(lVar5 + lVar8);
          if ((int)(uint)*(byte *)(lVar5 + lVar8) < (int)uVar2) {
            *puVar3 = uVar2;
            *(int *)((param_4 - param_3) + (longlong)puVar3) = *piVar7;
            *piVar7 = iVar9;
            *(uint *)((param_3 - param_4) + (longlong)piVar7) = uVar4;
          }
          else {
            if ((int)uVar4 < (int)*puVar3) {
              *puVar3 = uVar4;
              *(int *)((param_4 - param_3) + (longlong)puVar3) = iVar9;
            }
          }
          lVar8 = lVar8 + 1;
          piVar7 = piVar7 + 2;
          puVar3 = puVar3 + 2;
        } while (lVar8 < iVar1);
      }
      uVar10 = (ulonglong)(iVar9 + 1);
      lVar5 = lVar5 + 0xb4;
      lVar6 = lVar6 + -1;
    } while (lVar6 != 0);
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180031e60(longlong param_1,longlong param_2,int *param_3,int *param_4,longlong param_5,
                  longlong param_6,longlong param_7)

{
  int *piVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  byte *pbVar6;
  longlong lVar7;
  int iVar8;
  uint uVar9;
  int iVar10;
  ulonglong uVar11;
  ushort *puVar12;
  ushort *puVar13;
  undefined auStack168 [32];
  uint local_88;
  int local_84;
  int local_80;
  longlong local_78;
  longlong local_70;
  longlong local_68;
  int local_60;
  int iStack92;
  int iStack88;
  int iStack84;
  undefined8 local_50;
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)auStack168;
  local_50._4_4_ = 0;
  local_50 = 0x100;
  local_60 = 0x100;
  iStack92 = 0;
  iStack88 = 0;
  iStack84 = 0;
  local_70 = param_2;
  if (param_3 != (int *)0x0) {
    FUN_180023cd0(param_3,&local_60);
  }
  local_88 = param_4[2];
  uVar11 = SEXT48((int)local_88);
  if ((int)local_88 < param_4[3]) {
    lVar7 = uVar11 * 8;
    local_78 = uVar11 * 0xb4;
    puVar12 = (ushort *)(param_1 + 4 + uVar11 * 0x38);
    local_80 = iStack88 * 0x100;
    local_84 = local_50._4_4_ * 0x100;
    local_68 = param_5 - param_6;
    do {
      uVar9 = (uint)uVar11;
      iVar8 = ((int)(local_80 + (uint)*puVar12 * iStack92 + (uint)puVar12[-1] * local_60 + 0x80) >>
              8) + 0x80 >> 8;
      iVar4 = ((int)((uint)*puVar12 * (int)local_50 + 0x80 + local_84 + (uint)puVar12[-1] * iStack84
                    ) >> 8) + 0x80 >> 8;
      if ((((iVar8 < *param_4 + -5) && (iVar4 < param_4[1] + -5)) && (5 < iVar8)) &&
         ((5 < iVar4 && (uVar11 = SEXT48(param_4[4]), param_4[4] < param_4[5])))) {
        pbVar6 = (byte *)(uVar11 + local_78 + param_7);
        puVar13 = (ushort *)(local_70 + 4 + uVar11 * 0x38);
        do {
          bVar2 = *pbVar6;
          iVar4 = (int)uVar11;
          if (bVar2 != 0xff) {
            iVar5 = param_3[1] * (uint)*puVar13 + param_3[2] * 0x100 + (uint)puVar13[-1] * *param_3;
            iVar10 = param_3[4] * (uint)*puVar13 + param_3[3] * (uint)puVar13[-1] +
                     param_3[5] * 0x100;
            iVar3 = iVar5 >> 8;
            iVar8 = iVar3 - (uint)puVar12[-1];
            if (iVar8 < 1) {
              iVar8 = (uint)puVar12[-1] - iVar3;
            }
            if (iVar8 < 0x1501) {
              iVar3 = iVar10 >> 8;
              iVar8 = iVar3 - (uint)*puVar12;
              if (iVar8 < 1) {
                iVar8 = (uint)*puVar12 - iVar3;
              }
              if (iVar8 < 0x1501) {
                iVar3 = (iVar5 + 0x80 >> 8) + 0x80 >> 8;
                iVar8 = (iVar10 + 0x80 >> 8) + 0x80 >> 8;
                if (((iVar3 <= *param_4 + -5) && (iVar8 <= param_4[1] + -5)) &&
                   ((5 < iVar3 && (5 < iVar8)))) {
                  piVar1 = (int *)(param_6 + lVar7);
                  if ((int)(uint)bVar2 < *(int *)(local_68 + (longlong)piVar1)) {
                    *(int *)(lVar7 + 4 + param_5) = *(int *)(local_68 + (longlong)piVar1);
                    *(int *)(param_6 + 4 + lVar7) = *piVar1;
                    *(uint *)(local_68 + (longlong)piVar1) = (uint)bVar2;
                    *piVar1 = iVar4;
                  }
                  else {
                    if ((int)(uint)bVar2 < *(int *)(lVar7 + 4 + param_5)) {
                      *(uint *)(lVar7 + 4 + param_5) = (uint)bVar2;
                      *(int *)(param_6 + 4 + lVar7) = iVar4;
                    }
                  }
                }
              }
            }
          }
          uVar11 = (ulonglong)(iVar4 + 1U);
          pbVar6 = pbVar6 + 1;
          puVar13 = puVar13 + 0x1c;
          uVar9 = local_88;
        } while ((int)(iVar4 + 1U) < param_4[5]);
      }
      local_88 = uVar9 + 1;
      uVar11 = (ulonglong)local_88;
      local_78 = local_78 + 0xb4;
      puVar12 = puVar12 + 0x1c;
      lVar7 = lVar7 + 8;
    } while ((int)local_88 < param_4[3]);
  }
  FUN_18005f100(local_48 ^ (ulonglong)auStack168);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180032160(longlong param_1,longlong param_2,longlong param_3,longlong param_4,int *param_5,
                  uint param_6,int param_7,uint param_8,int param_9,int param_10,int param_11,
                  int *param_12)

{
  int *piVar1;
  int iVar2;
  longlong lVar3;
  int iVar4;
  int *piVar5;
  ulonglong uVar6;
  uint *puVar7;
  ulonglong uVar8;
  longlong lVar9;
  int iVar10;
  int iVar11;
  ushort *puVar12;
  int iVar13;
  int iVar14;
  ulonglong uVar15;
  ushort *puVar16;
  undefined auStack216 [32];
  int local_b8;
  int local_b4;
  int *local_b0;
  ushort *local_a8;
  int local_a0;
  int local_9c;
  int local_98;
  int local_94;
  ulonglong local_90;
  ulonglong local_88;
  longlong local_80;
  longlong local_78;
  int local_70;
  int iStack108;
  int iStack104;
  int iStack100;
  undefined8 local_60;
  ulonglong local_58;

  local_58 = DAT_1800b04e8 ^ (ulonglong)auStack216;
  local_60._4_4_ = 0;
  uVar15 = 0x100;
  local_9c = *param_5;
  local_98 = param_5[1];
  local_b0 = param_12;
  local_60 = 0x100;
  local_70 = 0x100;
  iStack108 = 0;
  iStack104 = 0;
  iStack100 = 0;
  local_80 = param_2;
  if (param_12 != (int *)0x0) {
    FUN_180023cd0(param_12,&local_70);
    uVar15 = local_60 & 0xffffffff;
  }
  if ((int)param_6 < param_7) {
    lVar3 = (longlong)(int)param_6 * 0x38;
    iVar13 = param_11 + -5;
    uVar6 = SEXT48((int)param_8);
    puVar12 = (ushort *)(param_1 + 4 + lVar3);
    lVar9 = (longlong)(int)param_6 * 8;
    lVar3 = param_1 + 0x20 + lVar3;
    local_94 = iStack104 << 8;
    local_60._4_4_ = local_60._4_4_ << 8;
    local_78 = param_3 - param_4;
    local_90 = (ulonglong)(param_7 - param_6);
    local_b8 = iVar13;
    local_a0 = local_60._4_4_;
    local_88 = uVar6;
    do {
      iVar10 = ((int)(local_94 + (uint)*puVar12 * iStack108 + (uint)puVar12[-1] * local_70 + 0x80)
               >> 8) + 0x80 >> 8;
      iVar4 = ((int)((uint)*puVar12 * (int)uVar15 + 0x80 + local_60._4_4_ +
                    (uint)puVar12[-1] * iStack100) >> 8) + 0x80 >> 8;
      if ((((iVar10 < iVar13) &&
           (iVar14 = param_10 + -5, iVar13 = local_b8, local_b4 = iVar14, iVar4 < iVar14)) &&
          (5 < iVar10)) &&
         ((5 < iVar4 &&
          (uVar8 = uVar6 & 0xffffffff, local_60._4_4_ = local_a0, (int)uVar6 < param_9)))) {
        puVar16 = (ushort *)(local_80 + 4 + local_88 * 0x38);
        puVar7 = (uint *)(local_80 + 0x20 + local_88 * 0x38);
        piVar5 = local_b0;
        local_a8 = puVar12;
        do {
          iVar11 = *piVar5 * (uint)puVar16[-1] + (uint)*puVar16 * piVar5[1] + piVar5[2] * 0x100;
          iVar10 = piVar5[4] * (uint)*puVar16 + piVar5[3] * (uint)puVar16[-1] + piVar5[5] * 0x100;
          iVar4 = iVar11 >> 8;
          iVar13 = iVar4 - (uint)puVar12[-1];
          if (iVar13 < 1) {
            iVar13 = (uint)puVar12[-1] - iVar4;
          }
          iVar4 = (int)uVar8;
          if (iVar13 < 0x1501) {
            iVar2 = iVar10 >> 8;
            iVar13 = iVar2 - (uint)*puVar12;
            if (iVar13 < 1) {
              iVar13 = (uint)*puVar12 - iVar2;
            }
            if (iVar13 < 0x1501) {
              iVar11 = (iVar11 + 0x80 >> 8) + 0x80 >> 8;
              iVar13 = (iVar10 + 0x80 >> 8) + 0x80 >> 8;
              if (((iVar11 <= local_b8) && (iVar13 <= iVar14)) && ((5 < iVar11 && (5 < iVar13)))) {
                uVar15 = FUN_180031550(lVar3 + -0x10,puVar7 + -4,2);
                piVar5 = local_b0;
                puVar12 = local_a8;
                iVar14 = local_b4;
                if ((int)uVar15 <= local_9c) {
                  uVar6 = FUN_180031550(lVar3 + -8,puVar7 + -2,2);
                  iVar13 = (int)uVar15 + (int)uVar6;
                  piVar5 = local_b0;
                  puVar12 = local_a8;
                  iVar14 = local_b4;
                  if (iVar13 <= local_98) {
                    uVar15 = FUN_180031550(lVar3,puVar7,2);
                    piVar1 = (int *)(lVar9 + param_4);
                    iVar13 = iVar13 + (int)uVar15;
                    piVar5 = local_b0;
                    puVar12 = local_a8;
                    iVar14 = local_b4;
                    if (iVar13 < *(int *)(local_78 + (longlong)piVar1)) {
                      *(int *)(param_3 + 4 + lVar9) = *(int *)(local_78 + (longlong)piVar1);
                      *(int *)(lVar9 + 4 + param_4) = *piVar1;
                      *(int *)(local_78 + (longlong)piVar1) = iVar13;
                      *piVar1 = iVar4;
                    }
                    else {
                      if (iVar13 < *(int *)(param_3 + 4 + lVar9)) {
                        *(int *)(param_3 + 4 + lVar9) = iVar13;
                        *(int *)(lVar9 + 4 + param_4) = iVar4;
                      }
                    }
                  }
                }
              }
            }
          }
          uVar8 = (ulonglong)(iVar4 + 1U);
          puVar7 = puVar7 + 0xe;
          puVar16 = puVar16 + 0x1c;
        } while ((int)(iVar4 + 1U) < param_9);
        uVar6 = (ulonglong)param_8;
        uVar15 = local_60 & 0xffffffff;
        iVar13 = local_b8;
        local_60._4_4_ = local_a0;
      }
      puVar12 = puVar12 + 0x1c;
      lVar3 = lVar3 + 0x38;
      lVar9 = lVar9 + 8;
      local_90 = local_90 - 1;
      local_a8 = puVar12;
    } while (local_90 != 0);
  }
  FUN_18005f100(local_58 ^ (ulonglong)auStack216);
  return;
}



void FUN_180032530(longlong param_1,longlong param_2,int *param_3,int param_4,undefined8 param_5,
                  longlong param_6,longlong param_7)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  undefined8 *puVar5;
  uint *puVar6;
  undefined8 *puVar7;
  int iVar8;
  undefined4 *puVar9;
  ulonglong uVar10;
  ulonglong uVar11;
  int iVar12;
  ulonglong uVar13;
  undefined4 *puVar14;
  int iVar15;
  ulonglong uVar16;
  longlong lVar17;
  ulonglong uVar18;
  longlong lVar19;
  ulonglong uVar20;
  uint uVar21;
  ulonglong uVar22;
  int local_268;
  uint local_264;
  int local_260;
  int local_25c;
  uint *local_258;
  uint local_250;
  uint local_24c;
  uint local_248;
  longlong local_240;
  undefined8 local_238;
  undefined8 local_230;
  undefined8 local_228;
  uint local_220 [122];
  ulonglong local_38;

  local_38 = DAT_1800b04e8 ^ (ulonglong)&local_268;
  uVar18 = 0;
  local_260 = *(int *)(param_6 + 8);
  lVar19 = 7;
  local_25c = *(int *)(param_6 + 0xc);
  local_230 = param_7;
  puVar7 = &local_228;
  do {
    puVar5 = puVar7;
    *puVar5 = 0;
    puVar5[1] = 0;
    puVar5[2] = 0;
    puVar5[3] = 0;
    puVar5[4] = 0;
    puVar5[5] = 0;
    puVar5[6] = 0;
    puVar5[7] = 0;
    lVar19 = lVar19 + -1;
    puVar7 = puVar5 + 8;
  } while (lVar19 != 0);
  puVar5[8] = 0;
  puVar5[9] = 0;
  puVar5[10] = 0;
  puVar5[0xb] = 0;
  puVar5[0xc] = 0;
  puVar5[0xd] = 0;
  uVar10 = uVar18;
  local_258 = (uint *)param_3;
  if (0 < param_4) {
    local_238 = param_2 - (longlong)param_3;
    uVar20 = uVar18;
    uVar11 = uVar18;
    do {
      local_250 = *local_258;
      uVar1 = *(uint *)(local_238 + (longlong)local_258);
      local_264 = *(uint *)(local_238 + 4 + (longlong)local_258);
      uVar21 = (uint)uVar11;
      if ((-1 < (int)local_250) && ((int)(uVar1 * local_260) < (int)(local_264 * local_25c))) {
        local_248 = (uint)*(ushort *)((longlong)(int)local_250 * 0x38 + 2 + param_1);
        local_24c = (uint)*(ushort *)((longlong)(int)local_250 * 0x38 + 4 + param_1);
        if (0 < (longlong)uVar20) {
          iVar15 = (int)uVar10 + -1;
          puVar6 = local_220;
          puVar7 = &local_238 + uVar20 * 2;
          uVar11 = uVar18;
          uVar13 = uVar18;
          uVar16 = uVar18;
          uVar22 = uVar18;
          do {
            iVar12 = local_24c - *(ushort *)((longlong)(int)puVar6[-1] * 0x38 + 4 + param_1);
            iVar8 = local_248 - *(ushort *)((longlong)(int)puVar6[-1] * 0x38 + 2 + param_1);
            if (iVar8 * iVar8 + iVar12 * iVar12 < 0x10000) {
              if (*puVar6 == uVar1 || (int)*puVar6 < (int)uVar1) {
                if ((int)uVar22 == 0) goto LAB_1800327e4;
              }
              else {
                uVar22 = 1;
                if ((int)uVar16 == 0) {
                  uVar16 = 1;
                  puVar6[-1] = local_250;
                  puVar6[1] = local_264;
                  puVar6[-2] = uVar21;
                  *puVar6 = uVar1;
                }
                else {
                  if ((int)uVar13 != iVar15) {
                    uVar2 = *(uint *)((longlong)puVar7 + 4);
                    uVar3 = *(uint *)(puVar7 + 1);
                    uVar4 = *(uint *)((longlong)puVar7 + 0xc);
                    puVar6[-2] = *(uint *)puVar7;
                    puVar6[-1] = uVar2;
                    *puVar6 = uVar3;
                    puVar6[1] = uVar4;
                  }
                  uVar10 = (ulonglong)((int)uVar10 - 1);
                  iVar15 = iVar15 + -1;
                  uVar20 = uVar20 - 1;
                  puVar7 = puVar7 + -2;
                }
              }
            }
            uVar13 = (ulonglong)((int)uVar13 + 1);
            uVar11 = uVar11 + 1;
            puVar6 = puVar6 + 4;
          } while ((longlong)uVar11 < (longlong)uVar20);
          if ((int)uVar22 != 0) goto LAB_1800327e4;
        }
        if (uVar20 == 0x1f) {
          uVar13 = 0xffffffffffffffff;
          puVar7 = &local_228;
          uVar11 = uVar18;
          uVar16 = uVar18;
          do {
            if ((int)uVar16 < (int)*(uint *)(puVar7 + 1)) {
              uVar16 = (ulonglong)*(uint *)(puVar7 + 1);
              uVar13 = uVar11;
            }
            uVar11 = uVar11 + 1;
            puVar7 = puVar7 + 2;
          } while ((longlong)uVar11 < 0x1f);
          if ((int)uVar1 < (int)uVar16) {
            *(uint *)(&local_228 + uVar13 * 2) = uVar21;
            local_220[uVar13 * 4 + -1] = local_250;
            local_220[uVar13 * 4] = uVar1;
            local_220[uVar13 * 4 + 1] = local_264;
          }
        }
        else {
          uVar10 = (ulonglong)((int)uVar10 + 1);
          *(uint *)(&local_228 + uVar20 * 2) = uVar21;
          local_220[uVar20 * 4 + -1] = local_250;
          local_220[uVar20 * 4] = uVar1;
          local_220[uVar20 * 4 + 1] = local_264;
          uVar20 = uVar20 + 1;
        }
      }
LAB_1800327e4:
      local_258 = local_258 + 2;
      uVar11 = (ulonglong)(uVar21 + 1);
    } while ((int)(uVar21 + 1) < param_4);
  }
  lVar19 = (longlong)(int)uVar10;
  if (0 < (int)uVar10) {
    puVar9 = (undefined4 *)((longlong)&local_228 + 4);
    puVar14 = (undefined4 *)(local_230 + 4);
    lVar17 = lVar19;
    do {
      iVar15 = (int)uVar18;
      uVar18 = (ulonglong)(iVar15 + 1);
      *(undefined4 *)(local_230 + (longlong)(iVar15 * 2) * 4) = puVar9[-1];
      *puVar14 = *puVar9;
      lVar17 = lVar17 + -1;
      puVar9 = puVar9 + 4;
      puVar14 = puVar14 + 2;
    } while (lVar17 != 0);
  }
  if (lVar19 < 0x1f) {
    lVar17 = 0x1f - lVar19;
    puVar9 = (undefined4 *)(lVar19 * 8 + 4 + local_230);
    do {
      iVar15 = (int)uVar10;
      uVar10 = (ulonglong)(iVar15 + 1);
      *(undefined4 *)(local_230 + (longlong)(iVar15 * 2) * 4) = 0xffffffff;
      *puVar9 = 0xffffffff;
      lVar17 = lVar17 + -1;
      puVar9 = puVar9 + 2;
    } while (lVar17 != 0);
  }
  local_268 = param_4;
  local_240 = param_1;
  FUN_18005f100(local_38 ^ (ulonglong)&local_268);
  return;
}



void FUN_1800329f0(longlong param_1,longlong param_2,undefined8 *param_3)

{
  uint *puVar1;
  int iVar2;
  undefined8 *puVar3;
  undefined8 *puVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  int iVar7;
  uint *puVar8;
  int iVar9;
  int *piVar10;
  uint *puVar11;
  uint uVar12;
  longlong lVar13;
  longlong lVar14;
  longlong lVar15;
  int iVar16;
  longlong lVar17;
  undefined8 in_stack_fffffffffffff408;
  int local_bd8;
  longlong local_bd0;
  longlong local_bc8;
  longlong local_bc0;
  longlong local_bb8;
  undefined8 *local_bb0;
  undefined4 local_ba8;
  undefined4 uStack2980;
  undefined4 uStack2976;
  undefined4 uStack2972;
  undefined8 local_b98;
  int local_b88 [360];
  int local_5e8 [360];
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffff3e8;
  local_bd8 = *(int *)(param_1 + 0xf0);
  local_bb8 = (longlong)local_bd8;
  local_bd0 = *(longlong *)(param_2 + 0xf8);
  local_bc0 = (longlong)*(int *)(param_2 + 0xf0);
  local_ba8 = 0;
  uStack2980 = 0;
  uStack2976 = 0x28;
  uStack2972 = 0x26;
  local_b98 = 0;
  iVar9 = local_bd8 * 2;
  lVar15 = *(longlong *)(param_1 + 0xf8);
  if (0 < iVar9) {
    uVar6 = (longlong)iVar9 & 0x3fffffffffffffff;
    uVar5 = (longlong)iVar9 & 0x3fffffffffffffff;
    piVar10 = local_b88;
    while (uVar5 != 0) {
      uVar5 = uVar5 - 1;
      *piVar10 = 0xc0;
      piVar10 = piVar10 + 1;
    }
    piVar10 = local_5e8;
    while (uVar6 != 0) {
      uVar6 = uVar6 - 1;
      *piVar10 = -1;
      piVar10 = piVar10 + 1;
    }
  }
  if (0 < local_bd8) {
    lVar15 = lVar15 - local_bd0;
    local_bc8 = 0;
    do {
      iVar9 = 0;
      if (0 < local_bc0) {
        iVar16 = local_b88[local_bc8 * 2];
        puVar8 = (uint *)(local_bd0 + 0x20);
        lVar13 = lVar15;
        lVar17 = local_bc0;
        do {
          iVar7 = 0;
          puVar11 = puVar8 + -4;
          uVar5 = 4;
          do {
            uVar12 = *puVar11;
            puVar1 = (uint *)((longlong)puVar11 + lVar13);
            puVar11 = puVar11 + 1;
            uVar6 = SEXT48((int)(*puVar1 ^ uVar12));
            iVar7 = iVar7 + *(int *)(&DAT_18007c6f0 + ((longlong)uVar6 >> 0x18 & 0xffU) * 4) +
                            *(int *)(&DAT_18007c6f0 + ((longlong)uVar6 >> 0x10 & 0xffU) * 4) +
                            *(int *)(&DAT_18007c6f0 + ((longlong)uVar6 >> 8 & 0xffU) * 4) +
                            *(int *)(&DAT_18007c6f0 + (uVar6 & 0xff) * 4);
            uVar5 = uVar5 - 1;
          } while (uVar5 != 0);
          lVar14 = 2;
          puVar11 = puVar8;
          do {
            uVar12 = *puVar11;
            puVar1 = (uint *)(lVar13 + (longlong)puVar11);
            puVar11 = puVar11 + 1;
            uVar6 = SEXT48((int)(*puVar1 ^ uVar12));
            uVar12 = (int)uVar5 +
                     *(int *)(&DAT_18007c6f0 + ((longlong)uVar6 >> 0x18 & 0xffU) * 4) +
                     *(int *)(&DAT_18007c6f0 + ((longlong)uVar6 >> 0x10 & 0xffU) * 4) +
                     *(int *)(&DAT_18007c6f0 + ((longlong)uVar6 >> 8 & 0xffU) * 4) +
                     *(int *)(&DAT_18007c6f0 + (uVar6 & 0xff) * 4);
            uVar5 = (ulonglong)uVar12;
            lVar14 = lVar14 + -1;
          } while (lVar14 != 0);
          iVar7 = uVar12 + iVar7;
          if (iVar7 < iVar16) {
            iVar2 = local_5e8[local_bc8 * 2];
            local_b88[local_bc8 * 2 + 1] = iVar16;
            local_5e8[local_bc8 * 2 + 1] = iVar2;
            local_5e8[local_bc8 * 2] = iVar9;
            iVar16 = iVar7;
          }
          else {
            if (iVar7 < local_b88[local_bc8 * 2 + 1]) {
              local_b88[local_bc8 * 2 + 1] = iVar7;
              local_5e8[local_bc8 * 2 + 1] = iVar9;
            }
          }
          iVar9 = iVar9 + 1;
          puVar8 = puVar8 + 0xe;
          lVar13 = lVar13 + -0x38;
          lVar17 = lVar17 + -1;
        } while (lVar17 != 0);
        local_b88[local_bc8 * 2] = iVar16;
      }
      local_bc8 = local_bc8 + 1;
      lVar15 = lVar15 + 0x38;
    } while (local_bc8 < local_bb8);
  }
  if (param_3 != (undefined8 *)0x0) {
    lVar15 = 3;
    puVar3 = param_3;
    do {
      puVar4 = puVar3;
      *puVar4 = 0xffffffffffffffff;
      puVar4[1] = 0xffffffffffffffff;
      puVar4[2] = 0xffffffffffffffff;
      puVar4[3] = 0xffffffffffffffff;
      puVar4[4] = 0xffffffffffffffff;
      puVar4[5] = 0xffffffffffffffff;
      puVar4[6] = 0xffffffffffffffff;
      puVar4[7] = 0xffffffffffffffff;
      lVar15 = lVar15 + -1;
      puVar3 = puVar4 + 8;
    } while (lVar15 != 0);
    puVar4[8] = 0xffffffffffffffff;
    puVar4[9] = 0xffffffffffffffff;
    puVar4[10] = 0xffffffffffffffff;
    puVar4[0xb] = 0xffffffffffffffff;
    puVar4[0xc] = 0xffffffffffffffff;
    puVar4[0xd] = 0xffffffffffffffff;
    puVar4[0xe] = 0xffffffffffffffff;
  }
  local_bb0 = param_3;
  FUN_180032530(local_bd0,(longlong)local_b88,local_5e8,local_bd8,in_stack_fffffffffffff408,
                (longlong)&local_ba8,(longlong)param_3);
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xfffffffffffff3e8);
  return;
}



void FUN_180032d90(undefined4 *param_1,longlong param_2,undefined8 param_3,longlong param_4,
                  undefined4 *param_5,int param_6,undefined8 param_7,undefined8 param_8)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  longlong lVar5;
  longlong lVar6;
  undefined4 *puVar7;
  undefined8 uVar8;
  undefined8 uVar9;
  longlong lVar10;
  longlong lVar11;
  longlong lVar12;
  ulonglong uVar13;
  ulonglong uVar14;
  undefined4 *puVar15;
  int aiStackX8 [4];
  longlong local_2230;
  undefined4 local_2208 [360];
  undefined4 local_1c68 [360];
  int local_16c8 [360];
  int local_1128 [360];
  undefined4 local_b88 [360];
  undefined4 local_5e8 [360];
  ulonglong local_48;
  undefined8 uStack64;

  uStack64 = 0x180032db2;
  lVar10 = _alloca_probe();
  uVar9 = param_8;
  uVar8 = param_7;
  puVar7 = param_5;
  lVar10 = -lVar10;
  local_48 = DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffc8 + lVar10);
  iVar1 = param_1[0x3c];
  lVar5 = *(longlong *)(param_1 + 0x3e);
  lVar6 = *(longlong *)(param_2 + 0xf8);
  iVar2 = *(int *)(param_2 + 0xf0);
  lVar11 = 0;
  lVar12 = (longlong)(iVar1 * 2);
  if (0 < iVar1 * 2) {
    do {
      *(undefined4 *)((longlong)local_b88 + lVar11) = 0xc0;
      *(undefined4 *)((longlong)local_16c8 + lVar11) = 0xffffffff;
      *(undefined4 *)((longlong)local_5e8 + lVar11) = 0xc0;
      *(undefined4 *)((longlong)local_1128 + lVar11) = 0xffffffff;
      lVar11 = lVar11 + 4;
      lVar12 = lVar12 + -1;
    } while (lVar12 != 0);
  }
  if (param_6 - 9U < 2) {
    iVar4 = iVar2 * 2;
    if (0 < iVar4) {
      uVar14 = (longlong)iVar4 & 0x3fffffffffffffff;
      uVar13 = (longlong)iVar4 & 0x3fffffffffffffff;
      puVar15 = local_1c68;
      while (uVar13 != 0) {
        uVar13 = uVar13 - 1;
        *puVar15 = 0xc0;
        puVar15 = puVar15 + 1;
      }
      puVar15 = local_2208;
      while (uVar14 != 0) {
        uVar14 = uVar14 - 1;
        *puVar15 = 0xffffffff;
        puVar15 = puVar15 + 1;
      }
    }
    *(undefined4 *)(&stack0x00000018 + lVar10) = *(undefined4 *)(param_2 + 0x108);
    iVar4 = param_1[0x42];
    *(undefined4 *)((longlong)aiStackX8 + lVar10 + 8) = 0;
    *(int *)((longlong)aiStackX8 + lVar10) = iVar4;
    local_2230 = lVar5;
    *(undefined4 *)(&stack0x00000000 + lVar10) = 0;
    *(undefined4 **)(&stack0xfffffffffffffff8 + lVar10) = puVar7;
    *(undefined4 **)(&stack0xfffffffffffffff0 + lVar10) = local_2208;
    *(undefined4 **)(&stack0xffffffffffffffe8 + lVar10) = local_1c68;
    *(undefined8 *)((longlong)&uStack64 + lVar10) = 0x180032fbb;
    FUN_1800315e0(lVar5,lVar6,(longlong)local_b88,(longlong)local_16c8,
                  *(longlong *)(&stack0xffffffffffffffe8 + lVar10),
                  *(longlong *)(&stack0xfffffffffffffff0 + lVar10),
                  *(int **)(&stack0xfffffffffffffff8 + lVar10),*(uint *)(&stack0x00000000 + lVar10),
                  *(int *)((longlong)aiStackX8 + lVar10),*(uint *)((longlong)aiStackX8 + lVar10 + 8)
                  ,*(int *)(&stack0x00000018 + lVar10));
    uVar3 = *(undefined4 *)(param_2 + 0x108);
    *(int *)(&stack0x00000018 + lVar10) = iVar2;
    *(undefined4 *)((longlong)aiStackX8 + lVar10 + 8) = uVar3;
    uVar3 = param_1[0x42];
    *(int *)((longlong)aiStackX8 + lVar10) = iVar1;
    *(undefined4 *)(&stack0x00000000 + lVar10) = uVar3;
    *(undefined4 **)(&stack0xfffffffffffffff8 + lVar10) = puVar7;
    *(undefined4 **)(&stack0xfffffffffffffff0 + lVar10) = local_2208;
    *(undefined4 **)(&stack0xffffffffffffffe8 + lVar10) = local_1c68;
    *(undefined8 *)((longlong)&uStack64 + lVar10) = 0x18003300d;
    FUN_1800315e0(local_2230,lVar6,(longlong)local_b88,(longlong)local_16c8,
                  *(longlong *)(&stack0xffffffffffffffe8 + lVar10),
                  *(longlong *)(&stack0xfffffffffffffff0 + lVar10),
                  *(int **)(&stack0xfffffffffffffff8 + lVar10),*(uint *)(&stack0x00000000 + lVar10),
                  *(int *)((longlong)aiStackX8 + lVar10),*(uint *)((longlong)aiStackX8 + lVar10 + 8)
                  ,*(int *)(&stack0x00000018 + lVar10));
    *(longlong *)(&stack0xfffffffffffffff8 + lVar10) = param_4 + 0xf8;
    *(undefined4 **)(&stack0xfffffffffffffff0 + lVar10) = puVar7;
    *(undefined8 *)((longlong)&uStack64 + lVar10) = 0x180033037;
    FUN_180032530(lVar6,(longlong)local_5e8,local_1128,iVar1,
                  *(undefined8 *)(&stack0xffffffffffffffe8 + lVar10),
                  *(longlong *)(&stack0xfffffffffffffff0 + lVar10),
                  *(longlong *)(&stack0xfffffffffffffff8 + lVar10));
  }
  else {
    *(undefined4 *)((longlong)&param_5 + lVar10) = *param_1;
    *(undefined4 *)((longlong)&param_5 + lVar10 + 4) = param_1[1];
    *(undefined4 *)(&stack0x00000034 + lVar10) = param_1[0x42];
    *(undefined4 *)((longlong)&param_7 + lVar10 + 4) = *(undefined4 *)(param_2 + 0x108);
    *(undefined4 *)((longlong)&param_8 + lVar10) = *puVar7;
    uVar3 = puVar7[1];
    *(undefined8 *)(&stack0xfffffffffffffff8 + lVar10) = uVar9;
    *(undefined4 *)((longlong)&param_8 + lVar10 + 4) = uVar3;
    *(undefined8 *)(&stack0xfffffffffffffff0 + lVar10) = uVar8;
    *(int *)((longlong)&param_6 + lVar10) = 0;
    *(undefined4 *)((longlong)&param_7 + lVar10) = 0;
    *(int **)(&stack0xffffffffffffffe8 + lVar10) = local_16c8;
    *(undefined8 *)((longlong)&uStack64 + lVar10) = 0x180032ed7;
    FUN_1800319a0(lVar5,lVar6,(longlong)((longlong)&param_5 + lVar10),(longlong)local_b88,
                  *(longlong *)(&stack0xffffffffffffffe8 + lVar10),
                  *(longlong *)(&stack0xfffffffffffffff0 + lVar10),
                  *(longlong *)(&stack0xfffffffffffffff8 + lVar10));
    *(undefined4 *)((longlong)&param_6 + lVar10) = param_1[0x42];
    *(undefined4 *)((longlong)&param_7 + lVar10) = *(undefined4 *)(param_2 + 0x108);
    *(undefined8 *)(&stack0xfffffffffffffff8 + lVar10) = uVar9;
    *(undefined8 *)(&stack0xfffffffffffffff0 + lVar10) = uVar8;
    *(int **)(&stack0xffffffffffffffe8 + lVar10) = local_16c8;
    *(int *)(&stack0x00000034 + lVar10) = iVar1;
    *(int *)((longlong)&param_7 + lVar10 + 4) = iVar2;
    *(undefined8 *)((longlong)&uStack64 + lVar10) = 0x180032f2b;
    FUN_1800319a0(lVar5,lVar6,(longlong)((longlong)&param_5 + lVar10),(longlong)local_b88,
                  *(longlong *)(&stack0xffffffffffffffe8 + lVar10),
                  *(longlong *)(&stack0xfffffffffffffff0 + lVar10),
                  *(longlong *)(&stack0xfffffffffffffff8 + lVar10));
  }
  *(longlong *)(&stack0xfffffffffffffff8 + lVar10) = param_4;
  *(undefined4 **)(&stack0xfffffffffffffff0 + lVar10) = puVar7;
  *(undefined8 *)((longlong)&uStack64 + lVar10) = 0x180033063;
  FUN_180032530(lVar6,(longlong)local_b88,local_16c8,iVar1,
                *(undefined8 *)(&stack0xffffffffffffffe8 + lVar10),
                *(longlong *)(&stack0xfffffffffffffff0 + lVar10),
                *(longlong *)(&stack0xfffffffffffffff8 + lVar10));
  *(undefined8 *)((longlong)&uStack64 + lVar10) = 0x180033072;
  FUN_18005f100(local_48 ^ (ulonglong)(&stack0xffffffffffffffc8 + lVar10),
                *(undefined *)((longlong)&uStack64 + lVar10));
  return;
}



void FUN_180033090(longlong param_1,longlong param_2,longlong param_3,longlong param_4,
                  longlong param_5)

{
  int iVar1;
  undefined8 *puVar2;
  longlong lVar3;
  undefined8 *puVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  longlong lVar7;
  uint uVar8;
  uint *puVar9;
  int *piVar10;
  ulonglong uVar11;
  longlong lVar12;
  int iVar13;
  longlong lVar14;
  ulonglong uVar15;
  ulonglong uVar16;
  longlong lVar17;
  undefined8 in_stack_fffffffffffff348;
  longlong local_c98;
  undefined8 local_c88;
  uint local_b88 [360];
  int local_5e8 [360];
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffff328;
  iVar1 = *(int *)(param_2 + 0xf0);
  iVar13 = iVar1 * 2;
  if (0 < iVar13) {
    uVar6 = (longlong)iVar13 & 0x3fffffffffffffff;
    uVar5 = (longlong)iVar13 & 0x3fffffffffffffff;
    puVar9 = local_b88;
    while (uVar5 != 0) {
      uVar5 = uVar5 - 1;
      *puVar9 = 0xc0;
      puVar9 = puVar9 + 1;
    }
    piVar10 = local_5e8;
    while (uVar6 != 0) {
      uVar6 = uVar6 - 1;
      *piVar10 = -1;
      piVar10 = piVar10 + 1;
    }
  }
  uVar15 = SEXT48(*(int *)(param_1 + 0x108));
  uVar5 = 0;
  lVar7 = (longlong)*(int *)(param_2 + 0x108);
  uVar6 = uVar5;
  lVar14 = param_5;
  uVar16 = uVar15;
  if (0 < *(int *)(param_1 + 0x108)) {
    do {
      iVar13 = (int)uVar6;
      uVar6 = uVar5;
      uVar11 = uVar5;
      if (0 < lVar7) {
        do {
          uVar8 = (uint)*(byte *)(uVar6 + lVar14);
          if ((int)(uint)*(byte *)(uVar6 + lVar14) < (int)*(uint *)((longlong)local_b88 + uVar11)) {
            local_b88[uVar6 * 2 + 1] = *(uint *)((longlong)local_b88 + uVar11);
            local_5e8[uVar6 * 2 + 1] = *(int *)((longlong)local_5e8 + uVar11);
            *(int *)((longlong)local_5e8 + uVar11) = iVar13;
            *(uint *)((longlong)local_b88 + uVar11) = uVar8;
          }
          else {
            if ((int)uVar8 < (int)local_b88[uVar6 * 2 + 1]) {
              local_b88[uVar6 * 2 + 1] = uVar8;
              local_5e8[uVar6 * 2 + 1] = iVar13;
            }
          }
          uVar6 = uVar6 + 1;
          uVar11 = uVar11 + 8;
        } while ((longlong)uVar6 < lVar7);
      }
      uVar16 = uVar16 - 1;
      uVar6 = (ulonglong)(iVar13 + 1);
      lVar14 = lVar14 + 0xb4;
    } while (uVar16 != 0);
  }
  if ((longlong)uVar15 < (longlong)*(int *)(param_1 + 0xf0)) {
    lVar14 = uVar15 * 0xb4 + param_5;
    lVar17 = (longlong)*(int *)(param_1 + 0xf0) - uVar15;
    do {
      iVar13 = (int)uVar15;
      if (lVar7 < iVar1) {
        lVar12 = lVar7 * 8;
        lVar3 = lVar7;
        do {
          uVar8 = (uint)*(byte *)(lVar14 + lVar3);
          if ((int)(uint)*(byte *)(lVar14 + lVar3) < (int)*(uint *)((longlong)local_b88 + lVar12)) {
            local_b88[lVar3 * 2 + 1] = *(uint *)((longlong)local_b88 + lVar12);
            local_5e8[lVar3 * 2 + 1] = *(int *)((longlong)local_5e8 + lVar12);
            *(int *)((longlong)local_5e8 + lVar12) = iVar13;
            *(uint *)((longlong)local_b88 + lVar12) = uVar8;
          }
          else {
            if ((int)uVar8 < (int)local_b88[lVar3 * 2 + 1]) {
              local_b88[lVar3 * 2 + 1] = uVar8;
              local_5e8[lVar3 * 2 + 1] = iVar13;
            }
          }
          lVar3 = lVar3 + 1;
          lVar12 = lVar12 + 8;
        } while (lVar3 < iVar1);
      }
      uVar15 = (ulonglong)(iVar13 + 1);
      lVar14 = lVar14 + 0xb4;
      lVar17 = lVar17 + -1;
    } while (lVar17 != 0);
  }
  lVar14 = 3;
  puVar2 = &local_c88;
  do {
    puVar4 = puVar2;
    *puVar4 = 0xffffffffffffffff;
    puVar4[1] = 0xffffffffffffffff;
    puVar4[2] = 0xffffffffffffffff;
    puVar4[3] = 0xffffffffffffffff;
    puVar4[4] = 0xffffffffffffffff;
    puVar4[5] = 0xffffffffffffffff;
    puVar4[6] = 0xffffffffffffffff;
    puVar4[7] = 0xffffffffffffffff;
    lVar14 = lVar14 + -1;
    puVar2 = puVar4 + 8;
  } while (lVar14 != 0);
  lVar14 = *(longlong *)(param_1 + 0xf8);
  puVar4[8] = 0xffffffffffffffff;
  puVar4[9] = 0xffffffffffffffff;
  puVar4[10] = 0xffffffffffffffff;
  puVar4[0xb] = 0xffffffffffffffff;
  puVar4[0xc] = 0xffffffffffffffff;
  puVar4[0xd] = 0xffffffffffffffff;
  puVar4[0xe] = 0xffffffffffffffff;
  local_c98 = param_4;
  FUN_180032530(lVar14,(longlong)local_b88,local_5e8,iVar1,in_stack_fffffffffffff348,param_4,
                (longlong)&local_c88);
  uVar6 = uVar5;
  do {
    iVar1 = (int)uVar6;
    uVar8 = iVar1 + 1;
    uVar6 = (ulonglong)uVar8;
    lVar7 = (longlong)(iVar1 * 2);
    lVar14 = uVar5 + 4;
    uVar5 = uVar5 + 8;
    *(undefined4 *)(param_3 + lVar7 * 4) = *(undefined4 *)((longlong)&local_c88 + lVar14);
    *(undefined4 *)(param_3 + -4 + uVar5) = *(undefined4 *)((longlong)&local_c88 + lVar7 * 4);
  } while ((int)uVar8 < 0x1f);
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xfffffffffffff328);
  return;
}



void FUN_180033390(int *param_1,longlong param_2,longlong param_3,int *param_4,int *param_5,
                  int param_6,longlong param_7)

{
  int iVar1;
  longlong lVar2;
  longlong lVar3;
  int iVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  int *piVar7;
  int local_be8;
  int local_be4;
  int local_be0;
  int local_bd8;
  int local_bd4;
  int local_bd0;
  int local_bcc;
  undefined4 local_bc8;
  int local_bc4;
  int local_bc0;
  int local_bbc;
  int local_bb8;
  longlong local_bb0;
  longlong local_ba8;
  longlong local_ba0;
  int local_b98 [360];
  int local_5f8 [360];
  ulonglong local_58;

  local_58 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffff3b8;
  local_be0 = *(int *)(param_2 + 0xf0);
  iVar1 = param_1[0x3c];
  lVar2 = *(longlong *)(param_1 + 0x3e);
  lVar3 = *(longlong *)(param_2 + 0xf8);
  local_be4 = param_1[1];
  local_be8 = *param_1;
  iVar4 = iVar1 * 2;
  local_ba8 = param_7;
  if (0 < iVar4) {
    uVar6 = (longlong)iVar4 & 0x3fffffffffffffff;
    uVar5 = (longlong)iVar4 & 0x3fffffffffffffff;
    piVar7 = local_5f8;
    while (uVar5 != 0) {
      uVar5 = uVar5 - 1;
      *piVar7 = 0xc0;
      piVar7 = piVar7 + 1;
    }
    piVar7 = local_b98;
    while (uVar6 != 0) {
      uVar6 = uVar6 - 1;
      *piVar7 = -1;
      piVar7 = piVar7 + 1;
    }
  }
  local_bb0 = lVar2;
  local_ba0 = param_3;
  if (param_6 - 9U < 2) {
    FUN_180032160(lVar2,lVar3,(longlong)local_5f8,(longlong)local_b98,param_5,0,param_1[0x42],0,
                  *(int *)(param_2 + 0x108),local_be4,local_be8,param_4);
    piVar7 = param_5;
    FUN_180032160(lVar2,lVar3,(longlong)local_5f8,(longlong)local_b98,param_5,param_1[0x42],iVar1,
                  *(uint *)(param_2 + 0x108),local_be0,local_be4,local_be8,param_4);
  }
  else {
    local_bcc = param_1[0x42];
    local_bc4 = *(undefined4 *)(param_2 + 0x108);
    local_bc0 = *param_5;
    local_bbc = param_5[1];
    local_bb8 = param_5[5];
    local_bd0 = 0;
    local_bc8 = 0;
    local_bd8 = local_be8;
    local_bd4 = local_be4;
    FUN_180031e60(lVar2,lVar3,param_4,&local_bd8,(longlong)local_5f8,(longlong)local_b98,param_7);
    local_bd0 = param_1[0x42];
    local_bc8 = *(undefined4 *)(param_2 + 0x108);
    local_bc4 = local_be0;
    piVar7 = local_5f8;
    local_bcc = iVar1;
    FUN_180031e60(lVar2,lVar3,param_4,&local_bd8,(longlong)piVar7,(longlong)local_b98,local_ba8);
  }
  FUN_180032530(lVar3,(longlong)local_5f8,local_b98,iVar1,piVar7,(longlong)param_5,local_ba0);
  FUN_18005f100(local_58 ^ (ulonglong)&stack0xfffffffffffff3b8);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180033600(longlong param_1,longlong param_2,longlong param_3,int param_4,int param_5,
                  ulonglong *param_6)

{
  int iVar1;
  longlong *plVar2;
  int *piVar3;
  longlong *plVar4;
  longlong *plVar5;
  longlong lVar6;
  ulonglong uVar7;
  longlong lVar8;
  int iVar9;
  ulonglong uVar10;
  ulonglong uVar11;
  longlong lVar12;
  ulonglong *puVar13;
  longlong lVar14;
  longlong lVar15;
  longlong lVar16;
  longlong lVar17;
  undefined auStack2392 [32];
  int local_938;
  longlong local_930;
  longlong local_928;
  longlong local_920;
  longlong local_918;
  ulonglong *local_910;
  int local_908 [4];
  undefined8 local_8f8;
  undefined8 local_8f0;
  int iStack2280;
  int iStack2276;
  undefined8 local_8e0;
  ulonglong local_8d8 [4];
  longlong local_8b8;
  longlong local_8b0;
  longlong local_8a8;
  longlong local_8a0;
  longlong local_898;
  longlong local_888;
  longlong local_880;
  longlong local_878;
  longlong local_870;
  longlong local_868;
  longlong local_860;
  longlong local_858;
  longlong local_850;
  longlong local_848;
  ulonglong local_838 [68];
  longlong local_618;
  longlong local_610 [93];
  longlong local_328 [94];
  ulonglong local_38;

  local_38 = DAT_1800b04e8 ^ (ulonglong)auStack2392;
  local_910 = param_6;
  local_930 = (longlong)param_4;
  local_928 = param_1;
  local_918 = param_2;
  memset(&local_618,0,0x2e8);
  memset(local_838 + 6,0,0x1f0);
  memset(local_328,0,0x2e8);
  uVar10 = 0;
  iVar9 = 0;
  local_8d8[0] = 0;
  local_8d8[1] = 0;
  local_8d8[2] = 0;
  local_8d8[3] = 0;
  local_8b8 = 0;
  local_8b0 = 0;
  local_8a8 = 0;
  local_8a0 = 0;
  local_898 = 0;
  local_838[0] = 0;
  local_838[1] = 0;
  local_838[2] = 0;
  local_838[3] = 0;
  local_838[4] = 0;
  local_838[5] = 0;
  local_880 = 0;
  local_878 = 0;
  local_870 = 0;
  local_868 = 0;
  local_860 = 0;
  local_858 = 0;
  local_850 = 0;
  local_848 = 0;
  local_8f8 = 0;
  local_8e0 = 0x100;
  local_938 = 0;
  local_908[0] = 0x100;
  local_908[1] = 0;
  local_908[2] = 0;
  local_908[3] = 0x100;
  local_8f0._0_4_ = 0x100;
  local_8f0._4_4_ = 0;
  iStack2280 = 0;
  iStack2276 = 0;
  if (0 < param_4) {
    plVar5 = local_610;
    puVar13 = local_838 + 7;
    piVar3 = (int *)(param_1 + 4);
    uVar11 = uVar10;
    uVar7 = uVar10;
    do {
      if (*(char *)(uVar11 + param_3) != '\0') {
        uVar7 = (ulonglong)((int)uVar7 + 1);
        puVar13[-1] = (longlong)*(int *)((param_2 - param_1) + -4 + (longlong)piVar3);
        *puVar13 = (longlong)*(int *)((param_2 - param_1) + (longlong)piVar3);
        puVar13 = puVar13 + 2;
        plVar5[-1] = (longlong)piVar3[-1];
        *plVar5 = (longlong)*piVar3;
        plVar5[1] = 0x100;
        plVar5 = plVar5 + 3;
      }
      local_938 = (int)uVar7;
      uVar11 = uVar11 + 1;
      piVar3 = piVar3 + 2;
    } while ((longlong)uVar11 < local_930);
  }
  lVar8 = 3;
  plVar5 = &local_618;
  local_920 = 3;
  plVar4 = local_328;
  lVar15 = 3;
  do {
    lVar12 = 0x1f;
    plVar2 = plVar5;
    do {
      lVar17 = *plVar2;
      plVar2 = plVar2 + 3;
      *plVar4 = lVar17;
      plVar4 = plVar4 + 1;
      lVar12 = lVar12 + -1;
    } while (lVar12 != 0);
    plVar5 = plVar5 + 1;
    lVar15 = lVar15 + -1;
  } while (lVar15 != 0);
  lVar12 = (longlong)local_938;
  lVar17 = 3;
  lVar15 = 0x2c0;
  plVar5 = local_328;
  puVar13 = local_8d8;
  do {
    do {
      *puVar13 = 0;
      uVar11 = uVar10;
      if (0 < lVar12) {
        plVar2 = (longlong *)(lVar15 + (longlong)puVar13);
        plVar4 = plVar5;
        lVar14 = lVar12;
        do {
          lVar16 = *plVar4;
          plVar4 = plVar4 + 1;
          lVar6 = *plVar2;
          plVar2 = plVar2 + 3;
          uVar11 = uVar11 + lVar16 * lVar6;
          lVar14 = lVar14 + -1;
        } while (lVar14 != 0);
        *puVar13 = uVar11;
      }
      *puVar13 = (longlong)(uVar11 + 0x80) >> 8;
      puVar13 = puVar13 + 1;
      lVar8 = lVar8 + -1;
    } while (lVar8 != 0);
    lVar15 = lVar15 + -0x18;
    plVar5 = plVar5 + 0x1f;
    lVar8 = 3;
    lVar17 = lVar17 + -1;
  } while (lVar17 != 0);
  plVar5 = local_328;
  puVar13 = local_838;
  lVar15 = 3;
  local_888 = local_8b8 * local_898 - local_8a0 * local_8b0;
  local_880 = local_8d8[2] * local_8a0 - local_8d8[1] * local_898;
  local_878 = local_8d8[1] * local_8b0 - local_8d8[2] * local_8b8;
  lVar8 = 0x30;
  do {
    lVar17 = 2;
    do {
      *puVar13 = 0;
      uVar11 = uVar10;
      if (0 < lVar12) {
        plVar2 = (longlong *)(lVar8 + (longlong)puVar13);
        plVar4 = plVar5;
        lVar14 = lVar12;
        do {
          lVar16 = *plVar4;
          plVar4 = plVar4 + 1;
          lVar6 = *plVar2;
          plVar2 = plVar2 + 2;
          uVar11 = uVar11 + lVar16 * lVar6;
          lVar14 = lVar14 + -1;
        } while (lVar14 != 0);
        *puVar13 = uVar11;
      }
      *puVar13 = (longlong)(uVar11 + 0x80) >> 8;
      puVar13 = puVar13 + 1;
      lVar17 = lVar17 + -1;
    } while (lVar17 != 0);
    lVar8 = lVar8 + -0x10;
    plVar5 = plVar5 + 0x1f;
    lVar15 = lVar15 + -1;
  } while (lVar15 != 0);
  local_870 = local_8a8 * local_8b0 - local_8d8[3] * local_898;
  local_868 = local_898 * local_8d8[0] - local_8a8 * local_8d8[2];
  local_860 = local_8d8[3] * local_8d8[2] - local_8b0 * local_8d8[0];
  local_858 = local_8d8[3] * local_8a0 - local_8a8 * local_8b8;
  local_850 = local_8a8 * local_8d8[1] - local_8a0 * local_8d8[0];
  local_848 = local_8b8 * local_8d8[0] - local_8d8[3] * local_8d8[1];
  lVar8 = local_858 * local_8d8[2] + 0x80 +
          (local_888 * local_8d8[0] -
          (local_8d8[3] * local_898 - local_8a8 * local_8b0) * local_8d8[1]);
  lVar15 = lVar8 >> 8;
  if (lVar15 == 0) goto LAB_180033bca;
  lVar8 = lVar8 >> 9;
  piVar3 = local_908;
  plVar5 = &local_880;
  do {
    lVar12 = plVar5[-1];
    puVar13 = local_838;
    lVar17 = *plVar5;
    lVar16 = 2;
    lVar14 = plVar5[1];
    do {
      lVar6 = puVar13[4] * lVar14 + puVar13[2] * lVar17 + *puVar13 * lVar12;
      if (lVar6 < 0) {
        iVar1 = -(int)((lVar8 - lVar6) / lVar15);
      }
      else {
        iVar1 = (int)((lVar6 + lVar8) / lVar15);
      }
      *piVar3 = iVar1;
      puVar13 = puVar13 + 1;
      piVar3 = piVar3 + 1;
      lVar16 = lVar16 + -1;
    } while (lVar16 != 0);
    plVar5 = plVar5 + 3;
    local_920 = local_920 + -1;
    uVar11 = uVar10;
  } while (local_920 != 0);
  do {
    *(int *)((longlong)&local_8f0 + uVar11 * 4) = local_908[uVar11 * 2];
    (&iStack2276)[uVar11] = local_908[uVar11 * 2 + 1];
    uVar11 = uVar11 + 1;
  } while ((longlong)uVar11 < 3);
  if (local_930 < 1) {
LAB_180033b7f:
    lVar8 = 0x190000;
  }
  else {
    local_928 = local_928 - local_918;
    piVar3 = (int *)(local_918 + 4);
    uVar11 = uVar10;
    do {
      lVar15 = (longlong)*(int *)(local_928 + -4 + (longlong)piVar3);
      lVar8 = (longlong)
              (((int)((ulonglong)
                      ((longlong)*(int *)(local_928 + (longlong)piVar3) * (longlong)(int)local_8e0 +
                      lVar15 * iStack2276 + 0x80) >> 8) - *piVar3) + local_8e0._4_4_);
      lVar15 = (longlong)
               (((int)((ulonglong)
                       ((longlong)*(int *)(local_928 + (longlong)piVar3) * (longlong)local_8f0._4_4_
                        + 0x80 + lVar15 * (int)local_8f0) >> 8) - piVar3[-1]) + iStack2280);
      uVar7 = lVar15 * lVar15 + lVar8 * lVar8;
      if (uVar7 < 0x64000) {
        uVar10 = (ulonglong)((int)uVar10 + 1);
        uVar11 = uVar11 + uVar7;
      }
      iVar9 = (int)uVar10;
      piVar3 = piVar3 + 2;
      local_930 = local_930 + -1;
    } while (local_930 != 0);
    if (iVar9 == 0) goto LAB_180033b7f;
    lVar8 = (longlong)(((longlong)iVar9 >> 1) + uVar11) / (longlong)iVar9;
  }
  if ((((lVar8 < param_5) && (local_938 <= iVar9)) && (local_910 != (ulonglong *)0x0)) &&
     ((local_8d8 <= local_910 || (local_910 + 3 <= &local_8f0)))) {
    *(int *)local_910 = (int)local_8f0;
    *(int *)((longlong)local_910 + 4) = local_8f0._4_4_;
    *(int *)(local_910 + 1) = iStack2280;
    *(int *)((longlong)local_910 + 0xc) = iStack2276;
    local_910[2] = local_8e0;
  }
LAB_180033bca:
  FUN_18005f100(local_38 ^ (ulonglong)auStack2392);
  return;
}



void FUN_180033c00(longlong param_1,longlong param_2,longlong param_3,longlong param_4,
                  longlong param_5,int param_6,longlong param_7,int param_8,longlong param_9,
                  longlong param_10,longlong param_11)

{
  uint *puVar1;
  byte bVar2;
  byte bVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  ulonglong uVar8;
  longlong lVar9;
  longlong lVar10;
  longlong lVar11;
  ulonglong uVar12;
  uint *puVar13;
  ulonglong uVar14;
  longlong local_58;

  iVar4 = *(int *)(param_11 + 0x20);
  if (0 < param_6) {
    local_58 = 0;
    do {
      lVar10 = 0;
      bVar2 = *(byte *)(local_58 + param_5);
      uVar8 = (ulonglong)bVar2;
      if (0 < param_8) {
        uVar12 = (ulonglong)(uint)bVar2;
        uVar14 = (ulonglong)((uint)bVar2 + (uint)bVar2);
        do {
          bVar3 = *(byte *)(param_7 + lVar10);
          uVar6 = (uint)bVar2 * 0xb4 + (uint)bVar3;
          if (*(char *)((ulonglong)uVar6 + param_3) != -1) {
            puVar13 = (uint *)(param_1 + 0x28 + uVar12 * 0x38);
            iVar7 = 0;
            lVar9 = (param_2 + 0x28 + (ulonglong)bVar3 * 0x38) - (longlong)puVar13;
            if (*(char *)((ulonglong)uVar6 + param_4) == '\0') {
              lVar11 = 2;
              do {
                uVar6 = *puVar13;
                puVar1 = (uint *)(lVar9 + 8 + (longlong)puVar13);
                puVar13 = puVar13 + 1;
                uVar12 = SEXT48((int)(*puVar1 ^ uVar6));
                iVar7 = iVar7 + *(int *)(&DAT_18007c6f0 + ((longlong)uVar12 >> 0x18 & 0xffU) * 4) +
                                *(int *)(&DAT_18007c6f0 + ((longlong)uVar12 >> 0x10 & 0xffU) * 4) +
                                *(int *)(&DAT_18007c6f0 + ((longlong)uVar12 >> 8 & 0xffU) * 4) +
                                *(int *)(&DAT_18007c6f0 + (uVar12 & 0xff) * 4);
                lVar11 = lVar11 + -1;
              } while (lVar11 != 0);
            }
            else {
              lVar11 = 2;
              do {
                uVar6 = *puVar13;
                puVar1 = (uint *)(lVar9 + (longlong)puVar13);
                puVar13 = puVar13 + 1;
                uVar12 = SEXT48((int)(*puVar1 ^ uVar6));
                iVar7 = iVar7 + *(int *)(&DAT_18007c6f0 + ((longlong)uVar12 >> 0x18 & 0xffU) * 4) +
                                *(int *)(&DAT_18007c6f0 + ((longlong)uVar12 >> 0x10 & 0xffU) * 4) +
                                *(int *)(&DAT_18007c6f0 + ((longlong)uVar12 >> 8 & 0xffU) * 4) +
                                *(int *)(&DAT_18007c6f0 + (uVar12 & 0xff) * 4);
                lVar11 = lVar11 + -1;
              } while (lVar11 != 0);
            }
            uVar12 = uVar8;
            if (iVar7 <= iVar4) {
              iVar5 = *(int *)(param_9 + uVar14 * 4);
              if (iVar7 < iVar5) {
                *(int *)(param_9 + 4 + uVar14 * 4) = iVar5;
                *(undefined4 *)(param_10 + 4 + uVar14 * 4) = *(undefined4 *)(param_10 + uVar14 * 4);
                *(uint *)(param_10 + uVar14 * 4) = (uint)bVar3;
                *(int *)(param_9 + uVar14 * 4) = iVar7;
              }
              else {
                if (iVar7 < *(int *)(param_9 + 4 + uVar14 * 4)) {
                  *(int *)(param_9 + 4 + uVar14 * 4) = iVar7;
                  *(uint *)(param_10 + 4 + uVar14 * 4) = (uint)bVar3;
                }
              }
            }
          }
          lVar10 = lVar10 + 1;
        } while (lVar10 < param_8);
      }
      local_58 = local_58 + 1;
    } while (local_58 < param_6);
  }
  return;
}



void FUN_180033ec0(longlong param_1,longlong param_2,longlong param_3,longlong param_4,
                  longlong param_5,longlong param_6,longlong param_7,longlong param_8,
                  longlong param_9)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  ulonglong uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int *piVar8;
  undefined *puVar9;
  ulonglong uVar10;
  int iVar11;
  undefined *puVar12;
  longlong local_378;
  longlong local_370;
  longlong local_368;
  longlong local_360;
  longlong local_358;
  longlong local_350;
  undefined local_348 [192];
  undefined local_288 [192];
  undefined local_1c8 [192];
  undefined local_108 [192];
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffc28;
  iVar5 = 0;
  local_370 = param_6;
  iVar7 = 0;
  uVar4 = SEXT48(*(int *)(param_5 + 8));
  iVar6 = 0;
  iVar11 = *(int *)(param_5 + 0xc);
  iVar1 = *(int *)(param_5 + 0x10);
  uVar10 = SEXT48(iVar1);
  iVar2 = *(int *)(param_5 + 0x14);
  local_378 = param_7;
  local_350 = param_8;
  local_358 = param_9;
  if (*(int *)(param_5 + 8) < iVar11) {
    piVar8 = (int *)(param_1 + 0xc + uVar4 * 0x38);
    puVar9 = local_288;
    puVar12 = local_108;
    do {
      if (*piVar8 == 1) {
        iVar7 = iVar7 + 1;
        *puVar9 = (char)uVar4;
        puVar9 = puVar9 + 1;
      }
      else {
        if (*piVar8 == 2) {
          iVar6 = iVar6 + 1;
          *puVar12 = (char)uVar4;
          puVar12 = puVar12 + 1;
        }
      }
      uVar3 = (int)uVar4 + 1;
      uVar4 = (ulonglong)uVar3;
      piVar8 = piVar8 + 0xe;
    } while ((int)uVar3 < iVar11);
  }
  iVar11 = 0;
  if (iVar1 < iVar2) {
    piVar8 = (int *)(param_2 + 0xc + uVar10 * 0x38);
    puVar9 = local_1c8;
    puVar12 = local_348;
    iVar11 = 0;
    do {
      if (*piVar8 == 1) {
        iVar5 = iVar5 + 1;
        *puVar9 = (char)uVar10;
        puVar9 = puVar9 + 1;
      }
      else {
        if (*piVar8 == 2) {
          iVar11 = iVar11 + 1;
          *puVar12 = (char)uVar10;
          puVar12 = puVar12 + 1;
        }
      }
      uVar3 = (int)uVar10 + 1;
      uVar10 = (ulonglong)uVar3;
      piVar8 = piVar8 + 0xe;
    } while ((int)uVar3 < iVar2);
  }
  local_368 = param_4;
  local_360 = param_3;
  FUN_180033c00(param_1,param_2,param_3,param_4,(longlong)local_288,iVar7,(longlong)local_348,iVar11
                ,param_6,param_7,param_5);
  FUN_180033c00(param_1,param_2,local_360,local_368,(longlong)local_108,iVar6,(longlong)local_1c8,
                iVar5,local_350,local_358,param_5);
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xfffffffffffffc28);
  return;
}



void FUN_1800340c0(undefined4 *param_1,longlong param_2,undefined8 param_3,undefined8 param_4,
                  undefined8 param_5,undefined8 param_6,longlong param_7,longlong param_8)

{
  undefined4 uVar1;
  int iVar2;
  undefined8 uVar3;
  longlong lVar4;
  longlong lVar5;
  longlong lVar6;
  longlong lVar7;
  longlong lVar8;
  int iVar9;
  ulonglong uVar10;
  uint uVar11;
  ulonglong uVar12;
  int iVar13;
  undefined4 *puVar14;
  int *piVar15;
  undefined *puVar16;
  undefined *puVar17;
  int iVar18;
  int iVar19;
  int iVar20;
  int iVar21;
  int *piStackX8;
  longlong *aplStackX16 [2];
  longlong lStackX32;
  undefined8 local_19f0;
  undefined8 local_19e8;
  int local_19d8 [360];
  undefined4 local_1438 [360];
  int local_e98 [360];
  undefined4 local_8f8 [360];
  undefined local_358 [192];
  undefined local_298 [192];
  undefined local_1d8 [192];
  undefined local_118 [192];
  ulonglong local_58;
  undefined8 uStack72;

  uStack72 = 0x1800340df;
  lVar8 = _alloca_probe();
  lVar8 = -lVar8;
  local_58 = DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffc0 + lVar8);
  uVar3 = *(undefined8 *)(param_2 + 0xf8);
  lVar4 = *(longlong *)(param_1 + 0x3e);
  iVar18 = param_1[0x3c];
  *(int *)((longlong)&param_6 + lVar8) = iVar18;
  iVar18 = iVar18 * 2;
  *(undefined8 *)((longlong)aplStackX16 + lVar8 + 0x10) = uVar3;
  uVar1 = *(undefined4 *)(param_2 + 0xf0);
  *(longlong *)((longlong)&param_5 + lVar8) = lVar4;
  *(undefined4 *)((longlong)&param_6 + lVar8 + 4) = uVar1;
  if (0 < iVar18) {
    uVar12 = (longlong)iVar18 & 0x3fffffffffffffff;
    uVar10 = (longlong)iVar18 & 0x3fffffffffffffff;
    puVar14 = local_1438;
    while (uVar10 != 0) {
      uVar10 = uVar10 - 1;
      *puVar14 = 0xc0;
      puVar14 = puVar14 + 1;
    }
    piVar15 = local_19d8;
    while (uVar12 != 0) {
      uVar12 = uVar12 - 1;
      *piVar15 = -1;
      piVar15 = piVar15 + 1;
    }
  }
  iVar13 = 0;
  if (0 < iVar18) {
    uVar12 = (longlong)iVar18 & 0x3fffffffffffffff;
    uVar10 = (longlong)iVar18 & 0x3fffffffffffffff;
    puVar14 = local_8f8;
    while (uVar10 != 0) {
      uVar10 = uVar10 - 1;
      *puVar14 = 0xc0;
      puVar14 = puVar14 + 1;
    }
    piVar15 = local_e98;
    while (uVar12 != 0) {
      uVar12 = uVar12 - 1;
      *piVar15 = -1;
      piVar15 = piVar15 + 1;
    }
  }
  iVar20 = 0;
  iVar21 = 0;
  iVar18 = param_1[0x42];
  iVar2 = *(int *)(param_2 + 0x108);
  *(undefined4 *)((longlong)&param_7 + lVar8) = *param_1;
  lVar6 = param_7;
  *(undefined4 *)((longlong)&param_7 + lVar8 + 4) = param_1[1];
  lVar7 = param_8;
  iVar9 = 0;
  if (0 < iVar18) {
    puVar16 = local_298;
    puVar17 = local_118;
    piVar15 = (int *)(lVar4 + 0xc);
    do {
      if (*piVar15 == 1) {
        iVar20 = iVar20 + 1;
        *puVar16 = (char)iVar9;
        puVar16 = puVar16 + 1;
      }
      else {
        if (*piVar15 == 2) {
          iVar21 = iVar21 + 1;
          *puVar17 = (char)iVar9;
          puVar17 = puVar17 + 1;
        }
      }
      iVar9 = iVar9 + 1;
      piVar15 = piVar15 + 0xe;
    } while (iVar9 < iVar18);
  }
  iVar19 = 0;
  iVar18 = 0;
  iVar9 = 0;
  if (0 < iVar2) {
    puVar16 = local_1d8;
    piVar15 = (int *)(*(longlong *)((longlong)aplStackX16 + lVar8 + 0x10) + 0xc);
    puVar17 = local_358;
    iVar18 = 0;
    do {
      if (*piVar15 == 1) {
        iVar19 = iVar19 + 1;
        *puVar16 = (char)iVar9;
        puVar16 = puVar16 + 1;
      }
      else {
        if (*piVar15 == 2) {
          iVar18 = iVar18 + 1;
          *puVar17 = (char)iVar9;
          puVar17 = puVar17 + 1;
        }
      }
      iVar9 = iVar9 + 1;
      piVar15 = piVar15 + 0xe;
    } while (iVar9 < iVar2);
  }
  lVar4 = *(longlong *)((longlong)aplStackX16 + lVar8 + 0x10);
  lVar5 = *(longlong *)((longlong)&param_5 + lVar8);
  *(longlong **)((longlong)aplStackX16 + lVar8) = (longlong *)((longlong)&param_7 + lVar8);
  *(int **)((longlong)&piStackX8 + lVar8) = local_19d8;
  local_19f0 = param_3;
  local_19e8 = param_4;
  *(undefined4 **)((longlong)aplStackX16 + lVar8 + -0x10) = local_1438;
  *(int *)(&stack0xfffffffffffffff8 + lVar8) = iVar18;
  *(undefined **)(&stack0xfffffffffffffff0 + lVar8) = local_358;
  *(int *)(&stack0xffffffffffffffe8 + lVar8) = iVar20;
  *(undefined **)(&stack0xffffffffffffffe0 + lVar8) = local_298;
  *(undefined8 *)((longlong)&uStack72 + lVar8) = 0x1800342d8;
  FUN_180033c00(lVar5,lVar4,lVar6,lVar7,*(longlong *)(&stack0xffffffffffffffe0 + lVar8),
                *(int *)(&stack0xffffffffffffffe8 + lVar8),
                *(longlong *)(&stack0xfffffffffffffff0 + lVar8),
                *(int *)(&stack0xfffffffffffffff8 + lVar8),
                *(longlong *)((longlong)aplStackX16 + lVar8 + -0x10),
                (longlong)*(int **)((longlong)&piStackX8 + lVar8),
                (longlong)*(longlong **)((longlong)aplStackX16 + lVar8));
  lVar5 = param_8;
  lVar7 = param_7;
  lVar4 = *(longlong *)((longlong)aplStackX16 + lVar8 + 0x10);
  lVar6 = *(longlong *)((longlong)&param_5 + lVar8);
  *(longlong **)((longlong)aplStackX16 + lVar8) = (longlong *)((longlong)&param_7 + lVar8);
  *(int **)((longlong)&piStackX8 + lVar8) = local_e98;
  *(undefined4 **)((longlong)aplStackX16 + lVar8 + -0x10) = local_8f8;
  *(int *)(&stack0xfffffffffffffff8 + lVar8) = iVar19;
  *(undefined **)(&stack0xfffffffffffffff0 + lVar8) = local_1d8;
  *(int *)(&stack0xffffffffffffffe8 + lVar8) = iVar21;
  *(undefined **)(&stack0xffffffffffffffe0 + lVar8) = local_118;
  *(undefined8 *)((longlong)&uStack72 + lVar8) = 0x180034338;
  FUN_180033c00(lVar6,lVar4,lVar7,lVar5,*(longlong *)(&stack0xffffffffffffffe0 + lVar8),
                *(int *)(&stack0xffffffffffffffe8 + lVar8),
                *(longlong *)(&stack0xfffffffffffffff0 + lVar8),
                *(int *)(&stack0xfffffffffffffff8 + lVar8),
                *(longlong *)((longlong)aplStackX16 + lVar8 + -0x10),
                (longlong)*(int **)((longlong)&piStackX8 + lVar8),
                (longlong)*(longlong **)((longlong)aplStackX16 + lVar8));
  lVar7 = param_8;
  lVar6 = param_7;
  uVar10 = SEXT48((int)param_1[0x42]);
  iVar20 = 0;
  iVar18 = *(int *)((longlong)&param_6 + lVar8);
  iVar21 = 0;
  iVar2 = *(int *)(param_2 + 0x108);
  uVar12 = SEXT48(iVar2);
  iVar9 = *(int *)((longlong)&param_6 + lVar8 + 4);
  lVar4 = *(longlong *)((longlong)&param_5 + lVar8);
  if ((int)param_1[0x42] < iVar18) {
    piVar15 = (int *)(lVar4 + 0xc + uVar10 * 0x38);
    puVar16 = local_1d8;
    puVar17 = local_358;
    iVar20 = 0;
    do {
      if (*piVar15 == 1) {
        iVar20 = iVar20 + 1;
        *puVar16 = (char)uVar10;
        puVar16 = puVar16 + 1;
      }
      else {
        if (*piVar15 == 2) {
          iVar21 = iVar21 + 1;
          *puVar17 = (char)uVar10;
          puVar17 = puVar17 + 1;
        }
      }
      uVar11 = (int)uVar10 + 1;
      uVar10 = (ulonglong)uVar11;
      piVar15 = piVar15 + 0xe;
    } while ((int)uVar11 < iVar18);
  }
  lVar5 = *(longlong *)((longlong)aplStackX16 + lVar8 + 0x10);
  iVar19 = 0;
  if (iVar2 < iVar9) {
    piVar15 = (int *)(lVar5 + 0xc + uVar12 * 0x38);
    puVar16 = local_298;
    puVar17 = local_118;
    iVar19 = 0;
    do {
      if (*piVar15 == 1) {
        iVar13 = iVar13 + 1;
        *puVar16 = (char)uVar12;
        puVar16 = puVar16 + 1;
      }
      else {
        if (*piVar15 == 2) {
          iVar19 = iVar19 + 1;
          *puVar17 = (char)uVar12;
          puVar17 = puVar17 + 1;
        }
      }
      uVar11 = (int)uVar12 + 1;
      uVar12 = (ulonglong)uVar11;
      piVar15 = piVar15 + 0xe;
    } while ((int)uVar11 < iVar9);
  }
  *(longlong **)((longlong)aplStackX16 + lVar8) = (longlong *)((longlong)&param_7 + lVar8);
  *(int **)((longlong)&piStackX8 + lVar8) = local_19d8;
  *(undefined4 **)((longlong)aplStackX16 + lVar8 + -0x10) = local_1438;
  *(int *)(&stack0xfffffffffffffff8 + lVar8) = iVar19;
  *(undefined **)(&stack0xfffffffffffffff0 + lVar8) = local_118;
  *(int *)(&stack0xffffffffffffffe8 + lVar8) = iVar20;
  *(undefined **)(&stack0xffffffffffffffe0 + lVar8) = local_1d8;
  *(undefined8 *)((longlong)&uStack72 + lVar8) = 0x180034464;
  FUN_180033c00(lVar4,lVar5,lVar6,lVar7,*(longlong *)(&stack0xffffffffffffffe0 + lVar8),
                *(int *)(&stack0xffffffffffffffe8 + lVar8),
                *(longlong *)(&stack0xfffffffffffffff0 + lVar8),
                *(int *)(&stack0xfffffffffffffff8 + lVar8),
                *(longlong *)((longlong)aplStackX16 + lVar8 + -0x10),
                (longlong)*(int **)((longlong)&piStackX8 + lVar8),
                (longlong)*(longlong **)((longlong)aplStackX16 + lVar8));
  lVar7 = param_8;
  lVar6 = param_7;
  *(longlong **)((longlong)aplStackX16 + lVar8) = (longlong *)((longlong)&param_7 + lVar8);
  *(int **)((longlong)&piStackX8 + lVar8) = local_e98;
  *(undefined4 **)((longlong)aplStackX16 + lVar8 + -0x10) = local_8f8;
  *(int *)(&stack0xfffffffffffffff8 + lVar8) = iVar13;
  *(undefined **)(&stack0xfffffffffffffff0 + lVar8) = local_298;
  *(int *)(&stack0xffffffffffffffe8 + lVar8) = iVar21;
  *(undefined **)(&stack0xffffffffffffffe0 + lVar8) = local_358;
  *(undefined8 *)((longlong)&uStack72 + lVar8) = 0x1800344bf;
  FUN_180033c00(lVar4,lVar5,lVar6,lVar7,*(longlong *)(&stack0xffffffffffffffe0 + lVar8),
                *(int *)(&stack0xffffffffffffffe8 + lVar8),
                *(longlong *)(&stack0xfffffffffffffff0 + lVar8),
                *(int *)(&stack0xfffffffffffffff8 + lVar8),
                *(longlong *)((longlong)aplStackX16 + lVar8 + -0x10),
                (longlong)*(int **)((longlong)&piStackX8 + lVar8),
                (longlong)*(longlong **)((longlong)aplStackX16 + lVar8));
  uVar3 = param_5;
  *(undefined8 *)(&stack0xfffffffffffffff0 + lVar8) = local_19f0;
  *(undefined8 *)(&stack0xffffffffffffffe8 + lVar8) = param_5;
  *(undefined8 *)((longlong)&uStack72 + lVar8) = 0x1800344ea;
  FUN_180032530(lVar5,(longlong)local_1438,local_19d8,iVar18,
                *(undefined8 *)(&stack0xffffffffffffffe0 + lVar8),
                *(longlong *)(&stack0xffffffffffffffe8 + lVar8),
                *(longlong *)(&stack0xfffffffffffffff0 + lVar8));
  *(undefined8 *)(&stack0xfffffffffffffff0 + lVar8) = local_19e8;
  *(undefined8 *)(&stack0xffffffffffffffe8 + lVar8) = uVar3;
  *(undefined8 *)((longlong)&uStack72 + lVar8) = 0x180034511;
  FUN_180032530(lVar5,(longlong)local_8f8,local_e98,iVar18,
                *(undefined8 *)(&stack0xffffffffffffffe0 + lVar8),
                *(longlong *)(&stack0xffffffffffffffe8 + lVar8),
                *(longlong *)(&stack0xfffffffffffffff0 + lVar8));
  *(undefined8 *)((longlong)&uStack72 + lVar8) = 0x180034520;
  FUN_18005f100(local_58 ^ (ulonglong)(&stack0xffffffffffffffc0 + lVar8),
                *(undefined *)((longlong)&uStack72 + lVar8));
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180034540(longlong param_1,longlong param_2,int *param_3,int *param_4,longlong param_5,
                  longlong param_6)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  longlong lVar4;
  ulonglong uVar5;
  longlong lVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  ushort *puVar10;
  ulonglong uVar11;
  longlong lVar12;
  undefined auStack200 [32];
  uint local_a8;
  int local_a4;
  ushort *local_a0;
  int *local_98;
  longlong local_90;
  longlong local_88;
  int local_80;
  int local_7c;
  ushort *local_78;
  longlong local_70;
  int local_68;
  int iStack100;
  int iStack96;
  int iStack92;
  undefined8 local_58;
  ulonglong local_50;

  local_50 = DAT_1800b04e8 ^ (ulonglong)auStack200;
  local_58._4_4_ = 0;
  local_80 = param_4[8];
  local_58 = 0x100;
  local_68 = 0x100;
  iStack100 = 0;
  iStack96 = 0;
  iStack92 = 0;
  local_98 = param_3;
  local_90 = param_2;
  local_88 = param_1;
  if (param_3 != (int *)0x0) {
    FUN_180023cd0(param_3,&local_68);
  }
  local_a8 = param_4[2];
  uVar11 = SEXT48((int)local_a8);
  if ((int)local_a8 < param_4[3]) {
    local_7c = iStack96 << 8;
    puVar10 = (ushort *)(param_1 + 4 + uVar11 * 0x38);
    local_58._4_4_ = local_58._4_4_ << 8;
    local_70 = param_5 - param_6;
    lVar12 = uVar11 * 8;
    local_a4 = local_58._4_4_;
    do {
      iVar7 = (int)uVar11;
      iVar8 = ((int)(local_7c + (uint)*puVar10 * iStack100 + (uint)puVar10[-1] * local_68 + 0x80) >>
              8) + 0x80 >> 8;
      iVar3 = ((int)((uint)*puVar10 * (int)local_58 + 0x80 + local_58._4_4_ +
                    (uint)puVar10[-1] * iStack92) >> 8) + 0x80 >> 8;
      if ((((iVar8 < *param_4 + -5) && (iVar3 < param_4[1] + -5)) && (5 < iVar8)) &&
         ((5 < iVar3 &&
          (uVar5 = SEXT48(param_4[4]), local_58._4_4_ = local_a4, param_4[4] < param_4[5])))) {
        local_78 = (ushort *)(uVar5 * 0x38 + 4 + param_2);
        local_a0 = puVar10;
        do {
          iVar9 = param_3[1] * (uint)*local_78 + *param_3 * (uint)local_78[-1] + param_3[2] * 0x100;
          iVar7 = (uint)*local_78 * param_3[4] + (uint)local_78[-1] * param_3[3] +
                  param_3[5] * 0x100;
          iVar8 = iVar9 >> 8;
          iVar3 = iVar8 - (uint)puVar10[-1];
          if (iVar3 < 1) {
            iVar3 = (uint)puVar10[-1] - iVar8;
          }
          iVar8 = (int)uVar5;
          if (iVar3 < 0x1501) {
            iVar2 = iVar7 >> 8;
            iVar3 = iVar2 - (uint)*puVar10;
            if (iVar3 < 1) {
              iVar3 = (uint)*puVar10 - iVar2;
            }
            if (iVar3 < 0x1501) {
              iVar9 = (iVar9 + 0x80 >> 8) + 0x80 >> 8;
              iVar3 = (iVar7 + 0x80 >> 8) + 0x80 >> 8;
              if (((iVar9 <= *param_4 + -5) && (iVar3 <= param_4[1] + -5)) &&
                 ((5 < iVar9 && (5 < iVar3)))) {
                lVar6 = param_1 + (longlong)(int)uVar11 * 0x38;
                lVar4 = (longlong)iVar8 * 0x38 + param_2;
                uVar11 = FUN_180031550(lVar6 + 0x28,(uint *)(lVar4 + 0x28),2);
                uVar5 = FUN_180031550(lVar6 + 0x28,(uint *)(lVar4 + 0x30),2);
                iVar3 = (int)uVar11;
                if ((int)uVar5 < (int)uVar11) {
                  iVar3 = (int)uVar5;
                }
                if (iVar3 <= local_80) {
                  piVar1 = (int *)(lVar12 + param_6);
                  if (iVar3 < *(int *)(local_70 + (longlong)piVar1)) {
                    *(int *)(param_5 + 4 + lVar12) = *(int *)(local_70 + (longlong)piVar1);
                    *(int *)(lVar12 + 4 + param_6) = *piVar1;
                    *(int *)(local_70 + (longlong)piVar1) = iVar3;
                    *piVar1 = iVar8;
                  }
                  else {
                    if (iVar3 < *(int *)(param_5 + 4 + lVar12)) {
                      *(int *)(param_5 + 4 + lVar12) = iVar3;
                      *(int *)(lVar12 + 4 + param_6) = iVar8;
                    }
                  }
                }
                uVar11 = (ulonglong)local_a8;
                param_3 = local_98;
                param_2 = local_90;
                param_1 = local_88;
                puVar10 = local_a0;
              }
            }
          }
          iVar7 = (int)uVar11;
          uVar5 = (ulonglong)(iVar8 + 1U);
          local_78 = local_78 + 0x1c;
          local_58._4_4_ = local_a4;
        } while ((int)(iVar8 + 1U) < param_4[5]);
      }
      local_a8 = iVar7 + 1;
      uVar11 = (ulonglong)local_a8;
      puVar10 = puVar10 + 0x1c;
      lVar12 = lVar12 + 8;
      local_a0 = puVar10;
    } while ((int)local_a8 < param_4[3]);
  }
  FUN_18005f100(local_50 ^ (ulonglong)auStack200);
  return;
}



void FUN_180034a50(int *param_1,longlong param_2,int *param_3,int param_4,undefined8 *param_5,
                  longlong param_6,int param_7)

{
  int iVar1;
  int iVar2;
  int iVar3;
  longlong lVar4;
  longlong lVar5;
  longlong lVar6;
  int iVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  int iVar10;
  longlong lVar11;
  int iVar12;
  int iVar13;
  ushort *puVar14;
  int iVar15;
  longlong lVar16;
  int iVar17;
  ushort *puVar18;
  int iVar19;
  longlong local_60;

  iVar12 = *(int *)(param_2 + 0xf0);
  local_60 = (longlong)iVar12;
  iVar1 = *param_1;
  iVar2 = param_1[1];
  lVar4 = *(longlong *)(param_2 + 0xf8);
  lVar5 = *(longlong *)(param_1 + 0x3e);
  iVar3 = param_1[0x3c];
  if (param_5 != (undefined8 *)0x0) {
    *param_5 = 0;
    param_5[1] = 0;
    param_5[2] = 0;
  }
  param_5._0_4_ = 0;
  if (0 < iVar12) {
    puVar18 = (ushort *)(lVar4 + 4);
    do {
      lVar11 = (longlong)param_3[1] * (ulonglong)*puVar18 +
               (longlong)*param_3 * (ulonglong)puVar18[-1] + (longlong)param_3[2] * 0x100;
      if (lVar11 < 1) {
        iVar12 = -(int)((ulonglong)(0x80 - lVar11) >> 8);
      }
      else {
        iVar12 = (int)((ulonglong)(lVar11 + 0x80) >> 8);
      }
      if ((0x5ff < iVar12) && (iVar12 < (iVar1 + -7) * 0x100)) {
        lVar11 = (longlong)param_3[3] * (ulonglong)puVar18[-1] +
                 (longlong)param_3[4] * (ulonglong)*puVar18 + (longlong)param_3[5] * 0x100;
        if (lVar11 < 1) {
          iVar17 = -(int)((ulonglong)(0x80 - lVar11) >> 8);
        }
        else {
          iVar17 = (int)((ulonglong)(lVar11 + 0x80) >> 8);
        }
        if ((0x5ff < iVar17) && (iVar17 < (iVar2 + -7) * 0x100)) {
          *(int *)param_5 = *(int *)param_5 + 1;
          iVar19 = -1;
          lVar11 = -1;
          iVar15 = 0;
          lVar16 = 0;
          iVar13 = 0x7fffffff;
          if (0 < iVar3) {
            puVar14 = (ushort *)(lVar5 + 4);
            do {
              if ((puVar14[-2] & 3) == (puVar18[-2] & 3)) {
                iVar7 = iVar12 - (uint)puVar14[-1];
                if (iVar7 < 1) {
                  iVar7 = (uint)puVar14[-1] - iVar12;
                }
                if (iVar7 < 0x201) {
                  iVar10 = iVar17 - (uint)*puVar14;
                  if (iVar10 < 1) {
                    iVar10 = (uint)*puVar14 - iVar17;
                  }
                  if ((iVar10 < 0x201) && (iVar7 = iVar7 * iVar7 + iVar10 * iVar10, iVar7 < iVar13))
                  {
                    lVar11 = lVar16;
                    iVar13 = iVar7;
                    iVar19 = iVar15;
                  }
                }
              }
              iVar15 = iVar15 + 1;
              lVar16 = lVar16 + 1;
              puVar14 = puVar14 + 0x1c;
            } while (iVar15 < iVar3);
            if ((-1 < iVar19) && (iVar13 < 0x40000)) {
              if (param_7 - 9U < 2) {
                lVar16 = *(longlong *)(param_2 + 0xf8);
                lVar6 = *(longlong *)(param_1 + 0x3e);
                uVar8 = FUN_180031550((longlong)iVar19 * 0x38 + 0x1c + lVar6,
                                      (uint *)((longlong)(int)param_5 * 0x38 + 0x1c + lVar16),1);
                iVar12 = (int)uVar8;
                if (((iVar12 < 6) && (*(char *)(lVar11 + param_6) == '\0')) &&
                   ((0 < *(int *)(lVar11 * 0x38 + 0xc + lVar6) ||
                    (0 < *(int *)((lVar16 - lVar4) + 8 + (longlong)puVar18))))) {
                  *(int *)((longlong)param_5 + 0x14) = *(int *)((longlong)param_5 + 0x14) + 1;
                }
              }
              else {
                lVar16 = (longlong)(int)param_5 * 0x38 + *(longlong *)(param_2 + 0xf8);
                lVar11 = (longlong)iVar19 * 0x38 + *(longlong *)(param_1 + 0x3e);
                uVar8 = FUN_180031550(lVar11 + 0x28,(uint *)(lVar16 + 0x28),2);
                uVar9 = FUN_180031550(lVar11 + 0x28,(uint *)(lVar16 + 0x30),2);
                iVar12 = (int)uVar8;
                if ((int)uVar9 < (int)uVar8) {
                  iVar12 = (int)uVar9;
                }
              }
              *(int *)((longlong)param_5 + 4) = *(int *)((longlong)param_5 + 4) + 1;
              *(int *)(param_5 + 2) = *(int *)(param_5 + 2) + iVar12;
            }
          }
        }
      }
      param_5._0_4_ = (int)param_5 + 1;
      puVar18 = puVar18 + 0x1c;
      local_60 = local_60 + -1;
    } while (local_60 != 0);
  }
  iVar12 = *(int *)((longlong)param_5 + 4);
  if (0 < iVar12) {
    *(int *)(param_5 + 2) = *(int *)(param_5 + 2) / iVar12;
  }
  iVar1 = *(int *)param_5;
  if (0 < iVar1) {
    *(int *)(param_5 + 1) = (iVar12 * 100) / iVar1;
    *(int *)((longlong)param_5 + 0xc) = (param_4 * 100) / iVar1;
  }
  return;
}



ulonglong FUN_180034df0(uint param_1)

{
  ushort uVar1;
  ushort uVar2;
  uint *puVar3;
  uint uVar4;
  uint local_58 [4];
  uint local_48 [4];
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;

  puVar3 = local_58;
  local_58[0] = 0x58b90;
  uVar1 = 0;
  local_58[1] = 0x2c5c8;
  uVar2 = 0;
  local_58[2] = 0x162e4;
  local_58[3] = 0xb172;
  local_48[0] = 0x67cd;
  uVar4 = 0x10000;
  local_48[1] = 0x3920;
  local_48[2] = 0x1e27;
  local_48[3] = 0xf85;
  local_38 = 0x7e1;
  local_34 = 0x3f8;
  local_30 = 0x1fe;
  local_2c = 0x100;
  local_28 = 0x80;
  local_24 = 0x40;
  local_20 = 0x20;
  local_1c = 0x10;
  local_18 = 8;
  local_14 = 4;
  local_10 = 2;
  local_c = 1;
  do {
    if (*puVar3 < param_1) {
      param_1 = param_1 - *puVar3;
      uVar4 = uVar4 << ((byte)(1 << (3U - (char)uVar2 & 0x1f)) & 0x1f);
    }
    uVar2 = uVar2 + 1;
    puVar3 = puVar3 + 1;
  } while (uVar2 < 4);
  puVar3 = local_48;
  do {
    if (*puVar3 < param_1) {
      param_1 = param_1 - *puVar3;
      uVar4 = uVar4 + (uVar4 >> ((char)uVar1 + 1U & 0x1f));
    }
    uVar1 = uVar1 + 1;
    puVar3 = puVar3 + 1;
  } while (uVar1 < 0x10);
  return (ulonglong)uVar4;
}



ulonglong FUN_1800350d0(uint *param_1,uint *param_2)

{
  short sVar1;
  uint uVar2;
  uint uVar3;
  ushort uVar4;
  uint uVar5;
  ulonglong uVar6;
  uint uVar7;
  short *psVar8;
  ushort uVar9;
  uint uVar11;
  int iVar12;
  int iVar13;
  ulonglong uVar10;

  uVar2 = *param_2;
  uVar3 = *param_1;
  uVar6 = 0;
  uVar11 = (uVar2 ^ (int)uVar2 >> 0x1f) - ((int)uVar2 >> 0x1f);
  uVar5 = (uVar3 ^ (int)uVar3 >> 0x1f) - ((int)uVar3 >> 0x1f);
  if (uVar5 == 0) {
    *param_2 = uVar11;
    if ((int)uVar2 < 1) {
      uVar6 = 0x3244;
    }
  }
  else {
    if (uVar11 == 0) {
      *param_2 = uVar5;
      if ((int)uVar3 < 1) {
        uVar6 = 0xffffe6de;
      }
      else {
        uVar6 = 0x1922;
      }
    }
    else {
      psVar8 = &DAT_18007d310;
      uVar10 = uVar6;
      do {
        iVar12 = (int)uVar5 >> ((byte)uVar6 & 0x1f);
        iVar13 = (int)uVar11 >> ((byte)uVar6 & 0x1f);
        if ((int)uVar5 < 1) {
          iVar12 = -iVar12;
          sVar1 = -*psVar8;
        }
        else {
          iVar13 = -iVar13;
          sVar1 = *psVar8;
        }
        uVar5 = uVar5 + iVar13;
        uVar11 = uVar11 + iVar12;
        uVar9 = (short)uVar10 + sVar1;
        uVar10 = (ulonglong)uVar9;
        iVar13 = (int)uVar6;
        if (uVar5 == 0) break;
        uVar7 = (int)uVar6 + 1;
        uVar6 = (ulonglong)uVar7;
        psVar8 = psVar8 + 1;
        iVar13 = 0xc;
      } while ((int)uVar7 < 0xd);
      if ((int)uVar2 < 1) {
        if ((int)uVar3 < 1) {
          uVar6 = (ulonglong)(ushort)(uVar9 + 0xcdbc);
        }
        else {
          uVar6 = (ulonglong)(ushort)(0x3244 - uVar9);
        }
      }
      else {
        uVar4 = -uVar9;
        if (-1 < (int)uVar3) {
          uVar4 = uVar9;
        }
        uVar6 = (ulonglong)uVar4;
      }
      *param_2 = (uint)((ulonglong)
                        ((longlong)*(int *)(&DAT_18007d330 + (longlong)iVar13 * 4) *
                         (longlong)(int)uVar11 + 0x8000) >> 0x10);
    }
  }
  return uVar6;
}



ulonglong FUN_180035200(uint *param_1,uint *param_2)

{
  uint uVar1;
  uint uVar2;
  bool bVar3;
  ushort uVar4;
  uint uVar5;
  ulonglong uVar6;
  uint uVar7;
  short *psVar8;
  ushort uVar9;
  ulonglong uVar10;
  uint uVar11;
  int iVar12;
  int iVar13;

  uVar1 = *param_2;
  uVar2 = *param_1;
  bVar3 = false;
  uVar6 = 0;
  uVar11 = (uVar1 ^ (int)uVar1 >> 0x1f) - ((int)uVar1 >> 0x1f);
  uVar5 = (uVar2 ^ (int)uVar2 >> 0x1f) - ((int)uVar2 >> 0x1f);
  if (uVar5 == 0) {
    *param_2 = uVar11;
    if ((int)uVar1 < 1) {
      uVar6 = 0x3244;
    }
  }
  else {
    if (uVar11 == 0) {
      *param_2 = uVar5;
      if ((int)uVar2 < 1) {
        uVar6 = 0xffffe6de;
      }
      else {
        uVar6 = 0x1922;
      }
    }
    else {
      psVar8 = &DAT_18007d310;
      uVar10 = uVar6;
      do {
        iVar12 = (int)uVar5 >> ((byte)uVar6 & 0x1f);
        iVar13 = (int)uVar11 >> ((byte)uVar6 & 0x1f);
        if (uVar5 == 0) {
          bVar3 = true;
LAB_180035296:
          uVar11 = uVar11 + iVar12;
          uVar5 = uVar5 - iVar13;
          if (!bVar3) {
            uVar10 = (ulonglong)(ushort)((short)uVar10 + *psVar8);
          }
        }
        else {
          if (-1 < (int)uVar5) goto LAB_180035296;
          uVar11 = uVar11 - iVar12;
          uVar5 = uVar5 + iVar13;
          if (!bVar3) {
            uVar10 = (ulonglong)(ushort)((short)uVar10 - *psVar8);
          }
        }
        uVar7 = (int)uVar6 + 1;
        uVar6 = (ulonglong)uVar7;
        psVar8 = psVar8 + 1;
      } while ((int)uVar7 < 4);
      uVar9 = (ushort)uVar10;
      if ((int)uVar1 < 1) {
        if ((int)uVar2 < 1) {
          uVar6 = (ulonglong)(ushort)(uVar9 + 0xcdbc);
        }
        else {
          uVar6 = (ulonglong)(ushort)(0x3244 - uVar9);
        }
      }
      else {
        uVar4 = -uVar9;
        if (-1 < (int)uVar2) {
          uVar4 = uVar9;
        }
        uVar6 = (ulonglong)uVar4;
      }
      *param_2 = (uint)((ulonglong)((longlong)(int)uVar11 * 0x9bda + 0x8000) >> 0x10);
    }
  }
  return uVar6;
}



void FUN_180035330(uint param_1,int *param_2,int *param_3)

{
  short sVar1;
  short sVar2;
  short sVar3;
  short sVar4;
  int iVar5;
  int iVar6;
  short *psVar7;
  int iVar8;
  short sVar9;
  short sVar10;

  iVar8 = (param_1 ^ (int)param_1 >> 0x1f) - ((int)param_1 >> 0x1f);
  sVar9 = 0x4000;
  iVar5 = (int)((ulonglong)((longlong)iVar8 * 0x5d069adb) >> 0x20) - iVar8;
  sVar10 = 0;
  iVar6 = 0;
  iVar8 = iVar8 + ((iVar5 >> 0xe) - (iVar5 >> 0x1f)) * 0x6488;
  if (iVar8 < 0x3245) {
    if ((int)param_1 < 1) {
      iVar8 = -iVar8;
    }
  }
  else {
    if ((int)param_1 < 0) {
      iVar8 = 0x6488 - iVar8;
    }
    else {
      iVar8 = iVar8 + -0x6488;
    }
  }
  sVar1 = (short)iVar8;
  if (iVar8 < 0x1923) {
    if (iVar8 < -0x1922) {
      iVar8 = iVar8 + 0x3244;
    }
    else {
      if (iVar8 < 0) {
        iVar8 = -iVar8;
      }
    }
  }
  else {
    iVar8 = 0x3244 - iVar8;
  }
  if (iVar8 == 0) {
    *param_2 = 0;
    *param_3 = 0x4000;
  }
  else {
    if (iVar8 == 0x1922) {
      *param_3 = 0;
      *param_2 = 0x4000;
    }
    else {
      psVar7 = &DAT_18007d310;
      sVar3 = sVar10;
      do {
        sVar4 = sVar9 >> ((byte)sVar3 & 0x1f);
        sVar2 = sVar10 >> ((byte)sVar3 & 0x1f);
        if (iVar8 - iVar6 < 0) {
          sVar4 = -sVar4;
          iVar5 = -(int)*psVar7;
        }
        else {
          sVar2 = -sVar2;
          iVar5 = (int)*psVar7;
        }
        iVar6 = iVar6 + iVar5;
        sVar10 = sVar10 + sVar4;
        sVar9 = sVar9 + sVar2;
        sVar3 = sVar3 + 1;
        psVar7 = psVar7 + 1;
      } while (sVar3 < 0xd);
      *param_3 = sVar9 * 0x9b75 + 0x8000 >> 0x10;
      *param_2 = sVar10 * 0x9b75 + 0x8000 >> 0x10;
    }
  }
  if (sVar1 < 0x1923) {
    if (sVar1 < -0x1922) {
      *param_3 = -*param_3;
    }
    else {
      if (-1 < sVar1) {
        return;
      }
    }
    *param_2 = -*param_2;
    return;
  }
  *param_3 = -*param_3;
  return;
}



ulonglong FUN_1800354d0(uint param_1)

{
  uint uVar1;
  int iVar2;
  ulonglong uVar3;
  int *piVar4;
  uint uVar5;
  int local_48 [4];
  undefined4 local_38;
  undefined4 uStack52;
  undefined4 uStack48;
  undefined4 uStack44;
  undefined4 local_28;
  undefined4 uStack36;
  undefined4 uStack32;
  undefined4 uStack28;
  undefined4 local_18;
  undefined4 uStack20;
  undefined4 uStack16;
  undefined4 uStack12;

  piVar4 = local_48;
  local_48[0] = 0x95c0;
  local_48[1] = 0x526a;
  local_48[2] = 0x2b80;
  local_48[3] = 0x1664;
  uVar1 = (param_1 ^ (int)param_1 >> 0x1f) - ((int)param_1 >> 0x1f);
  local_38 = 0xb5d;
  uStack52 = 0x5ba;
  uStack48 = 0x2e0;
  uStack44 = 0x171;
  uVar3 = 0x10000;
  local_28 = 0xb8;
  uStack36 = 0x5c;
  uStack32 = 0x2e;
  uStack28 = 0x17;
  local_18 = 0xc;
  uStack20 = 6;
  uStack16 = 3;
  uStack12 = 1;
  uVar5 = uVar1 & 0xffff;
  if (0 < (int)uVar1 >> 0x10) {
    uVar3 = 0x10000 << ((byte)(uVar1 >> 0x10) & 0x3f);
  }
  iVar2 = 0;
  do {
    if (*piVar4 <= (int)uVar5) {
      uVar5 = uVar5 - *piVar4;
      uVar3 = uVar3 + ((longlong)uVar3 >> ((char)iVar2 + 1U & 0x3f));
    }
    iVar2 = iVar2 + 1;
    piVar4 = piVar4 + 1;
  } while (iVar2 < 0x10);
  if (0 < (int)param_1) {
    return uVar3 & 0xffffffff;
  }
  return SUB168((ZEXT816(0) << 0x40 | ZEXT816(0x100000000)) / ZEXT816(uVar3),0);
}



void FUN_180035660(int *param_1,longlong param_2)

{
  byte *pbVar1;
  undefined *puVar2;
  undefined *puVar3;
  byte bVar4;
  int iVar5;
  uint uVar6;
  longlong lVar7;
  int iVar8;
  uint uVar9;
  short *psVar10;
  undefined *puVar11;
  longlong lVar12;
  byte *pbVar13;
  byte *pbVar14;
  ulonglong uVar15;
  int iVar16;
  ulonglong uVar17;
  short *psVar18;
  ulonglong uVar19;
  undefined2 *puVar20;
  longlong lVar21;
  int *local_res20;

  iVar5 = *param_1;
  lVar21 = (longlong)iVar5;
  uVar6 = param_1[1];
  uVar15 = (ulonglong)uVar6;
  lVar12 = *(longlong *)(param_1 + 6);
  lVar7 = *(longlong *)(param_2 + 0x18);
  iVar16 = iVar5 + -1;
  iVar8 = (uVar6 + 2) * iVar5 * 2;
  local_res20 = (int *)malloc((longlong)iVar8 + 0x20);
  if (local_res20 == (int *)0x0) {
    local_res20 = (int *)0x0;
  }
  else {
    local_res20[3] = iVar8;
    *local_res20 = iVar5;
    local_res20[1] = uVar6 + 2;
    local_res20[4] = 2;
    local_res20[2] = iVar5 * 2;
    *(int **)(local_res20 + 6) = local_res20 + 8;
  }
  puVar11 = *(undefined **)(local_res20 + 6);
  puVar2 = puVar11 + lVar21 * 2;
  if (0 < (int)uVar6) {
    psVar10 = (short *)(puVar2 + 2);
    pbVar14 = (byte *)(lVar12 + 2);
    uVar17 = uVar15;
    do {
      if (1 < iVar16) {
        uVar19 = (ulonglong)(iVar5 - 2);
        pbVar13 = pbVar14;
        psVar18 = psVar10;
        do {
          pbVar1 = pbVar13 + -2;
          bVar4 = *pbVar13;
          pbVar13 = pbVar13 + 1;
          *psVar18 = (ushort)bVar4 - (ushort)*pbVar1;
          uVar19 = uVar19 - 1;
          psVar18 = psVar18 + 1;
        } while (uVar19 != 0);
      }
      pbVar14 = pbVar14 + lVar21;
      psVar10 = psVar10 + lVar21;
      uVar17 = uVar17 - 1;
    } while (uVar17 != 0);
  }
  uVar9 = iVar5 * 2;
  uVar17 = (ulonglong)uVar9;
  puVar3 = puVar2 + lVar21 * 2;
  if ((((puVar11 != (undefined *)0x0) && (puVar3 != (undefined *)0x0)) && (uVar9 != 0)) &&
     (((puVar3 + uVar17 <= puVar11 || (puVar11 + uVar17 <= puVar3)) && (uVar9 != 0)))) {
    lVar12 = -(longlong)puVar11;
    uVar19 = uVar17;
    do {
      *puVar11 = (puVar3 + lVar12)[(longlong)puVar11];
      puVar11 = puVar11 + 1;
      uVar19 = uVar19 - 1;
    } while (uVar19 != 0);
  }
  puVar3 = puVar2 + (longlong)(int)((uVar6 - 2) * iVar5) * 2;
  puVar11 = puVar2 + (longlong)(int)(iVar5 * uVar6) * 2;
  if (((puVar11 != (undefined *)0x0) && (puVar3 != (undefined *)0x0)) &&
     ((uVar9 != 0 &&
      (((puVar3 + uVar17 <= puVar11 || (puVar11 + uVar17 <= puVar3)) && (uVar9 != 0)))))) {
    lVar12 = -(longlong)puVar11;
    do {
      *puVar11 = (puVar3 + lVar12)[(longlong)puVar11];
      puVar11 = puVar11 + 1;
      uVar17 = uVar17 - 1;
    } while (uVar17 != 0);
  }
  if (0 < (int)uVar6) {
    lVar12 = (longlong)iVar16;
    puVar20 = (undefined2 *)(lVar7 + lVar12 * 2);
    do {
      if (1 < iVar16) {
        uVar17 = (ulonglong)(iVar5 - 2);
        psVar10 = (short *)((((lVar21 - lVar12) * 2 + 2) - lVar7) + (longlong)puVar2 +
                           (longlong)puVar20);
        do {
          psVar18 = psVar10 + 1;
          *(short *)(((lVar7 + lVar21 * -2) - (longlong)puVar2) + -2 + (longlong)psVar18) =
               psVar10[-lVar21] * 2 + psVar18[lVar21 * -2 + -1] + *psVar10;
          uVar17 = uVar17 - 1;
          psVar10 = psVar18;
        } while (uVar17 != 0);
      }
      puVar20[-lVar12] = 0;
      *puVar20 = 0;
      puVar20 = puVar20 + lVar21;
      uVar15 = uVar15 - 1;
    } while (uVar15 != 0);
  }
                    // WARNING: Could not recover jumptable at 0x0001800358cf. Too many branches
                    // WARNING: Treating indirect jump as call
  free(local_res20);
  return;
}



void FUN_1800358e0(uint *param_1,longlong param_2)

{
  int iVar1;
  longlong lVar2;
  byte *pbVar3;
  byte bVar4;
  uint uVar5;
  uint uVar6;
  longlong lVar7;
  int iVar8;
  int *_Memory;
  short *psVar9;
  byte *pbVar10;
  ulonglong uVar11;
  longlong lVar12;
  int iVar13;
  undefined *puVar14;
  undefined *puVar15;
  ulonglong uVar16;
  short *psVar17;
  longlong lVar18;
  longlong lVar19;
  longlong lVar20;

  uVar5 = param_1[1];
  uVar6 = *param_1;
  lVar18 = *(longlong *)(param_1 + 6);
  puVar15 = *(undefined **)(param_2 + 0x18);
  iVar1 = uVar5 - 1;
  iVar13 = uVar6 + 2;
  iVar8 = iVar13 * uVar5 * 2;
  _Memory = (int *)malloc((longlong)iVar8 + 0x20);
  if (_Memory != (int *)0x0) {
    _Memory[3] = iVar8;
    *_Memory = iVar13;
    _Memory[1] = uVar5;
    _Memory[4] = 2;
    _Memory[2] = iVar13 * 2;
    *(int **)(_Memory + 6) = _Memory + 8;
  }
  lVar7 = *(longlong *)(_Memory + 6);
  lVar20 = (longlong)iVar13;
  lVar12 = (longlong)(int)uVar6;
  if (1 < iVar1) {
    uVar11 = (ulonglong)(uVar5 - 2);
    psVar17 = (short *)(lVar7 + ((longlong)(int)(uVar6 + 3) + -1) * 2);
    lVar19 = lVar12;
    do {
      if (0 < (int)uVar6) {
        lVar2 = lVar12 + lVar18;
        pbVar10 = (byte *)(lVar2 + lVar19);
        uVar16 = (ulonglong)uVar6;
        psVar9 = psVar17;
        do {
          psVar9 = psVar9 + 1;
          pbVar3 = pbVar10 + ((lVar18 - lVar2) - lVar12);
          bVar4 = *pbVar10;
          pbVar10 = pbVar10 + 1;
          *psVar9 = (ushort)bVar4 - (ushort)*pbVar3;
          uVar16 = uVar16 - 1;
        } while (uVar16 != 0);
      }
      lVar19 = lVar19 + lVar12;
      *psVar17 = psVar17[2];
      psVar17[lVar12 + 1] = psVar17[lVar12 + -1];
      psVar17 = psVar17 + lVar20;
      uVar11 = uVar11 - 1;
    } while (uVar11 != 0);
    if (1 < iVar1) {
      lVar19 = (longlong)(int)(uVar6 + 3);
      uVar11 = (ulonglong)(uVar5 - 2);
      psVar17 = (short *)(lVar7 + (lVar19 + 1) * 2);
      lVar18 = lVar12;
      do {
        if (0 < (int)uVar6) {
          psVar9 = psVar17;
          uVar16 = (ulonglong)uVar6;
          do {
            *(short *)((longlong)puVar15 + ((lVar18 - lVar19) * 2 - lVar7) + -4 +
                      (longlong)(psVar9 + 1)) = psVar9[-1] * 2 + psVar9[-2] + *psVar9;
            uVar16 = uVar16 - 1;
            psVar9 = psVar9 + 1;
          } while (uVar16 != 0);
        }
        lVar18 = lVar18 + lVar12;
        lVar19 = lVar19 + lVar20;
        psVar17 = psVar17 + lVar20;
        uVar11 = uVar11 - 1;
      } while (uVar11 != 0);
    }
  }
  if ((puVar15 != (undefined *)0x0) && (uVar6 * 2 != 0)) {
    uVar11 = (ulonglong)(uVar6 * 2);
    puVar14 = puVar15;
    while (uVar11 != 0) {
      uVar11 = uVar11 - 1;
      *puVar14 = 0;
      puVar14 = puVar14 + 1;
    }
  }
  if ((puVar15 + (longlong)(int)(iVar1 * uVar6) * 2 != (undefined *)0x0) && (uVar6 * 2 != 0)) {
    uVar11 = (ulonglong)(uVar6 * 2);
    puVar15 = puVar15 + (longlong)(int)(iVar1 * uVar6) * 2;
    while (uVar11 != 0) {
      uVar11 = uVar11 - 1;
      *puVar15 = 0;
      puVar15 = puVar15 + 1;
    }
  }
                    // WARNING: Could not recover jumptable at 0x000180035ad7. Too many branches
                    // WARNING: Treating indirect jump as call
  free(_Memory);
  return;
}



ulonglong FUN_180035ae0(int *param_1,longlong param_2,int param_3,ushort param_4,undefined4 param_5)

{
  byte bVar1;
  ushort uVar2;
  int iVar4;
  uint uVar5;
  int iVar6;
  ulonglong *puVar7;
  ulonglong *puVar8;
  ulonglong *puVar9;
  ulonglong uVar10;
  undefined *puVar11;
  byte *pbVar12;
  ushort *puVar13;
  short *psVar14;
  ulonglong uVar15;
  uint uVar16;
  ulonglong *puVar17;
  ulonglong *puVar18;
  longlong lVar19;
  uint uVar20;
  uint uVar21;
  ulonglong *puVar22;
  uint uVar23;
  ushort uVar3;

  iVar4 = *param_1;
  uVar5 = param_1[1];
  uVar10 = (ulonglong)uVar5;
  uVar23 = iVar4 * uVar5;
  puVar17 = (ulonglong *)0x0;
  iVar6 = uVar23 * 2;
  puVar7 = (ulonglong *)malloc((longlong)iVar6 + 0x20);
  uVar16 = 0;
  puVar18 = puVar17;
  if (puVar7 != (ulonglong *)0x0) {
    *(int *)((longlong)puVar7 + 0xc) = iVar6;
    *(int *)puVar7 = iVar4;
    *(uint *)((longlong)puVar7 + 4) = uVar5;
    *(int *)(puVar7 + 2) = 2;
    *(int *)(puVar7 + 1) = iVar4 * 2;
    puVar7[3] = (ulonglong)(puVar7 + 4);
    puVar18 = puVar7;
  }
  pbVar12 = *(byte **)(param_1 + 6);
  psVar14 = (short *)puVar18[3];
  puVar7 = puVar17;
  if (0 < param_1[3]) {
    do {
      bVar1 = *pbVar12;
      pbVar12 = pbVar12 + 1;
      *psVar14 = (ushort)bVar1 << 8;
      uVar20 = (int)puVar7 + 1;
      psVar14 = psVar14 + 1;
      puVar7 = (ulonglong *)(ulonglong)uVar20;
    } while ((int)uVar20 < param_1[3]);
  }
  puVar8 = (ulonglong *)malloc((longlong)iVar6 + 0x20);
  puVar7 = puVar17;
  if (puVar8 != (ulonglong *)0x0) {
    *(int *)((longlong)puVar8 + 0xc) = iVar6;
    *(int *)puVar8 = iVar4;
    *(uint *)((longlong)puVar8 + 4) = uVar5;
    *(int *)(puVar8 + 2) = 2;
    *(int *)(puVar8 + 1) = iVar4 * 2;
    puVar8[3] = (ulonglong)(puVar8 + 4);
    puVar7 = puVar8;
  }
  FUN_1800395b0(puVar18,(int *)puVar7,0xffffffffffffffff,7,-1,-1);
  free(puVar18);
  puVar8 = (ulonglong *)malloc((longlong)(int)uVar23 + 0x20);
  puVar18 = puVar17;
  if (puVar8 != (ulonglong *)0x0) {
    *(uint *)((longlong)puVar8 + 0xc) = uVar23;
    *(int *)puVar8 = iVar4;
    *(uint *)((longlong)puVar8 + 4) = uVar5;
    *(int *)(puVar8 + 2) = 1;
    *(int *)(puVar8 + 1) = iVar4;
    puVar8[3] = (ulonglong)(puVar8 + 4);
    puVar18 = puVar8;
  }
  uVar15 = puVar7[3];
  puVar11 = (undefined *)puVar18[3];
  puVar8 = puVar17;
  if (0 < *(int *)((longlong)puVar18 + 0xc)) {
    do {
      uVar20 = (int)puVar8 + 1;
      *puVar11 = *(undefined *)(uVar15 + 1);
      puVar11 = puVar11 + 1;
      uVar15 = uVar15 + 2;
      puVar8 = (ulonglong *)(ulonglong)uVar20;
    } while ((int)uVar20 < *(int *)((longlong)puVar18 + 0xc));
  }
  free(puVar7);
  puVar8 = (ulonglong *)malloc((longlong)iVar6 + 0x20);
  puVar7 = puVar17;
  if (puVar8 != (ulonglong *)0x0) {
    *(int *)((longlong)puVar8 + 0xc) = iVar6;
    *(int *)puVar8 = iVar4;
    *(uint *)((longlong)puVar8 + 4) = uVar5;
    *(int *)(puVar8 + 2) = 2;
    *(int *)(puVar8 + 1) = iVar4 * 2;
    puVar8[3] = (ulonglong)(puVar8 + 4);
    puVar7 = puVar8;
  }
  puVar9 = (ulonglong *)malloc((longlong)iVar6 + 0x20);
  puVar8 = puVar17;
  if (puVar9 != (ulonglong *)0x0) {
    *(int *)((longlong)puVar9 + 0xc) = iVar6;
    *(int *)puVar9 = iVar4;
    *(uint *)((longlong)puVar9 + 4) = uVar5;
    *(int *)(puVar9 + 2) = 2;
    *(int *)(puVar9 + 1) = iVar4 * 2;
    puVar9[3] = (ulonglong)(puVar9 + 4);
    puVar8 = puVar9;
  }
  FUN_180035660((int *)puVar18,(longlong)puVar7);
  FUN_1800358e0((uint *)puVar18,(longlong)puVar8);
  free(puVar18);
  puVar9 = (ulonglong *)malloc((longlong)iVar6 + 0x20);
  puVar18 = puVar17;
  if (puVar9 != (ulonglong *)0x0) {
    *(int *)((longlong)puVar9 + 0xc) = iVar6;
    *(int *)puVar9 = iVar4;
    *(uint *)((longlong)puVar9 + 4) = uVar5;
    *(int *)(puVar9 + 2) = 2;
    *(int *)(puVar9 + 1) = iVar4 * 2;
    puVar9[3] = (ulonglong)(puVar9 + 4);
    puVar18 = puVar9;
  }
  puVar9 = puVar17;
  if (0 < (int)uVar5) {
    do {
      lVar19 = (longlong)iVar4;
      puVar22 = puVar9;
      if (0 < iVar4) {
        do {
          uVar21 = (int)*(short *)((longlong)puVar22 + puVar7[3]) >> 0xf;
          uVar20 = (int)*(short *)((longlong)puVar22 + puVar8[3]) >> 0xf;
          *(short *)((longlong)puVar22 + puVar18[3]) =
               (short)((int)((uVar20 ^ (int)*(short *)((longlong)puVar22 + puVar8[3])) - uVar20) / 2
                      ) +
               (short)((int)((uVar21 ^ (int)*(short *)((longlong)puVar22 + puVar7[3])) - uVar21) / 2
                      );
          lVar19 = lVar19 + -1;
          puVar22 = (ulonglong *)((longlong)puVar22 + 2);
        } while (lVar19 != 0);
      }
      uVar10 = uVar10 - 1;
      puVar9 = (ulonglong *)((longlong)puVar9 + (longlong)iVar4 * 2);
    } while (uVar10 != 0);
  }
  if (puVar7 != (ulonglong *)0x0) {
    free(puVar7);
  }
  if (puVar8 != (ulonglong *)0x0) {
    free(puVar8);
  }
  puVar8 = (ulonglong *)malloc((longlong)iVar6 + 0x20);
  puVar7 = puVar17;
  if (puVar8 != (ulonglong *)0x0) {
    *(int *)((longlong)puVar8 + 0xc) = iVar6;
    *(int *)puVar8 = iVar4;
    *(uint *)((longlong)puVar8 + 4) = uVar5;
    *(int *)(puVar8 + 2) = 2;
    *(int *)(puVar8 + 1) = iVar4 * 2;
    puVar8[3] = (ulonglong)(puVar8 + 4);
    puVar7 = puVar8;
  }
  FUN_180039f70((uint *)puVar18,(uint *)puVar7);
  if (puVar18 != (ulonglong *)0x0) {
    free(puVar18);
  }
  uVar10 = (ulonglong)uVar23;
  if (param_3 == 0) {
    puVar13 = (ushort *)puVar7[3];
    if (0 < (int)uVar23) {
      do {
        uVar2 = *puVar13;
        uVar3 = *puVar13;
        puVar13 = puVar13 + 1;
        uVar16 = (uint)puVar17 + 1;
        if (uVar2 < param_4 || uVar3 == param_4) {
          uVar16 = (uint)puVar17;
        }
        puVar17 = (ulonglong *)(ulonglong)uVar16;
        uVar10 = uVar10 - 1;
      } while (uVar10 != 0);
    }
  }
  else {
    puVar13 = (ushort *)puVar7[3];
    puVar11 = *(undefined **)(param_2 + 0x18);
    if (0 < (int)uVar23) {
      do {
        if (*puVar13 < param_4 || *puVar13 == param_4) {
          *puVar11 = 0;
        }
        else {
          puVar17 = (ulonglong *)(ulonglong)((int)puVar17 + 1);
          *puVar11 = (undefined)param_5;
        }
        uVar16 = (uint)puVar17;
        puVar13 = puVar13 + 1;
        puVar11 = puVar11 + 1;
        uVar10 = uVar10 - 1;
      } while (uVar10 != 0);
    }
  }
  free(puVar7);
  return (longlong)(int)(uVar16 << 0x10) / (longlong)(int)uVar23 & 0xffffffff;
}



void FUN_180035f00(undefined *param_1,int param_2,undefined *param_3)

{
  short sVar1;
  short sVar2;
  longlong lVar3;
  undefined *puVar4;
  uint uVar5;
  uint uVar6;
  longlong lVar7;
  ulonglong uVar8;
  longlong lVar9;
  ulonglong uVar10;

  uVar6 = param_2 * 2;
  uVar8 = (ulonglong)uVar6;
  if ((((param_3 != (undefined *)0x0) && (param_1 != (undefined *)0x0)) && (uVar6 != 0)) &&
     (((param_1 + uVar8 <= param_3 || (param_3 + uVar8 <= param_1)) && (uVar6 != 0)))) {
    puVar4 = param_3;
    do {
      *puVar4 = (param_1 + -(longlong)param_3)[(longlong)puVar4];
      puVar4 = puVar4 + 1;
      uVar8 = uVar8 - 1;
    } while (uVar8 != 0);
  }
  uVar5 = param_2 >> 1;
  uVar6 = 1;
  while (0 < (int)uVar5) {
    if (0 < (int)uVar6) {
      lVar7 = (longlong)(int)uVar5;
      lVar3 = 0;
      uVar8 = (ulonglong)uVar6;
      lVar9 = lVar7;
      do {
        if (0 < (int)uVar5) {
          uVar10 = (ulonglong)uVar5;
          do {
            sVar1 = *(short *)(param_3 + lVar3 * 2);
            sVar2 = *(short *)(param_3 + lVar9 * 2);
            *(short *)(param_3 + lVar3 * 2) = sVar1 + sVar2;
            lVar3 = lVar3 + 1;
            *(short *)(param_3 + lVar9 * 2) = sVar1 - sVar2;
            lVar9 = lVar9 + 1;
            uVar10 = uVar10 - 1;
          } while (uVar10 != 0);
        }
        lVar3 = lVar3 + lVar7;
        lVar9 = lVar9 + lVar7;
        uVar8 = uVar8 - 1;
      } while (uVar8 != 0);
    }
    uVar5 = (int)uVar5 >> 1;
    uVar6 = uVar6 * 2;
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180035fd0(longlong param_1,longlong param_2)

{
  undefined2 *puVar1;
  short sVar2;
  short sVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined8 *puVar7;
  undefined8 *puVar8;
  uint uVar9;
  ulonglong uVar10;
  ulonglong uVar11;
  ulonglong uVar12;
  int iVar13;
  ulonglong uVar14;
  int *piVar15;
  ulonglong uVar16;
  undefined2 *puVar17;
  longlong lVar18;
  longlong lVar19;
  undefined auStack712 [32];
  longlong local_2a8;
  int local_2a0 [6];
  undefined8 local_288;
  undefined8 local_280;
  undefined8 local_278;
  undefined8 local_270;
  undefined8 local_268;
  undefined8 local_260;
  undefined8 local_258;
  undefined8 local_250;
  undefined8 local_248;
  undefined2 local_240 [92];
  undefined4 local_188;
  undefined4 uStack388;
  undefined4 uStack384;
  undefined4 uStack380;
  undefined4 local_178;
  undefined4 uStack372;
  undefined4 uStack368;
  undefined4 uStack364;
  undefined4 local_168;
  undefined4 uStack356;
  undefined4 uStack352;
  undefined4 uStack348;
  undefined4 local_158;
  undefined4 uStack340;
  undefined4 uStack336;
  undefined4 uStack332;
  undefined8 local_148 [4];
  undefined2 local_128 [16];
  undefined2 local_108 [16];
  undefined2 local_e8 [16];
  undefined2 local_c8 [16];
  undefined2 local_a8 [16];
  undefined2 local_88 [16];
  undefined2 local_68 [16];
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)auStack712;
  uVar10 = 0;
  if ((undefined8 *)(param_1 + 0x10) != (undefined8 *)0x0) {
    *(undefined8 *)(param_1 + 0x10) = 0;
    *(undefined8 *)(param_1 + 0x18) = 0;
    *(undefined8 *)(param_1 + 0x20) = 0;
  }
  local_2a8 = param_1;
  memset(&local_248,0,0x100);
  memset(local_148,0,0x100);
  uVar14 = 0x10;
  puVar7 = &local_248;
  lVar19 = 0x10;
  puVar17 = local_108;
  do {
    FUN_180035f00((undefined *)((param_2 - (longlong)&local_248) + (longlong)puVar7),8,
                  (undefined *)puVar7);
    puVar17[-0x20] = *(undefined2 *)puVar7;
    puVar17[-0x10] = *(undefined2 *)((longlong)puVar7 + 2);
    *puVar17 = *(undefined2 *)((longlong)puVar7 + 4);
    puVar17[0x10] = *(undefined2 *)((longlong)puVar7 + 6);
    puVar17[0x20] = *(undefined2 *)(puVar7 + 1);
    puVar17[0x30] = *(undefined2 *)((longlong)puVar7 + 10);
    puVar17[0x40] = *(undefined2 *)((longlong)puVar7 + 0xc);
    puVar1 = (undefined2 *)((longlong)puVar7 + 0xe);
    puVar7 = puVar7 + 2;
    puVar17[0x50] = *puVar1;
    lVar19 = lVar19 + -1;
    puVar17 = puVar17 + 1;
  } while (lVar19 != 0);
  lVar18 = 4;
  lVar19 = 4;
  puVar7 = &local_248;
  do {
    *puVar7 = 0;
    puVar7[1] = 0;
    puVar7[2] = 0;
    puVar7[3] = 0;
    puVar7[4] = 0;
    puVar7[5] = 0;
    puVar7[6] = 0;
    puVar7[7] = 0;
    lVar19 = lVar19 + -1;
    puVar7 = puVar7 + 8;
  } while (lVar19 != 0);
  lVar19 = 6;
  uVar11 = uVar10;
  do {
    FUN_180035f00((undefined *)((longlong)local_128 + uVar11),0x10,
                  (undefined *)((longlong)&local_248 + uVar11));
    uVar11 = uVar11 + 0x20;
    lVar19 = lVar19 + -1;
  } while (lVar19 != 0);
  piVar15 = local_2a0;
  puVar7 = &local_288;
  local_2a0[0] = 5;
  local_2a0[1] = 6;
  local_2a0[2] = 9;
  local_2a0[3] = 10;
  local_288 = 0;
  local_280 = 0;
  local_278 = 0;
  local_270 = 0;
  local_268 = 0;
  local_260 = 0;
  local_258 = 0;
  local_250 = 0;
  do {
    puVar8 = (undefined8 *)((longlong)(*piVar15 << 3) * 2 + param_2);
    if (((puVar7 != (undefined8 *)0x0) && (puVar8 != (undefined8 *)0x0)) &&
       ((puVar8 + 2 <= puVar7 || (puVar7 + 2 <= puVar8)))) {
      uVar4 = *(undefined4 *)((longlong)puVar8 + 4);
      uVar5 = *(undefined4 *)(puVar8 + 1);
      uVar6 = *(undefined4 *)((longlong)puVar8 + 0xc);
      *(undefined4 *)puVar7 = *(undefined4 *)puVar8;
      *(undefined4 *)((longlong)puVar7 + 4) = uVar4;
      *(undefined4 *)(puVar7 + 1) = uVar5;
      *(undefined4 *)((longlong)puVar7 + 0xc) = uVar6;
    }
    puVar7 = puVar7 + 2;
    piVar15 = piVar15 + 1;
    lVar18 = lVar18 + -1;
  } while (lVar18 != 0);
  if ((&local_248 <= &local_188) || (local_148 <= &local_288)) {
    local_188 = (undefined4)local_288;
    uStack388 = local_288._4_4_;
    uStack384 = (undefined4)local_280;
    uStack380 = local_280._4_4_;
    local_178 = (undefined4)local_278;
    uStack372 = local_278._4_4_;
    uStack368 = (undefined4)local_270;
    uStack364 = local_270._4_4_;
    local_168 = (undefined4)local_268;
    uStack356 = local_268._4_4_;
    uStack352 = (undefined4)local_260;
    uStack348 = local_260._4_4_;
    local_158 = (undefined4)local_258;
    uStack340 = local_258._4_4_;
    uStack336 = (undefined4)local_250;
    uStack332 = local_250._4_4_;
  }
  uVar9 = 1;
  do {
    iVar13 = (int)uVar14;
    if (0 < (int)uVar9) {
      lVar18 = (longlong)iVar13;
      uVar12 = (ulonglong)uVar9;
      uVar11 = uVar10;
      lVar19 = lVar18;
      do {
        uVar16 = uVar14;
        if (iVar13 != 0) {
          do {
            sVar2 = *(short *)((longlong)&local_188 + uVar11 * 2);
            sVar3 = *(short *)((longlong)&local_188 + lVar19 * 2);
            *(short *)((longlong)&local_188 + uVar11 * 2) = sVar2 + sVar3;
            uVar11 = uVar11 + 1;
            *(short *)((longlong)&local_188 + lVar19 * 2) = sVar2 - sVar3;
            lVar19 = lVar19 + 1;
            uVar16 = uVar16 - 1;
          } while (uVar16 != 0);
        }
        uVar11 = uVar11 + lVar18;
        lVar19 = lVar19 + lVar18;
        uVar12 = uVar12 - 1;
      } while (uVar12 != 0);
    }
    uVar14 = (ulonglong)(uint)(iVar13 >> 1);
    uVar9 = uVar9 * 2;
  } while (iVar13 >> 1 != 0);
  puVar7 = &local_248;
  uVar14 = uVar10;
  do {
    if (0 < *(short *)puVar7) {
      *(uint *)(local_2a8 + ((longlong)uVar14 >> 5) * 4 + 0x10) =
           *(uint *)(local_2a8 + 0x10 + ((longlong)uVar14 >> 5) * 4) | 1 << ((uint)uVar10 & 0x1f);
    }
    uVar9 = (uint)uVar10 + 1;
    uVar10 = (ulonglong)uVar9;
    uVar14 = uVar14 + 1;
    puVar7 = (undefined8 *)((longlong)puVar7 + 2);
  } while ((int)uVar9 < 0x80);
  FUN_18005f100(local_48 ^ (ulonglong)auStack712);
  return;
}



void FUN_1800362e0(longlong param_1,longlong param_2,longlong param_3)

{
  short *psVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  short sVar6;
  int iVar7;
  longlong lVar8;
  short *psVar9;
  longlong lVar10;
  longlong lVar11;
  short sVar12;
  int iVar13;
  short sVar14;
  short sVar15;

  uVar5 = 0;
  if ((undefined8 *)(param_1 + 0x10) != (undefined8 *)0x0) {
    *(undefined8 *)(param_1 + 0x10) = 0;
    *(undefined8 *)(param_1 + 0x18) = 0;
    *(undefined8 *)(param_1 + 0x20) = 0;
  }
  lVar10 = (param_3 - param_2) + -2;
  lVar11 = (param_2 - param_3) + -2;
  iVar13 = 0x20;
  do {
    sVar15 = 0;
    lVar8 = 4;
    psVar1 = (short *)(param_2 + 0xe);
    sVar14 = sVar15;
    do {
      psVar9 = psVar1 + 8;
      sVar14 = sVar14 + *(short *)(lVar10 + -0xc + (longlong)psVar1) * psVar1[-7] +
                        *(short *)(lVar10 + -10 + (longlong)psVar1) * psVar1[-6] +
                        *(short *)(lVar10 + -0x18 + (longlong)psVar9) * psVar1[-5] +
                        *(short *)(lVar10 + -0x16 + (longlong)psVar9) * psVar1[-4] +
                        *(short *)(lVar10 + -0x14 + (longlong)psVar9) * psVar1[-3] +
                        *(short *)(lVar10 + -0x12 + (longlong)psVar9) * psVar1[-2] +
                        *(short *)(lVar10 + -0x10 + (longlong)psVar9) * psVar1[-1] +
                        *(short *)(lVar10 + -0xe + (longlong)psVar9) * *psVar1;
      lVar8 = lVar8 + -1;
      psVar1 = psVar9;
    } while (lVar8 != 0);
    lVar8 = 4;
    psVar1 = (short *)(param_2 + 0x4e + lVar10);
    sVar6 = sVar15;
    do {
      sVar6 = sVar6 + *(short *)((longlong)psVar1 + lVar11 + -10) * psVar1[-6] +
                      *(short *)((longlong)psVar1 + lVar11 + -8) * psVar1[-5] +
                      *(short *)((longlong)psVar1 + lVar11 + -6) * psVar1[-4] +
                      *(short *)((longlong)psVar1 + lVar11 + -4) * psVar1[-3] +
                      *(short *)((longlong)psVar1 + lVar11 + -2) * psVar1[-2] +
                      *(short *)((longlong)psVar1 + lVar11 + 4) * psVar1[1] +
                      *(short *)((longlong)psVar1 + lVar11) * psVar1[-1] +
                      *(short *)((longlong)psVar1 + lVar11 + 2) * *psVar1;
      lVar8 = lVar8 + -1;
      psVar1 = psVar1 + 8;
    } while (lVar8 != 0);
    lVar8 = 4;
    psVar1 = (short *)(param_2 + 0x8c);
    psVar9 = (short *)(param_3 + 0xc + (longlong)(iVar13 + 0x20) * 2);
    sVar12 = sVar15;
    do {
      sVar12 = sVar12 + psVar9[-6] * psVar1[-6] + psVar9[-5] * psVar1[-5] + psVar9[-4] * psVar1[-4]
                        + psVar9[-3] * psVar1[-3] + psVar9[-2] * psVar1[-2] +
                        psVar9[-1] * psVar1[-1] + psVar9[1] * psVar1[1] + *psVar9 * *psVar1;
      lVar8 = lVar8 + -1;
      psVar1 = psVar1 + 8;
      psVar9 = psVar9 + 8;
    } while (lVar8 != 0);
    lVar8 = 4;
    psVar1 = (short *)(param_2 + 0xcc);
    psVar9 = (short *)(param_3 + 0xc + (longlong)(iVar13 + 0x40) * 2);
    do {
      sVar15 = sVar15 + psVar9[-6] * psVar1[-6] + psVar9[-5] * psVar1[-5] + psVar9[-4] * psVar1[-4]
                        + psVar9[-3] * psVar1[-3] + psVar9[-2] * psVar1[-2] +
                        psVar9[-1] * psVar1[-1] + psVar9[1] * psVar1[1] + *psVar9 * *psVar1;
      lVar8 = lVar8 + -1;
      psVar1 = psVar1 + 8;
      psVar9 = psVar9 + 8;
    } while (lVar8 != 0);
    iVar4 = (int)sVar6;
    iVar3 = (int)sVar14;
    iVar2 = (int)sVar12;
    iVar7 = (int)sVar15;
    if (0 < iVar3 + iVar4 + iVar2 + iVar7) {
      *(uint *)(param_1 + 0x10) = *(uint *)(param_1 + 0x10) | 1 << (uVar5 & 0x1f);
    }
    if (0 < iVar3 + iVar2 + -iVar4 + -iVar7) {
      *(uint *)(param_1 + 0x14) = *(uint *)(param_1 + 0x14) | 1 << (uVar5 & 0x1f);
    }
    if (0 < iVar3 + iVar4 + -iVar2 + -iVar7) {
      *(uint *)(param_1 + 0x18) = *(uint *)(param_1 + 0x18) | 1 << (uVar5 & 0x1f);
    }
    if (0 < iVar3 + iVar7 + -iVar2 + -iVar4) {
      *(uint *)(param_1 + 0x1c) = *(uint *)(param_1 + 0x1c) | 1 << (uVar5 & 0x1f);
    }
    uVar5 = uVar5 + 1;
    iVar13 = iVar13 + 0x80;
    lVar11 = lVar11 + -0x100;
    lVar10 = lVar10 + 0x100;
  } while (iVar13 < 0x1020);
  return;
}



void FUN_1800366f0(longlong param_1,longlong param_2,longlong param_3)

{
  undefined8 *puVar1;
  short *psVar2;
  short *psVar3;
  longlong lVar4;
  int iVar5;
  longlong lVar6;
  uint uVar7;
  short *psVar8;

  puVar1 = (undefined8 *)(param_1 + 0x28);
  if (puVar1 != (undefined8 *)0x0) {
    *puVar1 = 0;
    *(undefined8 *)(param_1 + 0x30) = 0;
  }
  uVar7 = 0;
  psVar8 = (short *)(param_3 + 0xc);
  lVar6 = (param_2 - param_3) + -2;
  do {
    iVar5 = 0;
    lVar4 = 4;
    psVar3 = psVar8;
    do {
      psVar2 = psVar3 + 8;
      iVar5 = iVar5 + (int)*(short *)(lVar6 + -0xe + (longlong)psVar2) * (int)*psVar3 +
              (int)*(short *)(lVar6 + -10 + (longlong)psVar3) * (int)psVar3[-6] +
              (int)*(short *)(lVar6 + -8 + (longlong)psVar3) * (int)psVar3[-5] +
              (int)*(short *)(lVar6 + -0x16 + (longlong)psVar2) * (int)psVar3[-4] +
              (int)*(short *)(lVar6 + -0x14 + (longlong)psVar2) * (int)psVar3[-3] +
              (int)*(short *)(lVar6 + -0x12 + (longlong)psVar2) * (int)psVar3[-2] +
              (int)*(short *)(lVar6 + -0xc + (longlong)psVar2) * (int)psVar3[1] +
              (int)*(short *)(lVar6 + -0x10 + (longlong)psVar2) * (int)psVar3[-1];
      lVar4 = lVar4 + -1;
      psVar3 = psVar2;
    } while (lVar4 != 0);
    if (0 < iVar5) {
      *(uint *)puVar1 = *(uint *)puVar1 | 1 << (uVar7 & 0x1f);
    }
    uVar7 = uVar7 + 1;
    psVar8 = psVar8 + 0x80;
    lVar6 = lVar6 + -0x100;
  } while ((int)uVar7 < 0x20);
  return;
}



ulonglong FUN_180036810(longlong param_1,int param_2)

{
  ushort *puVar1;
  ushort *puVar2;
  ushort uVar3;
  ushort uVar4;
  longlong lVar5;
  longlong lVar6;
  longlong lVar7;
  ushort uVar8;
  int iVar9;
  longlong lVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  longlong lVar16;
  longlong lVar17;

  iVar12 = param_2 + -1;
  iVar11 = 0;
  iVar15 = iVar12 >> 1;
  if (0 < iVar12) {
    lVar10 = (longlong)iVar12;
    lVar16 = 0;
    lVar17 = (longlong)iVar15;
    do {
      iVar9 = iVar11 + 1;
      if (iVar9 == iVar12) {
        uVar8 = *(ushort *)(param_1 + (longlong)iVar12 * 2);
        puVar1 = (ushort *)(param_1 + (longlong)iVar12 * 2);
        lVar10 = (longlong)iVar11;
        uVar4 = *(ushort *)(param_1 + lVar10 * 2);
        if ((short)uVar8 < (short)uVar4) {
          uVar8 = uVar8 ^ uVar4;
          *(ushort *)(param_1 + lVar10 * 2) = uVar8;
          *puVar1 = *puVar1 ^ uVar8;
          puVar2 = (ushort *)(param_1 + lVar10 * 2);
          *puVar2 = *puVar2 ^ *puVar1;
        }
        uVar8 = *(ushort *)(param_1 + lVar17 * 2);
        goto LAB_18003699c;
      }
      uVar8 = *(ushort *)(param_1 + lVar10 * 2);
      lVar5 = (longlong)(iVar12 + iVar11 >> 1);
      puVar1 = (ushort *)(param_1 + lVar5 * 2);
      uVar4 = *(ushort *)(param_1 + lVar5 * 2);
      if ((short)uVar8 < (short)uVar4) {
        uVar4 = uVar4 ^ uVar8;
        *puVar1 = uVar4;
        puVar2 = (ushort *)(param_1 + lVar10 * 2);
        *puVar2 = *puVar2 ^ uVar4;
        *puVar1 = *puVar1 ^ *(ushort *)(param_1 + lVar10 * 2);
      }
      uVar8 = *(ushort *)(param_1 + lVar16 * 2);
      uVar4 = *(ushort *)(param_1 + lVar10 * 2);
      if ((short)uVar4 < (short)uVar8) {
        uVar8 = uVar8 ^ uVar4;
        *(ushort *)(param_1 + lVar16 * 2) = uVar8;
        puVar2 = (ushort *)(param_1 + lVar10 * 2);
        *puVar2 = *puVar2 ^ uVar8;
        uVar8 = *(ushort *)(param_1 + lVar16 * 2) ^ *(ushort *)(param_1 + lVar10 * 2);
        *(ushort *)(param_1 + lVar16 * 2) = uVar8;
      }
      uVar4 = *puVar1;
      if ((short)uVar8 < (short)uVar4) {
        *puVar1 = uVar4 ^ uVar8;
        puVar2 = (ushort *)(param_1 + lVar16 * 2);
        *puVar2 = *puVar2 ^ uVar4 ^ uVar8;
        uVar4 = *puVar1 ^ *(ushort *)(param_1 + lVar16 * 2);
        *puVar1 = uVar4;
      }
      uVar8 = *(ushort *)(param_1 + 2 + lVar16 * 2);
      lVar5 = lVar16 + 1;
      lVar7 = lVar10;
      iVar14 = iVar12;
      if (uVar4 != uVar8) {
        uVar8 = uVar8 ^ uVar4;
        *puVar1 = uVar8;
        puVar2 = (ushort *)(param_1 + lVar5 * 2);
        *puVar2 = *puVar2 ^ uVar8;
        *puVar1 = *puVar1 ^ *(ushort *)(param_1 + lVar5 * 2);
      }
      while( true ) {
        uVar8 = *(ushort *)(param_1 + lVar16 * 2);
        do {
          uVar4 = *(ushort *)(param_1 + 2 + lVar5 * 2);
          iVar9 = iVar9 + 1;
          lVar5 = lVar5 + 1;
        } while ((short)uVar4 < (short)uVar8);
        do {
          iVar13 = iVar14;
          lVar6 = lVar7;
          uVar3 = *(ushort *)(param_1 + -2 + lVar6 * 2);
          lVar7 = lVar6 + -1;
          iVar14 = iVar13 + -1;
        } while ((short)uVar8 < (short)uVar3);
        if (iVar14 < iVar9) break;
        if (uVar4 != uVar3) {
          *(ushort *)(param_1 + lVar5 * 2) = uVar3 ^ uVar4;
          puVar1 = (ushort *)(param_1 + lVar7 * 2);
          *puVar1 = *puVar1 ^ uVar3 ^ uVar4;
          puVar1 = (ushort *)(param_1 + lVar5 * 2);
          *puVar1 = *puVar1 ^ *(ushort *)(param_1 + lVar7 * 2);
        }
      }
      if (uVar8 != uVar3) {
        *(ushort *)(param_1 + lVar16 * 2) = uVar3 ^ uVar8;
        puVar1 = (ushort *)(param_1 + lVar7 * 2);
        *puVar1 = *puVar1 ^ uVar3 ^ uVar8;
        puVar1 = (ushort *)(param_1 + lVar16 * 2);
        *puVar1 = *puVar1 ^ *(ushort *)(param_1 + lVar7 * 2);
      }
      if (lVar17 < lVar7) {
        iVar9 = iVar11;
        lVar5 = lVar16;
      }
      lVar16 = lVar5;
      iVar11 = iVar9;
      if (lVar17 <= lVar7) {
        iVar12 = iVar13 + -2;
        lVar10 = lVar6 + -2;
      }
    } while (iVar11 < iVar12);
  }
  uVar8 = *(ushort *)(param_1 + (longlong)iVar15 * 2);
LAB_18003699c:
  return (ulonglong)uVar8;
}



void FUN_1800369f0(longlong param_1,undefined8 *param_2,int param_3,longlong param_4)

{
  undefined8 *puVar1;
  uint *puVar2;
  int iVar3;
  int iVar4;
  short sVar5;
  ulonglong uVar6;
  ulonglong uVar7;
  uint uVar8;
  short *psVar9;
  undefined auStack328 [32];
  undefined8 local_128 [32];
  ulonglong local_28;

  local_28 = DAT_1800b04e8 ^ (ulonglong)auStack328;
  memset(local_128,0,0x100);
  iVar3 = *(int *)(param_4 + 8);
  iVar4 = *(int *)(param_4 + 0xc);
  if ((iVar4 * iVar3 <= param_3) && (param_3 < 0x81)) {
    uVar8 = param_3 * 2;
    if (((param_2 != (undefined8 *)0x0) && (uVar8 != 0)) &&
       ((((undefined8 *)((ulonglong)uVar8 + (longlong)param_2) <= local_128 ||
         ((undefined8 *)((longlong)local_128 + (ulonglong)uVar8) <= param_2)) && (uVar8 != 0)))) {
      memcpy_FUN_180061f90(local_128,param_2,(ulonglong)uVar8);
    }
    uVar6 = FUN_180036810((longlong)local_128,param_3);
    uVar7 = 0;
    sVar5 = (short)uVar6;
    if (iVar4 == 1) {
      uVar6 = uVar7;
      if (0 < iVar3) {
        do {
          puVar1 = (undefined8 *)((longlong)param_2 + uVar7 * 2);
          uVar8 = (uint)uVar6;
          if (*(short *)puVar1 != sVar5 && sVar5 <= *(short *)puVar1) {
            puVar2 = (uint *)(param_1 + ((longlong)(int)uVar8 >> 5) * 4);
            *puVar2 = *puVar2 | 1 << (uVar8 & 0x1f);
          }
          uVar7 = uVar7 + 1;
          uVar6 = (ulonglong)(uVar8 + 1);
        } while ((longlong)uVar7 < (longlong)iVar3);
      }
    }
    else {
      if (0 < iVar3) {
        psVar9 = (short *)((longlong)param_2 + 2);
        uVar6 = uVar7;
        do {
          if (*psVar9 != sVar5 && sVar5 <= *psVar9) {
            *(uint *)(param_1 + ((longlong)uVar6 >> 5) * 4) =
                 *(uint *)(param_1 + ((longlong)uVar6 >> 5) * 4) | 1 << ((uint)uVar7 & 0x1f);
          }
          uVar8 = (uint)uVar7 + 1;
          uVar7 = (ulonglong)uVar8;
          psVar9 = psVar9 + iVar4;
          uVar6 = uVar6 + 1;
        } while ((int)uVar8 < iVar3);
      }
    }
  }
  FUN_18005f100(local_28 ^ (ulonglong)auStack328);
  return;
}



void FUN_180036b60(longlong param_1,longlong param_2,int param_3,uint param_4,uint param_5)

{
  undefined (*pauVar1) [16];
  undefined *puVar2;
  longlong lVar3;
  longlong lVar4;
  short sVar5;
  uint uVar6;
  undefined (*_Memory) [16];
  undefined (*_Memory_00) [16];
  undefined (*pauVar7) [16];
  undefined (*_Memory_01) [16];
  undefined (*pauVar8) [16];
  undefined *_Memory_02;
  undefined *_Memory_03;
  int *piVar9;
  ulonglong uVar10;
  int iVar11;
  int iVar12;
  ulonglong uVar13;
  longlong lVar14;
  longlong lVar15;
  int iVar16;
  int iVar17;
  byte *pbVar18;
  uint uVar19;
  int iVar20;
  longlong lVar21;
  int iVar22;
  int *piVar23;
  undefined *puVar24;
  longlong lVar25;
  size_t _Size;
  int iVar26;
  undefined auVar27 [16];
  undefined auVar28 [16];
  undefined auVar29 [16];
  uint local_res20 [2];

  lVar21 = (longlong)param_3;
  uVar19 = param_3 * param_4;
  _Size = (longlong)(int)uVar19 << 2;
  local_res20[0] = param_4;
  param_5 = uVar19;
  _Memory = (undefined (*) [16])malloc(_Size);
  _Memory_00 = (undefined (*) [16])malloc(_Size);
  if ((_Memory != (undefined (*) [16])0x0) && (uVar19 * 4 != 0)) {
    uVar13 = (ulonglong)(uVar19 * 4);
    pauVar7 = _Memory;
    while (uVar13 != 0) {
      uVar13 = uVar13 - 1;
      (*pauVar7)[0] = 0;
      pauVar7 = (undefined (*) [16])(*pauVar7 + 1);
    }
  }
  if ((_Memory_00 != (undefined (*) [16])0x0) && (uVar19 * 4 != 0)) {
    uVar13 = (ulonglong)(uVar19 * 4);
    pauVar7 = _Memory_00;
    while (uVar13 != 0) {
      uVar13 = uVar13 - 1;
      (*pauVar7)[0] = 0;
      pauVar7 = (undefined (*) [16])(*pauVar7 + 1);
    }
  }
  pauVar7 = (undefined (*) [16])malloc(_Size);
  _Memory_01 = (undefined (*) [16])malloc(_Size);
  if ((pauVar7 != (undefined (*) [16])0x0) &&
     (uVar13 = (ulonglong)(uVar19 * 4), pauVar8 = pauVar7, uVar19 * 4 != 0)) {
    while (uVar13 != 0) {
      uVar13 = uVar13 - 1;
      (*pauVar8)[0] = 0;
      pauVar8 = (undefined (*) [16])(*pauVar8 + 1);
    }
  }
  if ((_Memory_01 != (undefined (*) [16])0x0) && (uVar19 * 4 != 0)) {
    uVar13 = (ulonglong)(uVar19 * 4);
    pauVar8 = _Memory_01;
    while (uVar13 != 0) {
      uVar13 = uVar13 - 1;
      (*pauVar8)[0] = 0;
      pauVar8 = (undefined (*) [16])(*pauVar8 + 1);
    }
  }
  iVar16 = local_res20[0] - 1;
  if (1 < iVar16) {
    uVar13 = (ulonglong)(local_res20[0] - 2);
    piVar9 = (int *)(*_Memory_00 + lVar21 * 4 + 4);
    do {
      param_1 = lVar21 + param_1;
      if (1 < (longlong)(param_3 + -1)) {
        lVar14 = lVar21 * 2;
        lVar25 = (longlong)(param_3 + -1) + -1;
        pbVar18 = (byte *)(param_1 + (2 - lVar21));
        piVar23 = piVar9;
        do {
          *(uint *)((longlong)_Memory + (-4 - (longlong)_Memory_00) + (longlong)(piVar23 + 1)) =
               ((((uint)pbVar18[lVar21] - (uint)pbVar18[lVar21 + -2]) * 2 - (uint)pbVar18[-2]) -
               (uint)pbVar18[lVar14 + -2]) + (uint)pbVar18[lVar14] + (uint)*pbVar18;
          *piVar23 = ((((uint)pbVar18[lVar14 + -1] - (uint)pbVar18[-1]) * 2 - (uint)pbVar18[-2]) -
                     (uint)*pbVar18) + (uint)pbVar18[lVar14] + (uint)pbVar18[lVar14 + -2];
          lVar25 = lVar25 + -1;
          pbVar18 = pbVar18 + 1;
          piVar23 = piVar23 + 1;
        } while (lVar25 != 0);
      }
      piVar9 = piVar9 + lVar21;
      uVar13 = uVar13 - 1;
      uVar19 = param_5;
    } while (uVar13 != 0);
  }
  iVar26 = 0;
  if (0 < (int)uVar19) {
    iVar22 = 0;
    if ((3 < uVar19) && (iVar22 = iVar26, 1 < DAT_1800b04f8)) {
      lVar25 = (longlong)(int)(uVar19 - 1);
      pauVar8 = (undefined (*) [16])(*_Memory_01 + lVar25 * 4);
      if ((((((undefined (*) [16])(*_Memory_00 + lVar25 * 4) < _Memory_01) || (pauVar8 < _Memory_00)
            ) && (((undefined (*) [16])(*_Memory + lVar25 * 4) < _Memory_01 || (pauVar8 < _Memory)))
           ) && ((pauVar1 = (undefined (*) [16])(*pauVar7 + lVar25 * 4), pauVar1 < _Memory_01 ||
                 (pauVar8 < pauVar7)))) &&
         ((((undefined (*) [16])(*_Memory_00 + lVar25 * 4) < pauVar7 || (pauVar1 < _Memory_00)) &&
          (((undefined (*) [16])(*_Memory + lVar25 * 4) < pauVar7 || (pauVar1 < _Memory)))))) {
        uVar6 = uVar19 & 0x80000003;
        if ((int)uVar6 < 0) {
          uVar6 = (uVar6 - 1 | 0xfffffffc) + 1;
        }
        pauVar8 = _Memory_00;
        iVar22 = 0;
        do {
          auVar28 = *pauVar8;
          iVar22 = iVar22 + 4;
          auVar29 = *(undefined (*) [16])
                     (*pauVar8 +
                     (longlong)*(undefined (*) [16])((longlong)_Memory - (longlong)_Memory_00));
          pauVar8 = pauVar8[1];
          auVar27 = pmulld(auVar28,auVar29);
          auVar29 = pmulld(auVar29,auVar29);
          auVar28 = pmulld(auVar28,auVar28);
          piVar9 = (int *)(*pauVar8 + (longlong)_Memory_01 + (-0x10 - (longlong)_Memory_00));
          *piVar9 = SUB164(auVar29,0) - SUB164(auVar28,0);
          piVar9[1] = SUB164(auVar29 >> 0x20,0) - SUB164(auVar28 >> 0x20,0);
          piVar9[2] = SUB164(auVar29 >> 0x40,0) - SUB164(auVar28 >> 0x40,0);
          piVar9[3] = SUB164(auVar29 >> 0x60,0) - SUB164(auVar28 >> 0x60,0);
          piVar9 = (int *)(*pauVar8 + (longlong)pauVar7 + (-0x10 - (longlong)_Memory_00));
          *piVar9 = SUB164(auVar27,0) << 1;
          piVar9[1] = SUB164(auVar27 >> 0x20,0);
          piVar9[2] = SUB164(auVar27 >> 0x40,0);
          piVar9[3] = SUB164(auVar27 >> 0x60,0);
        } while (iVar22 < (int)(uVar19 - uVar6));
      }
    }
    if (iVar22 < (int)uVar19) {
      uVar13 = (ulonglong)(uVar19 - iVar22);
      piVar9 = (int *)(*_Memory_00 + (longlong)iVar22 * 4);
      do {
        *(int *)((longlong)piVar9 + (longlong)((longlong)pauVar7 - (longlong)_Memory_00)) =
             *(int *)((longlong)piVar9 +
                     (longlong)*(undefined (*) [16])((longlong)_Memory - (longlong)_Memory_00)) *
             *piVar9 * 2;
        iVar26 = *(int *)((longlong)(piVar9 + 1) +
                         (longlong)
                         (((undefined (*) [16])((longlong)_Memory - (longlong)_Memory_00))[-1] + 0xc
                         ));
        *(int *)((longlong)piVar9 + (longlong)((longlong)_Memory_01 - (longlong)_Memory_00)) =
             iVar26 * iVar26 - *piVar9 * *piVar9;
        uVar13 = uVar13 - 1;
        piVar9 = piVar9 + 1;
      } while (uVar13 != 0);
    }
  }
  free(_Memory);
  free(_Memory_00);
  _Memory_02 = (undefined *)malloc(_Size);
  _Memory_03 = (undefined *)malloc(_Size);
  if ((_Memory_02 != (undefined *)0x0) && (uVar19 * 4 != 0)) {
    uVar13 = (ulonglong)(uVar19 * 4);
    puVar24 = _Memory_02;
    while (uVar13 != 0) {
      uVar13 = uVar13 - 1;
      *puVar24 = 0;
      puVar24 = puVar24 + 1;
    }
  }
  if ((_Memory_03 != (undefined *)0x0) &&
     (uVar13 = (ulonglong)(uVar19 * 4), puVar24 = _Memory_03, uVar19 * 4 != 0)) {
    while (uVar13 != 0) {
      uVar13 = uVar13 - 1;
      *puVar24 = 0;
      puVar24 = puVar24 + 1;
    }
  }
  if (1 < (int)local_res20[0]) {
    uVar13 = (ulonglong)(local_res20[0] - 1);
    puVar24 = _Memory_02 + lVar21 * 4;
    do {
      lVar25 = 1;
      if (1 < lVar21) {
        puVar2 = puVar24 + (longlong)(_Memory_03 + -(longlong)_Memory_02);
        piVar9 = (int *)(puVar24 + (longlong)pauVar7 + (4 - (longlong)_Memory_02));
        do {
          lVar14 = lVar25 - lVar21;
          lVar25 = lVar25 + 1;
          lVar3 = lVar14 * 4;
          lVar14 = lVar14 * 4 + -4;
          *(int *)((longlong)piVar9 + (longlong)(_Memory_02 + -(longlong)pauVar7)) =
               (*(int *)(puVar24 + lVar3) - *(int *)(puVar24 + lVar14)) +
               *(int *)((longlong)((longlong)piVar9 + -4) +
                       (longlong)(_Memory_02 + -(longlong)pauVar7)) + *piVar9;
          *(int *)((longlong)piVar9 +
                  (longlong)
                  (_Memory_02 + (longlong)(puVar2 + (-(longlong)pauVar7 - (longlong)puVar24)))) =
               (*(int *)((longlong)_Memory_01 + (-4 - (longlong)pauVar7) + (longlong)(piVar9 + 1)) -
               *(int *)(puVar2 + lVar14)) +
               *(int *)((longlong)piVar9 +
                       (longlong)
                       ((longlong)
                        (_Memory_02 + (longlong)(puVar2 + (-(longlong)pauVar7 - (longlong)puVar24)))
                       + -4)) + *(int *)(puVar2 + lVar3);
          piVar9 = piVar9 + 1;
        } while (lVar25 < lVar21);
      }
      puVar24 = puVar24 + lVar21 * 4;
      uVar13 = uVar13 - 1;
    } while (uVar13 != 0);
  }
  if (0 < (int)local_res20[0]) {
    uVar13 = (ulonglong)local_res20[0];
    iVar26 = 6;
    do {
      lVar25 = 0;
      if (0 < lVar21) {
        iVar20 = 6;
        iVar22 = iVar26;
        if (iVar16 <= iVar26) {
          iVar22 = iVar16;
        }
        do {
          iVar11 = 1;
          if (1 < iVar20 + -0xc) {
            iVar11 = iVar20 + -0xc;
          }
          iVar12 = iVar20;
          if (param_3 + -1 <= iVar20) {
            iVar12 = param_3 + -1;
          }
          iVar17 = 1;
          if (1 < iVar26 + -0xc) {
            iVar17 = iVar26 + -0xc;
          }
          iVar17 = (iVar17 + -1) * param_3;
          lVar14 = (longlong)(iVar11 + -1 + iVar17) * 4;
          lVar3 = (longlong)(iVar17 + iVar12) * 4;
          lVar4 = (longlong)(iVar11 + -1 + iVar22 * param_3) * 4;
          lVar15 = (longlong)(iVar22 * param_3 + iVar12);
          param_5 = ((*(int *)(_Memory_03 + lVar15 * 4) - *(int *)(_Memory_03 + lVar4)) -
                    *(int *)(_Memory_03 + lVar3)) + *(int *)(_Memory_03 + lVar14);
          local_res20[0] =
               ((*(int *)(_Memory_02 + lVar15 * 4) - *(int *)(_Memory_02 + lVar4)) -
               *(int *)(_Memory_02 + lVar3)) + *(int *)(_Memory_02 + lVar14);
          uVar10 = FUN_1800350d0(&param_5,local_res20);
          sVar5 = (short)uVar10;
          iVar11 = sVar5 + 0x6488;
          if (-1 < sVar5) {
            iVar11 = (int)sVar5;
          }
          iVar11 = iVar11 * 0x1ca6 >> 0x14;
          iVar12 = iVar11 + -0x87;
          if (iVar12 < 1) {
            iVar12 = iVar11 + 0x2d;
          }
          iVar20 = iVar20 + 1;
          *(char *)(lVar25 + param_2) = -0x4c - (char)iVar12;
          lVar25 = lVar25 + 1;
        } while (lVar25 < lVar21);
      }
      iVar26 = iVar26 + 1;
      param_2 = param_2 + lVar21;
      uVar13 = uVar13 - 1;
    } while (uVar13 != 0);
  }
  free(pauVar7);
  free(_Memory_01);
  free(_Memory_02);
                    // WARNING: Could not recover jumptable at 0x000180037177. Too many branches
                    // WARNING: Treating indirect jump as call
  free(_Memory_03);
  return;
}



void FUN_180037360(int *param_1)

{
  longlong *plVar1;
  int iVar2;
  uint uVar3;
  longlong lVar4;
  int *piVar5;
  int iVar6;
  longlong lVar7;
  int *piVar8;
  byte *pbVar9;
  int iVar10;
  undefined8 unaff_RBP;
  int iVar11;
  undefined8 unaff_RSI;
  int iVar12;
  longlong lVar13;
  undefined8 unaff_R12;
  longlong lVar14;
  int iVar15;
  longlong alStackX8 [2];
  byte *pbStackX24;
  longlong lStackX32;
  undefined8 uStack48;

  uStack48 = 0x180037373;
  lVar4 = _alloca_probe();
  lVar4 = -lVar4;
  *(ulonglong *)(&stack0x00004cf8 + lVar4) =
       DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffd8 + lVar4);
  iVar2 = param_1[4];
  iVar15 = param_1[1];
  iVar11 = *param_1;
  *(undefined8 *)((longlong)&uStack48 + lVar4) = 0x180037399;
  piVar5 = FUN_180022ff0(iVar11,iVar15,iVar2,*(undefined *)((longlong)&uStack48 + lVar4));
  iVar2 = *param_1;
  lVar14 = (longlong)iVar2;
  uVar3 = param_1[1];
  lVar7 = *(longlong *)(param_1 + 6);
  *(int **)(&stack0x00000038 + lVar4) = piVar5;
  *(undefined8 *)((longlong)&uStack48 + lVar4) = 0x1800373bf;
  FUN_180036b60(lVar7,(longlong)(&stack0x00000068 + lVar4),iVar2,uVar3,
                *(undefined4 *)(&stack0xfffffffffffffff8 + lVar4));
  lVar13 = *(longlong *)(piVar5 + 6);
  iVar15 = 0;
  lVar7 = *(longlong *)(param_1 + 6);
  *(longlong *)(&stack0x00000028 + lVar4) = lVar13;
  *(longlong *)(&stack0x00000030 + lVar4) = lVar7;
  *(undefined4 *)(&stack0x00000050 + lVar4) = 4;
  *(undefined4 *)(&stack0x00000054 + lVar4) = 2;
  *(undefined4 *)(&stack0x00000058 + lVar4) = 1;
  *(undefined4 *)(&stack0x00000040 + lVar4) = 1;
  *(undefined4 *)(&stack0x00000044 + lVar4) = 2;
  *(undefined4 *)(&stack0x00000048 + lVar4) = 4;
  *(undefined4 *)(&stack0x0000004c + lVar4) = 8;
  if (0 < (int)uVar3) {
    *(undefined8 *)(&stack0x00004d40 + lVar4) = unaff_RBP;
    pbVar9 = &stack0x00000068 + lVar4;
    *(undefined8 *)(&stack0x00004d48 + lVar4) = unaff_RSI;
    *(undefined8 *)(&stack0x00004d50 + lVar4) = unaff_R12;
    *(byte **)((longlong)&pbStackX24 + lVar4) = pbVar9;
    do {
      iVar11 = 0;
      if (0 < lVar14) {
        *(longlong *)((longlong)alStackX8 + lVar4 + 8) = lVar14;
        lVar7 = lVar7 - (longlong)(&stack0x00000068 + lVar4);
        *(longlong *)((longlong)&lStackX32 + lVar4) = lVar7;
        *(longlong *)((longlong)alStackX8 + lVar4) = lVar13 - (longlong)(&stack0x00000068 + lVar4);
        do {
          if ((byte)(*pbVar9 - 8) < 0xa5) {
            iVar6 = (int)(*pbVar9 - 8) / 0xf + 1;
          }
          else {
            iVar6 = 0;
          }
          piVar5 = (int *)(&stack0x00000040 + lVar4);
          iVar10 = 0;
          iVar12 = 0;
          piVar8 = (int *)(&DAT_18007d370 + (longlong)iVar6 * 0x38);
          lVar13 = 7;
          do {
            iVar6 = piVar8[1] + iVar15;
            if ((-1 < iVar6) && (iVar6 < (int)uVar3)) {
              iVar6 = *piVar8 + iVar11;
              if ((-1 < iVar6) && (iVar6 < iVar2)) {
                iVar10 = iVar10 + (uint)pbVar9[(longlong)*piVar8 + piVar8[1] * iVar2 + lVar7] *
                                  *piVar5;
                iVar12 = iVar12 + *piVar5;
              }
            }
            piVar8 = piVar8 + 2;
            piVar5 = piVar5 + 1;
            lVar13 = lVar13 + -1;
          } while (lVar13 != 0);
          if (iVar12 == 0) {
            pbVar9[*(longlong *)((longlong)alStackX8 + lVar4)] = 0xff;
          }
          else {
            pbVar9[*(longlong *)((longlong)alStackX8 + lVar4)] = (byte)(iVar10 / iVar12);
          }
          lVar7 = *(longlong *)((longlong)&lStackX32 + lVar4);
          iVar11 = iVar11 + 1;
          pbVar9 = pbVar9 + 1;
          plVar1 = (longlong *)((longlong)alStackX8 + lVar4 + 8);
          *plVar1 = *plVar1 + -1;
        } while (*plVar1 != 0);
        pbVar9 = *(byte **)((longlong)&pbStackX24 + lVar4);
        lVar13 = *(longlong *)(&stack0x00000028 + lVar4);
        lVar7 = *(longlong *)(&stack0x00000030 + lVar4);
      }
      pbVar9 = pbVar9 + lVar14;
      iVar15 = iVar15 + 1;
      *(byte **)((longlong)&pbStackX24 + lVar4) = pbVar9;
    } while (iVar15 < (int)uVar3);
  }
  *(undefined8 *)((longlong)&uStack48 + lVar4) = 0x180037593;
  FUN_18005f100(*(ulonglong *)(&stack0x00004cf8 + lVar4) ^
                (ulonglong)(&stack0xffffffffffffffd8 + lVar4),
                *(undefined *)((longlong)&uStack48 + lVar4));
  return;
}



void FUN_1800375f0(longlong param_1,longlong param_2,longlong param_3,int param_4,int param_5)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  longlong lVar4;
  ushort *puVar5;
  ushort *puVar6;
  ulonglong uVar7;
  uint *puVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  longlong lVar12;
  uint uVar13;
  int iVar14;
  ulonglong uVar15;

  iVar3 = 0;
  iVar1 = **(int **)(param_1 + 0x90);
  piVar2 = *(int **)(*(int **)(param_1 + 0x90) + 8);
  iVar14 = param_4 * param_5;
  if (-1 < iVar14 + -4) {
    puVar6 = (ushort *)(param_2 + 4);
    puVar8 = (uint *)(param_3 + 8);
    uVar15 = (longlong)(iVar14 + -4) + 4U >> 2;
    iVar3 = (int)uVar15 * 4;
    do {
      uVar9 = (uint)puVar6[-2];
      puVar5 = puVar6 + -2;
      uVar10 = (uint)puVar6[-1];
      uVar11 = (uint)*puVar6;
      uVar13 = (uint)puVar6[1];
      if (1 < iVar1) {
        uVar7 = (ulonglong)(iVar1 - 1);
        do {
          puVar5 = puVar5 + param_5;
          uVar9 = uVar9 + *puVar5;
          uVar10 = uVar10 + puVar5[1];
          uVar11 = uVar11 + puVar5[2];
          uVar13 = uVar13 + puVar5[3];
          uVar7 = uVar7 - 1;
        } while (uVar7 != 0);
      }
      puVar6 = puVar6 + 4;
      puVar8[-2] = *piVar2 * uVar9 >> 0x10;
      puVar8[-1] = *piVar2 * uVar10 >> 0x10;
      *puVar8 = *piVar2 * uVar11 >> 0x10;
      puVar8[1] = *piVar2 * uVar13 >> 0x10;
      puVar8 = puVar8 + 4;
      uVar15 = uVar15 - 1;
    } while (uVar15 != 0);
  }
  lVar12 = (longlong)iVar3;
  if (lVar12 < iVar14) {
    puVar6 = (ushort *)(param_2 + lVar12 * 2);
    do {
      uVar9 = (uint)*puVar6;
      lVar4 = 1;
      if (1 < (longlong)iVar1) {
        do {
          puVar5 = puVar6 + lVar4;
          lVar4 = lVar4 + 1;
          uVar9 = uVar9 + *puVar5;
        } while (lVar4 < iVar1);
      }
      puVar6 = puVar6 + 1;
      *(uint *)(param_3 + lVar12 * 4) = *piVar2 * uVar9 >> 0x10;
      lVar12 = lVar12 + 1;
    } while (lVar12 < iVar14);
  }
  return;
}



void FUN_180037790(longlong param_1,longlong param_2,longlong param_3,int param_4,int param_5,
                  int param_6)

{
  longlong *plVar1;
  int iVar2;
  int *piVar3;
  longlong lVar4;
  longlong lVar5;
  longlong lVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  longlong lVar10;
  longlong lVar11;
  longlong *plVar12;
  undefined2 *puVar13;
  longlong *plVar14;
  longlong *plVar15;
  ulonglong uVar16;
  int iVar17;
  ulonglong uVar18;
  longlong local_res18;

  piVar3 = *(int **)(param_1 + 0x98);
  iVar2 = piVar3[10];
  lVar6 = (longlong)*piVar3 >> 1;
  piVar3 = (int *)(*(longlong *)(piVar3 + 8) + lVar6 * 4);
  plVar14 = (longlong *)(param_2 + lVar6 * 8);
  if (param_5 != 0) {
    plVar15 = plVar14 + -1;
    local_res18 = param_3;
    do {
      param_5 = param_5 + -1;
      uVar18 = 0;
      if (-1 < (longlong)(param_6 + -4)) {
        lVar11 = 8;
        uVar18 = (longlong)(param_6 + -4) + 4;
        uVar16 = uVar18 >> 2;
        puVar13 = (undefined2 *)(local_res18 + 4);
        uVar18 = uVar18 & 0xfffffffffffffffc;
        do {
          lVar4 = *plVar14;
          lVar10 = 1;
          iVar9 = *(int *)(lVar4 + -8 + lVar11);
          iVar8 = *(int *)(lVar4 + -4 + lVar11);
          iVar7 = *(int *)(lVar4 + lVar11);
          iVar17 = *(int *)(lVar4 + 4 + lVar11);
          plVar12 = plVar15;
          if (0 < lVar6) {
            do {
              lVar4 = *plVar12;
              lVar5 = plVar14[lVar10];
              lVar10 = lVar10 + 1;
              iVar9 = iVar9 + *(int *)(lVar4 + -8 + lVar11) + *(int *)(lVar5 + -8 + lVar11);
              iVar8 = iVar8 + *(int *)(lVar4 + -4 + lVar11) + *(int *)(lVar5 + -4 + lVar11);
              iVar7 = iVar7 + *(int *)(lVar5 + lVar11) + *(int *)(lVar4 + lVar11);
              iVar17 = iVar17 + *(int *)(lVar4 + 4 + lVar11) + *(int *)(lVar5 + 4 + lVar11);
              plVar12 = plVar12 + -1;
            } while (lVar10 <= lVar6);
          }
          lVar11 = lVar11 + 0x10;
          puVar13[-2] = (short)((uint)(*piVar3 * iVar9 + iVar2) >>
                               ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c) & 0x1f))
          ;
          puVar13[-1] = (short)((uint)(*piVar3 * iVar8 + iVar2) >>
                               ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c) & 0x1f))
          ;
          *puVar13 = (short)((uint)(*piVar3 * iVar7 + iVar2) >>
                            ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c) & 0x1f));
          puVar13[1] = (short)((uint)(*piVar3 * iVar17 + iVar2) >>
                              ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c) & 0x1f));
          puVar13 = puVar13 + 4;
          uVar16 = uVar16 - 1;
        } while (uVar16 != 0);
      }
      while ((longlong)uVar18 < (longlong)param_6) {
        iVar9 = *(int *)(*plVar14 + uVar18 * 4);
        lVar11 = 1;
        plVar12 = plVar15;
        if (0 < lVar6) {
          do {
            plVar1 = plVar14 + lVar11;
            lVar11 = lVar11 + 1;
            iVar9 = iVar9 + *(int *)(*plVar1 + uVar18 * 4) + *(int *)(*plVar12 + uVar18 * 4);
            plVar12 = plVar12 + -1;
          } while (lVar11 <= lVar6);
        }
        *(short *)(local_res18 + uVar18 * 2) =
             (short)((uint)(*piVar3 * iVar9 + iVar2) >>
                    ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c) & 0x1f));
        uVar18 = uVar18 + 1;
      }
      local_res18 = local_res18 + param_4;
      plVar14 = plVar14 + 1;
      plVar15 = plVar15 + 1;
    } while (param_5 != 0);
  }
  return;
}



void FUN_180037a40(longlong param_1,longlong param_2,longlong param_3,int param_4,int param_5)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  uint uVar5;
  longlong lVar6;
  ushort *puVar7;
  longlong lVar8;
  ushort *puVar9;
  longlong lVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  ulonglong uVar15;
  ulonglong uVar16;
  uint *puVar17;

  uVar5 = 0;
  iVar4 = param_4 * param_5;
  piVar3 = *(int **)(*(int **)(param_1 + 0x90) + 8);
  lVar8 = (longlong)**(int **)(param_1 + 0x90);
  if (-1 < iVar4 + -4) {
    puVar17 = (uint *)(param_3 + 8);
    uVar15 = (longlong)(iVar4 + -4) + 4;
    puVar9 = (ushort *)(param_2 + 4);
    uVar16 = uVar15 >> 2;
    uVar5 = (uint)uVar15 & 0xfffffffc;
    do {
      iVar2 = *piVar3;
      puVar7 = puVar9 + -2;
      lVar10 = 1;
      uVar12 = (uint)*puVar7 * iVar2;
      uVar13 = (uint)puVar9[-1] * iVar2;
      uVar14 = (uint)*puVar9 * iVar2;
      uVar11 = (uint)puVar9[1] * iVar2;
      if (1 < lVar8) {
        do {
          iVar2 = piVar3[lVar10];
          puVar7 = puVar7 + param_5;
          lVar10 = lVar10 + 1;
          uVar12 = uVar12 + (uint)*puVar7 * iVar2;
          uVar13 = uVar13 + (uint)puVar7[1] * iVar2;
          uVar14 = uVar14 + (uint)puVar7[2] * iVar2;
          uVar11 = uVar11 + (uint)puVar7[3] * iVar2;
        } while (lVar10 < lVar8);
      }
      puVar9 = puVar9 + 4;
      puVar17[-2] = uVar12 >> 0x10;
      puVar17[-1] = uVar13 >> 0x10;
      *puVar17 = uVar14 >> 0x10;
      puVar17[1] = uVar11 >> 0x10;
      puVar17 = puVar17 + 4;
      uVar16 = uVar16 - 1;
    } while (uVar16 != 0);
  }
  lVar10 = (longlong)(int)uVar5;
  if (lVar10 < iVar4) {
    puVar9 = (ushort *)(param_2 + lVar10 * 2);
    do {
      lVar6 = 1;
      uVar5 = (uint)*puVar9 * *piVar3;
      puVar7 = puVar9;
      if (1 < lVar8) {
        do {
          piVar1 = piVar3 + lVar6;
          lVar6 = lVar6 + 1;
          uVar5 = uVar5 + *piVar1 * (uint)puVar7[param_5];
          puVar7 = puVar7 + param_5;
        } while (lVar6 < lVar8);
      }
      puVar9 = puVar9 + 1;
      *(uint *)(param_3 + lVar10 * 4) = uVar5 >> 0x10;
      lVar10 = lVar10 + 1;
    } while (lVar10 < iVar4);
  }
  return;
}



void FUN_180037be0(longlong param_1,longlong param_2,longlong param_3,int param_4,int param_5,
                  int param_6)

{
  longlong *plVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  longlong lVar6;
  longlong lVar7;
  undefined2 *puVar8;
  longlong lVar9;
  uint uVar10;
  uint uVar11;
  longlong *plVar12;
  ulonglong uVar13;
  longlong lVar14;
  uint uVar15;
  longlong *plVar16;
  longlong *plVar17;
  longlong lVar18;
  uint uVar19;
  ulonglong uVar20;
  longlong local_res18;

  piVar5 = *(int **)(param_1 + 0x98);
  iVar3 = piVar5[10];
  lVar9 = (longlong)*piVar5 >> 1;
  piVar5 = (int *)(*(longlong *)(piVar5 + 8) + lVar9 * 4);
  plVar17 = (longlong *)(param_2 + lVar9 * 8);
  if (param_5 != 0) {
    plVar12 = plVar17 + -1;
    local_res18 = param_3;
    do {
      param_5 = param_5 + -1;
      uVar20 = 0;
      if (-1 < (longlong)(param_6 + -4)) {
        lVar18 = 8;
        uVar20 = (longlong)(param_6 + -4) + 4;
        uVar13 = uVar20 >> 2;
        puVar8 = (undefined2 *)(local_res18 + 4);
        uVar20 = uVar20 & 0xfffffffffffffffc;
        do {
          lVar6 = *plVar17;
          lVar14 = 1;
          iVar4 = *piVar5;
          uVar15 = *(int *)(lVar6 + -8 + lVar18) * iVar4 + iVar3;
          uVar11 = *(int *)(lVar6 + -4 + lVar18) * iVar4 + iVar3;
          uVar10 = *(int *)(lVar6 + lVar18) * iVar4 + iVar3;
          uVar19 = *(int *)(lVar6 + 4 + lVar18) * iVar4 + iVar3;
          plVar16 = plVar12;
          if (0 < lVar9) {
            do {
              lVar6 = *plVar16;
              lVar7 = plVar17[lVar14];
              iVar4 = piVar5[lVar14];
              lVar14 = lVar14 + 1;
              uVar15 = uVar15 + (*(int *)(lVar18 + -8 + lVar6) + *(int *)(lVar7 + -8 + lVar18)) *
                                iVar4;
              uVar11 = uVar11 + (*(int *)(lVar18 + -4 + lVar6) + *(int *)(lVar7 + -4 + lVar18)) *
                                iVar4;
              uVar10 = uVar10 + (*(int *)(lVar18 + lVar6) + *(int *)(lVar7 + lVar18)) * iVar4;
              uVar19 = uVar19 + (*(int *)(lVar18 + 4 + lVar6) + *(int *)(lVar7 + 4 + lVar18)) *
                                iVar4;
              plVar16 = plVar16 + -1;
            } while (lVar14 <= lVar9);
          }
          lVar18 = lVar18 + 0x10;
          puVar8[-2] = (short)(uVar15 >>
                              ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c) & 0x1f));
          puVar8[-1] = (short)(uVar11 >>
                              ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c) & 0x1f));
          *puVar8 = (short)(uVar10 >>
                           ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c) & 0x1f));
          puVar8[1] = (short)(uVar19 >>
                             ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c) & 0x1f));
          puVar8 = puVar8 + 4;
          uVar13 = uVar13 - 1;
        } while (uVar13 != 0);
      }
      while ((longlong)uVar20 < (longlong)param_6) {
        lVar18 = 1;
        uVar10 = *(int *)(*plVar17 + uVar20 * 4) * *piVar5 + iVar3;
        plVar16 = plVar12;
        if (0 < lVar9) {
          do {
            plVar1 = plVar17 + lVar18;
            piVar2 = piVar5 + lVar18;
            lVar18 = lVar18 + 1;
            uVar10 = uVar10 + (*(int *)(*plVar1 + uVar20 * 4) + *(int *)(*plVar16 + uVar20 * 4)) *
                              *piVar2;
            plVar16 = plVar16 + -1;
          } while (lVar18 <= lVar9);
        }
        *(short *)(local_res18 + uVar20 * 2) =
             (short)(uVar10 >> ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c) & 0x1f))
        ;
        uVar20 = uVar20 + 1;
      }
      local_res18 = local_res18 + param_4;
      plVar12 = plVar12 + 1;
      plVar17 = plVar17 + 1;
    } while (param_5 != 0);
  }
  return;
}



ulonglong FUN_180037ef0(int *param_1,longlong param_2,int param_3,int param_4,longlong param_5,
                       int param_6)

{
  undefined4 *puVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  longlong lVar10;
  longlong lVar11;
  bool bVar12;
  int iVar13;
  uint uVar14;
  longlong lVar15;
  undefined *puVar16;
  longlong lVar17;
  undefined4 *puVar18;
  int iVar19;
  ulonglong uVar20;
  undefined4 *puVar21;
  ulonglong uVar22;
  int iVar23;
  uint *puVar24;
  uint uVar25;
  longlong lVar26;
  int *piVar27;
  undefined4 *puVar28;
  uint uVar29;
  uint uVar30;
  int iVar31;
  uint uVar32;
  uint uVar33;
  longlong lVar34;
  longlong lVar35;
  int iVar36;
  ulonglong uVar37;
  undefined *local_res10;
  uint local_98;

  lVar10 = *(longlong *)(param_1 + 10);
  iVar2 = param_1[0x20];
  lVar11 = *(longlong *)(param_1 + 0x14);
  iVar3 = param_1[0x13];
  iVar4 = param_1[0x21];
  iVar5 = param_1[6];
  iVar6 = param_1[9];
  iVar7 = param_1[4];
  iVar23 = (*param_1 >> 3 & 0x1ffU) + 1 << ((byte)(0xfa50 >> ((byte)*param_1 & 7) * '\x02') & 3);
  iVar8 = param_1[0x11];
  iVar9 = param_1[3];
  iVar13 = param_1[5];
  if (param_1[0xf] == iVar13 || param_1[0xf] < iVar13) {
    iVar13 = param_1[0xf];
  }
  if (((iVar2 < 1) && (iVar4 < 1)) || (bVar12 = true, param_1[7] == 0)) {
    bVar12 = false;
  }
  local_98 = 0;
  if (iVar3 == 0) {
    return 0xffffffff;
  }
  local_res10 = (undefined *)(param_2 - iVar13 * iVar23);
  iVar13 = (param_1[0x1d] - param_1[0x1e]) - param_1[0x1b];
  if (iVar13 < param_4) {
    param_4 = iVar13;
  }
  lVar15 = (longlong)(iVar2 * iVar6);
  lVar34 = (longlong)(iVar2 * iVar23);
  do {
    iVar13 = (((param_1[0x10] - param_1[0x1e]) - param_1[0x1b]) - iVar5) + iVar3;
    if (iVar13 < 1) {
      iVar13 = (iVar3 - iVar7) + 1;
    }
    if (param_4 < iVar13) {
      iVar13 = param_4;
    }
    param_4 = param_4 - iVar13;
    if (0 < iVar13) {
      iVar31 = (iVar9 + iVar8 + -1) - iVar4;
      uVar29 = (iVar31 - iVar2) * iVar23;
      do {
        iVar19 = param_1[0x1e];
        puVar28 = *(undefined4 **)(param_1 + 0x16);
        param_1[0x1e] = iVar19 + 1;
        lVar35 = (longlong)((((param_1[0x1b] - param_1[0x1c]) + iVar19) % iVar3) * param_1[0x1a]) +
                 *(longlong *)(param_1 + 0x18);
        if (iVar3 < iVar19 + 1) {
          param_1[0x1e] = iVar19;
          param_1[0x1b] = param_1[0x1b] + 1;
        }
        puVar16 = (undefined *)(lVar34 + (longlong)puVar28);
        if ((((puVar16 != (undefined *)0x0) && (local_res10 != (undefined *)0x0)) &&
            ((uVar29 != 0 &&
             ((uVar20 = (ulonglong)uVar29, local_res10 + uVar20 <= puVar16 ||
              (puVar16 + uVar20 <= local_res10)))))) && (uVar29 != 0)) {
          lVar26 = -(longlong)puVar16;
          do {
            *puVar16 = puVar16[(longlong)(local_res10 + lVar26)];
            puVar16 = puVar16 + 1;
            uVar20 = uVar20 - 1;
          } while (uVar20 != 0);
        }
        if (bVar12) {
          if (iVar6 * 4 == iVar23) {
            if (0 < lVar15) {
              puVar21 = puVar28;
              lVar26 = lVar15;
              do {
                *puVar21 = *(undefined4 *)
                            (local_res10 +
                            (longlong)*(int *)((lVar10 - (longlong)puVar28) + (longlong)puVar21) * 4
                            );
                lVar26 = lVar26 + -1;
                puVar21 = puVar21 + 1;
              } while (lVar26 != 0);
            }
            lVar26 = (longlong)(iVar4 * iVar6);
            if (0 < iVar4 * iVar6) {
              piVar27 = (int *)(lVar10 + lVar15 * 4);
              iVar19 = iVar31 * iVar6;
              do {
                iVar36 = *piVar27;
                piVar27 = piVar27 + 1;
                lVar17 = (longlong)iVar19;
                iVar19 = iVar19 + 1;
                puVar28[lVar17] = *(undefined4 *)(local_res10 + (longlong)iVar36 * 4);
                lVar26 = lVar26 + -1;
              } while (lVar26 != 0);
            }
          }
          else {
            lVar26 = 0;
            if (0 < lVar34) {
              do {
                *(undefined *)(lVar26 + (longlong)puVar28) =
                     local_res10[*(int *)(lVar10 + lVar26 * 4)];
                lVar26 = lVar26 + 1;
              } while (lVar26 < lVar34);
            }
            lVar26 = (longlong)(iVar4 * iVar23);
            if (0 < iVar4 * iVar23) {
              piVar27 = (int *)(lVar10 + lVar34 * 4);
              iVar19 = iVar31 * iVar23;
              do {
                iVar36 = *piVar27;
                piVar27 = piVar27 + 1;
                lVar17 = (longlong)iVar19;
                iVar19 = iVar19 + 1;
                *(undefined *)(lVar17 + (longlong)puVar28) = local_res10[iVar36];
                lVar26 = lVar26 + -1;
              } while (lVar26 != 0);
            }
          }
        }
        if (*(char *)(param_1 + 0x22) == '\0') {
          FUN_180037a40((longlong)param_1,(longlong)puVar28,lVar35,iVar8,
                        (*param_1 >> 3 & 0x1ffU) + 1);
        }
        else {
          uVar20 = 0;
          piVar27 = *(int **)(*(int **)(param_1 + 0x24) + 8);
          uVar14 = (*param_1 >> 3 & 0x1ffU) + 1;
          iVar19 = **(int **)(param_1 + 0x24);
          iVar36 = uVar14 * iVar8;
          if (-1 < iVar36 + -4) {
            uVar20 = (longlong)(iVar36 + -4) + 4;
            puVar24 = (uint *)(lVar35 + 8);
            uVar37 = uVar20 >> 2;
            puVar21 = puVar28 + 1;
            uVar20 = uVar20 & 0xfffffffffffffffc;
            do {
              uVar25 = (uint)*(ushort *)(puVar21 + -1);
              puVar18 = puVar21 + -1;
              uVar30 = (uint)*(ushort *)((longlong)puVar21 + -2);
              uVar32 = (uint)*(ushort *)puVar21;
              uVar33 = (uint)*(ushort *)((longlong)puVar21 + 2);
              if (1 < iVar19) {
                uVar22 = (ulonglong)(iVar19 - 1);
                do {
                  puVar1 = (undefined4 *)((longlong)puVar18 + (ulonglong)uVar14 * 2);
                  puVar18 = (undefined4 *)((longlong)puVar18 + (ulonglong)uVar14 * 2);
                  uVar25 = uVar25 + *(ushort *)puVar1;
                  uVar30 = uVar30 + *(ushort *)((longlong)puVar18 + 2);
                  uVar32 = uVar32 + *(ushort *)(puVar18 + 1);
                  uVar33 = uVar33 + *(ushort *)((longlong)puVar18 + 6);
                  uVar22 = uVar22 - 1;
                } while (uVar22 != 0);
              }
              puVar21 = puVar21 + 2;
              puVar24[-2] = *piVar27 * uVar25 >> 0x10;
              puVar24[-1] = *piVar27 * uVar30 >> 0x10;
              *puVar24 = *piVar27 * uVar32 >> 0x10;
              puVar24[1] = *piVar27 * uVar33 >> 0x10;
              puVar24 = puVar24 + 4;
              uVar37 = uVar37 - 1;
            } while (uVar37 != 0);
          }
          if ((longlong)uVar20 < (longlong)iVar36) {
            puVar28 = (undefined4 *)((longlong)puVar28 + uVar20 * 2);
            do {
              uVar14 = (uint)*(ushort *)puVar28;
              lVar26 = 1;
              if (1 < (longlong)iVar19) {
                do {
                  lVar17 = lVar26 * 2;
                  lVar26 = lVar26 + 1;
                  uVar14 = uVar14 + *(ushort *)((longlong)puVar28 + lVar17);
                } while (lVar26 < iVar19);
              }
              puVar28 = (undefined4 *)((longlong)puVar28 + 2);
              *(uint *)(lVar35 + uVar20 * 4) = *piVar27 * uVar14 >> 0x10;
              uVar20 = uVar20 + 1;
            } while ((longlong)uVar20 < (longlong)iVar36);
          }
        }
        iVar13 = iVar13 + -1;
        local_res10 = local_res10 + param_3;
      } while (0 < iVar13);
    }
    iVar31 = 0;
    iVar13 = iVar7 + -1 + ((param_1[0x12] - local_98) - param_1[0x1f]);
    lVar35 = 0;
    if (iVar3 <= iVar13) {
      iVar13 = iVar3;
    }
    if (0 < iVar13) {
      do {
        uVar14 = param_1[0xe];
        uVar29 = (param_1[0x10] - iVar5) + iVar31 + local_98 + param_1[0x1f];
        if ((uVar14 <= uVar29) && ((param_1[8] - 2U & 0xfffffffd) == 0)) {
          if (uVar14 == 1) {
            uVar29 = 0;
          }
          else {
            do {
              uVar25 = (uint)(param_1[8] == 4);
              if ((int)uVar29 < 0) {
                iVar19 = uVar25 - uVar29;
              }
              else {
                iVar19 = (uVar14 * 2 - uVar29) - uVar25;
              }
              uVar29 = iVar19 - 1;
            } while (uVar14 <= uVar29);
          }
        }
        if (param_1[0x1e] + param_1[0x1b] <= (int)uVar29) break;
        iVar31 = iVar31 + 1;
        *(longlong *)(lVar11 + lVar35 * 8) =
             (longlong)(((int)(uVar29 - param_1[0x1c]) % iVar3) * param_1[0x1a]) +
             *(longlong *)(param_1 + 0x18);
        lVar35 = lVar35 + 1;
      } while (lVar35 < iVar13);
    }
    if (iVar31 < iVar7) {
      param_1[0x1f] = param_1[0x1f] + local_98;
      return (ulonglong)local_98;
    }
    iVar31 = iVar31 + (1 - iVar7);
    if (*(char *)(param_1 + 0x22) == '\0') {
      FUN_180037be0((longlong)param_1,lVar11,param_5,param_6,iVar31,param_1[0x11]);
    }
    else {
      FUN_180037790((longlong)param_1,lVar11,param_5,param_6,iVar31,param_1[0x11]);
    }
    param_5 = param_5 + iVar31 * param_6;
    local_98 = local_98 + iVar31;
  } while( true );
}



ulonglong FUN_180038570(int *param_1,undefined8 param_2,undefined *param_3)

{
  uint uVar1;
  longlong lVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  void *pvVar7;
  int *piVar8;
  int iVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  longlong lVar17;
  int iVar18;

  iVar13 = *(int *)param_3;
  iVar9 = *(int *)(param_3 + 4);
  iVar11 = *(int *)(param_3 + 8);
  iVar16 = *(int *)(param_3 + 0xc);
  *(undefined8 *)(param_1 + 0xd) = param_2;
  iVar14 = (*param_1 >> 3 & 0x1ffU) + 1 << ((byte)(0xfa50 >> ((byte)*param_1 & 7) * '\x02') & 3);
  iVar15 = (param_1[2] >> 3 & 0x1ffU) + 1 << ((byte)(0xfa50 >> ((byte)param_1[2] & 7) * '\x02') & 3)
  ;
  iVar18 = param_1[4] + 3;
  iVar12 = param_1[6];
  iVar4 = (param_1[4] - iVar12) + -1;
  param_1[0xf] = iVar13;
  param_1[0x10] = iVar9;
  param_1[0x11] = iVar11;
  param_1[0x12] = iVar16;
  if (iVar4 <= iVar12) {
    iVar4 = iVar12;
  }
  iVar12 = iVar4 * 2 + 1;
  if (iVar12 <= iVar18) {
    iVar12 = iVar18;
  }
  param_1[0x13] = iVar12;
  pvVar7 = malloc((longlong)iVar12 << 3);
  param_1[0xc] = param_1[0x11];
  *(void **)(param_1 + 0x14) = pvVar7;
  pvVar7 = malloc((longlong)((param_1[0x11] + param_1[3] + -1) * iVar14));
  *(void **)(param_1 + 0x16) = pvVar7;
  pvVar7 = malloc((longlong)(int)(iVar12 * (param_1[0xc] + 0xfU & 0xfffffff0) * iVar15 + 0x10));
  iVar18 = param_1[5];
  iVar12 = param_1[0xf];
  uVar1 = param_1[0xd];
  *(void **)(param_1 + 0x18) = pvVar7;
  param_1[0x1a] = (param_1[0x11] + 0xfU & 0xfffffff0) * iVar15;
  iVar4 = 0;
  if (-1 < iVar18 - iVar12) {
    iVar4 = iVar18 - iVar12;
  }
  param_1[0x20] = iVar4;
  iVar9 = ((iVar12 - uVar1) - iVar18) + param_1[0x11] + param_1[3] + -1;
  iVar13 = 0;
  if (-1 < iVar9) {
    iVar13 = iVar9;
  }
  param_1[0x21] = iVar13;
  if ((0 < iVar4) || (0 < iVar13)) {
    lVar2 = *(longlong *)(param_1 + 10);
    if (iVar12 <= iVar18) {
      iVar18 = iVar12;
    }
    iVar13 = 1;
    if (3 < ((byte)*param_1 & 7)) {
      iVar13 = 4;
    }
    iVar9 = 0;
    uVar3 = iVar14 / iVar13;
    if (0 < iVar4) {
      iVar4 = 0;
      do {
        iVar13 = param_1[7];
        uVar10 = iVar9 - param_1[0x20];
        if ((uVar1 <= uVar10) && ((iVar13 - 2U & 0xfffffffd) == 0)) {
          if (uVar1 == 1) {
            uVar10 = 0;
          }
          else {
            do {
              if ((int)uVar10 < 0) {
                uVar5 = (uint)(iVar13 == 4);
              }
              else {
                uVar5 = uVar1 * 2 - (uint)(iVar13 == 4);
              }
              uVar10 = (uVar5 - uVar10) - 1;
            } while (uVar1 <= uVar10);
          }
        }
        iVar11 = 0;
        iVar13 = (uVar10 + (iVar18 - iVar12)) * uVar3;
        if ((0 < (int)uVar3) && (0xf < uVar3)) {
          uVar10 = uVar3 & 0x8000000f;
          if ((int)uVar10 < 0) {
            uVar10 = (uVar10 - 1 | 0xfffffff0) + 1;
          }
          piVar8 = (int *)(lVar2 + ((longlong)iVar4 + 4) * 4);
          iVar16 = 8;
          do {
            piVar8[-4] = iVar11 + iVar13;
            piVar8[-3] = iVar11 + 1 + iVar13;
            piVar8[-2] = iVar11 + 2 + iVar13;
            piVar8[-1] = iVar11 + 3 + iVar13;
            iVar11 = iVar11 + 0x10;
            *piVar8 = iVar16 + -4 + iVar13;
            piVar8[1] = iVar16 + -3 + iVar13;
            piVar8[2] = iVar16 + -2 + iVar13;
            piVar8[3] = iVar16 + -1 + iVar13;
            piVar8[4] = iVar16 + iVar13;
            piVar8[5] = iVar16 + 1 + iVar13;
            piVar8[6] = iVar16 + 2 + iVar13;
            piVar8[7] = iVar16 + 3 + iVar13;
            piVar8[8] = iVar16 + 4 + iVar13;
            piVar8[9] = iVar16 + 5 + iVar13;
            piVar8[10] = iVar16 + 6 + iVar13;
            piVar8[0xb] = iVar16 + 7 + iVar13;
            piVar8 = piVar8 + 0x10;
            iVar16 = iVar16 + 0x10;
          } while (iVar11 < (int)(uVar3 - uVar10));
        }
        lVar17 = (longlong)iVar11;
        if (lVar17 < (int)uVar3) {
          iVar13 = iVar13 + iVar11;
          piVar8 = (int *)(lVar2 + (iVar4 + lVar17) * 4);
          lVar17 = (int)uVar3 - lVar17;
          do {
            *piVar8 = iVar13;
            piVar8 = piVar8 + 1;
            iVar13 = iVar13 + 1;
            lVar17 = lVar17 + -1;
          } while (lVar17 != 0);
        }
        iVar9 = iVar9 + 1;
        iVar4 = iVar4 + uVar3;
      } while (iVar9 < param_1[0x20]);
    }
    uVar10 = 0;
    if (0 < param_1[0x21]) {
      do {
        iVar4 = param_1[7];
        uVar5 = uVar1 + uVar10;
        if ((uVar1 <= uVar5) && ((iVar4 - 2U & 0xfffffffd) == 0)) {
          if (uVar1 == 1) {
            uVar5 = 0;
          }
          else {
            do {
              if ((int)uVar5 < 0) {
                uVar6 = (uint)(iVar4 == 4);
              }
              else {
                uVar6 = uVar1 * 2 - (uint)(iVar4 == 4);
              }
              uVar5 = (uVar6 - uVar5) - 1;
            } while (uVar1 <= uVar5);
          }
        }
        iVar4 = 0;
        if (0 < (int)uVar3) {
          do {
            iVar13 = (uVar5 + (iVar18 - iVar12)) * uVar3 + iVar4;
            iVar9 = (param_1[0x20] + uVar10) * uVar3 + iVar4;
            iVar4 = iVar4 + 1;
            *(int *)(lVar2 + (longlong)iVar9 * 4) = iVar13;
          } while (iVar4 < (int)uVar3);
        }
        uVar10 = uVar10 + 1;
      } while ((int)uVar10 < param_1[0x21]);
    }
  }
  *(undefined8 *)(param_1 + 0x1e) = 0;
  uVar1 = 0;
  if (-1 < param_1[0x10] - param_1[6]) {
    uVar1 = param_1[0x10] - param_1[6];
  }
  iVar12 = param_1[4] + -1 + (param_1[0x12] - param_1[6]) + param_1[0x10];
  param_1[0x1b] = uVar1;
  param_1[0x1c] = uVar1;
  iVar18 = param_1[0xe];
  if (iVar12 <= param_1[0xe]) {
    iVar18 = iVar12;
  }
  param_1[0x1d] = iVar18;
  return (ulonglong)uVar1;
}



void FUN_180038940(int *param_1,ulonglong *param_2,longlong param_3)

{
  ulonglong uVar1;
  undefined8 local_18;
  undefined4 uStack16;
  undefined4 uStack12;

  uStack16 = *(undefined4 *)param_2;
  uStack12 = *(undefined4 *)((longlong)param_2 + 4);
  local_18 = 0;
  uVar1 = FUN_180038570(param_1,*param_2,(undefined *)&local_18);
  FUN_180037ef0(param_1,(longlong)(*(int *)(param_2 + 1) * (int)uVar1) + param_2[3],
                *(int *)(param_2 + 1),param_1[0x1d] - param_1[0x1b],*(longlong *)(param_3 + 0x18),
                *(int *)(param_3 + 8));
  return;
}



void FUN_180038af0(int *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int *piVar10;

  piVar10 = (int *)malloc(0x38);
  iVar1 = param_1[1];
  iVar3 = param_1[1];
  iVar4 = param_1[2];
  iVar5 = param_1[3];
  iVar2 = *param_1;
  iVar6 = param_1[4];
  iVar7 = param_1[5];
  iVar8 = param_1[6];
  iVar9 = param_1[7];
  piVar10[2] = *param_1;
  piVar10[3] = iVar3;
  piVar10[4] = iVar4;
  piVar10[5] = iVar5;
  piVar10[1] = param_2;
  *piVar10 = iVar1 + -1 + iVar2;
  piVar10[6] = iVar6;
  piVar10[7] = iVar7;
  piVar10[8] = iVar8;
  piVar10[9] = iVar9;
  piVar10[10] = 0;
  piVar10[0xb] = 0x10;
  piVar10[0xc] = 5;
  return;
}



void FUN_180038b50(int *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int *piVar10;

  piVar10 = (int *)malloc(0x30);
  iVar1 = param_1[1];
  iVar3 = param_1[1];
  iVar4 = param_1[2];
  iVar5 = param_1[3];
  iVar2 = *param_1;
  iVar6 = param_1[4];
  iVar7 = param_1[5];
  iVar8 = param_1[6];
  iVar9 = param_1[7];
  piVar10[2] = *param_1;
  piVar10[3] = iVar3;
  piVar10[4] = iVar4;
  piVar10[5] = iVar5;
  piVar10[1] = param_2;
  *piVar10 = iVar1 + -1 + iVar2;
  piVar10[6] = iVar6;
  piVar10[7] = iVar7;
  piVar10[8] = iVar8;
  piVar10[9] = iVar9;
  piVar10[10] = 5;
  return;
}



uint * FUN_180038ba0(uint param_1,uint param_2,undefined8 *param_3,undefined8 *param_4,
                    longlong param_5)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined8 uVar4;
  undefined auVar5 [12];
  undefined auVar6 [16];
  undefined8 uVar7;
  undefined auVar8 [12];
  int *piVar9;
  int *piVar10;
  uint *puVar11;
  void *pvVar12;
  int iVar13;
  uint uVar14;

  uVar14 = (int)param_1 >> 3 & 0x1ff;
  if ((int)param_5 < 0) {
    param_5._0_4_ = (*(int *)param_3 + *(int *)((longlong)param_3 + 4) + -1) / 2;
  }
  if (param_5 < 0) {
    param_5._4_4_ = (*(int *)((longlong)param_4 + 4) + *(int *)param_4 + -1) / 2;
  }
  uVar4 = *param_3;
  auVar5 = *(undefined (*) [12])param_3;
  auVar6 = *(undefined (*) [16])param_3;
  iVar13 = *(int *)(param_3 + 2);
  iVar1 = *(int *)((longlong)param_3 + 0x14);
  iVar2 = *(int *)(param_3 + 3);
  iVar3 = *(int *)((longlong)param_3 + 0x1c);
  piVar9 = (int *)malloc(0x30);
  *(undefined (*) [16])(piVar9 + 2) = auVar6;
  piVar9[1] = (int)param_5;
  piVar9[6] = iVar13;
  piVar9[7] = iVar1;
  piVar9[8] = iVar2;
  piVar9[9] = iVar3;
  piVar9[10] = 5;
  uVar7 = *param_4;
  auVar8 = *(undefined (*) [12])param_4;
  auVar6 = *(undefined (*) [16])param_4;
  iVar13 = *(int *)(param_4 + 2);
  iVar1 = *(int *)((longlong)param_4 + 0x14);
  iVar2 = *(int *)(param_4 + 3);
  iVar3 = *(int *)((longlong)param_4 + 0x1c);
  *piVar9 = (int)uVar4 + -1 + SUB124(auVar5 >> 0x20,0);
  piVar10 = (int *)malloc(0x38);
  *(undefined (*) [16])(piVar10 + 2) = auVar6;
  piVar10[1] = param_5._4_4_;
  piVar10[6] = iVar13;
  piVar10[7] = iVar1;
  piVar10[8] = iVar2;
  piVar10[9] = iVar3;
  piVar10[10] = 0;
  piVar10[0xb] = 0x10;
  *piVar10 = (int)uVar7 + -1 + SUB124(auVar8 >> 0x20,0);
  piVar10[0xc] = 5;
  puVar11 = (uint *)malloc(0xa0);
  puVar11[2] = uVar14 * 8 + 4;
  *puVar11 = param_1;
  puVar11[1] = param_2;
  *(int **)(puVar11 + 0x24) = piVar9;
  *(int **)(puVar11 + 0x26) = piVar10;
  puVar11[7] = 4;
  puVar11[8] = 4;
  param_5 = CONCAT44(*piVar10,*piVar9);
  *(longlong *)(puVar11 + 3) = param_5;
  param_5 = CONCAT44(piVar10[1],piVar9[1]);
  *(longlong *)(puVar11 + 5) = param_5;
  iVar13 = 1;
  if (3 < (param_1 & 7)) {
    iVar13 = 4;
  }
  uVar14 = (int)(uVar14 + 1 << ((byte)(0xfa50 >> (char)(param_1 & 7) * '\x02') & 3)) / iVar13;
  puVar11[9] = uVar14;
  iVar13 = 1;
  if (0 < (int)(puVar11[3] - 1)) {
    iVar13 = puVar11[3] - 1;
  }
  pvVar12 = malloc((longlong)iVar13 * (longlong)(int)uVar14 * 4);
  *(void **)(puVar11 + 10) = pvVar12;
  *(undefined8 *)(puVar11 + 0xd) = 0xffffffffffffffff;
  puVar11[0xc] = 0;
  puVar11[0x1a] = 0;
  return puVar11;
}



undefined4 * FUN_180038dd0(undefined4 *param_1,int param_2,int param_3)

{
  int iVar1;
  undefined *puVar2;
  int *piVar3;
  int iVar4;
  ulonglong uVar5;
  longlong lVar6;
  int *piVar7;
  uint uVar8;

  param_1[4] = param_3;
  if (param_2 < 100) {
    lVar6 = (longlong)param_2;
    puVar2 = &DAT_1800b07a0;
  }
  else {
    if (param_2 < 200) {
      lVar6 = (longlong)(param_2 + -100);
      puVar2 = &DAT_1800b0a60;
    }
    else {
      lVar6 = (longlong)(param_2 + -200);
      puVar2 = &DAT_1800b0560;
    }
  }
  piVar7 = (int *)(puVar2 + lVar6 * 0x40);
  *param_1 = 1;
  if (param_3 == 4) {
    iVar1 = *piVar7;
    param_1[1] = iVar1;
    piVar3 = (int *)malloc((longlong)(iVar1 * 4));
    iVar1 = param_1[1];
    iVar4 = 0;
    *(int **)(param_1 + 6) = piVar3;
    if (0 < iVar1) {
      do {
        piVar7 = piVar7 + 1;
        iVar4 = iVar4 + 1;
        *piVar3 = *piVar7;
        piVar3 = piVar3 + 1;
      } while (iVar4 < iVar1);
      return param_1;
    }
  }
  else {
    iVar1 = *piVar7;
    param_1[1] = iVar1;
    uVar8 = ((param_3 >> 3 & 0x1ffU) + 1 << ((byte)(0xfa50 >> ((byte)param_3 & 7) * '\x02') & 3)) *
            iVar1;
    puVar2 = (undefined *)malloc((longlong)(int)uVar8);
    piVar7 = piVar7 + 1;
    *(undefined **)(param_1 + 6) = puVar2;
    if ((((puVar2 != (undefined *)0x0) && (piVar7 != (int *)0x0)) && (uVar8 != 0)) &&
       (((uVar5 = (ulonglong)uVar8, (undefined *)((ulonglong)uVar8 + (longlong)piVar7) <= puVar2 ||
         (puVar2 + uVar8 <= piVar7)) && (uVar8 != 0)))) {
      piVar7 = (int *)((longlong)piVar7 - (longlong)puVar2);
      do {
        *puVar2 = *(undefined *)((longlong)piVar7 + (longlong)puVar2);
        puVar2 = puVar2 + 1;
        uVar5 = uVar5 - 1;
      } while (uVar5 != 0);
    }
  }
  return param_1;
}



undefined4 * FUN_180038f20(undefined4 *param_1,int param_2,int param_3,int param_4)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  int *piVar6;
  ulonglong uVar7;
  ushort uVar8;
  uint uVar9;
  int iVar10;
  ulonglong uVar11;
  uint *puVar12;
  int *piVar13;
  uint local_78 [4];
  uint local_68 [4];
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;

  param_1[4] = param_2;
  param_1[1] = param_3;
  *param_1 = 1;
  iVar10 = 0;
  piVar6 = (int *)malloc((longlong)
                         (int)(((param_2 >> 3 & 0x1ffU) + 1 <<
                               ((byte)(0xfa50 >> ((byte)param_2 & 7) * '\x02') & 3)) * param_3));
  *(int **)(param_1 + 6) = piVar6;
  if (param_4 == 0) {
    iVar2 = 0xb1721;
  }
  else {
    iVar2 = SUB164((SEXT816(0x1000000000000) & (undefined  [16])0xffffffffffffffff |
                   ZEXT816(0x1000000000000)) / SEXT816((longlong)param_4 * (longlong)param_4 * 2),0)
    ;
  }
  uVar1 = param_1[1];
  uVar7 = (ulonglong)uVar1;
  if (0 < (int)uVar1) {
    uVar11 = (ulonglong)uVar1;
    iVar3 = -((param_3 + -1) / 2);
    piVar13 = piVar6;
    do {
      uVar4 = -(iVar3 * iVar3 * iVar2);
      uVar9 = (int)uVar4 >> 0x1f;
      uVar9 = (uVar4 ^ uVar9) - uVar9;
      if (uVar9 < 0xb1721) {
        local_78[0] = 0x58b90;
        puVar12 = local_78;
        local_78[1] = 0x2c5c8;
        uVar4 = 0x10000;
        local_78[2] = 0x162e4;
        uVar8 = 0;
        local_78[3] = 0xb172;
        local_68[0] = 0x67cd;
        local_68[1] = 0x3920;
        local_68[2] = 0x1e27;
        local_68[3] = 0xf85;
        local_58 = 0x7e1;
        local_54 = 0x3f8;
        local_50 = 0x1fe;
        local_4c = 0x100;
        local_48 = 0x80;
        local_44 = 0x40;
        local_40 = 0x20;
        local_3c = 0x10;
        local_38 = 8;
        local_34 = 4;
        local_30 = 2;
        local_2c = 1;
        do {
          if (*puVar12 < uVar9) {
            uVar9 = uVar9 - *puVar12;
            uVar4 = uVar4 << ((byte)(1 << (3U - (char)uVar8 & 0x1f)) & 0x1f);
          }
          uVar8 = uVar8 + 1;
          puVar12 = puVar12 + 1;
        } while (uVar8 < 4);
        uVar8 = 0;
        puVar12 = local_68;
        do {
          if (*puVar12 < uVar9) {
            uVar9 = uVar9 - *puVar12;
            uVar4 = uVar4 + (uVar4 >> ((char)uVar8 + 1U & 0x1f));
          }
          uVar8 = uVar8 + 1;
          puVar12 = puVar12 + 1;
        } while (uVar8 < 0x10);
        iVar5 = SUB164((ZEXT816(0) << 0x40 | ZEXT816(0x100000000)) / ZEXT416(uVar4),0);
      }
      else {
        iVar5 = 0;
      }
      *piVar13 = iVar5;
      iVar10 = iVar10 + iVar5;
      piVar13 = piVar13 + 1;
      iVar3 = iVar3 + 1;
      uVar11 = uVar11 - 1;
    } while (uVar11 != 0);
  }
  if ((iVar10 != 0) && (0 < (int)uVar1)) {
    do {
      *piVar6 = (int)(((longlong)*piVar6 * 0x10000 + ((longlong)iVar10 >> 1)) / (longlong)iVar10);
      uVar7 = uVar7 - 1;
      piVar6 = piVar6 + 1;
    } while (uVar7 != 0);
  }
  return param_1;
}



// WARNING: Could not reconcile some variable overlaps

uint * FUN_1800391b0(uint param_1,uint param_2,undefined8 param_3,int param_4,int param_5,
                    int param_6)

{
  undefined8 *puVar1;
  undefined *puVar2;
  int *piVar3;
  undefined *puVar4;
  int *piVar5;
  uint *puVar6;
  void *pvVar7;
  uint uVar8;
  ulonglong uVar9;
  int iVar10;
  uint uVar11;
  uint uVar12;
  int iStackX28;
  undefined8 local_b8;
  int iStack176;
  int iStack172;
  int local_a8;
  int iStack164;
  int iStack160;
  int iStack156;
  int local_98;
  int iStack148;
  int iStack144;
  int iStack140;
  int local_88;
  int iStack132;
  int iStack128;
  int iStack124;
  int local_78;
  int iStack116;
  undefined8 local_70;
  undefined4 local_68 [10];

  uVar12 = param_1 & 7;
  if (param_4 < 0) {
    uVar11 = uVar12;
    if (uVar12 < 4) {
      uVar11 = 4;
    }
    piVar3 = FUN_180038f20(&local_88,uVar11,(int)param_3,param_5);
    iStackX28 = (int)((ulonglong)param_3 >> 0x20);
    local_98 = *piVar3;
    iStack148 = piVar3[1];
    iStack144 = piVar3[2];
    iStack140 = piVar3[3];
    local_a8 = piVar3[4];
    iStack164 = piVar3[5];
    puVar1 = (undefined8 *)(piVar3 + 6);
    iStack160 = *(int *)puVar1;
    iStack156 = piVar3[7];
    puVar2 = (undefined *)*puVar1;
    local_70 = (undefined *)*puVar1;
    if (((int)param_3 == iStackX28) &&
       (uVar8 = param_5 - param_6 >> 0x1f, (int)((param_5 - param_6 ^ uVar8) - uVar8) < 0x28f)) {
      iVar10 = (local_a8 >> 3 & 0x1ffU) + 1 << ((byte)(0xfa50 >> ((byte)local_a8 & 7) * '\x02') & 3)
      ;
      local_78 = local_a8;
      iStack116 = iStack164;
      local_70 = (undefined *)malloc((longlong)(iStack148 * iVar10 * local_98));
      uVar11 = iVar10 * iStack148 * local_98;
      uVar9 = (ulonglong)uVar11;
      iStack176 = iStack144;
      iStack172 = iStack140;
      local_b8._0_4_ = local_98;
      local_b8._4_4_ = iStack148;
      if ((((local_70 != (undefined *)0x0) && (puVar2 != (undefined *)0x0)) && (uVar11 != 0)) &&
         (((puVar2 + uVar9 <= local_70 || (local_70 + uVar9 <= puVar2)) && (uVar11 != 0)))) {
        puVar4 = local_70;
        do {
          *puVar4 = puVar4[(longlong)(puVar2 + -(longlong)local_70)];
          puVar4 = puVar4 + 1;
          uVar9 = uVar9 - 1;
        } while (uVar9 != 0);
      }
    }
    else {
      piVar3 = FUN_180038f20(local_68,uVar11,iStackX28,param_6);
      local_88 = *piVar3;
      iStack132 = piVar3[1];
      iStack128 = piVar3[2];
      iStack124 = piVar3[3];
      local_78 = piVar3[4];
      iStack116 = piVar3[5];
      local_70 = *(undefined **)(piVar3 + 6);
      iStack176 = iStack128;
      iStack172 = iStack124;
      local_b8._0_4_ = local_88;
      local_b8._4_4_ = iStack132;
    }
  }
  else {
    uVar11 = uVar12;
    if (uVar12 < 4) {
      uVar11 = 4;
    }
    piVar3 = FUN_180038dd0(&local_88,param_4,uVar11);
    local_98 = *piVar3;
    iStack148 = piVar3[1];
    iStack176 = piVar3[2];
    iStack172 = piVar3[3];
    local_a8 = piVar3[4];
    iStack164 = piVar3[5];
    puVar1 = (undefined8 *)(piVar3 + 6);
    iStack160 = *(int *)puVar1;
    iStack156 = piVar3[7];
    puVar2 = (undefined *)*puVar1;
    local_70 = (undefined *)*puVar1;
    iVar10 = (local_a8 >> 3 & 0x1ffU) + 1 << ((byte)(0xfa50 >> ((byte)local_a8 & 7) * '\x02') & 3);
    local_78 = local_a8;
    iStack116 = iStack164;
    local_70 = (undefined *)malloc((longlong)(iStack148 * iVar10 * local_98));
    uVar11 = iVar10 * iStack148 * local_98;
    uVar9 = (ulonglong)uVar11;
    iStack144 = iStack176;
    iStack140 = iStack172;
    local_b8._0_4_ = local_98;
    local_b8._4_4_ = iStack148;
    if (((local_70 != (undefined *)0x0) && (puVar2 != (undefined *)0x0)) &&
       ((uVar11 != 0 &&
        (((puVar2 + uVar9 <= local_70 || (local_70 + uVar9 <= puVar2)) && (uVar11 != 0)))))) {
      puVar4 = local_70;
      do {
        *puVar4 = puVar4[(longlong)(puVar2 + -(longlong)local_70)];
        puVar4 = puVar4 + 1;
        uVar9 = uVar9 - 1;
      } while (uVar9 != 0);
    }
  }
  uVar11 = (int)param_1 >> 3 & 0x1ff;
  piVar3 = (int *)malloc(0x30);
  piVar3[1] = (local_98 + -1 + iStack148) / 2;
  *(undefined (*) [16])(piVar3 + 2) =
       CONCAT412(iStack140,CONCAT48(iStack144,CONCAT44(iStack148,local_98)));
  piVar3[10] = 5;
  piVar3[6] = local_a8;
  piVar3[7] = iStack164;
  piVar3[8] = iStack160;
  piVar3[9] = iStack156;
  *piVar3 = local_98 + -1 + iStack148;
  piVar5 = (int *)malloc(0x38);
  piVar5[1] = (local_b8._4_4_ + (int)local_b8 + -1) / 2;
  *piVar5 = local_b8._4_4_ + -1 + (int)local_b8;
  piVar5[2] = (int)local_b8;
  piVar5[3] = local_b8._4_4_;
  piVar5[4] = iStack176;
  piVar5[5] = iStack172;
  piVar5[10] = 0;
  piVar5[6] = local_78;
  piVar5[7] = iStack116;
  piVar5[8] = (int)local_70;
  piVar5[9] = local_70._4_4_;
  piVar5[0xb] = 0x10;
  piVar5[0xc] = 5;
  puVar6 = (uint *)malloc(0xa0);
  *puVar6 = param_1;
  puVar6[2] = uVar11 * 8 + 4;
  puVar6[1] = param_2;
  *(int **)(puVar6 + 0x24) = piVar3;
  *(int **)(puVar6 + 0x26) = piVar5;
  puVar6[7] = 4;
  puVar6[8] = 4;
  local_b8 = CONCAT44(*piVar5,*piVar3);
  *(undefined8 *)(puVar6 + 3) = local_b8;
  local_b8 = CONCAT44(piVar5[1],piVar3[1]);
  *(undefined8 *)(puVar6 + 5) = local_b8;
  iVar10 = 1;
  if (3 < uVar12) {
    iVar10 = 4;
  }
  uVar12 = (int)(uVar11 + 1 << ((byte)(0xfa50 >> (char)uVar12 * '\x02') & 3)) / iVar10;
  puVar6[9] = uVar12;
  iVar10 = 1;
  if (0 < (int)(puVar6[3] - 1)) {
    iVar10 = puVar6[3] - 1;
  }
  pvVar7 = malloc((longlong)iVar10 * (longlong)(int)uVar12 * 4);
  *(void **)(puVar6 + 10) = pvVar7;
  *(undefined8 *)(puVar6 + 0xd) = 0xffffffffffffffff;
  puVar6[0xc] = 0;
  puVar6[0x1a] = 0;
  return puVar6;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_1800395b0(ulonglong *param_1,int *param_2,undefined8 param_3,int param_4,int param_5,
                  int param_6)

{
  int *piVar1;
  uint *_Memory;
  ulonglong uVar2;
  uint uVar3;
  undefined8 local_58;
  undefined4 uStack80;
  undefined4 uStack76;
  int *local_48;
  undefined4 local_40;
  undefined4 local_3c;
  ulonglong local_38;

  local_38 = DAT_1800b04e8 ^ (ulonglong)&stack0xffffffffffffff78;
  local_58 = param_3;
  local_48 = param_2;
  if ((((param_1[3] != 0) && (*(longlong *)(param_2 + 6) != 0)) && (*(int *)(param_1 + 2) == 2)) &&
     (param_2[4] == 2)) {
    if ((param_2[1] != *(int *)((longlong)param_1 + 4)) || (*param_2 != *(int *)param_1)) {
      FUN_1800230e0((int *)param_1,&local_48);
    }
    piVar1 = local_48;
    if ((((0 < (int)local_58) && (0 < local_58._4_4_)) || (-1 < param_4)) &&
       (((int)local_58 != 1 || (local_58._4_4_ != 1)))) {
      *(undefined4 *)(param_1 + 2) = 0x42ff0002;
      local_48[4] = 0x42ff0002;
      *(uint *)(param_1 + 1) =
           ((*(int *)(param_1 + 2) >> 3 & 0x1ffU) + 1 <<
           ((byte)(0xfa50 >> ((byte)*(int *)(param_1 + 2) & 7) * '\x02') & 3)) * *(int *)param_1;
      *local_48 = *(int *)param_1;
      local_48[1] = *(int *)((longlong)param_1 + 4);
      local_48[2] = ((local_48[4] >> 3 & 0x1ffU) + 1 <<
                    ((byte)(0xfa50 >> ((byte)local_48[4] & 7) * '\x02') & 3)) * *local_48;
      if (*(int *)((longlong)param_1 + 4) == 1) {
        local_58._4_4_ = 1;
      }
      if (*(int *)param_1 == 1) {
        local_58._0_4_ = 1;
      }
      _Memory = FUN_1800391b0(*(uint *)(param_1 + 2) & 0xfff,local_48[4] & 0xfff,local_58,param_4,
                              param_5,param_6);
      uVar3 = _Memory[4] & 0x80000001;
      if ((int)uVar3 < 0) {
        uVar3 = (uVar3 - 1 | 0xfffffffe) + 1;
      }
      if (uVar3 == 1) {
        uVar3 = _Memory[3] & 0x80000001;
        if ((int)uVar3 < 0) {
          uVar3 = (uVar3 - 1 | 0xfffffffe) + 1;
        }
        if (uVar3 == 1) {
          *(bool *)(_Memory + 0x22) = (param_4 - 6U & 0xfffffffd) == 0;
          uStack80 = *(undefined4 *)param_1;
          uStack76 = *(undefined4 *)((longlong)param_1 + 4);
          local_48 = (int *)*param_1;
          local_58 = 0;
          local_40 = uStack80;
          local_3c = uStack76;
          uVar2 = FUN_180038570((int *)_Memory,local_48,(undefined *)&local_58);
          FUN_180037ef0((int *)_Memory,(longlong)(*(int *)(param_1 + 1) * (int)uVar2) + param_1[3],
                        *(int *)(param_1 + 1),_Memory[0x1d] - _Memory[0x1b],
                        *(longlong *)(piVar1 + 6),piVar1[2]);
          piVar1[4] = 2;
          *(undefined4 *)(param_1 + 2) = 2;
          free(*(void **)(*(longlong *)(_Memory + 0x24) + 0x20));
          free(*(void **)(*(longlong *)(_Memory + 0x26) + 0x20));
          free(*(void **)(_Memory + 0x24));
          free(*(void **)(_Memory + 0x26));
          free(*(void **)(_Memory + 10));
          free(*(void **)(_Memory + 0x14));
          free(*(void **)(_Memory + 0x16));
          free(*(void **)(_Memory + 0x18));
          free(_Memory);
          goto LAB_180039856;
        }
      }
    }
    FUN_1800230e0((int *)param_1,&local_48);
  }
LAB_180039856:
  FUN_18005f100(local_38 ^ (ulonglong)&stack0xffffffffffffff78);
  return;
}



void FUN_180039870(uint *param_1,int *param_2,int param_3,uint param_4)

{
  int *piVar1;
  short sVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  longlong lVar6;
  longlong lVar7;
  int *piVar8;
  int *piVar9;
  int *piVar10;
  undefined *puVar11;
  undefined *puVar12;
  int *piVar13;
  int iVar14;
  short *psVar15;
  short *psVar16;
  short *psVar17;
  ulonglong uVar18;
  longlong lVar19;
  undefined *puVar20;
  int *piVar21;
  longlong lVar22;
  uint uVar23;
  longlong lVar24;
  ulonglong uVar25;
  longlong lVar26;
  longlong lVar27;
  undefined *puVar28;
  longlong lVar29;
  short *psVar30;
  undefined *puVar31;
  uint uVar32;
  short *local_d0;
  ulonglong local_60;

  psVar30 = *(short **)(param_1 + 6);
  lVar27 = (longlong)param_3;
  if ((((psVar30 != (short *)0x0) && (lVar6 = *(longlong *)(param_2 + 6), lVar6 != 0)) &&
      (param_1[4] == 2)) && (param_2[4] == 4)) {
    iVar3 = param_2[1];
    uVar23 = param_1[1];
    if (uVar23 == (iVar3 + param_4 * -2) - 1) {
      uVar4 = *param_1;
      lVar26 = (longlong)(int)uVar4;
      iVar5 = *param_2;
      lVar22 = (longlong)iVar5;
      if (uVar4 == (iVar5 + param_3 * -2) - 1U) {
        uVar32 = iVar5 * 4;
        lVar7 = lVar6 + (longlong)(int)(iVar5 * param_4) * 4;
        psVar17 = psVar30 + lVar26;
        lVar29 = lVar22 * 4;
        piVar8 = (int *)(lVar29 + lVar7);
        psVar16 = psVar30 + (int)(uVar4 * 2);
        local_d0 = psVar30 + (int)(uVar4 * 3);
        piVar13 = (int *)(lVar7 + (longlong)(iVar5 * 2) * 4);
        piVar21 = (int *)(lVar7 + (longlong)(iVar5 * 3) * 4);
        piVar9 = (int *)(lVar7 + (longlong)(int)uVar32 * 4);
        iVar14 = (uVar23 & 0xfffffffc) + 1;
        if (1 < iVar14) {
          lVar24 = lVar22 - lVar27;
          lVar7 = (longlong)((iVar5 - param_3) + -1);
          local_60 = (ulonglong)(((uVar23 & 0xfffffffc) - 1 >> 2) + 1);
          do {
            if (0 < lVar27) {
              piVar10 = piVar13;
              lVar19 = lVar27;
              psVar15 = psVar17 + lVar27;
              do {
                *(int *)((longlong)((longlong)piVar10 + 4) +
                        (longlong)(int *)((longlong)piVar8 - (longlong)piVar13)) =
                     (int)*(short *)((longlong)psVar15 +
                                    (longlong)((longlong)psVar30 - (longlong)psVar17)) +
                     *(int *)((longlong)piVar10 +
                             (longlong)(int *)((longlong)piVar8 - (longlong)piVar13));
                piVar1 = piVar10 + 1;
                *piVar1 = (int)*psVar15 + *piVar10;
                *(int *)((longlong)piVar1 + (longlong)(int *)((longlong)piVar21 - (longlong)piVar13)
                        ) = (int)*(short *)((longlong)psVar15 +
                                           (longlong)((longlong)psVar16 - (longlong)psVar17)) +
                            *(int *)((longlong)piVar10 +
                                    (longlong)(int *)((longlong)piVar21 - (longlong)piVar13));
                *(int *)((longlong)piVar1 + (longlong)(int *)((longlong)piVar9 - (longlong)piVar13))
                     = (int)*(short *)((longlong)psVar15 +
                                      (longlong)((longlong)local_d0 - (longlong)psVar17)) +
                       *(int *)((longlong)piVar10 +
                               (longlong)(int *)((longlong)piVar9 - (longlong)piVar13));
                lVar19 = lVar19 + -1;
                piVar10 = piVar1;
                psVar15 = psVar15 + -1;
              } while (lVar19 != 0);
            }
            if (lVar27 + 1 <= lVar7) {
              lVar19 = lVar7 - lVar27;
              piVar10 = piVar13 + lVar27;
              psVar15 = psVar17;
              do {
                *(int *)((longlong)((longlong)piVar10 + 4) +
                        (longlong)(int *)((longlong)piVar8 - (longlong)piVar13)) =
                     (int)*(short *)((longlong)psVar15 +
                                    (longlong)((longlong)psVar30 - (longlong)psVar17)) +
                     *(int *)((longlong)piVar10 +
                             (longlong)(int *)((longlong)piVar8 - (longlong)piVar13));
                piVar1 = piVar10 + 1;
                *piVar1 = (int)*psVar15 + *piVar10;
                *(int *)((longlong)piVar1 + (longlong)(int *)((longlong)piVar21 - (longlong)piVar13)
                        ) = (int)*(short *)((longlong)psVar15 +
                                           (longlong)((longlong)psVar16 - (longlong)psVar17)) +
                            *(int *)((longlong)piVar10 +
                                    (longlong)(int *)((longlong)piVar21 - (longlong)piVar13));
                *(int *)((longlong)piVar1 + (longlong)(int *)((longlong)piVar9 - (longlong)piVar13))
                     = (int)*(short *)((longlong)psVar15 +
                                      (longlong)((longlong)local_d0 - (longlong)psVar17)) +
                       *(int *)((longlong)piVar10 +
                               (longlong)(int *)((longlong)piVar9 - (longlong)piVar13));
                lVar19 = lVar19 + -1;
                piVar10 = piVar1;
                psVar15 = psVar15 + 1;
              } while (lVar19 != 0);
            }
            if (lVar24 < lVar22) {
              piVar10 = piVar13 + lVar24 + -1;
              psVar15 = psVar17 + lVar26 + -2;
              lVar19 = lVar24;
              do {
                lVar19 = lVar19 + 1;
                *(int *)((longlong)((longlong)piVar10 + 4) +
                        (longlong)(int *)((longlong)piVar8 - (longlong)piVar13)) =
                     (int)*(short *)((longlong)psVar15 +
                                    (longlong)((longlong)psVar30 - (longlong)psVar17)) +
                     *(int *)((longlong)piVar10 +
                             (longlong)(int *)((longlong)piVar8 - (longlong)piVar13));
                piVar1 = piVar10 + 1;
                *piVar1 = (int)*psVar15 + *piVar10;
                *(int *)((longlong)piVar1 + (longlong)(int *)((longlong)piVar21 - (longlong)piVar13)
                        ) = (int)*(short *)((longlong)psVar15 +
                                           (longlong)((longlong)psVar16 - (longlong)psVar17)) +
                            *(int *)((longlong)piVar10 +
                                    (longlong)(int *)((longlong)piVar21 - (longlong)piVar13));
                *(int *)((longlong)piVar1 + (longlong)(int *)((longlong)piVar9 - (longlong)piVar13))
                     = (int)*(short *)((longlong)psVar15 +
                                      (longlong)((longlong)local_d0 - (longlong)psVar17)) +
                       *(int *)((longlong)piVar10 +
                               (longlong)(int *)((longlong)piVar9 - (longlong)piVar13));
                piVar10 = piVar1;
                psVar15 = psVar15 + -1;
              } while (lVar19 < lVar22);
            }
            piVar8 = piVar9 + lVar22;
            piVar13 = piVar8 + lVar22;
            psVar30 = local_d0 + lVar26;
            local_60 = local_60 - 1;
            piVar21 = piVar13 + lVar22;
            psVar17 = psVar30 + lVar26;
            psVar16 = psVar17 + lVar26;
            local_d0 = psVar16 + lVar26;
            piVar9 = piVar21 + lVar22;
          } while (local_60 != 0);
        }
        if (iVar14 < (int)(uVar23 + 1)) {
          uVar25 = (ulonglong)((uVar23 + 1) - iVar14);
          do {
            lVar24 = 1;
            psVar17 = psVar30;
            lVar7 = lVar27;
            if (0 < lVar27) {
              psVar16 = psVar30 + lVar27;
              do {
                sVar2 = *psVar16;
                psVar16 = psVar16 + -1;
                piVar8[lVar24] = (int)sVar2 + piVar8[lVar24 + -1];
                lVar24 = lVar24 + 1;
              } while (lVar24 <= lVar27);
            }
            while (lVar24 = lVar7 + 1, lVar24 <= (iVar5 - param_3) + -1) {
              piVar8[lVar24] = (int)*psVar17 + piVar8[lVar7];
              psVar17 = psVar17 + 1;
              lVar7 = lVar24;
            }
            if (lVar22 - lVar27 < lVar22) {
              psVar17 = psVar30 + lVar26 + -2;
              lVar7 = lVar22 - lVar27;
              do {
                sVar2 = *psVar17;
                psVar17 = psVar17 + -1;
                piVar8[lVar7] = (int)sVar2 + piVar8[lVar7 + -1];
                lVar7 = lVar7 + 1;
              } while (lVar7 < lVar22);
            }
            psVar30 = psVar30 + lVar26;
            piVar8 = piVar8 + lVar22;
            uVar25 = uVar25 - 1;
          } while (uVar25 != 0);
        }
        puVar28 = (undefined *)(lVar29 + lVar6);
        lVar27 = (longlong)((iVar3 + -1) * iVar5);
        puVar31 = (undefined *)(lVar6 + lVar27 * 4);
        if (0 < (int)param_4) {
          uVar25 = (ulonglong)param_4;
          lVar26 = (lVar6 + (longlong)(int)((iVar3 + param_4 * -2 + -1) * iVar5) * 4) -
                   (longlong)puVar28;
          puVar20 = puVar31 + ((int)((param_4 * 2 + 1) * iVar5) - lVar27) * 4;
          do {
            if ((((puVar28 != (undefined *)0x0) && (puVar20 != (undefined *)0x0)) &&
                ((uVar32 != 0 &&
                 ((uVar18 = (ulonglong)uVar32, puVar20 + uVar18 <= puVar28 ||
                  (puVar28 + uVar18 <= puVar20)))))) && (uVar32 != 0)) {
              puVar11 = puVar28;
              do {
                *puVar11 = (puVar20 + -(longlong)puVar28)[(longlong)puVar11];
                puVar11 = puVar11 + 1;
                uVar18 = uVar18 - 1;
              } while (uVar18 != 0);
            }
            if (((((puVar31 != (undefined *)0x0) &&
                  (puVar11 = puVar28 + lVar26, puVar11 != (undefined *)0x0)) && (uVar32 != 0)) &&
                ((uVar18 = (ulonglong)uVar32, puVar11 + uVar18 <= puVar31 ||
                 (puVar31 + uVar18 <= puVar11)))) && (uVar32 != 0)) {
              puVar12 = puVar31;
              do {
                *puVar12 = puVar12[(longlong)(puVar11 + -(longlong)puVar31)];
                puVar12 = puVar12 + 1;
                uVar18 = uVar18 - 1;
              } while (uVar18 != 0);
            }
            puVar28 = puVar28 + lVar29;
            puVar31 = puVar31 + lVar22 * -4;
            puVar20 = puVar20 + lVar22 * -4;
            uVar25 = uVar25 - 1;
          } while (uVar25 != 0);
        }
        uVar23 = iVar5 - 1U & 0xfffffffc;
        iVar14 = uVar23 + 1;
        if (1 < iVar14) {
          lVar29 = lVar29 + 4;
          uVar25 = (ulonglong)((uVar23 - 1 >> 2) + 1);
          do {
            piVar8 = (int *)(lVar6 + 8 + lVar29);
            if (1 < iVar3) {
              uVar18 = (ulonglong)(iVar3 - 1);
              lVar27 = lVar29 - (longlong)piVar8;
              do {
                piVar13 = (int *)(lVar27 + lVar6 + (longlong)piVar8);
                *piVar13 = *piVar13 + piVar13[-lVar22];
                piVar8[-1] = piVar8[-1] + piVar8[-1 - lVar22];
                *piVar8 = *piVar8 + piVar8[-lVar22];
                piVar8[1] = piVar8[1] + piVar8[1 - lVar22];
                piVar8 = piVar8 + lVar22;
                uVar18 = uVar18 - 1;
              } while (uVar18 != 0);
            }
            lVar29 = lVar29 + 0x10;
            uVar25 = uVar25 - 1;
          } while (uVar25 != 0);
        }
        if (iVar14 < iVar5) {
          uVar25 = (ulonglong)(uint)(iVar5 - iVar14);
          piVar8 = (int *)(lVar6 + (iVar14 + lVar22) * 4);
          do {
            if (1 < iVar3) {
              uVar18 = (ulonglong)(iVar3 - 1);
              piVar13 = piVar8;
              do {
                *piVar13 = *piVar13 + piVar13[-lVar22];
                piVar13 = piVar13 + lVar22;
                uVar18 = uVar18 - 1;
              } while (uVar18 != 0);
            }
            piVar8 = piVar8 + 1;
            uVar25 = uVar25 - 1;
          } while (uVar25 != 0);
        }
      }
    }
  }
  return;
}



void FUN_180039f70(uint *param_1,uint *param_2)

{
  uint *puVar1;
  uint *puVar2;
  uint *puVar3;
  longlong lVar4;
  uint *puVar5;
  int *_Memory;
  uint *puVar6;
  uint uVar7;
  ulonglong uVar8;
  longlong lVar9;
  undefined2 *puVar10;
  int iVar11;
  int iVar12;
  undefined *puVar13;
  int iVar14;
  undefined auStack104 [32];
  uint *local_48;
  ulonglong local_40;

  local_40 = DAT_1800b04e8 ^ (ulonglong)auStack104;
  local_48 = param_2;
  if ((((*(longlong *)(param_1 + 6) != 0) && (*(longlong *)(param_2 + 6) != 0)) && (param_1[4] == 2)
      ) && (param_2[4] == 2)) {
    if ((param_2[1] != param_1[1]) || (*param_2 != *param_1)) {
      FUN_1800230e0((int *)param_1,(int **)&local_48);
    }
    puVar5 = local_48;
    uVar7 = param_1[1];
    iVar11 = *param_1 + 0xf;
    _Memory = FUN_180022ff0(iVar11,uVar7 + 0xf,4);
    puVar13 = *(undefined **)(_Memory + 6);
    if ((puVar13 != (undefined *)0x0) &&
       (uVar7 = iVar11 * (uVar7 + 0xf) * 4, uVar8 = (ulonglong)uVar7, uVar7 != 0)) {
      while (uVar8 != 0) {
        uVar8 = uVar8 - 1;
        *puVar13 = 0;
        puVar13 = puVar13 + 1;
      }
    }
    FUN_180039870(param_1,_Memory,7,7);
    local_48 = *(uint **)(_Memory + 6);
    iVar14 = 0;
    lVar4 = *(longlong *)(puVar5 + 6);
    if (0 < (int)param_1[1]) {
      uVar7 = *param_1;
      do {
        iVar12 = 0;
        if (0 < (int)uVar7) {
          lVar9 = (longlong)(iVar11 * 8) - (longlong)(iVar11 * -7);
          puVar6 = local_48 +
                   (longlong)(iVar11 * -7) + 0xf +
                   (longlong)(*_Memory * iVar14) + (longlong)(iVar11 * 7);
          puVar10 = (undefined2 *)(lVar4 + (longlong)(int)(*puVar5 * iVar14) * 2);
          do {
            puVar2 = puVar6 + lVar9;
            iVar12 = iVar12 + 1;
            puVar3 = puVar6 + lVar9 + -0xf;
            puVar1 = puVar6 + -0xf;
            uVar7 = *puVar6;
            puVar6 = puVar6 + 1;
            *puVar10 = (short)((((*puVar2 - *puVar3) + *puVar1) - uVar7) * 0x123 >> 0x10);
            uVar7 = *param_1;
            puVar10 = puVar10 + 1;
          } while (iVar12 < (int)uVar7);
        }
        iVar14 = iVar14 + 1;
      } while (iVar14 < (int)param_1[1]);
    }
    free(_Memory);
  }
  FUN_18005f100(local_40 ^ (ulonglong)auStack104);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

ulonglong FUN_18003a130(ulonglong param_1,ulonglong param_2,int param_3)

{
  undefined (*pauVar1) [16];
  int iVar2;
  undefined auVar3 [16];
  uint uVar4;
  void *_Memory;
  void *pvVar5;
  uint *puVar6;
  uint *puVar7;
  undefined (*pauVar8) [16];
  byte bVar9;
  longlong lVar10;
  int *piVar11;
  uint uVar12;
  ulonglong uVar13;
  void *pvVar14;
  uint uVar15;
  uint uVar16;
  longlong lVar17;
  longlong lVar18;
  uint uVar19;
  undefined *puVar20;
  longlong lVar21;
  longlong lVar22;
  undefined auVar23 [16];
  undefined auVar24 [16];
  longlong local_38;

  lVar22 = 0;
  local_38 = 0;
  _Memory = malloc(0x3000);
  pvVar5 = malloc(0x4000);
  puVar6 = (uint *)malloc(0x3000);
  puVar7 = (uint *)malloc(0x4000);
  iVar2 = DAT_1800b04f8;
  auVar3 = _DAT_1800a4440;
  uVar13 = 0;
  lVar21 = 0xc00;
  if ((1 < DAT_1800b04f8) &&
     (((void *)(param_1 + 0x2ffc) < _Memory || ((longlong)_Memory + 0x2ffcU < param_1)))) {
    lVar17 = 0xc0;
    lVar10 = param_1 - (longlong)_Memory;
    uVar13 = 0xc00;
    pauVar8 = (undefined (*) [16])((longlong)_Memory + 0x10);
    do {
      auVar24 = *(undefined (*) [16])(lVar10 + (longlong)pauVar8);
      pauVar1 = pauVar8[4];
      auVar23 = pmulld(*(undefined (*) [16])(lVar10 + -0x10 + (longlong)pauVar8),auVar3);
      pauVar8[-1] = auVar23;
      auVar23 = *(undefined (*) [16])(lVar10 + -0x30 + (longlong)pauVar1);
      auVar24 = pmulld(auVar24,auVar3);
      *pauVar8 = auVar24;
      auVar24 = *(undefined (*) [16])(lVar10 + -0x20 + (longlong)pauVar1);
      auVar23 = pmulld(auVar23,auVar3);
      pauVar8[1] = auVar23;
      auVar24 = pmulld(auVar24,auVar3);
      pauVar8[2] = auVar24;
      lVar17 = lVar17 + -1;
      pauVar8 = pauVar1;
    } while (lVar17 != 0);
  }
  if (uVar13 < 0xc00) {
    lVar10 = 0xc00 - uVar13;
    piVar11 = (int *)((longlong)_Memory + uVar13 * 4);
    do {
      *piVar11 = *(int *)((longlong)piVar11 + (param_1 - (longlong)_Memory)) * 10000;
      lVar10 = lVar10 + -1;
      piVar11 = piVar11 + 1;
    } while (lVar10 != 0);
  }
  auVar3 = _DAT_1800a4440;
  uVar13 = 0;
  lVar10 = 0x1000;
  if ((1 < iVar2) &&
     (((void *)(param_2 + 0x3ffc) < pvVar5 || ((longlong)pvVar5 + 0x3ffcU < param_2)))) {
    uVar13 = 0x1000;
    lVar17 = param_2 - (longlong)pvVar5;
    lVar18 = 0x100;
    pauVar8 = (undefined (*) [16])((longlong)pvVar5 + 0x10);
    do {
      auVar24 = *(undefined (*) [16])(lVar17 + (longlong)pauVar8);
      pauVar1 = pauVar8[4];
      auVar23 = pmulld(*(undefined (*) [16])(lVar17 + -0x10 + (longlong)pauVar8),auVar3);
      pauVar8[-1] = auVar23;
      auVar23 = *(undefined (*) [16])(lVar17 + -0x30 + (longlong)pauVar1);
      auVar24 = pmulld(auVar24,auVar3);
      *pauVar8 = auVar24;
      auVar24 = *(undefined (*) [16])(lVar17 + -0x20 + (longlong)pauVar1);
      auVar23 = pmulld(auVar23,auVar3);
      pauVar8[1] = auVar23;
      auVar24 = pmulld(auVar24,auVar3);
      pauVar8[2] = auVar24;
      lVar18 = lVar18 + -1;
      pauVar8 = pauVar1;
    } while (lVar18 != 0);
  }
  if (uVar13 < 0x1000) {
    lVar17 = 0x1000 - uVar13;
    piVar11 = (int *)((longlong)pvVar5 + uVar13 * 4);
    do {
      *piVar11 = *(int *)((longlong)piVar11 + (param_2 - (longlong)pvVar5)) * 10000;
      lVar17 = lVar17 + -1;
      piVar11 = piVar11 + 1;
    } while (lVar17 != 0);
  }
  pvVar14 = (void *)((longlong)_Memory - (longlong)puVar6);
  if (param_3 < 0x51) {
    lVar17 = -(longlong)puVar6;
    do {
      uVar19 = *(uint *)((longlong)pvVar14 + (longlong)puVar6);
      uVar16 = 0;
      bVar9 = 0xf;
      uVar15 = 0x8000;
      uVar12 = uVar19;
      if (1 < uVar19) {
        do {
          uVar4 = uVar15 + uVar16 * 2 << (bVar9 & 0x1f);
          bVar9 = bVar9 - 1;
          uVar19 = uVar16;
          if (uVar4 <= uVar12) {
            uVar19 = uVar16 + uVar15;
            uVar12 = uVar12 - uVar4;
          }
          uVar15 = uVar15 >> 1;
          uVar16 = uVar19;
        } while (uVar15 != 0);
      }
      bVar9 = 0xf;
      uVar15 = 0x8000;
      uVar12 = uVar19;
      uVar16 = 0;
      if (1 < uVar19) {
        do {
          uVar4 = uVar15 + uVar16 * 2 << (bVar9 & 0x1f);
          bVar9 = bVar9 - 1;
          uVar12 = uVar16;
          if (uVar4 <= uVar19) {
            uVar12 = uVar16 + uVar15;
            uVar19 = uVar19 - uVar4;
          }
          uVar15 = uVar15 >> 1;
          uVar16 = uVar12;
        } while (uVar15 != 0);
      }
      iVar2 = *(int *)(&DAT_18008a610 + lVar17 + (longlong)puVar6);
      *puVar6 = uVar12;
      puVar6 = puVar6 + 1;
      local_38 = local_38 + (int)(iVar2 * uVar12);
      lVar21 = lVar21 + -1;
    } while (lVar21 != 0);
    pvVar5 = (void *)((longlong)pvVar5 - (longlong)puVar7);
    lVar21 = -(longlong)puVar7;
    do {
      uVar19 = *(uint *)((longlong)puVar7 + (longlong)pvVar5);
      uVar15 = 0;
      bVar9 = 0xf;
      uVar16 = 0x8000;
      uVar12 = uVar19;
      if (1 < uVar19) {
        do {
          uVar12 = uVar16 + uVar15 * 2 << (bVar9 & 0x1f);
          bVar9 = bVar9 - 1;
          if (uVar12 <= uVar19) {
            uVar15 = uVar15 + uVar16;
            uVar19 = uVar19 - uVar12;
          }
          uVar16 = uVar16 >> 1;
          uVar12 = uVar15;
        } while (uVar16 != 0);
      }
      bVar9 = 0xf;
      uVar15 = 0x8000;
      uVar19 = uVar12;
      uVar16 = 0;
      if (1 < uVar12) {
        do {
          uVar19 = uVar16;
          uVar16 = uVar15 + uVar19 * 2 << (bVar9 & 0x1f);
          bVar9 = bVar9 - 1;
          if (uVar16 <= uVar12) {
            uVar19 = uVar19 + uVar15;
            uVar12 = uVar12 - uVar16;
          }
          uVar15 = uVar15 >> 1;
          uVar16 = uVar19;
        } while (uVar15 != 0);
      }
      iVar2 = *(int *)(&DAT_180083610 + lVar21 + (longlong)puVar7);
      *puVar7 = uVar19;
      puVar7 = puVar7 + 1;
      lVar22 = lVar22 + (int)(iVar2 * uVar19);
      lVar10 = lVar10 + -1;
    } while (lVar10 != 0);
  }
  else {
    if (param_3 < 0x8c) {
      lVar17 = -(longlong)puVar6;
      do {
        uVar19 = *(uint *)((longlong)puVar6 + (longlong)pvVar14);
        uVar16 = 0;
        bVar9 = 0xf;
        uVar15 = 0x8000;
        uVar12 = uVar19;
        if (1 < uVar19) {
          do {
            uVar4 = uVar15 + uVar16 * 2 << (bVar9 & 0x1f);
            bVar9 = bVar9 - 1;
            uVar19 = uVar16;
            if (uVar4 <= uVar12) {
              uVar19 = uVar16 + uVar15;
              uVar12 = uVar12 - uVar4;
            }
            uVar15 = uVar15 >> 1;
            uVar16 = uVar19;
          } while (uVar15 != 0);
        }
        bVar9 = 0xf;
        uVar15 = 0x8000;
        uVar12 = uVar19;
        uVar16 = 0;
        if (1 < uVar19) {
          do {
            uVar4 = uVar15 + uVar16 * 2 << (bVar9 & 0x1f);
            bVar9 = bVar9 - 1;
            uVar12 = uVar16;
            if (uVar4 <= uVar19) {
              uVar12 = uVar16 + uVar15;
              uVar19 = uVar19 - uVar4;
            }
            uVar15 = uVar15 >> 1;
            uVar16 = uVar12;
          } while (uVar15 != 0);
        }
        iVar2 = *(int *)(&DAT_180087610 + lVar17 + (longlong)puVar6);
        *puVar6 = uVar12;
        puVar6 = puVar6 + 1;
        local_38 = local_38 + (int)(iVar2 * uVar12);
        lVar21 = lVar21 + -1;
      } while (lVar21 != 0);
      pvVar5 = (void *)((longlong)pvVar5 - (longlong)puVar7);
      lVar21 = -(longlong)puVar7;
      do {
        uVar19 = *(uint *)((longlong)puVar7 + (longlong)pvVar5);
        uVar15 = 0;
        bVar9 = 0xf;
        uVar16 = 0x8000;
        uVar12 = uVar19;
        if (1 < uVar19) {
          do {
            uVar12 = uVar16 + uVar15 * 2 << (bVar9 & 0x1f);
            bVar9 = bVar9 - 1;
            if (uVar12 <= uVar19) {
              uVar15 = uVar15 + uVar16;
              uVar19 = uVar19 - uVar12;
            }
            uVar16 = uVar16 >> 1;
            uVar12 = uVar15;
          } while (uVar16 != 0);
        }
        bVar9 = 0xf;
        uVar15 = 0x8000;
        uVar19 = uVar12;
        uVar16 = 0;
        if (1 < uVar12) {
          do {
            uVar19 = uVar16;
            uVar16 = uVar15 + uVar19 * 2 << (bVar9 & 0x1f);
            bVar9 = bVar9 - 1;
            if (uVar16 <= uVar12) {
              uVar19 = uVar19 + uVar15;
              uVar12 = uVar12 - uVar16;
            }
            uVar15 = uVar15 >> 1;
            uVar16 = uVar19;
          } while (uVar15 != 0);
        }
        iVar2 = *(int *)(&DAT_180090610 + lVar21 + (longlong)puVar7);
        *puVar7 = uVar19;
        puVar7 = puVar7 + 1;
        lVar22 = lVar22 + (int)(iVar2 * uVar19);
        lVar10 = lVar10 + -1;
      } while (lVar10 != 0);
    }
    else {
      if (param_3 < 200) {
        lVar17 = -(longlong)puVar6;
        do {
          uVar19 = *(uint *)((longlong)puVar6 + (longlong)pvVar14);
          uVar16 = 0;
          bVar9 = 0xf;
          uVar15 = 0x8000;
          uVar12 = uVar19;
          if (1 < uVar19) {
            do {
              uVar4 = uVar15 + uVar16 * 2 << (bVar9 & 0x1f);
              bVar9 = bVar9 - 1;
              uVar19 = uVar16;
              if (uVar4 <= uVar12) {
                uVar19 = uVar16 + uVar15;
                uVar12 = uVar12 - uVar4;
              }
              uVar15 = uVar15 >> 1;
              uVar16 = uVar19;
            } while (uVar15 != 0);
          }
          bVar9 = 0xf;
          uVar15 = 0x8000;
          uVar12 = uVar19;
          uVar16 = 0;
          if (1 < uVar19) {
            do {
              uVar4 = uVar15 + uVar16 * 2 << (bVar9 & 0x1f);
              bVar9 = bVar9 - 1;
              uVar12 = uVar16;
              if (uVar4 <= uVar19) {
                uVar12 = uVar16 + uVar15;
                uVar19 = uVar19 - uVar4;
              }
              uVar15 = uVar15 >> 1;
              uVar16 = uVar12;
            } while (uVar15 != 0);
          }
          iVar2 = *(int *)(&DAT_18008d610 + lVar17 + (longlong)puVar6);
          *puVar6 = uVar12;
          puVar6 = puVar6 + 1;
          local_38 = local_38 + (int)(iVar2 * uVar12);
          lVar21 = lVar21 + -1;
        } while (lVar21 != 0);
        pvVar5 = (void *)((longlong)pvVar5 - (longlong)puVar7);
        lVar21 = -(longlong)puVar7;
        do {
          uVar19 = *(uint *)((longlong)puVar7 + (longlong)pvVar5);
          uVar15 = 0;
          bVar9 = 0xf;
          uVar16 = 0x8000;
          uVar12 = uVar19;
          if (1 < uVar19) {
            do {
              uVar12 = uVar16 + uVar15 * 2 << (bVar9 & 0x1f);
              bVar9 = bVar9 - 1;
              if (uVar12 <= uVar19) {
                uVar15 = uVar15 + uVar16;
                uVar19 = uVar19 - uVar12;
              }
              uVar16 = uVar16 >> 1;
              uVar12 = uVar15;
            } while (uVar16 != 0);
          }
          bVar9 = 0xf;
          uVar15 = 0x8000;
          uVar19 = uVar12;
          uVar16 = 0;
          if (1 < uVar12) {
            do {
              uVar19 = uVar16;
              uVar16 = uVar15 + uVar19 * 2 << (bVar9 & 0x1f);
              bVar9 = bVar9 - 1;
              if (uVar16 <= uVar12) {
                uVar19 = uVar19 + uVar15;
                uVar12 = uVar12 - uVar16;
              }
              uVar15 = uVar15 >> 1;
              uVar16 = uVar19;
            } while (uVar15 != 0);
          }
          iVar2 = *(int *)(&DAT_18009e610 + lVar21 + (longlong)puVar7);
          *puVar7 = uVar19;
          puVar7 = puVar7 + 1;
          lVar22 = lVar22 + (int)(iVar2 * uVar19);
          lVar10 = lVar10 + -1;
        } while (lVar10 != 0);
      }
      else {
        puVar20 = (undefined *)((longlong)&DAT_18007d610 - (longlong)puVar6);
        do {
          uVar19 = *(uint *)((longlong)puVar6 + (longlong)pvVar14);
          uVar16 = 0;
          bVar9 = 0xf;
          uVar15 = 0x8000;
          uVar12 = uVar19;
          if (1 < uVar19) {
            do {
              uVar4 = uVar15 + uVar16 * 2 << (bVar9 & 0x1f);
              bVar9 = bVar9 - 1;
              uVar19 = uVar16;
              if (uVar4 <= uVar12) {
                uVar19 = uVar16 + uVar15;
                uVar12 = uVar12 - uVar4;
              }
              uVar15 = uVar15 >> 1;
              uVar16 = uVar19;
            } while (uVar15 != 0);
          }
          bVar9 = 0xf;
          uVar15 = 0x8000;
          uVar12 = uVar19;
          uVar16 = 0;
          if (1 < uVar19) {
            do {
              uVar4 = uVar15 + uVar16 * 2 << (bVar9 & 0x1f);
              bVar9 = bVar9 - 1;
              uVar12 = uVar16;
              if (uVar4 <= uVar19) {
                uVar12 = uVar16 + uVar15;
                uVar19 = uVar19 - uVar4;
              }
              uVar15 = uVar15 >> 1;
              uVar16 = uVar12;
            } while (uVar15 != 0);
          }
          iVar2 = *(int *)((longlong)puVar6 + (longlong)puVar20);
          *puVar6 = uVar12;
          puVar6 = puVar6 + 1;
          local_38 = local_38 + (int)(iVar2 * uVar12);
          lVar21 = lVar21 + -1;
        } while (lVar21 != 0);
        pvVar5 = (void *)((longlong)pvVar5 - (longlong)puVar7);
        lVar21 = -(longlong)puVar7;
        do {
          uVar19 = *(uint *)((longlong)puVar7 + (longlong)pvVar5);
          uVar15 = 0;
          bVar9 = 0xf;
          uVar16 = 0x8000;
          uVar12 = uVar19;
          if (1 < uVar19) {
            do {
              uVar12 = uVar16 + uVar15 * 2 << (bVar9 & 0x1f);
              bVar9 = bVar9 - 1;
              if (uVar12 <= uVar19) {
                uVar15 = uVar15 + uVar16;
                uVar19 = uVar19 - uVar12;
              }
              uVar16 = uVar16 >> 1;
              uVar12 = uVar15;
            } while (uVar16 != 0);
          }
          bVar9 = 0xf;
          uVar15 = 0x8000;
          uVar19 = uVar12;
          uVar16 = 0;
          if (1 < uVar12) {
            do {
              uVar19 = uVar16;
              uVar16 = uVar15 + uVar19 * 2 << (bVar9 & 0x1f);
              bVar9 = bVar9 - 1;
              if (uVar16 <= uVar12) {
                uVar19 = uVar19 + uVar15;
                uVar12 = uVar12 - uVar16;
              }
              uVar15 = uVar15 >> 1;
              uVar16 = uVar19;
            } while (uVar15 != 0);
          }
          iVar2 = *(int *)(&DAT_180097610 + lVar21 + (longlong)puVar7);
          *puVar7 = uVar19;
          puVar7 = puVar7 + 1;
          lVar22 = lVar22 + (int)(iVar2 * uVar19);
          lVar10 = lVar10 + -1;
        } while (lVar10 != 0);
      }
    }
  }
  uVar19 = 1;
  if (local_38 < 0) {
    uVar19 = (uint)((ulonglong)lVar22 >> 0x3f) ^ 1;
  }
  free(_Memory);
  return (ulonglong)uVar19;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

ulonglong FUN_18003a860(ulonglong param_1,int param_2)

{
  int iVar1;
  undefined auVar2 [16];
  uint uVar3;
  void *_Memory;
  longlong *_Memory_00;
  undefined (*pauVar4) [16];
  byte bVar5;
  ulonglong *puVar6;
  uint uVar7;
  ulonglong uVar8;
  void *pvVar9;
  ulonglong uVar10;
  longlong lVar11;
  uint uVar12;
  longlong lVar13;
  ulonglong uVar14;
  longlong *plVar15;
  int *piVar16;
  undefined auVar17 [16];
  undefined auVar18 [16];

  uVar10 = 0;
  _Memory = malloc(0x6000);
  _Memory_00 = (longlong *)malloc(0x6000);
  auVar2 = _DAT_1800a4440;
  lVar11 = 0xc00;
  uVar8 = uVar10;
  if (1 < DAT_1800b04f8) {
    uVar8 = 0;
    if (((void *)(param_1 + 0x2ffc) < _Memory) || ((longlong)_Memory + 0x5ff8U < param_1)) {
      uVar8 = 0xc00;
      lVar13 = 0x180;
      pauVar4 = (undefined (*) [16])((longlong)_Memory + 0x20);
      puVar6 = (ulonglong *)(param_1 + 0x10);
      do {
        auVar17 = auVar2 & (undefined  [16])0xffffffffffffffff;
        auVar18 = pmulld(ZEXT816(puVar6[-2]),auVar17);
        auVar17 = pmovsxdq(auVar17,auVar18);
        auVar18 = auVar2 & (undefined  [16])0xffffffffffffffff;
        pauVar4[-2] = auVar17;
        auVar17 = pmulld(ZEXT816(puVar6[-1]),auVar18);
        auVar17 = pmovsxdq(auVar17,auVar17);
        pauVar4[-1] = auVar17;
        auVar17 = pmulld(ZEXT816(*puVar6),auVar18);
        auVar17 = pmovsxdq(auVar17,auVar17);
        *pauVar4 = auVar17;
        auVar17 = pmulld(ZEXT816(puVar6[1]),auVar18);
        auVar17 = pmovsxdq(auVar17,auVar17);
        pauVar4[1] = auVar17;
        lVar13 = lVar13 + -1;
        pauVar4 = pauVar4[4];
        puVar6 = puVar6 + 4;
      } while (lVar13 != 0);
    }
  }
  if (uVar8 < 0xc00) {
    do {
      *(longlong *)((longlong)_Memory + uVar8 * 8) =
           (longlong)(*(int *)(param_1 + uVar8 * 4) * 10000);
      uVar8 = uVar8 + 1;
    } while ((longlong)uVar8 < 0xc00);
  }
  pvVar9 = (void *)((longlong)_Memory - (longlong)_Memory_00);
  uVar8 = uVar10;
  if (param_2 == 0) {
    piVar16 = &DAT_180094610;
    plVar15 = _Memory_00;
    do {
      uVar12 = *(uint *)((longlong)pvVar9 + (longlong)plVar15);
      bVar5 = 0xf;
      uVar7 = 0x8000;
      uVar14 = uVar10;
      if (1 < uVar12) {
        do {
          uVar3 = uVar7 + (int)uVar14 * 2 << (bVar5 & 0x1f);
          bVar5 = bVar5 - 1;
          if (uVar3 <= uVar12) {
            uVar14 = (ulonglong)((int)uVar14 + uVar7);
            uVar12 = uVar12 - uVar3;
          }
          uVar7 = uVar7 >> 1;
        } while (uVar7 != 0);
        uVar12 = (uint)uVar14;
      }
      uVar12 = uVar12 * 10000;
      bVar5 = 0xf;
      uVar3 = 0x8000;
      uVar14 = uVar10;
      uVar7 = uVar12;
      if (1 < uVar12) {
        do {
          uVar12 = uVar3 + (int)uVar14 * 2 << (bVar5 & 0x1f);
          bVar5 = bVar5 - 1;
          if (uVar12 <= uVar7) {
            uVar14 = (ulonglong)((int)uVar14 + uVar3);
            uVar7 = uVar7 - uVar12;
          }
          uVar12 = (uint)uVar14;
          uVar3 = uVar3 >> 1;
        } while (uVar3 != 0);
      }
      iVar1 = *piVar16;
      piVar16 = piVar16 + 1;
      *plVar15 = (longlong)(int)uVar12;
      plVar15 = plVar15 + 1;
      uVar8 = uVar8 + (longlong)iVar1 * (longlong)(int)uVar12;
      lVar11 = lVar11 + -1;
    } while (lVar11 != 0);
  }
  else {
    if (param_2 == 5) {
      piVar16 = &DAT_180080610;
      plVar15 = _Memory_00;
      do {
        uVar12 = *(uint *)((longlong)plVar15 + (longlong)pvVar9);
        bVar5 = 0xf;
        uVar7 = 0x8000;
        uVar14 = uVar10;
        if (1 < uVar12) {
          do {
            uVar3 = uVar7 + (int)uVar14 * 2 << (bVar5 & 0x1f);
            bVar5 = bVar5 - 1;
            if (uVar3 <= uVar12) {
              uVar14 = (ulonglong)((int)uVar14 + uVar7);
              uVar12 = uVar12 - uVar3;
            }
            uVar7 = uVar7 >> 1;
          } while (uVar7 != 0);
          uVar12 = (uint)uVar14;
        }
        uVar12 = uVar12 * 10000;
        bVar5 = 0xf;
        uVar3 = 0x8000;
        uVar14 = uVar10;
        uVar7 = uVar12;
        if (1 < uVar12) {
          do {
            uVar12 = uVar3 + (int)uVar14 * 2 << (bVar5 & 0x1f);
            bVar5 = bVar5 - 1;
            if (uVar12 <= uVar7) {
              uVar14 = (ulonglong)((int)uVar14 + uVar3);
              uVar7 = uVar7 - uVar12;
            }
            uVar12 = (uint)uVar14;
            uVar3 = uVar3 >> 1;
          } while (uVar3 != 0);
        }
        iVar1 = *piVar16;
        piVar16 = piVar16 + 1;
        *plVar15 = (longlong)(int)uVar12;
        plVar15 = plVar15 + 1;
        uVar8 = uVar8 + (longlong)iVar1 * (longlong)(int)uVar12;
        lVar11 = lVar11 + -1;
      } while (lVar11 != 0);
    }
    else {
      if (param_2 == 2) {
        piVar16 = &DAT_18009b610;
        plVar15 = _Memory_00;
        do {
          uVar12 = *(uint *)((longlong)plVar15 + (longlong)pvVar9);
          bVar5 = 0xf;
          uVar7 = 0x8000;
          uVar14 = uVar10;
          if (1 < uVar12) {
            do {
              uVar3 = uVar7 + (int)uVar14 * 2 << (bVar5 & 0x1f);
              bVar5 = bVar5 - 1;
              if (uVar3 <= uVar12) {
                uVar14 = (ulonglong)((int)uVar14 + uVar7);
                uVar12 = uVar12 - uVar3;
              }
              uVar7 = uVar7 >> 1;
            } while (uVar7 != 0);
            uVar12 = (uint)uVar14;
          }
          uVar12 = uVar12 * 10000;
          bVar5 = 0xf;
          uVar3 = 0x8000;
          uVar14 = uVar10;
          uVar7 = uVar12;
          if (1 < uVar12) {
            do {
              uVar12 = uVar3 + (int)uVar14 * 2 << (bVar5 & 0x1f);
              bVar5 = bVar5 - 1;
              if (uVar12 <= uVar7) {
                uVar14 = (ulonglong)((int)uVar14 + uVar3);
                uVar7 = uVar7 - uVar12;
              }
              uVar12 = (uint)uVar14;
              uVar3 = uVar3 >> 1;
            } while (uVar3 != 0);
          }
          iVar1 = *piVar16;
          piVar16 = piVar16 + 1;
          *plVar15 = (longlong)(int)uVar12;
          plVar15 = plVar15 + 1;
          uVar8 = uVar8 + (longlong)iVar1 * (longlong)(int)uVar12;
          lVar11 = lVar11 + -1;
        } while (lVar11 != 0);
      }
      else {
        piVar16 = &DAT_180080610;
        plVar15 = _Memory_00;
        do {
          uVar12 = *(uint *)((longlong)plVar15 + (longlong)pvVar9);
          bVar5 = 0xf;
          uVar7 = 0x8000;
          uVar14 = uVar10;
          if (1 < uVar12) {
            do {
              uVar3 = uVar7 + (int)uVar14 * 2 << (bVar5 & 0x1f);
              bVar5 = bVar5 - 1;
              if (uVar3 <= uVar12) {
                uVar14 = (ulonglong)((int)uVar14 + uVar7);
                uVar12 = uVar12 - uVar3;
              }
              uVar7 = uVar7 >> 1;
            } while (uVar7 != 0);
            uVar12 = (uint)uVar14;
          }
          uVar12 = uVar12 * 10000;
          bVar5 = 0xf;
          uVar3 = 0x8000;
          uVar14 = uVar10;
          uVar7 = uVar12;
          if (1 < uVar12) {
            do {
              uVar12 = uVar3 + (int)uVar14 * 2 << (bVar5 & 0x1f);
              bVar5 = bVar5 - 1;
              if (uVar12 <= uVar7) {
                uVar14 = (ulonglong)((int)uVar14 + uVar3);
                uVar7 = uVar7 - uVar12;
              }
              uVar12 = (uint)uVar14;
              uVar3 = uVar3 >> 1;
            } while (uVar3 != 0);
          }
          iVar1 = *piVar16;
          piVar16 = piVar16 + 1;
          *plVar15 = (longlong)(int)uVar12;
          plVar15 = plVar15 + 1;
          uVar8 = uVar8 + (longlong)iVar1 * (longlong)(int)uVar12;
          lVar11 = lVar11 + -1;
        } while (lVar11 != 0);
      }
    }
  }
  free(_Memory);
  free(_Memory_00);
  return (ulonglong)(-40000000000 < (longlong)uVar8);
}



void FUN_18003ac80(longlong param_1,short *param_2,int param_3,int param_4,int param_5,int param_6,
                  int *param_7,int *param_8,uint param_9)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  longlong lVar6;
  int iVar7;
  int iVar8;
  longlong lVar9;

  iVar8 = 0;
  iVar7 = param_3 * param_4;
  iVar4 = 0;
  lVar9 = (longlong)iVar7;
  if ((param_9 < 9) && ((0x132U >> (param_9 & 0x1f) & 1) != 0)) {
    iVar5 = 0;
    iVar3 = 0xed8;
    if (param_9 != 4) {
      iVar3 = 0x1036;
    }
    iVar2 = 0;
    if (0 < iVar7) {
      lVar6 = param_1 - (longlong)param_2;
      do {
        iVar1 = (int)*(short *)((longlong)param_2 + lVar6);
        iVar7 = *param_2 - iVar1;
        if (iVar3 < iVar7) {
          iVar8 = iVar8 + 1;
          iVar4 = iVar4 + iVar7;
        }
        else {
          iVar5 = iVar5 + 1;
          iVar2 = iVar2 + iVar7;
        }
        if (0 < iVar1 - *param_2) {
          *param_8 = *param_8 + 1;
        }
        param_2 = param_2 + 1;
        lVar9 = lVar9 + -1;
      } while (lVar9 != 0);
      if (0 < iVar8) {
        if (0 < iVar5) {
          iVar2 = iVar2 / iVar5;
        }
        iVar2 = iVar4 / iVar8 - iVar2;
        *param_7 = iVar3 - ((int)(iVar2 + (iVar2 >> 0x1f & 3U)) >> 2);
      }
    }
  }
  else {
    if (param_5 == 0) {
      if (0 < iVar7) {
        lVar6 = param_1 - (longlong)param_2;
        do {
          iVar7 = (int)*(short *)((longlong)param_2 + lVar6) - (int)*param_2;
          if (0x32 < iVar7) {
            iVar8 = iVar8 + 1;
            iVar4 = iVar4 + iVar7;
          }
          param_2 = param_2 + 1;
          lVar9 = lVar9 + -1;
        } while (lVar9 != 0);
        if (0 < iVar8) {
          *param_7 = (iVar4 / iVar8) / 5;
        }
      }
    }
    else {
      iVar7 = 0x32;
      if ((param_9 - 0x3e < 2) && (iVar7 = 300, param_6 == 0)) {
        iVar7 = 700;
      }
      if (0 < lVar9) {
        lVar6 = param_1 - (longlong)param_2;
        do {
          iVar3 = (int)*param_2 - (int)*(short *)(lVar6 + (longlong)param_2);
          if (iVar7 < iVar3) {
            iVar8 = iVar8 + 1;
            iVar4 = iVar4 + iVar3;
          }
          param_2 = param_2 + 1;
          lVar9 = lVar9 + -1;
        } while (lVar9 != 0);
        if (0 < iVar8) {
          iVar4 = iVar4 / iVar8;
          if ((param_9 - 0x3e < 2) && (param_6 == 0)) {
            iVar4 = (iVar4 * 0x17) / 0x32 + (iVar4 * 0x17 >> 0x1f);
          }
          else {
            iVar4 = iVar4 / 5 + (iVar4 >> 0x1f);
          }
          iVar4 = iVar4 - (iVar4 >> 0x1f);
          *param_7 = iVar4;
          if (iVar8 != param_4 * 10 && SBORROW4(iVar8,param_4 * 10) == iVar8 + param_4 * -10 < 0) {
            return;
          }
          if (iVar7 < iVar4) {
            iVar7 = iVar4;
          }
          *param_7 = iVar7;
          return;
        }
      }
      *param_7 = iVar7;
    }
  }
  return;
}



ulonglong FUN_18003ae90(longlong param_1,longlong param_2,int param_3,int param_4)

{
  bool bVar1;
  int iVar2;
  short sVar3;
  longlong lVar4;
  longlong lVar5;
  ulonglong uVar6;
  int iVar7;
  short sVar8;
  short *psVar9;
  ulonglong uVar10;
  int iVar11;
  longlong lVar12;
  short sVar13;
  short sVar14;
  uint uVar15;
  short *psVar16;
  short *psVar17;
  int iVar18;
  uint local_res18;
  int local_68;
  int local_64;

  iVar7 = 0;
  uVar15 = 0;
  local_68 = 0;
  local_res18 = 0;
  if (param_3 + -5 < 6) {
    uVar6 = 0;
  }
  else {
    iVar18 = 10;
    local_64 = 0;
    lVar4 = (longlong)((param_4 + 1) * 5);
    lVar12 = lVar4 + param_2;
    psVar9 = (short *)(param_1 + lVar4 * 2);
    uVar6 = (ulonglong)(param_3 - 10);
    do {
      if (5 < param_4 + -5) {
        lVar4 = 0;
        uVar10 = (ulonglong)(param_4 - 10);
        psVar17 = psVar9;
        do {
          if (*(char *)(lVar12 + lVar4) != '\0') {
            sVar13 = *psVar17;
            iVar11 = iVar18 + -10;
            bVar1 = true;
            sVar8 = sVar13;
            iVar2 = local_64;
            sVar14 = sVar13;
            if (iVar11 <= iVar18) {
              do {
                uVar15 = local_res18;
                iVar7 = local_68;
                if (!bVar1) goto LAB_18003b00c;
                psVar16 = (short *)(param_1 + (lVar4 + iVar2) * 2);
                lVar5 = lVar4;
                do {
                  if (*(char *)(iVar2 + param_2 + lVar5) == '\0') {
                    bVar1 = false;
                    sVar8 = sVar14;
                    break;
                  }
                  sVar8 = *psVar16;
                  sVar3 = sVar8;
                  if (sVar8 <= sVar13) {
                    sVar3 = sVar13;
                  }
                  sVar13 = sVar3;
                  if (sVar14 <= sVar8) {
                    sVar8 = sVar14;
                  }
                  lVar5 = lVar5 + 1;
                  psVar16 = psVar16 + 1;
                  sVar14 = sVar8;
                } while (lVar5 <= lVar4);
                iVar11 = iVar11 + 1;
                iVar2 = iVar2 + param_4;
                sVar14 = sVar8;
              } while (iVar11 <= iVar18);
              if (!bVar1) goto LAB_18003b00c;
            }
            local_res18 = local_res18 + ((int)sVar13 - (int)sVar8);
            local_68 = local_68 + 1;
            uVar15 = local_res18;
            iVar7 = local_68;
          }
LAB_18003b00c:
          psVar17 = psVar17 + 1;
          lVar4 = lVar4 + 1;
          uVar10 = uVar10 - 1;
        } while (uVar10 != 0);
      }
      psVar9 = psVar9 + param_4;
      lVar12 = lVar12 + param_4;
      local_64 = local_64 + param_4;
      iVar18 = iVar18 + 1;
      uVar6 = uVar6 - 1;
    } while (uVar6 != 0);
    uVar6 = (ulonglong)uVar15;
    if (0 < iVar7) {
      return (longlong)(int)uVar15 / (longlong)iVar7 & 0xffffffff;
    }
  }
  return uVar6;
}



// WARNING: Could not reconcile some variable overlaps

ulonglong FUN_18003b0b0(ulonglong param_1,ulonglong param_2,ulonglong param_3,ulonglong param_4)

{
  bool bVar1;
  uint uVar2;
  short sVar3;
  uint uVar4;
  undefined *_Memory;
  undefined8 *_Memory_00;
  undefined8 *_Memory_01;
  undefined2 *_Memory_02;
  short *_Memory_03;
  undefined *_Memory_04;
  undefined8 *puVar5;
  ulonglong uVar6;
  ulonglong uVar7;
  short *psVar8;
  longlong lVar9;
  short sVar10;
  longlong lVar11;
  int iVar12;
  uint uVar13;
  int iVar14;
  ulonglong _Size;
  short sVar15;
  undefined *puVar16;
  short sVar17;
  int iVar18;
  undefined2 *puVar19;
  longlong lVar20;
  short *psVar21;
  undefined *puVar22;
  short *psVar23;
  uint uVar24;
  ulonglong uVar25;
  int iVar26;
  int local_res8 [2];
  ulonglong local_res10;
  uint local_res18;
  ulonglong local_res20;

  uVar13 = (uint)param_3;
  local_res18 = (int)uVar13 >> 0xe & 0x1ff;
  uVar6 = (param_3 & 0xffffffff) >> 0x17;
  iVar26 = (int)uVar6;
  uVar4 = local_res18 * iVar26;
  local_res20 = param_4 & 0xffffffff00000000 | uVar6;
  _Size = (ulonglong)uVar4;
  local_res10 = param_2 & 0xffffffff00000000;
  local_res8[0] = 0;
  _Memory = (undefined *)malloc(_Size);
  _Memory_00 = (undefined8 *)malloc(0x3000);
  _Memory_01 = (undefined8 *)malloc(0x4000);
  uVar24 = uVar4 * 2;
  uVar25 = (ulonglong)uVar24;
  uVar7 = (ulonglong)uVar24;
  _Memory_02 = (undefined2 *)malloc(uVar25);
  _Memory_03 = (short *)malloc(uVar25);
  _Memory_04 = (undefined *)malloc((ulonglong)uVar24);
  if (_Memory_00 != (undefined8 *)0x0) {
    lVar11 = 0xc0;
    puVar5 = _Memory_00;
    do {
      *puVar5 = 0;
      puVar5[1] = 0;
      puVar5[2] = 0;
      puVar5[3] = 0;
      puVar5[4] = 0;
      puVar5[5] = 0;
      puVar5[6] = 0;
      puVar5[7] = 0;
      lVar11 = lVar11 + -1;
      puVar5 = puVar5 + 8;
    } while (lVar11 != 0);
  }
  if (_Memory_01 != (undefined8 *)0x0) {
    lVar11 = 0x100;
    puVar5 = _Memory_01;
    do {
      *puVar5 = 0;
      puVar5[1] = 0;
      puVar5[2] = 0;
      puVar5[3] = 0;
      puVar5[4] = 0;
      puVar5[5] = 0;
      puVar5[6] = 0;
      puVar5[7] = 0;
      lVar11 = lVar11 + -1;
      puVar5 = puVar5 + 8;
    } while (lVar11 != 0);
  }
  if ((_Memory_02 != (undefined2 *)0x0) && (puVar19 = _Memory_02, uVar4 != 0)) {
    while (uVar7 != 0) {
      uVar7 = uVar7 - 1;
      *(undefined *)puVar19 = 0;
      puVar19 = (undefined2 *)((longlong)puVar19 + 1);
    }
  }
  if ((_Memory != (undefined *)0x0) && (uVar7 = _Size, puVar16 = _Memory, uVar4 != 0)) {
    while (uVar7 != 0) {
      *puVar16 = 1;
      uVar7 = uVar7 - 1;
      puVar16 = puVar16 + 1;
    }
  }
  if (((((_Memory_03 != (short *)0x0) && (param_1 != 0)) && (uVar4 != 0)) &&
      ((uVar7 = (ulonglong)uVar24, (short *)(uVar25 + param_1) <= _Memory_03 ||
       (uVar25 + (longlong)_Memory_03 <= param_1)))) && (uVar4 != 0)) {
    psVar8 = _Memory_03;
    do {
      *(undefined *)psVar8 = *(undefined *)((param_1 - (longlong)_Memory_03) + (longlong)psVar8);
      psVar8 = (short *)((longlong)psVar8 + 1);
      uVar7 = uVar7 - 1;
    } while (uVar7 != 0);
  }
  if ((((_Memory_04 != (undefined *)0x0) && (uVar4 != 0)) &&
      ((uVar7 = (ulonglong)uVar24, (undefined *)((longlong)&DAT_1800bb9d4 + uVar7) <= _Memory_04 ||
       (_Memory_04 + uVar25 < (undefined *)0x1800bb9d5)))) && (uVar4 != 0)) {
    puVar16 = _Memory_04;
    do {
      *puVar16 = puVar16[(longlong)((longlong)&DAT_1800bb9d4 + -(longlong)_Memory_04)];
      puVar16 = puVar16 + 1;
      uVar7 = uVar7 - 1;
    } while (uVar7 != 0);
  }
  if ((((_Memory_02 != (undefined2 *)0x0) && (uVar4 != 0)) &&
      ((uVar7 = (ulonglong)uVar24, &DAT_1800c52f4 + uVar7 <= _Memory_02 ||
       (uVar25 + (longlong)_Memory_02 < 0x1800c52f5)))) && (uVar4 != 0)) {
    puVar19 = _Memory_02;
    do {
      *(undefined *)puVar19 = (&DAT_1800c52f4 + -(longlong)_Memory_02)[(longlong)puVar19];
      puVar19 = (undefined2 *)((longlong)puVar19 + 1);
      uVar7 = uVar7 - 1;
    } while (uVar7 != 0);
  }
  uVar24 = (int)uVar13 >> 3 & 0x3f;
  if (uVar24 - 0x3e < 2) {
    psVar8 = _Memory_03 + (int)((local_res18 - 1) * iVar26) / 2;
    iVar18 = (int)psVar8[-1 - uVar6] + (int)psVar8[uVar6 - 1] + (int)psVar8[-2] + (int)*psVar8;
    psVar8[-1] = (short)((int)(iVar18 + (iVar18 >> 0x1f & 3U)) >> 2);
  }
  else {
    if (iVar26 != 0) {
      iVar18 = (local_res18 - 1) * iVar26;
      psVar8 = _Memory_03 + uVar6;
      uVar7 = uVar6;
      do {
        *(undefined2 *)
         ((longlong)psVar8 + (longlong)_Memory_04 + (uVar6 * -2 - (longlong)_Memory_03)) =
             *(undefined2 *)
              ((longlong)psVar8 + (longlong)((longlong)_Memory_04 - (longlong)_Memory_03));
        lVar9 = (longlong)(int)(iVar18 + ((local_res18 - (local_res18 - 1)) + -2) * iVar26);
        lVar11 = (longlong)iVar18;
        iVar18 = iVar18 + 1;
        *(undefined2 *)(_Memory_04 + lVar11 * 2) = *(undefined2 *)(_Memory_04 + lVar9 * 2);
        psVar8[-uVar6] = *psVar8;
        _Memory_03[lVar11] = _Memory_03[lVar9];
        uVar7 = uVar7 - 1;
        psVar8 = psVar8 + 1;
      } while (uVar7 != 0);
      uVar6 = local_res20 & 0xffffffff;
    }
    iVar26 = (int)uVar6;
    if (local_res18 != 0) {
      lVar9 = (longlong)(iVar26 + -1);
      lVar11 = (iVar26 + -2) - lVar9;
      puVar19 = (undefined2 *)(_Memory_04 + lVar9 * 2);
      lVar20 = (longlong)_Memory_03 + (lVar9 * -2 - (longlong)_Memory_04);
      uVar7 = (ulonglong)local_res18;
      do {
        puVar19[-lVar9] = puVar19[1 - lVar9];
        *puVar19 = puVar19[lVar11];
        *(undefined2 *)(lVar20 + (longlong)puVar19) =
             *(undefined2 *)(lVar20 + 2 + (longlong)puVar19);
        *(undefined2 *)((longlong)((longlong)_Memory_03 - (longlong)_Memory_04) + (longlong)puVar19)
             = *(undefined2 *)
                ((lVar11 * 2 - (longlong)_Memory_04) + (longlong)_Memory_03 + (longlong)puVar19);
        puVar19 = puVar19 + uVar6;
        uVar7 = uVar7 - 1;
        iVar26 = (uint)local_res20;
      } while (uVar7 != 0);
    }
  }
  FUN_18003ac80((longlong)_Memory_03,&DAT_1800bb9d4,local_res18,iVar26,uVar13 & 1,
                (int)uVar13 >> 2 & 1,(int *)&local_res10,local_res8,uVar24);
  uVar6 = local_res20;
  uVar2 = local_res18;
  if (_Size != 0) {
    puVar22 = _Memory_04 + -(longlong)_Memory_03;
    psVar8 = _Memory_03;
    puVar16 = _Memory;
    do {
      if ((uVar24 < 9) && ((0x132U >> uVar24 & 1) != 0)) {
        if ((((int)*(short *)((longlong)psVar8 + (longlong)puVar22) - (int)*psVar8 <
              (int)(uint)local_res10) || ((uint)local_res10 == 0)) ||
           (((int)uVar4 < local_res8[0] * 10 &&
            (0 < (int)*psVar8 - (int)*(short *)((longlong)psVar8 + (longlong)puVar22))))) {
          *puVar16 = 0;
        }
LAB_18003b5a6:
        if ((param_3 & 1) == 0) goto LAB_18003b5b6;
LAB_18003b5ab:
        if (*psVar8 == 0xfff) goto LAB_18003b5bb;
        if ((param_3 & 1) == 0) goto LAB_18003b5b6;
      }
      else {
        if ((param_3 & 1) != 0) {
          if ((int)*(short *)((longlong)psVar8 + (longlong)puVar22) - (int)*psVar8 <
              (int)(uint)local_res10) goto LAB_18003b7bf;
          goto LAB_18003b5ab;
        }
        if ((int)*psVar8 - (int)*(short *)((longlong)psVar8 + (longlong)puVar22) <
            (int)(uint)local_res10) {
LAB_18003b7bf:
          *puVar16 = 0;
          goto LAB_18003b5a6;
        }
LAB_18003b5b6:
        if (*psVar8 == 0) {
LAB_18003b5bb:
          *puVar16 = 0;
        }
      }
      psVar8 = psVar8 + 1;
      puVar16 = puVar16 + 1;
      _Size = _Size - 1;
    } while (_Size != 0);
  }
  iVar26 = (uint)local_res20;
  FUN_18003c110((longlong)_Memory_02,(longlong)_Memory,_Memory_00,local_res18,(uint)local_res20,1,2)
  ;
  FUN_18003c110((longlong)_Memory_02,(longlong)_Memory,_Memory_00 + 0x200,uVar2,(uint)local_res20,2,
                4);
  FUN_18003c110((longlong)_Memory_02,(longlong)_Memory,_Memory_00 + 0x400,uVar2,(uint)local_res20,4,
                8);
  if (uVar24 == 0x3f) {
    local_res10._0_4_ = 0;
    uVar13 = 0;
    local_res10 = local_res10 & 0xffffffff00000000;
    local_res20 = local_res20 & 0xffffffff00000000;
    if (5 < (int)(local_res18 - 5)) {
      uVar7 = (ulonglong)(((uint)local_res20 + 1) * 5);
      iVar18 = 10;
      puVar16 = _Memory + uVar7;
      local_res8[0] = 0;
      psVar8 = _Memory_02 + uVar7;
      uVar7 = (ulonglong)(local_res18 - 10);
      uVar13 = (uint)local_res10;
      do {
        lVar11 = 0;
        if (5 < iVar26 + -5) {
          uVar25 = (ulonglong)(iVar26 - 10);
          psVar23 = psVar8;
          do {
            if (puVar16[lVar11] != '\0') {
              sVar15 = *psVar23;
              iVar12 = iVar18 + -10;
              bVar1 = true;
              sVar10 = sVar15;
              iVar14 = local_res8[0];
              if (iVar12 <= iVar18) {
                do {
                  uVar13 = (uint)local_res20;
                  if (!bVar1) goto LAB_18003b829;
                  psVar21 = _Memory_02 + lVar11 + iVar14;
                  lVar9 = lVar11;
                  sVar17 = sVar10;
                  do {
                    if (_Memory[lVar9 + iVar14] == '\0') {
                      bVar1 = false;
                      sVar10 = sVar17;
                      break;
                    }
                    sVar10 = *psVar21;
                    sVar3 = sVar10;
                    if (sVar10 <= sVar15) {
                      sVar3 = sVar15;
                    }
                    sVar15 = sVar3;
                    if (sVar17 <= sVar10) {
                      sVar10 = sVar17;
                    }
                    lVar9 = lVar9 + 1;
                    psVar21 = psVar21 + 1;
                    sVar17 = sVar10;
                  } while (lVar9 <= lVar11);
                  iVar12 = iVar12 + 1;
                  iVar14 = iVar14 + iVar26;
                } while (iVar12 <= iVar18);
                if (!bVar1) goto LAB_18003b829;
              }
              uVar13 = (uint)local_res20 + ((int)sVar15 - (int)sVar10);
              local_res10._0_4_ = (uint)local_res10 + 1;
              local_res20 = local_res20 & 0xffffffff00000000 | (ulonglong)uVar13;
              local_res10 = local_res10 & 0xffffffff00000000 | (ulonglong)(uint)local_res10;
            }
LAB_18003b829:
            psVar23 = psVar23 + 1;
            lVar11 = lVar11 + 1;
            uVar25 = uVar25 - 1;
          } while (uVar25 != 0);
        }
        psVar8 = psVar8 + (uVar6 & 0xffffffff);
        puVar16 = puVar16 + (uVar6 & 0xffffffff);
        local_res8[0] = local_res8[0] + iVar26;
        iVar18 = iVar18 + 1;
        uVar7 = uVar7 - 1;
      } while (uVar7 != 0);
      if (0 < (int)(uint)local_res10) {
        uVar13 = (int)uVar13 / (int)(uint)local_res10;
      }
    }
    FUN_18003c5b0(_Memory_02,(longlong)_Memory,(longlong)_Memory_01,local_res18,iVar26);
    FUN_18003a130((ulonglong)_Memory_00,(ulonglong)_Memory_01,uVar13);
    uVar6 = 0xffffffff;
  }
  else {
    uVar6 = 0xffffffff;
    if ((uVar24 < 6) && (uVar6 = 0xffffffff, (0x25U >> ((int)uVar13 >> 3 & 0x1fU) & 1) != 0)) {
      uVar6 = FUN_18003a860((ulonglong)_Memory_00,uVar24);
      uVar6 = uVar6 & 0xffffffff;
    }
  }
  free(_Memory);
  free(_Memory_00);
  free(_Memory_01);
  free(_Memory_02);
  free(_Memory_04);
  free(_Memory_03);
  return uVar6;
}



// WARNING: Could not reconcile some variable overlaps

undefined8 FUN_18003ba20(void)

{
  longlong lVar1;
  undefined8 *puVar2;
  int iVar3;
  int iVar4;
  longlong lVar5;
  longlong lVar6;
  int *in_RCX;
  longlong lVar7;
  longlong lVar8;
  int local_38;
  undefined8 local_34;
  int local_2c;
  undefined local_28 [16];
  undefined local_18 [24];

  local_38 = *in_RCX;
  local_34._0_4_ = in_RCX[1];
  lVar8 = 0;
  local_34._4_4_ = in_RCX[3];
  local_2c = in_RCX[4];
  lVar7 = 0xc;
  local_28 = ZEXT816(0);
  local_18._0_16_ = ZEXT816(0);
  do {
    iVar3 = *(int *)(&local_34 + lVar8);
    lVar6 = 0;
    iVar4 = (&local_38)[lVar8 * 2];
    do {
      puVar2 = &local_34 + lVar6;
      lVar5 = lVar6 * 2;
      lVar1 = lVar6 * 8;
      lVar6 = lVar6 + 1;
      *(longlong *)((longlong)&local_34 + lVar7 + lVar1) =
           (longlong)(*(int *)puVar2 * iVar3) + (longlong)((&local_38)[lVar5] * iVar4);
    } while (lVar6 < 2);
    lVar8 = lVar8 + 1;
    lVar7 = lVar7 + 0x10;
  } while (lVar8 < 2);
  lVar7 = local_18._8_8_ + local_28._0_8_;
  lVar8 = lVar7 * lVar7 + (local_18._0_8_ * local_28._8_8_ - local_18._8_8_ * local_28._0_8_) * 4;
  if ((-1 < lVar8) && (-1 < lVar7)) {
    lVar6 = 0x14600 - lVar7;
    lVar7 = 0x32200 - lVar7;
    if ((lVar6 < 1) &&
       (((-1 < lVar7 && (lVar6 * lVar6 - lVar8 != 0 && lVar8 <= lVar6 * lVar6)) &&
        (lVar7 * lVar7 - lVar8 != 0 && lVar8 <= lVar7 * lVar7)))) {
      return 1;
    }
  }
  return 0;
}



void FUN_18003bb20(ulonglong param_1,ulonglong param_2,ulonglong param_3,int param_4,int param_5)

{
  uint *puVar1;
  uint *puVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  ulonglong uVar13;
  uint *puVar14;
  uint uVar15;
  uint uVar16;
  uint uVar17;
  ulonglong uVar18;

  uVar18 = 0;
  uVar16 = (uint)(param_4 * param_5) >> 2;
  if ((uint)(param_4 * param_5) >> 2 != 0) {
    if (0xf < uVar16) {
      uVar15 = uVar16 - 1;
      uVar13 = param_3 + (ulonglong)uVar15 * 4;
      if (((param_1 + (ulonglong)uVar15 * 4 < param_3) || (uVar13 < param_1)) &&
         ((param_2 + (ulonglong)uVar15 * 4 < param_3 || (uVar13 < param_2)))) {
        uVar15 = 8;
        do {
          puVar14 = (uint *)(param_2 + uVar18 * 4);
          uVar3 = puVar14[1];
          uVar4 = puVar14[2];
          uVar5 = puVar14[3];
          uVar13 = (ulonglong)(uVar15 - 4);
          puVar1 = (uint *)(param_1 + uVar18 * 4);
          uVar6 = puVar1[1];
          uVar7 = puVar1[2];
          uVar8 = puVar1[3];
          puVar2 = (uint *)(param_2 + uVar13 * 4);
          uVar9 = *puVar2;
          uVar10 = puVar2[1];
          uVar11 = puVar2[2];
          uVar12 = puVar2[3];
          puVar2 = (uint *)(param_3 + uVar18 * 4);
          *puVar2 = *puVar1 & *puVar14;
          puVar2[1] = uVar6 & uVar3;
          puVar2[2] = uVar7 & uVar4;
          puVar2[3] = uVar8 & uVar5;
          uVar17 = (int)uVar18 + 0x10;
          uVar18 = (ulonglong)uVar17;
          puVar14 = (uint *)(param_1 + uVar13 * 4);
          uVar3 = puVar14[1];
          uVar4 = puVar14[2];
          uVar5 = puVar14[3];
          puVar1 = (uint *)(param_3 + uVar13 * 4);
          *puVar1 = *puVar14 & uVar9;
          puVar1[1] = uVar3 & uVar10;
          puVar1[2] = uVar4 & uVar11;
          puVar1[3] = uVar5 & uVar12;
          uVar13 = (ulonglong)uVar15;
          puVar14 = (uint *)(param_2 + uVar13 * 4);
          uVar3 = puVar14[1];
          uVar4 = puVar14[2];
          uVar5 = puVar14[3];
          puVar1 = (uint *)(param_1 + uVar13 * 4);
          uVar6 = puVar1[1];
          uVar7 = puVar1[2];
          uVar8 = puVar1[3];
          puVar2 = (uint *)(param_3 + uVar13 * 4);
          *puVar2 = *puVar1 & *puVar14;
          puVar2[1] = uVar6 & uVar3;
          puVar2[2] = uVar7 & uVar4;
          puVar2[3] = uVar8 & uVar5;
          uVar13 = (ulonglong)(uVar15 + 4);
          uVar15 = uVar15 + 0x10;
          puVar14 = (uint *)(param_1 + uVar13 * 4);
          uVar3 = puVar14[1];
          uVar4 = puVar14[2];
          uVar5 = puVar14[3];
          puVar1 = (uint *)(param_2 + uVar13 * 4);
          uVar6 = puVar1[1];
          uVar7 = puVar1[2];
          uVar8 = puVar1[3];
          puVar2 = (uint *)(param_3 + uVar13 * 4);
          *puVar2 = *puVar14 & *puVar1;
          puVar2[1] = uVar3 & uVar6;
          puVar2[2] = uVar4 & uVar7;
          puVar2[3] = uVar5 & uVar8;
        } while (uVar17 < (uVar16 & 0xfffffff0));
      }
    }
    if ((uint)uVar18 < uVar16) {
      puVar14 = (uint *)(param_1 + uVar18 * 4);
      uVar18 = (ulonglong)(uVar16 - (uint)uVar18);
      do {
        *(uint *)((param_3 - param_1) + (longlong)puVar14) =
             *(uint *)((param_2 - param_1) + (longlong)puVar14) & *puVar14;
        puVar14 = puVar14 + 1;
        uVar18 = uVar18 - 1;
      } while (uVar18 != 0);
    }
  }
  return;
}



void FUN_18003bdc0(ulonglong param_1,ulonglong param_2,ulonglong param_3,int param_4)

{
  longlong lVar1;
  longlong lVar2;
  longlong lVar3;
  char *pcVar4;
  char cVar5;
  byte bVar6;
  int iVar7;
  ulonglong uVar8;
  longlong lVar9;
  uint uVar10;
  int iVar11;
  ulonglong uVar12;
  uint uVar13;
  undefined *puVar14;
  longlong lVar15;
  longlong lVar16;
  ulonglong uVar17;
  longlong lVar18;
  longlong lVar19;
  undefined8 uStack56;

  uStack56 = 0x18003bdd3;
  lVar3 = _alloca_probe();
  lVar3 = -lVar3;
  *(ulonglong *)(&stack0x00009920 + lVar3) =
       DAT_1800b04e8 ^ (ulonglong)(&stack0xffffffffffffffd0 + lVar3);
  iVar7 = *(int *)(&stack0x00009990 + lVar3);
  uVar13 = param_4 * iVar7;
  if (uVar13 != 0) {
    uVar8 = (ulonglong)uVar13;
    puVar14 = &stack0x00004c90 + lVar3;
    while (uVar8 != 0) {
      uVar8 = uVar8 - 1;
      *puVar14 = 0;
      puVar14 = puVar14 + 1;
    }
    if (uVar13 != 0) {
      uVar8 = (ulonglong)uVar13;
      puVar14 = &stack0x00000000 + lVar3;
      while (uVar8 != 0) {
        uVar8 = uVar8 - 1;
        *puVar14 = 0;
        puVar14 = puVar14 + 1;
      }
    }
  }
  *(int *)(&stack0xfffffffffffffff0 + lVar3) = iVar7;
  *(undefined8 *)((longlong)&uStack56 + lVar3) = 0x18003be37;
  FUN_18003bb20(param_3,param_1,(ulonglong)(&stack0x00004c90 + lVar3),param_4,
                *(int *)(&stack0xfffffffffffffff0 + lVar3));
  *(int *)(&stack0xfffffffffffffff0 + lVar3) = iVar7;
  *(undefined8 *)((longlong)&uStack56 + lVar3) = 0x18003be4f;
  FUN_18003bb20(param_3,param_2,(ulonglong)(&stack0x00000000 + lVar3),param_4,
                *(int *)(&stack0xfffffffffffffff0 + lVar3));
  uVar10 = 0;
  if (uVar13 != 0) {
    pcVar4 = &stack0x00004c90 + lVar3;
    do {
      cVar5 = *pcVar4;
      if (pcVar4[param_3 - (longlong)(&stack0x00004c90 + lVar3)] == '\0') {
        cVar5 = cVar5 + 'z';
      }
      *pcVar4 = cVar5;
      uVar10 = uVar10 + 1;
      pcVar4 = pcVar4 + 1;
    } while (uVar10 < uVar13);
    if (uVar13 != 0) {
      uVar8 = (ulonglong)uVar13;
      pcVar4 = &stack0x00000000 + lVar3;
      do {
        cVar5 = *pcVar4;
        if (pcVar4[param_3 - (longlong)(&stack0x00000000 + lVar3)] == '\0') {
          cVar5 = cVar5 + 'z';
        }
        *pcVar4 = cVar5;
        pcVar4 = pcVar4 + 1;
        uVar8 = uVar8 - 1;
      } while (uVar8 != 0);
    }
  }
  lVar16 = 0;
  lVar18 = 0;
  lVar19 = 0;
  lVar15 = 0;
  if (uVar13 != 0) {
    lVar9 = 0;
    uVar8 = (ulonglong)uVar13;
    do {
      lVar1 = lVar9 + lVar3;
      lVar9 = lVar9 + 1;
      lVar16 = lVar16 + (ulonglong)(byte)(&stack0x00000000)[lVar1];
      lVar18 = lVar18 + (ulonglong)(byte)(&stack0x00004c8f)[lVar9 + lVar3];
      uVar8 = uVar8 - 1;
    } while (uVar8 != 0);
  }
  uVar10 = 0;
  if (uVar13 != 0) {
    lVar9 = 0;
    do {
      lVar1 = lVar9 + lVar3;
      uVar10 = uVar10 + 1;
      lVar2 = lVar9 + lVar3;
      lVar9 = lVar9 + 1;
      iVar11 = (uint)(byte)(&stack0x00004c90)[lVar1] -
               (int)((ulonglong)(lVar18 << 8) / (ulonglong)uVar13 >> 8);
      iVar7 = (uint)(byte)(&stack0x00000000)[lVar2] -
              (int)((ulonglong)(lVar16 << 8) / (ulonglong)uVar13 >> 8);
      lVar19 = lVar19 + iVar7 * iVar7;
      lVar15 = lVar15 + iVar11 * iVar11;
    } while (uVar10 < uVar13);
  }
  uVar8 = lVar15 * lVar19;
  iVar7 = 0;
  bVar6 = 0x1f;
  uVar17 = 0x80000000;
  if (1 < uVar8) {
    do {
      uVar12 = (uint)(iVar7 * 2) + uVar17 << (bVar6 & 0x3f);
      bVar6 = bVar6 - 1;
      if (uVar12 <= uVar8) {
        iVar7 = iVar7 + (int)uVar17;
        uVar8 = uVar8 - uVar12;
      }
      uVar17 = uVar17 >> 1;
    } while (uVar17 != 0);
  }
  *(undefined8 *)((longlong)&uStack56 + lVar3) = 0x18003bfc5;
  FUN_18005f100(*(ulonglong *)(&stack0x00009920 + lVar3) ^
                (ulonglong)(&stack0xffffffffffffffd0 + lVar3),
                *(undefined *)((longlong)&uStack56 + lVar3));
  return;
}



ulonglong FUN_18003bfe0(longlong param_1,longlong param_2,longlong param_3,int *param_4)

{
  int iVar1;
  int iVar2;
  byte *pbVar3;
  uint uVar4;
  uint uVar5;
  ulonglong uVar6;
  byte *pbVar7;
  longlong lVar8;
  int iVar9;
  uint uVar10;
  ulonglong uVar11;

  iVar1 = param_4[6];
  iVar9 = 0;
  iVar2 = *param_4;
  uVar5 = 0;
  if ((iVar1 == 1) || (iVar1 - 7U < 2)) {
    uVar5 = 4;
  }
  else {
    if ((iVar1 == 0) || (iVar1 == 0x14)) {
      uVar5 = 8;
    }
  }
  uVar10 = 0;
  if ((int)(param_4[1] - uVar5) <= (int)uVar5) {
    return 0;
  }
  uVar11 = (ulonglong)uVar5;
  pbVar7 = (byte *)(uVar11 + (longlong)(int)(iVar2 * uVar5) + param_1);
  uVar6 = (ulonglong)((param_4[1] - uVar5) - uVar5);
  do {
    if ((longlong)uVar11 < (longlong)(int)(iVar2 - uVar5)) {
      lVar8 = (longlong)(int)(iVar2 - uVar5) - uVar11;
      pbVar3 = pbVar7;
      do {
        if (pbVar3[param_3 - param_1] != 0) {
          uVar4 = (int)((uint)*pbVar3 - (uint)pbVar3[param_2 - param_1]) >> 0x1f;
          uVar10 = uVar10 + (((uint)*pbVar3 - (uint)pbVar3[param_2 - param_1] ^ uVar4) - uVar4);
          iVar9 = iVar9 + 1;
        }
        pbVar3 = pbVar3 + 1;
        lVar8 = lVar8 + -1;
      } while (lVar8 != 0);
    }
    pbVar7 = pbVar7 + iVar2;
    uVar6 = uVar6 - 1;
  } while (uVar6 != 0);
  if (iVar9 == 0) {
    return (ulonglong)uVar10;
  }
  return (longlong)(int)((iVar9 >> 1) + uVar10) / (longlong)iVar9 & 0xffffffff;
}



void FUN_18003c110(longlong param_1,longlong param_2,undefined8 *param_3,int param_4,int param_5,
                  int param_6,int param_7)

{
  ushort *puVar1;
  byte bVar2;
  bool bVar3;
  bool bVar4;
  char cVar5;
  int iVar6;
  void *_Memory;
  void *_Memory_00;
  void *pvVar7;
  undefined8 *puVar8;
  char cVar9;
  longlong lVar10;
  char cVar11;
  int iVar12;
  size_t _Size;
  char *pcVar13;
  longlong lVar14;
  int *piVar15;
  int iVar16;
  char *pcVar17;
  int iVar18;
  ushort *puVar19;
  int iVar20;
  longlong lVar21;
  int local_c0 [3];
  undefined8 local_b4;
  int local_ac;
  int local_a8;
  int local_a4;
  int local_a0;
  longlong local_98;
  longlong local_90;
  ushort *local_88;
  longlong local_78;
  void *local_70;
  void *local_68;
  longlong local_60;
  longlong local_58;

  local_c0[1] = param_6;
  local_a8 = param_6;
  local_c0[0] = 0;
  iVar12 = param_4 + param_6 * -2;
  local_b4 = 0;
  iVar20 = param_5 + param_6 * -2;
  local_c0[2] = -param_6;
  local_a4 = 0;
  _Size = SEXT48(iVar20 * iVar12);
  local_ac = local_c0[2];
  local_a0 = iVar20;
  _Memory = malloc(_Size);
  local_68 = _Memory;
  _Memory_00 = malloc(_Size);
  local_70 = _Memory_00;
  iVar16 = iVar20;
  if (param_6 < param_4 - param_6) {
    lVar21 = (longlong)param_5;
    local_58 = lVar21 * 2;
    local_60 = (longlong)iVar20;
    local_90 = (longlong)((param_5 + 1) * param_6);
    local_98 = 0;
    local_88 = (ushort *)(local_90 * 2 + param_1);
    iVar18 = param_6;
    do {
      if (param_6 < param_5 - param_6) {
        pcVar13 = (char *)(local_98 + (longlong)_Memory_00);
        local_78 = ((local_90 - local_98) - (longlong)_Memory) + param_2;
        pvVar7 = (void *)((longlong)_Memory - (longlong)_Memory_00);
        puVar19 = local_88;
        iVar16 = param_6;
        do {
          cVar9 = '\x01';
          cVar11 = '\0';
          lVar14 = 0;
          bVar4 = true;
          do {
            lVar10 = (longlong)
                     ((local_c0[lVar14 * 2] + iVar18) * param_5 + local_c0[lVar14 * 2 + 1] + iVar16)
            ;
            bVar3 = false;
            if (*(char *)(lVar10 + param_2) != '\0') {
              bVar3 = bVar4;
            }
            puVar1 = (ushort *)(param_1 + lVar10 * 2);
            cVar5 = '\0';
            if (*puVar19 <= *puVar1 && *puVar1 != *puVar19) {
              cVar5 = cVar9;
            }
            cVar9 = cVar9 * '\x02';
            cVar11 = cVar11 + cVar5;
            lVar14 = lVar14 + 1;
            bVar4 = bVar3;
          } while (lVar14 < 4);
          pcVar13[(longlong)pvVar7] = cVar11 + '\x01';
          cVar9 = (pcVar13 + (longlong)pvVar7)[local_78];
          if (!bVar3) {
            cVar9 = '\0';
          }
          *pcVar13 = cVar9;
          iVar16 = iVar16 + 1;
          pcVar13 = pcVar13 + 1;
          puVar19 = puVar19 + 1;
          _Memory = local_68;
        } while (iVar16 < param_5 - param_6);
      }
      local_90 = local_90 + lVar21;
      local_88 = local_88 + lVar21;
      iVar18 = iVar18 + 1;
      local_98 = local_98 + iVar20;
      iVar16 = local_a0;
    } while (iVar18 < param_4 - param_6);
  }
  if (param_3 != (undefined8 *)0x0) {
    lVar21 = 0x40;
    puVar8 = param_3;
    do {
      *puVar8 = 0;
      puVar8[1] = 0;
      puVar8[2] = 0;
      puVar8[3] = 0;
      puVar8[4] = 0;
      puVar8[5] = 0;
      puVar8[6] = 0;
      puVar8[7] = 0;
      lVar21 = lVar21 + -1;
      puVar8 = puVar8 + 8;
    } while (lVar21 != 0);
  }
  local_c0[2] = -param_7;
  local_c0[0] = 0;
  local_a8 = local_c0[2];
  local_a4 = local_c0[2];
  iVar12 = iVar12 - param_7;
  local_c0[1] = param_7;
  local_b4 = CONCAT44(local_c0[2],param_7);
  local_ac = 0;
  if (param_7 < iVar12) {
    pcVar13 = (char *)((longlong)((iVar16 + 1) * param_7) + (longlong)_Memory_00);
    iVar20 = param_7;
    do {
      if (param_7 < iVar16 - param_7) {
        pcVar17 = pcVar13;
        iVar18 = param_7;
        do {
          bVar2 = pcVar17[(longlong)((longlong)_Memory - (longlong)_Memory_00)];
          if (*pcVar17 != '\0') {
            piVar15 = local_c0 + 1;
            iVar6 = 0;
            do {
              lVar21 = (longlong)((piVar15[-1] + iVar20) * iVar16 + *piVar15 + iVar18);
              if (*(char *)(lVar21 + (longlong)_Memory_00) != '\0') {
                puVar8 = (undefined8 *)
                         ((longlong)param_3 +
                         (longlong)
                         (int)((*(byte *)(lVar21 + (longlong)_Memory) - 0x11) + iVar6 +
                              (uint)bVar2 * 0x10) * 4);
                *(int *)puVar8 = *(int *)puVar8 + 1;
              }
              iVar6 = iVar6 + 0x100;
              piVar15 = piVar15 + 2;
            } while (iVar6 < 0x400);
          }
          iVar18 = iVar18 + 1;
          pcVar17 = pcVar17 + 1;
        } while (iVar18 < iVar16 - param_7);
      }
      pcVar13 = pcVar13 + iVar16;
      iVar20 = iVar20 + 1;
    } while (iVar20 < iVar12);
  }
  free(_Memory);
                    // WARNING: Could not recover jumptable at 0x00018003c4f2. Too many branches
                    // WARNING: Treating indirect jump as call
  free(_Memory_00);
  return;
}



void FUN_18003c500(longlong param_1,longlong param_2,undefined8 *param_3,int param_4,int param_5)

{
  FUN_18003c110(param_1,param_2,param_3,param_4,param_5,1,2);
  FUN_18003c110(param_1,param_2,param_3 + 0x200,param_4,param_5,2,4);
  FUN_18003c110(param_1,param_2,param_3 + 0x400,param_4,param_5,4,8);
  return;
}



void FUN_18003c5b0(undefined2 *param_1,longlong param_2,longlong param_3,uint param_4,int param_5)

{
  undefined2 *puVar1;
  byte *pbVar2;
  int *piVar3;
  byte bVar4;
  undefined2 uVar5;
  size_t _Size;
  bool bVar6;
  bool bVar7;
  void *_Memory;
  void *_Memory_00;
  longlong lVar8;
  longlong lVar9;
  longlong lVar10;
  longlong lVar11;
  longlong lVar12;
  short *psVar13;
  int iVar14;
  longlong lVar15;
  undefined2 *puVar16;
  longlong lVar17;
  int iVar18;
  longlong lVar19;
  ushort *puVar20;
  int iVar21;
  int iVar22;
  longlong lVar23;
  int iVar24;
  longlong lVar25;
  byte *pbVar26;
  undefined2 *puVar27;
  short *psVar28;
  int iVar29;
  longlong lVar30;
  ulonglong uVar31;
  int local_res20;
  longlong local_100;
  longlong local_f8;
  undefined2 *local_e8;

  lVar23 = (longlong)param_5;
  uVar31 = (ulonglong)param_4;
  iVar21 = param_5 + 10;
  _Size = (longlong)(int)((param_4 + 10) * iVar21) * 2;
  _Memory = malloc(_Size);
  _Memory_00 = malloc(_Size);
  if (0 < (int)param_4) {
    iVar22 = (param_5 + 0xb) * 5;
    puVar16 = param_1;
    lVar30 = param_2;
    do {
      if (0 < lVar23) {
        lVar19 = 0;
        puVar27 = puVar16;
        iVar24 = iVar22;
        do {
          lVar8 = (longlong)iVar24;
          iVar24 = iVar24 + 1;
          *(undefined2 *)(lVar8 * 2 + (longlong)_Memory) = *puVar27;
          pbVar26 = (byte *)(lVar30 + lVar19);
          lVar19 = lVar19 + 1;
          *(ushort *)(lVar8 * 2 + (longlong)_Memory_00) = (ushort)*pbVar26;
          puVar27 = puVar27 + 1;
        } while (lVar19 < lVar23);
      }
      iVar22 = iVar22 + iVar21;
      puVar16 = puVar16 + lVar23;
      lVar30 = lVar30 + lVar23;
      uVar31 = uVar31 - 1;
    } while (uVar31 != 0);
  }
  lVar30 = (longlong)iVar21;
  lVar19 = 0;
  iVar14 = (param_4 - 5) * param_5;
  iVar18 = (param_4 + 5) * iVar21;
  local_100 = 0;
  local_f8 = 5;
  iVar22 = iVar14;
  iVar24 = iVar18;
  local_e8 = param_1;
  do {
    if (0 < lVar23) {
      iVar29 = iVar24 + 5;
      lVar25 = 0;
      lVar8 = ((local_100 - lVar19) * 2 + 10) - (longlong)param_1;
      puVar16 = local_e8;
      do {
        lVar15 = (longlong)((iVar22 - iVar24) + -5 + iVar29);
        puVar27 = puVar16 + 1;
        *(undefined2 *)((longlong)_Memory + lVar8 + -2 + (longlong)puVar27) = param_1[lVar15];
        lVar9 = (longlong)iVar29;
        iVar29 = iVar29 + 1;
        *(undefined2 *)(lVar9 * 2 + (longlong)_Memory) = *puVar16;
        *(ushort *)((longlong)_Memory_00 + lVar8 + -2 + (longlong)puVar27) =
             (ushort)*(byte *)(lVar15 + param_2);
        lVar15 = lVar19 + lVar25;
        lVar25 = lVar25 + 1;
        *(ushort *)(lVar9 * 2 + (longlong)_Memory_00) = (ushort)*(byte *)(lVar15 + param_2);
        puVar16 = puVar27;
      } while (lVar25 < lVar23);
    }
    local_e8 = local_e8 + lVar23;
    iVar22 = iVar22 + param_5;
    local_100 = local_100 + lVar30;
    iVar24 = iVar24 + iVar21;
    lVar19 = lVar19 + lVar23;
    local_f8 = local_f8 + -1;
  } while (local_f8 != 0);
  iVar22 = 0;
  lVar8 = (longlong)(param_5 + -5);
  lVar19 = lVar8;
  puVar16 = param_1;
  do {
    if (0 < (int)param_4) {
      pbVar26 = (byte *)((param_2 - lVar8) + lVar19);
      iVar24 = iVar22 + (param_5 + 10) * 5;
      lVar15 = (longlong)(param_5 + 5 + iVar24);
      lVar25 = iVar24 - lVar15;
      puVar20 = (ushort *)((longlong)_Memory_00 + lVar15 * 2);
      uVar31 = (ulonglong)param_4;
      puVar27 = puVar16;
      do {
        *(undefined2 *)((lVar25 * 2 - (longlong)_Memory_00) + (longlong)_Memory + (longlong)puVar20)
             = puVar27[lVar8];
        uVar5 = *puVar27;
        puVar27 = puVar27 + lVar23;
        *(undefined2 *)((longlong)((longlong)_Memory - (longlong)_Memory_00) + (longlong)puVar20) =
             uVar5;
        puVar20[lVar25] = (ushort)pbVar26[lVar8];
        bVar4 = *pbVar26;
        pbVar26 = pbVar26 + lVar23;
        *puVar20 = (ushort)bVar4;
        puVar20 = puVar20 + lVar30;
        uVar31 = uVar31 - 1;
      } while (uVar31 != 0);
    }
    puVar16 = puVar16 + 1;
    lVar19 = lVar19 + 1;
    iVar22 = iVar22 + 1;
  } while (iVar22 < 5);
  puVar16 = param_1 + lVar8;
  local_e8 = (undefined2 *)0x5;
  lVar25 = (longlong)(iVar18 + 5 + param_5);
  lVar15 = (longlong)(param_5 + 5);
  lVar19 = lVar25;
  do {
    lVar9 = (lVar8 - lVar25) + lVar19;
    puVar20 = (ushort *)
              (((lVar25 - lVar8) * 2 - (longlong)param_1) + (longlong)_Memory_00 + (longlong)puVar16
              );
    pbVar26 = (byte *)(param_2 + (lVar8 - lVar25) + lVar19);
    lVar10 = (lVar19 - lVar25) - lVar19;
    lVar11 = (((int)((param_4 - 4) * param_5 + -5) - lVar25) - lVar9) + lVar19;
    lVar12 = ((iVar14 - lVar25) - lVar9) + lVar19;
    lVar9 = (lVar19 - lVar25) - lVar9;
    lVar17 = 5;
    puVar27 = puVar16;
    do {
      *(undefined2 *)((lVar10 * 2 - (longlong)_Memory_00) + (longlong)_Memory + (longlong)puVar20) =
           puVar27[lVar11];
      *(undefined2 *)
       ((longlong)puVar20 + ((lVar15 - lVar25) * 2 - (longlong)_Memory_00) + (longlong)_Memory) =
           puVar27[lVar12];
      *(undefined2 *)
       (((iVar18 - lVar25) * 2 - (longlong)_Memory_00) + (longlong)_Memory + (longlong)puVar20) =
           *puVar27;
      puVar1 = puVar27 + lVar9;
      puVar27 = puVar27 + lVar23;
      *(undefined2 *)((longlong)((longlong)_Memory - (longlong)_Memory_00) + (longlong)puVar20) =
           *puVar1;
      puVar20[lVar10] = (ushort)pbVar26[lVar11];
      puVar20[lVar15 - lVar25] = (ushort)pbVar26[lVar12];
      puVar20[iVar18 - lVar25] = (ushort)*pbVar26;
      pbVar2 = pbVar26 + lVar9;
      pbVar26 = pbVar26 + lVar23;
      *puVar20 = (ushort)*pbVar2;
      puVar20 = puVar20 + lVar30;
      lVar17 = lVar17 + -1;
    } while (lVar17 != 0);
    lVar19 = lVar19 + 1;
    puVar16 = puVar16 + 1;
    local_e8 = (undefined2 *)((longlong)local_e8 + -1);
  } while (local_e8 != (undefined2 *)0x0);
  if (5 < (int)(param_4 + 5)) {
    local_res20 = 0;
    uVar31 = (ulonglong)param_4;
    psVar28 = (short *)((longlong)_Memory_00 + ((longlong)(iVar21 * 5) + 5) * 2);
    do {
      param_5 = 5;
      if (5 < lVar15) {
        local_f8 = lVar15 + -5;
        psVar13 = psVar28;
        do {
          iVar24 = 0;
          bVar6 = true;
          iVar22 = 1;
          if (*psVar13 != 0) {
            lVar23 = 0x533;
            do {
              lVar19 = 0;
              iVar14 = local_res20 + param_5 + -5;
              lVar8 = -0x37;
              bVar7 = bVar6;
              do {
                lVar25 = -5;
                iVar18 = iVar14;
                do {
                  lVar9 = (longlong)iVar18;
                  bVar6 = false;
                  if (*(short *)((longlong)_Memory_00 + lVar9 * 2) == 0) break;
                  iVar18 = iVar18 + 1;
                  lVar10 = lVar23 + lVar8 + lVar25;
                  lVar25 = lVar25 + 1;
                  lVar19 = lVar19 + (int)(*(int *)(&DAT_1800a2700 + lVar10 * 4) *
                                         (uint)*(ushort *)((longlong)_Memory + lVar9 * 2));
                  bVar6 = bVar7;
                } while (lVar25 < 6);
                iVar14 = iVar14 + iVar21;
                lVar8 = lVar8 + 0xb;
                bVar7 = bVar6;
              } while (lVar8 < 0x38);
              iVar14 = 0;
              if (0 < lVar19) {
                iVar14 = iVar22;
              }
              iVar22 = iVar22 * 2;
              iVar24 = iVar24 + iVar14;
              lVar23 = lVar23 + -0x79;
            } while (-1 < lVar23);
            if (bVar6) {
              piVar3 = (int *)(param_3 + (longlong)iVar24 * 4);
              *piVar3 = *piVar3 + 1;
            }
          }
          param_5 = param_5 + 1;
          psVar13 = psVar13 + 1;
          local_f8 = local_f8 + -1;
        } while (local_f8 != 0);
      }
      psVar28 = psVar28 + lVar30;
      local_res20 = local_res20 + iVar21;
      uVar31 = uVar31 - 1;
    } while (uVar31 != 0);
  }
  free(_Memory);
                    // WARNING: Could not recover jumptable at 0x00018003ccdf. Too many branches
                    // WARNING: Treating indirect jump as call
  free(_Memory_00);
  return;
}



void FUN_18003ccf0(longlong param_1,LPCWSTR param_2)

{
  int iVar1;
  LSTATUS LVar2;
  DWORD dwIndex;
  uint local_248 [2];
  HKEY local_240;
  DWORD local_238;
  DWORD local_234 [3];
  WCHAR local_228 [264];
  ulonglong local_18;

  local_18 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffd58;
  dwIndex = 0;
  local_248[0] = 0;
  local_240 = (HKEY)0x0;
  local_238 = 0;
  if (param_1 == -0x7ffffffe) {
    iVar1 = RegOpenKeyExW((HKEY)0xffffffff80000002,param_2,0,0x20019,(PHKEY)&local_240);
joined_r0x00018003cd9a:
    if (iVar1 != 0) goto LAB_18003ce39;
  }
  else {
    if (param_1 == -0x7fffffff) {
      LVar2 = RegOpenCurrentUser(0x20019,(PHKEY)&local_240);
      if (LVar2 != 0) goto LAB_18003ce39;
      iVar1 = RegOpenKeyExW(local_240,param_2,0,0x20019,(PHKEY)&local_240);
      goto joined_r0x00018003cd9a;
    }
  }
  RegQueryInfoKeyW(local_240,(LPWSTR)0x0,(LPDWORD)0x0,(LPDWORD)0x0,local_248,&local_238,(LPDWORD)0x0
                   ,(LPDWORD)0x0,(LPDWORD)0x0,(LPDWORD)0x0,(LPDWORD)0x0,(PFILETIME)0x0);
  if (local_248[0] != 0) {
    do {
      local_234[0] = 0x104;
      RegEnumKeyExW(local_240,dwIndex,local_228,local_234,(LPDWORD)0x0,(LPWSTR)0x0,(LPDWORD)0x0,
                    (PFILETIME)0x0);
      dwIndex = dwIndex + 1;
    } while (dwIndex < local_248[0]);
  }
  RegCloseKey(local_240);
LAB_18003ce39:
  FUN_18005f100(local_18 ^ (ulonglong)&stack0xfffffffffffffd58);
  return;
}



LPBYTE FUN_18003ce60(HKEY param_1,LPCWSTR param_2,DWORD *param_3,LPBYTE *param_4,uint *param_5)

{
  LSTATUS LVar1;
  LPBYTE lpData;
  uint local_res20 [2];
  DWORD local_18 [4];

  if (param_4 != (LPBYTE *)0x0) {
    local_res20[0] = 0;
    LVar1 = RegQueryValueExW(param_1,param_2,(LPDWORD)0x0,local_18,(LPBYTE)0x0,local_res20);
    if (LVar1 == 0) {
      *param_4 = (LPBYTE)0x0;
      lpData = (LPBYTE)calloc(1,(ulonglong)local_res20[0]);
      *param_4 = lpData;
      LVar1 = RegQueryValueExW(param_1,param_2,(LPDWORD)0x0,local_18,lpData,local_res20);
      if (LVar1 == 0) {
        if (param_3 != (DWORD *)0x0) {
          *param_3 = local_18[0];
        }
        if (param_5 != (uint *)0x0) {
          *param_5 = local_res20[0];
        }
        return *param_4;
      }
      free(*param_4);
    }
  }
  return (LPBYTE)0x0;
}



LPBYTE FUN_18003cf30(longlong param_1,LPCWSTR param_2,LPCWSTR param_3,DWORD *param_4,LPBYTE *param_5
                    ,uint *param_6)

{
  LPBYTE *ppBVar1;
  HKEY hKey;
  int iVar2;
  LSTATUS LVar3;
  LPBYTE lpData;
  uint local_res8 [2];
  DWORD local_28 [2];
  HKEY local_20;

  local_20 = (HKEY)0x0;
  if (param_1 == -0x7ffffffe) {
    iVar2 = RegOpenKeyExW((HKEY)0xffffffff80000002,param_2,0,1,(PHKEY)&local_20);
  }
  else {
    if (param_1 != -0x7fffffff) goto LAB_18003cfc6;
    LVar3 = RegOpenCurrentUser(1,(PHKEY)&local_20);
    if (LVar3 != 0) {
      return (LPBYTE)0x0;
    }
    iVar2 = RegOpenKeyExW(local_20,param_2,0,1,(PHKEY)&local_20);
  }
  if (iVar2 != 0) {
    return (LPBYTE)0x0;
  }
LAB_18003cfc6:
  hKey = local_20;
  ppBVar1 = param_5;
  if (param_5 == (LPBYTE *)0x0) {
    return (LPBYTE)0x0;
  }
  local_res8[0] = 0;
  LVar3 = RegQueryValueExW(local_20,param_3,(LPDWORD)0x0,local_28,(LPBYTE)0x0,local_res8);
  if (LVar3 == 0) {
    *ppBVar1 = (LPBYTE)0x0;
    lpData = (LPBYTE)calloc(1,(ulonglong)local_res8[0]);
    *ppBVar1 = lpData;
    LVar3 = RegQueryValueExW(hKey,param_3,(LPDWORD)0x0,local_28,lpData,local_res8);
    if (LVar3 == 0) {
      if (param_4 != (DWORD *)0x0) {
        *param_4 = local_28[0];
      }
      if (param_6 != (uint *)0x0) {
        *param_6 = local_res8[0];
      }
      return *ppBVar1;
    }
    free(*ppBVar1);
    return (LPBYTE)0x0;
  }
  return (LPBYTE)0x0;
}



void GetLogOutputConfig_FUN_18003d080(void)

{
  HKEY pHVar1;
  LSTATUS LVar2;
  undefined4 *_Src;
  uint local_res8 [2];
  DWORD local_res10 [2];
  HKEY local_res18;

  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"..\\..\\common\\cmtest.c",
             (undefined *)L"Get_LogOutput_config",0x29d,0,(undefined *)L"CONFIG DATA: enter");
  local_res18 = (HKEY)0x0;
  LVar2 = RegOpenKeyExW((HKEY)0xffffffff80000002,L"Software\\Goodix\\FP\\LogOutput\\",0,1,
                        (PHKEY)&local_res18);
  pHVar1 = local_res18;
  _Src = (undefined4 *)0x0;
  if (LVar2 == 0) {
    local_res8[0] = 0;
    LVar2 = RegQueryValueExW(local_res18,L"LogLevel",(LPDWORD)0x0,local_res10,(LPBYTE)0x0,local_res8
                            );
    _Src = (undefined4 *)0x0;
    if (LVar2 == 0) {
      _Src = (undefined4 *)calloc(1,(ulonglong)local_res8[0]);
      LVar2 = RegQueryValueExW(pHVar1,L"LogLevel",(LPDWORD)0x0,local_res10,(LPBYTE)_Src,local_res8);
      if (LVar2 != 0) {
        free(_Src);
      }
      if (_Src != (undefined4 *)0x0) {
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"..\\..\\common\\cmtest.c",
                   (undefined *)L"Get_LogOutput_config",0x2a4,0,
                   (undefined *)L"CONFIG DATA: LogLevel %d");
        DAT_1800af000 = *_Src;
        free(_Src);
        _Src = (undefined4 *)0x0;
      }
    }
  }
  local_res18 = (HKEY)0x0;
  LVar2 = RegOpenKeyExW((HKEY)0xffffffff80000002,L"Software\\Goodix\\FP\\LogOutput\\",0,1,
                        (PHKEY)&local_res18);
  pHVar1 = local_res18;
  if (LVar2 == 0) {
    local_res8[0] = 0;
    LVar2 = RegQueryValueExW(local_res18,L"LogTarget",(LPDWORD)0x0,local_res10,(LPBYTE)0x0,
                             local_res8);
    if (LVar2 == 0) {
      _Src = (undefined4 *)calloc(1,(ulonglong)local_res8[0]);
      LVar2 = RegQueryValueExW(pHVar1,L"LogTarget",(LPDWORD)0x0,local_res10,(LPBYTE)_Src,local_res8)
      ;
      if (LVar2 != 0) {
        free(_Src);
      }
    }
  }
  if (_Src != (undefined4 *)0x0) {
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"..\\..\\common\\cmtest.c",
               (undefined *)L"Get_LogOutput_config",0x2ac,0,
               (undefined *)L"CONFIG DATA: LogTarget %d");
    DAT_1800af004 = *_Src;
    free(_Src);
    _Src = (undefined4 *)0x0;
  }
  local_res18 = (HKEY)0x0;
  LVar2 = RegOpenKeyExW((HKEY)0xffffffff80000002,L"Software\\Goodix\\FP\\LogOutput\\",0,1,
                        (PHKEY)&local_res18);
  pHVar1 = local_res18;
  if (LVar2 == 0) {
    local_res8[0] = 0;
    LVar2 = RegQueryValueExW(local_res18,L"LogPath",(LPDWORD)0x0,local_res10,(LPBYTE)0x0,local_res8)
    ;
    if (LVar2 == 0) {
      _Src = (undefined4 *)calloc(1,(ulonglong)local_res8[0]);
      LVar2 = RegQueryValueExW(pHVar1,L"LogPath",(LPDWORD)0x0,local_res10,(LPBYTE)_Src,local_res8);
      if (LVar2 != 0) {
        free(_Src);
      }
    }
  }
  if (_Src != (undefined4 *)0x0) {
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"..\\..\\common\\cmtest.c",
               (undefined *)L"Get_LogOutput_config",0x2b4,0,(undefined *)L"CONFIG DATA: LogPath %s")
    ;
    wcscpy_s(u_C__ProgramData_Goodix_1800af008,0x103,(wchar_t *)_Src);
    free(_Src);
    return;
  }
  return;
}



void Init_LogOutput_Engine_FUN_18003d3d0(void)

{
  uint local_240;
  uint local_238;
  wchar_t *local_230;
  wchar_t local_228 [264];
  ulonglong local_18;

  local_18 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffd88;
  memset(local_228,0,0x208);
  FUN_18003e610(local_228,0x104,L"%s\\%s",u_C__ProgramData_Goodix_1800af008);
  if (PTR_DAT_1800afca8 != (undefined *)0x0) {
    FUN_18003fbd0(PTR_DAT_1800afca8);
  }
  PTR_DAT_1800afca8 = (undefined *)FUN_18003fa30(L"GFEngine",DAT_1800af000,local_228,DAT_1800af004);
  local_230 = local_228;
  local_238 = DAT_1800af004;
  local_240 = DAT_1800af000;
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"..\\..\\common\\cmtest.c",
             (undefined *)L"Init_LogOutput_Engine",0x2c4,0,
             (undefined *)L"created print object: LogLevel %d, LogTarget %d, fullLogPath %s");
  FUN_18005f100(local_18 ^ (ulonglong)&stack0xfffffffffffffd88);
  return;
}



void FUN_18003d5d0(longlong param_1,int param_2)

{
  longlong lVar1;
  longlong lVar2;

  if (DAT_1800b15b8 != '\0') {
    lVar2 = -1;
    lVar1 = -1;
    do {
      lVar1 = lVar1 + 1;
    } while (*(short *)(&DAT_1800b11a0 + lVar1 * 2) != 0);
    if ((lVar1 != 0) &&
       (FUN_18003db70((wchar_t *)&DAT_1800b11a0,param_1,param_2), DAT_1800b15b8 != '\0')) {
      do {
        lVar2 = lVar2 + 1;
      } while (*(short *)(&DAT_1800b13b0 + lVar2 * 2) != 0);
      if (lVar2 != 0) {
        FUN_18003db70((wchar_t *)&DAT_1800b13b0,param_1,param_2);
      }
    }
  }
  return;
}



void FUN_18003d660(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  longlong lVar1;
  undefined8 local_res10;
  undefined8 local_res18;
  undefined8 local_res20;

  if (DAT_1800b15b8 != '\0') {
    lVar1 = -1;
    do {
      lVar1 = lVar1 + 1;
    } while (*(short *)(&DAT_1800b11a0 + lVar1 * 2) != 0);
    if (lVar1 != 0) {
      local_res10 = param_2;
      local_res18 = param_3;
      local_res20 = param_4;
      FUN_18003dd50((wchar_t *)&DAT_1800b11a0,param_1,&local_res10);
    }
  }
  return;
}



void FUN_18003d720(longlong param_1)

{
  errno_t eVar1;
  longlong lVar2;
  short *psVar3;
  undefined auStack2168 [32];
  uint local_858;
  uint local_850;
  uint local_848;
  longlong local_840;
  FILE *local_838;
  _SYSTEMTIME local_830;
  short local_818 [1024];
  ulonglong local_18;

  if (param_1 != 0) {
    local_18 = DAT_1800b04e8 ^ (ulonglong)auStack2168;
    local_838 = (FILE *)0x0;
    lVar2 = 0x800;
    psVar3 = local_818;
    while (lVar2 != 0) {
      lVar2 = lVar2 + -1;
      *(undefined *)psVar3 = 0;
      psVar3 = (short *)((longlong)psVar3 + 1);
    }
    GetLocalTime((LPSYSTEMTIME)&local_830);
    local_848 = (uint)local_830.wMilliseconds;
    local_850 = (uint)local_830.wSecond;
    local_858 = (uint)local_830.wMinute;
    local_840 = param_1;
    FUN_18003e610(local_818,0x3ff,L"%02d:%02d:%02d.%03d [%s]\n",(ulonglong)local_830.wHour);
    eVar1 = _wfopen_s(&local_838,(wchar_t *)PTR_u_c__fingerprintlog_WbioUXLog_log_1800af260,
                      L"at+,ccs=UTF-8");
    if ((eVar1 == 0) && (local_838 != (FILE *)0x0)) {
      lVar2 = -1;
      do {
        lVar2 = lVar2 + 1;
      } while (local_818[lVar2] != 0);
      fwrite(local_818,lVar2 * 2,1,local_838);
      fclose(local_838);
    }
    FUN_18005f100(local_18 ^ (ulonglong)auStack2168);
  }
  return;
}



void FUN_18003d9a0(longlong param_1)

{
  ulonglong uVar1;

  uVar1 = 0xffffffffffffffff;
  do {
    uVar1 = uVar1 + 1;
  } while (*(short *)(param_1 + uVar1 * 2) != 0);
  if (uVar1 < 0x104) {
    FUN_18003e610(&DAT_1800b11a0,0x103,&DAT_18006e680,param_1);
    return;
  }
  return;
}



void FUN_18003da20(undefined param_1)

{
  DAT_1800b15b8 = param_1;
  return;
}



undefined8 FUN_18003da30(HKEY param_1,LPCWSTR param_2,DWORD param_3,BYTE *param_4,DWORD param_5)

{
  LSTATUS LVar1;

  LVar1 = RegSetValueExW(param_1,param_2,0,param_3,param_4,param_5);
  if (LVar1 != 0) {
    RegCloseKey(param_1);
    return 1;
  }
  RegCloseKey(param_1);
  return 0;
}



ulonglong FUN_18003da80(longlong param_1,LPCWSTR param_2,LPCWSTR param_3,DWORD param_4,BYTE *param_5
                       ,DWORD param_6)

{
  HKEY hKey;
  int iVar1;
  LSTATUS LVar2;
  HKEY local_res8;

  local_res8 = (HKEY)0x0;
  if (param_1 == -0x7ffffffe) {
    iVar1 = RegOpenKeyExW((HKEY)0xffffffff80000002,param_2,0,2,(PHKEY)&local_res8);
  }
  else {
    if (param_1 != -0x7fffffff) goto LAB_18003db19;
    LVar2 = RegOpenCurrentUser(2,(PHKEY)&local_res8);
    if (LVar2 != 0) {
      return 1;
    }
    iVar1 = RegOpenKeyExW(local_res8,param_2,0,2,(PHKEY)&local_res8);
  }
  if (iVar1 != 0) {
    return 1;
  }
LAB_18003db19:
  hKey = local_res8;
  LVar2 = RegSetValueExW(local_res8,param_3,0,param_4,param_5,param_6);
  if (LVar2 == 0) {
    RegCloseKey(hKey);
  }
  else {
    RegCloseKey(hKey);
  }
  return (ulonglong)(LVar2 != 0);
}



void FUN_18003db70(wchar_t *param_1,longlong param_2,int param_3)

{
  size_t _Size;
  int iVar2;
  undefined *puVar3;
  longlong lVar4;
  undefined *local_480;
  FILE *local_478;
  __time64_t local_470;
  tm local_468;
  undefined8 local_438;
  undefined8 local_430;
  undefined8 local_428;
  undefined8 local_420;
  undefined8 local_418;
  undefined8 local_410;
  undefined8 local_408;
  undefined8 local_400;
  undefined local_3f8 [447];
  undefined local_239;
  char local_238 [512];
  ulonglong local_38;
  size_t sVar1;

  if (param_2 != 0) {
    local_38 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffb58;
    if (0 < param_3) {
      lVar4 = 0;
      local_478 = (FILE *)0x0;
      _wfopen_s(&local_478,param_1,L"a+");
      if (local_478 != (FILE *)0x0) {
        memset(local_238,0,0x200);
        memset(local_3f8,0,0x1c0);
        puVar3 = local_3f8;
        iVar2 = 0x1bf;
        if (0 < (longlong)param_3) {
          do {
            if (iVar2 < 4) break;
            FUN_18003dee0(puVar3,(longlong)iVar2,3,"%02x ",*(undefined *)(lVar4 + param_2));
            puVar3 = puVar3 + 3;
            iVar2 = iVar2 + -3;
            lVar4 = lVar4 + 1;
          } while (lVar4 < param_3);
        }
        local_239 = 0;
        local_438 = 0;
        local_430 = 0;
        local_428 = 0;
        local_420 = 0;
        local_418 = 0;
        local_410 = 0;
        local_408 = 0;
        local_400 = 0;
        _time64(&local_470);
        _localtime64_s(&local_468,&local_470);
        strftime((char *)&local_438,0x3f,"%Y/%m/%d %X ",&local_468);
        GetCurrentThreadId();
        local_480 = local_3f8;
        FUN_18003e5b0(local_238,0x1ff,"[%s][TID:%d] %s\n",&local_438);
        sVar1 = 0xffffffffffffffff;
        do {
          _Size = sVar1 + 1;
          lVar4 = sVar1 + 1;
          sVar1 = _Size;
        } while (local_238[lVar4] != '\0');
        fwrite(local_238,_Size,1,local_478);
        fclose(local_478);
      }
    }
    FUN_18005f100(local_38 ^ (ulonglong)&stack0xfffffffffffffb58);
  }
  return;
}



void FUN_18003dd50(wchar_t *param_1,longlong param_2,undefined8 param_3)

{
  longlong lVar1;
  undefined8 *puVar2;
  size_t _Size;
  undefined auStack1256 [32];
  undefined *local_4c8;
  undefined8 local_4c0;
  undefined8 local_4b8;
  FILE *local_4a8;
  __time64_t local_4a0;
  tm local_498;
  undefined8 local_468;
  undefined8 local_460;
  undefined8 local_458;
  undefined8 local_450;
  undefined8 local_448;
  undefined8 local_440;
  undefined8 local_438;
  undefined8 local_430;
  char local_428 [512];
  undefined local_228 [512];
  ulonglong local_28;
  size_t sVar3;

  if (param_2 != 0) {
    local_28 = DAT_1800b04e8 ^ (ulonglong)auStack1256;
    local_4a8 = (FILE *)0x0;
    _wfopen_s(&local_4a8,param_1,L"a+");
    if (local_4a8 != (FILE *)0x0) {
      memset(local_428,0,0x200);
      local_468 = 0;
      local_460 = 0;
      local_458 = 0;
      local_450 = 0;
      local_448 = 0;
      local_440 = 0;
      local_438 = 0;
      local_430 = 0;
      _time64(&local_4a0);
      _localtime64_s(&local_498,&local_4a0);
      strftime((char *)&local_468,0x3f,"%Y/%m/%d %X",&local_498);
      memset(local_228,0,0x200);
      local_4c8 = (undefined *)param_2;
      FUN_18003e5b0(local_228,0x1ff,"[%s] %s\n",&local_468);
      puVar2 = (undefined8 *)FUN_18003ded0();
      local_4c8 = local_228;
      local_4c0 = 0;
      local_4b8 = param_3;
      __stdio_common_vsnprintf_s(*puVar2,local_428,0x1ff);
      sVar3 = 0xffffffffffffffff;
      do {
        _Size = sVar3 + 1;
        lVar1 = sVar3 + 1;
        sVar3 = _Size;
      } while (local_428[lVar1] != '\0');
      fwrite(local_428,_Size,1,local_4a8);
      fclose(local_4a8);
    }
    FUN_18005f100(local_28 ^ (ulonglong)auStack1256);
  }
  return;
}



undefined * FUN_18003ded0(void)

{
  return &DAT_180106d48;
}



ulonglong FUN_18003dee0(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
                       undefined param_5)

{
  uint uVar1;
  undefined8 *puVar2;
  ulonglong uVar3;

  puVar2 = (undefined8 *)FUN_18003ded0();
  uVar1 = __stdio_common_vsnprintf_s(*puVar2,param_1,param_2,param_3,param_4,0,&param_5);
  uVar3 = (ulonglong)uVar1;
  if ((int)uVar1 < 0) {
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



undefined8
FUN_18003e150(longlong param_1,int param_2,longlong param_3,undefined param_4,undefined4 param_5,
             undefined4 param_6)

{
  if (((param_1 != 0) && (param_3 != 0)) && (0 < param_2)) {
    FUN_18003e610(param_1,(longlong)param_2,L"%s\\%d.c%d.q%d.bmp",param_3);
    return 0;
  }
  return 0xffffffff;
}



undefined8
FUN_18003e1a0(longlong param_1,int param_2,longlong param_3,int param_4,undefined8 param_5,
             int param_6)

{
  wchar_t *pwVar1;

  if (((param_1 == 0) || (param_3 == 0)) || (param_2 < 1)) {
    return 0xffffffff;
  }
  if (param_4 == 0x80) {
    if (*(char *)(param_3 + 4) == '\0') {
      FUN_18003e610(param_1,(longlong)param_2,L"%s\\goodix_%05d_%s_%02d.csv",param_3 + 0xc);
      FUN_18003e610(param_5,(longlong)param_6,L"goodix_%05d_%s_%02d.csv",
                    (ulonglong)*(uint *)(param_3 + 8));
      return 0;
    }
    FUN_18003e610(param_1,(longlong)param_2,L"%s\\goodix_%05d_%s_%02d_%02d.csv",param_3 + 0xc);
    pwVar1 = L"goodix_%05d_%s_%02d_%02d.csv";
  }
  else {
    if (param_4 != 0x40) {
      return 0;
    }
    if (*(char *)(param_3 + 4) == '\0') {
      FUN_18003e610(param_1,(longlong)param_2,L"%s\\goodix_%05d_%s_%02d.dat",param_3 + 0x20c);
      FUN_18003e610(param_5,(longlong)param_6,L"goodix_%05d_%s_%02d.dat",
                    (ulonglong)*(uint *)(param_3 + 8));
      return 0;
    }
    FUN_18003e610(param_1,(longlong)param_2,L"%s\\goodix_%05d_%s_%02d_%02d.dat",param_3 + 0x20c);
    pwVar1 = L"goodix_%05d_%s_%02d_%02d.dat";
  }
  FUN_18003e610(param_5,(longlong)param_6,pwVar1,(ulonglong)*(uint *)(param_3 + 8));
  return 0;
}



undefined8 FUN_18003e3c0(int *param_1)

{
  ulonglong uVar1;
  int iVar2;
  _FILETIME local_res8 [4];

  if (param_1 != (int *)0x0) {
    GetSystemTimeAsFileTime((LPFILETIME)local_res8);
    uVar1 = ((longlong)local_res8[0] + 0xffd6a169b779c000U) / 10;
    iVar2 = (int)(uVar1 / 1000000);
    *param_1 = iVar2;
    param_1[1] = (int)uVar1 + iVar2 * -1000000;
  }
  return 0;
}



undefined8 FUN_18003e430(wchar_t *param_1,void *param_2,ulonglong param_3,wchar_t *param_4)

{
  FILE *local_res10 [3];

  if (param_2 != (void *)0x0) {
    local_res10[0] = (FILE *)0x0;
    _wfopen_s(local_res10,param_1,param_4);
    if (local_res10[0] != (FILE *)0x0) {
      fread_s(param_2,param_3 & 0xffffffff,1,param_3 & 0xffffffff,local_res10[0]);
      fclose(local_res10[0]);
      return 0;
    }
  }
  return 0xffffffff;
}



undefined8
FUN_18003e4b0(wchar_t *param_1,void *param_2,uint param_3,void *param_4,uint param_5,void *param_6,
             void *param_7,wchar_t *param_8)

{
  FILE *local_res10;

  if ((param_2 != (void *)0x0) && (param_4 != (void *)0x0)) {
    local_res10 = (FILE *)0x0;
    _wfopen_s(&local_res10,param_1,param_8);
    if (local_res10 != (FILE *)0x0) {
      fread_s(param_6,2,1,2,local_res10);
      fread_s(param_7,2,1,2,local_res10);
      fread_s(param_2,(ulonglong)param_3,1,(ulonglong)param_3,local_res10);
      fread_s(param_4,(ulonglong)param_5,1,(ulonglong)param_5,local_res10);
      fclose(local_res10);
      return 0;
    }
  }
  return 0xffffffff;
}



ulonglong FUN_18003e5b0(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  uint uVar1;
  undefined8 *puVar2;
  ulonglong uVar3;
  undefined8 local_res20;

  local_res20 = param_4;
  puVar2 = (undefined8 *)FUN_18003ded0();
  uVar1 = __stdio_common_vsprintf_s(*puVar2,param_1,param_2,param_3,0,&local_res20);
  uVar3 = (ulonglong)uVar1;
  if ((int)uVar1 < 0) {
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



ulonglong FUN_18003e610(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  uint uVar1;
  undefined8 *puVar2;
  ulonglong uVar3;
  undefined8 local_res20;

  local_res20 = param_4;
  puVar2 = (undefined8 *)FUN_18003ded0();
  uVar1 = __stdio_common_vswprintf_s(*puVar2,param_1,param_2,param_3,0,&local_res20);
  uVar3 = (ulonglong)uVar1;
  if ((int)uVar1 < 0) {
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



undefined8 FUN_18003e670(wchar_t *param_1,void *param_2,ulonglong param_3,wchar_t *param_4)

{
  FILE *local_res10 [3];

  if (param_2 != (void *)0x0) {
    local_res10[0] = (FILE *)0x0;
    _wfopen_s(local_res10,param_1,param_4);
    if (local_res10[0] != (FILE *)0x0) {
      fwrite(param_2,1,param_3 & 0xffffffff,local_res10[0]);
      fclose(local_res10[0]);
      return 0;
    }
  }
  return 0xffffffff;
}



undefined8
FUN_18003e6e0(wchar_t *param_1,void *param_2,uint param_3,void *param_4,uint param_5,
             undefined8 param_6,undefined8 param_7,wchar_t *param_8)

{
  FILE *local_res10;

  if ((param_2 != (void *)0x0) && (param_4 != (void *)0x0)) {
    local_res10 = (FILE *)0x0;
    _wfopen_s(&local_res10,param_1,param_8);
    if (local_res10 != (FILE *)0x0) {
      fwrite(&param_6,1,2,local_res10);
      fwrite(&param_7,1,2,local_res10);
      fwrite(param_2,1,(ulonglong)param_3,local_res10);
      fwrite(param_4,1,(ulonglong)param_5,local_res10);
      fclose(local_res10);
      return 0;
    }
  }
  return 0xffffffff;
}



ulonglong FUN_18003e7c0(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  uint uVar1;
  undefined8 *puVar2;
  ulonglong uVar3;
  undefined8 local_res18;
  undefined8 local_res20;

  local_res18 = param_3;
  local_res20 = param_4;
  puVar2 = (undefined8 *)FUN_18003ded0();
  uVar1 = __stdio_common_vswprintf(*puVar2,param_1,0xffffffffffffffff,param_2,0,&local_res18);
  uVar3 = (ulonglong)uVar1;
  if ((int)uVar1 < 0) {
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



ulonglong FUN_18003f450(void)

{
  byte *local_res8 [4];

  local_res8[0] = (byte *)0x0;
  FUN_18003cf30(-0x7ffffffe,L"Software\\Goodix\\FP\\DataDump\\",L"EngineDumpSwitch",(DWORD *)0x0,
                local_res8,(uint *)0x0);
  if (local_res8[0] != (byte *)0x0) {
    DAT_1800af268 = *local_res8[0];
    free(local_res8[0]);
  }
  return (ulonglong)DAT_1800af268;
}



ulonglong FUN_18003f4e0(char *param_1)

{
  errno_t eVar1;

  eVar1 = _access_s(param_1,0);
  return (ulonglong)(eVar1 == 0);
}



ulonglong FUN_18003f500(wchar_t *param_1)

{
  errno_t eVar1;

  eVar1 = _waccess_s(param_1,0);
  return (ulonglong)(eVar1 == 0);
}



ulonglong FUN_18003f520(LPCWSTR param_1,LPDWORD param_2,PHKEY param_3)

{
  LSTATUS LVar1;

  LVar1 = RegCreateKeyExW((HKEY)0xffffffff80000002,param_1,0,(LPWSTR)0x0,0,2,
                          (LPSECURITY_ATTRIBUTES)0x0,param_3,param_2);
  return (ulonglong)(LVar1 == 0);
}



ulonglong FUN_18003f5b0(HKEY param_1,LPCWSTR param_2,BYTE *param_3)

{
  LSTATUS LVar1;
  longlong lVar2;

  lVar2 = -1;
  do {
    lVar2 = lVar2 + 1;
  } while (*(short *)(param_3 + lVar2 * 2) != 0);
  LVar1 = RegSetValueExW(param_1,param_2,0,1,param_3,(int)lVar2 * 2);
  return (ulonglong)(LVar1 == 0);
}



void FUN_18003f970(LPCWSTR param_1,DWORD *param_2,DWORD *param_3)

{
  HANDLE hFindFile;
  undefined auStack648 [32];
  byte local_268;
  DWORD local_24c;
  DWORD local_248;
  ulonglong local_18;

  local_18 = DAT_1800b04e8 ^ (ulonglong)auStack648;
  hFindFile = FindFirstFileW(param_1,(LPWIN32_FIND_DATAW)&local_268);
  if ((longlong)hFindFile - 1U < 0xfffffffffffffffe) {
    if ((local_268 & 0x10) == 0) {
      *param_2 = local_248;
      if (param_3 != (DWORD *)0x0) {
        *param_3 = local_24c;
      }
      FindClose(hFindFile);
    }
    else {
      FindClose(hFindFile);
    }
  }
  FUN_18005f100(local_18 ^ (ulonglong)auStack648);
  return;
}



void FUN_18003fa10(void)

{
  if (*(HANDLE *)(PTR_DAT_1800afca8 + 0x348) != (HANDLE)0x0) {
                    // WARNING: Could not recover jumptable at 0x00018003fa23. Too many branches
                    // WARNING: Treating indirect jump as call
    FlushFileBuffers(*(HANDLE *)(PTR_DAT_1800afca8 + 0x348));
    return;
  }
  return;
}



void FUN_18003fa30(wchar_t *param_1,uint param_2,wchar_t *param_3,uint param_4)

{
  BOOL BVar1;
  DWORD DVar2;
  HANDLE hHeap;
  wchar_t *pwVar3;
  short *psVar4;
  uint uVar5;
  undefined auStack616 [32];
  wchar_t local_248;
  short local_246;
  short local_242 [261];
  ulonglong local_38;

  local_38 = DAT_1800b04e8 ^ (ulonglong)auStack616;
  uVar5 = 9;
  if (param_2 < 10) {
    uVar5 = param_2;
  }
  if (((param_4 & 1) == 0) || ((param_3 != (wchar_t *)0x0 && (*param_3 != L'\0')))) {
    hHeap = GetProcessHeap();
    pwVar3 = (wchar_t *)HeapAlloc(hHeap,8,0x350);
    if (pwVar3 != (wchar_t *)0x0) {
      if (param_1 != (wchar_t *)0x0) {
        wcscpy_s(pwVar3,0x80,param_1);
      }
      *(uint *)(pwVar3 + 0x80) = uVar5;
      if (param_3 != (wchar_t *)0x0) {
        wcscpy_s(pwVar3 + 0x82,0x104,param_3);
      }
      *(uint *)(pwVar3 + 0x186) = param_4;
      InitializeCriticalSection((LPCRITICAL_SECTION)(pwVar3 + 0x18c));
      *(undefined *)(pwVar3 + 0x1a0) = 1;
      if ((param_4 & 1) != 0) {
        pwVar3 = pwVar3 + 0x82;
        memset(&local_248,0,0x208);
        if (((pwVar3 != (wchar_t *)0x0) && (*pwVar3 != L'\0')) &&
           (wcscpy_s(&local_248,0x104,pwVar3), local_246 == 0x3a)) {
          psVar4 = local_242;
          while (local_242[0] != 0) {
            if ((*psVar4 == 0x5c) || (*psVar4 == 0x2f)) {
              *psVar4 = 0;
              BVar1 = CreateDirectoryW(&local_248,(LPSECURITY_ATTRIBUTES)0x0);
              if ((BVar1 == 0) && (DVar2 = GetLastError(), DVar2 != 0xb7)) break;
              *psVar4 = 0x5c;
            }
            psVar4 = psVar4 + 1;
            local_242[0] = *psVar4;
          }
        }
      }
    }
  }
  FUN_18005f100(local_38 ^ (ulonglong)auStack616);
  return;
}



void FUN_18003fbd0(undefined *param_1)

{
  HANDLE hHeap;

  if (((param_1 != (undefined *)0x0) && (param_1 != &DAT_1800af600)) && (param_1 != &DAT_1800af950))
  {
    if ((longlong)*(HANDLE *)(param_1 + 0x348) - 1U < 0xfffffffffffffffe) {
      CloseHandle(*(HANDLE *)(param_1 + 0x348));
    }
    param_1[0x340] = 0;
    DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x318));
    hHeap = GetProcessHeap();
    HeapFree(hHeap,0,param_1);
  }
  return;
}



void debug_print_FUN_18003fc70
               (longlong param_1,uint param_2,undefined *param_3,undefined *param_4,
               undefined4 param_5,uint param_6,undefined *param_7)

{
  uint uVar1;
  LPCWSTR lpOutputString;
  HANDLE hHeap;
  undefined *puVar2;
  undefined4 in_register_00000014;
  ulonglong uVar3;
  undefined *puVar4;
  longlong lVar5;
  undefined *puVar6;

  uVar3 = CONCAT44(in_register_00000014,param_2);
  if (param_1 == 0) {
    return;
  }
  if (param_2 == 0) {
    if (param_6 == 0) {
      return;
    }
    uVar1 = param_6 >> 0x1e;
    if (param_6 >> 0x1e == 0) {
      uVar3 = 6;
    }
    else {
      if (uVar1 != 1) {
        if (uVar1 == 2) {
          uVar3 = 5;
          goto LAB_18003fcca;
        }
        if (uVar1 == 3) {
          uVar3 = 4;
          goto LAB_18003fcca;
        }
      }
      uVar3 = 7;
    }
  }
LAB_18003fcca:
  if ((uint)uVar3 < *(uint *)(param_1 + 0x100) || (uint)uVar3 == *(uint *)(param_1 + 0x100)) {
    puVar4 = &DAT_18006f38c;
    if (param_3 != (undefined *)0x0) {
      puVar4 = param_3;
    }
    puVar6 = &DAT_18006f38c;
    if (param_4 != (undefined *)0x0) {
      puVar6 = param_4;
    }
    puVar2 = &DAT_18006f38c;
    if (param_7 != (undefined *)0x0) {
      puVar2 = param_7;
    }
    lpOutputString =
         (LPCWSTR)FUN_180040310(param_1,uVar3,(longlong)puVar4,(longlong)puVar6,param_5,puVar2,
                                (ulonglong)&stack0x00000040);
    if (lpOutputString != (LPCWSTR)0x0) {
      if ((*(byte *)(param_1 + 0x30c) & 2) != 0) {
        FUN_1800405c0(lpOutputString,uVar3,puVar4,puVar6);
      }
      if ((*(byte *)(param_1 + 0x30c) & 4) != 0) {
        OutputDebugStringW(lpOutputString);
      }
      if ((*(byte *)(param_1 + 0x30c) & 1) != 0) {
        lVar5 = -1;
        do {
          lVar5 = lVar5 + 1;
        } while (lpOutputString[lVar5] != L'\0');
        FUN_180040090(param_1,lpOutputString,lVar5 * 2);
      }
      hHeap = GetProcessHeap();
      HeapFree(hHeap,0,lpOutputString);
    }
  }
  return;
}



void FUN_180040090(longlong param_1,LPCVOID param_2,longlong param_3)

{
  LPCWSTR lpFileName;
  BOOL BVar1;
  HANDLE pvVar2;
  DWORD local_398 [4];
  undefined local_388 [320];
  WCHAR local_248 [264];
  ulonglong local_38;

  if (param_1 == 0) {
    return;
  }
  local_38 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffc28;
  local_398[0] = 0;
  if ((param_2 == (LPCVOID)0x0) || (param_3 == 0)) goto LAB_180040297;
  if (*(char *)(param_1 + 0x340) != '\0') {
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x318));
  }
  memset(local_388 + 0x140,0,0x208);
  lpFileName = (LPCWSTR)(param_1 + 0x104);
  if (*lpFileName != L'\0') {
    memset(local_388,0,0x140);
    pvVar2 = FindFirstFileW(lpFileName,(LPWIN32_FIND_DATAW)local_388);
    if ((longlong)pvVar2 - 1U < 0xfffffffffffffffe) {
      if ((local_388[0] & 0x10) == 0) {
        FindClose(pvVar2);
        if (4999999 < local_388._32_4_) {
          if ((longlong)*(HANDLE *)(param_1 + 0x348) - 1U < 0xfffffffffffffffe) {
            CloseHandle(*(HANDLE *)(param_1 + 0x348));
            *(undefined8 *)(param_1 + 0x348) = 0;
          }
          FUN_18003e610(local_388 + 0x140,0x104,L"%s.bak",lpFileName);
          CopyFileW(lpFileName,(LPCWSTR)(local_388 + 0x140),0);
          DeleteFileW(lpFileName);
        }
      }
      else {
        FindClose(pvVar2);
      }
    }
  }
  if ((*(longlong *)(param_1 + 0x348) + 1U & 0xfffffffffffffffe) == 0) {
    if ((*lpFileName != L'\0') &&
       (pvVar2 = CreateFileW(lpFileName,0x40000000,1,(LPSECURITY_ATTRIBUTES)0x0,4,0,(HANDLE)0x0),
       (longlong)pvVar2 - 1U < 0xfffffffffffffffe)) {
      *(HANDLE *)(param_1 + 0x348) = pvVar2;
      goto LAB_18004022c;
    }
  }
  else {
LAB_18004022c:
    SetFilePointer(*(HANDLE *)(param_1 + 0x348),0,(PLONG)0x0,2);
    BVar1 = WriteFile(*(HANDLE *)(param_1 + 0x348),param_2,(DWORD)param_3,local_398,
                      (LPOVERLAPPED)0x0);
    if (BVar1 == 0) {
      CloseHandle(*(HANDLE *)(param_1 + 0x348));
      *(undefined8 *)(param_1 + 0x348) = 0;
    }
  }
  if (*(char *)(param_1 + 0x340) != '\0') {
    LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x318));
  }
LAB_180040297:
  FUN_18005f100(local_38 ^ (ulonglong)&stack0xfffffffffffffc28);
  return;
}



void FUN_180040310(longlong param_1,ulonglong param_2,longlong param_3,longlong param_4,
                  undefined4 param_5,undefined8 param_6,ulonglong param_7)

{
  int iVar1;
  ulonglong *puVar2;
  ulonglong uVar3;
  longlong lVar4;
  HANDLE pvVar5;
  LPVOID lpMem;
  undefined8 uVar6;
  longlong lVar7;
  ulonglong uVar8;
  int iVar9;
  ulonglong uVar10;
  ulonglong uVar11;
  undefined auStack248 [32];
  ulonglong local_d8;
  ulonglong local_d0;
  uint local_c8;
  uint local_c0;
  uint local_b8;
  DWORD local_b0;
  DWORD local_a8;
  longlong local_a0;
  undefined *local_98;
  longlong local_90;
  undefined4 local_88;
  ulonglong local_78;
  undefined8 local_70;
  undefined **local_68;
  _SYSTEMTIME local_60;
  ulonglong local_50;

  local_50 = DAT_1800b04e8 ^ (ulonglong)auStack248;
  local_70 = param_6;
  local_78 = param_7;
  iVar9 = 0;
  GetLocalTime((LPSYSTEMTIME)&local_60);
  uVar10 = 0xffffffffffffffff;
  do {
    uVar10 = uVar10 + 1;
  } while (*(short *)(param_1 + uVar10 * 2) != 0);
  uVar11 = 0xffffffffffffffff;
  local_68 = &PTR_DAT_1800afcc0 + (param_2 & 0xffffffff);
  do {
    uVar11 = uVar11 + 1;
  } while (*(short *)(*local_68 + uVar11 * 2) != 0);
  uVar8 = 0xffffffffffffffff;
  do {
    uVar8 = uVar8 + 1;
  } while (*(short *)(param_4 + uVar8 * 2) != 0);
  puVar2 = (ulonglong *)FUN_18003ded0();
  local_d0 = local_78;
  local_d8 = 0;
  iVar1 = __stdio_common_vswprintf(*puVar2 | 2,0,0);
  lVar7 = -1;
  do {
    lVar7 = lVar7 + 1;
  } while (*(short *)(param_3 + lVar7 * 2) != 0);
  if (iVar1 < 0) {
    iVar1 = -1;
  }
  uVar3 = 0x24;
  if (0x24 < uVar8) {
    uVar3 = uVar8;
  }
  uVar8 = 5;
  if (5 < uVar11) {
    uVar8 = uVar11;
  }
  uVar11 = 8;
  if (8 < uVar10) {
    uVar11 = uVar10;
  }
  lVar4 = uVar11 + lVar7 + iVar1 + uVar3 + uVar8;
  lVar7 = lVar4 + 0x81;
  pvVar5 = GetProcessHeap();
  lpMem = HeapAlloc(pvVar5,8,lVar4 * 2 + 0x102);
  if ((*(uint *)(param_1 + 0x30c) & 0x1000) == 0) {
    local_a8 = GetCurrentThreadId();
    local_b0 = GetCurrentProcessId();
    local_88 = param_5;
    local_98 = *local_68;
    local_b8 = (uint)local_60.wMilliseconds;
    local_c0 = (uint)local_60.wSecond;
    local_c8 = (uint)local_60.wMinute;
    local_d0 = local_d0 & 0xffffffff00000000 | (ulonglong)local_60.wHour;
    local_d8 = local_d8 & 0xffffffff00000000 | (ulonglong)local_60.wDay;
    local_a0 = param_1;
    local_90 = param_4;
    uVar6 = FUN_18003e610(lpMem,lVar7,

                          L"[%02d%02d-%02d:%02d:%02d:%03d][PID:%6d][TID:%6d][%8s][%5s][%36s:%4d] Goodix>> "
                          ,(ulonglong)local_60.wMonth);
    iVar9 = (int)uVar6;
    if (0 < iVar9) goto LAB_18004052a;
  }
  else {
LAB_18004052a:
    local_d0 = local_78;
    local_d8 = 0;
    iVar1 = __stdio_common_vswprintf_s
                      (*puVar2,(LPVOID)((longlong)lpMem + (longlong)iVar9 * 2),lVar7 - iVar9,
                       local_70);
    if (iVar1 < 0) {
      iVar1 = -1;
    }
    if (-1 < iVar1) {
      iVar9 = iVar9 + iVar1;
      if ((*(short *)((longlong)lpMem + (longlong)(iVar9 + -1) * 2) != 10) &&
         (iVar9 + 1 < (int)lVar7)) {
        *(undefined2 *)((longlong)lpMem + (longlong)iVar9 * 2) = 10;
        *(undefined2 *)((longlong)lpMem + (longlong)(iVar9 + 1) * 2) = 0;
      }
      goto LAB_180040599;
    }
  }
  if (lpMem != (LPVOID)0x0) {
    pvVar5 = GetProcessHeap();
    HeapFree(pvVar5,0,lpMem);
  }
LAB_180040599:
  FUN_18005f100(local_50 ^ (ulonglong)auStack248);
  return;
}



void FUN_1800405c0(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 uVar1;
  undefined8 *puVar2;
  undefined8 local_res10;
  undefined8 local_res18;
  undefined8 local_res20;

  local_res10 = param_2;
  local_res18 = param_3;
  local_res20 = param_4;
  uVar1 = __acrt_iob_func(1);
  puVar2 = (undefined8 *)FUN_18003ded0();
  __stdio_common_vfwprintf(*puVar2,uVar1,param_1,0,&local_res10);
  return;
}



undefined8 * FUN_180040620(undefined8 *param_1)

{
  int *piVar1;

  FUN_18005e1d0(param_1);
  *(undefined4 *)(param_1 + 1) = 3;
  *param_1 = AlgorithmVersionChain::vftable;
  if (param_1 + 4 == (undefined8 *)0x0) {
    piVar1 = _errno();
    *piVar1 = 0x16;
    _invalid_parameter_noinfo();
    return param_1;
  }
  param_1[4] = 0x6f0067006c0041;
  return param_1;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180040680(undefined param_1,undefined param_2,undefined param_3,undefined param_4,
                  longlong param_5)

{
  ulonglong uVar1;
  undefined auStack120 [32];
  undefined8 local_58;
  undefined8 local_50;
  undefined8 local_48;
  undefined8 local_40;
  undefined8 local_38;
  undefined8 local_30;
  undefined8 local_28;
  undefined8 local_20;
  ulonglong local_18;

  local_18 = DAT_1800b04e8 ^ (ulonglong)auStack120;
  local_58 = 0;
  local_50 = 0;
  local_48 = 0;
  local_40 = 0;
  local_38 = 0;
  local_30 = 0;
  local_28 = 0;
  local_20 = 0;
  uVar1 = getAlgorithmVersion((uint *)&local_58);
  local_20 = local_20 & 0xffffffffffffff;
  if ((int)uVar1 == 0) {
    *(undefined4 *)(param_5 + 8) = (undefined4)local_58;
    *(undefined4 *)(param_5 + 0xc) = local_58._4_4_;
    *(undefined4 *)(param_5 + 0x10) = (undefined4)local_50;
    *(undefined4 *)(param_5 + 0x14) = local_50._4_4_;
    *(undefined4 *)(param_5 + 0x18) = (undefined4)local_48;
    *(undefined4 *)(param_5 + 0x1c) = local_48._4_4_;
    *(undefined4 *)(param_5 + 0x20) = (undefined4)local_40;
    *(undefined4 *)(param_5 + 0x24) = local_40._4_4_;
    *(undefined4 *)(param_5 + 0x28) = (undefined4)local_38;
    *(undefined4 *)(param_5 + 0x2c) = local_38._4_4_;
    *(undefined4 *)(param_5 + 0x30) = (undefined4)local_30;
    *(undefined4 *)(param_5 + 0x34) = local_30._4_4_;
    *(undefined4 *)(param_5 + 0x38) = (undefined4)local_28;
    *(undefined4 *)(param_5 + 0x3c) = local_28._4_4_;
    *(undefined4 *)(param_5 + 0x40) = (undefined4)local_20;
    *(undefined4 *)(param_5 + 0x44) = local_20._4_4_;
    FUN_18003d660((longlong)"%s %d Get algorithmVersion=%s","ProcessCore",0x18,&local_58);
    FUN_18005f100(local_18 ^ (ulonglong)auStack120);
    return;
  }
  *(undefined4 *)(param_5 + 4) = 1;
  FUN_18003d660((longlong)"%s %d Get algorithmVersion failed, ret=0x%x","ProcessCore",0x20,
                uVar1 & 0xffffffff);
  FUN_18005f100(local_18 ^ (ulonglong)auStack120);
  return;
}



undefined8 * FUN_180040760(undefined8 *param_1)

{
  int *piVar1;

  FUN_18005e1d0(param_1);
  *(undefined4 *)(param_1 + 1) = 0xffff;
  *param_1 = CodeUnitTestChain::vftable;
  if (param_1 + 4 == (undefined8 *)0x0) {
    piVar1 = _errno();
    *piVar1 = 0x16;
    _invalid_parameter_noinfo();
    return param_1;
  }
  param_1[4] = 0x650064006f0043;
  return param_1;
}



undefined8
FUN_1800407d0(undefined param_1,undefined param_2,undefined param_3,undefined param_4,
             longlong param_5)

{
  *(undefined4 *)(param_5 + 4) = 0;
  *(undefined4 *)(param_5 + 8) = 1;
  return 1;
}



undefined8 * FUN_1800407f0(undefined8 *param_1)

{
  int *piVar1;

  FUN_18005e1d0(param_1);
  *(undefined4 *)(param_1 + 1) = 7;
  *param_1 = DynamicParamsChain::vftable;
  if (param_1 + 4 == (undefined8 *)0x0) {
    piVar1 = _errno();
    *piVar1 = 0x16;
    _invalid_parameter_noinfo();
  }
  else {
    param_1[4] = 0x61006e00790044;
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"DynamicParamsChain.cpp",
             (undefined *)L"DynamicParamsChain::DynamicParamsChain",0xb,0,
             (undefined *)L"Engine test: DynamicParams chain init");
  return param_1;
}



void FUN_180040880(undefined param_1,undefined param_2,undefined param_3,undefined param_4,
                  longlong param_5)

{
  *(undefined4 *)(param_5 + 4) = 0;
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"DynamicParamsChain.cpp",
             (undefined *)L"DynamicParamsChain::ProcessCore",0x1d,0,
             (undefined *)
             L"Engine Test, DynamicParamsChain->ProcessCore,quality: 0x%x, coverage: 0x%x");
  *(undefined4 *)(param_5 + 0x10) = 1;
  *(undefined8 *)(param_5 + 0x14) = 1;
  *(undefined4 *)(param_5 + 8) = 0x410019;
  *(undefined4 *)(param_5 + 0xc) = 0xf;
  return;
}



undefined8 FUN_1800415b0(longlong param_1)

{
  LPVOID *ppvVar1;
  HANDLE pvVar2;
  longlong lVar3;
  LPVOID pvVar4;
  uint uVar5;
  undefined8 uVar6;
  undefined *puVar7;
  undefined4 uVar8;
  wchar_t *pwVar9;

  uVar6 = 0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x83,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterClearContext",0xa5d,0,(undefined *)L"Entry");
  if (param_1 == 0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x84,&DAT_180072bc8);
    }
    uVar5 = 2;
    pwVar9 = L"Arg error";
    uVar8 = 0xa63;
  }
  else {
    ppvVar1 = *(LPVOID **)(param_1 + 0x38);
    if (ppvVar1 != (LPVOID *)0x0) {
      if ((LPVOID *)*ppvVar1 != (LPVOID *)0x0) {
                    // WARNING: Load size is inaccurate
        pvVar4 = **ppvVar1;
        if (pvVar4 != (LPVOID)0x0) {
          pvVar2 = GetProcessHeap();
          HeapFree(pvVar2,8,pvVar4);
          *(undefined8 *)*ppvVar1 = 0;
        }
        pvVar4 = *(LPVOID *)((longlong)*ppvVar1 + 0x40);
        if (pvVar4 != (LPVOID)0x0) {
          pvVar2 = GetProcessHeap();
          HeapFree(pvVar2,8,pvVar4);
          *(undefined8 *)((longlong)*ppvVar1 + 0x40) = 0;
        }
        lVar3 = 0x48;
        puVar7 = (undefined *)*ppvVar1;
        while (lVar3 != 0) {
          lVar3 = lVar3 + -1;
          *puVar7 = 0;
          puVar7 = puVar7 + 1;
        }
        pvVar4 = *ppvVar1;
        pvVar2 = GetProcessHeap();
        HeapFree(pvVar2,8,pvVar4);
        *ppvVar1 = (LPVOID)0x0;
      }
      if ((void **)ppvVar1[2] != (void **)0x0) {
        enrolFinish((void **)ppvVar1[2]);
        ppvVar1[2] = (LPVOID)0x0;
        *(undefined4 *)(ppvVar1 + 1) = 0;
      }
      if ((undefined *)ppvVar1[3] != (undefined *)0x0) {
        pvVar4 = ppvVar1[4];
        puVar7 = (undefined *)ppvVar1[3];
        while (pvVar4 != (LPVOID)0x0) {
          pvVar4 = (LPVOID)((longlong)pvVar4 + -1);
          *puVar7 = 0;
          puVar7 = puVar7 + 1;
        }
        pvVar4 = ppvVar1[3];
        pvVar2 = GetProcessHeap();
        HeapFree(pvVar2,8,pvVar4);
        ppvVar1[3] = (LPVOID)0x0;
        ppvVar1[4] = (LPVOID)0x0;
      }
      goto LAB_1800417d4;
    }
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x85,&DAT_180072bc8);
    }
    uVar5 = 4;
    pwVar9 = L"Enginecontext NULL";
    uVar8 = 0xa6f;
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,uVar5,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterClearContext",uVar8,0,(undefined *)pwVar9);
  uVar6 = 0x80004003;
LAB_1800417d4:
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x86,&DAT_180072bc8,(int)uVar6);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterClearContext",0xaaa,0,(undefined *)L"Exit, hr=0x%x");
  FUN_18003fa10();
  return uVar6;
}



undefined8 FUN_180041860(longlong param_1,undefined4 *param_2,undefined4 *param_3)

{
  undefined8 uVar1;

  uVar1 = 0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x87,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterQueryPreferredFormat",0xabc,0,(undefined *)L"Entry");
  if (((param_1 == 0) || (param_2 == (undefined4 *)0x0)) || (param_3 == (undefined4 *)0x0)) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x88,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"EngineAdapterQueryPreferredFormat",0xac4,0,(undefined *)L"Arg error");
    uVar1 = 0x80004003;
  }
  else {
    *param_2 = 0x401001b;
    *param_3 = 0x310664e0;
    param_3[1] = 0x48b25df2;
    param_3[2] = 0x93b15ebb;
    param_3[3] = 0x1312bc6e;
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054880(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x89,&DAT_180072bc8,
                    (uint)*(ushort *)param_2,(char)*(undefined2 *)((longlong)param_2 + 2));
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"EngineAdapterQueryPreferredFormat",0xad8,0,
               (undefined *)L"owner:0x%x:type:0x%x");
  }
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x8a,&DAT_180072bc8,(int)uVar1);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterQueryPreferredFormat",0xadc,0,(undefined *)L"Exit, hr=0x%x"
            );
  return uVar1;
}



undefined8 FUN_180041aa0(longlong param_1,undefined8 *param_2)

{
  undefined8 uVar1;

  uVar1 = 0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x8b,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterQueryIndexVectorSize",0xaee,0,(undefined *)L"Entry");
  if ((param_1 == 0) || (param_2 == (undefined8 *)0x0)) {
    if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
       (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x8c,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"EngineAdapterQueryIndexVectorSize",0xaf5,0,(undefined *)L"Arg error");
    uVar1 = 0x80004003;
  }
  else {
    *param_2 = 0;
  }
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x8d,&DAT_180072bc8,(int)uVar1);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterQueryIndexVectorSize",0xb05,0,
             (undefined *)L" Exit, hr=0x%x");
  return uVar1;
}



undefined8 FUN_180041c40(void)

{
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x8e,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterQueryHashAlgorithms",0xb1c,0,(undefined *)L"Exit");
  return 0x80004001;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180041ed0(longlong param_1,undefined8 *param_2,longlong *param_3,byte param_4,
                  longlong *param_5)

{
  LPVOID pvVar1;
  int iVar2;
  undefined8 *lpMem;
  int iVar3;
  HANDLE pvVar4;
  undefined8 *lpMem_00;
  longlong *plVar5;
  longlong lVar6;
  longlong *plVar7;
  ulonglong uVar8;
  ULONGLONG UVar9;
  undefined8 uVar10;
  ushort *puVar11;
  longlong **pplVar12;
  uint uVar13;
  longlong **pplVar14;
  undefined4 uVar15;
  wchar_t *pwVar16;
  undefined8 local_120;
  uint local_118;
  uint local_110;
  char *local_108;
  undefined8 local_f8;
  undefined8 *local_f0;
  longlong *local_e8;
  LPVOID local_e0;
  int *local_d8;
  LPVOID local_d0;
  longlong local_c0;
  ULONGLONG local_b8;
  undefined4 local_b0;
  undefined4 local_ac;
  longlong **local_a8;
  undefined8 **local_a0;
  byte local_98;
  longlong *local_90;
  undefined8 *local_88;
  undefined8 local_80;
  undefined8 local_78;
  undefined8 local_70;
  undefined8 local_68;
  undefined8 local_60;
  ulonglong local_58;

  local_58 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffea8;
  local_e8 = param_3;
  local_c0 = param_1;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xaa,&DAT_180072bc8);
  }
  pplVar14 = (longlong **)0x0;
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterAcceptSampleData",0xc6d,0,(undefined *)L"Entry");
  local_f0 = (undefined8 *)0x0;
  local_88 = (undefined8 *)0x0;
  local_80 = 0;
  local_78 = 0;
  local_70 = 0;
  local_68 = 0;
  local_60 = 0;
  local_e0 = (LPVOID)0x0;
  local_d0 = (LPVOID)0x0;
  pvVar4 = GetProcessHeap();
  local_d8 = (int *)HeapAlloc(pvVar4,8,4);
  pplVar12 = pplVar14;
  if (((param_1 == 0) || (param_2 == (undefined8 *)0x0)) || (param_5 == (longlong *)0x0)) {
LAB_180042ac0:
    lpMem_00 = (undefined8 *)0x0;
    pplVar14 = (longlong **)0x80004003;
  }
  else {
    pplVar12 = *(longlong ***)(param_1 + 0x38);
    if (pplVar12 == (longlong **)0x0) {
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xab,&DAT_180072bc8);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"EngineAdapterAcceptSampleData",0xc93,0,(undefined *)L"Arg error");
      goto LAB_180042ac0;
    }
    *(undefined4 *)((longlong)pplVar12 + 0x124) = 0;
    if (*(char *)((longlong)pplVar12 + 0x53c) == '\x05') {
      local_f8 = (undefined8 *)0x0;
      FUN_18003e3c0((int *)&local_f8);
      FUN_18003d660((longlong)"%s %d time stamp %lu.%lu","EngineAdapterAcceptSampleData",0xc9f,
                    (ulonglong)local_f8 & 0xffffffff);
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
        FUN_180054bb0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xac,&DAT_180072bc8,
                      (undefined4)local_f8,(char)((ulonglong)local_f8 >> 0x20));
      }
      local_118 = local_f8._4_4_;
      local_120 = (longlong *)
                  ((ulonglong)local_f8 & 0xffffffff | (ulonglong)local_120._4_4_ << 0x20);
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"EngineAdapterAcceptSampleData",0xca1,0,
                 (undefined *)L"time stamp %lu.%lu");
    }
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xad,&DAT_180072bc8,
                    *(undefined4 *)(pplVar12 + 0x25));
    }
    local_120 = (longlong *)
                ((ulonglong)local_120 & 0xffffffff00000000 | (ulonglong)*(uint *)(pplVar12 + 0x25));
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"EngineAdapterAcceptSampleData",0xca5,0,
               (undefined *)L"TEST- check for test mode:save or load [1-4] =%d");
    if ((*(int *)(pplVar12 + 0x25) != 0) || ((byte)(*(char *)((longlong)pplVar12 + 0x53c) - 3U) < 3)
       ) {
      if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
         (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (3 < (byte)PTR_LOOP_1800aff38[0x19])))) {
        FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xae,&DAT_180072bc8,
                      *(int *)(pplVar12 + 0x25));
      }
      local_120 = (longlong *)
                  ((ulonglong)local_120 & 0xffffffff00000000 | (ulonglong)*(uint *)(pplVar12 + 0x25)
                  );
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"EngineAdapterAcceptSampleData",0xcac,0,(undefined *)L"TEST type=%d")
      ;
      local_120 = param_5;
      FUN_18003d660((longlong)

                    "%s %d call accept sample data for test controltype=%d, datatype=%d, SampleSize=%d, Purpose=%d, RejectDetail=%lu"
                    ,"EngineAdapterAcceptSampleData",0xcad,(ulonglong)*(uint *)(pplVar12 + 0x25));
      engine_adapter_accept_sample_data_ForTestr_FUN_180051cf0
                (param_1,param_2,param_3,(ulonglong)param_4,param_5);
      goto LAB_180042bf6;
    }
    local_b8 = GetTickCount64();
    local_f0 = (undefined8 *)
               FUN_18004cea0((longlong)
                             (int)((uint)*(ushort *)(&DAT_1800afd12 + (longlong)DAT_1800b17c8 * 0xe)
                                  * (uint)*(ushort *)
                                           (&DAT_1800afd10 + (longlong)DAT_1800b17c8 * 0xe)) * 2);
    lpMem_00 = (undefined8 *)
               FUN_18004cea0((longlong)
                             (int)((uint)*(ushort *)(&DAT_1800afd12 + (longlong)DAT_1800b17c8 * 0xe)
                                  * (uint)*(ushort *)
                                           (&DAT_1800afd10 + (longlong)DAT_1800b17c8 * 0xe)) * 2);
    local_f8 = lpMem_00;
    local_e0 = (LPVOID)FUN_18004cea0((longlong)
                                     (int)((uint)*(ushort *)
                                                  (&DAT_1800afd12 + (longlong)DAT_1800b17c8 * 0xe) *
                                          (uint)*(ushort *)
                                                 (&DAT_1800afd10 + (longlong)DAT_1800b17c8 * 0xe)) *
                                     2);
    local_d0 = (LPVOID)FUN_18004cea0((longlong)
                                     (int)((uint)*(ushort *)
                                                  (&DAT_1800afd12 + (longlong)DAT_1800b17c8 * 0xe) *
                                          (uint)*(ushort *)
                                                 (&DAT_1800afd10 + (longlong)DAT_1800b17c8 * 0xe)) *
                                     2);
    if ((((local_f0 == (undefined8 *)0x0) || (lpMem_00 == (undefined8 *)0x0)) ||
        (local_e0 == (LPVOID)0x0)) || (local_d0 == (LPVOID)0x0)) {
      pplVar14 = (longlong **)0x8007000e;
    }
    else {
      local_70 = CONCAT62(local_70._2_6_,1);
      local_88 = local_f0;
      local_80 = DAT_1800aff18;
      local_78 = CONCAT44((uint)*(ushort *)(&DAT_1800afd12 + (longlong)DAT_1800b17c8 * 0xe) *
                          (uint)*(ushort *)(&DAT_1800afd10 + (longlong)DAT_1800b17c8 * 0xe) * 2,
                          DAT_1800aff20);
      if (((param_3 == (longlong *)0x0) || (param_4 == 0)) ||
         ((*(int *)((longlong)param_2 + 0xc) != 0 &&
          ((*(short *)(param_2 + 9) != 0x1b || (*(short *)((longlong)param_2 + 0x4a) != 0x401))))))
      {
        pplVar14 = (longlong **)0x80070057;
      }
      else {
        if ((LPVOID *)*pplVar12 != (LPVOID *)0x0) {
          pvVar1 = (LPVOID)**pplVar12;
          if (pvVar1 != (LPVOID)0x0) {
            FUN_1800501e0(pvVar1);
            **pplVar12 = 0;
          }
          if ((LPVOID)(*pplVar12)[8] != (LPVOID)0x0) {
            FUN_1800501e0((LPVOID)(*pplVar12)[8]);
            (*pplVar12)[8] = 0;
          }
          FUN_1800501e0(*pplVar12);
          *pplVar12 = (longlong *)0x0;
        }
        pvVar4 = GetProcessHeap();
        plVar5 = (longlong *)HeapAlloc(pvVar4,8,0x48);
        *pplVar12 = plVar5;
        if (plVar5 == (longlong *)0x0) {
          pwVar16 = L"Alloc memory for FeatureSet fail";
          uVar15 = 0xcf1;
        }
        else {
          lVar6 = FUN_18004cea0((longlong)
                                (int)((uint)*(ushort *)
                                             (&DAT_1800afd12 + (longlong)DAT_1800b17c8 * 0xe) *
                                     (uint)*(ushort *)
                                            (&DAT_1800afd10 + (longlong)DAT_1800b17c8 * 0xe)));
          **pplVar12 = lVar6;
          if ((void *)**pplVar12 != (void *)0x0) {
            lVar6 = (longlong)DAT_1800b17c8 * 0xe;
            puVar11 = (ushort *)(&DAT_1800afd10 + lVar6);
            memset((void *)**pplVar12,0,
                   (longlong)(int)((uint)*puVar11 * (uint)*(ushort *)(&DAT_1800afd12 + lVar6)));
            plVar5 = *pplVar12;
            plVar5[1] = DAT_1800aff28;
            *(undefined4 *)(plVar5 + 2) = DAT_1800aff30;
            *(undefined2 *)(*pplVar12 + 3) = 1;
            *(uint *)((longlong)*pplVar12 + 0x14) =
                 (uint)*puVar11 * (uint)*(ushort *)(&DAT_1800afd12 + lVar6);
            lVar6 = FUN_18004cea0((longlong)
                                  (int)((uint)*puVar11 * (uint)*(ushort *)(&DAT_1800afd12 + lVar6))
                                  * 2);
            (*pplVar12)[8] = lVar6;
            if ((void *)(*pplVar12)[8] == (void *)0x0) {
              pwVar16 = L"Alloc memory for RawdataBuffer fail";
              uVar15 = 0xd05;
            }
            else {
              memset((void *)(*pplVar12)[8],0,
                     (longlong)
                     (int)((uint)*(ushort *)(&DAT_1800afd12 + (longlong)DAT_1800b17c8 * 0xe) *
                          (uint)*(ushort *)(&DAT_1800afd10 + (longlong)DAT_1800b17c8 * 0xe)) * 2);
              if (pplVar12[7] != (longlong *)0x0) {
                FUN_1800501e0(pplVar12[7]);
                pplVar12[7] = (longlong *)0x0;
                pplVar12[8] = (longlong *)0x0;
              }
              plVar5 = local_e8;
              plVar7 = (longlong *)FUN_18004cea0((SIZE_T)local_e8);
              pplVar12[7] = plVar7;
              if (plVar7 != (longlong *)0x0) {
                memcpy_FUN_180061f90(plVar7,param_2,(ulonglong)plVar5);
                pplVar12[8] = plVar5;
                lVar6 = (ulonglong)*(uint *)((longlong)param_2 + 0xc) + (longlong)param_2;
                uVar13 = (uint)(byte)(((*(byte *)(lVar6 + 0x22) & 7) != 0) +
                                     (*(byte *)(lVar6 + 0x22) >> 3)) *
                         (uint)*(ushort *)(lVar6 + 0x2e) * (uint)*(ushort *)(lVar6 + 0x2c);
                if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                    ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) &&
                   (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
                  FUN_180055000(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xaf,&DAT_180072bc8,
                                uVar13,(char)*(undefined2 *)
                                              (&DAT_1800afd12 + (longlong)DAT_1800b17c8 * 0xe),
                                (char)*(undefined2 *)
                                       (&DAT_1800afd10 + (longlong)DAT_1800b17c8 * 0xe));
                }
                local_110 = (uint)*(ushort *)(&DAT_1800afd10 + (longlong)DAT_1800b17c8 * 0xe);
                local_118 = (uint)*(ushort *)(&DAT_1800afd12 + (longlong)DAT_1800b17c8 * 0xe);
                local_120 = (longlong *)
                            ((ulonglong)local_120 & 0xffffffff00000000 | (ulonglong)uVar13);
                debug_print_FUN_18003fc70
                          ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                           (undefined *)L"EngineAdapterAcceptSampleData",0xd31,0,
                           (undefined *)L"len:%d!!! row:%u col:%u");
                *(uint *)(pplVar12 + 0x23) = (uint)*(byte *)(lVar6 + 0x38);
                local_e8 = (longlong *)
                           ((ulonglong)local_e8 & 0xffffffff00000000 |
                           (ulonglong)(uint)*(byte *)(lVar6 + 0x39));
                *(uint *)((longlong)pplVar12 + 0x8c) = (uint)*(byte *)(lVar6 + 0x39);
                memcpy_FUN_180061f90(local_f0,(undefined8 *)(lVar6 + 0x3a),(ulonglong)uVar13);
                memcpy_FUN_180061f90(local_f8,(undefined8 *)(lVar6 + 0x7630),(ulonglong)uVar13);
                local_70 = local_70 & 0xffffffff | (ulonglong)*(uint *)(pplVar12 + 0xa7) << 0x20;
                *(undefined4 *)((longlong)*pplVar12 + 0x1c) = *(undefined4 *)(pplVar12 + 0xa7);
                memcpy_FUN_180061f90
                          ((undefined8 *)(*pplVar12)[8],local_88,
                           (longlong)
                           (int)((uint)*(ushort *)(&DAT_1800afd12 + (longlong)DAT_1800b17c8 * 0xe) *
                                (uint)*(ushort *)(&DAT_1800afd10 + (longlong)DAT_1800b17c8 * 0xe)) *
                           2);
                local_118 = (int)local_e8;
                local_120 = (longlong *)
                            ((ulonglong)local_120 & 0xffffffff00000000 |
                            (ulonglong)*(byte *)(pplVar12 + 0xe));
                debug_print_FUN_18003fc70
                          ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                           (undefined *)L"EngineAdapterAcceptSampleData",0xd47,0,
                           (undefined *)L"m_basevalid:%d...needupdateimagebase:%d");
                lpMem_00 = local_f8;
                if (((*(char *)(pplVar12 + 0xe) == '\0') || ((int)local_e8 == 1)) &&
                   (_AdapterInitPreprocessor_FUN_18004f8d0(local_c0,local_f8,uVar13),
                   *(char *)(pplVar12 + 0xe) == '\0')) {
                  *(uint *)param_5 = (uint)*(byte *)(pplVar12 + 0x22);
                  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) &&
                     (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
                    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xb0,&DAT_180072bc8);
                  }
                  debug_print_FUN_18003fc70
                            ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                             (undefined *)L"EngineAdapterAcceptSampleData",0xd53,0,
                             (undefined *)L"_AdapterInitPreprocessor failed!!!");
                  pplVar14 = (longlong **)0x80098008;
                }
                else {
                  iVar3 = 0;
                  if (param_4 == 2) {
                    *(undefined4 *)((longlong)pplVar12 + 0x124) = 1;
                    *local_d8 = 0;
                  }
                  else {
                    *local_d8 = 1;
                  }
                  uVar8 = preprocessor(&local_88,local_d8,*pplVar12,(undefined *)(*pplVar12 + 6));
                  iVar2 = (int)uVar8;
                  UVar9 = GetTickCount64();
                  if (UVar9 != 0) {
                    iVar3 = (int)UVar9 - (int)local_b8;
                  }
                  *(int *)((longlong)pplVar12 + 0x11c) = iVar3;
                  if (*(int *)(pplVar12 + 0x25) != 0) {
                    *(undefined2 *)param_5 = *(undefined2 *)((longlong)*pplVar12 + 0x34);
                    *(undefined2 *)((longlong)param_5 + 2) = *(undefined2 *)(*pplVar12 + 6);
                  }
                  if (iVar2 == 0) {
                    local_110 = *(uint *)(*pplVar12 + 6);
                    local_118 = *(int *)((longlong)*pplVar12 + 0x34);
                    local_120 = (longlong *)
                                ((ulonglong)local_120 & 0xffffffff00000000 | (ulonglong)param_4);
                    debug_print_FUN_18003fc70
                              ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                               (undefined *)L"EngineAdapterAcceptSampleData",0xdeb,0,
                               (undefined *)
                               L"preprocessor success, Purpose=%u, quality=%u, coverage=%u");
                    if (param_4 == 4) {
                      *(char *)((longlong)pplVar12 + 0x7c) =
                           *(char *)((longlong)pplVar12 + 0x7c) + '\x01';
                      if (*(uint *)(*pplVar12 + 6) < (uint)*(byte *)((longlong)pplVar12 + 0x10a)) {
                        if (*(int *)(pplVar12 + 0x25) == 0) {
                          *(uint *)param_5 = (uint)*(byte *)(pplVar12 + 0x22);
                        }
                        pplVar14 = (longlong **)0x80098008;
                      }
                      else {
                        if (*(uint *)((longlong)*pplVar12 + 0x34) <
                            (uint)*(byte *)((longlong)pplVar12 + 0x10b)) {
                          if (*(int *)(pplVar12 + 0x25) == 0) {
                            *(uint *)param_5 = (uint)*(byte *)((longlong)pplVar12 + 0x111);
                          }
                          pplVar14 = (longlong **)0x80098008;
                        }
                        else {
                          *(char *)((longlong)pplVar12 + 0x7b) =
                               *(char *)((longlong)pplVar12 + 0x7b) + '\x01';
                          pplVar14 = (longlong **)0x0;
                        }
                      }
                    }
                  }
                  else {
                    local_108 = " liveness";
                    if (iVar2 == 0x84) {
                      local_108 = "no liveness";
                    }
                    local_110 = *(uint *)(*pplVar12 + 6);
                    local_118 = *(int *)((longlong)*pplVar12 + 0x34);
                    local_120 = (longlong *)
                                ((ulonglong)local_120 & 0xffffffff00000000 | (ulonglong)param_4);
                    debug_print_FUN_18003fc70
                              ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                               (undefined *)L"EngineAdapterAcceptSampleData",0xddb,0,
                               (undefined *)
                               L"preprocessor fail, Purpose=%u, quality=%u, coverage=%u, %S");
                    if (*(int *)(pplVar12 + 0x25) == 0) {
                      *(uint *)param_5 = (uint)*(byte *)(pplVar12 + 0x22);
                    }
                    pplVar14 = (longlong **)0x80098008;
                    if (iVar2 == 0x84) {
                      *(char *)((longlong)pplVar12 + 0x7a) =
                           *(char *)((longlong)pplVar12 + 0x7a) + '\x01';
                    }
                  }
                }
                goto LAB_180042ac6;
              }
              pwVar16 = L"Alloc memory for samplebuffer fail";
              uVar15 = 0xd14;
            }
            debug_print_FUN_18003fc70
                      ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                       (undefined *)L"EngineAdapterAcceptSampleData",uVar15,0,(undefined *)pwVar16);
            lpMem_00 = local_f8;
            pplVar14 = (longlong **)0x8007000e;
            goto LAB_180042ac6;
          }
          pwVar16 = L"Alloc memory for Image.buffer fail";
          uVar15 = 0xcf8;
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterAcceptSampleData",uVar15,0,(undefined *)pwVar16);
        pplVar14 = (longlong **)0x8007000e;
      }
    }
  }
LAB_180042ac6:
  uVar10 = FUN_18005ea70();
  if (((int)uVar10 != 0) && (pplVar12 != (longlong **)0x0)) {
    local_a0 = &local_88;
    local_ac = DAT_1800b04d0;
    local_90 = param_5;
    local_b0 = 3;
    local_a8 = pplVar12;
    local_98 = param_4;
    FUN_18005ead0((undefined2 *)&local_b0);
  }
  lpMem = local_f0;
  if (local_f0 != (undefined8 *)0x0) {
    pvVar4 = GetProcessHeap();
    HeapFree(pvVar4,8,lpMem);
  }
  if (lpMem_00 != (undefined8 *)0x0) {
    pvVar4 = GetProcessHeap();
    HeapFree(pvVar4,8,lpMem_00);
  }
  pvVar1 = local_e0;
  if (local_e0 != (LPVOID)0x0) {
    pvVar4 = GetProcessHeap();
    HeapFree(pvVar4,8,pvVar1);
  }
  pvVar1 = local_d0;
  if (local_d0 != (LPVOID)0x0) {
    pvVar4 = GetProcessHeap();
    HeapFree(pvVar4,8,pvVar1);
  }
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xb6,&DAT_180072bc8,(int)pplVar14);
  }
  local_120 = (longlong *)((ulonglong)local_120 & 0xffffffff00000000 | (ulonglong)pplVar14);
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterAcceptSampleData",0xe8a,0,(undefined *)L"Exit, hr=0x%x");
LAB_180042bf6:
  FUN_18005f100(local_58 ^ (ulonglong)&stack0xfffffffffffffea8);
  return;
}



// WARNING: Could not reconcile some variable overlaps

ulonglong FUN_180042c20(longlong param_1,byte param_2,undefined8 *param_3,undefined8 *param_4)

{
  longlong lVar1;
  uint uVar2;
  undefined8 uVar3;
  uint uVar4;
  wchar_t *pwVar5;
  undefined8 local_res8;
  undefined4 uVar6;
  undefined8 local_38 [2];

  local_38[0] = 0;
  local_res8 = 0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xb7,&DAT_180072bc8);
  }
  pwVar5 = L"EngineAdapterExportEngineData";
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterExportEngineData",0xea2,0,(undefined *)L"Entry");
  if (((param_1 == 0) || (param_3 == (undefined8 *)0x0)) || (param_4 == (undefined8 *)0x0)) {
    uVar2 = 0x80004003;
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xb8,&DAT_180072bc8);
    }
    uVar4 = 2;
    pwVar5 = L"Arg error";
    uVar6 = 0xeac;
  }
  else {
    lVar1 = *(longlong *)(param_1 + 0x38);
    if (lVar1 == 0) {
      uVar2 = 0x80004003;
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xb9,&DAT_180072bc8);
      }
      uVar4 = 4;
      pwVar5 = L"Enginecontext NULL";
      uVar6 = 0xeb8;
    }
    else {
      if (*(char *)(lVar1 + 0x53c) == '\x04') {
        if ((*(uint *)(lVar1 + 0x570) & 0xfffffffd) == 0) {
          FUN_18003d660((longlong)"%s %d to exit for DeadPixelTest_Stage?",
                        "EngineAdapterExportEngineData",0xec1,pwVar5);
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
            FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xba,&DAT_180072bc8);
          }
          pwVar5 = L"to exit for DeadPixelTest_Stage?";
          uVar6 = 0xec3;
LAB_180042daf:
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"EngineAdapterExportEngineData",uVar6,0,(undefined *)pwVar5);
          return 0;
        }
      }
      else {
        if ((*(char *)(lVar1 + 0x53c) == '\x03') && (*(int *)(lVar1 + 0x560) != 4)) {
          FUN_18003d660((longlong)"%s %d to exit for PixelOpenShort_Stage?",
                        "EngineAdapterExportEngineData",0xeca,pwVar5);
          if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
             (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (1 < (byte)PTR_LOOP_1800aff38[0x19])))) {
            FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xbb,&DAT_180072bc8);
          }
          pwVar5 = L"to exit for PixelOpenShort_Stage?";
          uVar6 = 0xecc;
          goto LAB_180042daf;
        }
      }
      FUN_18003d660((longlong)"%s %d Flags=0x%x","EngineAdapterExportEngineData",0xed0,
                    (ulonglong)(uint)param_2);
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xbc,&DAT_180072bc8,(uint)param_2);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"EngineAdapterExportEngineData",0xed2,0,(undefined *)L"Flags=0x%x");
      if (param_2 == 0x22) {
        uVar2 = 0x80070057;
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xbd,&DAT_180072bc8);
        }
        uVar4 = 4;
        pwVar5 = L"WINBIO_DATA_FLAG_RAW | WINBIO_DATA_FLAG_PRIVACY";
        uVar6 = 0xed9;
      }
      else {
        if (param_2 == 0x21) {
          uVar2 = 0x80070057;
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
            FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xbe,&DAT_180072bc8);
          }
          uVar4 = 4;
          pwVar5 = L"WINBIO_DATA_FLAG_RAW | WINBIO_DATA_FLAG_INTEGRITY";
          uVar6 = 0xee1;
        }
        else {
          if (param_2 == 0x25) {
            uVar2 = 0x80070057;
            if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
              FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xbf,&DAT_180072bc8);
            }
            uVar4 = 4;
            pwVar5 = L"WINBIO_DATA_FLAG_RAW | WINBIO_DATA_FLAG_INTEGRITY | WINBIO_DATA_FLAG_SIGNED";
            uVar6 = 0xee9;
          }
          else {
            if ((param_2 & 0x20) != 0) {
              uVar3 = FUN_180050be0(lVar1,param_2,local_38,&local_res8);
              uVar2 = (uint)uVar3;
              if (-1 < (int)uVar2) {
                *param_3 = local_38[0];
                *param_4 = local_res8;
              }
              FUN_18003d660((longlong)"%s %d Exit, export sample size=%u",
                            "EngineAdapterExportEngineData",0xf01,local_res8);
              if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                  ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19]))
              {
                FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xc1,&DAT_180072bc8,
                              (undefined4)local_res8);
              }
              debug_print_FUN_18003fc70
                        ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                         (undefined *)L"EngineAdapterExportEngineData",0xf03,0,
                         (undefined *)L"Exit, export sample size=%u");
              goto LAB_18004317f;
            }
            uVar2 = 0x80070057;
            if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
              FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xc0,&DAT_180072bc8);
            }
            uVar4 = 4;
            pwVar5 =
            L"WINBIO_DATA_FLAG_RAW | WINBIO_DATA_FLAG_INTERMEDIATE | WINBIO_DATA_FLAG_PROCESSED";
            uVar6 = 0xef2;
          }
        }
      }
    }
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,uVar4,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterExportEngineData",uVar6,0,(undefined *)pwVar5);
LAB_18004317f:
  FUN_18003d660((longlong)"%s %d Exit, hr=0x%x","EngineAdapterExportEngineData",0xf1e,
                (ulonglong)uVar2);
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xc2,&DAT_180072bc8,uVar2);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterExportEngineData",0xf20,0,(undefined *)L"Exit, hr=0x%x");
  return (ulonglong)uVar2;
}



ulonglong FUN_180045250(longlong param_1,longlong param_2)

{
  longlong lVar1;
  uint uVar2;
  ulonglong uVar3;
  undefined4 uVar4;
  wchar_t *pwVar5;

  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x13f,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterGetEnrollmentStatus",0x1650,0,(undefined *)L"Entry");
  if ((param_1 == 0) || (param_2 == 0)) {
    if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
       (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x140,&DAT_180072bc8);
    }
    uVar2 = 2;
    pwVar5 = L"Arg error";
    uVar4 = 0x1657;
  }
  else {
    lVar1 = *(longlong *)(param_1 + 0x38);
    if (lVar1 != 0) {
      if (*(int *)(lVar1 + 8) == 1) {
        uVar3 = _AdapterCheckEnrollmentStatus_FUN_18004ced0(lVar1,lVar1 + 8);
        uVar3 = uVar3 & 0xffffffff;
      }
      else {
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x142,&DAT_180072bc8);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterGetEnrollmentStatus",0x166d,0,
                   (undefined *)L"Enrollment not in progress error");
        uVar3 = 0x8009800f;
      }
      goto LAB_18004542d;
    }
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x141,&DAT_180072bc8);
    }
    uVar2 = 4;
    pwVar5 = L"Enginecontext NULL";
    uVar4 = 0x1663;
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,uVar2,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterGetEnrollmentStatus",uVar4,0,(undefined *)pwVar5);
  uVar3 = 0x80004003;
LAB_18004542d:
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x143,&DAT_180072bc8,(int)uVar3);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterGetEnrollmentStatus",0x1683,0,(undefined *)L"Exit, hr=0x%x"
            );
  return uVar3;
}



// WARNING: Could not reconcile some variable overlaps

ulonglong EngineAdapterCheckForDuplicate_FUN_180045530
                    (longlong param_1,undefined8 *param_2,undefined *param_3,undefined *param_4)

{
  longlong lVar1;
  code *pcVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  uint uVar5;
  ulonglong uVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  char local_res8 [8];
  undefined4 uVar9;
  wchar_t *pwVar10;
  ulonglong local_78 [2];
  undefined4 *local_68;
  undefined8 local_60;
  undefined8 local_58;
  undefined8 local_50;
  uint *local_48;
  undefined8 local_40;
  undefined8 local_38;
  undefined8 local_30;

  uVar8 = 0;
  local_78[0] = 0;
  local_68 = (undefined4 *)0x0;
  local_60 = 0;
  local_58 = 0;
  local_50 = 0;
  local_48 = (uint *)0x0;
  local_40 = 0;
  local_38 = 0;
  local_30 = 0;
  local_res8[0] = '\0';
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x14a,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterCheckForDuplicate",0x1707,0,(undefined *)L"Entry");
  if (((param_1 == 0) || (param_2 == (undefined8 *)0x0)) ||
     ((param_3 == (undefined *)0x0 || (param_4 == (undefined *)0x0)))) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x14b,&DAT_180072bc8);
    }
    uVar5 = 2;
    pwVar10 = L"Arg error";
    uVar9 = 0x170f;
  }
  else {
    lVar1 = *(longlong *)(param_1 + 0x38);
    if (lVar1 != 0) {
      if (*(int *)(lVar1 + 8) != 1) {
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x14d,&DAT_180072bc8);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterCheckForDuplicate",0x1725,0,
                   (undefined *)L"Enrollment not in progress error");
        uVar8 = 0x8009800f;
        goto LAB_180045d84;
      }
      *param_2 = 0;
      param_2[1] = 0;
      param_2[2] = 0;
      param_2[3] = 0;
      param_2[4] = 0;
      param_2[5] = 0;
      param_2[6] = 0;
      param_2[7] = 0;
      param_2[8] = 0;
      *(undefined4 *)(param_2 + 9) = 0;
      *(undefined4 *)param_2 = 0;
      *param_3 = 0;
      *param_4 = 0;
      if ((*(char *)(lVar1 + 0x53c) != '\x05') &&
         ((*(int *)(lVar1 + 0x128) != 0 || (*(char *)(lVar1 + 0x53c) != '\0')))) {
        if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
           (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (1 < (byte)PTR_LOOP_1800aff38[0x19])))) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x14e,&DAT_180072bc8);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterCheckForDuplicate",0x173b,0,
                   (undefined *)L"FAR-FRR Tool enroll, not check duplicate");
        goto LAB_180045d84;
      }
      if (*(longlong *)(param_1 + 0x28) == 0) {
        uVar7 = 0x80004003;
LAB_180045cd2:
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x14f,&DAT_180072bc8);
        }
        pwVar10 = L"WbioStorageQueryByContent error";
        uVar9 = 0x1750;
LAB_180045ca9:
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterCheckForDuplicate",uVar9,0,(undefined *)pwVar10);
      }
      else {
        pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0x80);
        if (pcVar2 == (code *)0x0) {
          uVar7 = 0x80004001;
          goto LAB_180045cd2;
        }
        uVar5 = (*pcVar2)(param_1,0xff,0);
        uVar7 = (ulonglong)uVar5;
        if ((int)uVar5 < 0) goto LAB_180045cd2;
        if (*(longlong *)(param_1 + 0x28) == 0) {
          uVar7 = 0x80004003;
LAB_180045c63:
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
            FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x150,&DAT_180072bc8);
          }
          pwVar10 = L"WbioStorageGetRecordCount error";
          uVar9 = 0x175a;
          goto LAB_180045ca9;
        }
        pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0x88);
        if (pcVar2 == (code *)0x0) {
          uVar7 = 0x80004001;
          goto LAB_180045c63;
        }
        uVar5 = (*pcVar2)(param_1,local_78);
        uVar7 = (ulonglong)uVar5;
        if ((int)uVar5 < 0) goto LAB_180045c63;
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x151,&DAT_180072bc8,
                        (undefined4)local_78[0]);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterCheckForDuplicate",0x175e,0,
                   (undefined *)L"WbioStorageGetRecordCount=%u");
        uVar6 = FUN_180055750(param_1);
        uVar7 = uVar6 & 0xffffffff;
        if ((int)uVar6 < 0) {
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
            FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x152,&DAT_180072bc8);
          }
          pwVar10 = L"WbioStorageFirstRecord error";
          uVar9 = 0x1765;
          goto LAB_180045ca9;
        }
        if (local_78[0] != 0) {
          do {
            if (*(longlong *)(param_1 + 0x28) == 0) {
              uVar7 = 0x80004003;
LAB_180045c0f:
              if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                  ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19]))
              {
                FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x153,&DAT_180072bc8);
              }
              pwVar10 = L"WbioStorageGetCurrentRecord error";
              uVar9 = 6000;
              goto LAB_180045ca9;
            }
            pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0xa0);
            if (pcVar2 == (code *)0x0) {
              uVar7 = 0x80004001;
              goto LAB_180045c0f;
            }
            uVar5 = (*pcVar2)(param_1,&local_68);
            uVar7 = (ulonglong)uVar5;
            if ((int)uVar5 < 0) goto LAB_180045c0f;
            FUN_18004e620(param_1,*(uint **)(lVar1 + 0x18),(uint)*(undefined8 *)(lVar1 + 0x20),
                          local_48,(uint)local_40,local_res8);
            if (local_res8[0] != '\0') {
              if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                  ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19]))
              {
                FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x155,&DAT_180072bc8);
              }
              debug_print_FUN_18003fc70
                        ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                         (undefined *)L"EngineAdapterCheckForDuplicate",0x178d,0,
                         (undefined *)L"Duplicate with stored template");
              uVar8 = 0;
              uVar9 = local_68[1];
              uVar3 = local_68[2];
              uVar4 = local_68[3];
              *(undefined4 *)param_2 = *local_68;
              *(undefined4 *)((longlong)param_2 + 4) = uVar9;
              *(undefined4 *)(param_2 + 1) = uVar3;
              *(undefined4 *)((longlong)param_2 + 0xc) = uVar4;
              uVar9 = local_68[5];
              uVar3 = local_68[6];
              uVar4 = local_68[7];
              *(undefined4 *)(param_2 + 2) = local_68[4];
              *(undefined4 *)((longlong)param_2 + 0x14) = uVar9;
              *(undefined4 *)(param_2 + 3) = uVar3;
              *(undefined4 *)((longlong)param_2 + 0x1c) = uVar4;
              uVar9 = local_68[9];
              uVar3 = local_68[10];
              uVar4 = local_68[0xb];
              *(undefined4 *)(param_2 + 4) = local_68[8];
              *(undefined4 *)((longlong)param_2 + 0x24) = uVar9;
              *(undefined4 *)(param_2 + 5) = uVar3;
              *(undefined4 *)((longlong)param_2 + 0x2c) = uVar4;
              uVar9 = local_68[0xd];
              uVar3 = local_68[0xe];
              uVar4 = local_68[0xf];
              *(undefined4 *)(param_2 + 6) = local_68[0xc];
              *(undefined4 *)((longlong)param_2 + 0x34) = uVar9;
              *(undefined4 *)(param_2 + 7) = uVar3;
              *(undefined4 *)((longlong)param_2 + 0x3c) = uVar4;
              param_2[8] = *(undefined8 *)(local_68 + 0x10);
              *(undefined4 *)(param_2 + 9) = local_68[0x12];
              *param_3 = (undefined)local_60;
              *param_4 = 1;
              if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                  ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19]))
              {
                FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x158,&DAT_180072bc8);
              }
              debug_print_FUN_18003fc70
                        ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                         (undefined *)L"EngineAdapterCheckForDuplicate",0x17af,0,
                         (undefined *)L"Duplicate with stored template");
              goto LAB_180045d84;
            }
            uVar6 = FUN_180055780(param_1);
            uVar7 = uVar6 & 0xffffffff;
            if ((int)uVar6 < 0) {
              if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                  ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (2 < (byte)PTR_LOOP_1800aff38[0x19]))
              {
                FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x156,&DAT_180072bc8);
              }
              debug_print_FUN_18003fc70
                        ((longlong)PTR_DAT_1800afca8,5,(undefined *)L"EngineAdapter.cpp",
                         (undefined *)L"EngineAdapterCheckForDuplicate",0x1797,0,
                         (undefined *)L"WbioStorageNextRecord error");
              if ((int)uVar7 == -0x7ff67fe0) {
                if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                    ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) &&
                   (2 < (byte)PTR_LOOP_1800aff38[0x19])) {
                  FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x157,&DAT_180072bc8);
                }
                debug_print_FUN_18003fc70
                          ((longlong)PTR_DAT_1800afca8,5,(undefined *)L"EngineAdapter.cpp",
                           (undefined *)L"EngineAdapterCheckForDuplicate",0x179b,0,
                           (undefined *)L"WINBIO_E_DATABASE_NO_MORE_RECORDS");
                uVar8 = 0;
                goto LAB_180045d84;
              }
              break;
            }
            uVar8 = uVar8 + 1;
          } while (uVar8 < local_78[0]);
        }
      }
      uVar8 = uVar7;
      if ((int)uVar8 == -0x7ff67fe1) {
        uVar8 = 0;
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (2 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x159,&DAT_180072bc8);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,5,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterCheckForDuplicate",0x17b9,0,
                   (undefined *)L"WINBIO_E_DATABASE_NO_RESULTS");
      }
      goto LAB_180045d84;
    }
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x14c,&DAT_180072bc8);
    }
    uVar5 = 4;
    pwVar10 = L"Enginecontext NULL";
    uVar9 = 0x171b;
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,uVar5,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterCheckForDuplicate",uVar9,0,(undefined *)pwVar10);
  uVar8 = 0x80004003;
LAB_180045d84:
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x15a,&DAT_180072bc8,(int)uVar8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterCheckForDuplicate",0x17c0,0,(undefined *)L"Exit, hr=0x%x");
  return uVar8;
}



undefined8 FUN_180046660(longlong param_1)

{
  longlong lVar1;
  uint uVar2;
  undefined8 uVar3;
  undefined4 uVar4;
  wchar_t *pwVar5;

  uVar3 = 0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x16b,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterDiscardEnrollment",0x18a2,0,(undefined *)L"Entry");
  if (param_1 == 0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x16c,&DAT_180072bc8);
    }
    uVar2 = 2;
    pwVar5 = L"Arg error";
    uVar4 = 0x18a8;
  }
  else {
    lVar1 = *(longlong *)(param_1 + 0x38);
    if (lVar1 != 0) {
      if (*(int *)(lVar1 + 8) == 1) {
        FUN_18004ec10(lVar1);
      }
      else {
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x16e,&DAT_180072bc8);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterDiscardEnrollment",0x18be,0,
                   (undefined *)L"Enrollment not in progress error");
        uVar3 = 0x8009800f;
      }
      goto LAB_180046828;
    }
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x16d,&DAT_180072bc8);
    }
    uVar2 = 4;
    pwVar5 = L"Enginecontext NULL";
    uVar4 = 0x18b4;
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,uVar2,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterDiscardEnrollment",uVar4,0,(undefined *)pwVar5);
  uVar3 = 0x80004003;
LAB_180046828:
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x16f,&DAT_180072bc8,(int)uVar3);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterDiscardEnrollment",0x18d0,0,(undefined *)L"Exit, hr=0x%x");
  return uVar3;
}



// WARNING: Could not reconcile some variable overlaps

void EngineAdapterControlUnit_FUN_1800468b0
               (HANDLE *param_1,DWORD param_2,undefined8 *param_3,ulonglong param_4,
               undefined8 *param_5,ulonglong param_6,ulonglong *param_7,int *param_8)

{
  ushort *puVar1;
  ushort uVar2;
  HANDLE pvVar3;
  LPVOID pvVar4;
  HANDLE *ppvVar5;
  char cVar6;
  int iVar7;
  uint uVar8;
  DWORD DVar9;
  ulonglong uVar10;
  undefined8 uVar11;
  ulonglong *puVar12;
  ulonglong *puVar13;
  undefined8 *puVar14;
  undefined2 uVar15;
  int iVar16;
  longlong lVar17;
  longlong lVar18;
  ushort *puVar19;
  int iVar20;
  ulonglong uVar21;
  wchar_t *pwVar22;
  wchar_t *pwVar23;
  uint uVar24;
  ushort uVar25;
  ulonglong *puVar26;
  ulonglong uVar27;
  undefined4 uVar28;
  undefined4 uStack452;
  ulonglong uStack456;
  undefined8 local_1c0;
  undefined8 local_1b8;
  undefined4 local_1b0;
  undefined4 local_1a8;
  undefined8 *local_198;
  ulonglong *local_190;
  int local_188;
  undefined8 *local_180;
  undefined8 local_178;
  undefined8 local_170;
  void *local_168;
  ulonglong *local_160;
  HANDLE *local_158;
  _OVERLAPPED local_150;
  undefined8 local_128;
  undefined4 local_120;
  undefined4 uStack284;
  undefined4 uStack280;
  undefined4 local_114;
  undefined4 uStack272;
  undefined4 uStack268;
  undefined4 local_108;
  undefined8 local_104;
  undefined8 local_98;
  undefined8 local_90;
  undefined8 local_88;
  undefined8 local_80;
  undefined8 local_78;
  undefined8 local_70;
  undefined8 local_68;
  undefined8 local_60;
  ulonglong local_58;

  local_58 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffdf8;
  local_190 = param_7;
  local_160 = (ulonglong *)((ulonglong)local_160 & 0xffffffff00000000 | (ulonglong)param_2);
  local_198 = param_5;
  local_158 = param_1;
  FUN_18003d660((longlong)"%s %d Entry","EngineAdapterControlUnit",0x18eb,param_4);
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x170,&DAT_180072bc8);
  }
  pwVar22 = L"EngineAdapterControlUnit";
  uVar27 = 0;
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterControlUnit",0x18ed,0,(undefined *)L"Entry");
  local_150.Internal = 0;
  local_150.InternalHigh = 0;
  local_150.u = 0;
  local_150.hEvent = (HANDLE)0x0;
  if (((param_1 == (HANDLE *)0x0) || (param_3 == (undefined8 *)0x0)) ||
     ((param_5 == (undefined8 *)0x0 || ((local_190 == (ulonglong *)0x0 || (param_8 == (int *)0x0))))
     )) {
    uVar27 = 0x80004003;
    FUN_18003d660((longlong)"%s %d Error, Ivalid args","EngineAdapterControlUnit",0x1902,pwVar22);
    if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
       (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x171,&DAT_180072bc8);
    }
    pwVar22 = L"Error, Ivalid args";
    uVar28 = 0x1904;
LAB_1800496e3:
    uVar8 = 2;
  }
  else {
    *param_8 = 0;
    pvVar3 = param_1[7];
    if (pvVar3 == (HANDLE)0x0) {
      uVar27 = 0x8009800f;
      FUN_18003d660((longlong)"%s %d Error, Enginecontext NULL","EngineAdapterControlUnit",0x1911,
                    pwVar22);
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x172,&DAT_180072bc8);
      }
      pwVar22 = L"Enginecontext NULL";
      uVar28 = 0x1913;
      goto LAB_1800496e3;
    }
    if (param_2 == 0x442140) {
      uVar10 = EntryTestControl_FUN_18004b7a0
                         ((longlong)param_1,(int *)param_3,param_4,(int *)local_198,param_6,
                          local_190,param_8);
      uVar27 = uVar10 & 0xffffffff;
      if ((int)uVar10 != 0) {
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,1,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterControlUnit",0x191c,0,
                   (undefined *)L"%u Control Code process return false!");
      }
      goto LAB_180049702;
    }
    DVar9 = (DWORD)param_4;
    if (param_2 == 0x44201c) {
      FUN_18003d660((longlong)"%s %d IOCTL_BIOMETRIC_FOR_GENERAL_CONTROL","EngineAdapterControlUnit"
                    ,0x1923,pwVar22);
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x173,&DAT_180072bc8);
      }
      pwVar22 = L"EngineAdapterControlUnit";
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"EngineAdapterControlUnit",0x1925,0,
                 (undefined *)L"IOCTL_BIOMETRIC_FOR_GENERAL_CONTROL");
      puVar12 = local_190;
      puVar14 = local_198;
      if ((param_4 < 0x404) || (param_6 < 0x108)) {
        FUN_18003d660((longlong)"%s %d wrong buffer size for general control",
                      "EngineAdapterControlUnit",0x192a,pwVar22);
        if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
           (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
          FUN_180054880(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x174,&DAT_180072bc8,DVar9,
                        (char)param_6);
        }
        pwVar22 = L"TEST-Error, SendBufferSize or ReceiveDataSize not enough=%u, %u";
        uVar28 = 0x192c;
LAB_18004746d:
        uStack456 = param_6;
        uVar27 = 0x80070057;
        uVar8 = 2;
LAB_180047472:
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,uVar8,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterControlUnit",uVar28,0,(undefined *)pwVar22);
        goto LAB_180049702;
      }
      *(undefined *)local_198 = *(undefined *)param_3;
      *(undefined *)((longlong)local_198 + 2) = *(undefined *)((longlong)param_3 + 2);
      *(undefined *)((longlong)local_198 + 1) = *(undefined *)((longlong)param_3 + 1);
      *(undefined2 *)((longlong)local_198 + 4) = 0;
      *local_190 = 0x108;
      if (3 < *(byte *)param_3) {
        *(undefined2 *)((longlong)local_198 + 4) = 1;
        uVar27 = 0x80070057;
        FUN_18003d660((longlong)"%s %d unknown control_type: %d","EngineAdapterControlUnit",0x193e,
                      (ulonglong)*(byte *)param_3);
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
          FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x175,&DAT_180072bc8,
                        (uint)*(byte *)param_3);
        }
        pwVar22 = L"TEST-unknown control_type=%d";
        uVar28 = 0x1940;
        goto LAB_180049546;
      }
      FUN_18003d660((longlong)

                    "%s %d TEST-keep pass-in data:control_type: %d, commonLogFlag:%d, version_sub_type:%d"
                    ,"EngineAdapterControlUnit",0x1944,(ulonglong)*(byte *)param_3);
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
        FUN_180055140(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x176,&DAT_180072bc8,
                      (uint)*(byte *)param_3,*(undefined *)((longlong)param_3 + 2),
                      *(undefined *)((longlong)param_3 + 1));
      }
      local_1c0 = CONCAT44(local_1c0._4_4_,(uint)*(byte *)((longlong)param_3 + 1));
      uStack456 = CONCAT44(uStack452,(uint)*(byte *)((longlong)param_3 + 2));
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"EngineAdapterControlUnit",0x1949,0,
                 (undefined *)
                 L"TEST-keep pass-in data: control_type: %d, commonLogFlag:%d, version_sub_type:%d")
      ;
      cVar6 = *(char *)param_3;
      if (cVar6 == '\x01') {
        FUN_18003d660((longlong)"%s %d Change log setting,log_flag=%d","EngineAdapterControlUnit",
                      0x194c,(ulonglong)*(byte *)((longlong)param_3 + 2));
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x177,&DAT_180072bc8,
                        (uint)*(byte *)((longlong)param_3 + 2));
        }
        pwVar23 = L"EngineAdapterControlUnit";
        pwVar22 = L"EngineAdapter.cpp";
        uVar11 = 7;
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterControlUnit",0x194e,0,
                   (undefined *)L"TEST-Change log setting,log_flag=%d");
        FUN_18003da20(*(undefined *)((longlong)param_3 + 2));
        if (*(char *)((longlong)param_3 + 2) != '\0') {
          FUN_18003d9a0((longlong)param_3 + 4);
          FUN_18003d660((longlong)"----- first log after turning on the log----- ",uVar11,pwVar22,
                        pwVar23);
        }
        goto LAB_180047761;
      }
      if (cVar6 == '\x02') {
        FUN_18003d660((longlong)"%s %d Get version info: version_type=%d","EngineAdapterControlUnit"
                      ,0x1958,(ulonglong)*(byte *)((longlong)param_3 + 1));
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x178,&DAT_180072bc8,
                        (uint)*(byte *)((longlong)param_3 + 1));
        }
        pwVar22 = L"EngineAdapterControlUnit";
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterControlUnit",0x195a,0,
                   (undefined *)L"TEST-Get version info: version_type=%d");
        cVar6 = *(char *)((longlong)param_3 + 1);
        if (cVar6 == '\x01') {
          local_98 = 0;
          local_90 = 0;
          local_88 = (ulonglong *)0x0;
          local_80 = (ulonglong *)0x0;
          local_78 = 0;
          local_70 = 0;
          local_68 = 0;
          local_60 = 0;
          uVar10 = getAlgorithmVersion((uint *)&local_98);
          local_60 = local_60 & 0xffffffffffffff;
          if ((int)uVar10 == 0) {
            *(undefined4 *)(puVar14 + 9) = (undefined4)local_98;
            *(undefined4 *)((longlong)puVar14 + 0x4c) = local_98._4_4_;
            *(undefined4 *)(puVar14 + 10) = (undefined4)local_90;
            *(undefined4 *)((longlong)puVar14 + 0x54) = local_90._4_4_;
            *(undefined4 *)(puVar14 + 0xb) = (undefined4)local_88;
            *(undefined4 *)((longlong)puVar14 + 0x5c) = local_88._4_4_;
            *(undefined4 *)(puVar14 + 0xc) = (undefined4)local_80;
            *(undefined4 *)((longlong)puVar14 + 100) = local_80._4_4_;
            *(undefined4 *)(puVar14 + 0xd) = (undefined4)local_78;
            *(undefined4 *)((longlong)puVar14 + 0x6c) = local_78._4_4_;
            *(undefined4 *)(puVar14 + 0xe) = (undefined4)local_70;
            *(undefined4 *)((longlong)puVar14 + 0x74) = local_70._4_4_;
            *(undefined4 *)(puVar14 + 0xf) = (undefined4)local_68;
            *(undefined4 *)((longlong)puVar14 + 0x7c) = local_68._4_4_;
            *(undefined4 *)(puVar14 + 0x10) = (undefined4)local_60;
            *(undefined4 *)((longlong)puVar14 + 0x84) = local_60._4_4_;
            FUN_18003d660((longlong)"%s %d Get algorithmVersion=%s","EngineAdapterControlUnit",
                          0x1965,&local_98);
            if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
              FUN_180055570(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x179,&DAT_180072bc8,
                            (undefined *)(puVar14 + 9),(char)*(undefined4 *)puVar12);
            }
            uStack456 = uStack456 & 0xffffffff00000000 | (ulonglong)*(uint *)puVar12;
            pwVar22 = L"TEST-Get algorithmVersion=%S, ReceiveDataSize=%u";
            uVar8 = 7;
            uVar28 = 0x1967;
            goto LAB_180047472;
          }
          *(undefined2 *)((longlong)puVar14 + 4) = 1;
          uVar27 = 1;
          FUN_18003d660((longlong)"%s %d Get algorithmVersion failed, ret=0x%x",
                        "EngineAdapterControlUnit",0x196e,uVar10 & 0xffffffff);
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
            FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x17a,&DAT_180072bc8,
                          (int)(uVar10 & 0xffffffff));
          }
          pwVar22 = L"TEST-Get algorithmVersion fail, ret=0x%x";
          uVar28 = 0x1970;
          uVar8 = 7;
        }
        else {
          if (cVar6 == '\x02') {
            *(undefined4 *)(puVar14 + 1) = 0x776f6c46;
            *(undefined4 *)((longlong)puVar14 + 0xc) = 0x2e31565f;
            *(undefined4 *)(puVar14 + 2) = 0x20302e31;
            *(undefined4 *)((longlong)puVar14 + 0x14) = 0x65736142;
            puVar14[3] = 0x323630363130325f;
            *(undefined *)(puVar14 + 4) = 0x32;
            FUN_18003d660((longlong)"%s %d Get Internal version %s","EngineAdapterControlUnit",
                          0x1978,"Flow_V1.1.0 Base_20160622");
            if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
              FUN_180055510(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x17b,&DAT_180072bc8,
                            (undefined *)(puVar14 + 1));
            }
            pwVar22 = L"TEST-Get internalVersion=%S";
            uVar28 = 0x197a;
            uVar8 = 7;
          }
          else {
            if ((cVar6 == '\0') || (cVar6 == '\x03')) {
              FUN_18003d660((longlong)"%s %d for firmware/driver version, go to driver",
                            "EngineAdapterControlUnit",0x197f,pwVar22);
              if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                 (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (3 < (byte)PTR_LOOP_1800aff38[0x19]))))
              {
                FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x17c,&DAT_180072bc8);
              }
              pwVar23 = L"EngineAdapterControlUnit";
              debug_print_FUN_18003fc70
                        ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                         (undefined *)L"EngineAdapterControlUnit",0x1981,0,
                         (undefined *)L"TEST-transfer get firmware/driver version request to driver"
                        );
              goto LAB_180047761;
            }
            *(undefined2 *)((longlong)puVar14 + 4) = 1;
            uVar27 = 1;
            FUN_18003d660((longlong)"%s %d not supported version type %d","EngineAdapterControlUnit"
                          ,0x1988,(ulonglong)*(byte *)((longlong)param_3 + 1));
            if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
              FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x17d,&DAT_180072bc8,
                            (uint)*(byte *)((longlong)param_3 + 1));
            }
            pwVar22 = L"not supported version type %d";
            uVar28 = 0x198a;
            uVar8 = 7;
          }
        }
      }
      else {
        if (cVar6 == '\x03') {
          FUN_18003d660((longlong)"%s %d Get sensor info: control_type=%d",
                        "EngineAdapterControlUnit",0x1990,3);
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
            FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x17e,&DAT_180072bc8,
                          (uint)*(byte *)param_3);
          }
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"EngineAdapterControlUnit",0x1992,0,
                     (undefined *)L"Get sensor info: control_type=%d");
          lVar17 = (longlong)DAT_1800b17c8 * 0xe;
          *(int *)(puVar14 + 1) = DAT_1800b17c8;
          *(undefined8 *)((longlong)puVar14 + 0xc) = *(undefined8 *)(&DAT_1800afd10 + lVar17);
          *(undefined4 *)((longlong)puVar14 + 0x14) = *(undefined4 *)(&DAT_1800afd18 + lVar17);
          *(undefined2 *)(puVar14 + 3) = *(undefined2 *)(&DAT_1800afd1c + lVar17);
          FUN_18003d660((longlong)"%s %d Got sensor info: control_type=%d, sensor type=%d",
                        "EngineAdapterControlUnit",0x1997,(ulonglong)*(byte *)param_3);
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
            FUN_1800550f0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x17f,&DAT_180072bc8,
                          (uint)*(byte *)param_3,(char)*(undefined4 *)(puVar14 + 1));
          }
          uStack456 = uStack456 & 0xffffffff00000000 | (ulonglong)*(uint *)(puVar14 + 1);
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"EngineAdapterControlUnit",0x1999,0,
                     (undefined *)L"Got sensor info: control_type=%d, sensor type=%d");
          goto LAB_180049702;
        }
        *(undefined2 *)((longlong)puVar14 + 4) = 1;
        uVar27 = 1;
        FUN_18003d660((longlong)"%s %d not supported type for general control type %d",
                      "EngineAdapterControlUnit",0x19a1,(ulonglong)*(byte *)param_3);
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x180,&DAT_180072bc8,
                        (uint)*(byte *)param_3);
        }
        pwVar22 = L"not supported type for general control=%d";
        uVar28 = 0x19a3;
        uVar8 = 7;
      }
LAB_18004954b:
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,uVar8,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"EngineAdapterControlUnit",uVar28,0,(undefined *)pwVar22);
      goto LAB_180049702;
    }
    if (param_2 == 0x442014) {
      uVar27 = 0x80004003;
      goto LAB_180049702;
    }
    if (param_2 == 0x442018) {
      FUN_18003d660((longlong)"%s %d IOCTL_BIOMETRIC_FOR_TEST_WHOLE","EngineAdapterControlUnit",
                    0x19e4,pwVar22);
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x187,&DAT_180072bc8);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"EngineAdapterControlUnit",0x19e6,0,
                 (undefined *)L"IOCTL_BIOMETRIC_FOR_TEST_WHOLE");
      if ((param_4 < 0x8c) || (param_6 < 0x88)) {
        *param_8 = 1;
        FUN_18003d660((longlong)"%s %d wrong buffer size SendBufferSize=%u, ReceiveBufferSize=%u",
                      "EngineAdapterControlUnit",0x19eb,param_4);
        if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
           (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
          FUN_180054880(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x188,&DAT_180072bc8,DVar9,
                        (char)param_6);
        }
        pwVar22 = L"wrong buffer size SendBufferSize=%u, ReceiveBufferSize=%u";
        uVar28 = 0x19ed;
        goto LAB_18004746d;
      }
      if (7 < *(byte *)param_3) {
        *param_8 = 1;
        uVar27 = 0x80070057;
        FUN_18003d660((longlong)"%s %d TEST-unknown control_type=%d","EngineAdapterControlUnit",
                      0x19f6,(ulonglong)*(byte *)param_3);
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
          FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x189,&DAT_180072bc8,
                        (uint)*(byte *)param_3);
        }
        pwVar22 = L"TEST-unknown control_type=%d";
        uVar28 = 0x19f8;
        goto LAB_180049546;
      }
      puVar14 = (undefined8 *)((longlong)pvVar3 + 0x53c);
      memcpy_FUN_180061f90(puVar14,param_3,param_4);
      local_180 = (undefined8 *)((longlong)pvVar3 + 0x5c8);
      *(byte *)local_180 = *(byte *)puVar14;
      *(undefined *)((longlong)pvVar3 + 0x5c9) = 1;
      *(undefined2 *)((longlong)pvVar3 + 0x5ca) = 0;
      FUN_18003d660((longlong)"%s %d IOCTL_BIOMETRIC_FOR_TEST_WHOLE: test_type:%d",
                    "EngineAdapterControlUnit",0x1a04,(ulonglong)*(byte *)puVar14);
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
        FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x18a,&DAT_180072bc8,
                      (uint)*(byte *)puVar14);
      }
      pwVar23 = L"EngineAdapterControlUnit";
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"EngineAdapterControlUnit",0x1a06,0,
                 (undefined *)L"IOCTL_BIOMETRIC_FOR_TEST_WHOLE: test_type:%d");
      cVar6 = *(char *)puVar14;
      if (cVar6 == '\0') {
        FUN_18003d660((longlong)"%s %d ENUM_TEST_WHOLE_TEST_TYPE_OFF","EngineAdapterControlUnit",
                      0x1a09,pwVar23);
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x18b,&DAT_180072bc8);
        }
        pwVar23 = L"EngineAdapterControlUnit";
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterControlUnit",0x1a0b,0,
                   (undefined *)L"ENUM_TEST_WHOLE_TEST_TYPE_OFF");
        memset(puVar14,0,0x8c);
        puVar14 = local_198;
        goto LAB_180047761;
      }
      puVar14 = local_198;
      if (cVar6 == '\x03') {
        if (*(int *)((longlong)pvVar3 + 0x560) == 0) {
          FUN_18003d660((longlong)"%s %d ENUM_TEST_PixelOpenShort_STAGE_BeforeDACChange",
                        "EngineAdapterControlUnit",0x1a12,pwVar23);
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
            FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x18c,&DAT_180072bc8);
          }
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"EngineAdapterControlUnit",0x1a14,0,
                     (undefined *)L"ENUM_TEST_PixelOpenShort_STAGE_BeforeDACChange");
          *(undefined8 *)((longlong)pvVar3 + 0x6e0) = 0;
          *(undefined8 *)((longlong)pvVar3 + 0x6e8) = 0;
          uVar11 = FUN_18004cea0((ulonglong)*(uint *)((longlong)pvVar3 + 0x544));
          *(undefined8 *)((longlong)pvVar3 + 0x6e0) = uVar11;
          uVar11 = FUN_18004cea0((ulonglong)*(uint *)((longlong)pvVar3 + 0x544));
          *(undefined8 *)((longlong)pvVar3 + 0x6e8) = uVar11;
          FUN_18003d660((longlong)
                        "%s %d ENUM_TEST_PixelOpenShort_STAGE_BeforeDACChange alloc %d to %p and %p"
                        ,"EngineAdapterControlUnit",0x1a19,
                        (ulonglong)*(uint *)((longlong)pvVar3 + 0x544));
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
            FUN_180055360(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x18d,&DAT_180072bc8,
                          *(undefined4 *)((longlong)pvVar3 + 0x544),
                          (char)*(undefined8 *)((longlong)pvVar3 + 0x6e0),
                          (char)*(undefined8 *)((longlong)pvVar3 + 0x6e8));
          }
          local_1c0 = *(ulonglong *)((longlong)pvVar3 + 0x6e8);
          pwVar23 = L"EngineAdapterControlUnit";
          uStack456 = *(ulonglong *)((longlong)pvVar3 + 0x6e0);
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"EngineAdapterControlUnit",0x1a1b,0,
                     (undefined *)
                     L"ENUM_TEST_PixelOpenShort_STAGE_BeforeDACChange alloc %d to %p and %p");
          if (*(LPVOID *)((longlong)pvVar3 + 0x6e0) != (LPVOID)0x0) {
            puVar14 = local_198;
            if (*(longlong *)((longlong)pvVar3 + 0x6e8) != 0) goto LAB_180047761;
            FUN_1800501e0(*(LPVOID *)((longlong)pvVar3 + 0x6e0));
            *(undefined8 *)((longlong)pvVar3 + 0x6e0) = 0;
          }
          if (*(LPVOID *)((longlong)pvVar3 + 0x6e8) != (LPVOID)0x0) {
            FUN_1800501e0(*(LPVOID *)((longlong)pvVar3 + 0x6e8));
            *(undefined8 *)((longlong)pvVar3 + 0x6e8) = 0;
          }
          *(undefined *)((longlong)pvVar3 + 0x5c9) = 2;
          *(undefined2 *)((longlong)pvVar3 + 0x5ca) = 1;
          *param_8 = 1;
          FUN_18003d660((longlong)

                        "%s %d fail to alloc space for ENUM_TEST_PixelOpenShort_STAGE_BeforeDACChange"
                        ,"EngineAdapterControlUnit",0x1a2c,pwVar23);
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
            FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x18e,&DAT_180072bc8);
          }
          pwVar22 = L"fail to alloc space for ENUM_TEST_PixelOpenShort_STAGE_BeforeDACChange";
          uVar28 = 0x1a2e;
LAB_180047af3:
          uVar27 = 0x80004004;
          uVar8 = 2;
        }
        else {
          if (*(int *)((longlong)pvVar3 + 0x560) != 4) goto LAB_180047761;
          FUN_18003d660((longlong)"%s %d ENUM_TEST_PixelOpenShort_STAGE_Result",
                        "EngineAdapterControlUnit",0x1a36,pwVar23);
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
            FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),399,&DAT_180072bc8);
          }
          pwVar22 = L"EngineAdapterControlUnit";
          uVar10 = 0;
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"EngineAdapterControlUnit",0x1a38,0,
                     (undefined *)L"ENUM_TEST_PixelOpenShort_STAGE_Result");
          lVar17 = *(longlong *)((longlong)pvVar3 + 0x6e0);
          if ((lVar17 == 0) || (lVar18 = *(longlong *)((longlong)pvVar3 + 0x6e8), lVar18 == 0)) {
            *(undefined *)((longlong)pvVar3 + 0x5c9) = 2;
            *(undefined2 *)((longlong)pvVar3 + 0x5ca) = 1;
            *param_8 = 1;
            FUN_18003d660((longlong)
                          "%s %d fail to alloc space for ENUM_TEST_PixelOpenShort_STAGE_Result",
                          "EngineAdapterControlUnit",0x1a3f,pwVar22);
            if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
               (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
              FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),400,&DAT_180072bc8);
            }
            pwVar22 = L"fail to alloc space for ENUM_TEST_PixelOpenShort_STAGE_Result";
            uVar28 = 0x1a41;
            goto LAB_180047af3;
          }
          local_188 = *(ushort *)((longlong)pvVar3 + 0x540) - 1;
          uVar25 = 0;
          iVar20 = 1;
          if (1 < local_188) {
            do {
              if (1 < (int)(*(ushort *)((longlong)pvVar3 + 0x542) - 1)) {
                uVar21 = (ulonglong)(*(ushort *)((longlong)pvVar3 + 0x542) - 2);
                puVar19 = (ushort *)
                          (lVar17 + (longlong)
                                    (int)((uint)*(ushort *)((longlong)pvVar3 + 0x542) * iVar20 + 1)
                                    * 2);
                do {
                  puVar1 = (ushort *)((lVar18 - lVar17) + (longlong)puVar19);
                  uVar2 = *puVar19;
                  puVar19 = puVar19 + 1;
                  iVar16 = (uint)uVar2 - (uint)*puVar1;
                  uVar10 = (ulonglong)(uint)((int)uVar10 + iVar16);
                  uVar2 = uVar25 + 1;
                  if ((int)(uint)*(ushort *)((longlong)pvVar3 + 0x568) <= iVar16) {
                    uVar2 = uVar25;
                  }
                  uVar25 = uVar2;
                  uVar21 = uVar21 - 1;
                } while (uVar21 != 0);
                lVar18 = *(longlong *)((longlong)pvVar3 + 0x6e8);
              }
              iVar20 = iVar20 + 1;
            } while (iVar20 < local_188);
          }
          *(ushort *)((longlong)pvVar3 + 0x5d8) = uVar25;
          uVar8 = (uint)(uVar10 / ((*(ushort *)((longlong)pvVar3 + 0x542) - 1) *
                                  (*(ushort *)((longlong)pvVar3 + 0x540) - 1)));
          *(uint *)((longlong)pvVar3 + 0x5d4) = uVar8;
          if (((*(ushort *)((longlong)pvVar3 + 0x56e) < uVar8) ||
              (uVar8 < *(ushort *)((longlong)pvVar3 + 0x56c))) ||
             (*(ushort *)((longlong)pvVar3 + 0x56a) <= uVar25)) {
            *(undefined4 *)((longlong)pvVar3 + 0x5dc) = 1;
          }
          else {
            *(undefined4 *)((longlong)pvVar3 + 0x5dc) = 0;
          }
          FUN_18003d660((longlong)

                        "%s %d ENUM_TEST_PixelOpenShort_STAGE_Result dead pixel count:%d, AvgDiff:%d, PASS(0) or Fail(1):%d"
                        ,"EngineAdapterControlUnit",0x1a70,(ulonglong)(uint)uVar25);
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
            FUN_180055140(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x191,&DAT_180072bc8,
                          (uint)uVar25,(char)*(undefined4 *)((longlong)pvVar3 + 0x5d4),
                          (char)*(undefined4 *)((longlong)pvVar3 + 0x5dc));
          }
          pwVar22 = L"EngineAdapterControlUnit";
          local_1c0 = CONCAT44(local_1c0._4_4_,*(undefined4 *)((longlong)pvVar3 + 0x5dc));
          uStack456 = CONCAT44(uStack452,*(undefined4 *)((longlong)pvVar3 + 0x5d4));
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"EngineAdapterControlUnit",0x1a75,0,
                     (undefined *)

                     L"ENUM_TEST_PixelOpenShort_STAGE_Result dead pixel count:%d, AvgDiff:%d, PASS(0) or Fail(1):%d"
                    );
          if (*(LPVOID *)((longlong)pvVar3 + 0x6e0) != (LPVOID)0x0) {
            FUN_1800501e0(*(LPVOID *)((longlong)pvVar3 + 0x6e0));
            *(undefined8 *)((longlong)pvVar3 + 0x6e0) = 0;
          }
          if (*(LPVOID *)((longlong)pvVar3 + 0x6e8) != (LPVOID)0x0) {
            FUN_1800501e0(*(LPVOID *)((longlong)pvVar3 + 0x6e8));
            *(undefined8 *)((longlong)pvVar3 + 0x6e8) = 0;
          }
          *(undefined *)((longlong)pvVar3 + 0x5c9) = 2;
          FUN_18003d660((longlong)"%s %d ENUM_TEST_PixelOpenShort_STAGE_Result done successfully",
                        "EngineAdapterControlUnit",0x1a82,pwVar22);
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
            FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x192,&DAT_180072bc8);
          }
          uVar8 = 9;
          pwVar22 = L"ENUM_TEST_PixelOpenShort_STAGE_Result done successfully";
          uVar28 = 0x1a84;
        }
LAB_180047af8:
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,uVar8,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterControlUnit",uVar28,0,(undefined *)pwVar22);
        memcpy_FUN_180061f90(local_198,local_180,param_6);
        *local_190 = param_6;
        goto LAB_180049702;
      }
      if (cVar6 == '\x04') {
        iVar20 = *(int *)((longlong)pvVar3 + 0x570);
        if (iVar20 == 0) {
          FUN_18003d660((longlong)"%s %d  in ENUM_TEST_DeadPixelTest_STAGE_Base",
                        "EngineAdapterControlUnit",0x1a8e,pwVar23);
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
            FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x193,&DAT_180072bc8);
          }
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"EngineAdapterControlUnit",0x1a90,0,
                     (undefined *)L"in ENUM_TEST_DeadPixelTest_STAGE_Base");
          *(undefined *)((longlong)pvVar3 + 0x6b8) = 0;
          *(undefined8 *)((longlong)pvVar3 + 0x6c0) = 0;
          *(undefined8 *)((longlong)pvVar3 + 0x6c8) = 0;
          *(undefined8 *)((longlong)pvVar3 + 0x6d0) = 0;
          *(undefined8 *)((longlong)pvVar3 + 0x6d8) = 0;
          uVar24 = (uint)*(byte *)((longlong)pvVar3 + 0x574) * *(int *)((longlong)pvVar3 + 0x580);
          uVar8 = ((uint)*(byte *)((longlong)pvVar3 + 0x575) -
                  (uint)*(byte *)((longlong)pvVar3 + 0x576)) * *(int *)((longlong)pvVar3 + 0x580);
          uVar11 = FUN_18004cea0((ulonglong)uVar24);
          *(undefined8 *)((longlong)pvVar3 + 0x6c0) = uVar11;
          uVar11 = FUN_18004cea0((ulonglong)uVar8);
          *(undefined8 *)((longlong)pvVar3 + 0x6d0) = uVar11;
          FUN_18003d660((longlong)
                        "%s %d ENUM_TEST_DeadPixelTest_STAGE_Base alloc %d, %d to %p and %p",
                        "EngineAdapterControlUnit",0x1a9b,(ulonglong)uVar24);
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
            FUN_1800552f0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x194,&DAT_180072bc8,uVar24,
                          (char)uVar8,(char)*(undefined8 *)((longlong)pvVar3 + 0x6c0),
                          (char)*(undefined8 *)((longlong)pvVar3 + 0x6d0));
          }
          local_1b8 = *(ulonglong *)((longlong)pvVar3 + 0x6d0);
          pwVar23 = L"EngineAdapterControlUnit";
          local_1c0 = *(ulonglong *)((longlong)pvVar3 + 0x6c0);
          uStack456 = CONCAT44(uStack452,uVar8);
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"EngineAdapterControlUnit",0x1a9d,0,
                     (undefined *)L"ENUM_TEST_DeadPixelTest_STAGE_Base alloc %d, %d to %p and %p");
          pvVar4 = *(LPVOID *)((longlong)pvVar3 + 0x6c0);
          *(LPVOID *)((longlong)pvVar3 + 0x6c8) = pvVar4;
          *(longlong *)((longlong)pvVar3 + 0x6d8) = *(longlong *)((longlong)pvVar3 + 0x6d0);
          if (pvVar4 != (LPVOID)0x0) {
            if (*(longlong *)((longlong)pvVar3 + 0x6d0) != 0) {
              puVar14 = local_198;
              param_2 = (DWORD)local_160;
              goto LAB_180047761;
            }
            FUN_1800501e0(pvVar4);
            *(undefined8 *)((longlong)pvVar3 + 0x6c0) = 0;
            *(undefined8 *)((longlong)pvVar3 + 0x6c8) = 0;
          }
          if (*(LPVOID *)((longlong)pvVar3 + 0x6d0) != (LPVOID)0x0) {
            FUN_1800501e0(*(LPVOID *)((longlong)pvVar3 + 0x6d0));
            *(undefined8 *)((longlong)pvVar3 + 0x6d0) = 0;
            *(undefined8 *)((longlong)pvVar3 + 0x6d8) = 0;
          }
          *param_8 = 1;
          uVar27 = 0x80004004;
          FUN_18003d660((longlong)"%s %d fail to alloc space for ENUM_TEST_DeadPixelTest_STAGE_Base"
                        ,"EngineAdapterControlUnit",0x1ab0,pwVar23);
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
            FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x195,&DAT_180072bc8);
          }
          pwVar22 = L"fail to alloc space for ENUM_TEST_DeadPixelTest_STAGE_Base";
          uVar28 = 0x1ab2;
          goto LAB_1800496e3;
        }
        if (iVar20 == 2) {
          FUN_18003d660((longlong)"%s %d  in ENUM_TEST_DeadPixelTest_STAGE_ImageFDTdown",
                        "EngineAdapterControlUnit",0x1ab8,pwVar23);
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
            FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x196,&DAT_180072bc8);
          }
          pwVar23 = L"EngineAdapterControlUnit";
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"EngineAdapterControlUnit",0x1aba,0,
                     (undefined *)L"in ENUM_TEST_DeadPixelTest_STAGE_ImageFDTdown");
          *(undefined *)((longlong)pvVar3 + 0x6b8) = 0;
          puVar14 = local_198;
        }
        else {
          if (iVar20 == 3) {
            FUN_18003d660((longlong)"%s %d  in ENUM_TEST_DeadPixelTest_STAGE_Result",
                          "EngineAdapterControlUnit",0x1abf,pwVar23);
            if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
              FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x197,&DAT_180072bc8);
            }
            pwVar22 = L"EngineAdapterControlUnit";
            iVar20 = 0;
            debug_print_FUN_18003fc70
                      ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                       (undefined *)L"EngineAdapterControlUnit",0x1ac1,0,
                       (undefined *)L"in ENUM_TEST_DeadPixelTest_STAGE_Result");
            local_98 = 0;
            local_90 = 0;
            local_88 = (ulonglong *)0x0;
            local_80 = (ulonglong *)0x0;
            local_178 = 0;
            local_170 = 0;
            local_168 = (void *)0x0;
            puVar12 = (ulonglong *)
                      FUN_18004cea0((ulonglong)*(byte *)((longlong)pvVar3 + 0x574) << 3);
            local_160 = puVar12;
            puVar13 = (ulonglong *)
                      FUN_18004cea0((longlong)
                                    (int)((uint)*(byte *)((longlong)pvVar3 + 0x575) -
                                         (uint)*(byte *)((longlong)pvVar3 + 0x576)) << 3);
            local_168 = (void *)FUN_18004cea0((longlong)
                                              (*(int *)((longlong)pvVar3 + 0x578) *
                                              *(int *)((longlong)pvVar3 + 0x57c)));
            memset(local_168,0,
                   (longlong)
                   (*(int *)((longlong)pvVar3 + 0x578) * *(int *)((longlong)pvVar3 + 0x57c)));
            if ((puVar12 == (ulonglong *)0x0) || (puVar13 == (ulonglong *)0x0)) {
              if (*(LPVOID *)((longlong)pvVar3 + 0x6c0) != (LPVOID)0x0) {
                FUN_1800501e0(*(LPVOID *)((longlong)pvVar3 + 0x6c0));
                *(undefined8 *)((longlong)pvVar3 + 0x6c0) = 0;
                *(undefined8 *)((longlong)pvVar3 + 0x6c8) = 0;
              }
              if (*(LPVOID *)((longlong)pvVar3 + 0x6d0) != (LPVOID)0x0) {
                FUN_1800501e0(*(LPVOID *)((longlong)pvVar3 + 0x6d0));
                *(undefined8 *)((longlong)pvVar3 + 0x6d0) = 0;
                *(undefined8 *)((longlong)pvVar3 + 0x6d8) = 0;
              }
              if (puVar12 != (ulonglong *)0x0) {
                FUN_1800501e0(puVar12);
              }
              if (puVar13 != (ulonglong *)0x0) {
                FUN_1800501e0(puVar13);
              }
              *(undefined *)((longlong)pvVar3 + 0x5c9) = 2;
              *(undefined2 *)((longlong)pvVar3 + 0x5ca) = 1;
              *param_8 = 1;
              FUN_18003d660((longlong)
                            "%s %d  fail to alloc space for  ENUM_TEST_DeadPixelTest_STAGE_Result",
                            "EngineAdapterControlUnit",0x1ae7,pwVar22);
              if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                  ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
                FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x198,&DAT_180072bc8);
              }
              pwVar22 = L"fail to alloc space for  ENUM_TEST_DeadPixelTest_STAGE_Result";
              uVar28 = 0x1ae9;
              goto LAB_180047af3;
            }
            iVar16 = 0;
            puVar26 = puVar12;
            if (*(char *)((longlong)pvVar3 + 0x574) != '\0') {
              do {
                puVar26 = local_160;
                if (*(ulonglong *)((longlong)pvVar3 + 0x6c8) <= *puVar12) break;
                if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                    ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) &&
                   (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
                  FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x199,&DAT_180072bc8,
                                iVar20);
                }
                debug_print_FUN_18003fc70
                          ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                           (undefined *)L"EngineAdapterControlUnit",0x1af5,0,
                           (undefined *)L"BaseData nframenum = %d");
                iVar7 = *(int *)((longlong)pvVar3 + 0x580) * iVar20;
                iVar20 = iVar20 + 1;
                *puVar12 = (longlong)iVar7 + *(longlong *)((longlong)pvVar3 + 0x6c0);
                puVar12 = puVar12 + 1;
                puVar26 = local_160;
              } while (iVar20 < (int)(uint)*(byte *)((longlong)pvVar3 + 0x574));
            }
            puVar12 = puVar13;
            if (*(char *)((longlong)pvVar3 + 0x576) != '\0') {
              do {
                puVar26 = local_160;
                if (*(ulonglong *)((longlong)pvVar3 + 0x6d8) <= *puVar12) break;
                if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                    ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) &&
                   (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
                  FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x19a,&DAT_180072bc8,
                                iVar16);
                }
                debug_print_FUN_18003fc70
                          ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                           (undefined *)L"EngineAdapterControlUnit",0x1b07,0,
                           (undefined *)L"ToouchData nframenum = %d");
                iVar20 = *(int *)((longlong)pvVar3 + 0x580) * iVar16;
                iVar16 = iVar16 + 1;
                *puVar12 = (longlong)iVar20 + *(longlong *)((longlong)pvVar3 + 0x6d0);
                puVar12 = puVar12 + 1;
                puVar26 = local_160;
              } while (iVar16 < (int)(uint)*(byte *)((longlong)pvVar3 + 0x576));
            }
            uVar27 = 0;
            local_98 = CONCAT62(CONCAT42(*(undefined4 *)((longlong)pvVar3 + 0x6c),
                                         *(undefined2 *)((longlong)pvVar3 + 0x57c)),
                                *(short *)((longlong)pvVar3 + 0x578));
            local_90._0_2_ = (ushort)*(byte *)((longlong)pvVar3 + 0x574);
            local_90 = local_90 & 0xffffffff00000000 |
                       (ulonglong)
                       CONCAT12(*(undefined *)((longlong)pvVar3 + 0x576),(ushort)local_90);
            local_88 = puVar26;
            local_80 = puVar13;
            FUN_18003d660((longlong)

                          "%s %d  ENUM_TEST_DeadPixelTest_STAGE_Result row=%d, col=%d, m_baseFrameNum=%d, m_touchFrameNum=%d"
                          ,"EngineAdapterControlUnit",0x1b28,
                          (ulonglong)(uint)(int)*(short *)((longlong)pvVar3 + 0x578));
            if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
              FUN_1800551a0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x19b,&DAT_180072bc8,
                            (int)(short)local_98,(char)((ulonglong)local_98 >> 0x10),(char)local_90,
                            (char)(local_90 >> 0x10));
            }
            local_1b8 = CONCAT44(local_1b8._4_4_,(int)local_90._2_2_);
            local_1c0 = CONCAT44(local_1c0._4_4_,(int)(short)(ushort)local_90);
            uStack456 = CONCAT44(uStack452,(int)local_98._2_2_);
            debug_print_FUN_18003fc70
                      ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                       (undefined *)L"EngineAdapterControlUnit",0x1b2c,0,
                       (undefined *)

                       L"ENUM_TEST_DeadPixelTest_STAGE_Result row=%d, col=%d, m_baseFrameNum=%d, m_touchFrameNum=%d"
                      );
            cVar6 = FUN_18005bfa0();
            uVar8 = SEXT14(cVar6);
            FUN_18003d660((longlong)

                          "%s %d  ENUM_TEST_DeadPixelTest_STAGE_Result nret=%d, total:%d, local:%d, localworst:%d, sigular:%d"
                          ,"EngineAdapterControlUnit",0x1b30,(ulonglong)uVar8);
            if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
              FUN_180055210(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x19c,&DAT_180072bc8,uVar8,
                            (char)local_178,(char)(local_178 >> 0x10),(char)(local_178 >> 0x20),
                            (char)local_170);
            }
            pwVar22 = L"EngineAdapterControlUnit";
            local_1b0 = (undefined4)local_170;
            local_1b8 = local_1b8 & 0xffffffff00000000 | local_178 >> 0x20 & 0xffff;
            local_1c0 = local_1c0 & 0xffffffff00000000 | local_178 >> 0x10 & 0xffff;
            uStack456 = uStack456 & 0xffffffff00000000 | local_178 & 0xffff;
            debug_print_FUN_18003fc70
                      ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                       (undefined *)L"EngineAdapterControlUnit",0x1b32,0,
                       (undefined *)

                       L"ENUM_TEST_DeadPixelTest_STAGE_Result nret=%d, total:%d, local:%d, localworst:%d, sigular:%d"
                      );
            *(undefined2 *)((longlong)pvVar3 + 0x5d0) = (undefined2)local_178;
            *(undefined2 *)((longlong)pvVar3 + 0x5d2) = local_178._2_2_;
            *(undefined2 *)((longlong)pvVar3 + 0x5d4) = local_178._4_2_;
            *(undefined4 *)((longlong)pvVar3 + 0x5d8) = (undefined4)local_170;
            *(uint *)((longlong)pvVar3 + 0x5e0) = (uint)(uVar8 != 1);
            if (*(LPVOID *)((longlong)pvVar3 + 0x6c0) != (LPVOID)0x0) {
              FUN_1800501e0(*(LPVOID *)((longlong)pvVar3 + 0x6c0));
              *(undefined8 *)((longlong)pvVar3 + 0x6c0) = 0;
              *(undefined8 *)((longlong)pvVar3 + 0x6c8) = 0;
            }
            if (*(LPVOID *)((longlong)pvVar3 + 0x6d0) != (LPVOID)0x0) {
              FUN_1800501e0(*(LPVOID *)((longlong)pvVar3 + 0x6d0));
              *(undefined8 *)((longlong)pvVar3 + 0x6d0) = 0;
              *(undefined8 *)((longlong)pvVar3 + 0x6d8) = 0;
            }
            FUN_1800501e0(puVar26);
            FUN_1800501e0(puVar13);
            *(undefined *)((longlong)pvVar3 + 0x5c9) = 2;
            FUN_18003d660((longlong)"%s %d  ENUM_TEST_DeadPixelTest_STAGE_Result done successfully",
                          "EngineAdapterControlUnit",0x1b5b,pwVar22);
            if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
              FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x19d,&DAT_180072bc8);
            }
            pwVar22 = L"ENUM_TEST_DeadPixelTest_STAGE_Result done successfully";
            uVar28 = 0x1b5d;
            uVar8 = 9;
            goto LAB_180047af8;
          }
        }
      }
      else {
        if (cVar6 == '\x05') {
          iVar20 = *(int *)((longlong)pvVar3 + 0x558);
          if (iVar20 == 0) {
            FUN_18003d660((longlong)"%s %d ENUM_TEST_Perf_STAGE_Start","EngineAdapterControlUnit",
                          0x1b68,pwVar23);
            if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
              FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x19e,&DAT_180072bc8);
            }
            pwVar22 = L"ENUM_TEST_Perf_STAGE_Start";
            uVar28 = 0x1b6a;
          }
          else {
            if (iVar20 != 1) {
              if (iVar20 == 2) {
                FUN_18003d660((longlong)"%s %d ENUM_TEST_Perf_STAGE_Result",
                              "EngineAdapterControlUnit",0x1b74,pwVar23);
                if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                    ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0'))
                {
                  FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1a0,&DAT_180072bc8);
                }
                debug_print_FUN_18003fc70
                          ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                           (undefined *)L"EngineAdapterControlUnit",0x1b76,0,
                           (undefined *)L"ENUM_TEST_Perf_STAGE_Result");
                uStack456 = CONCAT44(uStack452,*(undefined4 *)((longlong)pvVar3 + 0x5e0));
                FUN_18003d660((longlong)

                              "%s %d ENUM_TEST_Perf_STAGE_Result time1:%lu.%lu, time2:%lu.%lu, qualit:%d, coverage:%d"
                              ,"EngineAdapterControlUnit",0x1b78,
                              (ulonglong)*(uint *)((longlong)pvVar3 + 0x5cc));
                if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                    ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) &&
                   (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
                  uStack456 = uStack456 & 0xffffffff00000000 |
                              (ulonglong)*(uint *)((longlong)pvVar3 + 0x5e0);
                  FUN_180054c00(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1a1,&DAT_180072bc8,
                                *(undefined4 *)((longlong)pvVar3 + 0x5cc),
                                (char)*(undefined4 *)((longlong)pvVar3 + 0x5d0),
                                (char)*(undefined4 *)((longlong)pvVar3 + 0x5d4),
                                (char)*(undefined4 *)((longlong)pvVar3 + 0x5d8),
                                (char)*(undefined4 *)((longlong)pvVar3 + 0x5dc),
                                (char)*(uint *)((longlong)pvVar3 + 0x5e0));
                }
                local_1a8 = *(undefined4 *)((longlong)pvVar3 + 0x5e0);
                pwVar22 = L"EngineAdapterControlUnit";
                local_1b0 = *(undefined4 *)((longlong)pvVar3 + 0x5dc);
                local_1b8 = CONCAT44(local_1b8._4_4_,*(undefined4 *)((longlong)pvVar3 + 0x5d8));
                local_1c0 = CONCAT44(local_1c0._4_4_,*(undefined4 *)((longlong)pvVar3 + 0x5d4));
                uStack456 = uStack456 & 0xffffffff00000000 |
                            (ulonglong)*(uint *)((longlong)pvVar3 + 0x5d0);
                debug_print_FUN_18003fc70
                          ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                           (undefined *)L"EngineAdapterControlUnit",0x1b84,0,
                           (undefined *)

                           L"ENUM_TEST_Perf_STAGE_Result time1:%lu.%lu, time2:%lu.%lu, qualit:%d, coverage:%d"
                          );
                *(undefined *)((longlong)pvVar3 + 0x5c9) = 2;
                FUN_18003d660((longlong)"%s %d ENUM_TEST_Perf_STAGE_Result done successfully",
                              "EngineAdapterControlUnit",0x1b8a,pwVar22);
                if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                    ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) &&
                   (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
                  FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1a2,&DAT_180072bc8);
                }
                uVar8 = 9;
                pwVar22 = L"ENUM_TEST_Perf_STAGE_Result done successfully";
                uVar28 = 0x1b8c;
                goto LAB_180047af8;
              }
              goto LAB_180047761;
            }
            FUN_18003d660((longlong)"%s %d ENUM_TEST_Perf_STAGE_Identify","EngineAdapterControlUnit"
                          ,0x1b6e,pwVar23);
            if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
              FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x19f,&DAT_180072bc8);
            }
            pwVar22 = L"ENUM_TEST_Perf_STAGE_Identify";
            uVar28 = 0x1b70;
          }
          pwVar23 = L"EngineAdapterControlUnit";
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"EngineAdapterControlUnit",uVar28,0,(undefined *)pwVar22);
          puVar14 = local_198;
        }
      }
LAB_180047761:
      FUN_18003d660((longlong)"%s %d to call DeviceIoControl","EngineAdapterControlUnit",0x1ba8,
                    pwVar23);
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1a4,&DAT_180072bc8);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"EngineAdapterControlUnit",0x1baa,0,
                 (undefined *)L"to call DeviceIoControl");
      local_150.hEvent = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCWSTR)0x0);
      if (local_150.hEvent == (HANDLE)0x0) {
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1a5,&DAT_180072bc8);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterControlUnit",0x1baf,0,
                   (undefined *)L"TEST-CreateEvent fail");
        uVar27 = 0x8007000e;
        goto LAB_180049702;
      }
      memset(&local_128,0,0x88);
      ppvVar5 = local_158;
      if (param_2 == 0x442018) {
        puVar14 = &local_128;
        param_6._0_4_ = 0x88;
      }
      uVar8 = DeviceIoControl(*local_158,param_2,param_3,DVar9,puVar14,(uint)param_6,
                              (LPDWORD)local_190,(LPOVERLAPPED)&local_150);
      puVar12 = local_190;
      if (uVar8 == 0) {
        DVar9 = GetLastError();
        puVar12 = local_190;
        if (DVar9 == 0x3e5) {
          SetLastError(0);
          puVar12 = local_190;
          uVar8 = GetOverlappedResult(*ppvVar5,(LPOVERLAPPED)&local_150,(LPDWORD)local_190,1);
          FUN_18003d660((longlong)"%s %d GetOverlappedResult fail for IO_PENDING, result=%d",
                        "EngineAdapterControlUnit",0x1bcf,(ulonglong)uVar8);
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
            FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1a6,&DAT_180072bc8,uVar8);
          }
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"EngineAdapterControlUnit",0x1bd1,0,
                     (undefined *)L"TEST-GetOverlappedResult fail for IO_PENDING, result=%d");
          if (uVar8 != 0) goto LAB_180048e1f;
        }
        FUN_18003d660((longlong)"%s %d GetOverlappedResult fail, result=%d",
                      "EngineAdapterControlUnit",0x1bd7,0);
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
          FUN_180054fb0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1a7,&DAT_180072bc8,0,
                        (char)*(undefined4 *)puVar12);
        }
        uStack456 = uStack456 & 0xffffffff00000000 | (ulonglong)*(uint *)puVar12;
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterControlUnit",0x1bd9,0,
                   (undefined *)L"TEST-GetOverlappedResult fail, result=%d, bytesReturned=%u");
        DVar9 = GetLastError();
        uVar27 = (ulonglong)DVar9;
        goto LAB_180049702;
      }
LAB_180048e1f:
      FUN_18003d660((longlong)"%s %d GetOverlappedResult done, result=%d, bytesReturned=%u",
                    "EngineAdapterControlUnit",0x1bdf,(ulonglong)uVar8);
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
        FUN_180054fb0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1a8,&DAT_180072bc8,uVar8,
                      (char)*(undefined4 *)puVar12);
      }
      uStack456 = uStack456 & 0xffffffff00000000 | (ulonglong)*(uint *)puVar12;
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"EngineAdapterControlUnit",0x1be1,0,
                 (undefined *)L"TEST-GetOverlappedResult result=%d, bytesReturned=%u");
      if (param_2 == 0x442018) {
        FUN_18003d660((longlong)

                      "%s %d orignal IOCTL_BIOMETRIC_FOR_TEST_WHOLE,operation_status=%d, test_progress=%d"
                      ,"EngineAdapterControlUnit",0x1be5,
                      (ulonglong)*(ushort *)((longlong)pvVar3 + 0x5ca));
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
          FUN_1800550f0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1a9,&DAT_180072bc8,
                        (uint)*(ushort *)((longlong)pvVar3 + 0x5ca),
                        *(undefined *)((longlong)pvVar3 + 0x5c9));
        }
        uStack456 = uStack456 & 0xffffffff00000000 | (ulonglong)*(byte *)((longlong)pvVar3 + 0x5c9);
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterControlUnit",0x1be7,0,
                   (undefined *)
                   L"orignal IOCTL_BIOMETRIC_FOR_TEST_WHOLE,operation_status=%d, test_progress=%d");
        *(ushort *)((longlong)pvVar3 + 0x5ca) = local_128._2_2_;
        *(undefined *)((longlong)pvVar3 + 0x5c9) = local_128._1_1_;
        FUN_18003d660((longlong)

                      "%s %d from driver IOCTL_BIOMETRIC_FOR_TEST_WHOLE,operation_status=%d, test_progress=%d"
                      ,"EngineAdapterControlUnit",0x1bec,(ulonglong)local_128._2_2_);
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
          FUN_1800550f0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1aa,&DAT_180072bc8,
                        (uint)*(ushort *)((longlong)pvVar3 + 0x5ca),
                        *(undefined *)((longlong)pvVar3 + 0x5c9));
        }
        pwVar22 = L"EngineAdapterControlUnit";
        uStack456 = uStack456 & 0xffffffff00000000 | (ulonglong)*(byte *)((longlong)pvVar3 + 0x5c9);
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterControlUnit",0x1bee,0,
                   (undefined *)

                   L"from driver IOCTL_BIOMETRIC_FOR_TEST_WHOLE,operation_status=%d, test_progress=%d"
                  );
        cVar6 = *(char *)((longlong)pvVar3 + 0x53c);
        if (cVar6 == '\x06') {
          *(uint *)((longlong)pvVar3 + 0x5cc) = local_128._4_4_;
          *(undefined4 *)((longlong)pvVar3 + 0x5d0) = local_120;
          *(undefined4 *)((longlong)pvVar3 + 0x5d4) = uStack284;
          *(undefined4 *)((longlong)pvVar3 + 0x5d8) = uStack280;
          *(undefined4 *)((longlong)pvVar3 + 0x5dc) = local_114;
          *(undefined4 *)((longlong)pvVar3 + 0x5e0) = uStack272;
          *(undefined4 *)((longlong)pvVar3 + 0x5e4) = uStack268;
          *(undefined4 *)((longlong)pvVar3 + 0x5e8) = local_108;
          *(undefined8 *)((longlong)pvVar3 + 0x5ec) = local_104;
          FUN_18003d660((longlong)"%s %d from driver check OTP","EngineAdapterControlUnit",0x1bf3,
                        pwVar22);
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
            FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1ab,&DAT_180072bc8);
          }
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"EngineAdapterControlUnit",0x1bf5,0,
                     (undefined *)L"from driver check OTP");
          goto LAB_1800494b6;
        }
        uVar15 = (undefined2)local_128._4_4_;
        if (cVar6 == '\x01') {
          *(undefined2 *)((longlong)pvVar3 + 0x5cc) = uVar15;
          *(ushort *)((longlong)pvVar3 + 0x5ce) = local_128._6_2_;
          FUN_18003d660((longlong)

                        "%s %d from driver ENUM_TEST_WHOLE_TEST_TYPE_SPI PChipId[0]:0x%04x: PChipId[1]:0x%04x"
                        ,"EngineAdapterControlUnit",0x1bff,(ulonglong)(local_128._4_4_ & 0xffff));
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
            FUN_180054880(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1ac,&DAT_180072bc8,
                          (uint)*(ushort *)((longlong)pvVar3 + 0x5cc),
                          (char)*(undefined2 *)((longlong)pvVar3 + 0x5ce));
          }
          uStack456 = uStack456 & 0xffffffff00000000 |
                      (ulonglong)*(ushort *)((longlong)pvVar3 + 0x5ce);
          pwVar22 = L"from driver ENUM_TEST_WHOLE_TEST_TYPE_SPIPChipId[0]:0x%04x: PChipId[1]:0x%04x"
          ;
          uVar28 = 0x1c05;
          goto LAB_180049497;
        }
        if (cVar6 == '\a') {
          *(char *)((longlong)pvVar3 + 0x5cc) = (char)local_128._4_4_;
          pwVar22 = L"from driver ENUM_TEST_WHOLE_TEST_TYPE_GPIO test_result:%d";
          uVar28 = 0x1c0d;
LAB_180049272:
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"EngineAdapterControlUnit",uVar28,0,(undefined *)pwVar22);
        }
        else {
          if (cVar6 == '\x02') {
            *(undefined2 *)((longlong)pvVar3 + 0x5cc) = uVar15;
            FUN_18003d660((longlong)"%s %d from driver ValueOfIntReg: 0x%04x",
                          "EngineAdapterControlUnit",0x1c12,(ulonglong)(local_128._4_4_ & 0xffff));
            if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
              FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1ad,&DAT_180072bc8,
                            (uint)*(ushort *)((longlong)pvVar3 + 0x5cc));
            }
            pwVar22 = L"from driver ValueOfIntReg: 0x%04x";
            uVar28 = 0x1c14;
            goto LAB_180049272;
          }
          if (cVar6 == '\x03') {
            if (*(int *)((longlong)pvVar3 + 0x560) == 0) {
              *(ushort *)((longlong)pvVar3 + 0x5ce) = local_128._6_2_;
              FUN_18003d660((longlong)

                            "%s %d from driver ENUM_TEST_PixelOpenShort_STAGE_BeforeDACChange DACOrinialValue:%d"
                            ,"EngineAdapterControlUnit",0x1c1b,(ulonglong)local_128._6_2_);
              if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                  ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
                FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1ae,&DAT_180072bc8,
                              (uint)*(ushort *)((longlong)pvVar3 + 0x5ce));
              }
              pwVar22 =
              L"from driver ENUM_TEST_PixelOpenShort_STAGE_BeforeDACChange DACOrinialValue:%d";
              uVar28 = 0x1c1d;
              goto LAB_180049272;
            }
            if (*(int *)((longlong)pvVar3 + 0x560) == 1) {
              *(undefined2 *)((longlong)pvVar3 + 0x5cc) = uVar15;
              *(short *)((longlong)pvVar3 + 0x5d0) = (short)local_120;
              FUN_18003d660((longlong)

                            "%s %d from driver ENUM_TEST_PixelOpenShort_STAGE_UpdateDAC TcodeValue:%d, DACUpdatedValue:%d"
                            ,"EngineAdapterControlUnit",0x1c23,(ulonglong)(local_128._4_4_ & 0xffff)
                           );
              if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                  ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
                FUN_1800550f0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1af,&DAT_180072bc8,
                              (uint)*(ushort *)((longlong)pvVar3 + 0x5cc),
                              (char)*(undefined2 *)((longlong)pvVar3 + 0x5d0));
              }
              uStack456 = uStack456 & 0xffffffff00000000 |
                          (ulonglong)*(ushort *)((longlong)pvVar3 + 0x5d0);
              pwVar22 =
              L"from driver ENUM_TEST_PixelOpenShort_STAGE_UpdateDAC TcodeValue:%d, DACUpdatedValue:%d"
              ;
              uVar28 = 0x1c25;
              goto LAB_180049497;
            }
          }
          else {
            if ((cVar6 == '\x05') && (*(int *)((longlong)pvVar3 + 0x558) == 1)) {
              *(uint *)((longlong)pvVar3 + 0x5cc) = local_128._4_4_;
              *(undefined4 *)((longlong)pvVar3 + 0x5d0) = local_120;
              FUN_18003d660((longlong)
                            "%s %d from driver ENUM_TEST_Perf_STAGE_Identify captureTime:%lu.%lu",
                            "EngineAdapterControlUnit",0x1c2e,(ulonglong)local_128._4_4_);
              if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                 (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
                FUN_180054bb0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1b0,&DAT_180072bc8,
                              *(undefined4 *)((longlong)pvVar3 + 0x5cc),
                              (char)*(undefined4 *)((longlong)pvVar3 + 0x5d0));
              }
              uStack456 = uStack456 & 0xffffffff00000000 |
                          (ulonglong)*(uint *)((longlong)pvVar3 + 0x5d0);
              pwVar22 = L"from driver ENUM_TEST_Perf_STAGE_Identify captureTime:%lu.%lu";
              uVar28 = 0x1c30;
LAB_180049497:
              debug_print_FUN_18003fc70
                        ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                         (undefined *)L"EngineAdapterControlUnit",uVar28,0,(undefined *)pwVar22);
            }
          }
        }
LAB_1800494b6:
        memcpy_FUN_180061f90
                  (local_198,(undefined8 *)((longlong)pvVar3 + 0x5c8),(ulonglong)(uint)param_6);
        *puVar12 = param_6;
      }
      FUN_18003d660((longlong)"%s %d from driver called DeviceIoControl success, result=%d",
                    "EngineAdapterControlUnit",0x1c3a,(ulonglong)uVar8);
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
        FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1b1,&DAT_180072bc8,uVar8);
      }
      pwVar22 = L"TEST-called DeviceIoControl success, result=%d";
      uVar28 = 0x1c3c;
LAB_180049546:
      uVar8 = 2;
      goto LAB_18004954b;
    }
    uVar27 = 0x80098009;
    FUN_18003d660((longlong)"%s %d fail","EngineAdapterControlUnit",0x1b9d,pwVar22);
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1a3,&DAT_180072bc8);
    }
    pwVar22 = L"fail";
    uVar28 = 0x1b9f;
    uVar8 = 9;
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,uVar8,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterControlUnit",uVar28,0,(undefined *)pwVar22);
LAB_180049702:
  if (local_150.hEvent != (HANDLE)0x0) {
    CloseHandle(local_150.hEvent);
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1b2,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"EngineAdapterControlUnit",0x1c43,0,(undefined *)L"Event closed");
  }
  FUN_18003d660((longlong)"%s %d Exit hr=0x%x","EngineAdapterControlUnit",0x1c46,uVar27);
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1b3,&DAT_180072bc8,(int)uVar27);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterControlUnit",0x1c48,0,(undefined *)L"Exit, hr=0x%x");
  FUN_18005f100(local_58 ^ (ulonglong)&stack0xfffffffffffffdf8);
  return;
}



undefined8 FUN_180049830(void)

{
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1b4,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterControlUnitPrivileged",0x1c67,0,(undefined *)L"Exit");
  return 0x80004001;
}



undefined8 FUN_180049d00(longlong param_1)

{
  undefined8 uVar1;

  uVar1 = 0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1be,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterPipelineInit",0x1cd1,0,(undefined *)L"Entry");
  if (param_1 == 0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1bf,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"EngineAdapterPipelineInit",0x1cd5,0,(undefined *)L"Arg error");
    uVar1 = 0x80004003;
  }
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1c0,&DAT_180072bc8,(int)uVar1);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterPipelineInit",0x1cdf,0,(undefined *)L"Exit, hr=0x%x");
  return uVar1;
}



undefined8 FUN_180049e80(longlong param_1)

{
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1c1,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterPipelineCleanup",0x1ced,0,(undefined *)L"Entry");
  if (param_1 == 0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1c2,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"EngineAdapterPipelineCleanup",0x1cf1,0,(undefined *)L"Arg error");
    return 0x80004003;
  }
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1c3,&DAT_180072bc8,0);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterPipelineCleanup",0x1cfa,0,(undefined *)L"Exit, hr=0x%x");
  return 0;
}



undefined8 FUN_18004a000(longlong param_1)

{
  undefined8 uVar1;
  undefined4 uVar2;

  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1c4,&DAT_180072bc8);
  }
  uVar1 = 0;
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterActivate",0x1d06,0,(undefined *)L"Entry");
  if (param_1 == 0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1c5,&DAT_180072bc8);
    }
    uVar2 = 0x1d0c;
  }
  else {
    if (*(longlong *)(param_1 + 0x38) != 0) {
      *(undefined2 *)(*(longlong *)(param_1 + 0x38) + 0x7b) = 0;
      goto LAB_18004a14b;
    }
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1c6,&DAT_180072bc8);
    }
    uVar2 = 0x1d17;
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterActivate",uVar2,0,(undefined *)L"Arg error");
  uVar1 = 0x80004003;
LAB_18004a14b:
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1c7,&DAT_180072bc8,(int)uVar1);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterActivate",0x1d24,0,(undefined *)L"Exit, hr=0x%x");
  return uVar1;
}



undefined8 FUN_18004a780(longlong param_1,undefined4 *param_2,longlong param_3)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  byte bVar4;
  byte bVar5;
  longlong lVar6;
  undefined8 uVar7;
  undefined4 uVar8;

  uVar7 = 0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1d0,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterQueryExtendedInfo",0x1dab,0,(undefined *)L"Entry");
  if (((param_1 == 0) || (param_2 == (undefined4 *)0x0)) || (param_3 == 0)) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1d1,&DAT_180072bc8);
    }
    uVar8 = 0x1db3;
  }
  else {
    lVar6 = *(longlong *)(param_1 + 0x38);
    if (lVar6 != 0) {
      bVar1 = *(byte *)(lVar6 + 0x112);
      bVar2 = *(byte *)(lVar6 + 0x113);
      bVar3 = *(byte *)(lVar6 + 0x114);
      bVar4 = *(byte *)(lVar6 + 0x115);
      *param_2 = 1;
      *(undefined8 *)(param_2 + 1) = 8;
      param_2[3] = (uint)*(byte *)(lVar6 + 0x7e);
      bVar5 = *(byte *)(lVar6 + 0x7e);
      param_2[5] = (uint)bVar1;
      param_2[6] = (uint)bVar2;
      param_2[7] = (uint)bVar3;
      param_2[8] = (uint)bVar4;
      param_2[4] = ((((uint)bVar5 - (uint)bVar4) - (uint)bVar3) - (uint)bVar2) - (uint)bVar1;
      goto LAB_18004a944;
    }
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1d2,&DAT_180072bc8);
    }
    uVar8 = 0x1dbe;
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterQueryExtendedInfo",uVar8,0,(undefined *)L"Arg error");
  uVar7 = 0x80004003;
LAB_18004a944:
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1d3,&DAT_180072bc8,(int)uVar7);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterQueryExtendedInfo",0x1ddc,0,(undefined *)L"Exit, hr=0x%x");
  return uVar7;
}



undefined8 FUN_18004a9d0(undefined8 param_1,undefined8 *param_2,undefined8 *param_3)

{
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1d4,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterIdentifyAll",0x1dec,0,(undefined *)L"Entry");
  *param_2 = 0;
  *param_3 = 0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1d5,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterIdentifyAll",0x1df4,0,(undefined *)L"Exit");
  return 0;
}



undefined8 FUN_18004aae0(longlong param_1,longlong param_2)

{
  undefined8 uVar1;

  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1d6,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterSetEnrollmentSelector",0x1e03,0,(undefined *)L"Entry");
  if (param_1 == 0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1d7,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"EngineAdapterSetEnrollmentSelector",0x1e0b,0,(undefined *)L"Arg error"
              );
    uVar1 = 0x80004003;
  }
  else {
    if (param_2 == 0) {
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1d8,&DAT_180072bc8);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"EngineAdapterSetEnrollmentSelector",0x1e12,0,
                 (undefined *)L"Arg error");
      uVar1 = 0x80070057;
    }
    else {
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1d9,&DAT_180072bc8);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"EngineAdapterSetEnrollmentSelector",0x1e16,0,(undefined *)L"Exit");
      uVar1 = 0;
    }
  }
  return uVar1;
}



undefined8 FUN_18004acd0(longlong param_1,ulonglong *param_2)

{
  byte bVar1;
  uint uVar2;
  undefined4 uVar3;
  wchar_t *pwVar4;

  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1da,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterSetEnrollmentParameters",0x1e24,0,(undefined *)L"Entry");
  if ((param_1 == 0) || (param_2 == (ulonglong *)0x0)) {
    if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
       (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1db,&DAT_180072bc8);
    }
    uVar2 = 2;
    pwVar4 = L"Arg error";
    uVar3 = 0x1e28;
  }
  else {
    if (*(longlong *)(param_1 + 0x38) != 0) {
      if (*param_2 < 0x10) {
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054880(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1dd,&DAT_180072bc8,
                        *(undefined4 *)param_2,0x10);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterSetEnrollmentParameters",0x1e34,0,
                   (undefined *)L"Parameters->Size=%u < %u");
        return 0x80070057;
      }
      bVar1 = *(byte *)(param_2 + 1);
      *(byte *)(*(longlong *)(param_1 + 0x38) + 0x79) = bVar1;
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1de,&DAT_180072bc8,(uint)bVar1);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"EngineAdapterSetEnrollmentParameters",0x1e41,0,
                 (undefined *)L"Exit, subtype: 0x%x");
      return 0;
    }
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1dc,&DAT_180072bc8);
    }
    uVar2 = 4;
    pwVar4 = L"Enginecontext NULL";
    uVar3 = 0x1e2e;
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,uVar2,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterSetEnrollmentParameters",uVar3,0,(undefined *)pwVar4);
  return 0x80004003;
}



undefined8 FUN_18004af60(longlong param_1,undefined4 *param_2,ulonglong param_3)

{
  short sVar1;
  short sVar2;
  longlong lVar3;
  longlong lVar4;
  uint uVar5;
  undefined4 uVar6;
  wchar_t *pwVar7;

  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1df,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterQueryExtendedEnrollmentStatus",0x1e52,0,
             (undefined *)L"Entry");
  if ((param_1 == 0) || (param_2 == (undefined4 *)0x0)) {
    if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
       (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1e0,&DAT_180072bc8);
    }
    uVar5 = 2;
    pwVar7 = L"Arg error";
    uVar6 = 0x1e56;
  }
  else {
    lVar3 = *(longlong *)(param_1 + 0x38);
    if (lVar3 != 0) {
      if (param_3 < 0x158) {
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054880(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1e2,&DAT_180072bc8,(int)param_3
                        ,0x58);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterQueryExtendedEnrollmentStatus",0x1e63,0,
                   (undefined *)L"EnrollmentStatusSize=%u < %u");
        return 0x80070057;
      }
      lVar4 = *(longlong *)(lVar3 + 0x10);
      memset(param_2,0,0x158);
      param_2[3] = 8;
      *(undefined *)(param_2 + 4) = *(undefined *)(lVar3 + 0x79);
      if (*(int *)(lVar3 + 8) != 1) {
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (2 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1e3,&DAT_180072bc8);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,5,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"EngineAdapterQueryExtendedEnrollmentStatus",0x1e70,0,
                   (undefined *)L"Enrollment not in progress");
        *param_2 = 0x8009802c;
        return 0;
      }
      *param_2 = *(undefined4 *)(lVar3 + 0x84);
      param_2[1] = *(undefined4 *)(lVar3 + 0x80);
      param_2[2] = *(undefined4 *)(lVar4 + 0xc);
      param_2[5] = (int)*(short *)(lVar4 + 8) - (int)*(short *)(lVar4 + 10);
      sVar1 = *(short *)(lVar4 + 8);
      sVar2 = *(short *)(lVar4 + 10);
      *(undefined8 *)(param_2 + 7) = 0;
      param_2[6] = (int)sVar1 - (int)sVar2;
      *(undefined8 *)(param_2 + 9) = 0;
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1e4,&DAT_180072bc8);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"EngineAdapterQueryExtendedEnrollmentStatus",0x1e87,0,
                 (undefined *)L"Exit");
      return 0;
    }
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1e1,&DAT_180072bc8);
    }
    uVar5 = 4;
    pwVar7 = L"Enginecontext NULL";
    uVar6 = 0x1e5d;
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,uVar5,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterQueryExtendedEnrollmentStatus",uVar6,0,(undefined *)pwVar7)
  ;
  return 0x80004003;
}



undefined8 FUN_18004b2c0(void)

{
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1e5,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterRefreshCache",0x1e94,0,(undefined *)L"Entry");
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1e6,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterRefreshCache",0x1e9a,0,(undefined *)L"Exit");
  return 0;
}



ulonglong FUN_18004b3b0(longlong param_1,longlong param_2,undefined8 param_3,longlong param_4)

{
  uint uVar1;

  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1e7,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterSelectCalibrationFormat",0x1eae,0,(undefined *)L"Entry");
  uVar1 = 0x80004001;
  if (((param_1 == 0) || (param_2 == 0)) || (param_4 == 0)) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1e8,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"EngineAdapterSelectCalibrationFormat",0x1eb7,0,
               (undefined *)L"Arg error");
    uVar1 = 0x80004003;
  }
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1e9,&DAT_180072bc8,uVar1);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterSelectCalibrationFormat",0x1ec2,0,
             (undefined *)L"Exit, hr:0x%x");
  return (ulonglong)uVar1;
}



undefined8 FUN_18004b560(void)

{
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1ea,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"EngineAdapterQueryCalibrationData",0x1edb,0,(undefined *)L"Exit");
  return 0x80004001;
}



ulonglong EntryTestControl_FUN_18004b7a0
                    (longlong param_1,int *param_2,ulonglong param_3,int *param_4,ulonglong param_5,
                    ulonglong *param_6,int *param_7)

{
  int iVar1;
  ulonglong uVar2;
  undefined8 uVar3;
  undefined8 *puVar4;
  undefined8 *puVar5;
  undefined8 *puVar6;
  uint uVar7;
  undefined4 uVar8;
  wchar_t *pwVar9;

  puVar6 = (undefined8 *)0x0;
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,
             (undefined *)

             L"d:\\git\\milanf_emdoor\\winfpcode\\src\\driver\\milanfusb\\adapters\\engine_adapter\\TestEntry.h"
             ,(undefined *)L"EntryTestControl",0x3a,0,
             (undefined *)L"Engine test ControlUnit entry!!");
  if (((param_1 == 0) || (param_2 == (int *)0x0)) || (param_4 == (int *)0x0)) {
    uVar7 = 8;
    pwVar9 = L"Engine test entry: Pipeline or SendBuffer or ReceiveBuffer is NULL!!";
    uVar8 = 0x3d;
LAB_18004ba5e:
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,uVar7,
               (undefined *)

               L"d:\\git\\milanf_emdoor\\winfpcode\\src\\driver\\milanfusb\\adapters\\engine_adapter\\TestEntry.h"
               ,(undefined *)L"EntryTestControl",uVar8,0,(undefined *)pwVar9);
    *param_7 = 1;
    uVar2 = 1;
  }
  else {
    if (param_3 < 4) {
      pwVar9 = L"Engine test entry: send buffer size less then %d";
      uVar8 = 0x46;
    }
    else {
      if (7 < param_5) {
        *param_6 = param_5;
        param_4[1] = 0;
        *param_4 = *param_2;
        uVar3 = FUN_18005ea70();
        if ((int)uVar3 == 0) {
          puVar4 = (undefined8 *)FUN_18005f1cc(0x60);
          puVar5 = puVar6;
          if (puVar4 != (undefined8 *)0x0) {
            puVar5 = FUN_180040620(puVar4);
          }
          FUN_18005e360((longlong)puVar5);
          puVar4 = (undefined8 *)FUN_18005f1cc(0x60);
          puVar5 = puVar6;
          if (puVar4 != (undefined8 *)0x0) {
            puVar5 = FUN_180058010(puVar4);
          }
          FUN_18005e360((longlong)puVar5);
          puVar4 = (undefined8 *)FUN_18005f1cc(0x60);
          puVar5 = puVar6;
          if (puVar4 != (undefined8 *)0x0) {
            puVar5 = FUN_1800407f0(puVar4);
          }
          FUN_18005e360((longlong)puVar5);
          puVar4 = (undefined8 *)FUN_18005f1cc(0x60);
          puVar5 = puVar6;
          if (puVar4 != (undefined8 *)0x0) {
            puVar5 = FUN_1800580d0(puVar4);
          }
          FUN_18005e360((longlong)puVar5);
          puVar4 = (undefined8 *)FUN_18005f1cc(0xb0);
          puVar5 = puVar6;
          if (puVar4 != (undefined8 *)0x0) {
            puVar5 = FUN_1800585f0(puVar4);
          }
          FUN_18005e360((longlong)puVar5);
          puVar4 = (undefined8 *)FUN_18005f1cc(0xb0);
          puVar5 = puVar6;
          if (puVar4 != (undefined8 *)0x0) {
            puVar5 = FUN_180057900(puVar4);
          }
          FUN_18005e360((longlong)puVar5);
          puVar4 = (undefined8 *)FUN_18005f1cc(0xb0);
          puVar5 = puVar6;
          if (puVar4 != (undefined8 *)0x0) {
            puVar5 = FUN_180058260(puVar4);
          }
          FUN_18005e360((longlong)puVar5);
          puVar5 = (undefined8 *)FUN_18005f1cc(0x60);
          if (puVar5 != (undefined8 *)0x0) {
            puVar6 = WBDICapturedataReceiverChain_FUN_180059400(puVar5);
          }
          FUN_18005e360((longlong)puVar6);
        }
        if (*(longlong *)(param_1 + 0x38) != 0) {
          DAT_1800b04d0 = *param_2;
          if (DAT_1800b04d0 == 0x8fff) {
            DAT_1800b04d0 = 0x1d;
          }
          iVar1 = FUN_18005ea90(0,param_1,param_2,param_4,param_6,*(longlong *)(param_1 + 0x38));
          *param_7 = param_4[1];
          return (ulonglong)(iVar1 == 0);
        }
        pwVar9 = L"Engine test entry: Pipeline->EngineContext is NULL";
        uVar7 = 4;
        uVar8 = 0x5f;
        goto LAB_18004ba5e;
      }
      pwVar9 = L"Engine test entry: receive buffer size less then %d";
      uVar8 = 0x4d;
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,4,
               (undefined *)

               L"d:\\git\\milanf_emdoor\\winfpcode\\src\\driver\\milanfusb\\adapters\\engine_adapter\\TestEntry.h"
               ,(undefined *)L"EntryTestControl",uVar8,0,(undefined *)pwVar9);
    uVar2 = 0xc000000d;
  }
  return uVar2;
}



ulonglong FUN_18004bab0(LPCWSTR param_1,LPWSTR *param_2,uint *param_3)

{
  BOOL BVar1;
  LPWSTR Sid;
  LPWSTR ReferencedDomainName;
  HANDLE pvVar2;
  uint uVar3;
  uint local_res20 [2];
  uint local_58;
  undefined4 local_54;
  _SID_NAME_USE local_50 [2];
  LPWSTR local_48;
  LPWSTR local_40;
  undefined8 local_38;

  local_38 = 0xfffffffffffffffe;
  Sid = (LPWSTR)0x0;
  local_48 = (LPWSTR)0x0;
  local_res20[0] = 0;
  local_40 = (LPWSTR)0x0;
  local_58 = 0;
  local_54 = 0;
  BVar1 = LookupAccountNameW((LPCWSTR)0x0,param_1,(PSID)0x0,local_res20,(LPWSTR)0x0,&local_58,
                             local_50);
  ReferencedDomainName = Sid;
  uVar3 = 0;
  if (BVar1 == 0) {
    Sid = (LPWSTR)FUN_18004cea0((ulonglong)local_res20[0]);
    local_48 = Sid;
    ReferencedDomainName = (LPWSTR)FUN_18004cea0((ulonglong)local_58 * 2);
    local_40 = ReferencedDomainName;
    if ((Sid == (LPWSTR)0x0) || (ReferencedDomainName == (LPWSTR)0x0)) {
      _CxxThrowException((void *)0x0,(ThrowInfo *)0x0);
      uVar3 = 0;
    }
    else {
      BVar1 = LookupAccountNameW((LPCWSTR)0x0,param_1,Sid,local_res20,ReferencedDomainName,&local_58
                                 ,local_50);
      if (BVar1 == 0) {
        _CxxThrowException((void *)0x0,(ThrowInfo *)0x0);
      }
      local_54 = 1;
      uVar3 = 1;
    }
  }
  if (ReferencedDomainName != (LPWSTR)0x0) {
    pvVar2 = GetProcessHeap();
    HeapFree(pvVar2,8,ReferencedDomainName);
  }
  if (uVar3 == 0) {
    if (Sid != (LPWSTR)0x0) {
      pvVar2 = GetProcessHeap();
      HeapFree(pvVar2,8,Sid);
    }
  }
  else {
    *param_2 = Sid;
    if (param_3 != (uint *)0x0) {
      *param_3 = local_res20[0];
    }
  }
  return (ulonglong)uVar3;
}



ulonglong FUN_18004bc30(longlong param_1)

{
  longlong *plVar1;
  wchar_t wVar2;
  int iVar3;
  code *pcVar4;
  uint uVar5;
  ULONG UVar6;
  longlong *plVar7;
  longlong lVar8;
  longlong *plVar9;
  ulonglong uVar10;
  wchar_t *pwVar11;
  int local_res10 [4];
  IUnknown *local_res20;
  undefined4 uVar12;
  undefined8 in_stack_ffffffffffffff70;
  uint uVar14;
  longlong **pplVar13;
  wchar_t *pwVar15;
  ulonglong uVar16;
  wchar_t *pwVar17;
  longlong *local_68;
  longlong *local_60;
  longlong *local_58;
  undefined local_50 [8];
  wchar_t *local_48;

  uVar14 = (uint)((ulonglong)in_stack_ffffffffffffff70 >> 0x20);
  uVar5 = CoInitializeEx((LPVOID)0x0,0);
  if ((int)uVar5 < 0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x18,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"GetCurrentUserName",0x3fa,0,(undefined *)L"Fail to CoInitializeEx");
    return (ulonglong)uVar5;
  }
  uVar5 = CoInitializeSecurity
                    ((PSECURITY_DESCRIPTOR)0x0,-1,(SOLE_AUTHENTICATION_SERVICE *)0x0,(void *)0x0,0,3
                     ,(void *)0x0,0,(void *)0x0);
  if ((int)uVar5 < 0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x19,&DAT_180072bc8);
    }
    pwVar15 = L"Fail to CoInitializeSecurity";
    uVar12 = 0x410;
  }
  else {
    local_68 = (longlong *)0x0;
    uVar5 = CoCreateInstance((IID *)&DAT_18007a328,(LPUNKNOWN)0x0,1,(IID *)&DAT_18007a3d8,&local_68)
    ;
    if (-1 < (int)uVar5) {
      local_res20 = (IUnknown *)0x0;
      plVar7 = (longlong *)FUN_18005f1cc(0x18);
      if (plVar7 == (longlong *)0x0) {
        _com_issue_error(-0x7ff8fff2);
        pcVar4 = (code *)swi(3);
        uVar10 = (*pcVar4)();
        return uVar10;
      }
      plVar7[1] = 0;
      *(undefined4 *)(plVar7 + 2) = 1;
      lVar8 = Ordinal_2(L"ROOT\\CIMV2");
      *plVar7 = lVar8;
      if (lVar8 == 0) {
        _com_issue_error(-0x7ff8fff2);
        pcVar4 = (code *)swi(3);
        uVar10 = (*pcVar4)();
        return uVar10;
      }
      uVar16 = 0;
      uVar5 = (**(code **)(*local_68 + 0x18))
                        (local_68,lVar8,0,0,0,(ulonglong)uVar14 << 0x20,0,0,&local_res20);
      uVar10 = (ulonglong)uVar5;
      LOCK();
      plVar9 = plVar7 + 2;
      iVar3 = *(int *)plVar9;
      *(int *)plVar9 = *(int *)plVar9 + -1;
      if (iVar3 == 1) {
        if (*plVar7 != 0) {
          Ordinal_6();
          *plVar7 = 0;
        }
        if (plVar7[1] != 0) {
          FUN_18005f210();
          plVar7[1] = 0;
        }
        FUN_18005f208();
      }
      if ((int)uVar5 < 0) {
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1b,&DAT_180072bc8);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"GetCurrentUserName",0x43d,0,
                   (undefined *)L"Fail to ConnectServer root\\cimv2");
        (**(code **)(*local_68 + 0x10))();
      }
      else {
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1c,&DAT_180072bc8);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"GetCurrentUserName",0x444,0,
                   (undefined *)L"Connected to ROOT\\CIMV2 WMI namespace");
        pwVar17 = (wchar_t *)(uVar16 & 0xffffffff00000000);
        pwVar15 = (wchar_t *)0x0;
        uVar5 = CoSetProxyBlanket(local_res20,10,0,(OLECHAR *)0x0,3,3,(RPC_AUTH_IDENTITY_HANDLE)0x0,
                                  0);
        uVar10 = (ulonglong)uVar5;
        if (-1 < (int)uVar5) {
          local_60 = (longlong *)0x0;
          plVar7 = (longlong *)FUN_18005f1cc(0x18);
          if (plVar7 == (longlong *)0x0) {
            _com_issue_error(-0x7ff8fff2);
            pcVar4 = (code *)swi(3);
            uVar10 = (*pcVar4)();
            return uVar10;
          }
          plVar7[1] = 0;
          *(undefined4 *)(plVar7 + 2) = 1;
          lVar8 = ConvertStringToBSTR("SELECT * FROM Win32_ComputerSystem");
          *plVar7 = lVar8;
          plVar9 = (longlong *)FUN_18005f1cc(0x18);
          if (plVar9 != (longlong *)0x0) {
            plVar9[1] = 0;
            *(undefined4 *)(plVar9 + 2) = 1;
            lVar8 = ConvertStringToBSTR("WQL");
            *plVar9 = lVar8;
            pplVar13 = &local_60;
            UVar6 = (*local_res20->lpVtbl[6].Release)(local_res20);
            LOCK();
            plVar1 = plVar9 + 2;
            iVar3 = *(int *)plVar1;
            *(int *)plVar1 = *(int *)plVar1 + -1;
            if (iVar3 == 1) {
              if (*plVar9 != 0) {
                Ordinal_6();
                *plVar9 = 0;
              }
              if (plVar9[1] != 0) {
                FUN_18005f210();
                plVar9[1] = 0;
              }
              FUN_18005f208();
            }
            LOCK();
            plVar9 = plVar7 + 2;
            iVar3 = *(int *)plVar9;
            *(int *)plVar9 = *(int *)plVar9 + -1;
            if (iVar3 == 1) {
              if (*plVar7 != 0) {
                Ordinal_6();
                *plVar7 = 0;
              }
              if (plVar7[1] != 0) {
                FUN_18005f210();
                plVar7[1] = 0;
              }
              FUN_18005f208();
            }
            if ((int)UVar6 < 0) {
              if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                  ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19]))
              {
                FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1e,&DAT_180072bc8);
              }
              debug_print_FUN_18003fc70
                        ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                         (undefined *)L"GetCurrentUserName",0x46d,0,
                         (undefined *)L"Query for operating system name failed");
              (*local_res20->lpVtbl->Release)(local_res20);
              plVar7 = local_68;
            }
            else {
              local_58 = (longlong *)0x0;
              local_res10[0] = 0;
              while ((local_60 != (longlong *)0x0 &&
                     ((**(code **)(*local_60 + 0x20))
                                (local_60,0xffffffff,1,&local_58,local_res10,pplVar13,pwVar15,
                                 pwVar17), local_res10[0] != 0))) {
                (**(code **)(*local_58 + 0x20))(local_58,L"UserName",0,local_50,0,0);
                if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                   (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (4 < (byte)PTR_LOOP_1800aff38[0x19]))
                   )) {
                  FUN_180054c90(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1f,&DAT_180072bc8,
                                local_48);
                }
                pwVar15 = L"user name: %S";
                pplVar13 = (longlong **)0x0;
                pwVar17 = local_48;
                debug_print_FUN_18003fc70
                          ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                           (undefined *)L"GetCurrentUserName",0x489,0,(undefined *)L"user name: %S")
                ;
                pwVar11 = local_48;
                do {
                  wVar2 = *pwVar11;
                  *(wchar_t *)((longlong)pwVar11 + (param_1 - (longlong)local_48)) = wVar2;
                  pwVar11 = pwVar11 + 1;
                } while (wVar2 != L'\0');
                Ordinal_9(local_50);
                (**(code **)(*local_58 + 0x10))();
              }
              (*local_res20->lpVtbl->Release)(local_res20);
              (**(code **)(*local_68 + 0x10))();
              plVar7 = local_60;
            }
            (**(code **)(*plVar7 + 0x10))();
            CoUninitialize();
            return (ulonglong)UVar6;
          }
          _com_issue_error(-0x7ff8fff2);
          pcVar4 = (code *)swi(3);
          uVar10 = (*pcVar4)();
          return uVar10;
        }
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1d,&DAT_180072bc8);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"GetCurrentUserName",0x457,0,
                   (undefined *)L"Could not set proxy blanket");
        (*local_res20->lpVtbl->Release)(local_res20);
        (**(code **)(*local_68 + 0x10))();
      }
      goto LAB_18004bd73;
    }
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1a,&DAT_180072bc8);
    }
    pwVar15 = L"Fail to CoCreateInstance";
    uVar12 = 0x422;
  }
  uVar10 = (ulonglong)uVar5;
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"GetCurrentUserName",uVar12,0,(undefined *)pwVar15);
LAB_18004bd73:
  CoUninitialize();
  return uVar10;
}



void FUN_18004ca10(void)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  undefined8 *puVar3;

  puVar1 = (undefined8 *)FUN_18005f1cc(0x60);
  puVar3 = (undefined8 *)0x0;
  puVar2 = puVar3;
  if (puVar1 != (undefined8 *)0x0) {
    puVar2 = FUN_180040620(puVar1);
  }
  FUN_18005e360((longlong)puVar2);
  puVar1 = (undefined8 *)FUN_18005f1cc(0x60);
  puVar2 = puVar3;
  if (puVar1 != (undefined8 *)0x0) {
    puVar2 = FUN_180058010(puVar1);
  }
  FUN_18005e360((longlong)puVar2);
  puVar1 = (undefined8 *)FUN_18005f1cc(0x60);
  puVar2 = puVar3;
  if (puVar1 != (undefined8 *)0x0) {
    puVar2 = FUN_1800407f0(puVar1);
  }
  FUN_18005e360((longlong)puVar2);
  puVar1 = (undefined8 *)FUN_18005f1cc(0x60);
  puVar2 = puVar3;
  if (puVar1 != (undefined8 *)0x0) {
    puVar2 = FUN_1800580d0(puVar1);
  }
  FUN_18005e360((longlong)puVar2);
  puVar1 = (undefined8 *)FUN_18005f1cc(0xb0);
  puVar2 = puVar3;
  if (puVar1 != (undefined8 *)0x0) {
    puVar2 = FUN_1800585f0(puVar1);
  }
  FUN_18005e360((longlong)puVar2);
  puVar1 = (undefined8 *)FUN_18005f1cc(0xb0);
  puVar2 = puVar3;
  if (puVar1 != (undefined8 *)0x0) {
    puVar2 = FUN_180057900(puVar1);
  }
  FUN_18005e360((longlong)puVar2);
  puVar1 = (undefined8 *)FUN_18005f1cc(0xb0);
  puVar2 = puVar3;
  if (puVar1 != (undefined8 *)0x0) {
    puVar2 = FUN_180058260(puVar1);
  }
  FUN_18005e360((longlong)puVar2);
  puVar2 = (undefined8 *)FUN_18005f1cc(0x60);
  if (puVar2 != (undefined8 *)0x0) {
    puVar3 = WBDICapturedataReceiverChain_FUN_180059400(puVar2);
  }
  FUN_18005e360((longlong)puVar3);
  return;
}



void FUN_18004cb40(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  char *pcVar1;
  ulonglong *puVar2;
  undefined2 *puVar3;
  undefined8 local_res10;
  undefined8 local_res18;
  undefined8 local_res20;
  undefined auStack1112 [32];
  undefined8 local_438;
  undefined local_430 [8];
  CHAR local_428 [1024];
  ulonglong local_28;

  local_28 = DAT_1800b04e8 ^ (ulonglong)auStack1112;
  local_430 = &local_res10;
  local_res10 = param_2;
  local_res18 = param_3;
  local_res20 = param_4;
  puVar2 = (ulonglong *)FUN_18003ded0();
  local_438 = 0;
  __stdio_common_vsprintf(*puVar2 | 1,local_428,0x3ff,param_1);
  puVar3 = (undefined2 *)(local_430 + 7);
  do {
    pcVar1 = (char *)((longlong)puVar3 + 1);
    puVar3 = (undefined2 *)((longlong)puVar3 + 1);
  } while (*pcVar1 != '\0');
  *puVar3 = 10;
  OutputDebugStringA(local_428);
  FUN_18005f100(local_28 ^ (ulonglong)auStack1112);
  return;
}



ulonglong FUN_18004cbf0(HANDLE *param_1,undefined param_2)

{
  BOOL BVar1;
  DWORD DVar2;
  ulonglong uVar3;
  DWORD local_res8 [2];
  undefined local_res10 [8];
  _OVERLAPPED local_38;

  uVar3 = 0;
  local_res8[0] = 0;
  local_38.Internal = 0;
  local_38.InternalHigh = 0;
  local_38.u = 0;
  local_38.hEvent = (HANDLE)0x0;
  local_res10[0] = param_2;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x104,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterActivate",0x12e7,0,(undefined *)L"Entry");
  if (param_1 == (HANDLE *)0x0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x105,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_AdapterActivate",0x12eb,0,(undefined *)L"Arg error");
    uVar3 = 0x80004003;
    goto LAB_18004ce11;
  }
  local_38.hEvent = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCWSTR)0x0);
  if (local_38.hEvent == (HANDLE)0x0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x106,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_AdapterActivate",0x12f4,0,(undefined *)L"Create Event NULL");
    uVar3 = 0x8007000e;
    goto LAB_18004ce11;
  }
  BVar1 = DeviceIoControl(*param_1,0x442020,local_res10,1,(LPVOID)0x0,0,local_res8,
                          (LPOVERLAPPED)&local_38);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    if (DVar2 == 0x3e5) {
      SetLastError(0);
      BVar1 = GetOverlappedResult(*param_1,(LPOVERLAPPED)&local_38,local_res8,1);
      if (BVar1 != 0) goto LAB_18004cdff;
    }
  }
  else {
LAB_18004cdff:
    if (local_res8[0] == 1) goto LAB_18004ce11;
  }
  DVar2 = GetLastError();
  uVar3 = (ulonglong)DVar2;
LAB_18004ce11:
  if (local_38.hEvent != (HANDLE)0x0) {
    CloseHandle(local_38.hEvent);
  }
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x107,&DAT_180072bc8,(int)uVar3);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterActivate",0x131b,0,(undefined *)L"Exit, hr=0x%x");
  return uVar3;
}



void FUN_18004cea0(SIZE_T param_1)

{
  HANDLE hHeap;

  hHeap = GetProcessHeap();
                    // WARNING: Could not recover jumptable at 0x00018004cebf. Too many branches
                    // WARNING: Treating indirect jump as call
  HeapAlloc(hHeap,8,param_1);
  return;
}



undefined8 _AdapterCheckEnrollmentStatus_FUN_18004ced0(longlong param_1,longlong param_2)

{
  LPVOID lpMem;
  longlong lVar1;
  ulonglong uVar2;
  HANDLE pvVar3;
  undefined *puVar4;
  undefined8 uVar5;
  uint **local_res8;

  uVar5 = 0;
  local_res8 = (uint **)0x0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x13b,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterCheckEnrollmentStatus",0x160b,0,(undefined *)L"Entry");
  if ((param_1 == 0) || (param_2 == 0)) {
    if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
       (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x13c,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_AdapterCheckEnrollmentStatus",0x1610,0,(undefined *)L"Arg error");
    uVar5 = 0x80004003;
  }
  else {
    if (*(short *)(*(longlong *)(param_2 + 8) + 10) < *(short *)(*(longlong *)(param_2 + 8) + 8)) {
      *(char *)(param_1 + 0x7d) = *(char *)(param_1 + 0x7d) + '\x01';
      uVar5 = 0x90001;
    }
    else {
      enrolGetTemplate(*(longlong **)(param_1 + 0x10),&local_res8);
      uVar2 = templateGetPackedSize(local_res8);
      lpMem = *(LPVOID *)(param_1 + 0x18);
      *(ulonglong *)(param_1 + 0x20) = uVar2 & 0xffffffff;
      if (lpMem != (LPVOID)0x0) {
        pvVar3 = GetProcessHeap();
        HeapFree(pvVar3,8,lpMem);
      }
      lVar1 = *(longlong *)(param_1 + 0x20);
      pvVar3 = GetProcessHeap();
      puVar4 = (undefined *)HeapAlloc(pvVar3,8,lVar1 + 4);
      *(undefined **)(param_1 + 0x18) = puVar4;
      if (puVar4 == (undefined *)0x0) {
        uVar5 = 0x8007000e;
      }
      else {
        templatePack(local_res8,puVar4);
        _AdapterSettemplateCRC_FUN_1800504d0(*(byte **)(param_1 + 0x18),*(uint *)(param_1 + 0x20));
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054880(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x13d,&DAT_180072bc8,
                        (uint)*(byte *)(param_1 + 0x7b),*(undefined *)(param_1 + 0x7c));
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"_AdapterCheckEnrollmentStatus",0x1638,0,
                   (undefined *)L"enroll Good finger number:0x%x, enroll ALL finger number:0x%x");
        *(char *)(param_1 + 0x7d) = *(char *)(param_1 + 0x7d) + '\x01';
      }
    }
  }
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x13e,&DAT_180072bc8,(int)uVar5);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterCheckEnrollmentStatus",0x1641,0,(undefined *)L"Exit, hr=0x%x");
  return uVar5;
}



ulonglong _AdapterCheckTemplate_FUN_18004d190(byte *buffer,uint len)

{
  int crc_host;
  ulonglong uVar1;
  int crc_chip;

  uVar1 = (ulonglong)len;
  init_crc_FUN_180002d20();
  crc_DAT_1800b0550 = 0xffffffff;
  crc_host = calc_crc_FUN_180002de0(buffer,(short)len + -4);
  crc_chip = (uint)buffer[uVar1 - 1] * 0x1000000 + (uint)buffer[uVar1 - 2] * 0x10000 +
             (uint)buffer[uVar1 - 3] * 0x100 + (uint)buffer[uVar1 - 4];
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054880(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x109,&DAT_180072bc8,crc_host,
                  (char)crc_chip);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterChecktemplate",0x1342,0,
             (undefined *)L"check crc template:Crchost:0x%x----crcchip:0x%x");
  return (ulonglong)(crc_host == crc_chip);
}



undefined8
AdapterCompareCachedTemplateToCurrentFeatureSet_FUN_18004d280
          (longlong param_1,longlong param_2,longlong *param_3,undefined *param_4,uint *param_5)

{
  byte bVar1;
  uint *puVar2;
  HANDLE hHeap;
  uint *puVar3;
  undefined8 uVar4;
  ulonglong uVar5;
  undefined *puVar6;
  int local_res8 [2];
  uint local_res20 [2];
  int local_58 [2];
  uint local_50;
  uint uStack76;
  uint **local_48 [2];

  local_res8[0] = 0;
  local_48[0] = (uint **)0x0;
  hHeap = GetProcessHeap();
  puVar3 = (uint *)HeapAlloc(hHeap,8,4);
  *puVar3 = 0x28;
  *param_4 = 0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xc3,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterCompareCachedTemplateToCurrentFeatureSet",0xf3b,0,
             (undefined *)L"Entry");
  puVar2 = param_5;
  if (((param_1 == 0) || (param_2 == 0)) ||
     ((param_3 == (longlong *)0x0 || (param_5 == (uint *)0x0)))) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xc4,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_AdapterCompareCachedTemplateToCurrentFeatureSet",0xf42,0,
               (undefined *)L"Arg error");
    uVar4 = 0x80004003;
  }
  else {
    templateUnPack(*(uint **)(param_2 + 0xf8),*(uint *)(param_2 + 0x100),puVar3,(uint **)local_48);
    uVar4 = identifyImage(param_3,(longlong **)local_48,1,local_res20,local_58,&local_50,0,
                          *(byte *)(param_2 + 0x88),0,'\0');
    if ((int)uVar4 == 0x83) {
      *param_4 = 0;
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),(short)uVar4 + 0x42,&DAT_180072bc8)
        ;
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"_AdapterCompareCachedTemplateToCurrentFeatureSet",0xf4e,0,
                 (undefined *)L"identifyImage error");
      uVar4 = 0x80098005;
    }
    else {
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180055060(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xc6,&DAT_180072bc8,
                      *(undefined4 *)(param_2 + 0x128),(char)uStack76,(char)local_50,
                      (char)local_res20[0],(char)local_58[0],(char)local_res8[0]);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"_AdapterCompareCachedTemplateToCurrentFeatureSet",0xf53,0,
                 (undefined *)

                 L"identifyImage, control_type=%d, qualit=%u, coverage=%u, result=%d, score=%d, update=%d"
                );
      FUN_18003d660((longlong)

                    "%s %d identifyImage, control_type=%d, qualit=%u, coverage=%u, result=%d, score=%d, update=%d"
                    ,"_AdapterCompareCachedTemplateToCurrentFeatureSet",0xf54,
                    (ulonglong)*(uint *)(param_2 + 0x128));
      if (*(int *)(param_2 + 0x128) != 0) {
        *(short *)((longlong)puVar2 + 2) = (short)local_50;
        *(short *)puVar2 = (short)uStack76;
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180055000(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),199,&DAT_180072bc8,
                        *(undefined4 *)(param_2 + 0x128),(char)uStack76,(char)local_50);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"_AdapterCompareCachedTemplateToCurrentFeatureSet",0xf66,0,
                   (undefined *)L"TEST-control_type=%d, qualit=%u, coverage=%u");
      }
      if ((int)local_res20[0] < 0) {
        if (local_50 < *(byte *)(param_2 + 0x10a)) {
          *param_4 = 0;
          if (*(int *)(param_2 + 0x128) == 0) {
            *puVar2 = (uint)*(byte *)(param_2 + 0x110);
            uVar4 = 0x80098008;
          }
          else {
            if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (2 < (byte)PTR_LOOP_1800aff38[0x19])) {
              FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),200,&DAT_180072bc8);
            }
            debug_print_FUN_18003fc70
                      ((longlong)PTR_DAT_1800afca8,5,(undefined *)L"EngineAdapter.cpp",
                       (undefined *)L"_AdapterCompareCachedTemplateToCurrentFeatureSet",0xf74,0,
                       (undefined *)L"TEST-bad capture");
            uVar4 = 0x80098008;
          }
        }
        else {
          bVar1 = *(byte *)(param_2 + 0x10b);
          *param_4 = 0;
          if (uStack76 < bVar1) {
            if (*(int *)(param_2 + 0x128) == 0) {
              *puVar2 = (uint)*(byte *)(param_2 + 0x111);
              uVar4 = 0x80098008;
            }
            else {
              if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                  ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (2 < (byte)PTR_LOOP_1800aff38[0x19]))
              {
                FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xc9,&DAT_180072bc8);
              }
              debug_print_FUN_18003fc70
                        ((longlong)PTR_DAT_1800afca8,5,(undefined *)L"EngineAdapter.cpp",
                         (undefined *)L"_AdapterCompareCachedTemplateToCurrentFeatureSet",0xf84,0,
                         (undefined *)L"TEST-bad capture");
              uVar4 = 0x80098008;
            }
          }
          else {
            if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (2 < (byte)PTR_LOOP_1800aff38[0x19])) {
              FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xca,&DAT_180072bc8,
                            local_res20[0]);
            }
            debug_print_FUN_18003fc70
                      ((longlong)PTR_DAT_1800afca8,5,(undefined *)L"EngineAdapter.cpp",
                       (undefined *)L"_AdapterCompareCachedTemplateToCurrentFeatureSet",0xf90,0,
                       (undefined *)L"TEST-identifyImage result<0, not match, result=%d");
            uVar4 = 0x80098008;
          }
        }
      }
      else {
        if (local_58[0] < 1) {
          *param_4 = 0;
          uVar4 = 0x80098008;
          if (*(int *)(param_2 + 0x128) == 0) {
            *puVar2 = (uint)*(byte *)(param_2 + 0x110);
          }
          else {
            if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (2 < (byte)PTR_LOOP_1800aff38[0x19])) {
              FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xcf,&DAT_180072bc8);
            }
            debug_print_FUN_18003fc70
                      ((longlong)PTR_DAT_1800afca8,5,(undefined *)L"EngineAdapter.cpp",
                       (undefined *)L"_AdapterCompareCachedTemplateToCurrentFeatureSet",0xfcb,0,
                       (undefined *)L"TEST-bad capture");
          }
        }
        else {
          *param_4 = 1;
          templateStudy(local_res8);
          if (1 < local_res8[0]) {
            if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
              FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xcb,&DAT_180072bc8,
                            local_res8[0]);
            }
            debug_print_FUN_18003fc70
                      ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                       (undefined *)L"_AdapterCompareCachedTemplateToCurrentFeatureSet",4000,0,
                       (undefined *)L"Replacement occurs, update=%d");
            identifyUpdate();
          }
          uVar4 = 0;
          if (0 < local_res8[0]) {
            if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
              FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xcc,&DAT_180072bc8,
                            local_res8[0]);
            }
            debug_print_FUN_18003fc70
                      ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                       (undefined *)L"_AdapterCompareCachedTemplateToCurrentFeatureSet",0xfa6,0,
                       (undefined *)L"Learning occurs, update=%d");
            uVar5 = templateGetPackedSize(local_48[0]);
            uVar5 = uVar5 & 0xffffffff;
            FUN_1800501e0(*(LPVOID *)(param_2 + 0xf8));
            puVar6 = (undefined *)FUN_18004cea0(uVar5);
            *(undefined **)(param_2 + 0xf8) = puVar6;
            uVar4 = 0;
            if (puVar6 == (undefined *)0x0) {
              if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                  ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
                FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xcd,&DAT_180072bc8);
              }
              debug_print_FUN_18003fc70
                        ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                         (undefined *)L"_AdapterCompareCachedTemplateToCurrentFeatureSet",0xfae,0,
                         (undefined *)L"Error, Alloc memory failed, keep cache");
              *(undefined8 *)(param_2 + 0x100) = 0;
            }
            else {
              templatePack(local_48[0],puVar6);
              *(ulonglong *)(param_2 + 0x100) = uVar5;
              if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                  ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19]))
              {
                FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xce,&DAT_180072bc8,
                              (int)uVar5);
              }
              debug_print_FUN_18003fc70
                        ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                         (undefined *)L"_AdapterCompareCachedTemplateToCurrentFeatureSet",0xfb7,0,
                         (undefined *)L"Cached tool enrolled templatesize=%u");
            }
          }
        }
      }
    }
    if (local_48[0] != (uint **)0x0) {
      templateDelete(local_48[0]);
    }
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054980(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xd0,&DAT_180072bc8,local_res8[0],
                    *param_4,(char)uVar4,(char)*puVar2);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_AdapterCompareCachedTemplateToCurrentFeatureSet",0xfe3,0,
               (undefined *)L"Exit, update:0x%x, match:%d, hr=0x%x, RejectDetail=0x%x");
  }
  return uVar4;
}



undefined8
FUN_18004dbb0(longlong param_1,longlong param_2,longlong *param_3,undefined8 *param_4,
             undefined *param_5,uint *param_6)

{
  undefined uVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined *puVar5;
  uint *puVar6;
  HANDLE hHeap;
  uint *puVar7;
  ulonglong uVar8;
  undefined8 uVar9;
  undefined *puVar10;
  uint uVar11;
  undefined8 uVar12;
  int local_res8 [2];
  undefined4 uVar13;
  wchar_t *pwVar14;
  int local_48;
  uint local_44;
  uint **local_40;
  undefined2 local_38;
  undefined2 uStack52;
  ULONGLONG local_30;

  uVar12 = 0;
  local_res8[0] = 0;
  local_40 = (uint **)0x0;
  hHeap = GetProcessHeap();
  puVar7 = (uint *)HeapAlloc(hHeap,8,4);
  *puVar7 = 0x28;
  local_30 = GetTickCount64();
  puVar5 = param_5;
  *param_5 = 0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xd1,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterCompareTemplateToCurrentFeatureSet",0x1004,0,
             (undefined *)L"Entry");
  puVar6 = param_6;
  if (((param_1 == 0) || (param_2 == 0)) ||
     ((param_3 == (longlong *)0x0 || ((param_4 == (undefined8 *)0x0 || (param_6 == (uint *)0x0))))))
  {
    if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
       (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xd2,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_AdapterCompareTemplateToCurrentFeatureSet",0x100c,0,
               (undefined *)L"Arg error");
    return 0x80004003;
  }
  if (((byte *)param_4[4] == (byte *)0x0) || (param_4[5] == 0)) {
    if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
       (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xd3,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_AdapterCompareTemplateToCurrentFeatureSet",0x1012,0,
               (undefined *)L"Arg error");
    uVar12 = 0x80070057;
    goto LAB_18004e4dc;
  }
  uVar8 = _AdapterCheckTemplate_FUN_18004d190((byte *)param_4[4],*(uint *)(param_4 + 5));
  if ((int)uVar8 == 0) {
    *puVar5 = (char)uVar8;
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xd4,&DAT_180072bc8);
    }
    pwVar14 = L"_AdapterChecktemplate CRC error";
    uVar13 = 0x101d;
LAB_18004dd35:
    uVar12 = 0x80098005;
    uVar11 = 4;
  }
  else {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054ad0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xd5,&DAT_180072bc8,
                    (uint)*(byte *)(param_4 + 1),(char)param_4[4],(char)*(undefined4 *)(param_4 + 5)
                   );
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_AdapterCompareTemplateToCurrentFeatureSet",0x1022,0,
               (undefined *)
               L"subfactor=0x%x, Record->TemplateBlob=0x%p, Record->TemplateBlobSize=%u");
    templateUnPack((uint *)param_4[4],*(int *)(param_4 + 5) - 4,puVar7,(uint **)&local_40);
    uVar9 = identifyImage(param_3,(longlong **)&local_40,1,&local_44,&local_48,(uint *)&local_38,0,
                          *(byte *)(param_2 + 0x88),param_3[8],*(char *)(param_2 + 0x120));
    GetTickCount64();
    if ((int)uVar9 == 0x83) {
      *puVar5 = 0;
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xd6,&DAT_180072bc8);
      }
      pwVar14 = L"identifyImage error";
      uVar13 = 0x102e;
      goto LAB_18004dd35;
    }
    if ((int)uVar9 == 0x84) {
      *puVar5 = 0;
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"_AdapterCompareTemplateToCurrentFeatureSet",0x1034,0,
                 (undefined *)L"bioassay failed");
      uVar12 = 0x80098005;
      goto LAB_18004e4dc;
    }
    if (*(int *)(param_2 + 0x128) != 0) {
      *(undefined2 *)((longlong)puVar6 + 2) = local_38;
      *(undefined2 *)puVar6 = uStack52;
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180055000(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xd7,&DAT_180072bc8,
                      *(undefined4 *)(param_2 + 0x128),(char)uStack52,(char)local_38);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"_AdapterCompareTemplateToCurrentFeatureSet",0x103f,0,
                 (undefined *)L"TEST-control_type=%d, qualit=%u, coverage=%u");
    }
    if ((int)local_44 < 0) {
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"_AdapterCompareTemplateToCurrentFeatureSet",0x1044,0,
                 (undefined *)

                 L"match fail and retry:result=%d, quality=%u, coverage=%u, match_score=%d, update=%u, TemplateNum=NA, MaxTemplateNum=NA, capture_time=%ums, preprocess_time=%ums, authenticate_time=%ums"
                );
      *puVar5 = 0;
      uVar12 = 0x80098005;
      goto LAB_18004e4dc;
    }
    if (local_48 < 1) {
      *puVar5 = 0;
      uVar12 = 0x80098005;
      if (*(int *)(param_2 + 0x128) == 0) {
        *puVar6 = (uint)*(byte *)(param_2 + 0x110);
        goto LAB_18004e4dc;
      }
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (2 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xdd,&DAT_180072bc8);
      }
      pwVar14 = L"TEST-bad capture";
      uVar13 = 0x1099;
      uVar11 = 5;
    }
    else {
      *puVar5 = 1;
      templateStudy(local_res8);
      if (1 < local_res8[0]) {
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xd8,&DAT_180072bc8,local_res8[0]
                       );
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"_AdapterCompareTemplateToCurrentFeatureSet",0x1058,0,
                   (undefined *)L"Replacement occurs, update=%d");
        identifyUpdate();
      }
      if (local_res8[0] < 1) goto LAB_18004e4dc;
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xd9,&DAT_180072bc8,local_res8[0]);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"_AdapterCompareTemplateToCurrentFeatureSet",0x105e,0,
                 (undefined *)L"Learning occurs, update=%d");
      uVar8 = templateGetPackedSize(local_40);
      uVar8 = uVar8 & 0xffffffff;
      if (*(LPVOID *)(param_2 + 0xe8) != (LPVOID)0x0) {
        FUN_1800501e0(*(LPVOID *)(param_2 + 0xe8));
        *(undefined8 *)(param_2 + 0xe8) = 0;
        *(undefined8 *)(param_2 + 0xf0) = 0;
        *(undefined *)(param_2 + 0x90) = 0;
        *(undefined8 *)(param_2 + 0x94) = 0;
        *(undefined8 *)(param_2 + 0x9c) = 0;
        *(undefined8 *)(param_2 + 0xa4) = 0;
        *(undefined8 *)(param_2 + 0xac) = 0;
        *(undefined8 *)(param_2 + 0xb4) = 0;
        *(undefined8 *)(param_2 + 0xbc) = 0;
        *(undefined8 *)(param_2 + 0xc4) = 0;
        *(undefined8 *)(param_2 + 0xcc) = 0;
        *(undefined8 *)(param_2 + 0xd4) = 0;
        *(undefined4 *)(param_2 + 0xdc) = 0;
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xda,&DAT_180072bc8);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"_AdapterCompareTemplateToCurrentFeatureSet",0x1069,0,
                   (undefined *)L"Release m_latestIdentifiedFingerInfo");
      }
      puVar10 = (undefined *)FUN_18004cea0(uVar8 + 4);
      *(undefined **)(param_2 + 0xe8) = puVar10;
      if (puVar10 != (undefined *)0x0) {
        templatePack(local_40,puVar10);
        *(ulonglong *)(param_2 + 0xf0) = uVar8;
        uVar1 = *(undefined *)(param_4 + 1);
        *(undefined *)(param_2 + 0x90) = uVar1;
        puVar2 = (undefined4 *)*param_4;
        uVar13 = puVar2[1];
        uVar3 = puVar2[2];
        uVar4 = puVar2[3];
        *(undefined4 *)(param_2 + 0x94) = *puVar2;
        *(undefined4 *)(param_2 + 0x98) = uVar13;
        *(undefined4 *)(param_2 + 0x9c) = uVar3;
        *(undefined4 *)(param_2 + 0xa0) = uVar4;
        uVar13 = puVar2[5];
        uVar3 = puVar2[6];
        uVar4 = puVar2[7];
        *(undefined4 *)(param_2 + 0xa4) = puVar2[4];
        *(undefined4 *)(param_2 + 0xa8) = uVar13;
        *(undefined4 *)(param_2 + 0xac) = uVar3;
        *(undefined4 *)(param_2 + 0xb0) = uVar4;
        uVar13 = puVar2[9];
        uVar3 = puVar2[10];
        uVar4 = puVar2[0xb];
        *(undefined4 *)(param_2 + 0xb4) = puVar2[8];
        *(undefined4 *)(param_2 + 0xb8) = uVar13;
        *(undefined4 *)(param_2 + 0xbc) = uVar3;
        *(undefined4 *)(param_2 + 0xc0) = uVar4;
        uVar13 = puVar2[0xd];
        uVar3 = puVar2[0xe];
        uVar4 = puVar2[0xf];
        *(undefined4 *)(param_2 + 0xc4) = puVar2[0xc];
        *(undefined4 *)(param_2 + 200) = uVar13;
        *(undefined4 *)(param_2 + 0xcc) = uVar3;
        *(undefined4 *)(param_2 + 0xd0) = uVar4;
        *(undefined8 *)(param_2 + 0xd4) = *(undefined8 *)(puVar2 + 0x10);
        *(undefined4 *)(param_2 + 0xdc) = puVar2[0x12];
        *(undefined4 *)(param_2 + 0xe0) = 1;
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_1800548d0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xdc,&DAT_180072bc8,(int)uVar8,
                        uVar1,1);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"_AdapterCompareTemplateToCurrentFeatureSet",0x107b,0,
                   (undefined *)L"new templatesize=%u, subfactor=0x%x, Cnt=%u");
        uVar12 = 0;
        goto LAB_18004e4dc;
      }
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xdb,&DAT_180072bc8);
      }
      uVar11 = 2;
      pwVar14 = L"Error, Alloc memory failed";
      uVar13 = 0x1070;
    }
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,uVar11,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterCompareTemplateToCurrentFeatureSet",uVar13,0,
             (undefined *)pwVar14);
LAB_18004e4dc:
  if (local_40 != (uint **)0x0) {
    templateDelete(local_40);
  }
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054980(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xde,&DAT_180072bc8,local_res8[0],
                  *puVar5,(char)uVar12,(char)*puVar6);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterCompareTemplateToCurrentFeatureSet",0x10b1,0,
             (undefined *)L"Exit, update:0x%x, match:%d, hr=0x%x, RejectDetail=0x%x");
  return uVar12;
}



undefined8
FUN_18004e620(longlong param_1,uint *param_2,uint param_3,uint *param_4,uint param_5,
             undefined *param_6)

{
  longlong lVar1;
  undefined *puVar2;
  HANDLE hHeap;
  uint *puVar3;
  ulonglong uVar4;
  uint uVar5;
  undefined8 uVar6;
  uint local_res10 [2];
  undefined4 uVar7;
  wchar_t *pwVar8;
  void **local_38;
  uint **local_30;

  uVar6 = 0;
  local_30 = (uint **)0x0;
  local_38 = (void **)0x0;
  local_res10[0] = 0;
  hHeap = GetProcessHeap();
  puVar3 = (uint *)HeapAlloc(hHeap,8,4);
  *puVar3 = 0x28;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x145,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterCompareTemplateToEnrollmentTemplate",0x16af,0,
             (undefined *)L"Entry");
  puVar2 = param_6;
  uVar5 = param_5;
  if (((param_2 == (uint *)0x0) || (param_4 == (uint *)0x0)) || (param_1 == 0)) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x146,&DAT_180072bc8);
    }
    uVar5 = 2;
    pwVar8 = L"Arg error";
    uVar7 = 0x16b5;
  }
  else {
    lVar1 = *(longlong *)(param_1 + 0x38);
    if (lVar1 != 0) {
      uVar4 = _AdapterCheckTemplate_FUN_18004d190((byte *)param_4,param_5);
      if ((int)uVar4 == 0) {
        *puVar2 = 0;
        uVar6 = 0;
      }
      else {
        templateUnPack(param_2,param_3,puVar3,(uint **)&local_38);
        templateUnPack(param_4,uVar5 - 4,puVar3,(uint **)&local_30);
        identifytemplate(local_30,local_38,(ulonglong)*(uint *)(lVar1 + 0x538),local_res10);
        if ((int)local_res10[0] < 0) {
          *puVar2 = 0;
        }
        else {
          *puVar2 = 1;
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
            FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x148,&DAT_180072bc8);
          }
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"_AdapterCompareTemplateToEnrollmentTemplate",0x16d7,0,
                     (undefined *)L"match");
        }
      }
      goto LAB_18004e8d4;
    }
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x147,&DAT_180072bc8);
    }
    uVar5 = 4;
    pwVar8 = L"Enginecontext NULL";
    uVar7 = 0x16c1;
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,uVar5,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterCompareTemplateToEnrollmentTemplate",uVar7,0,(undefined *)pwVar8
            );
  uVar6 = 0x80004003;
LAB_18004e8d4:
  if (local_38 != (void **)0x0) {
    templateDelete(local_38);
  }
  if (local_30 != (uint **)0x0) {
    templateDelete(local_30);
  }
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054880(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x149,&DAT_180072bc8,(int)uVar6,*puVar2
                 );
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterCompareTemplateToEnrollmentTemplate",0x16ec,0,
             (undefined *)L" Exit, hr=0x%x, match:0x%x");
  return uVar6;
}



undefined8 FUN_18004e990(longlong param_1,longlong param_2)

{
  longlong lVar1;
  uint **ppuVar2;
  undefined8 uVar3;
  undefined4 uVar4;

  uVar3 = 0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x11e,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterCreateEnrollment",0x1496,0,(undefined *)L"Entry");
  if ((param_2 == 0) || (param_1 == 0)) {
    if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
       (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x11f,&DAT_180072bc8);
    }
    uVar4 = 0x149c;
  }
  else {
    lVar1 = *(longlong *)(param_1 + 0x38);
    if (lVar1 != 0) {
      ppuVar2 = enrolStart();
      if (ppuVar2 == (uint **)0x0) {
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x121,&DAT_180072bc8);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"_AdapterCreateEnrollment",0x14b2,0,
                   (undefined *)L"enrolStart error");
        return 0x8007000e;
      }
      *(ushort *)(ppuVar2 + 1) = (ushort)*(byte *)(lVar1 + 0x7e);
      *(uint ***)(param_2 + 8) = ppuVar2;
      goto LAB_18004eb7c;
    }
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x120,&DAT_180072bc8);
    }
    uVar4 = 0x14a7;
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterCreateEnrollment",uVar4,0,(undefined *)L"Arg error");
  uVar3 = 0x80004003;
LAB_18004eb7c:
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x122,&DAT_180072bc8,(int)uVar3);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterCreateEnrollment",0x14bf,0,(undefined *)L"Exit, hr=0x%x");
  return uVar3;
}



undefined8 FUN_18004ec10(longlong param_1)

{
  LPVOID lpMem;
  HANDLE hHeap;
  undefined8 uVar1;

  uVar1 = 0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x15b,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterDestroyEnrollmentTemplate",0x17c9,0,(undefined *)L"Entry");
  if (param_1 == 0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x15c,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_AdapterDestroyEnrollmentTemplate",0x17ce,0,
               (undefined *)L"Enginecontext NULL");
    uVar1 = 0x80004003;
  }
  else {
    if (*(void ***)(param_1 + 0x10) != (void **)0x0) {
      enrolFinish(*(void ***)(param_1 + 0x10));
      *(undefined8 *)(param_1 + 0x10) = 0;
      *(undefined4 *)(param_1 + 8) = 0;
    }
    lpMem = *(LPVOID *)(param_1 + 0x18);
    if (lpMem != (LPVOID)0x0) {
      hHeap = GetProcessHeap();
      HeapFree(hHeap,8,lpMem);
      *(undefined8 *)(param_1 + 0x18) = 0;
      *(undefined8 *)(param_1 + 0x20) = 0;
    }
  }
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x15d,&DAT_180072bc8,(int)uVar1);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterDestroyEnrollmentTemplate",0x17e7,0,
             (undefined *)L"Exit, hr=0x%x");
  return uVar1;
}



undefined8 FUN_18004ede0(longlong param_1)

{
  uint uVar1;
  byte bVar2;
  byte bVar3;
  byte bVar4;
  bool bVar5;
  bool bVar6;
  bool bVar7;
  bool bVar8;
  byte local_res10;
  byte local_res18;
  byte *local_res20;

  bVar2 = *(byte *)(param_1 + 0x7e);
  local_res20 = (byte *)0x0;
  local_res10 = 0;
  local_res18 = 0;
  bVar4 = 0;
  bVar3 = 0;
  FUN_18003cf30(-0x7ffffffe,L"Software\\Goodix\\FP\\parameter\\",L"MaxEnrollNum",(DWORD *)0x0,
                &local_res20,(uint *)0x0);
  bVar5 = local_res20 == (byte *)0x0;
  if (!bVar5) {
    bVar2 = *local_res20;
    free(local_res20);
    local_res20 = (byte *)0x0;
  }
  FUN_18003cf30(-0x7ffffffe,L"Software\\Goodix\\FP\\parameter\\",L"TopEdge",(DWORD *)0x0,
                &local_res20,(uint *)0x0);
  bVar6 = local_res20 == (byte *)0x0;
  if (!bVar6) {
    bVar4 = *local_res20;
    free(local_res20);
    local_res20 = (byte *)0x0;
  }
  FUN_18003cf30(-0x7ffffffe,L"Software\\Goodix\\FP\\parameter\\",L"BottomEdge",(DWORD *)0x0,
                &local_res20,(uint *)0x0);
  bVar7 = local_res20 == (byte *)0x0;
  if (!bVar7) {
    local_res10 = *local_res20;
    free(local_res20);
    local_res20 = (byte *)0x0;
  }
  FUN_18003cf30(-0x7ffffffe,L"Software\\Goodix\\FP\\parameter\\",L"LeftEdge",(DWORD *)0x0,
                &local_res20,(uint *)0x0);
  bVar8 = local_res20 == (byte *)0x0;
  if (!bVar8) {
    local_res18 = *local_res20;
    free(local_res20);
    local_res20 = (byte *)0x0;
  }
  FUN_18003cf30(-0x7ffffffe,L"Software\\Goodix\\FP\\parameter\\",L"RightEdge",(DWORD *)0x0,
                &local_res20,(uint *)0x0);
  if (local_res20 == (byte *)0x0) {
    if (bVar8 && (bVar7 && (bVar6 && bVar5))) {
      return 0;
    }
  }
  else {
    bVar3 = *local_res20;
    free(local_res20);
    local_res20 = (byte *)0x0;
  }
  if (((((byte)(bVar2 - 1) < 0x14) && (bVar4 <= bVar2)) && (local_res10 <= bVar2)) &&
     ((local_res18 <= bVar2 && (bVar3 <= bVar2)))) {
    uVar1 = (uint)bVar4 + (uint)local_res10 + (uint)local_res18 + (uint)bVar3;
    if (uVar1 <= bVar2) {
      if ((uVar1 == 0) ||
         ((int)(((((uint)bVar2 - (uint)bVar4) - (uint)local_res10) - (uint)local_res18) -
               (uint)bVar3) < 0xb)) {
        *(byte *)(param_1 + 0x113) = local_res10;
        *(byte *)(param_1 + 0x114) = local_res18;
        *(byte *)(param_1 + 0x112) = bVar4;
        *(byte *)(param_1 + 0x115) = bVar3;
        *(byte *)(param_1 + 0x108) = bVar2;
        *(undefined *)(param_1 + 0x10f) = 1;
        if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
           (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (3 < (byte)PTR_LOOP_1800aff38[0x19])))) {
          FUN_180055210(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x205,&DAT_180072bc8,(uint)bVar2,
                        bVar4,local_res10,local_res18,bVar3);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"_AdapterGetEnrollmentRequirements",0x20d8,0,
                   (undefined *)

                   L"Get register value: maxEnrollNum:%d TopEdge:%d BottomEdge:%d LeftEdge:%d RightEdge:%d "
                  );
        return 0;
      }
    }
  }
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x204,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterGetEnrollmentRequirements",0x20c9,0,
             (undefined *)L"regValue is not in this range: maxEnrollNum<=20 && center<=10");
  return 0;
}



undefined8 FUN_18004f1a0(longlong param_1)

{
  byte bVar1;
  undefined8 uVar2;
  uint uVar3;
  byte *local_res8;
  undefined4 uVar4;
  wchar_t *pwVar5;

  uVar2 = 0;
  local_res8 = (byte *)0x0;
  if (param_1 == 0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1fa,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_AdapterGetRegister",0x2010,0,(undefined *)L"NULL Context");
    uVar2 = 0x80004003;
  }
  else {
    FUN_18003cf30(-0x7ffffffe,L"Software\\Goodix\\FP\\parameter\\",L"LiveNessSwitch",(DWORD *)0x0,
                  &local_res8,(uint *)0x0);
    if (local_res8 != (byte *)0x0) {
      *(byte *)(param_1 + 0x109) = *local_res8;
      free(local_res8);
      local_res8 = (byte *)0x0;
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1fb,&DAT_180072bc8,
                      (uint)*(byte *)(param_1 + 0x109));
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"_AdapterGetRegister",0x201e,0,
                 (undefined *)L"Get register value: livenessswitch:%d ");
    }
    FUN_18003cf30(-0x7ffffffe,L"Software\\Goodix\\FP\\parameter\\",L"CoverageMin",(DWORD *)0x0,
                  &local_res8,(uint *)0x0);
    if (local_res8 != (byte *)0x0) {
      *(byte *)(param_1 + 0x10a) = *local_res8;
      free(local_res8);
      local_res8 = (byte *)0x0;
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1fc,&DAT_180072bc8,
                      (uint)*(byte *)(param_1 + 0x10a));
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"_AdapterGetRegister",0x202a,0,
                 (undefined *)L"Get register value: mincoverage:%d ");
    }
    FUN_18003cf30(-0x7ffffffe,L"Software\\Goodix\\FP\\parameter\\",L"QualityMin",(DWORD *)0x0,
                  &local_res8,(uint *)0x0);
    if (local_res8 != (byte *)0x0) {
      *(byte *)(param_1 + 0x10b) = *local_res8;
      free(local_res8);
      local_res8 = (byte *)0x0;
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1fd,&DAT_180072bc8,
                      (uint)*(byte *)(param_1 + 0x10b));
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"_AdapterGetRegister",0x2036,0,
                 (undefined *)L"Get register value: minquality:%d ");
    }
    FUN_18003cf30(-0x7ffffffe,L"Software\\Goodix\\FP\\parameter\\",L"ForceRollBack",(DWORD *)0x0,
                  &local_res8,(uint *)0x0);
    if (local_res8 != (byte *)0x0) {
      *(byte *)(param_1 + 0x10c) = *local_res8;
      free(local_res8);
      local_res8 = (byte *)0x0;
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1fe,&DAT_180072bc8,
                      (uint)*(byte *)(param_1 + 0x10c));
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"_AdapterGetRegister",0x2042,0,
                 (undefined *)L"Get register value: forcerollback:%d ");
    }
    FUN_18003cf30(-0x7ffffffe,L"Software\\Goodix\\FP\\parameter\\",L"OverlayRatio",(DWORD *)0x0,
                  &local_res8,(uint *)0x0);
    if (local_res8 != (byte *)0x0) {
      *(byte *)(param_1 + 0x10d) = *local_res8;
      free(local_res8);
      local_res8 = (byte *)0x0;
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1ff,&DAT_180072bc8,
                      (uint)*(byte *)(param_1 + 0x10d));
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"_AdapterGetRegister",0x204e,0,
                 (undefined *)L"Get register value: overlayratio:%d ");
    }
    FUN_18003cf30(-0x7ffffffe,L"Software\\Goodix\\FP\\parameter\\",L"PreoverlayRatio",(DWORD *)0x0,
                  &local_res8,(uint *)0x0);
    if (local_res8 != (byte *)0x0) {
      *(byte *)(param_1 + 0x10e) = *local_res8;
      free(local_res8);
      local_res8 = (byte *)0x0;
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x200,&DAT_180072bc8,
                      (uint)*(byte *)(param_1 + 0x10e));
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"_AdapterGetRegister",0x205a,0,
                 (undefined *)L"Get register value: preoverlayratio:%d ");
    }
    FUN_18003cf30(-0x7ffffffe,L"Software\\Goodix\\FP\\parameter\\",L"RejectDetail",(DWORD *)0x0,
                  &local_res8,(uint *)0x0);
    if (local_res8 != (byte *)0x0) {
      bVar1 = *local_res8;
      if ((byte)(bVar1 - 1) < 9) {
        *(byte *)(param_1 + 0x110) = bVar1;
        free(local_res8);
        local_res8 = (byte *)0x0;
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x202,&DAT_180072bc8,
                        (uint)*(byte *)(param_1 + 0x110));
        }
        uVar3 = 7;
        pwVar5 = L"Get register value: RejectDetail:%d ";
        uVar4 = 0x206e;
      }
      else {
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x201,&DAT_180072bc8,(uint)bVar1)
          ;
        }
        uVar3 = 4;
        pwVar5 = L"%d is not in this range:1<=RejectDetail<=9";
        uVar4 = 0x2064;
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,uVar3,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"_AdapterGetRegister",uVar4,0,(undefined *)pwVar5);
    }
    FUN_18003cf30(-0x7ffffffe,L"Software\\Goodix\\FP\\parameter\\",L"RejectDetail_quality",
                  (DWORD *)0x0,&local_res8,(uint *)0x0);
    if (local_res8 != (byte *)0x0) {
      if ((byte)(*local_res8 - 1) < 9) {
        *(byte *)(param_1 + 0x111) = *local_res8;
        free(local_res8);
        uVar3 = 7;
        pwVar5 = L"Get register value: RejectDetail_quality:%d ";
        uVar4 = 0x207e;
        local_res8 = (byte *)0x0;
      }
      else {
        uVar3 = 4;
        pwVar5 = L"%d is not in this range:1<=RejectDetail_quality<=9";
        uVar4 = 0x2077;
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,uVar3,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"_AdapterGetRegister",uVar4,0,(undefined *)pwVar5);
    }
  }
  return uVar2;
}



void _AdapterInitPreprocessor_FUN_18004f8d0(longlong param_1,undefined8 param_2,undefined4 param_3)

{
  longlong lVar1;
  uint uVar2;
  longlong lVar3;
  undefined8 uVar4;
  longlong *lpMem;
  ulonglong uVar5;
  HANDLE pvVar6;
  undefined4 uVar7;
  int local_80;
  undefined local_78 [24];
  undefined8 local_60;
  uint local_54;
  uint local_50;
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xffffffffffffff48;
  lVar1 = *(longlong *)(param_1 + 0x38);
  lpMem = (longlong *)0x0;
  if (lVar1 == 0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x27,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_AdapterInitPreprocessor",0x534,0,(undefined *)L"Enginecontext NULL");
    uVar7 = 0x8009800f;
    goto LAB_18004fcad;
  }
  lVar3 = (longlong)DAT_1800b17c8;
  *(undefined4 *)(lVar1 + 0x74) = param_3;
  local_50 = (uint)*(ushort *)(&DAT_1800afd10 + lVar3 * 0xe);
  local_54 = (uint)*(ushort *)(&DAT_1800afd12 + lVar3 * 0xe);
  local_60 = param_2;
  uVar4 = preprocess_get_calidata_len();
  uVar2 = (uint)uVar4;
  pvVar6 = GetProcessHeap();
  lpMem = (longlong *)HeapAlloc(pvVar6,8,(ulonglong)(uVar2 + 0x10));
  if (lpMem == (longlong *)0x0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x28,&DAT_180072bc8,
                    *(int *)(lVar1 + 0x74) + 0x10 + uVar2);
    }
    local_80 = *(int *)(lVar1 + 0x74) + 0x10 + uVar2;
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_AdapterInitPreprocessor",0x544,0,
               (undefined *)L"Alloc memory error, len=%u");
    uVar7 = 0x8007000e;
    goto LAB_18004fcad;
  }
  FUN_18003e430(L"C:\\ProgramData\\Goodix\\goodix_calib.dat",lpMem,(ulonglong)(uVar2 + 0x10),L"rb");
  if ((*(longlong *)(lVar1 + 0x49) == *lpMem) && (*(longlong *)(lVar1 + 0x51) == lpMem[1])) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (2 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x29,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,5,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_AdapterInitPreprocessor",0x552,0,
               (undefined *)L"Read Kr from system file");
    uVar4 = preprocess_load_calidata((int *)(lpMem + 2),uVar2);
    if ((int)uVar4 != 0) {
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (2 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x2a,&DAT_180072bc8);
      }
      uVar7 = 0x558;
      goto LAB_18004fbc6;
    }
  }
  else {
    if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
       (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (2 < (byte)PTR_LOOP_1800aff38[0x19])))) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x2b,&DAT_180072bc8);
    }
    uVar7 = 0x561;
LAB_18004fbc6:
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,5,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_AdapterInitPreprocessor",uVar7,0,(undefined *)L"Load default Kr");
    preprocess_init_calidata();
  }
  uVar5 = preprocessor_init((longlong)local_78);
  if (((int)uVar5 == 0) || (uVar5 = preprocessor_init((longlong)local_78), (int)uVar5 == 0)) {
    *(undefined *)(lVar1 + 0x70) = 1;
  }
  uVar7 = 0;
  if (*(char *)(lVar1 + 0x70) == '\x01') {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x2c,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_AdapterInitPreprocessor",0x575,0,(undefined *)L"Save Kr to file");
    uVar7 = 0;
    if (((*(longlong *)(lVar1 + 0x49) != *lpMem) || (*(longlong *)(lVar1 + 0x51) != lpMem[1])) ||
       (*(int *)(lVar1 + 0x8c) == 1)) {
      _SaveCalitoWbioStorage_FUN_1800519a0(param_1);
    }
  }
LAB_18004fcad:
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x2d,&DAT_180072bc8,uVar7);
  }
  local_80 = uVar7;
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterInitPreprocessor",0x589,0,(undefined *)L"Exit, hr=0x%x");
  if (lpMem != (longlong *)0x0) {
    pvVar6 = GetProcessHeap();
    HeapFree(pvVar6,8,lpMem);
  }
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xffffffffffffff48);
  return;
}



undefined8
FUN_18004fd70(longlong param_1,longlong param_2,longlong *param_3,longlong param_4,uint *param_5)

{
  ushort uVar1;
  undefined2 uVar2;
  int **ppiVar3;
  undefined8 uVar4;
  uint uVar5;
  undefined8 uVar6;
  bool bVar7;
  undefined4 uVar8;
  wchar_t *pwVar9;

  uVar6 = 0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x132,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterMergeFeatureSetWithEnrollment",0x1551,0,(undefined *)L"Entry");
  bVar7 = false;
  if (((param_2 == 0) || (param_3 == (longlong *)0x0)) ||
     ((param_4 == 0 || (param_5 == (uint *)0x0)))) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x133,&DAT_180072bc8);
    }
    uVar6 = 0x80004003;
  }
  else {
    if (*(int *)(param_2 + 0x128) != 0) {
      uVar1 = *(ushort *)((longlong)param_3 + 0x34);
      *(ushort *)param_5 = uVar1;
      uVar2 = *(undefined2 *)(param_3 + 6);
      *(undefined2 *)((longlong)param_5 + 2) = uVar2;
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054880(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x134,&DAT_180072bc8,(uint)uVar1,
                      (char)uVar2);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"_AdapterMergeFeatureSetWithEnrollment",0x1564,0,
                 (undefined *)L"TEST-quality=%u, coverage=%u");
    }
    GetTickCount64();
    uVar4 = enrolAddImage(*(longlong ***)(param_4 + 8),param_3,param_3[8],*(char *)(param_2 + 0x120)
                          ,(uint *)(param_3 + 6));
    if ((int)uVar4 == 0x83) {
      uVar6 = 0x8009800f;
      FUN_18004ec10(param_2);
      FUN_180046660(param_1);
    }
    else {
      if ((int)uVar4 == 0) {
        ppiVar3 = *(int ***)(param_4 + 8);
        if (*(uint *)((longlong)ppiVar3 + 0x14) != (uint)*(byte *)(param_2 + 0x10d) &&
            (int)(uint)*(byte *)(param_2 + 0x10d) <= (int)*(uint *)((longlong)ppiVar3 + 0x14)) {
          bVar7 = *(uint *)(ppiVar3 + 2) != (uint)*(byte *)(param_2 + 0x10e) &&
                  (int)(uint)*(byte *)(param_2 + 0x10e) <= *(int *)(ppiVar3 + 2);
        }
        if ((*(byte *)(param_2 + 0x10c) & bVar7) == 0) {
          GetTickCount64();
          uVar5 = 7;
          pwVar9 =
          L"enroll success:quality=%u,coverage=%u,PreOverlay=%u,Overlay=%u,enrolledNum=%u,maxEnrollNum=%u,capture_time=%ums, preprocess_time=%ums, enroll_time=%ums"
          ;
          uVar8 = 0x159f;
        }
        else {
          enrolDeleteImage(ppiVar3);
          uVar6 = 0x80098008;
          if (*(int *)(param_2 + 0x128) == 0) {
            *param_5 = (uint)*(byte *)(param_2 + 0x110);
          }
          GetTickCount64();
          uVar5 = 4;
          pwVar9 =
          L"enroll fail:quality=%u,coverage=%u,PreOverlay=%u,Overlay=%u,enrolledNum=%u,maxEnrollNum=%u,capture_time=%ums, preprocess_time=%ums, enroll_time=%ums"
          ;
          uVar8 = 0x1596;
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,uVar5,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"_AdapterMergeFeatureSetWithEnrollment",uVar8,0,(undefined *)pwVar9
                  );
      }
      else {
        uVar6 = 0x80098008;
        if (*(int *)(param_2 + 0x128) == 0) {
          *param_5 = (uint)*(byte *)(param_2 + 0x110);
        }
      }
    }
  }
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x135,&DAT_180072bc8,(int)uVar6);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterMergeFeatureSetWithEnrollment",0x15a8,0,
             (undefined *)L"Exit, hr=0x%x");
  return uVar6;
}



void FUN_1800501e0(LPVOID param_1)

{
  HANDLE hHeap;

  hHeap = GetProcessHeap();
                    // WARNING: Could not recover jumptable at 0x0001800501ff. Too many branches
                    // WARNING: Treating indirect jump as call
  HeapFree(hHeap,8,param_1);
  return;
}



ulonglong FUN_180050210(HANDLE *param_1,LPVOID param_2)

{
  BOOL BVar1;
  DWORD DVar2;
  ulonglong uVar3;
  DWORD local_res8 [2];
  _OVERLAPPED local_38;

  uVar3 = 0;
  local_res8[0] = 0;
  local_38.Internal = 0;
  local_38.InternalHigh = 0;
  local_38.u = 0;
  local_38.hEvent = (HANDLE)0x0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x100,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterSetPoweraction",0x12a1,0,(undefined *)L"Entry");
  if (param_1 == (HANDLE *)0x0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x101,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_AdapterSetPoweraction",0x12a5,0,(undefined *)L"Arg error");
    uVar3 = 0x80004003;
    goto LAB_180050430;
  }
  local_38.hEvent = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCWSTR)0x0);
  if (local_38.hEvent == (HANDLE)0x0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x102,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_AdapterSetPoweraction",0x12ae,0,(undefined *)L"Create Event NULL");
    uVar3 = 0x8007000e;
    goto LAB_180050430;
  }
  BVar1 = DeviceIoControl(*param_1,0x44200c,param_2,8,(LPVOID)0x0,0,local_res8,
                          (LPOVERLAPPED)&local_38);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    if (DVar2 == 0x3e5) {
      SetLastError(0);
      BVar1 = GetOverlappedResult(*param_1,(LPOVERLAPPED)&local_38,local_res8,1);
      if (BVar1 != 0) goto LAB_18005041e;
    }
  }
  else {
LAB_18005041e:
    if (local_res8[0] == 8) goto LAB_180050430;
  }
  DVar2 = GetLastError();
  uVar3 = (ulonglong)DVar2;
LAB_180050430:
  if (local_38.hEvent != (HANDLE)0x0) {
    CloseHandle(local_38.hEvent);
  }
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x103,&DAT_180072bc8,(int)uVar3);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterSetPoweraction",0x12da,0,(undefined *)L"Exit, hr=0x%x");
  return uVar3;
}



undefined8 _AdapterSettemplateCRC_FUN_1800504d0(byte *buffer,uint len)

{
  undefined4 uVar1;

  if (buffer == (byte *)0x0) {
    return 0;
  }
  init_crc_FUN_180002d20();
  crc_DAT_1800b0550 = 0xffffffff;
  uVar1 = calc_crc_FUN_180002de0(buffer,(short)len);
  *(undefined4 *)(buffer + len) = uVar1;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x108,&DAT_180072bc8,uVar1);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_AdapterSettemplateCRC",0x132f,0,
             (undefined *)L"add crc to template:Crchost:0x%x");
  return 1;
}



ulonglong FUN_1800505b0(longlong param_1,longlong param_2,undefined *param_3)

{
  code *pcVar1;
  uint uVar2;
  BOOL BVar3;
  ulonglong uVar4;
  ulonglong local_res8;
  undefined8 local_res20;
  undefined4 uVar5;
  wchar_t *pwVar6;
  ulonglong local_48;
  ulonglong local_40;
  ulonglong local_38 [2];

  local_res8 = 0;
  local_res20 = 0;
  local_40 = 0;
  local_38[0] = 0;
  local_48 = 0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1ee,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_CheckAvailableRecord",0x1f6e,0,(undefined *)L"Entry");
  if (((param_1 == 0) || (param_2 == 0)) || (param_3 == (undefined *)0x0)) {
    uVar4 = 0x80004003;
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1ef,&DAT_180072bc8);
    }
    uVar2 = 2;
    pwVar6 = L"Arg error";
    uVar5 = 0x1f77;
    goto LAB_180050ba7;
  }
  if (*(longlong *)(param_1 + 0x28) == 0) {
    uVar4 = 0x80004003;
LAB_180050788:
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1f0,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_CheckAvailableRecord",0x1f7f,0,
               (undefined *)L"WbioStorageGetDatabaseSize failed");
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_1800549f0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1f1,&DAT_180072bc8,(int)uVar4,
                    (char)(local_res8 >> 10),(char)local_res20);
    }
    uVar5 = 0x1f83;
  }
  else {
    pcVar1 = *(code **)(*(longlong *)(param_1 + 0x28) + 0x60);
    if (pcVar1 == (code *)0x0) {
      uVar4 = 0x80004001;
      goto LAB_180050788;
    }
    uVar2 = (*pcVar1)(param_1,&local_res8,&local_res20);
    uVar4 = (ulonglong)uVar2;
    if ((int)uVar2 < 0) goto LAB_180050788;
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1f2,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_CheckAvailableRecord",0x1f87,0,
               (undefined *)L"WbioStorageGetDatabaseSize success");
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_1800549f0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),499,&DAT_180072bc8,uVar2,
                    (char)(local_res8 >> 10),(char)local_res20);
    }
    uVar5 = 0x1f8b;
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_CheckAvailableRecord",uVar5,0,
             (undefined *)L"hr=0x%x, availableRecordCount = %d KB, totalRecordCount = %d");
  BVar3 = GetDiskFreeSpaceExW(L"C:",&local_40,local_38,&local_48);
  if (BVar3 != 0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1f5,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_CheckAvailableRecord",0x1f9a,0,
               (undefined *)L"GetDiskFreeSpaceEx success");
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1f6,&DAT_180072bc8,
                    (int)(local_40 >> 10));
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_CheckAvailableRecord",0x1f9c,0,
               (undefined *)L"lpFreeBytesAvailableToCaller = %d KB");
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1f7,&DAT_180072bc8,
                    (int)(local_38[0] >> 10));
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_CheckAvailableRecord",0x1f9e,0,
               (undefined *)L"lpTotalNumberOfBytes = %d KB");
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1f8,&DAT_180072bc8,
                    (int)(local_48 >> 10));
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_CheckAvailableRecord",0x1fa0,0,
               (undefined *)L"lpTotalNumberOfFreeBytes = %d KB");
    if ((*(ulonglong *)(param_2 + 0x28) < local_res8 - 0xa00000) &&
       (*(ulonglong *)(param_2 + 0x28) < local_48 - 0xa00000)) {
      *param_3 = 1;
      return uVar4;
    }
    if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
       (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (4 < (byte)PTR_LOOP_1800aff38[0x19])))) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x1f9,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_CheckAvailableRecord",0x1fa7,0,(undefined *)L"out of disk space");
    *param_3 = 0;
    return uVar4;
  }
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),500,&DAT_180072bc8);
  }
  uVar2 = 9;
  pwVar6 = L"GetDiskFreeSpaceEx failed";
  uVar5 = 0x1f95;
LAB_180050ba7:
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,uVar2,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_CheckAvailableRecord",uVar5,0,(undefined *)pwVar6);
  return uVar4;
}



undefined8 FUN_180050be0(longlong param_1,byte param_2,undefined8 *param_3,undefined8 *param_4)

{
  undefined8 *puVar1;
  undefined8 uVar2;

  uVar2 = 0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xa4,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_CreateBirFromAdapterData",0xc2d,0,(undefined *)L"Entry");
  if ((param_1 == 0) || (param_4 == (undefined8 *)0x0)) {
    if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
       (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
      FUN_180055460(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xa5,&DAT_180072bc8,param_1,
                    (char)param_4);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_CreateBirFromAdapterData",0xc33,0,
               (undefined *)L"Arg error, context=0x%p, pBirSize=0x%p");
    uVar2 = 0x80004003;
  }
  else {
    if ((param_2 & 0x20) == 0) {
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
        FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xa6,&DAT_180072bc8,(uint)param_2);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"_CreateBirFromAdapterData",0xc3b,0,
                 (undefined *)L"Arg error, Flags=0x%x");
      uVar2 = 0x80070057;
    }
    else {
      if ((*(longlong *)(param_1 + 0x38) == 0) || (*(SIZE_T *)(param_1 + 0x40) == 0)) {
        if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
           (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
          FUN_180055410(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xa7,&DAT_180072bc8,
                        *(longlong *)(param_1 + 0x38),(char)*(undefined4 *)(param_1 + 0x40));
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"_CreateBirFromAdapterData",0xc43,0,
                   (undefined *)L"Arg error, most recently samplebuffer=0x%p, samplesize=0x%x");
        uVar2 = 0x8009800f;
      }
      else {
        puVar1 = (undefined8 *)FUN_18004cea0(*(SIZE_T *)(param_1 + 0x40));
        *param_3 = puVar1;
        if (puVar1 == (undefined8 *)0x0) {
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
            FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xa8,&DAT_180072bc8);
          }
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"_CreateBirFromAdapterData",0xc4c,0,
                     (undefined *)L"Allocate memory error");
          uVar2 = 0x8007000e;
        }
        else {
          memcpy_FUN_180061f90
                    (puVar1,*(undefined8 **)(param_1 + 0x38),*(ulonglong *)(param_1 + 0x40));
          *param_4 = *(undefined8 *)(param_1 + 0x40);
        }
      }
    }
  }
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xa9,&DAT_180072bc8,(int)uVar2);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_CreateBirFromAdapterData",0xc56,0,(undefined *)L"Exit, hr=0x%x");
  return uVar2;
}



ulonglong FUN_180050f50(uint param_1,LPVOID *param_2,undefined8 *param_3,char param_4)

{
  LPVOID lpMem;
  longlong **pplVar1;
  undefined8 uVar2;
  HANDLE hHeap;
  ulonglong uVar3;
  uint uVar4;
  uint local_res10 [2];
  int local_38 [2];
  longlong *local_30;

  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),10,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_ForTestCreateTemplateWithFeatureSetAndIdentify",0x1a5,0,
             (undefined *)L"enter");
  if ((param_2 == (LPVOID *)0x0) || (param_3 == (undefined8 *)0x0)) {
    if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
       (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xb,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_ForTestCreateTemplateWithFeatureSetAndIdentify",0x1a9,0,
               (undefined *)L"wrong input parameters");
    uVar3 = 1;
  }
  else {
    *param_3 = 0;
    param_3[1] = 0;
    param_3[2] = 0;
    param_3[3] = 0;
    ppp_param_init(param_1);
    pplVar1 = (longlong **)enrolStart();
    *(undefined2 *)(pplVar1 + 1) = 1;
    param_3[1] = pplVar1;
    enrolAddImage(pplVar1,(longlong *)param_2,param_2[8],param_4,(uint *)(param_2 + 6));
    uVar4 = 0;
    local_30 = (longlong *)0x0;
    enrolGetTemplate((longlong *)param_3[1],&local_30);
    local_res10[0] = 0xffffffff;
    local_38[0] = 0;
    uVar2 = identifyImage((longlong *)param_2,&local_30,1,local_res10,local_38,(uint *)(param_2 + 6)
                          ,0,0,0,'\0');
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_1800551a0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xc,&DAT_180072bc8,(int)uVar2,
                    (char)local_res10[0],(char)local_38[0],0);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_ForTestCreateTemplateWithFeatureSetAndIdentify",0x1c6,0,
               (undefined *)L"ret=%d, result=%d, score=%d, update=%d");
    if ((((int)uVar2 == 0) && (-1 < (int)local_res10[0])) && (uVar4 = 0, 0 < local_38[0])) {
      uVar4 = 1;
    }
    lpMem = *param_2;
    if (lpMem != (LPVOID)0x0) {
      hHeap = GetProcessHeap();
      HeapFree(hHeap,8,lpMem);
      *param_2 = (LPVOID)0x0;
    }
    if ((void **)param_3[1] != (void **)0x0) {
      enrolFinish((void **)param_3[1]);
      param_3[1] = 0;
      *(undefined4 *)param_3 = 0;
    }
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xd,&DAT_180072bc8,uVar4);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_ForTestCreateTemplateWithFeatureSetAndIdentify",0x1d7,0,
               (undefined *)L"match(1-match,0-not match): %d");
    uVar3 = (ulonglong)(uVar4 ^ 1);
  }
  return uVar3;
}



void FUN_180051290(longlong param_1,undefined8 *param_2)

{
  uint uVar1;
  uint uVar2;
  ulonglong uVar3;
  uint local_260;
  undefined8 local_258;
  uint local_248 [2];
  undefined8 *local_240;
  WCHAR local_238 [264];
  ulonglong local_28;

  local_28 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffd68;
  if ((param_1 == 0) || (param_2 == (undefined8 *)0x0)) {
    if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
       (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x20,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_GetCurrentUserIdentityInfo",0x4e2,0,(undefined *)L"Arg error");
    uVar2 = 0x80004003;
  }
  else {
    if (*(longlong *)(param_1 + 0x38) == 0) {
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x21,&DAT_180072bc8);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"_GetCurrentUserIdentityInfo",0x4ed,0,
                 (undefined *)L"Enginecontext NULL");
      uVar2 = 0x8009800f;
    }
    else {
      memset(local_238,0,0x208);
      uVar3 = FUN_18004bc30((longlong)local_238);
      uVar2 = (uint)uVar3;
      if (uVar2 != 0) {
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x22,&DAT_180072bc8,uVar2);
        }
        local_260 = uVar2;
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"_GetCurrentUserIdentityInfo",0x4f7,0,
                   (undefined *)L"GetCurrentUserName error, hr=0x%x");
        goto LAB_1800516bc;
      }
      local_240 = (undefined8 *)0x0;
      local_248[0] = 0;
      uVar3 = FUN_18004bab0(local_238,(LPWSTR *)&local_240,local_248);
      uVar1 = local_248[0];
      if ((int)uVar3 == 0) {
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x23,&DAT_180072bc8);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"_GetCurrentUserIdentityInfo",0x501,0,
                   (undefined *)L"GetAccountSid error#################");
        goto LAB_1800516bc;
      }
      if (local_240 != (undefined8 *)0x0) {
        if (local_248[0] - 1 < 0x44) {
          *param_2 = 0;
          param_2[1] = 0;
          param_2[2] = 0;
          param_2[3] = 0;
          param_2[4] = 0;
          param_2[5] = 0;
          param_2[6] = 0;
          param_2[7] = 0;
          param_2[8] = 0;
          *(undefined4 *)(param_2 + 9) = 0;
          *(undefined4 *)param_2 = 3;
          *(uint *)((longlong)param_2 + 4) = local_248[0];
          memcpy_FUN_180061f90(param_2 + 1,local_240,(ulonglong)local_248[0]);
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
            FUN_180054930(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x24,&DAT_180072bc8,uVar1,0x44)
            ;
          }
          local_258 = 0x44;
          local_260 = uVar1;
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"_GetCurrentUserIdentityInfo",0x510,0,
                     (undefined *)L"sidlen=%u, SECURITY_MAX_SID_SIZE=%d");
        }
        else {
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
            FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x25,&DAT_180072bc8,
                          local_248[0]);
          }
          local_260 = uVar1;
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"_GetCurrentUserIdentityInfo",0x514,0,
                     (undefined *)L"Find sidlen error, =%u");
          uVar2 = 1;
        }
        FUN_1800501e0(local_240);
      }
    }
  }
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x26,&DAT_180072bc8,uVar2);
  }
  local_260 = uVar2;
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_GetCurrentUserIdentityInfo",0x51c,0,(undefined *)L"Exit, hr=0x%x");
LAB_1800516bc:
  FUN_18005f100(local_28 ^ (ulonglong)&stack0xfffffffffffffd68);
  return;
}



ulonglong FUN_1800516e0(HANDLE *param_1,LPVOID param_2)

{
  BOOL BVar1;
  DWORD DVar2;
  ulonglong uVar3;
  DWORD local_res8 [2];
  _OVERLAPPED local_38;

  uVar3 = 0;
  local_res8[0] = 0;
  local_38.Internal = 0;
  local_38.InternalHigh = 0;
  local_38.u = 0;
  local_38.hEvent = (HANDLE)0x0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x93,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_GetSensorID",0xb69,0,(undefined *)L"Entry");
  if (param_1 == (HANDLE *)0x0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x94,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_GetSensorID",0xb6d,0,(undefined *)L"Arg error");
    uVar3 = 0x80004003;
    goto LAB_180051901;
  }
  local_38.hEvent = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCWSTR)0x0);
  if (local_38.hEvent == (HANDLE)0x0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x95,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"_GetSensorID",0xb7a,0,(undefined *)L"Create Event NULL");
    uVar3 = 0x8007000e;
    goto LAB_180051901;
  }
  BVar1 = DeviceIoControl(*param_1,0x442008,(LPVOID)0x0,0,param_2,0x28,local_res8,
                          (LPOVERLAPPED)&local_38);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    if (DVar2 == 0x3e5) {
      SetLastError(0);
      BVar1 = GetOverlappedResult(*param_1,(LPOVERLAPPED)&local_38,local_res8,1);
      if (BVar1 != 0) goto LAB_1800518ef;
    }
  }
  else {
LAB_1800518ef:
    if (local_res8[0] == 0x28) goto LAB_180051901;
  }
  DVar2 = GetLastError();
  uVar3 = (ulonglong)DVar2;
LAB_180051901:
  if (local_38.hEvent != (HANDLE)0x0) {
    CloseHandle(local_38.hEvent);
  }
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x96,&DAT_180072bc8,(int)uVar3);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_GetSensorID",0xba0,0,(undefined *)L"Exit, hr=0x%x");
  return uVar3;
}



undefined8 _SaveCalitoWbioStorage_FUN_1800519a0(longlong param_1)

{
  longlong lVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined8 uVar4;
  HANDLE pvVar5;
  undefined4 *lpMem;
  uint uVar6;
  undefined8 uVar7;
  uint local_res8 [2];
  undefined4 uVar8;
  wchar_t *pwVar9;

  uVar7 = 0;
  local_res8[0] = 0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xee,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_SaveCalitoWbioStorage",0x119a,0,(undefined *)L"Entry");
  if (param_1 == 0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xef,&DAT_180072bc8);
    }
    uVar6 = 2;
    pwVar9 = L"Arg error";
    uVar8 = 0x119d;
  }
  else {
    lVar1 = *(longlong *)(param_1 + 0x38);
    if (lVar1 != 0) {
      uVar4 = preprocess_get_calidata_len();
      local_res8[0] = (uint)uVar4;
      uVar6 = local_res8[0] + 0x10;
      pvVar5 = GetProcessHeap();
      lpMem = (undefined4 *)HeapAlloc(pvVar5,8,(ulonglong)uVar6);
      if (lpMem == (undefined4 *)0x0) {
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xf1,&DAT_180072bc8,
                        local_res8[0] + 0x10 + *(int *)(lVar1 + 0x74));
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"_SaveCalitoWbioStorage",0x11b0,0,
                   (undefined *)L"Alloc memory error, len=%u");
        uVar7 = 0x8007000e;
      }
      else {
        uVar8 = *(undefined4 *)(lVar1 + 0x4d);
        uVar2 = *(undefined4 *)(lVar1 + 0x51);
        uVar3 = *(undefined4 *)(lVar1 + 0x55);
        *lpMem = *(undefined4 *)(lVar1 + 0x49);
        lpMem[1] = uVar8;
        lpMem[2] = uVar2;
        lpMem[3] = uVar3;
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xf2,&DAT_180072bc8);
        }
        uVar4 = preprocess_save_calidata(lpMem + 4,local_res8);
        if ((int)uVar4 == 0) {
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
            FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xf3,&DAT_180072bc8);
          }
          FUN_18003e670(L"C:\\ProgramData\\Goodix\\goodix_calib.dat",lpMem,
                        (ulonglong)(local_res8[0] + 0x10),L"wb");
        }
        pvVar5 = GetProcessHeap();
        HeapFree(pvVar5,8,lpMem);
      }
      goto LAB_180051c64;
    }
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xf0,&DAT_180072bc8);
    }
    uVar6 = 4;
    pwVar9 = L"Enginecontext NULL";
    uVar8 = 0x11a6;
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,uVar6,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_SaveCalitoWbioStorage",uVar8,0,(undefined *)pwVar9);
  uVar7 = 0x80004003;
LAB_180051c64:
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0xf4,&DAT_180072bc8,(int)uVar7);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"_SaveCalitoWbioStorage",0x11d1,0,(undefined *)L"Exit, hr=0x%x");
  return uVar7;
}



// WARNING: Could not reconcile some variable overlaps

void engine_adapter_accept_sample_data_ForTestr_FUN_180051cf0
               (longlong param_1,undefined8 *param_2,longlong *param_3,undefined8 param_4,
               longlong *param_5)

{
  longlong **pplVar1;
  ushort uVar2;
  ushort uVar3;
  longlong **pplVar4;
  LPVOID pvVar5;
  void **ppvVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  bool bVar9;
  undefined8 *lpMem;
  byte bVar10;
  byte bVar11;
  HANDLE pvVar12;
  undefined8 *lpMem_00;
  longlong *plVar13;
  longlong lVar14;
  ulonglong uVar15;
  char *pcVar16;
  char *pcVar17;
  int iVar18;
  undefined8 uVar19;
  longlong *plVar20;
  undefined8 uVar21;
  uint uVar22;
  undefined4 uVar23;
  wchar_t *pwVar24;
  undefined8 local_4e8;
  undefined8 local_4e0;
  int local_4d8;
  int local_4d0;
  undefined4 local_4c8;
  undefined4 local_4c0;
  byte local_4b8;
  undefined8 *local_4b0;
  short local_4a8 [2];
  short local_4a4 [2];
  longlong *local_4a0;
  undefined8 *local_498;
  int *local_490;
  undefined8 *local_488;
  undefined8 local_480;
  undefined8 local_478;
  undefined8 local_470;
  undefined8 local_468;
  undefined8 local_460;
  wchar_t local_458 [256];
  undefined8 local_258 [64];
  ulonglong local_58;

  local_58 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffad8;
  local_4a0 = param_5;
  local_4b8 = (byte)param_4;
  FUN_18003d660((longlong)"%s %d TEST-Entry","engine_adapter_accept_sample_data_ForTest",0x632,
                param_4);
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x35,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x634,0,
             (undefined *)L"TEST-Entry");
  uVar19 = 0;
  memset(local_458,0,0x200);
  local_488 = (undefined8 *)0x0;
  local_480 = 0;
  local_478 = 0;
  local_470 = 0;
  local_468 = 0;
  local_460 = 0;
  pvVar12 = GetProcessHeap();
  local_490 = (int *)HeapAlloc(pvVar12,8,4);
  uVar2 = *(ushort *)(&DAT_1800afd12 + (longlong)DAT_1800b17c8 * 0xe);
  uVar3 = *(ushort *)(&DAT_1800afd10 + (longlong)DAT_1800b17c8 * 0xe);
  pvVar12 = GetProcessHeap();
  local_498 = (undefined8 *)HeapAlloc(pvVar12,8,(longlong)(int)((uint)uVar2 * (uint)uVar3) * 2);
  uVar2 = *(ushort *)(&DAT_1800afd12 + (longlong)DAT_1800b17c8 * 0xe);
  uVar3 = *(ushort *)(&DAT_1800afd10 + (longlong)DAT_1800b17c8 * 0xe);
  pvVar12 = GetProcessHeap();
  lpMem_00 = (undefined8 *)HeapAlloc(pvVar12,8,(longlong)(int)((uint)uVar2 * (uint)uVar3) * 2);
  bVar10 = local_4b8;
  local_4b0 = lpMem_00;
  if ((lpMem_00 == (undefined8 *)0x0) || (local_498 == (undefined8 *)0x0)) {
    uVar21 = 0x8007000e;
    goto LAB_180052e4e;
  }
  local_470 = CONCAT62(local_470._2_6_,1);
  local_488 = local_498;
  local_480 = DAT_1800aff18;
  local_478 = CONCAT44((uint)*(ushort *)(&DAT_1800afd12 + (longlong)DAT_1800b17c8 * 0xe) *
                       (uint)*(ushort *)(&DAT_1800afd10 + (longlong)DAT_1800b17c8 * 0xe) * 2,
                       DAT_1800aff20);
  if (((param_1 == 0) || (param_2 == (undefined8 *)0x0)) || (param_5 == (longlong *)0x0)) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_1800554b0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x36,&DAT_180072bc8,param_1,
                    (char)param_2,(char)param_5);
    }
    local_4e0 = param_5;
    local_4e8 = param_2;
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x659,0,
               (undefined *)L"TEST-Arg error, Pipeline=0x%p, SampleBuffer=0x%p, RejectDetail=0x%p");
    uVar21 = 0x80004003;
    goto LAB_180052e4e;
  }
  pplVar4 = *(longlong ***)(param_1 + 0x38);
  if ((param_3 == (longlong *)0x0) || (local_4b8 == 0)) {
    FUN_18003d660((longlong)"%s %d TEST-Arg error, SampleSize=%u, Purpose=%u",
                  "engine_adapter_accept_sample_data_ForTest",0x669,param_3);
    if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
       (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
      FUN_1800553c0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x37,&DAT_180072bc8,param_3,bVar10);
    }
    local_4e8 = (undefined8 *)CONCAT44(local_4e8._4_4_,(uint)bVar10);
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x66b,0,
               (undefined *)L"TEST-Arg error, SampleSize=%lld, Purpose=%u");
    uVar21 = 0x80070057;
    lpMem_00 = local_4b0;
    goto LAB_180052e4e;
  }
  if (*(int *)((longlong)param_2 + 0xc) != 0) {
    if ((*(ushort *)(param_2 + 9) != 0x1b) || (*(short *)((longlong)param_2 + 0x4a) != 0x401)) {
      if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
         (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (1 < (byte)PTR_LOOP_1800aff38[0x19])))) {
        FUN_180054880(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x38,&DAT_180072bc8,
                      (uint)*(ushort *)(param_2 + 9),(char)*(undefined2 *)((longlong)param_2 + 0x4a)
                     );
      }
      local_4e8 = (undefined8 *)
                  ((ulonglong)local_4e8 & 0xffffffff00000000 |
                  (ulonglong)*(ushort *)((longlong)param_2 + 0x4a));
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x676,0,
                 (undefined *)L"TEST-Arg error, Owner=%u, Type=%u");
      uVar21 = 0x80070057;
      lpMem_00 = local_4b0;
      goto LAB_180052e4e;
    }
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x39,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x67b,0,
               (undefined *)L"TEST-BirHeader check pass");
  }
  if ((LPVOID *)*pplVar4 != (LPVOID *)0x0) {
    pvVar5 = (LPVOID)**pplVar4;
    if (pvVar5 != (LPVOID)0x0) {
      FUN_1800501e0(pvVar5);
      **pplVar4 = 0;
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x3a,&DAT_180072bc8);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x686,0,
                 (undefined *)L"TEST-FeatureSet image buf released");
    }
    FUN_1800501e0(*pplVar4);
    *pplVar4 = (longlong *)0x0;
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x3b,&DAT_180072bc8);
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x68c,0,
               (undefined *)L"TEST-FeatureSet released");
  }
  pvVar12 = GetProcessHeap();
  plVar13 = (longlong *)HeapAlloc(pvVar12,8,0x48);
  *pplVar4 = plVar13;
  if (plVar13 == (longlong *)0x0) {
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x3c,&DAT_180072bc8);
    }
    pwVar24 = L"Alloc memory for FeatureSet fail";
    uVar23 = 0x692;
LAB_1800521ad:
    uVar22 = 2;
  }
  else {
    lVar14 = FUN_18004cea0((longlong)
                           (int)((uint)*(ushort *)(&DAT_1800afd12 + (longlong)DAT_1800b17c8 * 0xe) *
                                (uint)*(ushort *)(&DAT_1800afd10 + (longlong)DAT_1800b17c8 * 0xe)));
    **pplVar4 = lVar14;
    plVar13 = *pplVar4;
    if (*plVar13 == 0) {
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x3d,&DAT_180072bc8);
      }
      pwVar24 = L"TEST-Alloc memory for FeatureSet image buf fail";
      uVar23 = 0x69a;
      goto LAB_1800521ad;
    }
    plVar13[1] = DAT_1800aff28;
    *(undefined4 *)(plVar13 + 2) = DAT_1800aff30;
    *(undefined2 *)(*pplVar4 + 3) = 1;
    *(uint *)((longlong)*pplVar4 + 0x14) =
         (uint)*(ushort *)(&DAT_1800afd12 + (longlong)DAT_1800b17c8 * 0xe) *
         (uint)*(ushort *)(&DAT_1800afd10 + (longlong)DAT_1800b17c8 * 0xe);
    iVar18 = *(int *)(pplVar4 + 0x25);
    if (((iVar18 - 3U & 0xfffffffc) == 0) && (iVar18 != 5)) {
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x3e,&DAT_180072bc8,iVar18);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x6a8,0,
                 (undefined *)L"Not real capture finger print, not init preprocessor,type:%d");
    }
    else {
      if (pplVar4[7] != (longlong *)0x0) {
        FUN_1800501e0(pplVar4[7]);
        pplVar4[7] = (longlong *)0x0;
        pplVar4[8] = (longlong *)0x0;
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x3f,&DAT_180072bc8);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x6b2,0,
                   (undefined *)L"old sample data released");
      }
      plVar13 = (longlong *)FUN_18004cea0((SIZE_T)param_3);
      pplVar4[7] = plVar13;
      if (plVar13 == (longlong *)0x0) {
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x40,&DAT_180072bc8);
        }
        pwVar24 = L"Alloc memory for sample data fail";
        uVar23 = 0x6b8;
        goto LAB_1800521ad;
      }
      FUN_18003d660((longlong)"%s %d copy data to context->samplebuffer, SampleSize=%u",
                    "engine_adapter_accept_sample_data_ForTest",0x6bd,param_3);
      memcpy_FUN_180061f90(pplVar4[7],param_2,(ulonglong)param_3);
      pplVar4[8] = param_3;
      lVar14 = (ulonglong)*(uint *)((longlong)param_2 + 0xc) + (longlong)param_2;
      bVar10 = *(byte *)(lVar14 + 0x22);
      bVar11 = *(byte *)(lVar14 + 0x38);
      uVar2 = *(ushort *)(lVar14 + 0x2e);
      uVar3 = *(ushort *)(lVar14 + 0x2c);
      *(uint *)((longlong)pplVar4 + 0x8c) = (uint)bVar11;
      uVar22 = (uint)(byte)(((bVar10 & 7) != 0) + (bVar10 >> 3)) * (uint)uVar2 * (uint)uVar3;
      memcpy_FUN_180061f90(local_498,(undefined8 *)(lVar14 + 0x39),(ulonglong)uVar22);
      lpMem_00 = local_4b0;
      memcpy_FUN_180061f90(local_4b0,(undefined8 *)(lVar14 + 0x7630),(ulonglong)uVar22);
      local_470 = local_470 & 0xffffffff | (ulonglong)*(uint *)(pplVar4 + 0xa7) << 0x20;
      *(undefined4 *)((longlong)*pplVar4 + 0x1c) = *(undefined4 *)(pplVar4 + 0xa7);
      if (((*(char *)(pplVar4 + 0xe) == '\0') || (param_5 = local_4a0, bVar11 == 1)) &&
         (_AdapterInitPreprocessor_FUN_18004f8d0(param_1,lpMem_00,uVar22), param_5 = local_4a0,
         *(char *)(pplVar4 + 0xe) == '\0')) {
        *(uint *)local_4a0 = (uint)*(byte *)(pplVar4 + 0x22);
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x41,&DAT_180072bc8);
        }
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x6ec,0,
                   (undefined *)L"_AdapterInitPreprocessor failed!!!");
        uVar21 = 0x80098008;
        goto LAB_180052e4e;
      }
    }
    uVar21 = 0;
    uVar22 = *(uint *)(pplVar4 + 0x25);
    pwVar24 = (wchar_t *)(ulonglong)uVar22;
    if (((uVar22 - 3 & 0xfffffffc) == 0) && (uVar22 != 5)) {
      FUN_18003d660((longlong)
                    "%s %d TEST-NOT_CAPTURE, TEST-get finger data from file : FARFRR type:%d",
                    "engine_adapter_accept_sample_data_ForTest",0x6f7,pwVar24);
      if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
         (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (4 < (byte)PTR_LOOP_1800aff38[0x19])))) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x42,&DAT_180072bc8);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x6f9,0,
                 (undefined *)L"TEST-NOT_CAPTURE, TEST-get finger data from file");
      if (*(char *)((longlong)pplVar4 + 0x12e) < '\0') {
        memset(local_258,0,0x200);
        FUN_18003e1a0((longlong)local_458,0xff,(longlong)pplVar4 + 300,0x80,local_258,0xff);
        FUN_18003e430(local_458,local_488,local_478 >> 0x20,L"rb");
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054ef0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x43,&DAT_180072bc8,
                        (wchar_t *)local_258,(char)(local_478 >> 0x20));
        }
        local_4e8 = (undefined8 *)CONCAT44(local_4e8._4_4_,local_478._4_4_);
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x701,0,
                   (undefined *)L"TEST-read from SRC:%S, size:%d");
      }
      if ((*(byte *)((longlong)pplVar4 + 0x12e) & 0x40) != 0) {
        memset(local_258,0,0x200);
        FUN_18003e1a0((longlong)local_458,0xff,(longlong)pplVar4 + 300,0x40,local_258,0xff);
        ppvVar6 = (void **)*pplVar4;
        local_4a4[0] = 0;
        local_4a8[0] = 0;
        FUN_18003e4b0(local_458,*ppvVar6,*(uint *)((longlong)ppvVar6 + 0x14),ppvVar6 + 6,8,local_4a4
                      ,local_4a8,L"rb");
        FUN_18003d660((longlong)

                      "%s %d TEST-read from BMP, size:%u, imageWidth=%d, imageHeight=%d, quality:%u - coverage:%u"
                      ,"engine_adapter_accept_sample_data_ForTest",0x70e,
                      (ulonglong)*(uint *)((longlong)*pplVar4 + 0x14));
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
          plVar13 = *pplVar4;
          FUN_180054a50(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x45,&DAT_180072bc8,
                        *(undefined4 *)((longlong)plVar13 + 0x14),(char)local_4a4[0],
                        (char)local_4a8[0],(char)*(undefined4 *)((longlong)plVar13 + 0x34),
                        (char)*(undefined4 *)(plVar13 + 6));
        }
        local_4d0 = *(int *)(*pplVar4 + 6);
        local_4d8 = *(int *)((longlong)*pplVar4 + 0x34);
        local_4e0 = (longlong *)CONCAT44(local_4e0._4_4_,(int)local_4a8[0]);
        local_4e8 = (undefined8 *)
                    ((ulonglong)local_4e8 & 0xffffffff00000000 | (ulonglong)(uint)(int)local_4a4[0])
        ;
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x713,0,
                   (undefined *)

                   L"TEST-read from BMP, size:%u, imageWidth=%d, imageHeight=%d, quality:%u - coverage:%u"
                  );
        FUN_18003d660((longlong)"%s %d TEST-read from BMP:%S %S",
                      "engine_adapter_accept_sample_data_ForTest",0x715,local_458);
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054cf0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x46,&DAT_180072bc8,local_458,
                        (wchar_t *)local_258);
        }
        local_4e8 = local_258;
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x717,0,
                   (undefined *)L"TEST-read from BMP:%S %S");
        *(undefined *)(*pplVar4 + 5) = *(undefined *)((longlong)*pplVar4 + 0x34);
        *(undefined *)((longlong)*pplVar4 + 0x29) = *(undefined *)(*pplVar4 + 6);
        *(undefined2 *)param_5 = *(undefined2 *)((longlong)*pplVar4 + 0x34);
        *(undefined2 *)((longlong)param_5 + 2) = *(undefined2 *)(*pplVar4 + 6);
        if (pplVar4[7] != (longlong *)0x0) {
          FUN_1800501e0(pplVar4[7]);
          pplVar4[7] = (longlong *)0x0;
          pplVar4[8] = (longlong *)0x0;
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
            FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x48,&DAT_180072bc8);
          }
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x72b,0,
                     (undefined *)L"TEST-Last samplebuffer released");
        }
        plVar13 = (longlong *)FUN_18004cea0((ulonglong)*(uint *)((longlong)*pplVar4 + 0x14) + 4);
        pplVar4[7] = plVar13;
        if (plVar13 == (longlong *)0x0) {
          pplVar4[8] = (longlong *)0x0;
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
            FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x49,&DAT_180072bc8);
          }
          pwVar24 = L"TEST-Alloc memory for sample data fail";
          uVar23 = 0x732;
          goto LAB_1800521ad;
        }
        *(undefined2 *)plVar13 = *(undefined2 *)(*pplVar4 + 1);
        *(undefined2 *)((longlong)pplVar4[7] + 2) = *(undefined2 *)((longlong)*pplVar4 + 10);
        memcpy_FUN_180061f90
                  ((undefined8 *)((longlong)pplVar4[7] + 4),(undefined8 *)**pplVar4,
                   (ulonglong)*(uint *)((longlong)*pplVar4 + 0x14));
        pplVar4[8] = (longlong *)((ulonglong)*(uint *)((longlong)*pplVar4 + 0x14) + 4);
        FUN_18003d660((longlong)

                      "%s %d TEST-Copy bmp data for raw data capture test, width=%d, height=%d, samplesize=%u"
                      ,"engine_adapter_accept_sample_data_ForTest",0x73a,
                      (ulonglong)(uint)(int)*(short *)(*pplVar4 + 1));
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180055290(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x4a,&DAT_180072bc8,
                        (int)*(short *)(*pplVar4 + 1),(char)*(undefined2 *)((longlong)*pplVar4 + 10)
                        ,(char)pplVar4[8]);
        }
        local_4e0 = pplVar4[8];
        local_4e8 = (undefined8 *)
                    ((ulonglong)local_4e8 & 0xffffffff00000000 |
                    (ulonglong)(uint)(int)*(short *)((longlong)*pplVar4 + 10));
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x73c,0,
                   (undefined *)

                   L"TEST-Copy bmp data for raw data capture test, width=%d, height=%d, samplesize=%lld"
                  );
      }
      pwVar24 = (wchar_t *)(ulonglong)*(uint *)(pplVar4 + 0x25);
      if (1 < *(uint *)(pplVar4 + 0x25) - 3) {
LAB_180052d8d:
        if ((*(byte *)((longlong)pplVar4 + 0x12e) & 0x40) != 0) {
          FUN_18003d660((longlong)
                        "%s %d TEST-Got BMP data, return rignt away. quality:%u - coverage:%u",
                        "engine_adapter_accept_sample_data_ForTest",0x759,
                        (ulonglong)*(uint *)((longlong)*pplVar4 + 0x34));
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
            FUN_180054880(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x4e,&DAT_180072bc8,
                          *(undefined4 *)((longlong)*pplVar4 + 0x34),
                          (char)*(undefined4 *)(*pplVar4 + 6));
          }
          local_4e8 = (undefined8 *)
                      ((ulonglong)local_4e8 & 0xffffffff00000000 |
                      (ulonglong)*(uint *)(*pplVar4 + 6));
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x75b,0,
                     (undefined *)L"TEST-Got BMP data, return rignt away. quality:%u - coverage:%u")
          ;
          lpMem_00 = local_4b0;
          goto LAB_180052e4e;
        }
        goto LAB_180052f39;
      }
      FUN_18003d660((longlong)
                    "%s %d TEST-NOT_CAPTURE, control type=%u, current file num: %d and temp num:%d",
                    "engine_adapter_accept_sample_data_ForTest",0x742,pwVar24);
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x4b,&DAT_180072bc8,
                      *(undefined4 *)(pplVar4 + 0x25));
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x744,0,
                 (undefined *)L"TEST-NOT_CAPTURE, control type=%u");
      if ((*(int *)(pplVar4 + 0x25) != 3) ||
         (*(byte *)((longlong)pplVar4 + 0x131) <= *(byte *)((longlong)pplVar4 + 0x12d))) {
        bVar10 = *(char *)((longlong)pplVar4 + 0x131) + 1;
        *(byte *)((longlong)pplVar4 + 0x131) = bVar10;
        if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
           (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (4 < (byte)PTR_LOOP_1800aff38[0x19])))) {
          FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x4d,&DAT_180072bc8,(uint)bVar10)
          ;
        }
        pwVar24 = L"engine_adapter_accept_sample_data_ForTest";
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x752,0,
                   (undefined *)L"TEST-file_no++, file_no=%u");
        goto LAB_180052d8d;
      }
      FUN_18003d660((longlong)"%s %d TEST-NOT_CAPTURE, control type=%u, file num grows to %d (>%d)",
                    "engine_adapter_accept_sample_data_ForTest",0x748,3);
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_1800550f0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x4c,&DAT_180072bc8,
                      (uint)*(byte *)((longlong)pplVar4 + 0x131),
                      *(undefined *)((longlong)pplVar4 + 0x12d));
      }
      local_4e8 = (undefined8 *)
                  ((ulonglong)local_4e8 & 0xffffffff00000000 |
                  (ulonglong)*(byte *)((longlong)pplVar4 + 0x12d));
      pwVar24 = L"TEST-ERROR, file num grows to %d (>%d)";
      uVar23 = 0x74a;
LAB_180052ce0:
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"engine_adapter_accept_sample_data_ForTest",uVar23,0,
                 (undefined *)pwVar24);
      lpMem_00 = local_4b0;
      uVar21 = 1;
      goto LAB_180052e4e;
    }
LAB_180052f39:
    if (*(char *)((longlong)pplVar4 + 0x53c) == '\x04') {
      if (*(int *)(pplVar4 + 0xae) == 0) {
        if (*(byte *)(pplVar4 + 0xd7) < *(byte *)((longlong)pplVar4 + 0x574)) {
          memcpy_FUN_180061f90(pplVar4[0xd9],local_488,(ulonglong)local_478._4_4_);
          uVar19 = 0x769;
          pplVar4[0xd9] = (longlong *)((longlong)pplVar4[0xd9] + (local_478 >> 0x20));
          bVar10 = *(char *)(pplVar4 + 0xd7) + 1;
          pcVar17 = "%s %d ENUM_TEST_DeadPixelTest_STAGE_Base: got base frame: %d, data_len=%p";
          *(byte *)(pplVar4 + 0xd7) = bVar10;
LAB_180053031:
          pwVar24 = (wchar_t *)(ulonglong)bVar10;
          FUN_18003d660((longlong)pcVar17,"engine_adapter_accept_sample_data_ForTest",uVar19,pwVar24
                       );
        }
      }
      else {
        if (*(int *)(pplVar4 + 0xae) == 2) {
          bVar10 = *(byte *)((longlong)pplVar4 + 0x575);
          if (*(byte *)(pplVar4 + 0xd7) < bVar10) {
            bVar11 = *(byte *)(pplVar4 + 0xd7) + 1;
            *(byte *)(pplVar4 + 0xd7) = bVar11;
            if ((*(byte *)((longlong)pplVar4 + 0x576) < bVar10) &&
               ((int)((uint)bVar10 - (uint)*(byte *)((longlong)pplVar4 + 0x576)) < (int)(uint)bVar11
               )) {
              memcpy_FUN_180061f90(pplVar4[0xdb],local_488,(ulonglong)local_478._4_4_);
              pcVar17 =
              "%s %d ENUM_TEST_DeadPixelTest_STAGE_ImageFDTdown: got frame: %d, data_len=%p";
              pplVar4[0xdb] = (longlong *)((longlong)pplVar4[0xdb] + (local_478 >> 0x20));
              uVar19 = 0x774;
              bVar10 = *(byte *)(pplVar4 + 0xd7);
              goto LAB_180053031;
            }
          }
        }
      }
      FUN_18003d660((longlong)"%s %d exit for ENUM_TEST_WHOLE_TEST_TYPE_DEAD_PIXEL",
                    "engine_adapter_accept_sample_data_ForTest",0x778,pwVar24);
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x4f,&DAT_180072bc8);
      }
      pwVar24 = L"exit for ENUM_TEST_WHOLE_TEST_TYPE_DEAD_PIXEL";
      uVar23 = 0x77a;
LAB_18005309c:
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"engine_adapter_accept_sample_data_ForTest",uVar23,0,
                 (undefined *)pwVar24);
      lpMem_00 = local_4b0;
      goto LAB_180052e4e;
    }
    if (*(char *)((longlong)pplVar4 + 0x53c) == '\x03') {
      if (*(int *)(pplVar4 + 0xac) == 0) {
        memcpy_FUN_180061f90(pplVar4[0xdc],local_488,(ulonglong)local_478._4_4_);
        uVar19 = 0x783;
        pcVar17 = "%s %d ENUM_TEST_PixelOpenShort_STAGE_BeforeDACChange got base frame";
LAB_18005311b:
        FUN_18003d660((longlong)pcVar17,"engine_adapter_accept_sample_data_ForTest",uVar19,pwVar24);
      }
      else {
        if (*(int *)(pplVar4 + 0xac) == 2) {
          memcpy_FUN_180061f90(pplVar4[0xdd],local_488,(ulonglong)local_478._4_4_);
          uVar19 = 0x788;
          pcVar17 = "%s %d ENUM_TEST_PixelOpenShort_STAGE_AfterDACChange got base frame";
          goto LAB_18005311b;
        }
      }
      FUN_18003d660((longlong)"%s %d exit for ENUM_TEST_WHOLE_TEST_TYPE_PIXEL_OPEN_SHORT",
                    "engine_adapter_accept_sample_data_ForTest",0x78b,pwVar24);
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x50,&DAT_180072bc8);
      }
      pwVar24 = L"exit for ENUM_TEST_WHOLE_TEST_TYPE_PIXEL_OPEN_SHORT";
      uVar23 = 0x78d;
      goto LAB_18005309c;
    }
    *local_490 = 0;
    uVar15 = preprocessor(&local_488,local_490,*pplVar4,(undefined *)(*pplVar4 + 6));
    FUN_18003d660((longlong)"%s %d after preprocessor(): quality: %d, coverage: %d",
                  "engine_adapter_accept_sample_data_ForTest",0x79f,
                  (ulonglong)*(uint *)((longlong)*pplVar4 + 0x34));
    if (pplVar4[7] != (longlong *)0x0) {
      FUN_1800501e0(pplVar4[7]);
      pplVar4[7] = (longlong *)0x0;
      pplVar4[8] = (longlong *)0x0;
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x51,&DAT_180072bc8);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x7b1,0,
                 (undefined *)L"TEST-Last samplebuffer released");
    }
    plVar13 = (longlong *)FUN_18004cea0((ulonglong)*(uint *)((longlong)*pplVar4 + 0x14) + 4);
    pplVar4[7] = plVar13;
    if (plVar13 == (longlong *)0x0) {
      pplVar4[8] = (longlong *)0x0;
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x52,&DAT_180072bc8);
      }
      pwVar24 = L"TEST-Alloc memory for sample data fail";
      uVar23 = 0x7b8;
      goto LAB_1800521ad;
    }
    *(undefined2 *)plVar13 = *(undefined2 *)(*pplVar4 + 1);
    *(undefined2 *)((longlong)pplVar4[7] + 2) = *(undefined2 *)((longlong)*pplVar4 + 10);
    memcpy_FUN_180061f90
              ((undefined8 *)((longlong)pplVar4[7] + 4),(undefined8 *)**pplVar4,
               (ulonglong)*(uint *)((longlong)*pplVar4 + 0x14));
    plVar13 = *pplVar4;
    plVar20 = (longlong *)((ulonglong)*(uint *)((longlong)plVar13 + 0x14) + 4);
    pplVar4[8] = plVar20;
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180055290(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x53,&DAT_180072bc8,
                    (int)*(short *)(plVar13 + 1),(char)*(undefined2 *)((longlong)plVar13 + 10),
                    (char)plVar20);
    }
    pwVar24 = L"engine_adapter_accept_sample_data_ForTest";
    local_4e0 = pplVar4[8];
    local_4e8 = (undefined8 *)
                ((ulonglong)local_4e8 & 0xffffffff00000000 |
                (ulonglong)(uint)(int)*(short *)((longlong)*pplVar4 + 10));
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x7c1,0,
               (undefined *)
               L"TEST-Copy bmp data for raw data capture test, width=%d, height=%d, samplesize=%lld"
              );
    bVar9 = false;
    if (((*(int *)(pplVar4 + 0x25) - 1U & 0xfffffffa) == 0) &&
       (bVar9 = false, *(int *)(pplVar4 + 0x25) != 6)) {
      bVar9 = true;
      FUN_18003d660((longlong)"%s %d TEST-SAVETOFILE","engine_adapter_accept_sample_data_ForTest",
                    0x7c9,pwVar24);
      if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
         (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x54,&DAT_180072bc8);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x7cb,0,
                 (undefined *)L"TEST-SAVETOFILE");
    }
    bVar10 = local_4b8;
    *(undefined2 *)param_5 = *(undefined2 *)((longlong)*pplVar4 + 0x34);
    *(undefined2 *)((longlong)param_5 + 2) = *(undefined2 *)(*pplVar4 + 6);
    iVar18 = (int)(uVar15 & 0xffffffff);
    if (iVar18 != 0) {
      FUN_18003d660((longlong)"%s %d TEST-preprocessor fail, ret=0x%.2x",
                    "engine_adapter_accept_sample_data_ForTest",0x7d4,uVar15 & 0xffffffff);
      pcVar17 = " liveness";
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
        pcVar16 = " liveness";
        if (iVar18 == 0x84) {
          pcVar16 = "no liveness";
        }
        FUN_180054b30(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x55,&DAT_180072bc8,iVar18,pcVar16)
        ;
      }
      if (iVar18 == 0x84) {
        pcVar17 = "no liveness";
      }
      local_4e8 = (undefined8 *)pcVar17;
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x7d8,0,
                 (undefined *)L"TEST-preprocessor fail, ret=0x%.2x %S");
      lpMem_00 = local_4b0;
      uVar21 = 0x80098008;
      goto LAB_180052e4e;
    }
    uVar22 = (uint)local_4b8;
    FUN_18003d660((longlong)"%s %d TEST-preprocessor success, Purpose=%u, quality=%u, coverage=%u",
                  "engine_adapter_accept_sample_data_ForTest",0x7e0,(ulonglong)uVar22);
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_1800548d0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x56,&DAT_180072bc8,uVar22,
                    (char)*(undefined4 *)((longlong)*pplVar4 + 0x34),
                    (char)*(undefined4 *)(*pplVar4 + 6));
    }
    local_4e0 = (longlong *)
                ((ulonglong)local_4e0 & 0xffffffff00000000 | (ulonglong)*(uint *)(*pplVar4 + 6));
    local_4e8 = (undefined8 *)
                ((ulonglong)local_4e8 & 0xffffffff00000000 |
                (ulonglong)*(uint *)((longlong)*pplVar4 + 0x34));
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x7e2,0,
               (undefined *)L"TEST-preprocessor success, Purpose=%u, quality=%u, coverage=%u");
    if (bVar10 == 4) {
      if ((*(char *)((longlong)pplVar4 + 0x53c) == '\x05') && (*(int *)(pplVar4 + 0xab) == 0)) {
        FUN_18003d660((longlong)"%s %d not to check the quality for enroll: %d, coverage: %d",
                      "engine_adapter_accept_sample_data_ForTest",0x7e8,
                      (ulonglong)*(uint *)((longlong)*pplVar4 + 0x34));
        goto LAB_180053caa;
      }
      FUN_18003d660((longlong)
                    "%s %d check finger image quality for enroll: quality: %d, coverage: %d",
                    "engine_adapter_accept_sample_data_ForTest",0x7ec,
                    (ulonglong)*(uint *)((longlong)*pplVar4 + 0x34));
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_1800550f0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x57,&DAT_180072bc8,
                      *(undefined4 *)((longlong)*pplVar4 + 0x34),(char)*(undefined4 *)(*pplVar4 + 6)
                     );
      }
      local_4e8 = (undefined8 *)
                  ((ulonglong)local_4e8 & 0xffffffff00000000 | (ulonglong)*(uint *)(*pplVar4 + 6));
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x7ee,0,
                 (undefined *)L"check finger image quality for enroll: %d, coverage: %d");
      uVar22 = *(uint *)(*pplVar4 + 6);
      if (uVar22 < 0x41) {
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x58,&DAT_180072bc8,uVar22);
        }
        pwVar24 = L"TEST-preprocessor success but bad coverage: %d";
        uVar23 = 0x7f3;
      }
      else {
        uVar22 = *(uint *)((longlong)*pplVar4 + 0x34);
        if (0x18 < uVar22) {
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
            FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x5a,&DAT_180072bc8);
          }
          uVar23 = 0x7ff;
          goto LAB_180053983;
        }
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054f70(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x59,&DAT_180072bc8,uVar22);
        }
        pwVar24 = L"TEST-preprocessor success but bad quality: %d";
        uVar23 = 0x7fb;
      }
      uVar19 = 0x80098008;
      uVar22 = 4;
LAB_18005375d:
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,uVar22,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"engine_adapter_accept_sample_data_ForTest",uVar23,0,
                 (undefined *)pwVar24);
      lpMem_00 = local_4b0;
      uVar21 = uVar19;
      goto LAB_180052e4e;
    }
    if (bVar10 == 0x80) {
      if ((*(char *)((longlong)pplVar4 + 0x53c) == '\x05') && (*(int *)(pplVar4 + 0xab) == 0)) {
        FUN_18003d660((longlong)"%s %d not to check the quality for audit: %d, coverage: %d",
                      "engine_adapter_accept_sample_data_ForTest",0x808,
                      (ulonglong)*(uint *)((longlong)*pplVar4 + 0x34));
      }
      else {
        FUN_18003d660((longlong)
                      "%s %d check finger image quality for enroll for audit: %d, coverage: %d",
                      "engine_adapter_accept_sample_data_ForTest",0x80c,
                      (ulonglong)*(uint *)((longlong)*pplVar4 + 0x34));
        if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
           (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (4 < (byte)PTR_LOOP_1800aff38[0x19])))) {
          FUN_1800550f0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x5b,&DAT_180072bc8,
                        *(undefined4 *)((longlong)*pplVar4 + 0x34),
                        (char)*(undefined4 *)(*pplVar4 + 6));
        }
        local_4e8 = (undefined8 *)
                    ((ulonglong)local_4e8 & 0xffffffff00000000 | (ulonglong)*(uint *)(*pplVar4 + 6))
        ;
        pwVar24 = L"check finger image quality for audit: %d, coverage: %d";
        uVar15 = 0;
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x80e,0,
                   (undefined *)L"check finger image quality for audit: %d, coverage: %d");
        if ((*(uint *)(*pplVar4 + 6) < 0x41) || (*(uint *)((longlong)*pplVar4 + 0x34) < 0x19)) {
          uVar21 = 0x80098008;
          if ((*(byte *)((longlong)pplVar4 + 0x12e) & 0x40) != 0) {
            FUN_18003e610(local_458,0xff,L"%s\\%s",pplVar4 + 0x67);
            ppvVar6 = (void **)*pplVar4;
            FUN_18003e6e0(local_458,*ppvVar6,*(uint *)((longlong)ppvVar6 + 0x14),ppvVar6 + 6,8,
                          uVar15 & 0xffffffffffff0000 | (ulonglong)*(ushort *)(ppvVar6 + 1),
                          (ulonglong)pwVar24 & 0xffffffffffff0000 |
                          (ulonglong)*(ushort *)((longlong)ppvVar6 + 10),L"wb+");
            if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
              plVar13 = *pplVar4;
              FUN_180054a50(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x5c,&DAT_180072bc8,
                            *(undefined4 *)((longlong)plVar13 + 0x14),
                            (char)*(undefined2 *)(plVar13 + 1),
                            (char)*(undefined2 *)((longlong)plVar13 + 10),
                            (char)*(undefined4 *)((longlong)plVar13 + 0x34),
                            (char)*(undefined4 *)(plVar13 + 6));
            }
            plVar13 = *pplVar4;
            local_4d0 = *(int *)(plVar13 + 6);
            local_4d8 = *(int *)((longlong)plVar13 + 0x34);
            local_4e0 = (longlong *)
                        ((ulonglong)local_4e0 & 0xffffffff00000000 |
                        (ulonglong)(uint)(int)*(short *)((longlong)plVar13 + 10));
            local_4e8 = (undefined8 *)
                        ((ulonglong)local_4e8 & 0xffffffff00000000 |
                        (ulonglong)(uint)(int)*(short *)(plVar13 + 1));
            debug_print_FUN_18003fc70
                      ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                       (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x819,0,
                       (undefined *)L"Capture invalid, size=%u, w=%d h=%d, q=%u c=%u");
            FUN_18003d660((longlong)"%s %d  Capture invalid, size=%u, w=%d h=%d, q=%u c=%u",
                          "engine_adapter_accept_sample_data_ForTest",0x81a,
                          (ulonglong)*(uint *)((longlong)*pplVar4 + 0x14));
            if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
                ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
              FUN_180054c90(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x5d,&DAT_180072bc8,local_458
                           );
            }
            debug_print_FUN_18003fc70
                      ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                       (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x81d,0,
                       (undefined *)L"Capture invalid, write to BMP:%S");
            FUN_18003d660((longlong)"%s %d  write to BMP:%S",
                          "engine_adapter_accept_sample_data_ForTest",0x81e,local_458);
          }
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
            FUN_180054880(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x5f,&DAT_180072bc8,
                          *(undefined4 *)((longlong)*pplVar4 + 0x34),
                          (char)*(undefined4 *)(*pplVar4 + 6));
          }
          local_4e8 = (undefined8 *)
                      ((ulonglong)local_4e8 & 0xffffffff00000000 |
                      (ulonglong)*(uint *)(*pplVar4 + 6));
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"EngineAdapter.cpp",
                     (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x826,0,
                     (undefined *)
                     L"TEST-Capture preprocessor success but bad quality=%u, coverage=%u");
          lpMem_00 = local_4b0;
          goto LAB_180052e4e;
        }
        if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
           (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (4 < (byte)PTR_LOOP_1800aff38[0x19])))) {
          FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x60,&DAT_180072bc8);
        }
        uVar23 = 0x82a;
LAB_180053983:
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"engine_adapter_accept_sample_data_ForTest",uVar23,0,
                   (undefined *)L"check finger image valid");
      }
    }
    else {
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x61,&DAT_180072bc8,uVar22);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x830,0,
                 (undefined *)L"TEST-Not Enrolling, Purpose=%u");
    }
LAB_180053caa:
    if ((*(char *)((longlong)pplVar4 + 0x53c) != '\x05') || (*(int *)(pplVar4 + 0xab) != 0)) {
LAB_180053f91:
      lpMem_00 = local_4b0;
      uVar21 = uVar19;
      if (!bVar9) goto LAB_180052e4e;
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x66,&DAT_180072bc8);
      }
      pwVar24 = L"TEST-write to file";
      uVar23 = 0;
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x860,0,
                 (undefined *)L"TEST-write to file");
      if (*(int *)(pplVar4 + 0x25) == 1) {
        bVar10 = *(byte *)((longlong)pplVar4 + 0x7d);
        *(byte *)((longlong)pplVar4 + 0x131) = bVar10;
        if (*(byte *)((longlong)pplVar4 + 0x12d) < bVar10) {
          FUN_18003d660((longlong)"%s %d ERROR: file num grows to %d (>%d)",
                        "engine_adapter_accept_sample_data_ForTest",0x867,(ulonglong)bVar10);
          if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
              ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
            FUN_1800550f0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x67,&DAT_180072bc8,
                          (uint)*(byte *)((longlong)pplVar4 + 0x131),
                          *(undefined *)((longlong)pplVar4 + 0x12d));
          }
          local_4e8 = (undefined8 *)
                      ((ulonglong)local_4e8 & 0xffffffff00000000 |
                      (ulonglong)*(byte *)((longlong)pplVar4 + 0x12d));
          pwVar24 = L"TEST-ERROR: file num grows to %d (>%d)";
          uVar23 = 0x869;
          goto LAB_180052ce0;
        }
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x68,&DAT_180072bc8,(uint)bVar10)
          ;
        }
        pwVar24 = L"TEST-file_no=%u";
        uVar23 = 0;
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x86e,0,
                   (undefined *)L"TEST-file_no=%u");
      }
      if (*(char *)((longlong)pplVar4 + 0x12e) < '\0') {
        memset(local_258,0,0x200);
        FUN_18003e1a0((longlong)local_458,0xff,(longlong)pplVar4 + 300,0x80,local_258,0xff);
        FUN_18003e670(local_458,local_488,local_478 >> 0x20,L"wb+");
        FUN_18003d660((longlong)"%s %d TEST-write to SRC: %S, capacity=%d",
                      "engine_adapter_accept_sample_data_ForTest",0x878,local_258);
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
          FUN_180054ef0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x69,&DAT_180072bc8,
                        (wchar_t *)local_258,(char)(local_478 >> 0x20));
        }
        local_4e8 = (undefined8 *)((ulonglong)local_4e8 & 0xffffffff00000000 | local_478 >> 0x20);
        pwVar24 = L"TEST-write to SRC:%S, capacity=%d";
        uVar23 = 0;
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x87a,0,
                   (undefined *)L"TEST-write to SRC:%S, capacity=%d");
      }
      if ((*(byte *)((longlong)pplVar4 + 0x12e) & 0x40) != 0) {
        memset(local_258,0,0x200);
        uVar15 = CONCAT44(uVar23,0xff);
        FUN_18003e1a0((longlong)local_458,0xff,(longlong)pplVar4 + 300,0x40,local_258,0xff);
        ppvVar6 = (void **)*pplVar4;
        FUN_18003e6e0(local_458,*ppvVar6,*(uint *)((longlong)ppvVar6 + 0x14),ppvVar6 + 6,8,
                      uVar15 & 0xffffffffffff0000 | (ulonglong)*(ushort *)(ppvVar6 + 1),
                      (ulonglong)pwVar24 & 0xffffffffffff0000 |
                      (ulonglong)*(ushort *)((longlong)ppvVar6 + 10),L"wb+");
        local_4e0 = (longlong *)
                    ((ulonglong)local_4e0 & 0xffffffff00000000 | (ulonglong)*(uint *)(*pplVar4 + 6))
        ;
        local_4e8 = (undefined8 *)
                    ((ulonglong)local_4e8 & 0xffffffff00000000 |
                    (ulonglong)*(uint *)((longlong)*pplVar4 + 0x34));
        FUN_18003d660((longlong)"%s %d TEST-write to BMP:%S, %S, size=%u, w=%d h=%d, q=%u c=%u",
                      "engine_adapter_accept_sample_data_ForTest",0x887,local_458);
        if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
            ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
          local_4e0 = (longlong *)
                      ((ulonglong)local_4e0 & 0xffffffff00000000 |
                      (ulonglong)*(uint *)(*pplVar4 + 6));
          local_4e8 = (undefined8 *)
                      ((ulonglong)local_4e8 & 0xffffffff00000000 |
                      (ulonglong)*(uint *)((longlong)*pplVar4 + 0x34));
          FUN_180054db0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x6b,&DAT_180072bc8,local_458,
                        (wchar_t *)local_258);
        }
        plVar13 = *pplVar4;
        local_4c0 = *(undefined4 *)(plVar13 + 6);
        local_4d0 = (int)*(short *)((longlong)plVar13 + 10);
        local_4d8 = (int)*(short *)(plVar13 + 1);
        local_4c8 = *(undefined4 *)((longlong)plVar13 + 0x34);
        local_4e0 = (longlong *)
                    ((ulonglong)local_4e0 & 0xffffffff00000000 |
                    (ulonglong)*(uint *)((longlong)plVar13 + 0x14));
        local_4e8 = local_258;
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,9,(undefined *)L"EngineAdapter.cpp",
                   (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x889,0,
                   (undefined *)

                   L"TEST-write to BMP:%S, %S, capacity=%u, width=%d - height=%d, quality:%u - coverage:%u"
                  );
      }
      lpMem_00 = local_4b0;
      uVar21 = 0;
      if (*(int *)(pplVar4 + 0x25) != 2) goto LAB_180052e4e;
      bVar10 = *(char *)((longlong)pplVar4 + 0x131) + 1;
      *(byte *)((longlong)pplVar4 + 0x131) = bVar10;
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x6d,&DAT_180072bc8,(uint)bVar10);
      }
      uVar22 = 9;
      pwVar24 = L"TEST-file_no++, file_no=%u";
      uVar23 = 0x899;
      goto LAB_18005375d;
    }
    uVar22 = *(uint *)((longlong)*pplVar4 + 0x34);
    *(uint *)((longlong)pplVar4 + 0x5dc) = uVar22;
    *(undefined4 *)(pplVar4 + 0xbc) = *(undefined4 *)(*pplVar4 + 6);
    FUN_18003d660((longlong)"%s %d ENUM_TEST_WHOLE_TEST_TYPE_PERFORMANCE- quality:%d, coverage:%d",
                  "engine_adapter_accept_sample_data_ForTest",0x837,(ulonglong)uVar22);
    if (((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
       (((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0 && (PTR_LOOP_1800aff38[0x19] != '\0')))) {
      FUN_1800550f0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x62,&DAT_180072bc8,
                    *(undefined4 *)((longlong)pplVar4 + 0x5dc),(char)*(undefined4 *)(pplVar4 + 0xbc)
                   );
    }
    local_4e8 = (undefined8 *)
                ((ulonglong)local_4e8 & 0xffffffff00000000 | (ulonglong)*(uint *)(pplVar4 + 0xbc));
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x83c,0,
               (undefined *)L" ENUM_TEST_WHOLE_TEST_TYPE_PERFORMANCE- quality:%d, coverage:%d");
    pplVar1 = pplVar4 + 0xca;
    if (*pplVar1 != (longlong *)0x0) {
      FUN_1800501e0(*pplVar1);
      *pplVar1 = (longlong *)0x0;
      pplVar4[0xcb] = (longlong *)0x0;
      pplVar4[0xcc] = (longlong *)0x0;
      pplVar4[0xcd] = (longlong *)0x0;
      pplVar4[0xce] = (longlong *)0x0;
      pplVar4[0xcf] = (longlong *)0x0;
      pplVar4[0xd0] = (longlong *)0x0;
      pplVar4[0xd1] = (longlong *)0x0;
      pplVar4[0xd2] = (longlong *)0x0;
    }
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (PTR_LOOP_1800aff38[0x19] != '\0')) {
      FUN_1800550f0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),99,&DAT_180072bc8,
                    *(undefined4 *)((longlong)*pplVar4 + 0x34),(char)*(undefined4 *)(*pplVar4 + 6));
    }
    local_4e8 = (undefined8 *)
                ((ulonglong)local_4e8 & 0xffffffff00000000 | (ulonglong)*(uint *)(*pplVar4 + 6));
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
               (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x846,0,
               (undefined *)L"PERFORMANCE kept the data, qualit:%d, coverage:%d");
    plVar13 = *pplVar4;
    uVar23 = *(undefined4 *)((longlong)plVar13 + 4);
    uVar7 = *(undefined4 *)(plVar13 + 1);
    uVar8 = *(undefined4 *)((longlong)plVar13 + 0xc);
    *(undefined4 *)pplVar1 = *(undefined4 *)plVar13;
    *(undefined4 *)((longlong)pplVar4 + 0x654) = uVar23;
    *(undefined4 *)(pplVar4 + 0xcb) = uVar7;
    *(undefined4 *)((longlong)pplVar4 + 0x65c) = uVar8;
    uVar23 = *(undefined4 *)((longlong)plVar13 + 0x14);
    uVar7 = *(undefined4 *)(plVar13 + 3);
    uVar8 = *(undefined4 *)((longlong)plVar13 + 0x1c);
    *(undefined4 *)(pplVar4 + 0xcc) = *(undefined4 *)(plVar13 + 2);
    *(undefined4 *)((longlong)pplVar4 + 0x664) = uVar23;
    *(undefined4 *)(pplVar4 + 0xcd) = uVar7;
    *(undefined4 *)((longlong)pplVar4 + 0x66c) = uVar8;
    uVar23 = *(undefined4 *)((longlong)plVar13 + 0x24);
    uVar7 = *(undefined4 *)(plVar13 + 5);
    uVar8 = *(undefined4 *)((longlong)plVar13 + 0x2c);
    *(undefined4 *)(pplVar4 + 0xce) = *(undefined4 *)(plVar13 + 4);
    *(undefined4 *)((longlong)pplVar4 + 0x674) = uVar23;
    *(undefined4 *)(pplVar4 + 0xcf) = uVar7;
    *(undefined4 *)((longlong)pplVar4 + 0x67c) = uVar8;
    uVar23 = *(undefined4 *)((longlong)plVar13 + 0x34);
    uVar7 = *(undefined4 *)(plVar13 + 7);
    uVar8 = *(undefined4 *)((longlong)plVar13 + 0x3c);
    *(undefined4 *)(pplVar4 + 0xd0) = *(undefined4 *)(plVar13 + 6);
    *(undefined4 *)((longlong)pplVar4 + 0x684) = uVar23;
    *(undefined4 *)(pplVar4 + 0xd1) = uVar7;
    *(undefined4 *)((longlong)pplVar4 + 0x68c) = uVar8;
    pplVar4[0xd2] = (longlong *)plVar13[8];
    plVar13 = (longlong *)FUN_18004cea0((ulonglong)*(uint *)((longlong)plVar13 + 0x14));
    *pplVar1 = plVar13;
    if (plVar13 != (longlong *)0x0) {
      memcpy_FUN_180061f90
                (plVar13,(undefined8 *)**pplVar4,(ulonglong)*(uint *)((longlong)*pplVar4 + 0x14));
      uVar15 = FUN_180050f50(*(uint *)((longlong)pplVar4 + 0x6c),pplVar1,pplVar4 + 0xd3,
                             *(char *)(pplVar4 + 0x24));
      *(int *)((longlong)pplVar4 + 0x5e4) = (int)uVar15;
      FUN_18003e3c0((int *)((longlong)pplVar4 + 0x5d4));
      if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
          ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
        FUN_180054bb0(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x65,&DAT_180072bc8,
                      *(undefined4 *)((longlong)pplVar4 + 0x5d4),
                      (char)*(undefined4 *)(pplVar4 + 0xbb));
      }
      local_4e8 = (undefined8 *)
                  ((ulonglong)local_4e8 & 0xffffffff00000000 | (ulonglong)*(uint *)(pplVar4 + 0xbb))
      ;
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x858,0,
                 (undefined *)L"update enrollment: -capture the end time:%lu.%lu");
      goto LAB_180053f91;
    }
    if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
        ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (1 < (byte)PTR_LOOP_1800aff38[0x19])) {
      FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),100,&DAT_180072bc8);
    }
    uVar22 = 4;
    pwVar24 = L"wrong to allocate memory for scenario test data";
    uVar23 = 0x84d;
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,uVar22,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"engine_adapter_accept_sample_data_ForTest",uVar23,0,(undefined *)pwVar24
            );
  lpMem_00 = local_4b0;
  uVar21 = 0x8007000e;
LAB_180052e4e:
  lpMem = local_498;
  if (local_498 != (undefined8 *)0x0) {
    pvVar12 = GetProcessHeap();
    HeapFree(pvVar12,8,lpMem);
  }
  if (lpMem_00 != (undefined8 *)0x0) {
    pvVar12 = GetProcessHeap();
    HeapFree(pvVar12,8,lpMem_00);
  }
  FUN_18003d660((longlong)"%s %d TEST-Exit, hr=0x%x","engine_adapter_accept_sample_data_ForTest",
                0x8ec,uVar21);
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054840(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x6f,&DAT_180072bc8,(int)uVar21);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,7,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"engine_adapter_accept_sample_data_ForTest",0x8ee,0,
             (undefined *)L"TEST-Exit, hr=0x%x");
  FUN_18005f100(local_58 ^ (ulonglong)&stack0xfffffffffffffad8);
  return;
}



void FUN_1800545f0(void)

{
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_180054600(undefined8 param_1,int param_2)

{
  undefined8 *puVar1;
  longlong *plVar2;
  longlong local_18;
  undefined8 local_10;

  if (param_2 == 1) {
    _DAT_1800b17f0 = 1;
    _DAT_1800b17e8 = 0;
    puVar1 = &DAT_1800b17d8;
    DAT_1800b17d8 = 0;
    DAT_1800b17d0 = &DAT_180072a70;
    plVar2 = (longlong *)&DAT_1800b17d0;
    PTR_LOOP_1800aff38 = (undefined **)&DAT_1800b17d8;
    do {
      local_18 = *plVar2;
      plVar2 = plVar2 + 1;
      local_10 = 0;
      puVar1[4] = local_18;
      RegisterTraceGuidsW(FUN_180055820,puVar1,local_18,1,&local_18,0,0,puVar1 + 1);
      puVar1 = (undefined8 *)*puVar1;
    } while (puVar1 != (undefined8 *)0x0);
  }
  else {
    if (param_2 == 0) {
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,6,(undefined *)L"EngineAdapter.cpp",
                 (undefined *)L"DllMain",0x3cb,0,(undefined *)L"process detach and debug_print_free"
                );
      if (PTR_DAT_1800afca8 != (undefined *)0x0) {
        FUN_18003fbd0(PTR_DAT_1800afca8);
      }
      puVar1 = PTR_LOOP_1800aff38;
      if (PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) {
        while (puVar1 != (undefined8 *)0x0) {
          if (puVar1[1] != 0) {
            UnregisterTraceGuids();
            puVar1[1] = 0;
          }
          puVar1 = (undefined8 *)*puVar1;
        }
        PTR_LOOP_1800aff38 = &PTR_LOOP_1800aff38;
      }
    }
  }
  return 1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180054760(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  char *pcVar1;
  ulonglong *puVar2;
  undefined2 *puVar3;
  undefined8 local_res10;
  undefined8 local_res18;
  undefined8 local_res20;
  undefined auStack1112 [32];
  undefined8 local_438;
  undefined local_430 [8];
  CHAR local_428 [1024];
  ulonglong local_28;

  local_28 = DAT_1800b04e8 ^ (ulonglong)auStack1112;
  local_res10 = param_2;
  local_res18 = param_3;
  local_res20 = param_4;
  if (_DAT_1800b1800 != 0) {
    local_430 = &local_res10;
    puVar2 = (ulonglong *)FUN_18003ded0();
    local_438 = 0;
    __stdio_common_vsprintf(*puVar2 | 1,local_428,0x3ff,param_1);
    puVar3 = (undefined2 *)(local_430 + 7);
    do {
      pcVar1 = (char *)((longlong)puVar3 + 1);
      puVar3 = (undefined2 *)((longlong)puVar3 + 1);
    } while (*pcVar1 != '\0');
    *puVar3 = 10;
    OutputDebugStringA(local_428);
  }
  FUN_18005f100(local_28 ^ (ulonglong)auStack1112);
  return;
}



void FUN_180054820(undefined8 param_1,ushort param_2,undefined8 param_3)

{
  TraceMessage(param_1,0x2b,param_3,param_2,0);
  return;
}



void FUN_180054840(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,0);
  return;
}



void FUN_180054880(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,0);
  return;
}



void FUN_1800548d0(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5,undefined param_6)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,&param_6,4,0);
  return;
}



void FUN_180054930(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,0);
  return;
}



void FUN_180054980(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5,undefined param_6,undefined param_7)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,&param_6,4,&param_7,4,0);
  return;
}



void FUN_1800549f0(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5,undefined param_6)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,&param_6,4,0);
  return;
}



void FUN_180054a50(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5,undefined param_6,undefined param_7,undefined param_8)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,&param_6,4,&param_7,4,&param_8,
               4,0);
  return;
}



void FUN_180054ad0(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5,undefined param_6)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,8,&param_6,4,0);
  return;
}



void FUN_180054b30(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined *param_5)

{
  longlong lVar1;
  longlong lVar2;
  undefined *puVar3;
  undefined4 local_res20 [2];

  if (param_5 == (undefined *)0x0) {
    lVar2 = 5;
  }
  else {
    lVar1 = -1;
    do {
      lVar2 = lVar1;
      lVar1 = lVar2 + 1;
    } while (param_5[lVar1] != '\0');
    lVar2 = lVar2 + 2;
  }
  puVar3 = &DAT_180072ed4;
  if (param_5 != (undefined *)0x0) {
    puVar3 = param_5;
  }
  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,puVar3,lVar2,0);
  return;
}



void FUN_180054bb0(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,0);
  return;
}



void FUN_180054c00(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5,undefined param_6,undefined param_7,undefined param_8,
                  undefined param_9)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,&param_6,4,&param_7,4,&param_8,
               4,&param_9,4,0);
  return;
}



void FUN_180054c90(undefined8 param_1,ushort param_2,undefined8 param_3,wchar_t *param_4)

{
  longlong lVar1;
  longlong lVar2;
  wchar_t *pwVar3;

  if (param_4 == (wchar_t *)0x0) {
    lVar2 = 5;
  }
  else {
    lVar1 = -1;
    do {
      lVar2 = lVar1;
      lVar1 = lVar2 + 1;
    } while (param_4[lVar1] != L'\0');
    lVar2 = lVar2 + 2;
  }
  pwVar3 = L"NULL";
  if (param_4 != (wchar_t *)0x0) {
    pwVar3 = param_4;
  }
  TraceMessage(param_1,0x2b,param_3,param_2,pwVar3,lVar2 * 2,0);
  return;
}



void FUN_180054cf0(undefined8 param_1,ushort param_2,undefined8 param_3,wchar_t *param_4,
                  wchar_t *param_5)

{
  longlong lVar1;
  wchar_t *pwVar2;
  longlong lVar3;
  longlong lVar4;
  wchar_t *pwVar5;

  if (param_5 == (wchar_t *)0x0) {
    lVar4 = 5;
  }
  else {
    lVar3 = -1;
    do {
      lVar4 = lVar3;
      lVar3 = lVar4 + 1;
    } while (param_5[lVar3] != L'\0');
    lVar4 = lVar4 + 2;
  }
  lVar3 = -1;
  if (param_4 == (wchar_t *)0x0) {
    lVar1 = 5;
  }
  else {
    do {
      lVar1 = lVar3;
      lVar3 = lVar1 + 1;
    } while (param_4[lVar3] != L'\0');
    lVar1 = lVar1 + 2;
  }
  pwVar2 = L"NULL";
  if (param_5 != (wchar_t *)0x0) {
    pwVar2 = param_5;
  }
  pwVar5 = L"NULL";
  if (param_4 != (wchar_t *)0x0) {
    pwVar5 = param_4;
  }
  TraceMessage(param_1,0x2b,param_3,param_2,pwVar5,lVar1 * 2,pwVar2,lVar4 * 2,0);
  return;
}



void FUN_180054db0(undefined8 param_1,ushort param_2,undefined8 param_3,wchar_t *param_4,
                  wchar_t *param_5)

{
  longlong lVar1;
  wchar_t *pwVar2;
  longlong lVar3;
  longlong lVar4;
  wchar_t *pwVar5;

  if (param_5 == (wchar_t *)0x0) {
    lVar4 = 5;
  }
  else {
    lVar3 = -1;
    do {
      lVar4 = lVar3;
      lVar3 = lVar4 + 1;
    } while (param_5[lVar3] != L'\0');
    lVar4 = lVar4 + 2;
  }
  lVar3 = -1;
  if (param_4 == (wchar_t *)0x0) {
    lVar1 = 5;
  }
  else {
    do {
      lVar1 = lVar3;
      lVar3 = lVar1 + 1;
    } while (param_4[lVar3] != L'\0');
    lVar1 = lVar1 + 2;
  }
  pwVar2 = L"NULL";
  if (param_5 != (wchar_t *)0x0) {
    pwVar2 = param_5;
  }
  pwVar5 = L"NULL";
  if (param_4 != (wchar_t *)0x0) {
    pwVar5 = param_4;
  }
  TraceMessage(param_1,0x2b,param_3,param_2,pwVar5,lVar1 * 2,pwVar2,lVar4 * 2,&stack0x00000030,4,
               &stack0x00000038,4,&stack0x00000040,4,&stack0x00000048,4,&stack0x00000050,4,0);
  return;
}



void FUN_180054ef0(undefined8 param_1,ushort param_2,undefined8 param_3,wchar_t *param_4,
                  undefined param_5)

{
  longlong lVar1;
  longlong lVar2;
  wchar_t *pwVar3;

  if (param_4 == (wchar_t *)0x0) {
    lVar2 = 5;
  }
  else {
    lVar1 = -1;
    do {
      lVar2 = lVar1;
      lVar1 = lVar2 + 1;
    } while (param_4[lVar1] != L'\0');
    lVar2 = lVar2 + 2;
  }
  pwVar3 = L"NULL";
  if (param_4 != (wchar_t *)0x0) {
    pwVar3 = param_4;
  }
  TraceMessage(param_1,0x2b,param_3,param_2,pwVar3,lVar2 * 2,&param_5,4,0);
  return;
}



void FUN_180054f70(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,0);
  return;
}



void FUN_180054fb0(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,0);
  return;
}



void FUN_180055000(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5,undefined param_6)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,&param_6,4,0);
  return;
}



void FUN_180055060(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5,undefined param_6,undefined param_7,undefined param_8,
                  undefined param_9)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,&param_6,4,&param_7,4,&param_8,
               4,&param_9,4,0);
  return;
}



void FUN_1800550f0(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,0);
  return;
}



void FUN_180055140(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5,undefined param_6)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,&param_6,4,0);
  return;
}



void FUN_1800551a0(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5,undefined param_6,undefined param_7)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,&param_6,4,&param_7,4,0);
  return;
}



void FUN_180055210(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5,undefined param_6,undefined param_7,undefined param_8)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,&param_6,4,&param_7,4,&param_8,
               4,0);
  return;
}



void FUN_180055290(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5,undefined param_6)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,&param_6,8,0);
  return;
}



void FUN_1800552f0(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5,undefined param_6,undefined param_7)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,&param_6,8,&param_7,8,0);
  return;
}



void FUN_180055360(undefined8 param_1,ushort param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5,undefined param_6)

{
  undefined4 local_res20 [2];

  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,8,&param_6,8,0);
  return;
}



void FUN_1800553c0(undefined8 param_1,ushort param_2,undefined8 param_3,undefined8 param_4,
                  undefined param_5)

{
  undefined8 local_res20;

  local_res20 = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,&local_res20,8,&param_5,4,0);
  return;
}



void FUN_180055410(undefined8 param_1,ushort param_2,undefined8 param_3,undefined8 param_4,
                  undefined param_5)

{
  undefined8 local_res20;

  local_res20 = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,&local_res20,8,&param_5,4,0);
  return;
}



void FUN_180055460(undefined8 param_1,ushort param_2,undefined8 param_3,undefined8 param_4,
                  undefined param_5)

{
  undefined8 local_res20;

  local_res20 = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,&local_res20,8,&param_5,8,0);
  return;
}



void FUN_1800554b0(undefined8 param_1,ushort param_2,undefined8 param_3,undefined8 param_4,
                  undefined param_5,undefined param_6)

{
  undefined8 local_res20;

  local_res20 = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,&local_res20,8,&param_5,8,&param_6,8,0);
  return;
}



void FUN_180055510(undefined8 param_1,ushort param_2,undefined8 param_3,undefined *param_4)

{
  longlong lVar1;
  longlong lVar2;
  undefined *puVar3;

  if (param_4 == (undefined *)0x0) {
    lVar2 = 5;
  }
  else {
    lVar1 = -1;
    do {
      lVar2 = lVar1;
      lVar1 = lVar2 + 1;
    } while (param_4[lVar1] != '\0');
    lVar2 = lVar2 + 2;
  }
  puVar3 = &DAT_180072ed4;
  if (param_4 != (undefined *)0x0) {
    puVar3 = param_4;
  }
  TraceMessage(param_1,0x2b,param_3,param_2,puVar3,lVar2,0);
  return;
}



void FUN_180055570(undefined8 param_1,ushort param_2,undefined8 param_3,undefined *param_4,
                  undefined param_5)

{
  longlong lVar1;
  longlong lVar2;
  undefined *puVar3;

  if (param_4 == (undefined *)0x0) {
    lVar2 = 5;
  }
  else {
    lVar1 = -1;
    do {
      lVar2 = lVar1;
      lVar1 = lVar2 + 1;
    } while (param_4[lVar1] != '\0');
    lVar2 = lVar2 + 2;
  }
  puVar3 = &DAT_180072ed4;
  if (param_4 != (undefined *)0x0) {
    puVar3 = param_4;
  }
  TraceMessage(param_1,0x2b,param_3,param_2,puVar3,lVar2,&param_5,4,0);
  return;
}



undefined8 WbioQueryEngineInterface(undefined8 *param_1)

{
                    // 0x55630  1  WbioQueryEngineInterface
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x16,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"WbioQueryEngineInterface",0x3e4,0,(undefined *)L"Entry");
  if (param_1 == (undefined8 *)0x0) {
    return 0x80004003;
  }
  *param_1 = &DAT_1800afdc0;
  if ((((undefined **)PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) &&
      ((PTR_LOOP_1800aff38[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800aff38[0x19])) {
    FUN_180054820(*(undefined8 *)(PTR_LOOP_1800aff38 + 0x10),0x17,&DAT_180072bc8);
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,2,(undefined *)L"EngineAdapter.cpp",
             (undefined *)L"WbioQueryEngineInterface",0x3eb,0,(undefined *)L"Exit");
  return 0;
}



undefined8 FUN_180055750(longlong param_1)

{
  code *UNRECOVERED_JUMPTABLE;
  undefined8 uVar1;

  if ((param_1 != 0) && (*(longlong *)(param_1 + 0x28) != 0)) {
    UNRECOVERED_JUMPTABLE = *(code **)(*(longlong *)(param_1 + 0x28) + 0x90);
    if (UNRECOVERED_JUMPTABLE == (code *)0x0) {
      return 0x80004001;
    }
                    // WARNING: Could not recover jumptable at 0x000180055770. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar1 = (*UNRECOVERED_JUMPTABLE)();
    return uVar1;
  }
  return 0x80004003;
}



undefined8 FUN_180055780(longlong param_1)

{
  code *UNRECOVERED_JUMPTABLE;
  undefined8 uVar1;

  if ((param_1 != 0) && (*(longlong *)(param_1 + 0x28) != 0)) {
    UNRECOVERED_JUMPTABLE = *(code **)(*(longlong *)(param_1 + 0x28) + 0x98);
    if (UNRECOVERED_JUMPTABLE == (code *)0x0) {
      return 0x80004001;
    }
                    // WARNING: Could not recover jumptable at 0x0001800557a0. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar1 = (*UNRECOVERED_JUMPTABLE)();
    return uVar1;
  }
  return 0x80004003;
}



void FUN_1800557b0(void)

{
  longlong *plVar1;

  if (PTR_LOOP_1800aff38 != &PTR_LOOP_1800aff38) {
    plVar1 = (longlong *)PTR_LOOP_1800aff38;
    if (PTR_LOOP_1800aff38 != (undefined **)0x0) {
      do {
        if (plVar1[1] != 0) {
          UnregisterTraceGuids();
          plVar1[1] = 0;
        }
        plVar1 = (longlong *)*plVar1;
      } while (plVar1 != (longlong *)0x0);
    }
    PTR_LOOP_1800aff38 = &PTR_LOOP_1800aff38;
  }
  return;
}



undefined8 FUN_180055820(int param_1,longlong param_2,undefined4 *param_3,undefined8 param_4)

{
  undefined uVar1;
  undefined4 uVar2;
  undefined8 uVar3;

  uVar3 = 0;
  *param_3 = 0;
  if (param_1 == 4) {
    uVar3 = GetTraceLoggerHandle(param_4);
    uVar1 = GetTraceEnableLevel(uVar3);
    uVar2 = GetTraceEnableFlags(uVar3);
  }
  else {
    if (param_1 != 5) {
      return 0x57;
    }
    uVar2 = 0;
    uVar1 = 0;
  }
  if (((*(byte *)(param_2 + 0x1a) & 2) != 0) && (*(longlong *)(param_2 + 0x10) != 0)) {
    param_2 = *(longlong *)(param_2 + 0x10);
  }
  *(undefined *)(param_2 + 0x19) = uVar1;
  *(undefined8 *)(param_2 + 0x10) = uVar3;
  *(undefined4 *)(param_2 + 0x1c) = uVar2;
  return 0;
}



void FUN_1800558b0(void)

{
  longlong *plVar1;
  longlong *plVar2;
  longlong local_18;
  undefined8 local_10;

  plVar2 = &DAT_1800b17d0;
  plVar1 = (longlong *)PTR_LOOP_1800aff38;
  if (PTR_LOOP_1800aff38 != (undefined *)0x0) {
    do {
      local_18 = *plVar2;
      plVar2 = plVar2 + 1;
      local_10 = 0;
      plVar1[4] = local_18;
      RegisterTraceGuidsW(FUN_180055820,plVar1,local_18,1,&local_18,0,0,plVar1 + 1);
      plVar1 = (longlong *)*plVar1;
    } while (plVar1 != (longlong *)0x0);
  }
  return;
}



ulonglong FUN_180055940(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  uint uVar1;
  ulonglong *puVar2;
  ulonglong uVar3;
  undefined8 local_res20;

  local_res20 = param_4;
  puVar2 = (ulonglong *)FUN_18003ded0();
  uVar1 = __stdio_common_vsprintf(*puVar2 | 2,param_1,param_2,param_3,0,&local_res20);
  uVar3 = (ulonglong)uVar1;
  if ((int)uVar1 < 0) {
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



undefined8 * FUN_1800559a0(undefined8 *param_1)

{
  int *piVar1;

  FUN_18005e1d0(param_1);
  *(undefined4 *)(param_1 + 1) = 0x38;
  *param_1 = EnterCaptureSampleChain::vftable;
  if (param_1 + 4 == (undefined8 *)0x0) {
    piVar1 = _errno();
    *piVar1 = 0x16;
    _invalid_parameter_noinfo();
  }
  else {
    param_1[4] = 0x650074006e0045;
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"EnterCaptureSampleChain.cpp",
             (undefined *)L"EnterCaptureSampleChain::EnterCaptureSampleChain",9,0,
             (undefined *)L"Engine test: EnterCaptureSample chain init");
  return param_1;
}



undefined8 FUN_180055a30(void)

{
  longlong in_R9;
  longlong in_stack_00000028;

  if (*(short *)(in_R9 + 4) == 1) {
    DAT_1800b04d0 = 0xffffffff;
  }
  *(undefined4 *)(in_stack_00000028 + 4) = 0;
  return 1;
}



undefined8 * FUN_180055a60(undefined8 *param_1)

{
  int *piVar1;

  FUN_18005e1d0(param_1);
  *(undefined4 *)(param_1 + 1) = 0x36;
  *param_1 = FARFRRChain::vftable;
  if (param_1 + 4 == (undefined8 *)0x0) {
    piVar1 = _errno();
    *piVar1 = 0x16;
    _invalid_parameter_noinfo();
  }
  else {
    param_1[4] = 0x46005200410046;
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"FARFRRChain.cpp",
             (undefined *)L"FARFRRChain::FARFRRChain",0xe,0,
             (undefined *)L"Engine test: FAR/FRR chain init");
  return param_1;
}



void FUN_180055af0(undefined8 *param_1)

{
  undefined4 local_res8 [8];

  local_res8[0] = 1;
  *param_1 = FARFRRChain::vftable;
  FUN_180058ba0(local_res8);
  FUN_18005e220(param_1);
  return;
}



void FUN_180055b30(undefined8 param_1,undefined8 param_2,longlong param_3,undefined4 *param_4,
                  undefined4 *param_5)

{
  byte bVar1;
  byte bVar2;
  int iVar3;
  longlong lVar4;
  DWORD nNumberOfBytesToRead;
  HANDLE hFile;
  uint *lpBuffer;
  longlong lVar5;
  char local_b8 [4];
  uint local_b4;
  undefined4 local_b0;
  DWORD local_ac;
  int local_a8 [4];
  LPVOID local_98 [8];
  LPVOID local_58;
  ulonglong local_48;

  local_48 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffef8;
  lpBuffer = (uint *)0x0;
  nNumberOfBytesToRead = 0;
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"FARFRRChain.cpp",
             (undefined *)L"FARFRRChain::ProcessCore",0x30,0,
             (undefined *)L"Engine Test,FAR/FRR Identity Entry!");
  local_b4 = 1;
  if (*(short *)((longlong)param_4 + 0x222) == 1) {
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"FARFRRChain.cpp",
               (undefined *)L"FARFRRChain::ProcessCore",0x35,0,
               (undefined *)L"Engine Test,FAR/FRR clean Entry!");
    FUN_180058ba0(&local_b4);
    param_5[1] = 0;
    *param_5 = *param_4;
  }
  else {
    param_5[1] = 0;
    param_5[2] = 1;
    FUN_180058c90(&local_b4);
    if ((*(short *)(param_4 + 0x88) != 0) || (local_b4 == 0)) {
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"FARFRRChain.cpp",
                 (undefined *)L"FARFRRChain::ProcessCore",0x46,0,
                 (undefined *)L"Engine Test, FAR/FRR use new template");
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"FARFRRChain.cpp",
                 (undefined *)L"FARFRRChain::ProcessCore",0x47,0,
                 (undefined *)
                 L"====================================Call QueryTempalte Start==================");
      hFile = CreateFileW(L"C:\\ProgramData\\Goodix\\temp_record.dat",0x80000000,0,
                          (LPSECURITY_ATTRIBUTES)0x0,3,0,(HANDLE)0x0);
      nNumberOfBytesToRead = 0;
      if (hFile != (HANDLE)0x0) {
        nNumberOfBytesToRead = GetFileSize(hFile,(LPDWORD)0x0);
        lpBuffer = (uint *)malloc((ulonglong)nNumberOfBytesToRead);
        ReadFile(hFile,lpBuffer,nNumberOfBytesToRead,&local_ac,(LPOVERLAPPED)0x0);
        CloseHandle(hFile);
      }
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"FARFRRChain.cpp",
                 (undefined *)L"FARFRRChain::ProcessCore",0x4a,0,
                 (undefined *)

                 L"====================================Call QueryTempalte Complete=================="
                );
      if (lpBuffer == (uint *)0x0) {
        param_5[1] = 1;
        param_5[2] = 2;
        goto LAB_180055f2b;
      }
    }
    lVar4 = *(longlong *)(param_3 + 0x38);
    lVar5 = (longlong)*(int *)(lVar4 + 0x6c) * 0xe;
    bVar1 = (&DAT_1800afd12)[lVar5];
    bVar2 = (&DAT_1800afd10)[lVar5];
    if (lVar4 == 0) {
      param_5[1] = 1;
    }
    else {
      iVar3 = *(int *)(lVar4 + 0x88);
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"FARFRRChain.cpp",
                 (undefined *)L"FARFRRChain::ProcessCore",0x69,0,
                 (undefined *)L"Identity FileName, %s");
      FUN_180056010((wchar_t *)(param_4 + 2),local_98,(ulonglong)bVar1,(ulonglong)bVar2);
      if ((local_98[0] == (LPVOID)0x0) || (local_58 == (LPVOID)0x0)) {
        param_5[1] = 0x9999991;
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"FARFRRChain.cpp",
                   (undefined *)L"FARFRRChain::ProcessCore",0x6e,0,
                   (undefined *)L"Engine Test,FAR/FRR GetFeatureSet buffer is NULL!");
      }
      else {
        FUN_180058ca0(&local_b4,lpBuffer,nNumberOfBytesToRead,(longlong *)local_98,iVar3 != 0,
                      local_a8,&local_b0,local_b8,(ulonglong)local_58,*(char *)(lVar4 + 0x120));
        param_5[2] = local_b0;
        param_5[1] = 0;
        param_5[3] = 2 - (uint)(local_b8[0] != '\0');
      }
      if (local_98[0] != (LPVOID)0x0) {
        FUN_1800501e0(local_98[0]);
        local_98[0] = (LPVOID)0x0;
      }
      if (local_58 != (LPVOID)0x0) {
        FUN_1800501e0(local_58);
        local_58 = (LPVOID)0x0;
      }
      if (lpBuffer != (uint *)0x0) {
        free(lpBuffer);
      }
    }
  }
LAB_180055f2b:
  FUN_18005f100(local_48 ^ (ulonglong)&stack0xfffffffffffffef8);
  return;
}



void FUN_180055f50(void **param_1,DWORD *param_2)

{
  DWORD nNumberOfBytesToRead;
  HANDLE hFile;
  void *lpBuffer;
  DWORD local_res18 [2];

  hFile = CreateFileW(L"C:\\ProgramData\\Goodix\\temp_record.dat",0x80000000,0,
                      (LPSECURITY_ATTRIBUTES)0x0,3,0,(HANDLE)0x0);
  if (hFile != (HANDLE)0x0) {
    nNumberOfBytesToRead = GetFileSize(hFile,(LPDWORD)0x0);
    *param_2 = nNumberOfBytesToRead;
    lpBuffer = malloc((ulonglong)nNumberOfBytesToRead);
    *param_1 = lpBuffer;
    ReadFile(hFile,lpBuffer,nNumberOfBytesToRead,local_res18,(LPOVERLAPPED)0x0);
    CloseHandle(hFile);
  }
  return;
}



void FUN_180056010(wchar_t *param_1,void **param_2,ulonglong param_3,ulonglong param_4)

{
  void **_DstBuf;
  void *pvVar1;
  void *_DstBuf_00;
  uint uVar2;
  FILE *local_res10;
  undefined2 local_res18 [4];
  undefined2 local_res20 [4];

  uVar2 = (int)(param_4 & 0xff) * (int)(param_3 & 0xff);
  local_res18[0] = 0;
  local_res20[0] = 0;
  *(uint *)((longlong)param_2 + 0x14) = uVar2;
  pvVar1 = (void *)FUN_18004cea0((ulonglong)uVar2);
  *param_2 = pvVar1;
  *(undefined2 *)((longlong)param_2 + 0xe) = 0x108;
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"FARFRRHelper.cpp",
             (undefined *)L"FrrFarHelper::getFeatureSet",0x31,0,
             (undefined *)L"--------------------Height = %d, Width = %d");
  *(short *)(param_2 + 1) = (short)(param_4 & 0xff);
  *(short *)((longlong)param_2 + 10) = (short)(param_3 & 0xff);
  *(undefined2 *)(param_2 + 3) = 1;
  _DstBuf_00 = (void *)FUN_18004cea0((ulonglong)(uint)(*(int *)((longlong)param_2 + 0x14) * 2));
  pvVar1 = *param_2;
  _DstBuf = param_2 + 6;
  uVar2 = *(uint *)((longlong)param_2 + 0x14);
  param_2[8] = _DstBuf_00;
  if ((pvVar1 != (void *)0x0) && (_DstBuf != (void **)0x0)) {
    local_res10 = (FILE *)0x0;
    _wfopen_s(&local_res10,param_1,L"rb");
    if (local_res10 != (FILE *)0x0) {
      fread_s(local_res18,2,1,2,local_res10);
      fread_s(local_res20,2,1,2,local_res10);
      fread_s(pvVar1,(ulonglong)uVar2,1,(ulonglong)uVar2,local_res10);
      fread_s(_DstBuf,8,1,8,local_res10);
      fread_s(_DstBuf_00,(ulonglong)(uVar2 * 2),1,(ulonglong)(uVar2 * 2),local_res10);
      fclose(local_res10);
    }
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"FARFRRHelper.cpp",
             (undefined *)L"FrrFarHelper::getFeatureSet",0x3d,0,
             (undefined *)
             L"read from BMP:size:%u, imageWidth=%d, imageHeight=%d, quality:%u - coverage:%u");
  *(undefined *)(param_2 + 5) = *(undefined *)((longlong)param_2 + 0x34);
  *(undefined *)((longlong)param_2 + 0x29) = *(undefined *)_DstBuf;
  *(undefined2 *)(param_2 + 1) = local_res18[0];
  *(undefined2 *)((longlong)param_2 + 10) = local_res20[0];
  return;
}



undefined8 * FUN_180056270(undefined8 *param_1)

{
  int *piVar1;

  FUN_18005e1d0(param_1);
  *(undefined4 *)(param_1 + 1) = 0x37;
  *param_1 = FARFRRImportPicAsTemplateChain::vftable;
  if (param_1 + 4 == (undefined8 *)0x0) {
    piVar1 = _errno();
    *piVar1 = 0x16;
    _invalid_parameter_noinfo();
  }
  else {
    param_1[4] = 0x6f0070006d0049;
  }
  param_1[0xd] = FUN_1800566f0;
  param_1[0xe] = &LAB_180056540;
  param_1[0xf] = &LAB_1800563d0;
  param_1[0x10] = FUN_180056370;
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"FARFRRImportPicAsTemplateChain.cpp",
             (undefined *)L"FARFRRImportPicAsTemplateChain::FARFRRImportPicAsTemplateChain",0xe8,0,
             (undefined *)L"Engine test: ImportPicAsTmpl chain init");
  return param_1;
}



void FUN_180056330(undefined8 *param_1)

{
  undefined4 local_res8 [8];

  *param_1 = FARFRRImportPicAsTemplateChain::vftable;
  FUN_180059070(local_res8);
  FUN_18005e220(param_1);
  return;
}



ulonglong FUN_180056360(undefined8 param_1,longlong param_2)

{
  return (ulonglong)*(uint *)(param_2 + 0x20c);
}



void FUN_180056370(void)

{
  longlong in_R9;
  undefined4 local_res20 [2];

  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"FARFRRImportPicAsTemplateChain.cpp",
             (undefined *)L"ImportClean",0xd7,0,
             (undefined *)L"Engine Test, ImportAction_Clean Entry");
  FUN_180059070(local_res20);
  *(undefined4 *)(in_R9 + 4) = 0;
  return;
}



void FUN_1800566f0(undefined8 param_1,longlong param_2,longlong param_3,longlong param_4)

{
  undefined4 local_res10 [2];

  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"FARFRRImportPicAsTemplateChain.cpp",
             (undefined *)L"ImportStart",0x42,0,
             (undefined *)L"Engine Test, ImportPicAction_Start Entry");
  FUN_180059220(local_res10,*(uint *)(*(longlong *)(param_2 + 0x38) + 0x6c),
                *(undefined2 *)(param_3 + 0x212));
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"FARFRRImportPicAsTemplateChain.cpp",
             (undefined *)L"ImportStart",0x45,0,
             (undefined *)L"Engine Test, ImportStart return code: %d");
  *(undefined4 *)(param_4 + 4) = local_res10[0];
  return;
}



undefined8 * FUN_1800567e0(undefined8 *param_1)

{
  undefined8 *puVar1;
  int *piVar2;
  ulonglong uVar3;
  undefined4 local_28;
  undefined4 uStack36;
  undefined4 uStack32;
  undefined4 uStack28;
  undefined4 local_18;
  undefined4 uStack20;
  undefined4 uStack16;
  undefined4 uStack12;

  FUN_18005e1d0(param_1);
  *(undefined4 *)(param_1 + 1) = 0x39;
  *param_1 = FetchSampleDataChain::vftable;
  uVar3 = 0xffffffffffffffff;
  local_28 = 0x650046;
  uStack36 = 0x630074;
  uStack32 = 0x530068;
  uStack28 = 0x6d0061;
  local_18 = 0x6c0070;
  uStack20 = 0x440065;
  uStack16 = 0x740061;
  uStack12 = 0x61;
  do {
    uVar3 = uVar3 + 1;
  } while (*(short *)((longlong)&local_28 + uVar3 * 2) != 0);
  puVar1 = param_1 + 4;
  if (uVar3 != 0) {
    if (puVar1 == (undefined8 *)0x0) {
      piVar2 = _errno();
      *piVar2 = 0x16;
    }
    else {
      if (uVar3 < 0x21) {
        memcpy_FUN_180061f90(puVar1,(undefined8 *)&local_28,uVar3);
        goto LAB_18005687c;
      }
      *puVar1 = 0;
      param_1[5] = 0;
      param_1[6] = 0;
      param_1[7] = 0;
      piVar2 = _errno();
      *piVar2 = 0x22;
    }
    _invalid_parameter_noinfo();
  }
LAB_18005687c:
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"FetchSampleDataChain.cpp",
             (undefined *)L"FetchSampleDataChain::FetchSampleDataChain",0xf,0,
             (undefined *)L"Engine test: FetchSampleDataChain chain init");
  return param_1;
}



void FUN_1800568d0(void **param_1)

{
  void **ppvVar1;
  code *pcVar2;
  void *pvVar3;
  void *pvVar4;

  pvVar4 = param_1[4];
  while (pvVar4 != (void *)0x0) {
    ppvVar1 = param_1 + 4;
    *ppvVar1 = (void *)((longlong)*ppvVar1 + -1);
    if (*ppvVar1 == (void *)0x0) {
      param_1[3] = (void *)0x0;
    }
    pvVar4 = param_1[4];
  }
  pvVar4 = param_1[2];
  while (pvVar4 != (void *)0x0) {
    pvVar4 = (void *)((longlong)pvVar4 + -1);
    pvVar3 = *(void **)((longlong)param_1[1] + (longlong)pvVar4 * 8);
    if (pvVar3 != (void *)0x0) {
      free(pvVar3);
    }
  }
  pvVar4 = param_1[1];
  if (pvVar4 != (void *)0x0) {
    if (((void *)0x1fffffffffffffff < param_1[2]) ||
       ((pvVar3 = pvVar4, 0xfff < (ulonglong)((longlong)param_1[2] * 8) &&
        (((((ulonglong)pvVar4 & 0x1f) != 0 ||
          (pvVar3 = *(void **)((longlong)pvVar4 - 8), pvVar4 <= pvVar3)) ||
         (0x1f < (ulonglong)((longlong)pvVar4 + (-8 - (longlong)pvVar3)))))))) {
      _invalid_parameter_noinfo_noreturn();
      pcVar2 = (code *)swi(3);
      (*pcVar2)();
      return;
    }
    free(pvVar3);
  }
  param_1[2] = (void *)0x0;
  param_1[1] = (void *)0x0;
  free(*param_1);
  *param_1 = (void *)0x0;
  return;
}



void FUN_1800569b0(undefined8 *param_1)

{
  *param_1 = FetchSampleDataChain::vftable;
  FUN_1800569e0();
  FUN_18005e220(param_1);
  return;
}



void FUN_1800569e0(void)

{
  void **_Memory;
  ulonglong uVar1;
  ulonglong *puVar2;

  if (DAT_1800b1830 != 0) {
    puVar2 = DAT_1800b1810;
    do {
      uVar1 = 0;
      if (puVar2 != (ulonglong *)0x0) {
        uVar1 = *puVar2;
      }
      DAT_1800b1830 = DAT_1800b1830 + -1;
      _Memory = *(void ***)
                 (*(longlong *)
                   (*(longlong *)(uVar1 + 8) +
                   (DAT_1800b1828 >> 1 & *(longlong *)(uVar1 + 0x10) - 1U) * 8) +
                 (ulonglong)((uint)DAT_1800b1828 & 1) * 8);
      uVar1 = 0;
      if (DAT_1800b1830 != 0) {
        uVar1 = DAT_1800b1828 + 1;
      }
      DAT_1800b1828 = uVar1;
      if (_Memory != (void **)0x0) {
        if (*_Memory != (void *)0x0) {
          free(*_Memory);
          *_Memory = (void *)0x0;
        }
        if (_Memory[4] != (void *)0x0) {
          free(_Memory[4]);
          _Memory[4] = (void *)0x0;
        }
        free(_Memory);
        puVar2 = DAT_1800b1810;
      }
    } while (DAT_1800b1830 != 0);
  }
  return;
}



// WARNING: Removing unreachable block (ram,0x000180056c76)
// WARNING: Removing unreachable block (ram,0x000180056c89)
// WARNING: Removing unreachable block (ram,0x000180056c7f)
// WARNING: Removing unreachable block (ram,0x000180056c87)
// WARNING: Removing unreachable block (ram,0x000180057290)
// WARNING: Removing unreachable block (ram,0x0001800572a3)
// WARNING: Removing unreachable block (ram,0x000180057299)
// WARNING: Removing unreachable block (ram,0x0001800572a1)
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

bool FetchSampleDataChain_FUN_180056ad0(void)

{
  int iVar1;
  void **_Memory;
  bool bVar2;
  undefined8 *puVar3;
  undefined8 *puVar4;
  undefined8 *puVar5;
  undefined8 *puVar6;
  undefined8 *puVar7;
  longlong lVar8;
  undefined8 *puVar9;
  undefined8 *puVar10;
  undefined4 uVar11;
  longlong in_R9;
  undefined8 *puVar12;
  undefined4 *puVar13;
  undefined4 *puVar14;
  undefined4 *in_stack_00000028;
  undefined8 *in_stack_00000030;
  undefined8 *local_48;
  undefined8 *local_40;
  undefined8 *local_38;

  iVar1 = *(int *)(in_R9 + 4);
  if (iVar1 == 0) {
    FUN_1800569e0();
    _DAT_1800b1838 = 1;
    in_stack_00000028[1] = 0;
    return true;
  }
  if (iVar1 == 1) {
    FUN_1800569e0();
    _DAT_1800b1838 = 0;
    in_stack_00000028[1] = 0;
    return true;
  }
  lVar8 = 0;
  if (iVar1 != 2) {
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"FetchSampleDataChain.cpp",
               (undefined *)L"FetchSampleDataChain::ProcessCore",0x98,0,
               (undefined *)L"not support action type, %d");
    return false;
  }
  if (DAT_1800b1830 == 0) {
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"FetchSampleDataChain.cpp",
               (undefined *)L"FetchSampleDataChain::ProcessCore",0x4b,0,
               (undefined *)L"export data queue is empty");
    in_stack_00000028[1] = 0x9999995;
    return false;
  }
  if (DAT_1800b1810 != (longlong *)0x0) {
    lVar8 = *DAT_1800b1810;
  }
  DAT_1800b1830 = DAT_1800b1830 + -1;
  _Memory = *(void ***)
             (*(longlong *)
               (*(longlong *)(lVar8 + 8) +
               (DAT_1800b1828 >> 1 & *(longlong *)(lVar8 + 0x10) - 1U) * 8) +
             (ulonglong)((uint)DAT_1800b1828 & 1) * 8);
  if (DAT_1800b1830 == 0) {
    DAT_1800b1828 = 0;
  }
  else {
    DAT_1800b1828 = DAT_1800b1828 + 1;
  }
  puVar9 = (undefined8 *)0x0;
  local_48 = (undefined8 *)0x0;
  local_40 = (undefined8 *)0x0;
  local_38 = (undefined8 *)0x0;
  if ((_Memory == (void **)0x0) || (*_Memory == (void *)0x0)) {
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"FetchSampleDataChain.cpp",
               (undefined *)L"FetchSampleDataChain::ProcessCore",0x5b,0,
               (undefined *)L"export data is invalid");
    puVar13 = (undefined4 *)0x2000;
    puVar7 = (undefined8 *)realloc((void *)0x0,0x2000);
    puVar12 = puVar9;
    puVar6 = puVar9;
    if (puVar7 != (undefined8 *)0x0) {
      *(undefined4 *)puVar7 = 4;
      puVar9 = (undefined8 *)&DAT_00000004;
      puVar12 = puVar7;
      puVar6 = (undefined8 *)0x2000;
    }
    puVar7 = puVar12;
    if ((undefined8 *)((longlong)puVar6 - (longlong)puVar9) < &DAT_00000004) {
      if (puVar6 != (undefined8 *)0x0) {
        puVar13 = (undefined4 *)((longlong)puVar6 * 2);
      }
      do {
        puVar14 = puVar13;
        if ((undefined4 *)((longlong)puVar9 + 4) <= puVar13) break;
        bVar2 = puVar13 < (undefined4 *)((longlong)puVar13 * 2);
        puVar14 = (undefined4 *)((longlong)puVar9 + 4);
        puVar13 = (undefined4 *)((longlong)puVar13 * 2);
      } while (bVar2);
      puVar7 = (undefined8 *)realloc(puVar12,(size_t)puVar14);
      if (puVar7 == (undefined8 *)0x0) {
        uVar11 = 0x9999995;
        goto LAB_180057324;
      }
    }
    uVar11 = 0x9999995;
    *(undefined4 *)((longlong)puVar7 + (longlong)puVar9) = 0x9999995;
    puVar9 = (undefined8 *)((longlong)puVar9 + 4);
    puVar12 = puVar7;
    goto LAB_180057324;
  }
  uVar11 = *(undefined4 *)((longlong)_Memory + 0x14);
  puVar12 = (undefined8 *)0x2000;
  puVar5 = (undefined8 *)realloc((void *)0x0,0x2000);
  puVar6 = puVar9;
  puVar7 = puVar9;
  if (puVar5 != (undefined8 *)0x0) {
    *(undefined4 *)puVar5 = 4;
    puVar9 = (undefined8 *)&DAT_00000004;
    local_48 = (undefined8 *)&DAT_00000004;
    puVar6 = puVar5;
    puVar7 = (undefined8 *)0x2000;
    local_40 = puVar5;
    local_38 = (undefined8 *)0x2000;
  }
  puVar5 = puVar6;
  puVar10 = puVar7;
  puVar3 = local_40;
  puVar4 = local_38;
  if ((undefined8 *)((longlong)puVar7 - (longlong)puVar9) < (undefined8 *)0x4) {
    puVar5 = (undefined8 *)((longlong)puVar7 * 2);
    if (puVar7 == (undefined8 *)0x0) {
      puVar5 = (undefined8 *)0x2000;
    }
    do {
      puVar10 = puVar5;
      if ((undefined8 *)((longlong)puVar9 + 4) <= puVar5) break;
      bVar2 = puVar5 < (undefined8 *)((longlong)puVar5 * 2);
      puVar10 = (undefined8 *)((longlong)puVar9 + 4);
      puVar5 = (undefined8 *)((longlong)puVar5 * 2);
    } while (bVar2);
    puVar5 = (undefined8 *)realloc(puVar6,(size_t)puVar10);
    puVar3 = puVar5;
    puVar4 = puVar10;
    if (puVar5 != (undefined8 *)0x0) goto LAB_180056d14;
  }
  else {
LAB_180056d14:
    local_38 = puVar4;
    local_40 = puVar3;
    *(undefined4 *)((longlong)puVar5 + (longlong)puVar9) = uVar11;
    puVar9 = (undefined8 *)((longlong)puVar9 + 4);
    puVar6 = puVar5;
    puVar7 = puVar10;
    local_48 = puVar9;
  }
  puVar5 = puVar6;
  puVar10 = puVar7;
  puVar3 = local_40;
  puVar4 = local_38;
  if ((undefined8 *)((longlong)puVar7 - (longlong)puVar9) < (undefined8 *)0x4) {
    puVar5 = (undefined8 *)((longlong)puVar7 * 2);
    if (puVar7 == (undefined8 *)0x0) {
      puVar5 = (undefined8 *)0x2000;
    }
    do {
      puVar10 = puVar5;
      if ((undefined8 *)((longlong)puVar9 + 4) <= puVar5) break;
      bVar2 = puVar5 < (undefined8 *)((longlong)puVar5 * 2);
      puVar10 = (undefined8 *)((longlong)puVar9 + 4);
      puVar5 = (undefined8 *)((longlong)puVar5 * 2);
    } while (bVar2);
    puVar5 = (undefined8 *)realloc(puVar6,(size_t)puVar10);
    puVar3 = puVar5;
    puVar4 = puVar10;
    if (puVar5 != (undefined8 *)0x0) goto LAB_180056d77;
  }
  else {
LAB_180056d77:
    local_38 = puVar4;
    local_40 = puVar3;
    *(undefined4 *)((longlong)puVar5 + (longlong)puVar9) = 4;
    puVar9 = (undefined8 *)((longlong)puVar9 + 4);
    puVar6 = puVar5;
    puVar7 = puVar10;
    local_48 = puVar9;
  }
  puVar5 = puVar6;
  puVar10 = puVar7;
  puVar3 = local_40;
  puVar4 = local_38;
  if ((undefined8 *)((longlong)puVar7 - (longlong)puVar9) < (undefined8 *)0x4) {
    puVar5 = (undefined8 *)((longlong)puVar7 * 2);
    if (puVar7 == (undefined8 *)0x0) {
      puVar5 = (undefined8 *)0x2000;
    }
    do {
      puVar10 = puVar5;
      if ((undefined8 *)((longlong)puVar9 + 4) <= puVar5) break;
      bVar2 = puVar5 < (undefined8 *)((longlong)puVar5 * 2);
      puVar10 = (undefined8 *)((longlong)puVar9 + 4);
      puVar5 = (undefined8 *)((longlong)puVar5 * 2);
    } while (bVar2);
    puVar5 = (undefined8 *)realloc(puVar6,(size_t)puVar10);
    puVar3 = puVar5;
    puVar4 = puVar10;
    if (puVar5 != (undefined8 *)0x0) goto LAB_180056ddb;
  }
  else {
LAB_180056ddb:
    local_38 = puVar4;
    local_40 = puVar3;
    *(undefined4 *)((longlong)puVar5 + (longlong)puVar9) = *(undefined4 *)(_Memory + 3);
    puVar9 = (undefined8 *)((longlong)puVar9 + 4);
    puVar6 = puVar5;
    puVar7 = puVar10;
    local_48 = puVar9;
  }
  puVar5 = puVar6;
  puVar10 = puVar7;
  puVar3 = local_40;
  puVar4 = local_38;
  if ((undefined8 *)((longlong)puVar7 - (longlong)puVar9) < (undefined8 *)0x4) {
    puVar5 = (undefined8 *)((longlong)puVar7 * 2);
    if (puVar7 == (undefined8 *)0x0) {
      puVar5 = (undefined8 *)0x2000;
    }
    do {
      puVar10 = puVar5;
      if ((undefined8 *)((longlong)puVar9 + 4) <= puVar5) break;
      bVar2 = puVar5 < (undefined8 *)((longlong)puVar5 * 2);
      puVar10 = (undefined8 *)((longlong)puVar9 + 4);
      puVar5 = (undefined8 *)((longlong)puVar5 * 2);
    } while (bVar2);
    puVar5 = (undefined8 *)realloc(puVar6,(size_t)puVar10);
    puVar3 = puVar5;
    puVar4 = puVar10;
    if (puVar5 != (undefined8 *)0x0) goto LAB_180056e44;
  }
  else {
LAB_180056e44:
    local_38 = puVar4;
    local_40 = puVar3;
    *(undefined4 *)((longlong)puVar5 + (longlong)puVar9) = 2;
    puVar9 = (undefined8 *)((longlong)puVar9 + 4);
    puVar6 = puVar5;
    puVar7 = puVar10;
    local_48 = puVar9;
  }
  puVar5 = puVar6;
  puVar10 = puVar7;
  puVar3 = local_40;
  puVar4 = local_38;
  if ((undefined8 *)((longlong)puVar7 - (longlong)puVar9) < (undefined8 *)0x2) {
    puVar5 = (undefined8 *)((longlong)puVar7 * 2);
    if (puVar7 == (undefined8 *)0x0) {
      puVar5 = (undefined8 *)0x2000;
    }
    do {
      puVar10 = puVar5;
      if ((undefined8 *)((longlong)puVar9 + 2) <= puVar5) break;
      bVar2 = puVar5 < (undefined8 *)((longlong)puVar5 * 2);
      puVar10 = (undefined8 *)((longlong)puVar9 + 2);
      puVar5 = (undefined8 *)((longlong)puVar5 * 2);
    } while (bVar2);
    puVar5 = (undefined8 *)realloc(puVar6,(size_t)puVar10);
    puVar3 = puVar5;
    puVar4 = puVar10;
    if (puVar5 != (undefined8 *)0x0) goto LAB_180056ea8;
  }
  else {
LAB_180056ea8:
    local_38 = puVar4;
    local_40 = puVar3;
    *(undefined2 *)((longlong)puVar5 + (longlong)puVar9) = *(undefined2 *)((longlong)_Memory + 0xc);
    puVar9 = (undefined8 *)((longlong)puVar9 + 2);
    puVar6 = puVar5;
    puVar7 = puVar10;
    local_48 = puVar9;
  }
  puVar5 = puVar6;
  puVar10 = puVar7;
  puVar3 = local_40;
  puVar4 = local_38;
  if ((undefined8 *)((longlong)puVar7 - (longlong)puVar9) < (undefined8 *)0x4) {
    puVar5 = (undefined8 *)((longlong)puVar7 * 2);
    if (puVar7 == (undefined8 *)0x0) {
      puVar5 = (undefined8 *)0x2000;
    }
    do {
      puVar10 = puVar5;
      if ((undefined8 *)((longlong)puVar9 + 4) <= puVar5) break;
      bVar2 = puVar5 < (undefined8 *)((longlong)puVar5 * 2);
      puVar10 = (undefined8 *)((longlong)puVar9 + 4);
      puVar5 = (undefined8 *)((longlong)puVar5 * 2);
    } while (bVar2);
    puVar5 = (undefined8 *)realloc(puVar6,(size_t)puVar10);
    puVar3 = puVar5;
    puVar4 = puVar10;
    if (puVar5 != (undefined8 *)0x0) goto LAB_180056f14;
  }
  else {
LAB_180056f14:
    local_38 = puVar4;
    local_40 = puVar3;
    *(undefined4 *)((longlong)puVar5 + (longlong)puVar9) = 2;
    puVar9 = (undefined8 *)((longlong)puVar9 + 4);
    puVar6 = puVar5;
    puVar7 = puVar10;
    local_48 = puVar9;
  }
  puVar5 = puVar6;
  puVar10 = puVar7;
  puVar3 = local_40;
  puVar4 = local_38;
  if ((undefined8 *)((longlong)puVar7 - (longlong)puVar9) < (undefined8 *)0x2) {
    puVar5 = (undefined8 *)((longlong)puVar7 * 2);
    if (puVar7 == (undefined8 *)0x0) {
      puVar5 = (undefined8 *)0x2000;
    }
    do {
      puVar10 = puVar5;
      if ((undefined8 *)((longlong)puVar9 + 2) <= puVar5) break;
      bVar2 = puVar5 < (undefined8 *)((longlong)puVar5 * 2);
      puVar10 = (undefined8 *)((longlong)puVar9 + 2);
      puVar5 = (undefined8 *)((longlong)puVar5 * 2);
    } while (bVar2);
    puVar5 = (undefined8 *)realloc(puVar6,(size_t)puVar10);
    puVar3 = puVar5;
    puVar4 = puVar10;
    if (puVar5 != (undefined8 *)0x0) goto LAB_180056f78;
  }
  else {
LAB_180056f78:
    local_38 = puVar4;
    local_40 = puVar3;
    *(undefined2 *)((longlong)puVar5 + (longlong)puVar9) = *(undefined2 *)((longlong)_Memory + 0xe);
    puVar9 = (undefined8 *)((longlong)puVar9 + 2);
    puVar6 = puVar5;
    puVar7 = puVar10;
    local_48 = puVar9;
  }
  puVar5 = puVar6;
  puVar10 = puVar7;
  puVar3 = local_40;
  puVar4 = local_38;
  if ((undefined8 *)((longlong)puVar7 - (longlong)puVar9) < (undefined8 *)0x4) {
    puVar5 = (undefined8 *)((longlong)puVar7 * 2);
    if (puVar7 == (undefined8 *)0x0) {
      puVar5 = (undefined8 *)0x2000;
    }
    do {
      puVar10 = puVar5;
      if ((undefined8 *)((longlong)puVar9 + 4) <= puVar5) break;
      bVar2 = puVar5 < (undefined8 *)((longlong)puVar5 * 2);
      puVar10 = (undefined8 *)((longlong)puVar9 + 4);
      puVar5 = (undefined8 *)((longlong)puVar5 * 2);
    } while (bVar2);
    puVar5 = (undefined8 *)realloc(puVar6,(size_t)puVar10);
    puVar3 = puVar5;
    puVar4 = puVar10;
    if (puVar5 != (undefined8 *)0x0) goto LAB_180056fe4;
  }
  else {
LAB_180056fe4:
    local_38 = puVar4;
    local_40 = puVar3;
    *(undefined4 *)((longlong)puVar5 + (longlong)puVar9) = 2;
    puVar9 = (undefined8 *)((longlong)puVar9 + 4);
    puVar6 = puVar5;
    puVar7 = puVar10;
    local_48 = puVar9;
  }
  puVar5 = puVar6;
  puVar10 = puVar7;
  puVar3 = local_40;
  puVar4 = local_38;
  if ((undefined8 *)((longlong)puVar7 - (longlong)puVar9) < (undefined8 *)0x2) {
    puVar5 = (undefined8 *)((longlong)puVar7 * 2);
    if (puVar7 == (undefined8 *)0x0) {
      puVar5 = (undefined8 *)0x2000;
    }
    do {
      puVar10 = puVar5;
      if ((undefined8 *)((longlong)puVar9 + 2) <= puVar5) break;
      bVar2 = puVar5 < (undefined8 *)((longlong)puVar5 * 2);
      puVar10 = (undefined8 *)((longlong)puVar9 + 2);
      puVar5 = (undefined8 *)((longlong)puVar5 * 2);
    } while (bVar2);
    puVar5 = (undefined8 *)realloc(puVar6,(size_t)puVar10);
    puVar3 = puVar5;
    puVar4 = puVar10;
    if (puVar5 != (undefined8 *)0x0) goto LAB_180057048;
  }
  else {
LAB_180057048:
    local_38 = puVar4;
    local_40 = puVar3;
    *(undefined2 *)((longlong)puVar5 + (longlong)puVar9) = *(undefined2 *)(_Memory + 2);
    puVar9 = (undefined8 *)((longlong)puVar9 + 2);
    puVar6 = puVar5;
    puVar7 = puVar10;
    local_48 = puVar9;
  }
  puVar5 = puVar6;
  puVar10 = puVar7;
  puVar3 = local_40;
  puVar4 = local_38;
  if ((undefined8 *)((longlong)puVar7 - (longlong)puVar9) < (undefined8 *)0x4) {
    puVar5 = (undefined8 *)((longlong)puVar7 * 2);
    if (puVar7 == (undefined8 *)0x0) {
      puVar5 = (undefined8 *)0x2000;
    }
    do {
      puVar10 = puVar5;
      if ((undefined8 *)((longlong)puVar9 + 4) <= puVar5) break;
      bVar2 = puVar5 < (undefined8 *)((longlong)puVar5 * 2);
      puVar10 = (undefined8 *)((longlong)puVar9 + 4);
      puVar5 = (undefined8 *)((longlong)puVar5 * 2);
    } while (bVar2);
    puVar5 = (undefined8 *)realloc(puVar6,(size_t)puVar10);
    puVar3 = puVar5;
    puVar4 = puVar10;
    if (puVar5 != (undefined8 *)0x0) goto LAB_1800570b4;
  }
  else {
LAB_1800570b4:
    local_38 = puVar4;
    local_40 = puVar3;
    *(undefined4 *)((longlong)puVar5 + (longlong)puVar9) = 2;
    puVar9 = (undefined8 *)((longlong)puVar9 + 4);
    puVar6 = puVar5;
    puVar7 = puVar10;
    local_48 = puVar9;
  }
  puVar5 = puVar6;
  puVar10 = puVar7;
  puVar3 = local_40;
  puVar4 = local_38;
  if ((undefined8 *)((longlong)puVar7 - (longlong)puVar9) < (undefined8 *)0x2) {
    puVar5 = (undefined8 *)((longlong)puVar7 * 2);
    if (puVar7 == (undefined8 *)0x0) {
      puVar5 = (undefined8 *)0x2000;
    }
    do {
      puVar10 = puVar5;
      if ((undefined8 *)((longlong)puVar9 + 2) <= puVar5) break;
      bVar2 = puVar5 < (undefined8 *)((longlong)puVar5 * 2);
      puVar10 = (undefined8 *)((longlong)puVar9 + 2);
      puVar5 = (undefined8 *)((longlong)puVar5 * 2);
    } while (bVar2);
    puVar5 = (undefined8 *)realloc(puVar6,(size_t)puVar10);
    puVar3 = puVar5;
    puVar4 = puVar10;
    if (puVar5 != (undefined8 *)0x0) goto LAB_180057118;
  }
  else {
LAB_180057118:
    local_38 = puVar4;
    local_40 = puVar3;
    *(undefined2 *)((longlong)puVar5 + (longlong)puVar9) = *(undefined2 *)((longlong)_Memory + 0x12)
    ;
    puVar9 = (undefined8 *)((longlong)puVar9 + 2);
    puVar6 = puVar5;
    puVar7 = puVar10;
    local_48 = puVar9;
  }
  puVar5 = puVar6;
  puVar10 = puVar7;
  puVar3 = local_40;
  puVar4 = local_38;
  if ((undefined8 *)((longlong)puVar7 - (longlong)puVar9) < (undefined8 *)0x4) {
    puVar5 = (undefined8 *)((longlong)puVar7 * 2);
    if (puVar7 == (undefined8 *)0x0) {
      puVar5 = (undefined8 *)0x2000;
    }
    do {
      puVar10 = puVar5;
      if ((undefined8 *)((longlong)puVar9 + 4) <= puVar5) break;
      bVar2 = puVar5 < (undefined8 *)((longlong)puVar5 * 2);
      puVar10 = (undefined8 *)((longlong)puVar9 + 4);
      puVar5 = (undefined8 *)((longlong)puVar5 * 2);
    } while (bVar2);
    puVar5 = (undefined8 *)realloc(puVar6,(size_t)puVar10);
    puVar3 = puVar5;
    puVar4 = puVar10;
    if (puVar5 != (undefined8 *)0x0) goto LAB_180057184;
  }
  else {
LAB_180057184:
    local_38 = puVar4;
    local_40 = puVar3;
    *(undefined4 *)((longlong)puVar5 + (longlong)puVar9) = 4;
    puVar9 = (undefined8 *)((longlong)puVar9 + 4);
    puVar6 = puVar5;
    puVar7 = puVar10;
    local_48 = puVar9;
  }
  puVar10 = local_40;
  puVar5 = local_38;
  if ((undefined8 *)((longlong)puVar7 - (longlong)puVar9) < (undefined8 *)0x4) {
    if (puVar7 != (undefined8 *)0x0) {
      puVar12 = (undefined8 *)((longlong)puVar7 * 2);
    }
    do {
      puVar5 = puVar12;
      if ((undefined8 *)((longlong)puVar9 + 4) <= puVar12) break;
      bVar2 = puVar12 < (undefined8 *)((longlong)puVar12 * 2);
      puVar5 = (undefined8 *)((longlong)puVar9 + 4);
      puVar12 = (undefined8 *)((longlong)puVar12 * 2);
    } while (bVar2);
    puVar6 = (undefined8 *)realloc(puVar6,(size_t)puVar5);
    puVar10 = puVar6;
    if (puVar6 != (undefined8 *)0x0) goto LAB_1800571e2;
  }
  else {
LAB_1800571e2:
    local_38 = puVar5;
    local_40 = puVar10;
    *(undefined4 *)((longlong)puVar6 + (longlong)puVar9) = *(undefined4 *)(_Memory + 1);
    local_48 = (undefined8 *)((longlong)puVar9 + 4);
  }
  FUN_1800577a0((longlong *)&local_48,(ulonglong)*(uint *)(_Memory + 1),(undefined8 *)*_Memory);
  puVar9 = local_48;
  puVar12 = local_40;
  if ((undefined8 *)_Memory[4] != (undefined8 *)0x0) {
    FUN_1800577a0((longlong *)&local_48,(ulonglong)(uint)(*(int *)(_Memory + 1) * 2),
                  (undefined8 *)_Memory[4]);
    puVar9 = local_48;
    puVar12 = local_40;
  }
LAB_180057324:
  puVar13 = (undefined4 *)((longlong)puVar9 + 0xc);
  puVar14 = (undefined4 *)*in_stack_00000030;
  if (puVar13 <= puVar14) {
    *in_stack_00000028 = 0x5a;
    in_stack_00000028[2] = (int)puVar9;
    *in_stack_00000030 = puVar13;
    in_stack_00000028[1] = uVar11;
    memcpy_FUN_180061f90((undefined8 *)(in_stack_00000028 + 3),puVar12,(ulonglong)puVar9);
    free(puVar12);
  }
  else {
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"FetchSampleDataChain.cpp",
               (undefined *)L"FetchSampleDataChain::ProcessCore",0x72,0,
               (undefined *)L"the receiveDataSize: %d is less than buffersize: %d ");
    in_stack_00000028[1] = 1;
  }
  if (_Memory != (void **)0x0) {
    if (*_Memory != (void *)0x0) {
      free(*_Memory);
      *_Memory = (void *)0x0;
    }
    if (_Memory[4] != (void *)0x0) {
      free(_Memory[4]);
      _Memory[4] = (void *)0x0;
    }
    free(_Memory);
  }
  return puVar13 <= puVar14;
}



void FUN_180057470(undefined8 param_1)

{
  ulonglong uVar1;
  longlong lVar2;
  code *pcVar3;
  longlong lVar4;

  if ((((int)DAT_1800b1830 + (int)DAT_1800b1828 & 1U) == 0) &&
     (DAT_1800b1820 <= DAT_1800b1830 + 2U >> 1)) {
    FUN_180057560((longlong)&DAT_1800b1810,1);
  }
  DAT_1800b1828 = DAT_1800b1828 & DAT_1800b1820 * 2 - 1;
  uVar1 = DAT_1800b1828 + DAT_1800b1830;
  lVar2 = (DAT_1800b1820 - 1 & uVar1 >> 1) * 8;
  if (*(longlong *)(lVar2 + DAT_1800b1818) == 0) {
    lVar4 = FUN_18005f1cc(0x10);
    if (lVar4 == 0) {
      _invalid_parameter_noinfo_noreturn();
      pcVar3 = (code *)swi(3);
      (*pcVar3)();
      return;
    }
    *(longlong *)(lVar2 + DAT_1800b1818) = lVar4;
  }
  *(undefined8 *)(*(longlong *)(lVar2 + DAT_1800b1818) + (ulonglong)((uint)uVar1 & 1) * 8) = param_1
  ;
  DAT_1800b1830 = DAT_1800b1830 + 1;
  return;
}



void FUN_180057560(longlong param_1,ulonglong param_2)

{
  void *pvVar1;
  code *pcVar2;
  longlong lVar3;
  void *_Memory;
  ulonglong uVar4;
  undefined8 *puVar5;
  ulonglong uVar6;
  ulonglong uVar7;
  undefined8 *puVar8;
  ulonglong uVar9;

  uVar9 = *(ulonglong *)(param_1 + 0x10);
  uVar6 = 1;
  if (uVar9 != 0) {
    uVar6 = uVar9;
  }
  while ((uVar7 = uVar6 - uVar9, uVar7 < param_2 || (uVar6 < 8))) {
    if (0xfffffffffffffff - uVar6 < uVar6) {
      FUN_180057780();
      pcVar2 = (code *)swi(3);
      (*pcVar2)();
      return;
    }
    uVar6 = uVar6 * 2;
  }
  uVar9 = *(ulonglong *)(param_1 + 0x18) >> 1;
  if (uVar6 == 0) {
    puVar8 = (undefined8 *)0x0;
  }
  else {
    if (0x1fffffffffffffff < uVar6) {
      FUN_180061e5c();
      pcVar2 = (code *)swi(3);
      (*pcVar2)();
      return;
    }
    uVar6 = uVar6 * 8;
    if (uVar6 < 0x1000) {
      puVar8 = (undefined8 *)FUN_18005f1cc(uVar6);
      if (puVar8 == (undefined8 *)0x0) {
        _invalid_parameter_noinfo_noreturn();
        pcVar2 = (code *)swi(3);
        (*pcVar2)();
        return;
      }
    }
    else {
      if (uVar6 + 0x27 <= uVar6) {
        FUN_180061e5c();
        pcVar2 = (code *)swi(3);
        (*pcVar2)();
        return;
      }
      lVar3 = FUN_18005f1cc(uVar6 + 0x27);
      if (lVar3 == 0) {
        _invalid_parameter_noinfo_noreturn();
        pcVar2 = (code *)swi(3);
        (*pcVar2)();
        return;
      }
      puVar8 = (undefined8 *)(lVar3 + 0x27U & 0xffffffffffffffe0);
      puVar8[-1] = lVar3;
    }
  }
  uVar6 = uVar9 * 8;
  puVar5 = (undefined8 *)(*(longlong *)(param_1 + 8) + uVar6);
  uVar4 = (*(longlong *)(param_1 + 0x10) * 8 - (longlong)puVar5) + *(longlong *)(param_1 + 8);
  memcpy_FUN_180061f90(puVar8 + uVar9,puVar5,uVar4);
  puVar5 = (undefined8 *)(uVar4 + (longlong)(puVar8 + uVar9));
  if (uVar7 < uVar9) {
    uVar9 = uVar7 * 8;
    memcpy_FUN_180061f90(puVar5,*(undefined8 **)(param_1 + 8),uVar9);
    puVar5 = (undefined8 *)(uVar9 + *(longlong *)(param_1 + 8));
    uVar6 = (*(longlong *)(param_1 + 8) - (longlong)puVar5) + uVar6;
    memcpy_FUN_180061f90(puVar8,puVar5,uVar6);
    puVar5 = (undefined8 *)(uVar6 + (longlong)puVar8);
  }
  else {
    memcpy_FUN_180061f90(puVar5,*(undefined8 **)(param_1 + 8),uVar6);
    memset(puVar5 + uVar9,0,(uVar7 - uVar9) * 8);
    puVar5 = puVar8;
    uVar9 = uVar6;
  }
  memset(puVar5,0,uVar9);
  pvVar1 = *(void **)(param_1 + 8);
  if (pvVar1 != (void *)0x0) {
    if ((0x1fffffffffffffff < *(ulonglong *)(param_1 + 0x10)) ||
       ((_Memory = pvVar1, 0xfff < *(ulonglong *)(param_1 + 0x10) * 8 &&
        (((((ulonglong)pvVar1 & 0x1f) != 0 ||
          (_Memory = *(void **)((longlong)pvVar1 - 8), pvVar1 <= _Memory)) ||
         (0x1f < (ulonglong)((longlong)pvVar1 + (-8 - (longlong)_Memory)))))))) {
      _invalid_parameter_noinfo_noreturn();
      pcVar2 = (code *)swi(3);
      (*pcVar2)();
      return;
    }
    free(_Memory);
  }
  *(undefined8 **)(param_1 + 8) = puVar8;
  *(longlong *)(param_1 + 0x10) = *(longlong *)(param_1 + 0x10) + uVar7;
  return;
}



void FUN_180057780(void)

{
  code *pcVar1;

  FUN_180061ec0("deque<T> too long");
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



undefined8 FUN_1800577a0(longlong *param_1,ulonglong param_2,undefined8 *param_3)

{
  longlong lVar1;
  bool bVar2;
  void *pvVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  ulonglong uVar6;

  lVar1 = param_1[2];
  if ((ulonglong)(lVar1 - *param_1) < 4) {
    if (lVar1 == 0) {
      uVar5 = 0x2000;
    }
    else {
      uVar5 = lVar1 * 2;
    }
    uVar4 = *param_1 + 4;
    do {
      uVar6 = uVar5;
      if (uVar4 <= uVar5) break;
      bVar2 = uVar5 < uVar5 * 2;
      uVar6 = uVar4;
      uVar5 = uVar5 * 2;
    } while (bVar2);
    pvVar3 = realloc((void *)param_1[1],uVar6);
    if (pvVar3 == (void *)0x0) goto LAB_180057850;
    param_1[1] = (longlong)pvVar3;
    param_1[2] = uVar6;
  }
  *(int *)(param_1[1] + *param_1) = (int)param_2;
  *param_1 = *param_1 + 4;
LAB_180057850:
  lVar1 = param_1[2];
  if ((ulonglong)(lVar1 - *param_1) < param_2) {
    if (lVar1 == 0) {
      uVar5 = 0x2000;
    }
    else {
      uVar5 = lVar1 * 2;
    }
    uVar4 = *param_1 + param_2;
    do {
      uVar6 = uVar5;
      if (uVar4 <= uVar5) break;
      bVar2 = uVar5 < uVar5 * 2;
      uVar6 = uVar4;
      uVar5 = uVar5 * 2;
    } while (bVar2);
    pvVar3 = realloc((void *)param_1[1],uVar6);
    if (pvVar3 == (void *)0x0) {
      return 0xffffffff;
    }
    param_1[1] = (longlong)pvVar3;
    param_1[2] = uVar6;
  }
  memcpy_FUN_180061f90((undefined8 *)(param_1[1] + *param_1),param_3,param_2);
  *param_1 = *param_1 + param_2;
  return 0;
}



undefined8 * FUN_180057900(undefined8 *param_1)

{
  int *piVar1;

  FUN_18005e1d0(param_1);
  *(undefined4 *)(param_1 + 1) = 0x18;
  *param_1 = FlatEndChain::vftable;
  if (param_1 + 4 == (undefined8 *)0x0) {
    piVar1 = _errno();
    *piVar1 = 0x16;
    _invalid_parameter_noinfo();
  }
  else {
    param_1[4] = 0x740061006c0046;
  }
  param_1[0xd] = 0;
  param_1[0xc] = FUN_180057990;
  param_1[0xe] = FUN_180057ba0;
  param_1[0xf] = FUN_180057c80;
  param_1[0x10] = &LAB_180057b00;
  return param_1;
}



void FUN_180057990(undefined8 param_1,HANDLE *param_2,longlong param_3,longlong param_4,
                  undefined8 param_5,undefined4 *param_6)

{
  ushort uVar1;
  ushort uVar2;
  ushort uVar3;
  int iVar4;
  int iVar5;
  HANDLE pvVar6;
  ulonglong uVar7;

  DAT_1800b1840 = 0;
  DAT_1800b1848 = (LPVOID)0x0;
  DAT_1800b1850 = (LPVOID)0x0;
  *param_6 = 1;
  uVar1 = *(ushort *)(param_3 + 0x28);
  uVar2 = *(ushort *)(param_3 + 0x26);
  uVar3 = *(ushort *)(param_3 + 0x24);
  iVar4 = *(int *)(param_3 + 8);
  iVar5 = *(int *)(param_3 + 8);
  DAT_1800b1858 = (LPVOID)0x0;
  DAT_1800b1860 = (LPVOID)0x0;
  pvVar6 = GetProcessHeap();
  DAT_1800b1848 = HeapAlloc(pvVar6,8,(ulonglong)((uint)uVar3 * iVar5));
  pvVar6 = GetProcessHeap();
  DAT_1800b1858 = HeapAlloc(pvVar6,8,(ulonglong)(((uint)uVar2 - (uint)uVar1) * iVar4));
  DAT_1800b1850 = DAT_1800b1848;
  DAT_1800b1860 = DAT_1800b1858;
  if ((DAT_1800b1848 == (LPVOID)0x0) || (DAT_1800b1858 == (LPVOID)0x0)) {
    *param_6 = 0;
    *(undefined4 *)(param_4 + 4) = 1;
    FUN_180057b10();
  }
  else {
    DAT_1800b1840 = 0;
    if (*(short *)(param_3 + 0x24) != 0) {
      do {
        uVar7 = FUN_180058a90(param_2,4,DAT_1800b1850,*(DWORD *)(param_3 + 8));
        if ((int)uVar7 < 0) {
          *param_6 = 0;
          *(undefined4 *)(param_4 + 4) = 1;
          return;
        }
        DAT_1800b1850 = (LPVOID)((longlong)DAT_1800b1850 + (longlong)*(int *)(param_3 + 8));
        DAT_1800b1840 = DAT_1800b1840 + 1;
      } while ((ushort)DAT_1800b1840 < *(ushort *)(param_3 + 0x24));
    }
  }
  return;
}



void FUN_180057b10(void)

{
  LPVOID pvVar1;
  HANDLE pvVar2;

  pvVar1 = DAT_1800b1848;
  if (DAT_1800b1848 != (LPVOID)0x0) {
    pvVar2 = GetProcessHeap();
    HeapFree(pvVar2,8,pvVar1);
    DAT_1800b1848 = (LPVOID)0x0;
    DAT_1800b1850 = 0;
  }
  pvVar1 = DAT_1800b1858;
  if (DAT_1800b1858 != (LPVOID)0x0) {
    pvVar2 = GetProcessHeap();
    HeapFree(pvVar2,8,pvVar1);
    DAT_1800b1858 = (LPVOID)0x0;
    DAT_1800b1860 = 0;
  }
  return;
}



ulonglong FUN_180057b90(undefined8 param_1,longlong param_2,longlong param_3)

{
  *(undefined4 *)(param_3 + 0xc) = 0;
  return (ulonglong)*(uint *)(param_2 + 4);
}



void FUN_180057ba0(undefined8 param_1,HANDLE *param_2,longlong param_3,longlong param_4,
                  undefined8 param_5,undefined4 *param_6)

{
  ushort uVar1;
  ulonglong uVar2;
  LPVOID pvVar3;
  ushort uVar4;

  uVar1 = 0;
  DAT_1800b1840 = 0;
  *param_6 = 1;
  uVar4 = *(ushort *)(param_3 + 0x26);
  pvVar3 = DAT_1800b1860;
  if (uVar4 != 0) {
    do {
      DAT_1800b1840 = (char)uVar1 + 1;
      uVar1 = (ushort)DAT_1800b1840;
      if ((*(ushort *)(param_3 + 0x28) < uVar4) &&
         ((int)((uint)uVar4 - (uint)*(ushort *)(param_3 + 0x28)) < (int)(uint)DAT_1800b1840)) {
        uVar2 = FUN_180058a90(param_2,4,pvVar3,*(DWORD *)(param_3 + 8));
        if ((int)uVar2 < 0) {
          *param_6 = 0;
          *(undefined4 *)(param_4 + 4) = 1;
          return;
        }
        pvVar3 = (LPVOID)((longlong)DAT_1800b1860 + (longlong)*(int *)(param_3 + 8));
        uVar1 = (ushort)DAT_1800b1840;
        DAT_1800b1860 = pvVar3;
      }
      uVar4 = *(ushort *)(param_3 + 0x26);
    } while (uVar1 < uVar4);
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180057c80(undefined8 param_1,undefined8 param_2,longlong param_3,longlong param_4,
                  undefined8 param_5,undefined4 *param_6,longlong param_7)

{
  ushort uVar1;
  ushort uVar2;
  LPVOID pvVar3;
  ulonglong uVar4;
  char cVar5;
  int iVar6;
  uint uVar7;
  HANDLE pvVar8;
  ulonglong *lpMem;
  ulonglong *lpMem_00;
  ulonglong *puVar9;
  int iVar10;
  int iVar11;
  undefined8 local_58;
  undefined8 local_50;
  LPVOID local_48;
  ulonglong local_40;
  ulonglong local_38;
  ulonglong *local_30;
  ulonglong *local_28;

  local_40 = 0;
  local_38 = 0;
  local_30 = (ulonglong *)0x0;
  *param_6 = 1;
  uVar1 = *(ushort *)(param_3 + 0x24);
  local_28 = (ulonglong *)0x0;
  local_58 = 0;
  local_50 = 0;
  local_48 = (LPVOID)0x0;
  pvVar8 = GetProcessHeap();
  lpMem = (ulonglong *)HeapAlloc(pvVar8,8,(ulonglong)uVar1 << 3);
  uVar1 = *(ushort *)(param_3 + 0x26);
  uVar2 = *(ushort *)(param_3 + 0x28);
  pvVar8 = GetProcessHeap();
  lpMem_00 = (ulonglong *)HeapAlloc(pvVar8,8,(longlong)(int)((uint)uVar1 - (uint)uVar2) << 3);
  uVar1 = *(ushort *)(param_3 + 0x2c);
  uVar2 = *(ushort *)(param_3 + 0x2a);
  pvVar8 = GetProcessHeap();
  local_48 = HeapAlloc(pvVar8,8,(longlong)(int)((uint)uVar1 * (uint)uVar2));
  if (((lpMem == (ulonglong *)0x0) || (lpMem_00 == (ulonglong *)0x0)) || (local_48 == (LPVOID)0x0))
  {
    FUN_180057b10();
    pvVar3 = local_48;
    if (local_48 != (LPVOID)0x0) {
      pvVar8 = GetProcessHeap();
      HeapFree(pvVar8,8,pvVar3);
      local_48 = (LPVOID)0x0;
    }
    if (lpMem != (ulonglong *)0x0) {
      pvVar8 = GetProcessHeap();
      HeapFree(pvVar8,8,lpMem);
    }
    if (lpMem_00 != (ulonglong *)0x0) {
      pvVar8 = GetProcessHeap();
      HeapFree(pvVar8,8,lpMem_00);
    }
    *(undefined4 *)(param_4 + 4) = 1;
    *param_6 = 0;
  }
  else {
    memset(local_48,0,
           (longlong)(int)((uint)*(ushort *)(param_3 + 0x2c) * (uint)*(ushort *)(param_3 + 0x2a)));
    uVar4 = DAT_1800b1850;
    pvVar3 = DAT_1800b1848;
    iVar11 = 0;
    puVar9 = lpMem;
    iVar6 = iVar11;
    if (*(short *)(param_3 + 0x24) != 0) {
      do {
        if (uVar4 <= *puVar9) break;
        iVar10 = iVar6 + 1;
        *puVar9 = (longlong)(*(int *)(param_3 + 8) * iVar6) + (longlong)pvVar3;
        puVar9 = puVar9 + 1;
        iVar6 = iVar10;
      } while (iVar10 < (int)(uint)*(ushort *)(param_3 + 0x24));
    }
    uVar4 = DAT_1800b1860;
    pvVar3 = DAT_1800b1858;
    puVar9 = lpMem_00;
    if (*(short *)(param_3 + 0x28) != 0) {
      do {
        if (uVar4 <= *puVar9) break;
        iVar6 = *(int *)(param_3 + 8) * iVar11;
        iVar11 = iVar11 + 1;
        *puVar9 = (longlong)iVar6 + (longlong)pvVar3;
        puVar9 = puVar9 + 1;
      } while (iVar11 < (int)(uint)*(ushort *)(param_3 + 0x28));
    }
    iVar6 = *(int *)(param_7 + 0x6c);
    if (iVar6 == 0) {
      local_40 = 0;
    }
    else {
      if (iVar6 == 1) {
        local_40 = 0x300000000;
      }
      else {
        if (iVar6 == 2) {
          local_40 = 0x400000000;
        }
        else {
          if (iVar6 == 3) {
            local_40 = 0x200000000;
          }
          else {
            if (iVar6 == 4) {
              local_40 = 0x100000000;
            }
            else {
              if (iVar6 == 5) {
                local_40 = 0x500000000;
              }
              else {
                uVar7 = 0xffffffff;
                if (iVar6 == 6) {
                  uVar7 = 0xc;
                }
                local_40 = (ulonglong)uVar7 << 0x20;
              }
            }
          }
        }
      }
    }
    local_40 = local_40 | *(uint *)(param_3 + 0x2a);
    local_38._0_4_ = CONCAT22(*(undefined2 *)(param_3 + 0x28),*(undefined2 *)(param_3 + 0x24));
    local_38 = local_38 & 0xffffffff00000000 | (ulonglong)(uint)local_38;
    local_30 = lpMem;
    local_28 = lpMem_00;
    cVar5 = FUN_18005bfa0(&local_40,&local_58);
    pvVar3 = DAT_1800b1848;
    *(undefined2 *)(param_4 + 0x14) = (undefined2)local_58;
    *(undefined2 *)(param_4 + 0x16) = local_58._2_2_;
    *(undefined2 *)(param_4 + 0x18) = local_58._4_2_;
    *(undefined4 *)(param_4 + 8) = (undefined4)local_50;
    *(uint *)(param_4 + 0xc) = (cVar5 != '\x01') + 1;
    if (pvVar3 != (LPVOID)0x0) {
      pvVar8 = GetProcessHeap();
      HeapFree(pvVar8,8,pvVar3);
      DAT_1800b1848 = (LPVOID)0x0;
      DAT_1800b1850 = 0;
    }
    pvVar3 = DAT_1800b1858;
    if (DAT_1800b1858 != (LPVOID)0x0) {
      pvVar8 = GetProcessHeap();
      HeapFree(pvVar8,8,pvVar3);
      DAT_1800b1858 = (LPVOID)0x0;
      DAT_1800b1860 = 0;
    }
    pvVar3 = local_48;
    if (local_48 != (LPVOID)0x0) {
      pvVar8 = GetProcessHeap();
      HeapFree(pvVar8,8,pvVar3);
      local_48 = (LPVOID)0x0;
    }
    pvVar8 = GetProcessHeap();
    HeapFree(pvVar8,8,lpMem);
    pvVar8 = GetProcessHeap();
    HeapFree(pvVar8,8,lpMem_00);
  }
  return;
}



undefined8 * FUN_180058010(undefined8 *param_1)

{
  int *piVar1;

  FUN_18005e1d0(param_1);
  *(undefined4 *)(param_1 + 1) = 2;
  *param_1 = InternalVersionChain::vftable;
  if (param_1 + 4 == (undefined8 *)0x0) {
    piVar1 = _errno();
    *piVar1 = 0x16;
    _invalid_parameter_noinfo();
    return param_1;
  }
  param_1[4] = 0x650074006e0049;
  return param_1;
}



undefined8
FUN_180058070(undefined param_1,undefined param_2,undefined param_3,undefined param_4,
             longlong param_5)

{
  *(undefined4 *)(param_5 + 8) = 0x776f6c46;
  *(undefined4 *)(param_5 + 0xc) = 0x2e31565f;
  *(undefined4 *)(param_5 + 0x10) = 0x20302e31;
  *(undefined4 *)(param_5 + 0x14) = 0x65736142;
  *(undefined8 *)(param_5 + 0x18) = 0x323630363130325f;
  *(undefined *)(param_5 + 0x20) = 0x32;
  FUN_18003d660((longlong)"%s %d Get Internal version %s","ProcessCore",0x17,
                "Flow_V1.1.0 Base_20160622");
  return 1;
}



undefined8 * FUN_1800580d0(undefined8 *param_1)

{
  undefined8 *puVar1;
  int *piVar2;
  ulonglong uVar3;
  undefined4 local_38;
  undefined4 uStack52;
  undefined4 uStack48;
  undefined4 uStack44;
  undefined4 local_28;
  undefined4 uStack36;
  undefined4 uStack32;
  undefined4 uStack28;
  undefined8 local_18;
  undefined4 local_10;
  undefined2 local_c;

  FUN_18005e1d0(param_1);
  *(undefined4 *)(param_1 + 1) = 0x3a;
  *param_1 = ParametersSettingChain::vftable;
  uVar3 = 0xffffffffffffffff;
  local_10 = 0x6e0069;
  local_c = 0;
  local_38 = 0x610050;
  uStack52 = 0x610072;
  uStack48 = 0x65006d;
  uStack44 = 0x650074;
  local_18 = 0x61006800430067;
  local_28 = 0x730072;
  uStack36 = 0x650053;
  uStack32 = 0x740074;
  uStack28 = 0x6e0069;
  do {
    uVar3 = uVar3 + 1;
  } while (*(short *)((longlong)&local_38 + uVar3 * 2) != 0);
  puVar1 = param_1 + 4;
  if (uVar3 != 0) {
    if (puVar1 == (undefined8 *)0x0) {
      piVar2 = _errno();
      *piVar2 = 0x16;
    }
    else {
      if (uVar3 < 0x21) {
        memcpy_FUN_180061f90(puVar1,(undefined8 *)&local_38,uVar3);
        goto LAB_180058190;
      }
      *puVar1 = 0;
      param_1[5] = 0;
      param_1[6] = 0;
      param_1[7] = 0;
      piVar2 = _errno();
      *piVar2 = 0x22;
    }
    _invalid_parameter_noinfo();
  }
LAB_180058190:
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"ParametersSettingChain.cpp",
             (undefined *)L"ParametersSettingChain::ParametersSettingChain",0xd,0,
             (undefined *)L"Engine test: ParametersSetting chain init");
  return param_1;
}



undefined8
FUN_1800581e0(undefined8 param_1,undefined8 param_2,longlong param_3,longlong param_4,
             longlong param_5)

{
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"ParametersSettingChain.cpp",
             (undefined *)L"ParametersSettingChain::ProcessCore",0x1a,0,
             (undefined *)L"ParametersSettingChain Entry");
  *(undefined *)(*(longlong *)(param_3 + 0x38) + 0x7e) = *(undefined *)(param_4 + 4);
  *(undefined4 *)(param_5 + 4) = 0;
  return 1;
}



undefined8 * FUN_180058260(undefined8 *param_1)

{
  int *piVar1;
  undefined4 local_res8;
  undefined4 local_resc;

  FUN_18005e1d0(param_1);
  *(undefined4 *)(param_1 + 1) = 0x1d;
  *param_1 = PerformanceChain::vftable;
  if (param_1 + 4 == (undefined8 *)0x0) {
    piVar1 = _errno();
    *piVar1 = 0x16;
    _invalid_parameter_noinfo();
  }
  else {
    param_1[4] = 0x66007200650050;
  }
  local_res8 = 3;
  param_1[0xe] = &LAB_180058560;
  local_resc = 0x1d;
  param_1[0xc] = &LAB_1800585d0;
  FUN_18005eb40((undefined2 *)&local_res8,&LAB_1800582f0);
  return param_1;
}



ulonglong FUN_180058550(undefined8 param_1,longlong param_2)

{
  return (ulonglong)*(uint *)(param_2 + 4);
}



undefined8 * FUN_1800585f0(undefined8 *param_1)

{
  int *piVar1;

  FUN_18005e1d0(param_1);
  *(undefined4 *)(param_1 + 1) = 0x17;
  *param_1 = PixelOpenShortChain::vftable;
  if (param_1 + 4 == (undefined8 *)0x0) {
    piVar1 = _errno();
    *piVar1 = 0x16;
    _invalid_parameter_noinfo();
  }
  else {
    param_1[4] = 0x65007800690050;
  }
  param_1[0xc] = FUN_1800586c0;
  param_1[0xe] = FUN_180058680;
  param_1[0x10] = &LAB_180058870;
  param_1[0x11] = &LAB_1800587e0;
  param_1[0xf] = 0;
  param_1[0xd] = 0;
  return param_1;
}



void FUN_180058680(undefined8 param_1,HANDLE *param_2,longlong param_3,undefined8 param_4,
                  undefined8 param_5,undefined4 *param_6)

{
  ulonglong uVar1;

  *param_6 = 1;
  uVar1 = FUN_180058a90(param_2,3,DAT_1800b1870,*(DWORD *)(param_3 + 8));
  if ((int)uVar1 < 0) {
    *param_6 = 0;
  }
  return;
}



void FUN_1800586c0(undefined8 param_1,HANDLE *param_2,longlong param_3,longlong param_4,
                  undefined8 param_5,undefined4 *param_6)

{
  uint uVar1;
  LPVOID pvVar2;
  HANDLE pvVar3;
  ulonglong uVar4;

  *param_6 = 1;
  FUN_1800587f0();
  uVar1 = *(uint *)(param_3 + 8);
  pvVar3 = GetProcessHeap();
  DAT_1800b1868 = HeapAlloc(pvVar3,8,(ulonglong)uVar1);
  uVar1 = *(uint *)(param_3 + 8);
  pvVar3 = GetProcessHeap();
  DAT_1800b1870 = HeapAlloc(pvVar3,8,(ulonglong)uVar1);
  pvVar2 = DAT_1800b1868;
  if (DAT_1800b1868 != (LPVOID)0x0) {
    if (DAT_1800b1870 != (LPVOID)0x0) {
      uVar4 = FUN_180058a90(param_2,3,DAT_1800b1868,*(DWORD *)(param_3 + 8));
      if (-1 < (int)uVar4) {
        return;
      }
      goto LAB_1800587b9;
    }
    pvVar3 = GetProcessHeap();
    HeapFree(pvVar3,8,pvVar2);
    DAT_1800b1868 = (LPVOID)0x0;
  }
  pvVar2 = DAT_1800b1870;
  if (DAT_1800b1870 != (LPVOID)0x0) {
    pvVar3 = GetProcessHeap();
    HeapFree(pvVar3,8,pvVar2);
    DAT_1800b1870 = (LPVOID)0x0;
  }
  *(undefined4 *)(param_4 + 4) = 1;
LAB_1800587b9:
  *param_6 = 0;
  return;
}



void FUN_1800587f0(void)

{
  LPVOID pvVar1;
  HANDLE pvVar2;

  pvVar1 = DAT_1800b1868;
  if (DAT_1800b1868 != (LPVOID)0x0) {
    pvVar2 = GetProcessHeap();
    HeapFree(pvVar2,8,pvVar1);
    DAT_1800b1868 = (LPVOID)0x0;
  }
  pvVar1 = DAT_1800b1870;
  if (DAT_1800b1870 != (LPVOID)0x0) {
    pvVar2 = GetProcessHeap();
    HeapFree(pvVar2,8,pvVar1);
    DAT_1800b1870 = (LPVOID)0x0;
  }
  return;
}



ulonglong FUN_180058860(undefined8 param_1,longlong param_2,longlong param_3)

{
  *(undefined4 *)(param_3 + 0xc) = 0;
  return (ulonglong)*(uint *)(param_2 + 0xc);
}



ulonglong FUN_1800589e0(longlong *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
                       longlong param_5,undefined8 param_6,undefined8 param_7)

{
  longlong lVar1;
  int iVar2;
  ulonglong uVar3;
  uint local_res8 [2];

  lVar1 = param_5;
  local_res8[0] = 1;
  iVar2 = (**(code **)(*param_1 + 8))(param_1,param_4,param_5);
  if (((ulonglong)(longlong)iVar2 < 0x50) && ((code *)param_1[(longlong)iVar2 + 0xc] != (code *)0x0)
     ) {
    (*(code *)param_1[(longlong)iVar2 + 0xc])
              (param_2,param_3,param_4,lVar1,param_6,local_res8,param_7);
    uVar3 = (ulonglong)local_res8[0];
  }
  else {
    *(undefined4 *)(lVar1 + 4) = 0xc000000d;
    uVar3 = 0;
  }
  return uVar3;
}



ulonglong FUN_180058a90(HANDLE *param_1,undefined4 param_2,LPVOID param_3,DWORD param_4)

{
  BOOL BVar1;
  DWORD DVar2;
  uint uVar3;
  DWORD local_res8 [2];
  undefined4 local_res10 [2];
  _OVERLAPPED local_38;

  local_res8[0] = 0;
  local_38.Internal = 0;
  local_38.InternalHigh = 0;
  local_38.u = 0;
  local_38.hEvent = (HANDLE)0x0;
  local_res10[0] = param_2;
  if (param_1 == (HANDLE *)0x0) {
    uVar3 = 0x80004003;
  }
  else {
    local_38.hEvent = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCWSTR)0x0);
    if (local_38.hEvent == (HANDLE)0x0) {
      return 0x8007000e;
    }
    BVar1 = DeviceIoControl(*param_1,0x442110,local_res10,4,param_3,param_4,local_res8,
                            (LPOVERLAPPED)&local_38);
    uVar3 = 0;
    if (BVar1 == 0) {
      DVar2 = GetLastError();
      if (DVar2 == 0x3e5) {
        SetLastError(0);
        BVar1 = GetOverlappedResult(*param_1,(LPOVERLAPPED)&local_38,local_res8,1);
        uVar3 = 0;
        if (BVar1 != 0) goto LAB_180058b7e;
      }
      uVar3 = 0x80004005;
    }
  }
LAB_180058b7e:
  if (local_38.hEvent != (HANDLE)0x0) {
    CloseHandle(local_38.hEvent);
  }
  return (ulonglong)uVar3;
}



void FUN_180058ba0(undefined4 *param_1)

{
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"test_processor.cpp",
             (undefined *)L"__FRRFARTest_DeleteTemplate",0x2b,0,
             (undefined *)L"__FRRFARTest_DeleteTemplate Enter");
  if (DAT_1800b1888 != (void **)0x0) {
    templateDelete(DAT_1800b1888);
    DAT_1800b1888 = (void **)0x0;
  }
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"test_processor.cpp",
             (undefined *)L"__FRRFARTest_DeleteTemplate",0x31,0,
             (undefined *)L"__FRRFARTest_DeleteTemplate Enter");
  *param_1 = 0;
  return;
}



void FUN_180058c90(uint *param_1)

{
  *param_1 = (uint)(DAT_1800b1888 != 0);
  return;
}



void FUN_180058ca0(undefined4 *param_1,uint *param_2,uint param_3,longlong *param_4,byte param_5,
                  int *param_6,undefined4 *param_7,undefined *param_8,ulonglong param_9,
                  char param_10)

{
  int *piVar1;
  undefined4 *puVar2;
  undefined *puVar3;
  uint *puVar4;
  ulonglong uVar5;
  undefined8 uVar6;
  uint local_res10;
  uint local_res14;

  puVar3 = param_8;
  puVar2 = param_7;
  *param_8 = 0;
  *param_7 = 1;
  puVar4 = (uint *)FUN_18004cea0(4);
  *puVar4 = 0x28;
  if (param_2 == (uint *)0x0) {
LAB_180058dc7:
    if (DAT_1800b1888 != (void **)0x0) {
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"test_processor.cpp",
                 (undefined *)L"__FRRFARTest_IdentityImage",0x5f,0,
                 (undefined *)
                 L"==========================Call identifyImage===========================");
      uVar6 = identifyImage(param_4,(longlong **)&DAT_1800b1888,1,(uint *)&param_8,(int *)&param_7,
                            &local_res10,0,param_5,param_9,param_10);
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"test_processor.cpp",
                 (undefined *)L"__FRRFARTest_IdentityImage",0x61,0,
                 (undefined *)L"__FRRFARTest_IdentityImage identifyImage result = %d, score = %d");
      piVar1 = param_6;
      if ((int)uVar6 == 0x83) {
        *puVar2 = 5;
        debug_print_FUN_18003fc70
                  ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"test_processor.cpp",
                   (undefined *)L"__FRRFARTest_IdentityImage",0x65,0,
                   (undefined *)L"identify error, alg_ret == GX_ALGO_UNSUPPORT");
      }
      else {
        if ((int)uVar6 == 0x84) {
          *param_1 = 0x80098005;
          debug_print_FUN_18003fc70
                    ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"test_processor.cpp",
                     (undefined *)L"__FRRFARTest_IdentityImage",0x6d,0,
                     (undefined *)L"bioassay failed");
          return;
        }
        if (local_res10 < DAT_1800b0209) {
          *puVar2 = 6;
        }
        else {
          if (DAT_1800b0208 <= local_res14) {
            if ((int)param_8 < 0) {
              *puVar2 = 5;
              debug_print_FUN_18003fc70
                        ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"test_processor.cpp",
                         (undefined *)L"__FRRFARTest_IdentityImage",0x82,0,
                         (undefined *)L"identifyImage result < 0, not match, result = %d");
              goto LAB_180059046;
            }
            if (0 < (int)param_7) {
              templateStudy(param_6);
              if (1 < *piVar1) {
                identifyUpdate();
              }
              debug_print_FUN_18003fc70
                        ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"test_processor.cpp",
                         (undefined *)L"__FRRFARTest_IdentityImage",0x93,0,
                         (undefined *)L"update = %d, updatesize  = %d");
              *puVar3 = 1;
              *param_1 = 0;
              return;
            }
          }
          *puVar2 = 7;
        }
      }
      goto LAB_180059046;
    }
  }
  else {
    if (DAT_1800b1888 != (void **)0x0) {
      debug_print_FUN_18003fc70
                ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"test_processor.cpp",
                 (undefined *)L"__FRRFARTest_IdentityImage",0x45,0,
                 (undefined *)L"templateDelete clean prepar template");
      templateDelete(DAT_1800b1888);
      DAT_1800b1888 = (void **)0x0;
    }
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"test_processor.cpp",
               (undefined *)L"__FRRFARTest_IdentityImage",0x4a,0,
               (undefined *)
               L"==========================Call templateUnPack===========================");
    uVar5 = templateUnPack(param_2,param_3,puVar4,(uint **)&DAT_1800b1888);
    if ((int)uVar5 == 0) goto LAB_180058dc7;
    if (DAT_1800b1888 != (void **)0x0) {
      templateDelete(DAT_1800b1888);
      DAT_1800b1888 = (void **)0x0;
    }
  }
  *puVar2 = 4;
LAB_180059046:
  *param_1 = 1;
  return;
}



void FUN_180059070(undefined4 *param_1)

{
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"test_processor.cpp",
             (undefined *)L"__FRRFARTest_ImportClean",0xd5,0,
             (undefined *)L"__FRRFARTest_ImportClean Enter");
  if (DAT_1800b1898 != (void **)0x0) {
    enrolFinish(DAT_1800b1898);
    DAT_1800b1898 = (void **)0x0;
  }
  DAT_1800b1890 = 0;
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"test_processor.cpp",
             (undefined *)L"__FRRFARTest_ImportClean",0xdc,0,
             (undefined *)L"__FRRFARTest_ImportClean Exit");
  *param_1 = 0;
  return;
}



void FUN_180059120(int *param_1,undefined *param_2)

{
  undefined8 uVar1;

  uVar1 = templatePack(DAT_1800b1890,param_2);
  if ((int)uVar1 != 0) {
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,4,(undefined *)L"test_processor.cpp",
               (undefined *)L"__FRRFARTest_ImportCommit",0xca,0,
               (undefined *)L"__FRRFARTest_ImportCommit templatePack failed, %x");
  }
  *param_1 = (int)uVar1;
  return;
}



void FUN_180059190(undefined4 *param_1,longlong *param_2,uint *param_3,undefined8 param_4,
                  char param_5)

{
  undefined8 uVar1;

  uVar1 = enrolAddImage(DAT_1800b1898,param_2,param_4,param_5,param_3);
  *param_1 = (int)uVar1;
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"test_processor.cpp",
             (undefined *)L"__FRRFARTest_ImportEnroll",0xb4,0,
             (undefined *)L"Import Enroll quality: %u, coverage: %u, enrolAddImage return value: %x"
            );
  return;
}



void FUN_180059220(undefined4 *param_1,uint param_2,undefined2 param_3)

{
  undefined8 uVar1;

  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"test_processor.cpp",
             (undefined *)L"__FRRFARTest_ImportClean",0xd5,0,
             (undefined *)L"__FRRFARTest_ImportClean Enter");
  if (DAT_1800b1898 != (uint **)0x0) {
    enrolFinish(DAT_1800b1898);
    DAT_1800b1898 = (uint **)0x0;
  }
  DAT_1800b1890 = 0;
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"test_processor.cpp",
             (undefined *)L"__FRRFARTest_ImportClean",0xdc,0,
             (undefined *)L"__FRRFARTest_ImportClean Exit");
  *param_1 = 0;
  uVar1 = ppp_param_init(param_2);
  DAT_1800b1898 = enrolStart();
  *(undefined2 *)(DAT_1800b1898 + 1) = param_3;
  *param_1 = (int)uVar1;
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"test_processor.cpp",
             (undefined *)L"__FRRFARTest_ImportStart",0xae,0,
             (undefined *)L"Import Start sensorType: %d, ppp_param_init return value: %x");
  return;
}



void FUN_180059350(int *param_1,undefined4 *param_2)

{
  undefined8 uVar1;
  ulonglong uVar2;

  uVar1 = enrolGetTemplate(DAT_1800b1898,&DAT_1800b1890);
  if ((int)uVar1 != 0) {
    debug_print_FUN_18003fc70
              ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"test_processor.cpp",
               (undefined *)L"__FRRFARTest_ImportTempalteSize",0xbb,0,
               (undefined *)L"GetImportTempalte enrolGetTemplate return value: %x");
    *param_1 = (int)uVar1;
    return;
  }
  uVar2 = templateGetPackedSize(DAT_1800b1890);
  *param_2 = (int)uVar2;
  *param_1 = 0;
  return;
}



undefined8 * WBDICapturedataReceiverChain_FUN_180059400(undefined8 *param_1)

{
  undefined8 *puVar1;
  int *piVar2;
  ulonglong uVar3;
  undefined4 local_48;
  undefined4 uStack68;
  undefined4 uStack64;
  undefined4 uStack60;
  undefined4 local_38;
  undefined4 uStack52;
  undefined4 uStack48;
  undefined4 uStack44;
  undefined4 local_28;
  undefined4 uStack36;
  undefined4 uStack32;
  undefined4 uStack28;
  undefined8 local_18;
  undefined2 local_10;

  FUN_18005e1d0(param_1);
  *(undefined4 *)(param_1 + 1) = 0x8fff;
  *param_1 = WBDICaptureDataReceiverChain::vftable;
  uVar3 = 0xffffffffffffffff;
  local_10 = 0;
  local_48 = 0x420057;
  uStack68 = 0x490044;
  uStack64 = 0x610043;
  uStack60 = 0x740070;
  local_38 = 0x720075;
  uStack52 = 0x440065;
  uStack48 = 0x740061;
  uStack44 = 0x520061;
  local_28 = 0x630065;
  uStack36 = 0x690065;
  uStack32 = 0x650076;
  uStack28 = 0x430072;
  local_18 = 0x6e006900610068;
  do {
    uVar3 = uVar3 + 1;
  } while (*(short *)((longlong)&local_48 + uVar3 * 2) != 0);
  puVar1 = param_1 + 4;
  if (uVar3 != 0) {
    if (puVar1 == (undefined8 *)0x0) {
      piVar2 = _errno();
      *piVar2 = 0x16;
    }
    else {
      if (uVar3 < 0x21) {
        memcpy_FUN_180061f90(puVar1,(undefined8 *)&local_48,uVar3);
        goto LAB_1800594cc;
      }
      *puVar1 = 0;
      param_1[5] = 0;
      param_1[6] = 0;
      param_1[7] = 0;
      piVar2 = _errno();
      *piVar2 = 0x22;
    }
    _invalid_parameter_noinfo();
  }
LAB_1800594cc:
  debug_print_FUN_18003fc70
            ((longlong)PTR_DAT_1800afca8,8,(undefined *)L"WBDICaptureDataReceiverChain.cpp",
             (undefined *)L"WBDICaptureDataReceiverChain::WBDICaptureDataReceiverChain",0xb,0,
             (undefined *)L"Engine test: WBDICaptureDataReceiver chain init");
  return param_1;
}



undefined8
FUN_180059520(undefined8 param_1,undefined8 param_2,longlong param_3,longlong param_4,
             longlong param_5,undefined8 *param_6)

{
  undefined4 uVar1;
  longlong local_res20;

  uVar1 = FUN_180041ed0(param_3,(undefined8 *)(param_4 + 8),
                        (longlong *)(ulonglong)*(uint *)(param_4 + 4),4,&local_res20);
  *(undefined4 *)(param_5 + 4) = uVar1;
  *param_6 = 0x2c8;
  return 1;
}



undefined8
FUN_180059570(longlong param_1,longlong param_2,longlong param_3,longlong param_4,longlong param_5)

{
  size_t _Size;
  short sVar1;
  int iVar2;
  void *_Memory;
  void *_Memory_00;
  void *_Memory_01;
  ulonglong uVar3;
  undefined8 extraout_RAX;
  void *extraout_RAX_00;
  byte bVar4;
  short sVar5;
  short sVar6;
  int iVar7;
  longlong lVar8;
  longlong lVar9;
  longlong lVar10;
  ulonglong uVar11;
  longlong lVar12;
  int iVar13;
  short sVar14;
  int iVar15;
  size_t _Size_00;
  ulonglong uVar16;
  short sVar17;
  longlong lVar18;
  ulonglong uVar19;
  ulonglong uVar20;
  ushort uVar21;
  short sVar22;
  int iVar23;
  longlong lVar24;
  int iVar25;
  short local_98;
  uint local_94;
  longlong local_80;
  ulonglong local_60;
  longlong local_50;

  iVar2 = (int)(short)DAT_1800b18a0;
  iVar7 = (int)(short)DAT_1800b18a4;
  local_80 = 0;
  local_50 = 0;
  if (((((param_1 != 0) && (param_2 != 0)) && (param_3 != 0)) && ((param_4 != 0 && (param_5 != 0))))
     && (*(longlong *)(param_5 + 0x10) != 0)) {
    iVar13 = iVar2 + 2;
    _Size = (longlong)(iVar7 + 2) * (longlong)iVar13 * 2;
    _Memory = malloc(_Size);
    _Size_00 = SEXT48(iVar2 * iVar7);
    _Memory_00 = malloc(_Size_00 * 8);
    _Memory_01 = malloc(_Size_00);
    if (_Memory != (void *)0x0) {
      if ((_Memory_00 != (void *)0x0) && (_Memory_01 != (void *)0x0)) {
        memset(_Memory,0,_Size);
        memset(_Memory_00,0,_Size_00 * 8);
        memset(_Memory_01,0,_Size_00);
        if (0 < (short)DAT_1800b18a0) {
          lVar12 = 0;
          uVar16 = (ulonglong)DAT_1800b18a0;
          uVar21 = DAT_1800b18a4;
          do {
            if (0 < (short)uVar21) {
              memcpy_FUN_180061f90
                        ((undefined8 *)
                         ((longlong)_Memory + ((lVar12 + 1) * ((longlong)(short)uVar21 + 2) + 1) * 2
                         ),(undefined8 *)(param_2 + lVar12 * (short)uVar21 * 2),
                         (ulonglong)uVar21 * 2);
              uVar21 = DAT_1800b18a4;
            }
            lVar12 = lVar12 + 1;
            uVar16 = uVar16 - 1;
          } while (uVar16 != 0);
        }
        iVar2 = (short)DAT_1800b18a4 + 1;
        sVar17 = 1;
        if (iVar2 < 2) {
          uVar16 = (ulonglong)DAT_1800b18a4;
        }
        else {
          uVar16 = SEXT28((short)DAT_1800b18a4);
          lVar12 = (longlong)(short)DAT_1800b18a0;
          do {
            lVar8 = (longlong)sVar17;
            sVar17 = sVar17 + 1;
            *(undefined2 *)((longlong)_Memory + lVar8 * 2) =
                 *(undefined2 *)((longlong)_Memory + (lVar8 + uVar16) * 2 + 4);
            *(undefined2 *)((longlong)_Memory + ((lVar12 + 1) * (uVar16 + 2) + lVar8) * 2) =
                 *(undefined2 *)((longlong)_Memory + (lVar12 * (uVar16 + 2) + lVar8) * 2);
          } while (sVar17 < iVar2);
        }
        sVar17 = 0;
        if (0 < iVar13) {
          do {
            lVar12 = (longlong)sVar17;
            sVar17 = sVar17 + 1;
            lVar12 = lVar12 * ((longlong)(short)uVar16 + 2);
            *(undefined2 *)((longlong)_Memory + lVar12 * 2) =
                 *(undefined2 *)((longlong)_Memory + lVar12 * 2 + 2);
            lVar12 = lVar12 + (short)uVar16;
            *(undefined2 *)((longlong)_Memory + lVar12 * 2 + 2) =
                 *(undefined2 *)((longlong)_Memory + lVar12 * 2);
          } while (sVar17 < iVar13);
        }
        uVar3 = 0;
        iVar7 = (int)(short)DAT_1800b18a0;
        local_60 = 0;
        local_94 = 0;
        local_98 = 1;
        uVar20 = uVar3;
        if (1 < iVar7 + 1) {
          do {
            sVar17 = 1;
            if (1 < iVar2) {
              lVar12 = (longlong)local_98;
              do {
                lVar18 = (longlong)sVar17;
                lVar8 = (lVar12 + -1) * (longlong)(short)uVar16 + lVar18;
                if (*(char *)(lVar8 + -1 + param_3) != '\x01') {
                  lVar10 = (longlong)(short)uVar16 + 2;
                  lVar24 = (lVar12 + -1) * lVar10 + lVar18;
                  iVar13 = (int)*(short *)((longlong)_Memory + lVar24 * 2 + 2);
                  iVar15 = (int)*(short *)((longlong)_Memory + lVar24 * 2 + -2);
                  lVar9 = lVar10 * lVar12 + lVar18;
                  lVar18 = lVar18 + (lVar12 + 1) * lVar10;
                  iVar23 = (int)*(short *)((longlong)_Memory + lVar18 * 2 + 2);
                  iVar25 = (int)*(short *)((longlong)_Memory + lVar18 * 2 + -2);
                  lVar10 = (longlong)
                           (((((int)*(short *)((longlong)_Memory + lVar9 * 2 + -2) -
                              (int)*(short *)((longlong)_Memory + lVar9 * 2 + 2)) * 2 - iVar23) -
                            iVar13) + iVar25 + iVar15);
                  lVar18 = (longlong)
                           (((((int)*(short *)((longlong)_Memory + lVar24 * 2) -
                              (int)*(short *)((longlong)_Memory + lVar18 * 2)) * 2 - iVar23) -
                            iVar25) + iVar13 + iVar15);
                  bVar4 = 0x1f;
                  uVar19 = lVar18 * lVar18 + lVar10 * lVar10;
                  uVar11 = 0x80000000;
                  uVar20 = uVar19;
                  uVar3 = 0;
                  if (1 < uVar19) {
                    do {
                      uVar19 = uVar3;
                      uVar3 = uVar11 + uVar19 * 2 << (bVar4 & 0x3f);
                      bVar4 = bVar4 - 1;
                      if (uVar3 <= uVar20) {
                        uVar19 = uVar19 + uVar11;
                        uVar20 = uVar20 - uVar3;
                      }
                      uVar11 = uVar11 >> 1;
                      uVar3 = uVar19;
                    } while (uVar11 != 0);
                  }
                  uVar20 = local_60 + uVar19;
                  local_94 = local_94 + 1;
                  uVar3 = (ulonglong)local_94;
                  *(ulonglong *)((longlong)_Memory_00 + lVar8 * 8 + -8) = uVar19;
                  local_60 = uVar20;
                }
                sVar17 = sVar17 + 1;
              } while (sVar17 < iVar2);
            }
            uVar16 = (ulonglong)DAT_1800b18a4;
            local_98 = local_98 + 1;
          } while ((int)local_98 < iVar7 + 1);
        }
        sVar1 = DAT_1800b18b4;
        sVar14 = DAT_1800b18b0;
        sVar17 = DAT_1800b18ac;
        sVar22 = 0;
        if (0 < (short)DAT_1800b18a0) {
          iVar2 = (int)(short)DAT_1800b18a4;
          uVar21 = DAT_1800b18a4;
          do {
            sVar6 = 0;
            if (0 < (short)uVar21) {
              do {
                lVar12 = (longlong)((int)sVar6 + sVar22 * iVar2);
                if ((((*(char *)(lVar12 + param_3) != '\x01') && (DAT_1800b18a8 <= sVar22)) &&
                    (sVar22 < sVar14)) &&
                   (((sVar17 <= sVar6 && (sVar6 < sVar1)) &&
                    (uVar16 = *(longlong *)((longlong)_Memory_00 + lVar12 * 8) *
                              (longlong)(int)uVar3,
                    uVar20 * 3 <= uVar16 && uVar16 + uVar20 * -3 != 0)))) {
                  *(undefined *)(lVar12 + (longlong)_Memory_01) = 1;
                }
                uVar3 = (ulonglong)local_94;
                sVar6 = sVar6 + 1;
                uVar21 = DAT_1800b18a4;
              } while (sVar6 < (short)DAT_1800b18a4);
            }
            uVar3 = (ulonglong)local_94;
            sVar22 = sVar22 + 1;
          } while (sVar22 < (short)DAT_1800b18a0);
        }
        uVar20 = 0;
        free(_Memory);
        free(_Memory_00);
        lVar12 = 0;
        sVar17 = 0;
        uVar16 = uVar20;
        uVar21 = DAT_1800b18a4;
        if (0 < (short)DAT_1800b18a0) {
          do {
            sVar14 = 0;
            if (0 < (short)uVar21) {
              lVar8 = *(longlong *)(param_5 + 0x10);
              lVar18 = (short)uVar21 * lVar12;
              do {
                if ((*(char *)(lVar18 + lVar8) == '\x01') ||
                   (*(char *)(lVar18 + (longlong)_Memory_01) == '\x01')) {
                  uVar3 = FUN_18005bf00(lVar8,sVar17,sVar14);
                  if ((int)uVar20 < (int)uVar3) {
                    uVar20 = uVar3 & 0xffffffff;
                  }
                  uVar3 = FUN_18005bf00((longlong)_Memory_01,sVar17,sVar14);
                  uVar21 = DAT_1800b18a4;
                  if ((int)uVar16 < (int)uVar3) {
                    uVar16 = uVar3 & 0xffffffff;
                  }
                }
                sVar14 = sVar14 + 1;
                lVar18 = lVar18 + 1;
              } while (sVar14 < (short)uVar21);
            }
            sVar17 = sVar17 + 1;
            lVar12 = lVar12 + 1;
          } while (sVar17 < (short)DAT_1800b18a0);
          if ((4 < (int)uVar20) || (4 < (int)uVar16)) {
            iVar2 = 0;
            iVar7 = 0;
            sVar17 = 0;
            do {
              sVar14 = 0;
              if (0 < (short)uVar21) {
                do {
                  lVar12 = (longlong)((int)sVar14 + (int)sVar17 * (int)(short)DAT_1800b18a4);
                  if ((((*(char *)(lVar12 + param_3) != '\x01') && (DAT_1800b18a8 <= sVar17)) &&
                      (sVar17 < DAT_1800b18b0)) &&
                     ((DAT_1800b18ac <= sVar14 && (sVar14 < DAT_1800b18b4)))) {
                    if ((*(char *)(lVar12 + *(longlong *)(param_5 + 0x10)) == '\x01') ||
                       (*(char *)(lVar12 + (longlong)_Memory_01) == '\x01')) {
                      local_80 = local_80 + *(short *)(param_1 + lVar12 * 2);
                      iVar2 = iVar2 + 1;
                    }
                    else {
                      local_50 = local_50 + *(short *)(param_1 + lVar12 * 2);
                      iVar7 = iVar7 + 1;
                    }
                  }
                  sVar14 = sVar14 + 1;
                  uVar21 = DAT_1800b18a4;
                } while (sVar14 < (short)DAT_1800b18a4);
              }
              sVar17 = sVar17 + 1;
            } while (sVar17 < (short)DAT_1800b18a0);
            if (iVar2 == 0) {
              local_80 = local_80 << 0xc;
            }
            else {
              local_80 = (((longlong)iVar2 >> 1) + local_80 * 0x1000) / (longlong)iVar2;
            }
            local_50 = local_50 * 0x1000;
            if (iVar7 != 0) {
              local_50 = (((longlong)iVar7 >> 1) + local_50) / (longlong)iVar7;
            }
            uVar16 = (ulonglong)DAT_1800b18d4;
            sVar14 = 0;
            sVar17 = DAT_1800b18a8;
            uVar21 = DAT_1800b18a4;
            do {
              local_98 = 0;
              if (0 < (short)uVar21) {
                iVar2 = (int)sVar17;
                uVar21 = DAT_1800b18a4;
                do {
                  sVar22 = DAT_1800b18b4;
                  sVar1 = DAT_1800b18b0;
                  sVar17 = DAT_1800b18ac;
                  iVar7 = (int)sVar14;
                  if (((iVar2 + 2 <= iVar7) && (uVar21 = DAT_1800b18a4, iVar7 < DAT_1800b18b0 + -2))
                     && ((iVar13 = (int)local_98, DAT_1800b18ac + 2 <= iVar13 &&
                         (iVar13 < DAT_1800b18b4 + -2)))) {
                    lVar12 = (longlong)(iVar7 * (short)DAT_1800b18a4 + iVar13);
                    if (((*(char *)(lVar12 + *(longlong *)(param_5 + 0x10)) == '\x01') ||
                        (*(char *)(lVar12 + (longlong)_Memory_01) == '\x01')) &&
                       ((uVar20 = FUN_18005bf00(*(longlong *)(param_5 + 0x10),sVar14,local_98),
                        2 < (int)uVar20 ||
                        (uVar20 = FUN_18005bf00((longlong)_Memory_01,sVar14,local_98),
                        uVar21 = DAT_1800b18a4, 2 < (int)uVar20)))) {
                      sVar6 = sVar14 + -2;
                      local_60 = 5;
                      do {
                        iVar7 = (int)(short)DAT_1800b18a4;
                        sVar5 = local_98 + -2;
                        lVar12 = 5;
                        do {
                          lVar8 = (longlong)((int)sVar5 + sVar6 * iVar7);
                          if ((((*(char *)(lVar8 + param_3) != '\x01') && (DAT_1800b18a8 <= sVar6))
                              && (sVar6 < sVar1)) && ((sVar17 <= sVar5 && (sVar5 < sVar22)))) {
                            lVar18 = (longlong)*(short *)(param_1 + lVar8 * 2) * 0x1000;
                            uVar11 = lVar18 - local_50;
                            uVar20 = lVar18 - local_80;
                            uVar3 = (longlong)uVar20 >> 0x3f;
                            lVar10 = (uVar20 ^ uVar3) - uVar3;
                            uVar20 = (longlong)uVar11 >> 0x3f;
                            lVar9 = (ulonglong)DAT_1800b18d0 * local_80;
                            lVar24 = ((uVar11 ^ uVar20) - uVar20) * 100;
                            lVar18 = lVar10 * 500;
                            if ((lVar18 == lVar9 * 4 ||
                                 SBORROW8(lVar18,lVar9 * 4) != lVar18 + lVar9 * -4 < 0) &&
                               (lVar18 = uVar16 * local_50,
                               SBORROW8(lVar24,lVar18 * 2) == lVar24 + lVar18 * -2 < 0)) {
                              *(undefined *)(lVar8 + *(longlong *)(param_5 + 0x10)) = 1;
                            }
                            if ((lVar10 * 200 <= lVar9) &&
                               ((longlong)(uVar16 * local_50 * 4) <= lVar24)) {
                              *(undefined *)(lVar8 + param_4) = 1;
                            }
                          }
                          sVar5 = sVar5 + 1;
                          lVar12 = lVar12 + -1;
                        } while (lVar12 != 0);
                        sVar6 = sVar6 + 1;
                        local_60 = local_60 + -1;
                        uVar21 = DAT_1800b18a4;
                      } while (local_60 != 0);
                    }
                  }
                  local_98 = local_98 + 1;
                  sVar17 = DAT_1800b18a8;
                } while (local_98 < (short)uVar21);
              }
              sVar14 = sVar14 + 1;
            } while (sVar14 < (short)DAT_1800b18a0);
          }
        }
        free(_Memory_01);
        return CONCAT71((int7)((ulonglong)extraout_RAX >> 8),1);
      }
      free(_Memory);
    }
    if (_Memory_00 != (void *)0x0) {
      free(_Memory_00);
    }
    if (_Memory_01 != (void *)0x0) {
      free(_Memory_01);
      _Memory_01 = extraout_RAX_00;
    }
    return CONCAT71((int7)((ulonglong)_Memory_01 >> 8),0xff);
  }
  return CONCAT71((uint7)(uint3)(int3)(char)(DAT_1800b18a0 >> 8),0xff);
}



undefined8
FUN_180059f50(longlong param_1,longlong param_2,longlong param_3,longlong param_4,uint param_5)

{
  longlong lVar1;
  short sVar2;
  ushort uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  short sVar6;
  int iVar7;
  longlong lVar8;
  void *_Dst;
  undefined8 uVar9;
  longlong lVar10;
  undefined8 extraout_RAX;
  short sVar11;
  longlong lVar12;
  ulonglong uVar13;
  ulonglong uVar14;
  short sVar15;
  short *psVar16;
  longlong lVar17;
  int iVar18;
  short sVar19;
  int iVar20;
  longlong lVar21;
  int iVar22;
  uint uVar23;
  uint uVar24;
  int iVar25;
  short local_res8;

  sVar19 = DAT_1800b18a4;
  uVar3 = DAT_1800b18a0;
  iVar25 = (int)DAT_1800b18a4;
  uVar23 = SEXT24((short)DAT_1800b18a0);
  lVar17 = 0;
  iVar18 = 0;
  if ((((param_1 != 0) && (param_2 != 0)) && (param_3 != 0)) &&
     ((param_4 != 0 && (*(longlong *)(param_4 + 0x10) != 0)))) {
    lVar8 = (longlong)(int)(uVar23 * iVar25);
    _Dst = malloc(lVar8 * 2);
    if (_Dst == (void *)0x0) {
      uVar9 = 0xff;
    }
    else {
      memset(_Dst,0,lVar8 * 2);
      sVar15 = 0;
      if (0 < (short)uVar3) {
        do {
          sVar11 = 0;
          if (0 < sVar19) {
            do {
              lVar21 = (longlong)((int)sVar11 + (int)sVar15 * (int)sVar19);
              if (((*(char *)(lVar21 + param_2) != '\x01') && (DAT_1800b18a8 <= sVar15)) &&
                 ((sVar15 < DAT_1800b18b0 && ((DAT_1800b18ac <= sVar11 && (sVar11 < DAT_1800b18b4)))
                  ))) {
                lVar17 = lVar17 + *(short *)(param_1 + lVar21 * 2);
                iVar18 = iVar18 + 1;
              }
              sVar11 = sVar11 + 1;
            } while (sVar11 < sVar19);
          }
          sVar15 = sVar15 + 1;
        } while (sVar15 < (short)uVar3);
      }
      local_res8 = 0;
      if (0 < (short)uVar3) {
        uVar24 = uVar23;
        do {
          iVar7 = 0;
          sVar19 = 0;
          if (0 < iVar25 + -1) {
            do {
              iVar7 = iVar7 + local_res8 * iVar25;
              if (*(char *)(iVar7 + param_2) != '\x01') {
                lVar21 = (longlong)iVar7 * 2;
                iVar20 = (int)*(short *)(lVar21 + param_1);
                lVar1 = (longlong)(iVar7 + 1) * 2;
                iVar22 = (int)*(short *)(lVar1 + param_1);
                iVar7 = iVar20 - iVar22;
                if (lVar17 == 0) {
                  if (iVar7 < 1) {
                    iVar7 = iVar22 - iVar20;
                  }
                  sVar15 = (short)iVar7 * (short)iVar18 * 100;
                }
                else {
                  if (iVar7 < 1) {
                    iVar7 = iVar22 - iVar20;
                  }
                  sVar15 = (short)(((longlong)(iVar7 * iVar18 * 100) + (lVar17 >> 1)) / lVar17);
                }
                lVar12 = iVar20 * iVar18 - lVar17;
                if (lVar12 < 1) {
                  lVar12 = lVar17 - iVar20 * iVar18;
                }
                lVar10 = iVar22 * iVar18 - lVar17;
                if (lVar10 < 1) {
                  lVar10 = lVar17 - iVar22 * iVar18;
                }
                if (lVar10 < lVar12) {
                  if (*(short *)(lVar21 + (longlong)_Dst) < sVar15) {
                    *(short *)(lVar21 + (longlong)_Dst) = sVar15;
                  }
                  else {
                    *(short *)(lVar21 + (longlong)_Dst) = *(short *)(lVar21 + (longlong)_Dst);
                  }
                }
                else {
                  sVar11 = *(short *)(lVar1 + (longlong)_Dst);
                  if (sVar11 < sVar15) {
                    sVar11 = sVar15;
                  }
                  *(short *)(lVar1 + (longlong)_Dst) = sVar11;
                }
              }
              sVar19 = sVar19 + 1;
              iVar7 = (int)sVar19;
            } while (iVar7 < iVar25 + -1);
            uVar24 = (uint)DAT_1800b18a0;
          }
          local_res8 = local_res8 + 1;
        } while (local_res8 < (short)uVar24);
      }
      sVar19 = DAT_1800b18a4;
      iVar25 = 0;
      local_res8 = 0;
      if (0 < (int)(uVar23 - 1)) {
        do {
          sVar15 = 0;
          if (0 < sVar19) {
            do {
              iVar7 = (int)sVar15 + iVar25 * sVar19;
              if (*(char *)(iVar7 + param_2) != '\x01') {
                lVar21 = (longlong)iVar7 * 2;
                iVar20 = (int)*(short *)(lVar21 + param_1);
                lVar1 = (longlong)(sVar19 + iVar7) * 2;
                iVar22 = (int)*(short *)(lVar1 + param_1);
                iVar7 = iVar20 - iVar22;
                if (lVar17 == 0) {
                  if (iVar7 < 1) {
                    iVar7 = iVar22 - iVar20;
                  }
                  sVar11 = (short)iVar7 * (short)iVar18 * 100;
                }
                else {
                  if (iVar7 < 1) {
                    iVar7 = iVar22 - iVar20;
                  }
                  sVar11 = (short)(((longlong)(iVar7 * iVar18 * 100) + (lVar17 >> 1)) / lVar17);
                }
                lVar12 = iVar20 * iVar18 - lVar17;
                if (lVar12 < 1) {
                  lVar12 = lVar17 - iVar20 * iVar18;
                }
                lVar10 = iVar22 * iVar18 - lVar17;
                if (lVar10 < 1) {
                  lVar10 = lVar17 - iVar22 * iVar18;
                }
                if (lVar10 < lVar12) {
                  if (*(short *)(lVar21 + (longlong)_Dst) < sVar11) {
                    *(short *)(lVar21 + (longlong)_Dst) = sVar11;
                  }
                  else {
                    *(short *)(lVar21 + (longlong)_Dst) = *(short *)(lVar21 + (longlong)_Dst);
                  }
                }
                else {
                  sVar6 = *(short *)(lVar1 + (longlong)_Dst);
                  if (sVar6 < sVar11) {
                    sVar6 = sVar11;
                  }
                  *(short *)(lVar1 + (longlong)_Dst) = sVar6;
                }
              }
              sVar15 = sVar15 + 1;
            } while (sVar15 < sVar19);
          }
          local_res8 = local_res8 + 1;
          iVar25 = (int)local_res8;
        } while (iVar25 < (int)(uVar23 - 1));
      }
      uVar5 = DAT_1800b18c8;
      uVar4 = DAT_1800b18c0;
      sVar11 = DAT_1800b18b0;
      sVar15 = DAT_1800b18a8;
      uVar13 = 0;
      if (0 < lVar8) {
        uVar14 = uVar13;
        do {
          iVar18 = (int)uVar14;
          sVar6 = (short)(iVar18 / (int)sVar19);
          sVar2 = (short)(iVar18 % (int)sVar19);
          if ((((undefined *)(param_3 + uVar13))[param_2 - param_3] != '\x01') &&
             ((((param_5 & 0xfffffffa) != 0 || (param_5 == 4)) ||
              ((sVar15 <= sVar6 &&
               (((sVar6 < sVar11 && (DAT_1800b18ac <= sVar2)) && (sVar2 < DAT_1800b18b4)))))))) {
            sVar6 = *(short *)((longlong)_Dst + uVar13 * 2);
            if (((short)uVar4 < sVar6) &&
               (*(char *)(*(longlong *)(param_4 + 0x10) + uVar13) != '\x01')) {
              *(undefined *)(*(longlong *)(param_4 + 0x10) + uVar13) = 1;
            }
            if ((short)uVar5 < sVar6) {
              *(undefined *)(param_3 + uVar13) = 1;
            }
          }
          uVar13 = uVar13 + 1;
          uVar14 = (ulonglong)(iVar18 + 1);
        } while ((longlong)uVar13 < lVar8);
      }
      sVar2 = DAT_1800b18b4;
      sVar6 = DAT_1800b18ac;
      *(undefined4 *)(param_4 + 8) = 0;
      uVar4 = DAT_1800b18cc;
      if (sVar6 < sVar2) {
        lVar17 = (longlong)sVar6;
        uVar13 = (ulonglong)(ushort)(sVar2 - sVar6);
        do {
          if (sVar15 < sVar11) {
            psVar16 = (short *)((longlong)_Dst + ((longlong)sVar15 * (longlong)sVar19 + lVar17) * 2)
            ;
            uVar14 = (ulonglong)(ushort)(sVar11 - sVar15);
            do {
              if ((short)uVar4 < *psVar16) {
                *(int *)(param_4 + 8) = *(int *)(param_4 + 8) + (int)*psVar16;
              }
              psVar16 = psVar16 + sVar19;
              uVar14 = uVar14 - 1;
            } while (uVar14 != 0);
          }
          lVar17 = lVar17 + 1;
          uVar13 = uVar13 - 1;
        } while (uVar13 != 0);
      }
      free(_Dst);
      uVar9 = CONCAT71((int7)((ulonglong)extraout_RAX >> 8),1);
    }
    return uVar9;
  }
  return CONCAT71((uint7)(uint3)(uVar23 * iVar25 >> 8),0xff);
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18005a4f0(short *param_1,int param_2)

{
  longlong lVar1;
  longlong lVar2;
  ulonglong uVar3;
  short *psVar4;
  short *psVar5;
  ulonglong uVar6;
  ulonglong uVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  longlong lVar12;
  short *psVar13;
  int iVar14;
  longlong lVar15;
  longlong lVar16;
  longlong lVar17;
  uint uVar18;
  short sVar19;
  uint uVar20;
  uint uVar21;
  uint uVar22;
  int iVar23;
  uint uVar24;
  uint uVar27;
  ulonglong uVar28;
  uint uVar29;
  uint uVar30;
  short sVar31;
  int iVar32;
  longlong lVar33;
  uint uVar34;
  int iVar35;
  ulonglong uVar36;
  int iVar37;
  short local_88 [2];
  undefined4 local_84;
  undefined4 local_80;
  ulonglong local_78;
  short *local_70;
  ulonglong local_68;
  ulonglong local_60;
  longlong local_58;
  short local_50;
  longlong local_48;
  undefined local_40 [12];
  int iStack52;
  ulonglong local_30;
  uint uVar25;
  uint uVar26;

  local_30 = DAT_1800b04e8 ^ (ulonglong)local_88;
  uVar28 = 0;
  uVar26 = 0;
  uVar25 = 0;
  uVar24 = 0;
  local_84 = 0;
  local_80 = 0;
  _local_40 = ZEXT816(0);
  if (param_1 != (short *)0x0) {
    if ((param_2 == 0) || (param_2 - 6U < 4)) {
      local_84 = 5;
      local_80 = 5;
    }
    else {
      if (param_2 == 2) {
        local_84 = 6;
        local_80 = 8;
      }
      else {
        if (param_2 - 3U < 2) {
          local_84 = 5;
          local_80 = 4;
        }
        else {
          if (param_2 - 10U < 3) {
            local_84 = 8;
            local_80 = 10;
          }
        }
      }
    }
    uVar27 = 0;
    sVar19 = (short)local_80;
    local_88[0] = DAT_1800b18a4 - sVar19;
    sVar31 = (short)local_84;
    local_50 = DAT_1800b18a0 - sVar31;
    lVar33 = (longlong)local_50;
    lVar1 = (longlong)sVar31;
    local_68 = local_68 & 0xffffffff00000000;
    uVar34 = uVar27;
    uVar18 = uVar25;
    if (lVar1 < lVar33) {
      lVar2 = lVar1;
      uVar29 = uVar27;
      uVar21 = uVar24;
      uVar34 = uVar26;
      if (1 < lVar33 - lVar1) {
        lVar15 = (longlong)DAT_1800b18a4;
        psVar13 = param_1 + lVar15 * lVar1 + (longlong)sVar19;
        lVar12 = ((lVar33 - sVar31) - 2U >> 1) + 1;
        uVar34 = (int)lVar12 * 2;
        lVar2 = lVar1 + lVar12 * 2;
        uVar3 = uVar28;
        uVar36 = uVar28;
        do {
          uVar21 = (int)uVar3 + (int)*psVar13;
          uVar3 = (ulonglong)uVar21;
          psVar5 = psVar13 + lVar15;
          psVar13 = psVar13 + lVar15 * 2;
          uVar29 = (int)uVar36 + (int)*psVar5;
          uVar36 = (ulonglong)uVar29;
          lVar12 = lVar12 + -1;
        } while (lVar12 != 0);
      }
      uVar18 = uVar27;
      if (lVar2 < lVar33) {
        uVar34 = uVar34 + 1;
        uVar18 = SEXT24(param_1[DAT_1800b18a4 * lVar2 + (longlong)sVar19]);
      }
      uVar18 = uVar18 + uVar29 + uVar21;
    }
    local_78 = local_78 & 0xffffffff00000000;
    local_70 = (short *)((ulonglong)local_70 & 0xffffffff00000000);
    local_48 = (longlong)sVar19;
    if (local_48 != 0) {
      uVar29 = SEXT24(DAT_1800b18a0);
      local_60 = local_60 & 0xffffffff00000000;
      uVar3 = uVar28;
      uVar36 = uVar28;
      do {
        local_78._0_4_ = (int)uVar3;
        uVar21 = uVar25;
        uVar30 = uVar25;
        if (lVar1 < lVar33) {
          lVar2 = lVar1;
          uVar22 = uVar24;
          uVar20 = uVar24;
          uVar21 = uVar26;
          if (1 < lVar33 - lVar1) {
            lVar12 = (longlong)DAT_1800b18a4;
            psVar13 = param_1 + lVar12 * lVar1 + uVar36;
            lVar15 = ((lVar33 - sVar31) - 2U >> 1) + 1;
            uVar21 = (int)lVar15 * 2;
            lVar2 = lVar1 + lVar15 * 2;
            uVar3 = uVar28;
            uVar6 = uVar28;
            do {
              uVar20 = (int)uVar3 + (int)*psVar13;
              uVar3 = (ulonglong)uVar20;
              psVar5 = psVar13 + lVar12;
              psVar13 = psVar13 + lVar12 * 2;
              uVar22 = (int)uVar6 + (int)*psVar5;
              uVar6 = (ulonglong)uVar22;
              lVar15 = lVar15 + -1;
            } while (lVar15 != 0);
          }
          if (lVar2 < lVar33) {
            uVar21 = uVar21 + 1;
            uVar30 = SEXT24(param_1[DAT_1800b18a4 * lVar2 + uVar36]);
          }
          uVar30 = uVar30 + uVar22 + uVar20;
        }
        if (0 < (int)uVar29) {
          lVar2 = (longlong)DAT_1800b18a4;
          psVar13 = param_1 + (int)local_78;
          uVar3 = (ulonglong)uVar29;
          do {
            *psVar13 = *psVar13 +
                       ((short)((int)uVar18 / (int)uVar34) - (short)((int)uVar30 / (int)uVar21));
            psVar13 = psVar13 + lVar2;
            uVar3 = uVar3 - 1;
          } while (uVar3 != 0);
        }
        uVar3 = (ulonglong)((int)local_78 + 1U);
        uVar36 = uVar36 + 1;
        local_78 = local_78 & 0xffffffff00000000 | (ulonglong)((int)local_78 + 1U);
      } while ((longlong)uVar36 < local_48);
    }
    uVar34 = uVar25;
    uVar18 = uVar25;
    if (lVar1 < lVar33) {
      lVar2 = lVar1;
      uVar29 = uVar25;
      uVar21 = uVar24;
      uVar34 = uVar26;
      if (1 < lVar33 - lVar1) {
        lVar15 = (longlong)DAT_1800b18a4;
        psVar13 = param_1 + lVar15 * lVar1 + (longlong)local_88[0] + -1;
        lVar12 = ((lVar33 - sVar31) - 2U >> 1) + 1;
        uVar34 = (int)lVar12 * 2;
        lVar2 = lVar1 + lVar12 * 2;
        uVar3 = uVar28;
        uVar36 = uVar28;
        do {
          uVar21 = (int)uVar3 + (int)*psVar13;
          uVar3 = (ulonglong)uVar21;
          psVar5 = psVar13 + lVar15;
          psVar13 = psVar13 + lVar15 * 2;
          uVar29 = (int)uVar36 + (int)*psVar5;
          uVar36 = (ulonglong)uVar29;
          lVar12 = lVar12 + -1;
        } while (lVar12 != 0);
      }
      uVar18 = uVar27;
      if (lVar2 < lVar33) {
        uVar34 = uVar34 + 1;
        uVar18 = SEXT24(param_1[DAT_1800b18a4 * lVar2 + (longlong)local_88[0] + -1]);
      }
      uVar18 = uVar18 + uVar29 + uVar21;
    }
    uVar3 = SEXT28(local_88[0]);
    lVar2 = (longlong)DAT_1800b18a4;
    local_78 = local_78 & 0xffffffff00000000 | (ulonglong)(uint)(int)local_88[0];
    uVar36 = uVar3;
    while ((longlong)uVar3 < lVar2) {
      local_78._0_4_ = (int)uVar36;
      uVar29 = uVar27;
      uVar21 = uVar25;
      if (lVar1 < lVar33) {
        lVar12 = lVar1;
        uVar30 = uVar27;
        uVar22 = uVar24;
        uVar29 = uVar26;
        if (1 < lVar33 - lVar1) {
          psVar13 = param_1 + lVar2 * lVar1 + uVar3;
          lVar15 = ((lVar33 - sVar31) - 2U >> 1) + 1;
          uVar29 = (int)lVar15 * 2;
          lVar12 = lVar1 + lVar15 * 2;
          uVar36 = uVar28;
          uVar6 = uVar28;
          do {
            uVar22 = (int)uVar36 + (int)*psVar13;
            uVar36 = (ulonglong)uVar22;
            psVar5 = psVar13 + lVar2;
            psVar13 = psVar13 + lVar2 * 2;
            uVar30 = (int)uVar6 + (int)*psVar5;
            uVar6 = (ulonglong)uVar30;
            lVar15 = lVar15 + -1;
          } while (lVar15 != 0);
        }
        uVar21 = uVar27;
        if (lVar12 < lVar33) {
          uVar29 = uVar29 + 1;
          uVar21 = SEXT24(param_1[lVar2 * lVar12 + uVar3]);
        }
        uVar21 = uVar21 + uVar30 + uVar22;
      }
      if (0 < DAT_1800b18a0) {
        psVar13 = param_1 + (int)local_78;
        uVar36 = (ulonglong)(uint)(int)DAT_1800b18a0;
        do {
          *psVar13 = *psVar13 +
                     ((short)((int)uVar18 / (int)uVar34) - (short)((int)uVar21 / (int)uVar29));
          psVar13 = psVar13 + lVar2;
          uVar36 = uVar36 - 1;
        } while (uVar36 != 0);
      }
      uVar36 = (ulonglong)((int)local_78 + 1U);
      uVar3 = uVar3 + 1;
      local_78 = local_78 & 0xffffffff00000000 | (ulonglong)((int)local_78 + 1U);
    }
    lVar1 = (longlong)local_88[0];
    lVar12 = (longlong)sVar19;
    uVar34 = uVar27;
    uVar18 = uVar25;
    if (lVar12 < lVar1) {
      lVar15 = lVar12;
      uVar29 = uVar27;
      uVar21 = uVar24;
      uVar34 = uVar26;
      if (1 < lVar1 - lVar12) {
        lVar16 = ((lVar1 - local_48) - 2U >> 1) + 1;
        uVar34 = (int)lVar16 * 2;
        lVar15 = lVar12 + lVar16 * 2;
        psVar13 = param_1 + sVar31 * lVar2 + lVar12;
        uVar3 = uVar28;
        uVar36 = uVar28;
        do {
          uVar21 = (int)uVar3 + (int)*psVar13;
          uVar3 = (ulonglong)uVar21;
          uVar29 = (int)uVar36 + (int)psVar13[1];
          uVar36 = (ulonglong)uVar29;
          lVar16 = lVar16 + -1;
          psVar13 = psVar13 + 2;
        } while (lVar16 != 0);
      }
      uVar18 = uVar27;
      if (lVar15 < lVar1) {
        uVar34 = uVar34 + 1;
        uVar18 = SEXT24(param_1[sVar31 * lVar2 + lVar15]);
      }
      uVar18 = uVar18 + uVar29 + uVar21;
    }
    if ((int)sVar31 != 0) {
      lVar15 = (longlong)DAT_1800b18a4;
      local_78 = lVar15 * 2;
      psVar13 = param_1 + lVar12;
      local_68 = 0;
      psVar5 = param_1;
      local_60 = (ulonglong)(uint)(int)sVar31;
      do {
        uVar29 = uVar25;
        uVar21 = uVar25;
        if (lVar12 < lVar1) {
          lVar16 = lVar12;
          uVar30 = uVar27;
          uVar22 = uVar24;
          uVar29 = uVar26;
          if (1 < lVar1 - lVar12) {
            lVar17 = ((lVar1 - local_48) - 2U >> 1) + 1;
            uVar29 = (int)lVar17 * 2;
            lVar16 = lVar12 + lVar17 * 2;
            psVar4 = psVar13;
            uVar3 = uVar28;
            uVar36 = uVar28;
            do {
              uVar22 = (int)uVar3 + (int)*psVar4;
              uVar3 = (ulonglong)uVar22;
              uVar30 = (int)uVar36 + (int)psVar4[1];
              uVar36 = (ulonglong)uVar30;
              lVar17 = lVar17 + -1;
              psVar4 = psVar4 + 2;
            } while (lVar17 != 0);
          }
          if (lVar16 < lVar1) {
            uVar29 = uVar29 + 1;
            uVar21 = SEXT24(param_1[lVar16 + local_68]);
          }
          uVar21 = uVar21 + uVar30 + uVar22;
        }
        if (0 < DAT_1800b18a4) {
          uVar3 = (ulonglong)(uint)(int)DAT_1800b18a4;
          psVar4 = psVar5;
          do {
            *psVar4 = *psVar4 + ((short)((int)uVar18 / (int)uVar34) -
                                (short)((int)uVar21 / (int)uVar29));
            psVar4 = psVar4 + 1;
            uVar3 = uVar3 - 1;
          } while (uVar3 != 0);
        }
        psVar5 = psVar5 + lVar15;
        local_68 = local_68 + lVar2;
        local_60 = local_60 - 1;
        psVar13 = psVar13 + lVar2;
      } while (local_60 != 0);
    }
    uVar34 = uVar25;
    uVar18 = uVar25;
    if (lVar12 < lVar1) {
      lVar15 = lVar12;
      uVar29 = uVar25;
      uVar21 = uVar24;
      uVar34 = uVar26;
      if (1 < lVar1 - lVar12) {
        lVar16 = ((lVar1 - local_48) - 2U >> 1) + 1;
        uVar34 = (int)lVar16 * 2;
        lVar15 = lVar12 + lVar16 * 2;
        psVar13 = param_1 + (lVar33 + -1) * lVar2 + lVar12;
        uVar3 = uVar28;
        uVar36 = uVar28;
        do {
          uVar21 = (int)uVar3 + (int)*psVar13;
          uVar3 = (ulonglong)uVar21;
          uVar29 = (int)uVar36 + (int)psVar13[1];
          uVar36 = (ulonglong)uVar29;
          lVar16 = lVar16 + -1;
          psVar13 = psVar13 + 2;
        } while (lVar16 != 0);
      }
      uVar18 = uVar27;
      if (lVar15 < lVar1) {
        uVar34 = uVar34 + 1;
        uVar18 = SEXT24(param_1[(lVar33 + -1) * lVar2 + lVar15]);
      }
      uVar18 = uVar18 + uVar29 + uVar21;
    }
    if ((int)local_50 < (int)DAT_1800b18a0) {
      lVar33 = (longlong)DAT_1800b18a4;
      lVar15 = lVar2 * local_50;
      psVar13 = param_1 + (int)DAT_1800b18a4 * (int)local_50;
      local_70 = param_1 + lVar12 + lVar15;
      local_60 = (ulonglong)(uint)((int)DAT_1800b18a0 - (int)local_50);
      do {
        uVar29 = uVar27;
        uVar21 = uVar25;
        if (lVar12 < lVar1) {
          lVar16 = lVar12;
          uVar30 = uVar27;
          uVar22 = uVar24;
          uVar29 = uVar26;
          if (1 < lVar1 - lVar12) {
            lVar17 = ((lVar1 - local_48) - 2U >> 1) + 1;
            uVar29 = (int)lVar17 * 2;
            lVar16 = lVar12 + lVar17 * 2;
            psVar5 = local_70;
            uVar3 = uVar28;
            uVar36 = uVar28;
            do {
              uVar22 = (int)uVar3 + (int)*psVar5;
              uVar3 = (ulonglong)uVar22;
              uVar30 = (int)uVar36 + (int)psVar5[1];
              uVar36 = (ulonglong)uVar30;
              lVar17 = lVar17 + -1;
              psVar5 = psVar5 + 2;
            } while (lVar17 != 0);
          }
          uVar21 = uVar27;
          if (lVar16 < lVar1) {
            uVar29 = uVar29 + 1;
            uVar21 = SEXT24(param_1[lVar16 + lVar15]);
          }
          uVar21 = uVar21 + uVar30 + uVar22;
        }
        if (0 < DAT_1800b18a4) {
          uVar3 = (ulonglong)(uint)(int)DAT_1800b18a4;
          psVar5 = psVar13;
          do {
            *psVar5 = *psVar5 + ((short)((int)uVar18 / (int)uVar34) -
                                (short)((int)uVar21 / (int)uVar29));
            psVar5 = psVar5 + 1;
            uVar3 = uVar3 - 1;
          } while (uVar3 != 0);
        }
        psVar13 = psVar13 + lVar33;
        local_70 = local_70 + lVar2;
        lVar15 = lVar15 + lVar2;
        local_60 = local_60 - 1;
      } while (local_60 != 0);
    }
    iVar14 = (int)DAT_1800b18a8;
    iStack52 = 0;
    local_40._8_4_ = 0;
    iVar35 = 0;
    iVar37 = 0;
    if (0 < (longlong)(iVar14 * 2)) {
      iVar32 = (int)DAT_1800b18ac;
      uVar3 = uVar28;
      uVar36 = uVar28;
      do {
        uVar6 = uVar28;
        uVar7 = uVar28;
        if (0 < (longlong)(iVar32 * 2)) {
          do {
            iVar23 = (int)uVar7;
            if ((int)uVar3 < iVar14) {
              if (iVar32 <= iVar23) {
LAB_18005ad4d:
                iVar8 = (int)param_1[lVar2 * uVar36 + uVar6];
                iVar9 = (int)param_1[((uVar36 + 1) * lVar2 - uVar6) + -1];
                iVar10 = (int)param_1[(((longlong)DAT_1800b18a0 - uVar36) + -1) * lVar2 + uVar6];
                iVar11 = (int)param_1[(lVar2 * ((longlong)DAT_1800b18a0 - uVar36) - uVar6) + -1];
                goto LAB_18005ad9e;
              }
            }
            else {
              if (iVar23 < iVar32) goto LAB_18005ad4d;
              iVar8 = param_1[lVar2 * uVar36 + uVar6] * 2;
              iVar9 = param_1[((uVar36 + 1) * lVar2 - uVar6) + -1] * 2;
              iVar10 = param_1[(((longlong)DAT_1800b18a0 - uVar36) + -1) * lVar2 + uVar6] * 2;
              iVar11 = param_1[(lVar2 * ((longlong)DAT_1800b18a0 - uVar36) - uVar6) + -1] * 2;
LAB_18005ad9e:
              iVar37 = iVar37 + iVar8;
              iVar35 = iVar35 + iVar9;
              local_40._8_4_ = local_40._8_4_ + iVar10;
              iStack52 = iStack52 + iVar11;
            }
            uVar6 = uVar6 + 1;
            uVar7 = (ulonglong)(iVar23 + 1);
          } while ((longlong)uVar6 < (longlong)(iVar32 * 2));
        }
        uVar36 = uVar36 + 1;
        uVar3 = (ulonglong)((int)uVar3 + 1);
      } while ((longlong)uVar36 < (longlong)(iVar14 * 2));
    }
    iVar14 = DAT_1800b18ac * iVar14 * 4;
    uVar3 = (longlong)iVar37 / (longlong)iVar14 & 0xffffffff;
    local_68 = local_68 & 0xffffffff00000000 | uVar3;
    uVar36 = (longlong)iVar35 / (longlong)iVar14 & 0xffffffff;
    local_70 = (short *)((ulonglong)local_70 & 0xffffffff00000000 | uVar36);
    uVar6 = (longlong)local_40._8_4_ / (longlong)iVar14 & 0xffffffff;
    local_60 = local_60 & 0xffffffff00000000 | uVar6;
    uVar7 = (longlong)iStack52 / (longlong)iVar14 & 0xffffffff;
    local_78 = local_78 & 0xffffffff00000000 | uVar7;
    local_58 = (longlong)DAT_1800b18a8;
    if (0 < local_58) {
      lVar1 = (longlong)DAT_1800b18ac;
      do {
        if (0 < lVar1) {
          lVar16 = (longlong)DAT_1800b18a0 - uVar28;
          lVar12 = ((uVar28 - lVar16) + 1) * lVar2;
          lVar15 = (uVar28 - (lVar16 + -1)) * lVar2;
          lVar33 = lVar1;
          psVar13 = param_1 + lVar2 * (lVar16 + -1);
          psVar5 = param_1 + lVar2 * lVar16 + -1;
          do {
            psVar4 = psVar5 + -1;
            iVar37 = (int)psVar13[lVar15] + (int)uVar3 * 3;
            (psVar13 + 1)[lVar15 + -1] = (short)((int)(iVar37 + (iVar37 >> 0x1f & 3U)) >> 2);
            iVar37 = (int)psVar4[lVar12 + 1] + (int)uVar36 * 3;
            psVar4[lVar12 + 1] = (short)((int)(iVar37 + (iVar37 >> 0x1f & 3U)) >> 2);
            iVar37 = (int)*psVar13 + (int)uVar6 * 3;
            *psVar13 = (short)((int)(iVar37 + (iVar37 >> 0x1f & 3U)) >> 2);
            iVar37 = (int)*psVar5 + (int)uVar7 * 3;
            *psVar5 = (short)((int)(iVar37 + (iVar37 >> 0x1f & 3U)) >> 2);
            lVar33 = lVar33 + -1;
            psVar13 = psVar13 + 1;
            psVar5 = psVar4;
          } while (lVar33 != 0);
        }
        uVar28 = uVar28 + 1;
      } while ((longlong)uVar28 < local_58);
    }
  }
  FUN_18005f100(local_30 ^ (ulonglong)local_88);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18005afc0(short *param_1)

{
  short sVar1;
  short sVar2;
  int iVar3;
  longlong lVar4;
  short *psVar5;
  ulonglong uVar6;
  int iVar7;
  int iVar8;
  ulonglong uVar9;
  int iVar10;
  longlong lVar11;
  uint uVar12;
  uint uVar13;
  ulonglong uVar14;
  int iVar15;
  longlong lVar16;
  int iVar17;
  uint uVar18;
  uint uVar19;
  longlong lVar20;
  short *psVar21;
  uint uVar22;
  uint uVar23;
  ulonglong uVar24;
  short *psVar25;
  int iVar26;
  longlong lVar27;
  ulonglong uVar28;
  ulonglong uVar29;
  longlong lVar30;
  int local_78;
  int local_74;
  ulonglong local_70;
  longlong local_68;
  undefined8 local_60;
  longlong local_58;
  longlong local_50;
  longlong local_48;
  undefined local_40 [12];
  int iStack52;
  ulonglong local_30;

  sVar2 = DAT_1800b18a8;
  if (param_1 != (short *)0x0) {
    local_30 = DAT_1800b04e8 ^ (ulonglong)&local_78;
    lVar4 = (longlong)DAT_1800b18a8;
    _local_40 = ZEXT816(0);
    uVar14 = 0;
    uVar12 = 0;
    uVar13 = 0;
    iVar8 = (int)DAT_1800b18a8;
    uVar22 = uVar13;
    uVar18 = uVar12;
    if (lVar4 < DAT_1800b18b0) {
      iVar15 = (int)DAT_1800b18ac;
      iVar17 = (int)DAT_1800b18b4;
      uVar28 = uVar14;
      lVar20 = lVar4;
      uVar29 = uVar14;
      do {
        iVar26 = (int)uVar29;
        if (iVar15 < iVar17) {
          iVar10 = iVar15;
          uVar22 = uVar13;
          if (1 < iVar17 - iVar15) {
            iVar3 = ((iVar17 - iVar15) - 2U >> 1) + 1;
            uVar28 = (ulonglong)(uint)((int)uVar28 + iVar3 * 2);
            iVar10 = iVar3 * 2 + iVar15;
            uVar22 = param_1[lVar20] * iVar3;
          }
          if (iVar10 < iVar17) {
            iVar26 = iVar26 + param_1[lVar20];
            uVar28 = (ulonglong)((int)uVar28 + 1);
          }
          uVar29 = (ulonglong)(iVar26 + uVar22 * 2);
        }
        uVar18 = (uint)uVar29;
        uVar22 = (uint)uVar28;
        lVar20 = lVar20 + 1;
      } while (lVar20 < DAT_1800b18b0);
    }
    lVar20 = (longlong)DAT_1800b18b0;
    uVar28 = SEXT28(DAT_1800b18a0);
    sVar1 = (short)((int)uVar18 / (int)uVar22);
    if (0 < (longlong)uVar28) {
      lVar20 = (longlong)DAT_1800b18ac;
      lVar16 = (longlong)DAT_1800b18b4;
      lVar30 = (longlong)DAT_1800b18a4;
      psVar25 = param_1;
      uVar29 = uVar14;
      local_70 = uVar28;
      do {
        uVar22 = uVar12;
        uVar18 = uVar12;
        if (lVar20 < lVar16) {
          lVar27 = lVar20;
          uVar23 = 0;
          uVar19 = uVar13;
          uVar22 = 0;
          if (1 < lVar16 - lVar20) {
            lVar11 = ((lVar16 - lVar20) - 2U >> 1) + 1;
            uVar22 = (int)lVar11 * 2;
            lVar27 = lVar11 * 2 + lVar20;
            psVar5 = param_1 + uVar29 + lVar20;
            uVar28 = uVar14;
            uVar9 = uVar14;
            do {
              uVar19 = (int)uVar28 + (int)*psVar5;
              uVar28 = (ulonglong)uVar19;
              uVar23 = (int)uVar9 + (int)psVar5[1];
              uVar9 = (ulonglong)uVar23;
              lVar11 = lVar11 + -1;
              psVar5 = psVar5 + 2;
            } while (lVar11 != 0);
          }
          uVar18 = 0;
          if (lVar27 < lVar16) {
            uVar22 = uVar22 + 1;
            uVar18 = SEXT24(param_1[uVar29 + lVar27]);
          }
          uVar18 = uVar18 + uVar23 + uVar19;
        }
        psVar5 = psVar25;
        lVar27 = lVar30;
        if (0 < lVar30) {
          do {
            *psVar5 = *psVar5 + (sVar1 - (short)((int)uVar18 / (int)uVar22));
            lVar27 = lVar27 + -1;
            psVar5 = psVar5 + 1;
          } while (lVar27 != 0);
        }
        uVar29 = uVar29 + lVar30;
        local_70 = local_70 - 1;
        psVar25 = psVar25 + lVar30;
      } while (local_70 != 0);
      uVar28 = SEXT28(DAT_1800b18a0);
      lVar20 = (longlong)DAT_1800b18b0;
    }
    local_58 = (longlong)DAT_1800b18a4;
    uVar29 = uVar14;
    psVar25 = param_1;
    if (0 < local_58) {
      do {
        uVar22 = uVar12;
        uVar18 = uVar12;
        if (lVar4 < lVar20) {
          lVar16 = lVar4;
          uVar23 = uVar12;
          uVar19 = uVar13;
          uVar22 = 0;
          if (1 < lVar20 - lVar4) {
            psVar5 = param_1 + lVar4 * local_58 + uVar29;
            lVar20 = ((DAT_1800b18b0 - lVar4) - 2U >> 1) + 1;
            uVar22 = (int)lVar20 * 2;
            lVar16 = lVar4 + lVar20 * 2;
            uVar9 = uVar14;
            uVar6 = uVar14;
            do {
              uVar19 = (int)uVar6 + (int)*psVar5;
              uVar6 = (ulonglong)uVar19;
              psVar21 = psVar5 + local_58;
              psVar5 = psVar5 + local_58 * 2;
              uVar23 = (int)uVar9 + (int)*psVar21;
              uVar9 = (ulonglong)uVar23;
              lVar20 = lVar20 + -1;
            } while (lVar20 != 0);
            lVar20 = (longlong)DAT_1800b18b0;
          }
          if (lVar16 < lVar20) {
            uVar22 = uVar22 + 1;
            uVar18 = SEXT24(param_1[lVar16 * local_58 + uVar29]);
          }
          uVar18 = uVar18 + uVar23 + uVar19;
        }
        psVar5 = psVar25;
        uVar9 = uVar28;
        if (0 < (longlong)uVar28) {
          do {
            *psVar5 = *psVar5 + (sVar1 - (short)((int)uVar18 / (int)uVar22));
            uVar9 = uVar9 - 1;
            psVar5 = psVar5 + local_58;
          } while (uVar9 != 0);
        }
        lVar20 = (longlong)DAT_1800b18b0;
        uVar29 = uVar29 + 1;
        psVar25 = psVar25 + 1;
      } while ((longlong)uVar29 < local_58);
    }
    iStack52 = 0;
    local_40._8_4_ = 0;
    local_78 = 0;
    local_74 = 0;
    if (0 < (longlong)(iVar8 * 2)) {
      iVar15 = (int)DAT_1800b18ac;
      local_70 = SEXT48(iVar15 * 2);
      uVar29 = uVar14;
      uVar9 = uVar14;
      do {
        uVar6 = uVar14;
        uVar24 = uVar14;
        if (0 < (longlong)local_70) {
          do {
            iVar17 = (int)uVar24;
            if ((int)uVar29 < iVar8) {
              if (iVar15 <= iVar17) {
LAB_18005b32d:
                iVar26 = (int)param_1[uVar9 * local_58 + uVar6];
                iVar10 = (int)param_1[((uVar9 + 1) * local_58 - uVar6) + -1];
                iVar3 = (int)param_1[((uVar28 - uVar9) + -1) * local_58 + uVar6];
                iVar7 = (int)param_1[((uVar28 - uVar9) * local_58 - uVar6) + -1];
                goto LAB_18005b37a;
              }
            }
            else {
              if (iVar17 < iVar15) goto LAB_18005b32d;
              iVar26 = param_1[uVar9 * local_58 + uVar6] * 2;
              iVar10 = param_1[((uVar9 + 1) * local_58 - uVar6) + -1] * 2;
              iVar3 = param_1[((uVar28 - uVar9) + -1) * local_58 + uVar6] * 2;
              iVar7 = param_1[((uVar28 - uVar9) * local_58 - uVar6) + -1] * 2;
LAB_18005b37a:
              local_74 = local_74 + iVar26;
              local_78 = local_78 + iVar10;
              local_40._8_4_ = local_40._8_4_ + iVar3;
              iStack52 = iStack52 + iVar7;
            }
            uVar6 = uVar6 + 1;
            uVar24 = (ulonglong)(iVar17 + 1);
          } while ((longlong)uVar6 < (longlong)local_70);
        }
        uVar9 = uVar9 + 1;
        uVar29 = (ulonglong)((int)uVar29 + 1);
      } while ((longlong)uVar9 < (longlong)(iVar8 * 2));
    }
    iVar8 = DAT_1800b18ac * iVar8 * 4;
    local_74 = local_74 / iVar8;
    local_78 = local_78 / iVar8;
    uVar29 = (longlong)local_40._8_4_ / (longlong)iVar8 & 0xffffffff;
    local_60._4_4_ = (uint)(sVar2 >> 0xf);
    local_60 = uVar29 | (ulonglong)local_60._4_4_ << 0x20;
    uVar9 = (longlong)iStack52 / (longlong)iVar8 & 0xffffffff;
    local_70 = local_70 & 0xffffffff00000000 | uVar9;
    local_68 = (longlong)DAT_1800b18a8;
    if (0 < local_68) {
      lVar4 = (longlong)DAT_1800b18ac;
      local_50 = local_58 * -2;
      psVar25 = param_1 + local_58 * uVar28 + -1;
      _local_40 = ZEXT816(local_58 * -2 + 2);
      do {
        if (0 < lVar4) {
          lVar16 = ((uVar14 - uVar28) + 1) * local_58;
          local_48 = lVar16 * 2;
          lVar30 = ((uVar14 - uVar28) + 1) * local_58;
          psVar5 = psVar25 + (1 - local_58);
          psVar21 = psVar25;
          lVar20 = lVar4;
          do {
            iVar8 = (int)psVar5[lVar30] + local_74 * 3;
            psVar5[lVar30] = (short)((int)(iVar8 + (iVar8 >> 0x1f & 3U)) >> 2);
            iVar8 = (int)psVar21[lVar16] + local_78 * 3;
            psVar21[lVar16] = (short)((int)(iVar8 + (iVar8 >> 0x1f & 3U)) >> 2);
            iVar8 = (int)*psVar5 + (int)uVar29 * 3;
            *psVar5 = (short)((int)(iVar8 + (iVar8 >> 0x1f & 3U)) >> 2);
            iVar8 = (int)*psVar21 + (int)uVar9 * 3;
            *psVar21 = (short)((int)(iVar8 + (iVar8 >> 0x1f & 3U)) >> 2);
            lVar20 = lVar20 + -1;
            psVar5 = psVar5 + 1;
            psVar21 = psVar21 + -1;
          } while (lVar20 != 0);
        }
        uVar14 = uVar14 + 1;
        psVar25 = psVar25 + -local_58;
        uVar28 = uVar28 - 1;
      } while ((longlong)uVar14 < local_68);
    }
    FUN_18005f100(local_30 ^ (ulonglong)&local_78);
  }
  return;
}



undefined8 FUN_18005b5c0(longlong param_1,undefined4 *param_2)

{
  longlong lVar1;
  ushort uVar2;
  ushort uVar3;
  int iVar4;
  ulonglong *_Memory;
  int *_Memory_00;
  void *_Memory_01;
  undefined4 *_Dst;
  undefined8 uVar5;
  undefined4 *extraout_RAX;
  char *pcVar6;
  undefined8 extraout_RAX_00;
  undefined4 *extraout_RAX_01;
  undefined4 *extraout_RAX_02;
  undefined4 *extraout_RAX_03;
  undefined4 *puVar7;
  ulonglong uVar8;
  longlong lVar9;
  short sVar10;
  int iVar11;
  int iVar12;
  longlong lVar13;
  short sVar14;
  ulonglong uVar15;
  uint uVar16;
  size_t _Size;
  undefined4 local_res8;
  undefined4 uStackX12;
  ulonglong *local_res18;
  int *local_res20;

  iVar11 = (int)(short)DAT_1800b18a0;
  iVar12 = (int)(short)DAT_1800b18a4;
  local_res8 = 3;
  uStackX12 = 3;
  iVar4 = iVar11 * iVar12;
  if ((((param_1 == 0) || (param_2 == (undefined4 *)0x0)) || (*(longlong *)(param_1 + 0x10) == 0))
     || ((*(longlong *)(param_1 + 0x18) == 0 || (*(void **)(param_2 + 4) == (void *)0x0)))) {
    return CONCAT71((uint7)(uint3)((uint)iVar4 >> 8),0xff);
  }
  _Size = SEXT48(iVar4);
  *param_2 = 0;
  *(undefined2 *)(param_2 + 1) = 0;
  param_2[2] = 0;
  memset(*(void **)(param_2 + 4),0,_Size);
  _Memory = (ulonglong *)FUN_18005be50(iVar12,iVar11,2);
  local_res18 = _Memory;
  _Memory_00 = FUN_18005be50((int)(short)DAT_1800b18a4,(int)(short)DAT_1800b18a0,2);
  local_res20 = _Memory_00;
  _Memory_01 = malloc(_Size);
  _Dst = (undefined4 *)malloc(_Size);
  puVar7 = _Dst;
  if (_Memory == (ulonglong *)0x0) {
LAB_18005b98b:
    if ((_Memory_00 != (int *)0x0) && (puVar7 = &local_res8, puVar7 != (undefined4 *)0x0)) {
      free(_Memory_00);
      puVar7 = extraout_RAX_02;
    }
    if (_Memory_01 != (void *)0x0) {
      free(_Memory_01);
      puVar7 = extraout_RAX_03;
    }
    if (_Dst == (undefined4 *)0x0) goto LAB_18005b81d;
  }
  else {
    if (((_Memory_00 == (int *)0x0) || (_Memory_01 == (void *)0x0)) || (_Dst == (undefined4 *)0x0))
    {
      puVar7 = &local_res8;
      if (puVar7 != (undefined4 *)0x0) {
        free(_Memory);
        puVar7 = extraout_RAX_01;
      }
      goto LAB_18005b98b;
    }
    memset((void *)_Memory[3],0,_Size * 2);
    memset(_Memory_01,0,_Size);
    memset(_Dst,0,_Size);
    uVar5 = FUN_18005b9d0(param_1,_Memory[3]);
    if ((char)uVar5 == '\x01') {
      if ((*(int *)(param_1 + 4) - 1U & 0xfffffffb) == 0) {
        FUN_18005afc0((short *)_Memory[3]);
      }
      else {
        FUN_18005a4f0((short *)_Memory[3],*(int *)(param_1 + 4));
      }
      memcpy_FUN_180061f90(*(undefined8 **)(_Memory_00 + 6),(undefined8 *)_Memory[3],_Size * 2);
      FUN_18005d5d0(_Memory,_Memory_00,CONCAT44(uStackX12,local_res8),-1,0xcccc,0xcccc);
      FUN_18005c040((longlong)_Memory_01,DAT_1800b18a0,DAT_1800b18a4,DAT_1800b18b8,DAT_1800b18ba,
                    DAT_1800b18bc);
      uVar5 = FUN_180059f50(_Memory[3],(longlong)_Memory_01,(longlong)_Dst,(longlong)param_2,
                            *(uint *)(param_1 + 4));
      if (((char)uVar5 == '\x01') &&
         ((((*(uint *)(param_1 + 4) & 0xfffffffa) != 0 || (*(uint *)(param_1 + 4) == 4)) ||
          (uVar5 = FUN_180059570(*(longlong *)(_Memory_00 + 6),_Memory[3],(longlong)_Memory_01,
                                 (longlong)_Dst,(longlong)param_2), (char)uVar5 == '\x01')))) {
        uVar3 = DAT_1800b18a4;
        uVar2 = DAT_1800b18a0;
        uVar16 = (uint)DAT_1800b18a0;
        lVar9 = 0;
        *(undefined2 *)param_2 = 0;
        if (0 < (short)uVar2) {
          uVar15 = (ulonglong)uVar16;
          do {
            if (0 < (short)uVar3) {
              uVar8 = (ulonglong)uVar3;
              pcVar6 = (char *)((short)uVar3 * lVar9 + *(longlong *)(param_2 + 4));
              do {
                if (*pcVar6 == '\x01') {
                  *(short *)param_2 = *(short *)param_2 + 1;
                }
                pcVar6 = pcVar6 + 1;
                uVar8 = uVar8 - 1;
              } while (uVar8 != 0);
            }
            lVar9 = lVar9 + 1;
            uVar15 = uVar15 - 1;
          } while (uVar15 != 0);
        }
        lVar9 = 0;
        *(undefined4 *)((longlong)param_2 + 2) = 0;
        sVar10 = 0;
        if (0 < (short)uVar2) {
          do {
            sVar14 = 0;
            if (0 < (short)uVar3) {
              lVar1 = *(longlong *)(param_2 + 4);
              lVar13 = (short)uVar3 * lVar9;
              do {
                if ((*(char *)(lVar13 + lVar1) == '\x01') ||
                   (*(char *)(lVar13 + (longlong)_Dst) == '\x01')) {
                  uVar15 = FUN_18005bf00(lVar1,sVar10,sVar14);
                  if ((int)(uint)*(ushort *)((longlong)param_2 + 2) < (int)uVar15) {
                    *(short *)((longlong)param_2 + 2) = (short)uVar15;
                  }
                  uVar15 = FUN_18005bf00((longlong)_Dst,sVar10,sVar14);
                  if ((int)(uint)*(ushort *)(param_2 + 1) < (int)uVar15) {
                    *(short *)(param_2 + 1) = (short)uVar15;
                  }
                }
                sVar14 = sVar14 + 1;
                lVar13 = lVar13 + 1;
              } while (sVar14 < (short)uVar3);
              uVar16 = (uint)DAT_1800b18a0;
            }
            sVar10 = sVar10 + 1;
            lVar9 = lVar9 + 1;
            _Memory = local_res18;
          } while (sVar10 < (short)uVar16);
        }
        if ((undefined *)register0x00000020 != (undefined *)0xfffffffffffffff8) {
          free(_Memory);
          free(local_res20);
        }
        free(_Memory_01);
        free(_Dst);
        return CONCAT71((int7)((ulonglong)extraout_RAX_00 >> 8),1);
      }
    }
    if ((undefined *)register0x00000020 != (undefined *)0xfffffffffffffff8) {
      free(_Memory);
      free(_Memory_00);
    }
    free(_Memory_01);
  }
  free(_Dst);
  puVar7 = extraout_RAX;
LAB_18005b81d:
  return CONCAT71((int7)((ulonglong)puVar7 >> 8),0xff);
}



undefined8 FUN_18005b9d0(longlong param_1,longlong param_2)

{
  undefined2 *puVar1;
  int *piVar2;
  size_t _Size;
  short sVar3;
  int iVar4;
  int *_Memory;
  int *_Dst;
  undefined8 extraout_RAX;
  int *extraout_RAX_00;
  int iVar5;
  longlong lVar6;
  short *psVar7;
  longlong lVar8;
  short **ppsVar9;
  longlong lVar10;
  longlong lVar11;
  int *piVar12;
  undefined2 *puVar13;
  int iVar14;
  longlong lVar15;
  short **ppsVar16;

  if ((((param_1 == 0) || (ppsVar9 = *(short ***)(param_1 + 0x10), ppsVar9 == (short **)0x0)) ||
      (ppsVar16 = *(short ***)(param_1 + 0x18), ppsVar16 == (short **)0x0)) || (param_2 == 0)) {
    return CONCAT71((uint7)(uint3)(int3)(char)((ushort)DAT_1800b18a0 >> 8),0xff);
  }
  lVar8 = (longlong)((int)DAT_1800b18a4 * (int)DAT_1800b18a0);
  _Size = lVar8 * 4;
  _Memory = (int *)malloc(_Size);
  _Dst = (int *)malloc(_Size);
  if (_Memory == (int *)0x0) {
    _Memory = _Dst;
    if (_Dst == (int *)0x0) goto LAB_18005bc68;
  }
  else {
    if (_Dst != (int *)0x0) {
      memset(_Memory,0,_Size);
      memset(_Dst,0,_Size);
      lVar11 = (longlong)*(short *)(param_1 + 8);
      lVar15 = 0;
      if (0 < lVar11) {
        do {
          if (0 < lVar8) {
            psVar7 = *ppsVar9;
            lVar10 = lVar15;
            do {
              sVar3 = *psVar7;
              lVar6 = lVar10 + 1;
              psVar7 = psVar7 + 1;
              _Memory[lVar10] = _Memory[lVar10] + (int)sVar3;
              lVar10 = lVar6;
            } while (lVar6 < lVar8);
          }
          ppsVar9 = ppsVar9 + 1;
          lVar11 = lVar11 + -1;
        } while (lVar11 != 0);
      }
      lVar11 = (longlong)*(short *)(param_1 + 10);
      if (0 < lVar11) {
        do {
          if (0 < lVar8) {
            psVar7 = *ppsVar16;
            lVar10 = lVar15;
            do {
              sVar3 = *psVar7;
              lVar6 = lVar10 + 1;
              psVar7 = psVar7 + 1;
              _Dst[lVar10] = _Dst[lVar10] + (int)sVar3;
              lVar10 = lVar6;
            } while (lVar6 < lVar8);
          }
          ppsVar16 = ppsVar16 + 1;
          lVar11 = lVar11 + -1;
        } while (lVar11 != 0);
      }
      if (0 < lVar8) {
        piVar12 = _Dst;
        do {
          sVar3 = *(short *)(param_1 + 8);
          piVar2 = (int *)((longlong)((longlong)_Memory - (longlong)_Dst) + (longlong)piVar12);
          if (sVar3 == 0) {
            iVar14 = *piVar2;
          }
          else {
            iVar14 = (((int)sVar3 >> 1) + *piVar2) / (int)sVar3;
          }
          sVar3 = *(short *)(param_1 + 10);
          *piVar2 = iVar14;
          if (sVar3 == 0) {
            iVar4 = *piVar12;
          }
          else {
            iVar4 = (((int)sVar3 >> 1) + *piVar12) / (int)sVar3;
          }
          *piVar12 = iVar4;
          iVar5 = iVar14 - iVar4;
          if (iVar5 < 1) {
            iVar5 = iVar4 - iVar14;
          }
          *(short *)(param_2 + lVar15 * 2) = (short)iVar5;
          lVar15 = lVar15 + 1;
          piVar12 = piVar12 + 1;
        } while (lVar15 < lVar8);
      }
      sVar3 = DAT_1800b18a0;
      lVar8 = (longlong)DAT_1800b18a4;
      if (0 < lVar8) {
        lVar10 = (longlong)DAT_1800b18a0;
        lVar11 = lVar10 + -2;
        lVar15 = lVar8;
        puVar13 = (undefined2 *)(param_2 + lVar11 * lVar8 * 2);
        do {
          puVar1 = puVar13 + 1;
          puVar1[-1 - lVar11 * lVar8] =
               *(undefined2 *)((lVar11 * -2 + 2) * lVar8 + (longlong)puVar13);
          puVar1[((lVar10 - lVar11) + -1) * lVar8 + -1] = *puVar13;
          lVar15 = lVar15 + -1;
          puVar13 = puVar1;
        } while (lVar15 != 0);
      }
      lVar11 = (longlong)sVar3;
      if (0 < lVar11) {
        puVar13 = (undefined2 *)(param_2 + -2);
        do {
          puVar13 = puVar13 + lVar8;
          puVar13[1 - lVar8] = puVar13[2 - lVar8];
          *puVar13 = puVar13[-1];
          lVar11 = lVar11 + -1;
        } while (lVar11 != 0);
      }
      free(_Memory);
      free(_Dst);
      return CONCAT71((int7)((ulonglong)extraout_RAX >> 8),1);
    }
  }
  free(_Memory);
  _Dst = extraout_RAX_00;
LAB_18005bc68:
  return CONCAT71((int7)((ulonglong)_Dst >> 8),0xff);
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_18005bc90(short *param_1)

{
  short sVar1;
  short sVar2;
  uint uVar3;

  if (((((param_1 == (short *)0x0) || (*(longlong *)(param_1 + 8) == 0)) ||
       (*(longlong *)(param_1 + 0xc) == 0)) ||
      ((uVar3 = *(uint *)(param_1 + 2), 0xc < uVar3 || (sVar1 = *param_1, sVar1 < 1)))) ||
     ((sVar2 = param_1[1], sVar2 < 1 || ((param_1[4] < 1 || (param_1[5] < 1)))))) {
    return 0xff;
  }
  if ((uVar3 - 1 & 0xfffffffb) == 0) {
    DAT_1800b18ac = 3;
  }
  else {
    if ((uVar3 < 0xb) && ((0x7c5U >> (uVar3 & 0x1f) & 1) != 0)) {
      DAT_1800b18ac = 4;
      DAT_1800b18a8 = 4;
      goto LAB_18005bd8e;
    }
    if (1 < uVar3 - 3) {
      if (uVar3 - 0xb < 2) {
        DAT_1800b18ac = 6;
        DAT_1800b18a8 = 8;
      }
      goto LAB_18005bd8e;
    }
    DAT_1800b18ac = 4;
  }
  DAT_1800b18a8 = 5;
LAB_18005bd8e:
  if (uVar3 == 0xb) {
    DAT_1800b18c0 = 0xb;
    _DAT_1800b18c4 = 0xb;
  }
  else {
    DAT_1800b18c0 = 10;
    _DAT_1800b18c4 = 10;
  }
  DAT_1800b18a0 = sVar1;
  DAT_1800b18a4 = sVar2;
  DAT_1800b18b0 = sVar1 - DAT_1800b18a8;
  DAT_1800b18b4 = sVar2 - DAT_1800b18ac;
  DAT_1800b18b8 = sVar1 / 2;
  DAT_1800b18ba = sVar2 / 2;
  DAT_1800b18bc = 0xb;
  DAT_1800b18c8 = 0x14;
  DAT_1800b18cc = 5;
  DAT_1800b18d0 = 10;
  DAT_1800b18d4 = 5;
  _DAT_1800b18d8 = 0xf002d;
  DAT_1800b18dc = 8;
  return 1;
}



int * FUN_18005be50(int param_1,int param_2,int param_3)

{
  int iVar1;
  int *piVar2;
  int iVar3;

  if (param_3 == 8) {
    iVar3 = param_1 * param_2;
    iVar1 = (int)(iVar3 + (iVar3 >> 0x1f & 7U)) >> 3;
    if (iVar1 * 8 < iVar3) {
      iVar1 = iVar1 + 1;
    }
    iVar3 = -1;
  }
  else {
    iVar1 = param_1 * param_2 * param_3;
    iVar3 = param_1 * param_3;
  }
  piVar2 = (int *)malloc((longlong)iVar1 + 0x20);
  if (piVar2 != (int *)0x0) {
    piVar2[3] = iVar1;
    *piVar2 = param_1;
    piVar2[1] = param_2;
    piVar2[4] = param_3;
    piVar2[2] = iVar3;
    *(int **)(piVar2 + 6) = piVar2 + 8;
  }
  return piVar2;
}



ulonglong FUN_18005bf00(longlong param_1,short param_2,short param_3)

{
  short sVar1;
  longlong lVar2;
  longlong lVar3;
  ulonglong uVar4;

  lVar2 = 5;
  uVar4 = 0;
  do {
    if (param_2 < DAT_1800b18a0) {
      sVar1 = 0;
      lVar3 = (longlong)param_3;
      do {
        if (((short)(param_3 + sVar1) < DAT_1800b18a4) &&
           (*(char *)((longlong)param_2 * (longlong)DAT_1800b18a4 + lVar3 + param_1) != '\0')) {
          uVar4 = (ulonglong)((int)uVar4 + 1);
        }
        sVar1 = sVar1 + 1;
        lVar3 = lVar3 + 1;
      } while (sVar1 < 5);
    }
    param_2 = param_2 + 1;
    lVar2 = lVar2 + -1;
  } while (lVar2 != 0);
  return uVar4;
}



undefined8 FUN_18005bfa0(longlong param_1,undefined4 *param_2)

{
  char cVar1;
  undefined8 uVar2;

  if ((((param_1 != 0) && (param_2 != (undefined4 *)0x0)) && (*(longlong *)(param_1 + 0x10) != 0))
     && ((*(longlong *)(param_1 + 0x18) != 0 && (*(longlong *)(param_2 + 4) != 0)))) {
    cVar1 = FUN_18005bc90();
    if (cVar1 == '\x01') {
      uVar2 = FUN_18005b5c0(param_1,param_2);
      if ((char)uVar2 == '\x01') {
        if ((*(ushort *)param_2 < DAT_1800b18d8 || *(ushort *)param_2 == DAT_1800b18d8) &&
           (*(ushort *)((longlong)param_2 + 2) < DAT_1800b18da ||
            *(ushort *)((longlong)param_2 + 2) == DAT_1800b18da)) {
          if (*(ushort *)(param_2 + 1) < DAT_1800b18dc || *(ushort *)(param_2 + 1) == DAT_1800b18dc)
          {
            return 1;
          }
        }
        return 0;
      }
    }
  }
  return 0xff;
}



void FUN_18005c040(longlong param_1,short param_2,short param_3,short param_4,short param_5,
                  short param_6)

{
  short sVar1;
  longlong lVar2;
  longlong lVar3;
  short sVar4;

  if ((((param_1 != 0) && (0 < param_2)) && (0 < param_3)) && (0 < param_6)) {
    lVar3 = 0;
    sVar4 = 0;
    if (0 < param_2) {
      do {
        if (0 < param_3) {
          lVar2 = 0;
          sVar1 = 0;
          do {
            if (((int)sVar1 - (int)param_5) * ((int)sVar1 - (int)param_5) +
                ((int)sVar4 - (int)param_4) * ((int)sVar4 - (int)param_4) <=
                (int)param_6 * (int)param_6) {
              *(undefined *)(param_3 * lVar3 + lVar2 + param_1) = 1;
            }
            sVar1 = sVar1 + 1;
            lVar2 = lVar2 + 1;
          } while (sVar1 < param_3);
        }
        sVar4 = sVar4 + 1;
        lVar3 = lVar3 + 1;
      } while (sVar4 < param_2);
    }
  }
  return;
}



undefined8 FUN_18005c160(void **param_1)

{
  if ((param_1 != (void **)0x0) && (*param_1 != (void *)0x0)) {
    free(*param_1);
    *param_1 = (void *)0x0;
    return 0;
  }
  return 0x80000002;
}



void FUN_18005c1f0(longlong param_1,longlong param_2,longlong param_3,int param_4,int param_5,
                  int param_6)

{
  longlong *plVar1;
  int iVar2;
  int *piVar3;
  longlong lVar4;
  longlong lVar5;
  longlong lVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  longlong lVar10;
  longlong lVar11;
  longlong *plVar12;
  undefined2 *puVar13;
  longlong *plVar14;
  longlong *plVar15;
  ulonglong uVar16;
  int iVar17;
  ulonglong uVar18;
  longlong local_res18;

  piVar3 = *(int **)(param_1 + 0x98);
  iVar2 = piVar3[10];
  lVar6 = (longlong)(*piVar3 >> 1);
  piVar3 = (int *)(*(longlong *)(piVar3 + 8) + lVar6 * 4);
  plVar14 = (longlong *)(param_2 + lVar6 * 8);
  if (param_5 != 0) {
    plVar15 = plVar14 + -1;
    local_res18 = param_3;
    do {
      param_5 = param_5 + -1;
      uVar18 = 0;
      if (-1 < (longlong)(param_6 + -4)) {
        lVar11 = 8;
        uVar18 = (longlong)(param_6 + -4) + 4;
        uVar16 = uVar18 >> 2;
        uVar18 = uVar18 & 0xfffffffffffffffc;
        puVar13 = (undefined2 *)(local_res18 + 4);
        do {
          lVar4 = *plVar14;
          lVar10 = 1;
          iVar9 = *(int *)(lVar4 + -8 + lVar11);
          iVar8 = *(int *)(lVar4 + -4 + lVar11);
          iVar7 = *(int *)(lVar4 + lVar11);
          iVar17 = *(int *)(lVar4 + 4 + lVar11);
          plVar12 = plVar15;
          if (0 < lVar6) {
            do {
              lVar4 = plVar14[lVar10];
              lVar5 = *plVar12;
              lVar10 = lVar10 + 1;
              iVar9 = iVar9 + *(int *)(lVar4 + -8 + lVar11) + *(int *)(lVar5 + -8 + lVar11);
              iVar8 = iVar8 + *(int *)(lVar4 + -4 + lVar11) + *(int *)(lVar5 + -4 + lVar11);
              iVar7 = iVar7 + *(int *)(lVar4 + lVar11) + *(int *)(lVar5 + lVar11);
              iVar17 = iVar17 + *(int *)(lVar4 + 4 + lVar11) + *(int *)(lVar5 + 4 + lVar11);
              plVar12 = plVar12 + -1;
            } while (lVar10 <= lVar6);
          }
          lVar11 = lVar11 + 0x10;
          puVar13[-2] = (short)((uint)(*piVar3 * iVar9 + iVar2) >>
                               ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c) & 0x1f))
          ;
          puVar13[-1] = (short)((uint)(*piVar3 * iVar8 + iVar2) >>
                               ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c) & 0x1f))
          ;
          *puVar13 = (short)((uint)(*piVar3 * iVar7 + iVar2) >>
                            ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c) & 0x1f));
          puVar13[1] = (short)((uint)(*piVar3 * iVar17 + iVar2) >>
                              ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c) & 0x1f));
          uVar16 = uVar16 - 1;
          puVar13 = puVar13 + 4;
        } while (uVar16 != 0);
      }
      while ((longlong)uVar18 < (longlong)param_6) {
        iVar9 = *(int *)(*plVar14 + uVar18 * 4);
        lVar11 = 1;
        plVar12 = plVar15;
        if (0 < lVar6) {
          do {
            plVar1 = plVar14 + lVar11;
            lVar11 = lVar11 + 1;
            iVar9 = iVar9 + *(int *)(*plVar1 + uVar18 * 4) + *(int *)(*plVar12 + uVar18 * 4);
            plVar12 = plVar12 + -1;
          } while (lVar11 <= lVar6);
        }
        uVar18 = uVar18 + 1;
        *(short *)(local_res18 + -2 + uVar18 * 2) =
             (short)((uint)(*piVar3 * iVar9 + iVar2) >>
                    ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c) & 0x1f));
      }
      local_res18 = local_res18 + param_4;
      plVar14 = plVar14 + 1;
      plVar15 = plVar15 + 1;
    } while (param_5 != 0);
  }
  return;
}



void FUN_18005c4a0(longlong param_1,longlong param_2,longlong param_3,int param_4,int param_5,
                  int param_6)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  longlong lVar4;
  longlong lVar5;
  undefined2 *puVar6;
  longlong lVar7;
  uint uVar8;
  uint uVar9;
  longlong *plVar10;
  ulonglong uVar11;
  longlong lVar12;
  uint uVar13;
  longlong *plVar14;
  longlong *plVar15;
  longlong lVar16;
  uint uVar17;
  ulonglong uVar18;
  longlong local_res18;

  piVar3 = *(int **)(param_1 + 0x98);
  iVar1 = piVar3[10];
  lVar7 = (longlong)(*piVar3 >> 1);
  piVar3 = (int *)(*(longlong *)(piVar3 + 8) + lVar7 * 4);
  plVar15 = (longlong *)(param_2 + lVar7 * 8);
  if (param_5 != 0) {
    plVar10 = plVar15 + -1;
    local_res18 = param_3;
    do {
      param_5 = param_5 + -1;
      uVar18 = 0;
      if (-1 < (longlong)(param_6 + -4)) {
        lVar16 = 8;
        uVar18 = (longlong)(param_6 + -4) + 4;
        uVar11 = uVar18 >> 2;
        uVar18 = uVar18 & 0xfffffffffffffffc;
        puVar6 = (undefined2 *)(local_res18 + 4);
        do {
          lVar5 = *plVar15;
          iVar2 = *piVar3;
          lVar12 = 1;
          uVar13 = *(int *)(lVar5 + -8 + lVar16) * iVar2 + iVar1;
          uVar9 = *(int *)(lVar5 + -4 + lVar16) * iVar2 + iVar1;
          uVar8 = *(int *)(lVar5 + lVar16) * iVar2 + iVar1;
          uVar17 = *(int *)(lVar5 + 4 + lVar16) * iVar2 + iVar1;
          plVar14 = plVar10;
          if (0 < lVar7) {
            do {
              lVar5 = *plVar14;
              lVar4 = plVar15[lVar12];
              iVar2 = piVar3[lVar12];
              lVar12 = lVar12 + 1;
              uVar13 = uVar13 + (*(int *)(lVar5 + -8 + lVar16) + *(int *)(lVar4 + -8 + lVar16)) *
                                iVar2;
              uVar9 = uVar9 + (*(int *)(lVar5 + -4 + lVar16) + *(int *)(lVar4 + -4 + lVar16)) *
                              iVar2;
              uVar8 = uVar8 + (*(int *)(lVar4 + lVar16) + *(int *)(lVar5 + lVar16)) * iVar2;
              uVar17 = uVar17 + (*(int *)(lVar5 + 4 + lVar16) + *(int *)(lVar4 + 4 + lVar16)) *
                                iVar2;
              plVar14 = plVar14 + -1;
            } while (lVar12 <= lVar7);
          }
          lVar16 = lVar16 + 0x10;
          puVar6[-2] = (short)(uVar13 >>
                              ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c) & 0x1f));
          puVar6[-1] = (short)(uVar9 >> ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c)
                                        & 0x1f));
          *puVar6 = (short)(uVar8 >> ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c) &
                                     0x1f));
          uVar11 = uVar11 - 1;
          puVar6[1] = (short)(uVar17 >>
                             ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c) & 0x1f));
          puVar6 = puVar6 + 4;
        } while (uVar11 != 0);
      }
      while ((longlong)uVar18 < (longlong)param_6) {
        lVar16 = 1;
        uVar8 = *(int *)(*plVar15 + uVar18 * 4) * *piVar3 + iVar1;
        plVar14 = plVar10;
        if (0 < lVar7) {
          do {
            lVar5 = lVar16 + 1;
            uVar8 = uVar8 + (*(int *)(plVar15[lVar16] + uVar18 * 4) +
                            *(int *)(*plVar14 + uVar18 * 4)) * piVar3[lVar16];
            lVar16 = lVar5;
            plVar14 = plVar14 + -1;
          } while (lVar5 <= lVar7);
        }
        uVar18 = uVar18 + 1;
        *(short *)(local_res18 + -2 + uVar18 * 2) =
             (short)(uVar8 >> ((byte)*(undefined4 *)(*(longlong *)(param_1 + 0x98) + 0x2c) & 0x1f));
      }
      local_res18 = local_res18 + param_4;
      plVar10 = plVar10 + 1;
      plVar15 = plVar15 + 1;
    } while (param_5 != 0);
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18005c770(uint param_1,uint param_2,undefined8 param_3,int param_4,int param_5,int param_6)

{
  int *piVar1;
  undefined8 *puVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  uint uStackX28;
  int local_78;
  int iStack116;
  int iStack112;
  int iStack108;
  int local_68;
  int iStack100;
  int iStack96;
  int iStack92;
  int local_58;
  int iStack84;
  int iStack80;
  int iStack76;
  int local_48;
  int iStack68;
  int iStack64;
  int iStack60;
  int local_38;
  int iStack52;
  int iStack48;
  int iStack44;
  undefined local_28 [8];
  int local_20;
  int iStack28;

  uVar4 = param_1 & 7;
  if (param_4 < 0) {
    if (uVar4 < 4) {
      uVar4 = 4;
    }
    piVar1 = FUN_18005d830(&local_38,uVar4,(uint)param_3,param_5);
    uStackX28 = (uint)((ulonglong)param_3 >> 0x20);
    local_78 = *piVar1;
    iStack116 = piVar1[1];
    iStack112 = piVar1[2];
    iStack108 = piVar1[3];
    local_68 = piVar1[4];
    iStack100 = piVar1[5];
    iStack96 = piVar1[6];
    iStack92 = piVar1[7];
    if (((uint)param_3 != uStackX28) ||
       (uVar3 = param_5 - param_6 >> 0x1f, 0x28e < (int)((param_5 - param_6 ^ uVar3) - uVar3))) {
      local_58 = local_78;
      iStack84 = iStack116;
      iStack80 = iStack112;
      iStack76 = iStack108;
      piVar1 = FUN_18005d830(&local_38,uVar4,uStackX28,param_6);
      local_78 = *piVar1;
      iStack116 = piVar1[1];
      iStack112 = piVar1[2];
      iStack108 = piVar1[3];
      local_28._0_4_ = piVar1[4];
      local_28._4_4_ = piVar1[5];
      local_20 = piVar1[6];
      iStack28 = piVar1[7];
      goto LAB_18005c8a3;
    }
  }
  else {
    if (uVar4 < 4) {
      uVar4 = 4;
    }
    piVar1 = FUN_18005d980(&local_38,param_4,uVar4);
    local_78 = *piVar1;
    iStack116 = piVar1[1];
    iStack112 = piVar1[2];
    iStack108 = piVar1[3];
    local_68 = piVar1[4];
    iStack100 = piVar1[5];
    iStack96 = piVar1[6];
    iStack92 = piVar1[7];
  }
  _local_28 = CONCAT412(iStack92,CONCAT48(iStack96,CONCAT44(iStack100,local_68)));
  iVar5 = (local_68 >> 3 & 0x1ffU) + 1 << ((byte)(0xfa50 >> ((byte)local_68 & 7) * '\x02') & 3);
  local_58 = local_78;
  iStack84 = iStack116;
  iStack80 = iStack112;
  iStack76 = iStack108;
  puVar2 = (undefined8 *)malloc((longlong)(iStack116 * iVar5 * local_78));
  _local_28 = CONCAT88(puVar2,local_28);
  memcpy_FUN_180061f90
            (puVar2,(undefined8 *)CONCAT44(iStack92,iStack96),
             (longlong)(iVar5 * iStack116 * local_78));
LAB_18005c8a3:
  local_38 = local_78;
  iStack52 = iStack116;
  iStack48 = iStack112;
  iStack44 = iStack108;
  _local_28 = CONCAT412(iStack28,CONCAT48(local_20,CONCAT44(local_28._4_4_,local_28._0_4_)));
  local_48 = local_68;
  iStack68 = iStack100;
  iStack64 = iStack96;
  iStack60 = iStack92;
  FUN_18005c910(param_1,param_2,&local_58,&local_38,0xffffffffffffffff,0);
  return;
}



void FUN_18005c910(uint param_1,uint param_2,int *param_3,int *param_4,longlong param_5,int param_6)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  int *piVar7;

  if ((int)param_5 < 0) {
    param_5._0_4_ = (*param_3 + param_3[1] + -1) / 2;
  }
  if (param_5 < 0) {
    param_5._4_4_ = (param_4[1] + *param_4 + -1) / 2;
  }
  iVar1 = *param_3;
  iVar2 = param_3[1];
  piVar6 = (int *)malloc(0x30);
  iVar3 = param_3[1];
  iVar4 = param_3[2];
  iVar5 = param_3[3];
  piVar6[2] = *param_3;
  piVar6[3] = iVar3;
  piVar6[4] = iVar4;
  piVar6[5] = iVar5;
  iVar3 = param_3[5];
  iVar4 = param_3[6];
  iVar5 = param_3[7];
  piVar6[6] = param_3[4];
  piVar6[7] = iVar3;
  piVar6[8] = iVar4;
  piVar6[9] = iVar5;
  piVar6[10] = 5;
  piVar6[1] = (int)param_5;
  *piVar6 = iVar1 + -1 + iVar2;
  iVar1 = *param_4;
  iVar2 = param_4[1];
  piVar7 = (int *)malloc(0x38);
  iVar3 = param_4[1];
  iVar4 = param_4[2];
  iVar5 = param_4[3];
  piVar7[2] = *param_4;
  piVar7[3] = iVar3;
  piVar7[4] = iVar4;
  piVar7[5] = iVar5;
  iVar3 = param_4[5];
  iVar4 = param_4[6];
  iVar5 = param_4[7];
  piVar7[6] = param_4[4];
  piVar7[7] = iVar3;
  piVar7[8] = iVar4;
  piVar7[9] = iVar5;
  piVar7[1] = param_5._4_4_;
  piVar7[0xb] = 0x10;
  piVar7[0xc] = 5;
  *piVar7 = iVar1 + -1 + iVar2;
  piVar7[10] = param_6 << 0x10;
  FUN_18005ccb0(piVar6,piVar7,param_1,param_2,((int)param_1 >> 3 & 0x1ffU) * 8 + 4,4,4);
  return;
}



void FUN_18005ca90(uint param_1)

{
  ushort uVar1;
  ushort uVar2;
  uint *puVar3;
  uint local_68 [4];
  uint local_58 [4];
  undefined4 local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  ulonglong local_18;

  puVar3 = local_68;
  local_18 = DAT_1800b04e8 ^ (ulonglong)local_68;
  uVar1 = 0;
  local_68[0] = 0x58b90;
  local_68[1] = 0x2c5c8;
  local_68[2] = 0x162e4;
  local_68[3] = 0xb172;
  uVar2 = 0;
  local_58[0] = 0x67cd;
  local_58[1] = 0x3920;
  local_58[2] = 0x1e27;
  local_58[3] = 0xf85;
  local_48 = 0x7e1;
  local_44 = 0x3f8;
  local_40 = 0x1fe;
  local_3c = 0x100;
  local_38 = 0x80;
  local_34 = 0x40;
  local_30 = 0x20;
  local_2c = 0x10;
  local_28 = 8;
  local_24 = 4;
  local_20 = 2;
  local_1c = 1;
  do {
    if (*puVar3 < param_1) {
      param_1 = param_1 - *puVar3;
    }
    uVar2 = uVar2 + 1;
    puVar3 = puVar3 + 1;
  } while (uVar2 < 4);
  puVar3 = local_58;
  do {
    if (*puVar3 < param_1) {
      param_1 = param_1 - *puVar3;
    }
    uVar1 = uVar1 + 1;
    puVar3 = puVar3 + 1;
  } while (uVar1 < 0x10);
  FUN_18005f100(DAT_1800b04e8 ^ (ulonglong)local_68 ^ (ulonglong)local_68);
  return;
}



undefined8 FUN_18005cbd0(uint param_1)

{
  uint uVar1;

  uVar1 = (param_1 ^ (int)param_1 >> 0x1f) - ((int)param_1 >> 0x1f);
  if (0xb1720 < uVar1) {
    return 0;
  }
  uVar1 = FUN_18005ca90(uVar1);
  return SUB168((ZEXT816(0) << 0x40 | ZEXT816(0x100000000)) / ZEXT416(uVar1),0);
}



void FUN_18005cc10(uint *param_1,ulonglong *param_2,longlong param_3)

{
  int iVar1;
  undefined8 local_18;
  undefined4 uStack16;
  undefined4 uStack12;

  uStack16 = *(undefined4 *)param_2;
  uStack12 = *(undefined4 *)((longlong)param_2 + 4);
  local_18 = 0;
  iVar1 = FUN_18005d270(param_1,*param_2,(uint *)&local_18,0xffffffff);
  FUN_18005cdd0((int *)param_1,(longlong)(*(int *)(param_2 + 1) * iVar1) + param_2[3],
                *(int *)(param_2 + 1),param_1[0x1d] - param_1[0x1b],*(longlong *)(param_3 + 0x18),
                *(int *)(param_3 + 8));
  return;
}



uint * FUN_18005ccb0(undefined4 *param_1,undefined4 *param_2,uint param_3,uint param_4,uint param_5,
                    uint param_6,uint param_7)

{
  undefined4 uVar1;
  uint uVar2;
  int iVar3;
  uint *puVar4;
  void *pvVar5;
  undefined8 local_res8;

  puVar4 = (uint *)malloc(0xa0);
  uVar1 = *param_1;
  *puVar4 = param_3;
  puVar4[2] = param_5;
  puVar4[8] = param_7;
  puVar4[1] = param_4;
  *(undefined4 **)(puVar4 + 0x24) = param_1;
  *(undefined4 **)(puVar4 + 0x26) = param_2;
  puVar4[7] = param_6;
  local_res8 = CONCAT44(*param_2,uVar1);
  *(undefined8 *)(puVar4 + 3) = local_res8;
  local_res8 = CONCAT44(param_2[1],param_1[1]);
  *(undefined8 *)(puVar4 + 5) = local_res8;
  iVar3 = 1;
  if (3 < (param_3 & 7)) {
    iVar3 = 4;
  }
  uVar2 = (int)(((int)param_3 >> 3 & 0x1ffU) + 1 <<
               ((byte)(0xfa50 >> (char)(param_3 & 7) * '\x02') & 3)) / iVar3;
  iVar3 = puVar4[3] - 1;
  if ((int)(puVar4[3] - 1) < 1) {
    iVar3 = 1;
  }
  puVar4[9] = uVar2;
  pvVar5 = malloc((longlong)(int)uVar2 * (longlong)iVar3 * 4);
  *(void **)(puVar4 + 10) = pvVar5;
  puVar4[0xc] = 0;
  puVar4[0x1a] = 0;
  *(undefined8 *)(puVar4 + 0xd) = 0xffffffffffffffff;
  return puVar4;
}



ulonglong FUN_18005cdd0(int *param_1,longlong param_2,int param_3,int param_4,longlong param_5,
                       int param_6)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  longlong lVar9;
  longlong lVar10;
  undefined4 *puVar11;
  bool bVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  uint uVar16;
  uint uVar17;
  int iVar18;
  undefined4 *puVar19;
  longlong lVar20;
  undefined8 *puVar21;
  longlong lVar22;
  int *piVar23;
  ulonglong uVar24;
  ulonglong uVar25;
  ulonglong uVar26;
  ulonglong uVar27;
  longlong lVar28;
  longlong lVar29;
  uint local_80;

  lVar9 = *(longlong *)(param_1 + 10);
  uVar1 = param_1[0x20];
  uVar26 = SEXT48((int)uVar1);
  iVar2 = param_1[9];
  lVar10 = *(longlong *)(param_1 + 0x14);
  iVar3 = param_1[4];
  iVar4 = param_1[6];
  uVar5 = param_1[0x21];
  uVar24 = SEXT48((int)uVar5);
  iVar6 = param_1[0x13];
  iVar18 = (*param_1 >> 3 & 0x1ffU) + 1 << ((byte)(0xfa50 >> ((byte)*param_1 & 7) * '\x02') & 3);
  iVar7 = param_1[0x11];
  iVar13 = param_1[3] + iVar7 + -1;
  iVar14 = param_1[0xf];
  if (param_1[5] < iVar14) {
    iVar14 = param_1[5];
  }
  if ((((int)uVar1 < 1) && ((int)uVar5 < 1)) || (bVar12 = true, param_1[7] == 0)) {
    bVar12 = false;
  }
  local_80 = 0;
  if (iVar6 == 0) {
    return 0xffffffff;
  }
  puVar21 = (undefined8 *)(param_2 - iVar14 * iVar18);
  iVar14 = (param_1[0x1d] - param_1[0x1e]) - param_1[0x1b];
  uVar25 = uVar24;
  uVar27 = uVar26;
  if (iVar14 < param_4) {
    param_4 = iVar14;
  }
  do {
    iVar14 = (((iVar6 - param_1[0x1e]) - param_1[0x1b]) - iVar4) + param_1[0x10];
    if (iVar14 < 1) {
      iVar14 = (iVar6 - iVar3) + 1;
    }
    if (param_4 < iVar14) {
      iVar14 = param_4;
    }
    param_4 = param_4 - iVar14;
    if (0 < iVar14) {
      lVar28 = (longlong)((int)uVar27 * iVar18);
      do {
        iVar15 = param_1[0x1e];
        puVar11 = *(undefined4 **)(param_1 + 0x16);
        param_1[0x1e] = iVar15 + 1;
        lVar29 = (longlong)((((param_1[0x1b] - param_1[0x1c]) + iVar15) % iVar6) * param_1[0x1a]) +
                 *(longlong *)(param_1 + 0x18);
        if (iVar6 < iVar15 + 1) {
          param_1[0x1e] = iVar15;
          param_1[0x1b] = param_1[0x1b] + 1;
        }
        memcpy_FUN_180061f90
                  ((undefined8 *)(lVar28 + (longlong)puVar11),puVar21,
                   (longlong)(((iVar13 - (int)uVar25) - (int)uVar27) * iVar18));
        if (bVar12) {
          if (iVar2 * 4 == iVar18) {
            lVar22 = (longlong)(int)(uVar1 * iVar2);
            if (0 < (int)(uVar1 * iVar2)) {
              puVar19 = puVar11;
              do {
                *puVar19 = *(undefined4 *)
                            ((longlong)puVar21 +
                            (longlong)*(int *)((lVar9 - (longlong)puVar11) + (longlong)puVar19) * 4)
                ;
                lVar22 = lVar22 + -1;
                puVar19 = puVar19 + 1;
              } while (lVar22 != 0);
            }
            lVar22 = (longlong)(int)(uVar5 * iVar2);
            if (0 < (int)(uVar5 * iVar2)) {
              puVar19 = puVar11 + (longlong)iVar2 * ((longlong)iVar13 - uVar24);
              do {
                *puVar19 = *(undefined4 *)
                            ((longlong)puVar21 +
                            (longlong)
                            *(int *)(((longlong)iVar2 * (uVar26 - ((longlong)iVar13 - uVar24)) * 4 -
                                     (longlong)puVar11) + lVar9 + (longlong)puVar19) * 4);
                lVar22 = lVar22 + -1;
                puVar19 = puVar19 + 1;
              } while (lVar22 != 0);
            }
          }
          else {
            lVar22 = 0;
            if (0 < lVar28) {
              do {
                lVar20 = lVar22 + 1;
                *(undefined *)(lVar22 + (longlong)puVar11) =
                     *(undefined *)((longlong)*(int *)(lVar9 + lVar22 * 4) + (longlong)puVar21);
                lVar22 = lVar20;
              } while (lVar20 < lVar28);
            }
            if (0 < (int)(uVar5 * iVar18)) {
              piVar23 = (int *)(lVar9 + (longlong)iVar18 * uVar26 * 4);
              lVar22 = 0;
              do {
                iVar15 = *piVar23;
                lVar20 = lVar22 + 1;
                piVar23 = piVar23 + 1;
                *(undefined *)
                 ((longlong)puVar11 + lVar22 + ((longlong)iVar13 - uVar24) * (longlong)iVar18) =
                     *(undefined *)((longlong)iVar15 + (longlong)puVar21);
                lVar22 = lVar20;
              } while (lVar20 < (int)(uVar5 * iVar18));
            }
          }
        }
        iVar15 = (*param_1 >> 3 & 0x1ffU) + 1;
        if (*(char *)(param_1 + 0x22) == '\0') {
          FUN_18005de20((longlong)param_1,(longlong)puVar11,lVar29,iVar7,iVar15);
        }
        else {
          FUN_18005dc70((longlong)param_1,(longlong)puVar11,lVar29,iVar7,iVar15);
        }
        iVar14 = iVar14 + -1;
        puVar21 = (undefined8 *)((longlong)puVar21 + (longlong)param_3);
      } while (0 < iVar14);
    }
    iVar15 = ((param_1[0x12] - param_1[0x1f]) - local_80) + -1 + iVar3;
    iVar14 = iVar6;
    if (iVar15 < iVar6) {
      iVar14 = iVar15;
    }
    iVar15 = 0;
    lVar28 = 0;
    if (0 < iVar14) {
      do {
        uVar8 = param_1[0xe];
        uVar16 = (param_1[0x1f] - iVar4) + iVar15 + local_80 + param_1[0x10];
        if ((uVar8 <= uVar16) && ((param_1[8] - 2U & 0xfffffffd) == 0)) {
          if (uVar8 == 1) {
            uVar16 = 0;
          }
          else {
            do {
              uVar17 = (uint)(param_1[8] == 4);
              if (-1 < (int)uVar16) {
                uVar17 = uVar8 * 2 - uVar17;
              }
              uVar16 = (uVar17 - uVar16) - 1;
            } while (uVar8 <= uVar16);
          }
        }
        if (param_1[0x1e] + param_1[0x1b] <= (int)uVar16) break;
        lVar28 = lVar28 + 1;
        iVar15 = iVar15 + 1;
        *(longlong *)(lVar10 + -8 + lVar28 * 8) =
             (longlong)(((int)(uVar16 - param_1[0x1c]) % iVar6) * param_1[0x1a]) +
             *(longlong *)(param_1 + 0x18);
      } while (lVar28 < iVar14);
    }
    if (iVar15 < iVar3) {
      param_1[0x1f] = param_1[0x1f] + local_80;
      return (ulonglong)local_80;
    }
    iVar15 = iVar15 + (1 - iVar3);
    if (*(char *)(param_1 + 0x22) == '\0') {
      FUN_18005c4a0((longlong)param_1,lVar10,param_5,param_6,iVar15,param_1[0x11]);
    }
    else {
      FUN_18005c1f0((longlong)param_1,lVar10,param_5,param_6,iVar15,param_1[0x11]);
    }
    uVar25 = (ulonglong)uVar5;
    uVar27 = (ulonglong)uVar1;
    param_5 = param_5 + iVar15 * param_6;
    local_80 = local_80 + iVar15;
  } while( true );
}



void FUN_18005d270(uint *param_1,undefined8 param_2,uint *param_3,uint param_4)

{
  uint uVar1;
  int *piVar2;
  int iVar3;
  uint uVar4;
  void *pvVar5;
  longlong lVar6;
  uint uVar7;
  int *piVar8;
  longlong lVar9;
  uint uVar10;
  uint uVar11;
  longlong lVar12;
  uint uVar13;
  int *piVar14;
  int iVar15;
  uint uVar16;
  int iVar17;
  longlong lVar18;

  uVar7 = param_1[2];
  uVar16 = *param_1 & 7;
  *(undefined8 *)(param_1 + 0xd) = param_2;
  uVar11 = param_3[1];
  uVar1 = param_3[2];
  uVar10 = param_3[3];
  param_1[0xf] = *param_3;
  param_1[0x10] = uVar11;
  param_1[0x11] = uVar1;
  param_1[0x12] = uVar10;
  iVar17 = ((int)*param_1 >> 3 & 0x1ffU) + 1 << ((byte)(0xfa50 >> (char)uVar16 * '\x02') & 3);
  if ((int)param_4 < 0) {
    param_4 = param_1[4] + 3;
  }
  uVar11 = param_1[6];
  uVar10 = (param_1[4] - uVar11) - 1;
  uVar1 = uVar11;
  if ((int)uVar11 < (int)uVar10) {
    uVar1 = uVar10;
  }
  if ((int)param_4 < (int)(uVar1 * 2 + 1)) {
    if ((int)uVar11 < (int)uVar10) {
      uVar11 = uVar10;
    }
    param_4 = uVar11 * 2 + 1;
  }
  param_1[0x13] = param_4;
  pvVar5 = malloc((longlong)(int)param_4 << 3);
  uVar11 = param_1[0x11];
  *(void **)(param_1 + 0x14) = pvVar5;
  param_1[0xc] = uVar11;
  pvVar5 = malloc((longlong)(int)(((uVar11 - 1) + param_1[3]) * iVar17));
  *(void **)(param_1 + 0x16) = pvVar5;
  uVar13 = (uVar11 + 0xf & 0xfffffff0) *
           (((int)uVar7 >> 3 & 0x1ffU) + 1 << ((byte)(0xfa50 >> ((byte)uVar7 & 7) * '\x02') & 3));
  pvVar5 = malloc((longlong)(int)(uVar13 * param_4 + 0x10));
  uVar7 = param_1[5];
  uVar1 = param_1[0xf];
  uVar10 = param_1[0xd];
  *(void **)(param_1 + 0x18) = pvVar5;
  param_1[0x1a] = uVar13;
  uVar13 = uVar7 - uVar1;
  if ((int)(uVar7 - uVar1) < 0) {
    uVar13 = 0;
  }
  param_1[0x20] = uVar13;
  uVar11 = (uVar11 - 1) + ((uVar1 - uVar10) - uVar7) + param_1[3];
  if ((int)uVar11 < 0) {
    uVar11 = 0;
  }
  param_1[0x21] = uVar11;
  if ((0 < (int)uVar13) || (0 < (int)uVar11)) {
    piVar2 = *(int **)(param_1 + 10);
    uVar11 = uVar1;
    if ((int)uVar7 < (int)uVar1) {
      uVar11 = uVar7;
    }
    iVar15 = 0;
    iVar3 = 1;
    if (3 < uVar16) {
      iVar3 = 4;
    }
    iVar17 = iVar17 / iVar3;
    lVar18 = (longlong)iVar17;
    piVar14 = piVar2;
    if (0 < (int)uVar13) {
      do {
        uVar16 = param_1[7];
        uVar7 = iVar15 - param_1[0x20];
        if ((uVar10 <= uVar7) && ((uVar16 - 2 & 0xfffffffd) == 0)) {
          if (uVar10 == 1) {
            uVar7 = 0;
          }
          else {
            do {
              if ((int)uVar7 < 0) {
                uVar13 = (uint)(uVar16 == 4);
              }
              else {
                uVar13 = uVar10 * 2 - (uint)(uVar16 == 4);
              }
              uVar7 = (uVar13 - uVar7) - 1;
            } while (uVar10 <= uVar7);
          }
        }
        iVar3 = (uVar7 + (uVar11 - uVar1)) * iVar17;
        piVar8 = piVar14;
        lVar12 = lVar18;
        if (0 < iVar17) {
          do {
            *piVar8 = iVar3;
            iVar3 = iVar3 + 1;
            lVar12 = lVar12 + -1;
            piVar8 = piVar8 + 1;
          } while (lVar12 != 0);
        }
        iVar15 = iVar15 + 1;
        piVar14 = piVar14 + lVar18;
      } while (iVar15 < (int)param_1[0x20]);
    }
    if (0 < (int)param_1[0x21]) {
      lVar12 = 0;
      uVar7 = uVar10;
      do {
        uVar13 = param_1[7];
        uVar16 = uVar7;
        if ((uVar10 <= uVar7) && ((uVar13 - 2 & 0xfffffffd) == 0)) {
          if (uVar10 == 1) {
            uVar16 = 0;
          }
          else {
            do {
              if ((int)uVar16 < 0) {
                uVar4 = (uint)(uVar13 == 4);
              }
              else {
                uVar4 = uVar10 * 2 - (uint)(uVar13 == 4);
              }
              uVar16 = (uVar4 - uVar16) - 1;
            } while (uVar10 <= uVar16);
          }
        }
        lVar9 = 0;
        iVar3 = (uVar16 + (uVar11 - uVar1)) * iVar17;
        if (0 < iVar17) {
          do {
            lVar6 = ((int)param_1[0x20] + lVar12) * lVar18 + lVar9;
            lVar9 = lVar9 + 1;
            piVar2[lVar6] = iVar3;
            iVar3 = iVar3 + 1;
          } while (lVar9 < lVar18);
        }
        uVar7 = uVar7 + 1;
        lVar12 = lVar12 + 1;
      } while ((int)(uVar7 - uVar10) < (int)param_1[0x21]);
    }
  }
  uVar7 = param_1[0x10] - param_1[6];
  if ((int)uVar7 < 0) {
    uVar7 = 0;
  }
  *(undefined8 *)(param_1 + 0x1e) = 0;
  uVar11 = (param_1[4] - 1) + (param_1[0x12] - param_1[6]) + param_1[0x10];
  param_1[0x1b] = uVar7;
  param_1[0x1c] = uVar7;
  if ((int)param_1[0xe] < (int)uVar11) {
    uVar11 = param_1[0xe];
  }
  param_1[0x1d] = uVar11;
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18005d5d0(ulonglong *param_1,int *param_2,undefined8 param_3,int param_4,int param_5,
                  int param_6)

{
  int *piVar1;
  uint uVar2;
  uint *_Memory;
  int *local_res10;
  undefined8 local_res18;

  if ((((param_1[3] == 0) || (*(longlong *)(param_2 + 6) == 0)) || (*(int *)(param_1 + 2) != 2)) ||
     (param_2[4] != 2)) {
    return;
  }
  local_res10 = param_2;
  local_res18 = param_3;
  if ((param_2[1] != *(int *)((longlong)param_1 + 4)) || (*param_2 != *(int *)param_1)) {
    FUN_18005db40((int *)param_1,&local_res10);
  }
  piVar1 = local_res10;
  if ((((0 < (int)local_res18) && (0 < local_res18._4_4_)) || (-1 < param_4)) &&
     (((int)local_res18 != 1 || (local_res18._4_4_ != 1)))) {
    *(undefined4 *)(param_1 + 2) = 0x42ff0002;
    local_res10[4] = 0x42ff0002;
    *(uint *)(param_1 + 1) =
         ((*(int *)(param_1 + 2) >> 3 & 0x1ffU) + 1 <<
         ((byte)(0xfa50 >> ((byte)*(int *)(param_1 + 2) & 7) * '\x02') & 3)) * *(int *)param_1;
    *local_res10 = *(int *)param_1;
    local_res10[1] = *(int *)((longlong)param_1 + 4);
    local_res10[2] =
         ((local_res10[4] >> 3 & 0x1ffU) + 1 <<
         ((byte)(0xfa50 >> ((byte)local_res10[4] & 7) * '\x02') & 3)) * *local_res10;
    if (*(int *)((longlong)param_1 + 4) == 1) {
      local_res18._4_4_ = 1;
    }
    if (*(int *)param_1 == 1) {
      local_res18._0_4_ = 1;
    }
    _Memory = (uint *)FUN_18005c770(*(uint *)(param_1 + 2) & 0xfff,local_res10[4] & 0xfff,
                                    local_res18,param_4,param_5,param_6);
    uVar2 = _Memory[4] & 0x80000001;
    if ((int)uVar2 < 0) {
      uVar2 = (uVar2 - 1 | 0xfffffffe) + 1;
    }
    if (uVar2 == 1) {
      uVar2 = _Memory[3] & 0x80000001;
      if ((int)uVar2 < 0) {
        uVar2 = (uVar2 - 1 | 0xfffffffe) + 1;
      }
      if (uVar2 == 1) {
        *(bool *)(_Memory + 0x22) = (param_4 - 6U & 0xfffffffd) == 0;
        FUN_18005cc10(_Memory,param_1,(longlong)piVar1);
        piVar1[4] = 2;
        *(undefined4 *)(param_1 + 2) = 2;
        free(*(void **)(*(longlong *)(_Memory + 0x24) + 0x20));
        free(*(void **)(*(longlong *)(_Memory + 0x26) + 0x20));
        free(*(void **)(_Memory + 0x24));
        free(*(void **)(_Memory + 0x26));
        free(*(void **)(_Memory + 10));
        free(*(void **)(_Memory + 0x14));
        free(*(void **)(_Memory + 0x16));
        free(*(void **)(_Memory + 0x18));
        free(_Memory);
        return;
      }
    }
    FUN_18005db40((int *)param_1,&local_res10);
    return;
  }
  FUN_18005db40((int *)param_1,&local_res10);
  return;
}



undefined4 * FUN_18005d830(undefined4 *param_1,int param_2,uint param_3,int param_4)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int *piVar5;
  ulonglong uVar6;
  uint uVar7;
  int iVar8;
  int *piVar9;
  ulonglong uVar10;

  param_1[4] = param_2;
  *param_1 = 1;
  uVar6 = (ulonglong)param_3;
  param_1[1] = param_3;
  iVar8 = 0;
  piVar5 = (int *)malloc((longlong)
                         (int)(((param_2 >> 3 & 0x1ffU) + 1 <<
                               ((byte)(0xfa50 >> ((byte)param_2 & 7) * '\x02') & 3)) * param_3));
  *(int **)(param_1 + 6) = piVar5;
  if (param_4 == 0) {
    iVar1 = 0xb1721;
  }
  else {
    iVar1 = SUB164((SEXT816(0x1000000000000) & (undefined  [16])0xffffffffffffffff |
                   ZEXT816(0x1000000000000)) / SEXT816((longlong)param_4 * (longlong)param_4 * 2),0)
    ;
  }
  if (0 < (int)param_3) {
    iVar2 = -((int)(param_3 - 1) / 2);
    piVar9 = piVar5;
    uVar10 = uVar6;
    do {
      uVar3 = -(iVar2 * iVar2 * iVar1);
      uVar7 = (int)uVar3 >> 0x1f;
      uVar7 = (uVar3 ^ uVar7) - uVar7;
      if (uVar7 < 0xb1721) {
        uVar3 = FUN_18005ca90(uVar7);
        iVar4 = SUB164((ZEXT816(0) << 0x40 | ZEXT816(0x100000000)) / ZEXT416(uVar3),0);
      }
      else {
        iVar4 = 0;
      }
      *piVar9 = iVar4;
      piVar9 = piVar9 + 1;
      iVar8 = iVar8 + iVar4;
      iVar2 = iVar2 + 1;
      uVar10 = uVar10 - 1;
    } while (uVar10 != 0);
  }
  if ((iVar8 != 0) && (0 < (int)param_3)) {
    do {
      *piVar5 = (int)(((longlong)*piVar5 * 0x10000 + ((longlong)iVar8 >> 1)) / (longlong)iVar8);
      uVar6 = uVar6 - 1;
      piVar5 = piVar5 + 1;
    } while (uVar6 != 0);
  }
  return param_1;
}



undefined4 * FUN_18005d980(undefined4 *param_1,int param_2,int param_3)

{
  uint uVar1;
  undefined4 uVar2;
  int iVar3;
  undefined4 *puVar4;
  undefined8 *puVar5;
  undefined4 *puVar6;
  size_t _Size;
  ulonglong uVar7;

  param_1[4] = param_3;
  *param_1 = 1;
  if (param_3 == 4) {
    uVar1 = *(uint *)(&DAT_1800b0210 + (longlong)param_2 * 0x40);
    param_1[1] = uVar1;
    puVar4 = (undefined4 *)malloc((longlong)(int)(uVar1 * 4));
    *(undefined4 **)(param_1 + 6) = puVar4;
    if (0 < (int)uVar1) {
      uVar7 = (ulonglong)uVar1;
      puVar6 = (undefined4 *)(&DAT_1800b0214 + (longlong)param_2 * 0x40);
      do {
        uVar2 = *puVar6;
        puVar6 = puVar6 + 1;
        *puVar4 = uVar2;
        uVar7 = uVar7 - 1;
        puVar4 = puVar4 + 1;
      } while (uVar7 != 0);
    }
  }
  else {
    iVar3 = *(int *)(&DAT_1800b0210 + (longlong)param_2 * 0x40);
    param_1[1] = iVar3;
    _Size = SEXT48((int)(((param_3 >> 3 & 0x1ffU) + 1 <<
                         ((byte)(0xfa50 >> ((byte)param_3 & 7) * '\x02') & 3)) * iVar3));
    puVar5 = (undefined8 *)malloc(_Size);
    *(undefined8 **)(param_1 + 6) = puVar5;
    memcpy_FUN_180061f90(puVar5,(undefined8 *)(&DAT_1800b0214 + (longlong)param_2 * 0x40),_Size);
  }
  return param_1;
}



void FUN_18005da70(int *param_1,int param_2,int param_3,int param_4,int param_5)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int *piVar10;

  piVar10 = (int *)malloc(0x38);
  iVar1 = *param_1;
  iVar2 = param_1[1];
  iVar3 = param_1[1];
  iVar4 = param_1[2];
  iVar5 = param_1[3];
  iVar6 = param_1[4];
  iVar7 = param_1[5];
  iVar8 = param_1[6];
  iVar9 = param_1[7];
  piVar10[2] = *param_1;
  piVar10[3] = iVar3;
  piVar10[4] = iVar4;
  piVar10[5] = iVar5;
  piVar10[1] = param_2;
  piVar10[6] = iVar6;
  piVar10[7] = iVar7;
  piVar10[8] = iVar8;
  piVar10[9] = iVar9;
  piVar10[10] = param_4;
  piVar10[0xc] = param_3;
  piVar10[0xb] = param_5;
  *piVar10 = iVar2 + iVar1 + -1;
  return;
}



void FUN_18005dae0(int *param_1,int param_2,int param_3)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int *piVar10;

  piVar10 = (int *)malloc(0x30);
  iVar1 = param_1[1];
  iVar2 = *param_1;
  iVar3 = param_1[1];
  iVar4 = param_1[2];
  iVar5 = param_1[3];
  iVar6 = param_1[4];
  iVar7 = param_1[5];
  iVar8 = param_1[6];
  iVar9 = param_1[7];
  piVar10[1] = param_2;
  piVar10[2] = iVar2;
  piVar10[3] = iVar3;
  piVar10[4] = iVar4;
  piVar10[5] = iVar5;
  piVar10[6] = iVar6;
  piVar10[7] = iVar7;
  piVar10[8] = iVar8;
  piVar10[9] = iVar9;
  iVar2 = *param_1;
  piVar10[10] = param_3;
  *piVar10 = iVar1 + -1 + iVar2;
  return;
}



void FUN_18005db40(int *param_1,int **param_2)

{
  int *_Memory;

  if (((param_1 != (int *)0x0) && (param_2 != (int **)0x0)) &&
     (_Memory = *param_2, _Memory != (int *)0x0)) {
    if (_Memory[3] < param_1[3]) {
      free(_Memory);
      _Memory = FUN_18005dbc0(*param_1,param_1[1],param_1[4]);
      *param_2 = _Memory;
    }
    *_Memory = *param_1;
    _Memory[1] = param_1[1];
    _Memory[2] = param_1[2];
    _Memory[3] = param_1[3];
    _Memory[4] = param_1[4];
    memcpy_FUN_180061f90
              (*(undefined8 **)(_Memory + 6),*(undefined8 **)(param_1 + 6),(longlong)param_1[3]);
  }
  return;
}



int * FUN_18005dbc0(int param_1,int param_2,int param_3)

{
  int iVar1;
  int *piVar2;
  int iVar3;

  if (param_3 == 8) {
    iVar3 = param_1 * param_2;
    iVar1 = (int)(iVar3 + (iVar3 >> 0x1f & 7U)) >> 3;
    if (iVar1 * 8 < iVar3) {
      iVar1 = iVar1 + 1;
    }
    iVar3 = -1;
  }
  else {
    iVar1 = param_1 * param_2 * param_3;
    iVar3 = param_1 * param_3;
  }
  piVar2 = (int *)malloc((longlong)iVar1 + 0x20);
  if (piVar2 != (int *)0x0) {
    piVar2[3] = iVar1;
    *piVar2 = param_1;
    piVar2[1] = param_2;
    piVar2[4] = param_3;
    piVar2[2] = iVar3;
    *(int **)(piVar2 + 6) = piVar2 + 8;
  }
  return piVar2;
}



void FUN_18005dc70(longlong param_1,longlong param_2,longlong param_3,int param_4,int param_5)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  longlong lVar4;
  ushort *puVar5;
  uint uVar6;
  uint *puVar7;
  ushort *puVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  longlong lVar12;
  ulonglong uVar13;
  int iVar14;
  ulonglong uVar15;

  iVar1 = **(int **)(param_1 + 0x90);
  piVar2 = *(int **)(*(int **)(param_1 + 0x90) + 8);
  iVar3 = 0;
  iVar14 = param_4 * param_5;
  if (-1 < iVar14 + -4) {
    puVar8 = (ushort *)(param_2 + 4);
    uVar15 = (longlong)(iVar14 + -4) + 4U >> 2;
    iVar3 = (int)uVar15 * 4;
    puVar7 = (uint *)(param_3 + 8);
    do {
      uVar6 = (uint)puVar8[-2];
      uVar9 = (uint)puVar8[-1];
      uVar10 = (uint)*puVar8;
      uVar11 = (uint)puVar8[1];
      puVar5 = puVar8 + -2;
      if (1 < iVar1) {
        uVar13 = (ulonglong)(iVar1 - 1);
        do {
          puVar5 = puVar5 + param_5;
          uVar6 = uVar6 + *puVar5;
          uVar9 = uVar9 + puVar5[1];
          uVar10 = uVar10 + puVar5[2];
          uVar11 = uVar11 + puVar5[3];
          uVar13 = uVar13 - 1;
        } while (uVar13 != 0);
      }
      puVar8 = puVar8 + 4;
      puVar7[-2] = *piVar2 * uVar6 >> 0x10;
      puVar7[-1] = *piVar2 * uVar9 >> 0x10;
      *puVar7 = *piVar2 * uVar10 >> 0x10;
      puVar7[1] = *piVar2 * uVar11 >> 0x10;
      uVar15 = uVar15 - 1;
      puVar7 = puVar7 + 4;
    } while (uVar15 != 0);
  }
  lVar12 = (longlong)iVar3;
  if (lVar12 < iVar14) {
    puVar8 = (ushort *)(param_2 + lVar12 * 2);
    do {
      uVar6 = (uint)*puVar8;
      lVar4 = 1;
      if (1 < (longlong)iVar1) {
        do {
          puVar5 = puVar8 + lVar4;
          lVar4 = lVar4 + 1;
          uVar6 = uVar6 + *puVar5;
        } while (lVar4 < iVar1);
      }
      lVar12 = lVar12 + 1;
      puVar8 = puVar8 + 1;
      *(uint *)(param_3 + -4 + lVar12 * 4) = *piVar2 * uVar6 >> 0x10;
    } while (lVar12 < iVar14);
  }
  return;
}



void FUN_18005de20(longlong param_1,longlong param_2,longlong param_3,int param_4,int param_5)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  longlong lVar5;
  ushort *puVar6;
  longlong lVar7;
  uint uVar8;
  ushort *puVar9;
  uint uVar10;
  longlong lVar11;
  int iVar12;
  uint uVar13;
  uint uVar14;
  ulonglong uVar15;
  uint *puVar16;

  piVar3 = *(int **)(*(int **)(param_1 + 0x90) + 8);
  lVar7 = (longlong)**(int **)(param_1 + 0x90);
  iVar12 = 0;
  iVar4 = param_4 * param_5;
  if (-1 < iVar4 + -4) {
    puVar16 = (uint *)(param_3 + 8);
    uVar15 = (longlong)(iVar4 + -4) + 4U >> 2;
    puVar9 = (ushort *)(param_2 + 4);
    iVar12 = (int)uVar15 * 4;
    do {
      iVar2 = *piVar3;
      uVar13 = (uint)puVar9[-2] * iVar2;
      uVar14 = (uint)puVar9[-1] * iVar2;
      puVar6 = puVar9 + -2;
      lVar11 = 1;
      uVar10 = (uint)*puVar9 * iVar2;
      uVar8 = (uint)puVar9[1] * iVar2;
      if (1 < lVar7) {
        do {
          iVar2 = piVar3[lVar11];
          puVar6 = puVar6 + param_5;
          lVar11 = lVar11 + 1;
          uVar13 = uVar13 + (uint)*puVar6 * iVar2;
          uVar14 = uVar14 + (uint)puVar6[1] * iVar2;
          uVar10 = uVar10 + (uint)puVar6[2] * iVar2;
          uVar8 = uVar8 + (uint)puVar6[3] * iVar2;
        } while (lVar11 < lVar7);
      }
      puVar16[-2] = uVar13 >> 0x10;
      puVar16[-1] = uVar14 >> 0x10;
      *puVar16 = uVar10 >> 0x10;
      puVar16[1] = uVar8 >> 0x10;
      puVar16 = puVar16 + 4;
      puVar9 = puVar9 + 4;
      uVar15 = uVar15 - 1;
    } while (uVar15 != 0);
  }
  lVar11 = (longlong)iVar12;
  if (lVar11 < iVar4) {
    puVar9 = (ushort *)(param_2 + lVar11 * 2);
    do {
      lVar5 = 1;
      uVar8 = (uint)*puVar9 * *piVar3;
      puVar6 = puVar9;
      if (1 < lVar7) {
        do {
          piVar1 = piVar3 + lVar5;
          lVar5 = lVar5 + 1;
          uVar8 = uVar8 + *piVar1 * (uint)puVar6[param_5];
          puVar6 = puVar6 + param_5;
        } while (lVar5 < lVar7);
      }
      lVar11 = lVar11 + 1;
      puVar9 = puVar9 + 1;
      *(uint *)(param_3 + -4 + lVar11 * 4) = uVar8 >> 0x10;
    } while (lVar11 < iVar4);
  }
  return;
}



void TraceMessage(void)

{
                    // WARNING: Could not recover jumptable at 0x00018005e0cf. Too many branches
                    // WARNING: Treating indirect jump as call
  TraceMessage();
  return;
}



errno_t wcscpy_s(wchar_t *_Dst,rsize_t _SizeInWords,wchar_t *_Src)

{
  errno_t eVar1;

                    // WARNING: Could not recover jumptable at 0x00018005e117. Too many branches
                    // WARNING: Treating indirect jump as call
  eVar1 = wcscpy_s(_Dst,_SizeInWords,_Src);
  return eVar1;
}



errno_t _wfopen_s(FILE **_File,wchar_t *_Filename,wchar_t *_Mode)

{
  errno_t eVar1;

                    // WARNING: Could not recover jumptable at 0x00018005e11d. Too many branches
                    // WARNING: Treating indirect jump as call
  eVar1 = _wfopen_s(_File,_Filename,_Mode);
  return eVar1;
}



void __stdio_common_vswprintf_s(void)

{
                    // WARNING: Could not recover jumptable at 0x00018005e123. Too many branches
                    // WARNING: Treating indirect jump as call
  __stdio_common_vswprintf_s();
  return;
}



size_t fread_s(void *_DstBuf,size_t _DstSize,size_t _ElementSize,size_t _Count,FILE *_File)

{
  size_t sVar1;

                    // WARNING: Could not recover jumptable at 0x00018005e129. Too many branches
                    // WARNING: Treating indirect jump as call
  sVar1 = fread_s(_DstBuf,_DstSize,_ElementSize,_Count,_File);
  return sVar1;
}



int fclose(FILE *_File)

{
  int iVar1;

                    // WARNING: Could not recover jumptable at 0x00018005e12f. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = fclose(_File);
  return iVar1;
}



size_t fwrite(void *_Str,size_t _Size,size_t _Count,FILE *_File)

{
  size_t sVar1;

                    // WARNING: Could not recover jumptable at 0x00018005e135. Too many branches
                    // WARNING: Treating indirect jump as call
  sVar1 = fwrite(_Str,_Size,_Count,_File);
  return sVar1;
}



void __stdio_common_vsprintf_s(void)

{
                    // WARNING: Could not recover jumptable at 0x00018005e13b. Too many branches
                    // WARNING: Treating indirect jump as call
  __stdio_common_vsprintf_s();
  return;
}



void __stdio_common_vsnprintf_s(void)

{
                    // WARNING: Could not recover jumptable at 0x00018005e141. Too many branches
                    // WARNING: Treating indirect jump as call
  __stdio_common_vsnprintf_s();
  return;
}



void * calloc(size_t _Count,size_t _Size)

{
  void *pvVar1;

                    // WARNING: Could not recover jumptable at 0x00018005e147. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = calloc(_Count,_Size);
  return pvVar1;
}



void free(void *_Memory)

{
                    // WARNING: Could not recover jumptable at 0x00018005e14d. Too many branches
                    // WARNING: Treating indirect jump as call
  free(_Memory);
  return;
}



errno_t _localtime64_s(tm *_Tm,__time64_t *_Time)

{
  errno_t eVar1;

                    // WARNING: Could not recover jumptable at 0x00018005e153. Too many branches
                    // WARNING: Treating indirect jump as call
  eVar1 = _localtime64_s(_Tm,_Time);
  return eVar1;
}



size_t strftime(char *_Buf,size_t _SizeInBytes,char *_Format,tm *_Tm)

{
  size_t sVar1;

                    // WARNING: Could not recover jumptable at 0x00018005e159. Too many branches
                    // WARNING: Treating indirect jump as call
  sVar1 = strftime(_Buf,_SizeInBytes,_Format,_Tm);
  return sVar1;
}



__time64_t _time64(__time64_t *_Time)

{
  __time64_t _Var1;

                    // WARNING: Could not recover jumptable at 0x00018005e15f. Too many branches
                    // WARNING: Treating indirect jump as call
  _Var1 = _time64(_Time);
  return _Var1;
}



void * memset(void *_Dst,int _Val,size_t _Size)

{
  void *pvVar1;

                    // WARNING: Could not recover jumptable at 0x00018005e165. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = memset(_Dst,_Val,_Size);
  return pvVar1;
}



void __stdio_common_vswprintf(void)

{
                    // WARNING: Could not recover jumptable at 0x00018005e17d. Too many branches
                    // WARNING: Treating indirect jump as call
  __stdio_common_vswprintf();
  return;
}



errno_t _waccess_s(wchar_t *_Filename,int _AccessMode)

{
  errno_t eVar1;

                    // WARNING: Could not recover jumptable at 0x00018005e189. Too many branches
                    // WARNING: Treating indirect jump as call
  eVar1 = _waccess_s(_Filename,_AccessMode);
  return eVar1;
}



void __acrt_iob_func(void)

{
                    // WARNING: Could not recover jumptable at 0x00018005e18f. Too many branches
                    // WARNING: Treating indirect jump as call
  __acrt_iob_func();
  return;
}



void __stdio_common_vfwprintf(void)

{
                    // WARNING: Could not recover jumptable at 0x00018005e195. Too many branches
                    // WARNING: Treating indirect jump as call
  __stdio_common_vfwprintf();
  return;
}



errno_t _access_s(char *_Filename,int _AccessMode)

{
  errno_t eVar1;

                    // WARNING: Could not recover jumptable at 0x00018005e19b. Too many branches
                    // WARNING: Treating indirect jump as call
  eVar1 = _access_s(_Filename,_AccessMode);
  return eVar1;
}



void _invalid_parameter_noinfo(void)

{
                    // WARNING: Could not recover jumptable at 0x00018005e1a1. Too many branches
                    // WARNING: Treating indirect jump as call
  _invalid_parameter_noinfo();
  return;
}



int * _errno(void)

{
  int *piVar1;

                    // WARNING: Could not recover jumptable at 0x00018005e1a7. Too many branches
                    // WARNING: Treating indirect jump as call
  piVar1 = _errno();
  return piVar1;
}



void __stdio_common_vsprintf(void)

{
                    // WARNING: Could not recover jumptable at 0x00018005e1ad. Too many branches
                    // WARNING: Treating indirect jump as call
  __stdio_common_vsprintf();
  return;
}



void * malloc(size_t _Size)

{
  void *pvVar1;

                    // WARNING: Could not recover jumptable at 0x00018005e1b3. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = malloc(_Size);
  return pvVar1;
}



void _invalid_parameter_noinfo_noreturn(void)

{
                    // WARNING: Could not recover jumptable at 0x00018005e1b9. Too many branches
                    // WARNING: Treating indirect jump as call
  _invalid_parameter_noinfo_noreturn();
  return;
}



void * realloc(void *_Memory,size_t _NewSize)

{
  void *pvVar1;

                    // WARNING: Could not recover jumptable at 0x00018005e1bf. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = realloc(_Memory,_NewSize);
  return pvVar1;
}



undefined8 * FUN_18005e1d0(undefined8 *param_1)

{
  *param_1 = ChainBase::vftable;
  param_1[2] = 0;
  param_1[3] = 0;
  *(undefined2 *)(param_1 + 4) = 0;
  *(undefined8 *)((longlong)param_1 + 0x22) = 0;
  *(undefined8 *)((longlong)param_1 + 0x2a) = 0;
  *(undefined8 *)((longlong)param_1 + 0x32) = 0;
  *(undefined8 *)((longlong)param_1 + 0x3a) = 0;
  *(undefined8 *)((longlong)param_1 + 0x42) = 0;
  *(undefined8 *)((longlong)param_1 + 0x4a) = 0;
  *(undefined8 *)((longlong)param_1 + 0x52) = 0;
  *(undefined4 *)((longlong)param_1 + 0x5a) = 0;
  *(undefined2 *)((longlong)param_1 + 0x5e) = 0;
  *(undefined4 *)(param_1 + 1) = 0xffffffff;
  return param_1;
}



void FUN_18005e220(undefined8 *param_1)

{
  *param_1 = ChainBase::vftable;
  if ((undefined8 *)param_1[2] != (undefined8 *)0x0) {
    FUN_18005e220((undefined8 *)param_1[2]);
    FUN_18005f208();
    return;
  }
  return;
}



ulonglong FUN_18005e290(undefined **param_1,undefined8 param_2,undefined8 param_3,int *param_4,
                       undefined8 param_5,undefined8 param_6,undefined8 param_7)

{
  int iVar1;
  ulonglong uVar2;
  uint local_res8 [2];

  iVar1 = *(int *)(param_1 + 1);
  while (*param_4 != iVar1) {
    param_1 = (undefined **)((code **)param_1)[2];
    if ((code **)param_1 == (code **)0x0) {
      return 0;
    }
    iVar1 = *(int *)((code **)param_1 + 1);
  }
  if (((code **)param_1)[3] != (code *)0x0) {
    local_res8[0] = 1;
    (*((code **)param_1)[3])(param_2,param_3,param_4,param_5,param_6,local_res8,param_7);
    return (ulonglong)local_res8[0];
  }
  uVar2 = (**(code **)*param_1)();
  return uVar2;
}



undefined8 FUN_18005e350(void)

{
  return 0;
}



undefined8 FUN_18005e360(longlong param_1)

{
  longlong lVar1;
  undefined8 uVar2;
  longlong lVar3;

  uVar2 = 0;
  if (param_1 != 0) {
    lVar1 = DAT_1800b18e0;
    do {
      lVar3 = lVar1;
      if (*(int *)(param_1 + 8) == *(int *)(lVar3 + 8)) {
        uVar2 = 1;
      }
      lVar1 = *(longlong *)(lVar3 + 0x10);
    } while (*(longlong *)(lVar3 + 0x10) != 0);
    if ((int)uVar2 != 0) {
      return 0;
    }
    *(longlong *)(lVar3 + 0x10) = param_1;
    uVar2 = 1;
  }
  return uVar2;
}



void FUN_18005e3b0(undefined8 *param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined8 *puVar4;

  puVar4 = FUN_18005e8e0(param_1);
  *(undefined2 *)(puVar4 + 3) = 0;
  uVar1 = param_2[1];
  uVar2 = param_2[2];
  uVar3 = param_2[3];
  *(undefined4 *)(puVar4 + 4) = *param_2;
  *(undefined4 *)((longlong)puVar4 + 0x24) = uVar1;
  *(undefined4 *)(puVar4 + 5) = uVar2;
  *(undefined4 *)((longlong)puVar4 + 0x2c) = uVar3;
  return;
}



longlong **
FUN_18005e3f0(longlong **param_1,longlong **param_2,char param_3,longlong **param_4,
             undefined4 *param_5)

{
  char cVar1;
  longlong **pplVar2;
  longlong *plVar3;
  longlong **pplVar4;
  code *pcVar5;
  longlong *plVar6;
  longlong **pplVar7;
  longlong lVar8;
  longlong *plVar9;
  longlong **pplVar10;

  if ((longlong *)0x555555555555553 < param_1[1]) {
    FUN_180061ec0("map/set<T> too long");
    pcVar5 = (code *)swi(3);
    pplVar7 = (longlong **)(*pcVar5)();
    return pplVar7;
  }
  plVar6 = (longlong *)FUN_18005e3b0(param_1,param_5);
  param_1[1] = (longlong *)((longlong)param_1[1] + 1);
  plVar6[1] = (longlong)param_4;
  if (param_4 == (longlong **)*param_1) {
    (*param_1)[1] = (longlong)plVar6;
    **param_1 = (longlong)plVar6;
    (*param_1)[2] = (longlong)plVar6;
  }
  else {
    if (param_3 == '\0') {
      param_4[2] = plVar6;
      if (param_4 == (longlong **)(*param_1)[2]) {
        (*param_1)[2] = (longlong)plVar6;
      }
    }
    else {
      *param_4 = plVar6;
      if (param_4 == (longlong **)**param_1) {
        **param_1 = (longlong)plVar6;
      }
    }
  }
  cVar1 = *(char *)(plVar6[1] + 0x18);
  pplVar7 = (longlong **)plVar6;
  do {
    if (cVar1 != '\0') {
      lVar8 = (*param_1)[1];
      *param_2 = plVar6;
      *(undefined *)(lVar8 + 0x18) = 1;
      return param_2;
    }
    pplVar2 = (longlong **)((longlong *)pplVar7)[1];
    pplVar10 = (longlong **)((longlong *)pplVar7 + 1);
    pplVar4 = pplVar2 + 1;
    lVar8 = *pplVar2[1];
    if (pplVar2 == (longlong **)lVar8) {
      lVar8 = pplVar2[1][2];
      if (*(char *)(lVar8 + 0x18) == '\0') goto LAB_18005e583;
      if (pplVar7 == (longlong **)pplVar2[2]) {
        pplVar7 = (longlong **)pplVar2[2];
        pplVar2[2] = *pplVar7;
        if (*(char *)((longlong)*pplVar7 + 0x19) == '\0') {
          (*pplVar7)[1] = (longlong)pplVar2;
        }
        pplVar7[1] = *pplVar4;
        if (pplVar2 == (longlong **)(*param_1)[1]) {
          (*param_1)[1] = (longlong)pplVar7;
        }
        else {
          pplVar10 = (longlong **)*pplVar4;
          if (pplVar2 == (longlong **)*pplVar10) {
            *pplVar10 = (longlong *)pplVar7;
          }
          else {
            pplVar10[2] = (longlong *)pplVar7;
          }
        }
        *pplVar7 = (longlong *)pplVar2;
        *pplVar4 = (longlong *)pplVar7;
        pplVar7 = pplVar2;
        pplVar10 = pplVar4;
      }
      *(undefined *)(*pplVar10 + 3) = 1;
      *(undefined *)((*pplVar10)[1] + 0x18) = 0;
      plVar9 = (longlong *)(*pplVar10)[1];
      pplVar10 = (longlong **)*plVar9;
      *plVar9 = (longlong)pplVar10[2];
      if (*(char *)((longlong)pplVar10[2] + 0x19) == '\0') {
        *(longlong **)((longlong)pplVar10[2] + 8) = plVar9;
      }
      pplVar10[1] = (longlong *)plVar9[1];
      if (plVar9 == (longlong *)(*param_1)[1]) {
        (*param_1)[1] = (longlong)pplVar10;
        pplVar10[2] = plVar9;
      }
      else {
        plVar3 = (longlong *)plVar9[1];
        if (plVar9 == (longlong *)plVar3[2]) {
          plVar3[2] = (longlong)pplVar10;
          pplVar10[2] = plVar9;
        }
        else {
          *plVar3 = (longlong)pplVar10;
          pplVar10[2] = plVar9;
        }
      }
LAB_18005e651:
      plVar9[1] = (longlong)pplVar10;
    }
    else {
      if (*(char *)(lVar8 + 0x18) != '\0') {
        if (pplVar7 == (longlong **)*pplVar2) {
          plVar9 = *pplVar2;
          *pplVar2 = (longlong *)plVar9[2];
          if (*(char *)(plVar9[2] + 0x19) == '\0') {
            *(longlong ***)(plVar9[2] + 8) = pplVar2;
          }
          plVar9[1] = (longlong)*pplVar4;
          if (pplVar2 == (longlong **)(*param_1)[1]) {
            (*param_1)[1] = (longlong)plVar9;
          }
          else {
            pplVar7 = (longlong **)*pplVar4;
            if (pplVar2 == (longlong **)pplVar7[2]) {
              pplVar7[2] = plVar9;
            }
            else {
              *pplVar7 = plVar9;
            }
          }
          plVar9[2] = (longlong)pplVar2;
          *pplVar4 = plVar9;
          pplVar7 = pplVar2;
          pplVar10 = pplVar4;
        }
        *(undefined *)(*pplVar10 + 3) = 1;
        *(undefined *)((*pplVar10)[1] + 0x18) = 0;
        plVar9 = (longlong *)(*pplVar10)[1];
        pplVar10 = (longlong **)plVar9[2];
        plVar9[2] = (longlong)*pplVar10;
        if (*(char *)((longlong)*pplVar10 + 0x19) == '\0') {
          (*pplVar10)[1] = (longlong)plVar9;
        }
        pplVar10[1] = (longlong *)plVar9[1];
        if (plVar9 == (longlong *)(*param_1)[1]) {
          (*param_1)[1] = (longlong)pplVar10;
        }
        else {
          pplVar4 = (longlong **)plVar9[1];
          if (plVar9 == *pplVar4) {
            *pplVar4 = (longlong *)pplVar10;
          }
          else {
            pplVar4[2] = (longlong *)pplVar10;
          }
        }
        *pplVar10 = plVar9;
        goto LAB_18005e651;
      }
LAB_18005e583:
      *(undefined *)(pplVar2 + 3) = 1;
      *(undefined *)(lVar8 + 0x18) = 1;
      *(undefined *)((*pplVar10)[1] + 0x18) = 0;
      pplVar7 = (longlong **)(*pplVar10)[1];
    }
    cVar1 = *(char *)(((longlong *)pplVar7)[1] + 0x18);
  } while( true );
}



longlong **
FUN_18005e6a0(longlong **param_1,longlong **param_2,char param_3,int *param_4,undefined param_5)

{
  char cVar1;
  longlong **pplVar2;
  longlong **pplVar3;
  longlong **pplVar4;
  bool bVar5;
  longlong **pplVar6;
  longlong *local_res8;

  pplVar3 = (longlong **)*param_1;
  bVar5 = true;
  pplVar6 = pplVar3;
  if (*(char *)((longlong)pplVar3[1] + 0x19) == '\0') {
    pplVar4 = (longlong **)pplVar3[1];
    do {
      pplVar6 = pplVar4;
      if (param_3 == '\0') {
        bVar5 = *param_4 < *(int *)(pplVar6 + 4);
      }
      else {
        bVar5 = *param_4 <= *(int *)(pplVar6 + 4);
      }
      if (bVar5 == false) {
        pplVar4 = (longlong **)pplVar6[2];
      }
      else {
        pplVar4 = (longlong **)*pplVar6;
      }
    } while (*(char *)((longlong)pplVar4 + 0x19) == '\0');
  }
  pplVar4 = pplVar6;
  if (bVar5 != false) {
    if (pplVar6 == (longlong **)*pplVar3) {
      pplVar3 = FUN_18005e3f0(param_1,&local_res8,'\x01',pplVar6,param_4);
      *param_2 = *pplVar3;
      *(undefined *)(param_2 + 1) = 1;
      return param_2;
    }
    if (*(char *)((longlong)pplVar6 + 0x19) == '\0') {
      pplVar4 = (longlong **)*pplVar6;
      if (*(char *)((longlong)pplVar4 + 0x19) == '\0') {
        cVar1 = *(char *)((longlong)pplVar4[2] + 0x19);
        pplVar3 = (longlong **)pplVar4[2];
        while (cVar1 == '\0') {
          cVar1 = *(char *)((longlong)pplVar3[2] + 0x19);
          pplVar4 = pplVar3;
          pplVar3 = (longlong **)pplVar3[2];
        }
      }
      else {
        cVar1 = *(char *)((longlong)pplVar6[1] + 0x19);
        pplVar3 = (longlong **)pplVar6[1];
        pplVar4 = pplVar6;
        while ((pplVar2 = pplVar3, cVar1 == '\0' && (pplVar4 == (longlong **)*pplVar2))) {
          cVar1 = *(char *)((longlong)pplVar2[1] + 0x19);
          pplVar3 = (longlong **)pplVar2[1];
          pplVar4 = pplVar2;
        }
        if (*(char *)((longlong)pplVar4 + 0x19) == '\0') {
          pplVar4 = pplVar2;
        }
      }
    }
    else {
      pplVar4 = (longlong **)pplVar6[2];
    }
  }
  if (*(int *)(pplVar4 + 4) < *param_4) {
    pplVar3 = FUN_18005e3f0(param_1,&local_res8,bVar5,pplVar6,param_4);
    *param_2 = *pplVar3;
    *(undefined *)(param_2 + 1) = 1;
  }
  else {
    *param_2 = (longlong *)pplVar4;
    *(undefined *)(param_2 + 1) = 0;
  }
  return param_2;
}



void FUN_18005e800(void **param_1)

{
  char cVar1;
  longlong *plVar2;
  longlong *_Memory;

  cVar1 = *(char *)((longlong)*(longlong **)((longlong)*param_1 + 8) + 0x19);
  _Memory = *(longlong **)((longlong)*param_1 + 8);
  while (cVar1 == '\0') {
    FUN_18005e930(param_1,(longlong *)_Memory[2]);
    plVar2 = (longlong *)*_Memory;
    free(_Memory);
    cVar1 = *(char *)((longlong)plVar2 + 0x19);
    _Memory = plVar2;
  }
  *(void **)((longlong)*param_1 + 8) = *param_1;
  *(void **)*param_1 = *param_1;
  *(void **)((longlong)*param_1 + 0x10) = *param_1;
  param_1[1] = (void *)0x0;
  free(*param_1);
  return;
}



void FUN_18005e890(void)

{
  longlong lVar1;
  longlong extraout_RAX;

  lVar1 = FUN_18005f1cc(0x30);
  if (lVar1 == 0) {
    _invalid_parameter_noinfo_noreturn();
    lVar1 = extraout_RAX;
  }
  *(longlong *)lVar1 = lVar1;
  *(longlong *)(lVar1 + 8) = lVar1;
  *(longlong *)(lVar1 + 0x10) = lVar1;
  *(undefined2 *)(lVar1 + 0x18) = 0x101;
  return;
}



undefined8 * FUN_18005e8e0(undefined8 *param_1)

{
  undefined8 *puVar1;

  puVar1 = (undefined8 *)FUN_18005f1cc(0x30);
  if (puVar1 == (undefined8 *)0x0) {
    _invalid_parameter_noinfo_noreturn();
  }
  *puVar1 = *param_1;
  puVar1[1] = *param_1;
  puVar1[2] = *param_1;
  return puVar1;
}



void FUN_18005e930(undefined8 param_1,longlong *param_2)

{
  char cVar1;
  longlong *plVar2;

  cVar1 = *(char *)((longlong)param_2 + 0x19);
  while (cVar1 == '\0') {
    FUN_18005e930(param_1,(longlong *)param_2[2]);
    plVar2 = (longlong *)*param_2;
    free(param_2);
    cVar1 = *(char *)((longlong)plVar2 + 0x19);
    param_2 = plVar2;
  }
  return;
}



void FUN_18005e980(undefined8 param_1,void *param_2)

{
  free(param_2);
  return;
}



void FUN_18005e990(undefined8 param_1,void *param_2,ulonglong param_3)

{
  code *pcVar1;
  void *_Memory;

  if ((param_3 < 0x555555555555556) &&
     ((_Memory = param_2, param_3 * 0x30 < 0x1000 ||
      (((((ulonglong)param_2 & 0x1f) == 0 &&
        (_Memory = *(void **)((longlong)param_2 + -8), _Memory < param_2)) &&
       ((ulonglong)((longlong)param_2 + (-8 - (longlong)_Memory)) < 0x20)))))) {
    free(_Memory);
    return;
  }
  _invalid_parameter_noinfo_noreturn();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_18005e9f0(void)

{
  if ((DAT_1800b18e0 != 0) && (*(undefined8 **)(DAT_1800b18e0 + 0x10) != (undefined8 *)0x0)) {
    FUN_18005e220(*(undefined8 **)(DAT_1800b18e0 + 0x10));
    FUN_18005f208();
    *(undefined8 *)(DAT_1800b18e0 + 0x10) = 0;
  }
  if (DAT_1800b18e8 != (void **)0x0) {
    FUN_18005e800(DAT_1800b18e8);
    FUN_18005f208();
    DAT_1800b18e8 = (void **)0x0;
  }
  return;
}



undefined8 FUN_18005ea70(void)

{
  if ((DAT_1800b18e0 != 0) && (*(longlong *)(DAT_1800b18e0 + 0x10) != 0)) {
    return 1;
  }
  return 0;
}



void FUN_18005ea90(undefined8 param_1,undefined8 param_2,int *param_3,undefined8 param_4,
                  undefined8 param_5,undefined8 param_6)

{
  FUN_18005e290(DAT_1800b18e0,param_1,param_2,param_3,param_4,param_5,param_6);
  return;
}



void FUN_18005ead0(undefined2 *param_1)

{
  char cVar1;
  undefined8 *puVar2;
  undefined8 *puVar3;
  undefined8 *puVar4;
  undefined8 *puVar5;

  if (DAT_1800b18e8 != (longlong *)0x0) {
    puVar2 = (undefined8 *)*DAT_1800b18e8;
    cVar1 = *(char *)((longlong)(undefined8 *)puVar2[1] + 0x19);
    puVar4 = puVar2;
    puVar3 = (undefined8 *)puVar2[1];
    while (cVar1 == '\0') {
      if (*(int *)(puVar3 + 4) < CONCAT22(*param_1,param_1[2])) {
        puVar5 = (undefined8 *)puVar3[2];
        puVar3 = puVar4;
      }
      else {
        puVar5 = (undefined8 *)*puVar3;
      }
      cVar1 = *(char *)((longlong)puVar5 + 0x19);
      puVar4 = puVar3;
      puVar3 = puVar5;
    }
    if ((puVar4 == puVar2) || (CONCAT22(*param_1,param_1[2]) < *(int *)(puVar4 + 4))) {
      puVar4 = puVar2;
    }
    if (puVar4 != puVar2) {
                    // WARNING: Could not recover jumptable at 0x00018005eb2c. Too many branches
                    // WARNING: Treating indirect jump as call
      (*(code *)puVar4[5])();
      return;
    }
  }
  return;
}



undefined8 FUN_18005eb40(undefined2 *param_1,undefined8 param_2)

{
  char cVar1;
  longlong **pplVar2;
  longlong *plVar3;
  longlong *plVar4;
  longlong *plVar5;
  undefined local_res8;
  int local_28 [2];
  undefined8 local_20;
  longlong *local_18 [2];

  if (DAT_1800b18e8 == (longlong **)0x0) {
    pplVar2 = (longlong **)FUN_18005f1cc(0x10);
    if (pplVar2 == (longlong **)0x0) {
      DAT_1800b18e8 = (longlong **)0x0;
    }
    else {
      *pplVar2 = (longlong *)0x0;
      pplVar2[1] = (longlong *)0x0;
      plVar3 = (longlong *)FUN_18005e890();
      *pplVar2 = plVar3;
      DAT_1800b18e8 = pplVar2;
    }
  }
  local_28[0] = CONCAT22(*param_1,param_1[2]);
  plVar3 = *DAT_1800b18e8;
  cVar1 = *(char *)((longlong)(longlong *)plVar3[1] + 0x19);
  plVar5 = plVar3;
  pplVar2 = (longlong **)(longlong *)plVar3[1];
  while (cVar1 == '\0') {
    if (*(int *)(pplVar2 + 4) < local_28[0]) {
      plVar4 = pplVar2[2];
      pplVar2 = (longlong **)plVar5;
    }
    else {
      plVar4 = *pplVar2;
    }
    cVar1 = *(char *)((longlong)plVar4 + 0x19);
    plVar5 = (longlong *)pplVar2;
    pplVar2 = (longlong **)plVar4;
  }
  if ((plVar5 == plVar3) || (local_28[0] < *(int *)(plVar5 + 4))) {
    plVar5 = plVar3;
  }
  if (plVar5 != plVar3) {
    return 0;
  }
  local_20 = param_2;
  FUN_18005e6a0(DAT_1800b18e8,local_18,'\0',local_28,local_res8);
  return 1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

ulonglong FUN_18005ece4(undefined8 param_1,int param_2,longlong param_3)

{
  code *pcVar1;
  bool bVar2;
  byte bVar3;
  char cVar4;
  char cVar5;
  int iVar6;
  ulonglong uVar7;
  code **ppcVar8;

  if (param_2 == 0) {
    if (DAT_1800b18f0 < 1) {
      uVar7 = 0;
    }
    else {
      DAT_1800b18f0 = DAT_1800b18f0 + -1;
      cVar4 = __scrt_acquire_startup_lock();
      if (_DAT_1800b18f8 != 2) {
        FUN_18005fc44(7);
      }
      FUN_18005f434();
      FUN_18005fc04();
      FUN_18005feb8();
      _DAT_1800b18f8 = 0;
      FUN_18005f464();
      __scrt_release_startup_lock(cVar4);
      cVar4 = __scrt_uninitialize_crt(param_3 != 0,'\0');
      uVar7 = (ulonglong)(cVar4 != '\0');
    }
    return uVar7;
  }
  if (param_2 == 1) {
    uVar7 = __scrt_initialize_crt(0);
    if ((char)uVar7 != '\0') {
      cVar4 = __scrt_acquire_startup_lock();
      bVar2 = true;
      if (_DAT_1800b18f8 != 0) {
        FUN_18005fc44(7);
      }
      _DAT_1800b18f8 = 1;
      cVar5 = FUN_18005f378();
      if (cVar5 != '\0') {
        FUN_18005fe6c();
        FUN_18005fbf4();
        FUN_18005fc18();
        iVar6 = _initterm_e(&DAT_18006e5c0,&DAT_18006e5c8);
        if ((iVar6 == 0) && (uVar7 = __scrt_dllmain_after_initialize_c(), (char)uVar7 != '\0')) {
          _initterm(&DAT_18006e588,&DAT_18006e5b8);
          _DAT_1800b18f8 = 2;
          bVar2 = false;
        }
      }
      __scrt_release_startup_lock(cVar4);
      if (!bVar2) {
        ppcVar8 = (code **)FUN_18005fc34();
        if ((*ppcVar8 != (code *)0x0) &&
           (uVar7 = __scrt_is_nonwritable_in_current_image((longlong)ppcVar8), (char)uVar7 != '\0'))
        {
          pcVar1 = *ppcVar8;
          _guard_check_icall();
          (*pcVar1)(param_1,2,param_3);
        }
        DAT_1800b18f0 = DAT_1800b18f0 + 1;
        return 1;
      }
    }
    return 0;
  }
  if (param_2 == 2) {
    uVar7 = __scrt_dllmain_crt_thread_attach();
    bVar3 = (byte)uVar7;
  }
  else {
    if (param_2 != 3) {
      return 1;
    }
    bVar3 = FUN_18005f3b8();
  }
  return (ulonglong)bVar3;
}



// WARNING: Removing unreachable block (ram,0x00018005eff9)
// Library Function - Single Match
// Name: ?dllmain_raw@@YAHQEAUHINSTANCE__@@KQEAX@Z
// Library: Visual Studio 2015 Release
// int __cdecl dllmain_raw(struct HINSTANCE__ * __ptr64 const,unsigned long,void * __ptr64 const)

int dllmain_raw(HINSTANCE__ *param_1,ulong param_2,void *param_3)

{
  return 1;
}



ulonglong entry(HINSTANCE__ *param_1,ulong param_2,void *param_3)

{
  uint uVar1;
  ulonglong uVar2;
  undefined8 uVar3;

  if (param_2 == 1) {
    FUN_18005fb48();
  }
  if ((param_2 == 0) && (DAT_1800b18f0 < 1)) {
    return 0;
  }
  if (param_2 - 1 < 2) {
    uVar1 = dllmain_raw(param_1,param_2,param_3);
    if (uVar1 == 0) goto LAB_18005efb1;
    uVar2 = FUN_18005ece4(param_1,param_2,(longlong)param_3);
    uVar1 = (uint)uVar2;
    if (uVar1 == 0) goto LAB_18005efb1;
  }
  uVar3 = FUN_180054600(param_1,param_2);
  uVar1 = (uint)uVar3;
  if ((param_2 == 1) && (uVar1 == 0)) {
    FUN_180054600(param_1,0);
    FUN_18005ece4(param_1,0,(longlong)param_3);
    dllmain_raw(param_1,0,param_3);
  }
  if ((param_2 == 0) || (param_2 == 3)) {
    uVar2 = FUN_18005ece4(param_1,param_2,(longlong)param_3);
    uVar1 = (uint)uVar2;
    if (uVar1 != 0) {
      uVar1 = dllmain_raw(param_1,param_2,param_3);
    }
  }
LAB_18005efb1:
  return (ulonglong)uVar1;
}



undefined8 FUN_18005f068(undefined8 param_1,ulonglong param_2,undefined8 param_3,longlong param_4)

{
  FUN_18005f088(param_2,param_4,*(uint **)(param_4 + 0x38));
  return 1;
}



void FUN_18005f088(ulonglong param_1,longlong param_2,uint *param_3)

{
  ulonglong uVar1;
  ulonglong uVar2;

  uVar2 = param_1;
  if ((*(byte *)param_3 & 4) != 0) {
    uVar2 = (longlong)(int)param_3[1] + param_1 & (longlong)(int)-param_3[2];
  }
  uVar1 = (ulonglong)*(uint *)(*(longlong *)(param_2 + 0x10) + 8);
  if ((*(byte *)(uVar1 + 3 + *(longlong *)(param_2 + 8)) & 0xf) != 0) {
    param_1 = param_1 + (*(byte *)(uVar1 + 3 + *(longlong *)(param_2 + 8)) & 0xfffffff0);
  }
  FUN_18005f100(param_1 ^ *(ulonglong *)((longlong)(int)(*param_3 & 0xfffffff8) + uVar2));
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18005f100(longlong param_1)

{
  code *pcVar1;
  BOOL BVar2;
  undefined *puVar3;
  undefined auStack56 [8];
  undefined auStack48 [48];

  if ((param_1 == DAT_1800b04e8) && ((short)((ulonglong)param_1 >> 0x30) == 0)) {
    return;
  }
  puVar3 = auStack56;
  BVar2 = IsProcessorFeaturePresent(0x17);
  if (BVar2 != 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)(2);
    puVar3 = auStack48;
  }
  *(undefined8 *)(puVar3 + -8) = 0x18005f78e;
  capture_previous_context((PCONTEXT)&DAT_1800b19e0,puVar3[-8]);
  _DAT_1800b1950 = *(undefined8 *)(puVar3 + 0x38);
  _DAT_1800b1a78 = puVar3 + 0x40;
  _DAT_1800b1a60 = *(undefined8 *)(puVar3 + 0x40);
  _DAT_1800b1940 = 0xc0000409;
  _DAT_1800b1944 = 1;
  _DAT_1800b1958 = 1;
  DAT_1800b1960 = 2;
  *(longlong *)(puVar3 + 0x20) = DAT_1800b04e8;
  *(undefined8 *)(puVar3 + 0x28) = DAT_1800b04e0;
  *(undefined8 *)(puVar3 + -8) = 0x18005f830;
  DAT_1800b1ad8 = _DAT_1800b1950;
  __raise_securityfailure((_EXCEPTION_POINTERS *)&PTR_DAT_18007a1d0,puVar3[-8]);
  return;
}



// Library Function - Single Match
// Name: _alloca_probe
// Libraries: Visual Studio 2015 Debug, Visual Studio 2015 Release

void _alloca_probe(void)

{
  undefined *in_RAX;
  undefined *puVar1;
  undefined *puVar2;
  longlong in_GS_OFFSET;
  undefined local_res8 [32];

  puVar1 = local_res8 + -(longlong)in_RAX;
  if (local_res8 < in_RAX) {
    puVar1 = (undefined *)0x0;
  }
  puVar2 = *(undefined **)(in_GS_OFFSET + 0x10);
  if (puVar1 < puVar2) {
    do {
      puVar2 = puVar2 + -0x1000;
      *puVar2 = 0;
    } while ((undefined *)((ulonglong)puVar1 & 0xfffffffffffff000) != puVar2);
  }
  return;
}



// Library Function - Multiple Matches With Same Base Name
// Name: `scalar_deleting_destructor'
// Library: Visual Studio 2015 Release

undefined8 * _scalar_deleting_destructor_(undefined8 *param_1,ulonglong param_2)

{
  *param_1 = type_info::vftable;
  if ((param_2 & 1) != 0) {
    FUN_18005f208();
  }
  return param_1;
}



void FUN_18005f1cc(size_t param_1)

{
  code *pcVar1;
  int iVar2;
  void *pvVar3;

  do {
    pvVar3 = malloc(param_1);
    if (pvVar3 != (void *)0x0) {
      return;
    }
    iVar2 = _callnewh(param_1);
  } while (iVar2 != 0);
  if (param_1 != 0xffffffffffffffff) {
    FUN_18006013c();
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  FUN_18006015c();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



// WARNING: Exceeded maximum restarts with more pending

void FUN_18005f208(void)

{
                    // WARNING: Could not recover jumptable at 0x00018005e14d. Too many branches
                    // WARNING: Treating indirect jump as call
  free();
  return;
}



// WARNING: Exceeded maximum restarts with more pending

void FUN_18005f210(void)

{
                    // WARNING: Could not recover jumptable at 0x00018005e14d. Too many branches
                    // WARNING: Treating indirect jump as call
  free();
  return;
}



void free(void *_Memory)

{
                    // WARNING: Could not recover jumptable at 0x00018005e14d. Too many branches
                    // WARNING: Treating indirect jump as call
  free(_Memory);
  return;
}



void FUN_18005f264(void)

{
  ulonglong uVar1;

  uVar1 = FUN_18006034c();
  _configure_narrow_argv(uVar1 & 0xffffffff);
  return;
}



// Library Function - Single Match
// Name: __scrt_acquire_startup_lock
// Library: Visual Studio 2015 Release

ulonglong __scrt_acquire_startup_lock(void)

{
  ulonglong uVar1;
  ulonglong uVar2;
  longlong in_GS_OFFSET;
  bool bVar3;

  uVar2 = __scrt_is_ucrt_dll_in_use();
  if ((int)uVar2 == 0) {
LAB_18005f336:
    uVar2 = uVar2 & 0xffffffffffffff00;
  }
  else {
    uVar1 = *(ulonglong *)(*(longlong *)(in_GS_OFFSET + 0x30) + 8);
    do {
      LOCK();
      bVar3 = DAT_1800b1900 == 0;
      DAT_1800b1900 = DAT_1800b1900 ^ (ulonglong)bVar3 * (DAT_1800b1900 ^ uVar1);
      uVar2 = !bVar3 * DAT_1800b1900;
      if (bVar3) goto LAB_18005f336;
    } while (uVar1 != uVar2);
    uVar2 = CONCAT71((int7)(uVar2 >> 8),1);
  }
  return uVar2;
}



// Library Function - Single Match
// Name: __scrt_dllmain_after_initialize_c
// Library: Visual Studio 2015 Release

ulonglong __scrt_dllmain_after_initialize_c(void)

{
  ulonglong uVar1;
  undefined8 uVar2;

  uVar1 = __scrt_is_ucrt_dll_in_use();
  if ((int)uVar1 == 0) {
    uVar1 = FUN_18006034c();
    uVar1 = _configure_narrow_argv(uVar1 & 0xffffffff);
    if ((int)uVar1 != 0) {
      return uVar1 & 0xffffffffffffff00;
    }
    uVar2 = _initialize_narrow_environment();
  }
  else {
    uVar2 = FUN_180060190();
  }
  return CONCAT71((int7)((ulonglong)uVar2 >> 8),1);
}



bool FUN_18005f378(void)

{
  char cVar1;

  cVar1 = FUN_18005f4c4(0);
  return cVar1 != '\0';
}



// Library Function - Single Match
// Name: __scrt_dllmain_crt_thread_attach
// Library: Visual Studio 2015 Release

ulonglong __scrt_dllmain_crt_thread_attach(void)

{
  ulonglong uVar1;
  undefined8 uVar2;

  uVar1 = __vcrt_thread_attach();
  if ((char)uVar1 != '\0') {
    uVar2 = FUN_18006cd94();
    if ((char)uVar2 != '\0') {
      return CONCAT71((int7)((ulonglong)uVar2 >> 8),1);
    }
    uVar1 = __vcrt_thread_detach();
  }
  return uVar1 & 0xffffffffffffff00;
}



undefined FUN_18005f3b8(void)

{
  FUN_18006cd98();
  __vcrt_thread_detach();
  return 1;
}



void FUN_18005f3d0(undefined8 param_1,int param_2,undefined8 param_3,undefined *param_4,uint param_5
                  ,undefined8 param_6)

{
  ulonglong uVar1;

  uVar1 = __scrt_is_ucrt_dll_in_use();
  if (((int)uVar1 == 0) && (param_2 == 1)) {
    _guard_check_icall();
    (*(code *)param_4)(param_1,0,param_3);
  }
                    // WARNING: Could not recover jumptable at 0x00018006cbc6. Too many branches
                    // WARNING: Treating indirect jump as call
  _seh_filter_dll(param_5,param_6);
  return;
}



void FUN_18005f434(void)

{
  ulonglong uVar1;
  undefined8 uVar2;

  uVar1 = __scrt_is_ucrt_dll_in_use();
  if ((int)uVar1 != 0) {
                    // WARNING: Could not recover jumptable at 0x00018006cbe4. Too many branches
                    // WARNING: Treating indirect jump as call
    _execute_onexit_table(&DAT_1800b1908);
    return;
  }
  uVar2 = FUN_18006cda4();
  if ((int)uVar2 == 0) {
    _cexit();
  }
  return;
}



undefined FUN_18005f464(void)

{
  FUN_18006cda0();
  __vcrt_uninitialize_ptd();
  return 1;
}



// Library Function - Single Match
// Name: __scrt_initialize_crt
// Library: Visual Studio 2015 Release

ulonglong __scrt_initialize_crt(int param_1)

{
  uint uVar1;
  undefined4 extraout_var;
  ulonglong uVar2;

  if (param_1 == 0) {
    DAT_1800b1938 = 1;
  }
  FUN_180060190();
  uVar1 = __vcrt_initialize();
  uVar2 = CONCAT44(extraout_var,uVar1);
  if ((char)uVar1 != '\0') {
    uVar2 = FUN_18006cd90();
    if ((char)uVar2 != '\0') {
      return uVar2 & 0xffffffffffffff00 | 1;
    }
    uVar2 = __vcrt_uninitialize('\0');
  }
  return uVar2 & 0xffffffffffffff00;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_18005f4c4(uint param_1)

{
  code *pcVar1;
  byte bVar2;
  int iVar3;
  ulonglong uVar4;
  undefined8 uVar5;
  undefined4 local_28;
  undefined4 uStack36;

  if (DAT_1800b18fc == '\0') {
    if (1 < param_1) {
      FUN_18005fc44(5);
      pcVar1 = (code *)swi(3);
      uVar5 = (*pcVar1)();
      return uVar5;
    }
    uVar4 = __scrt_is_ucrt_dll_in_use();
    if (((int)uVar4 == 0) || (param_1 != 0)) {
      bVar2 = 0x40 - ((byte)DAT_1800b04e8 & 0x3f) & 0x3f;
      _DAT_1800b1918 = (0xffffffffffffffffU >> bVar2 | -1 << 0x40 - bVar2) ^ DAT_1800b04e8;
      local_28 = (undefined4)_DAT_1800b1918;
      uStack36 = (undefined4)(_DAT_1800b1918 >> 0x20);
      _DAT_1800b1908 = local_28;
      DAT_1800b190c = uStack36;
      DAT_1800b1910 = local_28;
      DAT_1800b1914 = uStack36;
      _DAT_1800b1920 = local_28;
      DAT_1800b1924 = uStack36;
      DAT_1800b1928 = local_28;
      DAT_1800b192c = uStack36;
      _DAT_1800b1930 = _DAT_1800b1918;
    }
    else {
      iVar3 = _initialize_onexit_table(&DAT_1800b1908);
      if ((iVar3 != 0) || (iVar3 = _initialize_onexit_table(&DAT_1800b1920), iVar3 != 0)) {
        return 0;
      }
    }
    DAT_1800b18fc = '\x01';
  }
  return 1;
}



// WARNING: Removing unreachable block (ram,0x00018005f632)
// Library Function - Single Match
// Name: __scrt_is_nonwritable_in_current_image
// Library: Visual Studio 2015 Release

ulonglong __scrt_is_nonwritable_in_current_image(longlong param_1)

{
  ulonglong uVar1;
  uint7 uVar2;
  IMAGE_SECTION_HEADER *pIVar3;

  pIVar3 = &IMAGE_SECTION_HEADER_180000218;
  uVar1 = 0;
  while (pIVar3 != (IMAGE_SECTION_HEADER *)&DAT_180000308) {
    if (((ulonglong)(uint)pIVar3->VirtualAddress <= param_1 - 0x180000000U) &&
       (uVar1 = (ulonglong)(uint)(pIVar3->Misc + pIVar3->VirtualAddress),
       param_1 - 0x180000000U < uVar1)) goto LAB_18005f61b;
    pIVar3 = pIVar3 + 1;
  }
  pIVar3 = (IMAGE_SECTION_HEADER *)0x0;
LAB_18005f61b:
  if (pIVar3 == (IMAGE_SECTION_HEADER *)0x0) {
    uVar1 = uVar1 & 0xffffffffffffff00;
  }
  else {
    uVar2 = (uint7)(uVar1 >> 8);
    if ((int)pIVar3->Characteristics < 0) {
      uVar1 = (ulonglong)uVar2 << 8;
    }
    else {
      uVar1 = CONCAT71(uVar2,1);
    }
  }
  return uVar1;
}



// Library Function - Single Match
// Name: __scrt_release_startup_lock
// Library: Visual Studio 2015 Release

void __scrt_release_startup_lock(char param_1)

{
  ulonglong uVar1;

  uVar1 = __scrt_is_ucrt_dll_in_use();
  if (((int)uVar1 != 0) && (param_1 == '\0')) {
    DAT_1800b1900 = 0;
  }
  return;
}



// Library Function - Single Match
// Name: __scrt_uninitialize_crt
// Library: Visual Studio 2015 Release

undefined __scrt_uninitialize_crt(char param_1,char param_2)

{
  if ((DAT_1800b1938 == '\0') || (param_2 == '\0')) {
    FUN_18006cd9c();
    __vcrt_uninitialize(param_1);
  }
  return 1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
// Name: _onexit
// Library: Visual Studio 2015 Release

_onexit_t _onexit(_onexit_t _Func)

{
  int iVar1;
  byte bVar2;
  _onexit_t p_Var3;

  bVar2 = (byte)DAT_1800b04e8 & 0x3f;
  if (((DAT_1800b04e8 ^ _DAT_1800b1908) >> bVar2 | (DAT_1800b04e8 ^ _DAT_1800b1908) << 0x40 - bVar2)
      == 0xffffffffffffffff) {
    iVar1 = _crt_atexit();
  }
  else {
    iVar1 = _register_onexit_function(&DAT_1800b1908,_Func);
  }
  p_Var3 = (_onexit_t)0x0;
  if (iVar1 == 0) {
    p_Var3 = _Func;
  }
  return p_Var3;
}



// Library Function - Single Match
// Name: __raise_securityfailure
// Library: Visual Studio 2015 Release

void __raise_securityfailure(_EXCEPTION_POINTERS *param_1)

{
  HANDLE hProcess;

  SetUnhandledExceptionFilter((LPTOP_LEVEL_EXCEPTION_FILTER)0x0);
  UnhandledExceptionFilter(param_1);
  hProcess = GetCurrentProcess();
                    // WARNING: Could not recover jumptable at 0x00018005f75d. Too many branches
                    // WARNING: Treating indirect jump as call
  TerminateProcess(hProcess,0xc0000409);
  return;
}



// Library Function - Single Match
// Name: __report_rangecheckfailure
// Libraries: Visual Studio 2012 Debug, Visual Studio 2012 Release, Visual Studio 2015 Debug, Visual
// Studio 2015 Release

void __report_rangecheckfailure(void)

{
  __report_securityfailure(8);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
// Name: __report_securityfailure
// Library: Visual Studio 2015 Release

void __report_securityfailure(uint param_1)

{
  code *pcVar1;
  BOOL BVar2;
  undefined *puVar3;
  undefined auStack40 [8];
  undefined auStack32 [32];

  puVar3 = auStack40;
  BVar2 = IsProcessorFeaturePresent(0x17);
  if (BVar2 != 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)(param_1);
    puVar3 = auStack32;
  }
  *(undefined8 *)(puVar3 + -8) = 0x18005f876;
  capture_current_context((PCONTEXT)&DAT_1800b19e0,puVar3[-8]);
  _DAT_1800b1950 = *(undefined8 *)(puVar3 + 0x28);
  _DAT_1800b1a78 = puVar3 + 0x30;
  _DAT_1800b1940 = 0xc0000409;
  _DAT_1800b1944 = 1;
  _DAT_1800b1958 = 1;
  DAT_1800b1960 = (ulonglong)*(uint *)(puVar3 + 0x30);
  *(undefined8 *)(puVar3 + -8) = 0x18005f8e2;
  DAT_1800b1ad8 = _DAT_1800b1950;
  __raise_securityfailure((_EXCEPTION_POINTERS *)&PTR_DAT_18007a1d0,puVar3[-8]);
  return;
}



// Library Function - Single Match
// Name: capture_current_context
// Library: Visual Studio 2015 Release

void capture_current_context(PCONTEXT param_1)

{
  DWORD64 ControlPc;
  PRUNTIME_FUNCTION FunctionEntry;
  DWORD64 local_res8;
  ulonglong local_res10;
  PVOID local_res18;

  RtlCaptureContext();
  ControlPc = param_1->Rip;
  FunctionEntry = RtlLookupFunctionEntry(ControlPc,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
  if (FunctionEntry != (PRUNTIME_FUNCTION)0x0) {
    RtlVirtualUnwind(0,local_res8,ControlPc,FunctionEntry,param_1,&local_res18,&local_res10,
                     (PKNONVOLATILE_CONTEXT_POINTERS)0x0);
  }
  return;
}



// Library Function - Single Match
// Name: capture_previous_context
// Library: Visual Studio 2015 Release

void capture_previous_context(PCONTEXT param_1)

{
  DWORD64 ControlPc;
  PRUNTIME_FUNCTION FunctionEntry;
  int iVar1;
  DWORD64 local_res8;
  ulonglong local_res10;
  PVOID local_res18 [2];

  RtlCaptureContext();
  ControlPc = param_1->Rip;
  iVar1 = 0;
  do {
    FunctionEntry = RtlLookupFunctionEntry(ControlPc,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
    if (FunctionEntry == (PRUNTIME_FUNCTION)0x0) {
      return;
    }
    RtlVirtualUnwind(0,local_res8,ControlPc,FunctionEntry,param_1,local_res18,&local_res10,
                     (PKNONVOLATILE_CONTEXT_POINTERS)0x0);
    iVar1 = iVar1 + 1;
  } while (iVar1 < 2);
  return;
}



ulonglong FUN_18005fadc(void)

{
  DWORD DVar1;
  _FILETIME local_res8;
  _FILETIME local_res10;
  uint local_res18;
  undefined4 uStackX28;

  local_res10 = (_FILETIME)0x0;
  GetSystemTimeAsFileTime((LPFILETIME)&local_res10);
  local_res8 = local_res10;
  DVar1 = GetCurrentThreadId();
  local_res8 = (_FILETIME)((ulonglong)local_res8 ^ (ulonglong)DVar1);
  DVar1 = GetCurrentProcessId();
  local_res8 = (_FILETIME)((ulonglong)local_res8 ^ (ulonglong)DVar1);
  QueryPerformanceCounter((LARGE_INTEGER *)&local_res18);
  return ((ulonglong)local_res18 << 0x20 ^ CONCAT44(uStackX28,local_res18) ^ (ulonglong)local_res8 ^
         (ulonglong)&local_res8) & 0xffffffffffff;
}



void FUN_18005fb48(void)

{
  DWORD DVar1;
  _FILETIME local_res8;
  _FILETIME local_res10;
  uint local_res18;
  undefined4 uStackX28;

  if (DAT_1800b04e8 == 0x2b992ddfa232) {
    local_res10 = (_FILETIME)0x0;
    GetSystemTimeAsFileTime((LPFILETIME)&local_res10);
    local_res8 = local_res10;
    DVar1 = GetCurrentThreadId();
    local_res8 = (_FILETIME)((ulonglong)local_res8 ^ (ulonglong)DVar1);
    DVar1 = GetCurrentProcessId();
    local_res8 = (_FILETIME)((ulonglong)local_res8 ^ (ulonglong)DVar1);
    QueryPerformanceCounter((LARGE_INTEGER *)&local_res18);
    DAT_1800b04e8 =
         ((ulonglong)local_res18 << 0x20 ^ CONCAT44(uStackX28,local_res18) ^ (ulonglong)local_res8 ^
         (ulonglong)&local_res8) & 0xffffffffffff;
    if (DAT_1800b04e8 == 0x2b992ddfa232) {
      DAT_1800b04e8 = 0x2b992ddfa233;
    }
  }
  DAT_1800b04e0 = ~DAT_1800b04e8;
  return;
}



void FUN_18005fbf4(void)

{
                    // WARNING: Could not recover jumptable at 0x00018005fbfb. Too many branches
                    // WARNING: Treating indirect jump as call
  InitializeSListHead((PSLIST_HEADER)&DAT_1800b1eb0);
  return;
}



void FUN_18005fc04(void)

{
  _SLIST_ENTRY _Var1;
  _SLIST_ENTRY _Var2;

  _Var2 = (_SLIST_ENTRY)InterlockedFlushSList((PSLIST_HEADER)&DAT_1800b1eb0);
  while (_Var2 != (_SLIST_ENTRY)0x0) {
    _Var1 = *(_SLIST_ENTRY *)_Var2;
    _free_base(_Var2);
    _Var2 = _Var1;
  }
  return;
}



undefined * FUN_18005fc10(void)

{
  return &DAT_1800b1ec0;
}



void FUN_18005fc18(void)

{
  ulonglong *puVar1;

  puVar1 = (ulonglong *)FUN_18003ded0();
  *puVar1 = *puVar1 | 4;
  puVar1 = (ulonglong *)FUN_18005fc10();
  *puVar1 = *puVar1 | 2;
  return;
}



undefined * FUN_18005fc34(void)

{
  return &DAT_180106d50;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18005fc3c(void)

{
  _DAT_1800b1ec8 = 0;
  return;
}



void FUN_18005fc44(uint param_1)

{
  code *pcVar1;
  BOOL BVar2;
  LONG LVar3;
  PRUNTIME_FUNCTION FunctionEntry;
  undefined *puVar4;
  undefined8 in_stack_00000000;
  DWORD64 local_res10;
  undefined local_res18 [8];
  undefined local_res20 [8];
  undefined auStack1480 [8];
  undefined auStack1472 [232];
  undefined local_4d8 [152];
  undefined *local_440;
  DWORD64 local_3e0;

  puVar4 = auStack1480;
  BVar2 = IsProcessorFeaturePresent(0x17);
  if (BVar2 != 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)(param_1);
    puVar4 = auStack1472;
  }
  *(undefined8 *)(puVar4 + -8) = 0x18005fc77;
  FUN_18005fc3c(puVar4[-8]);
  *(undefined8 *)(puVar4 + -8) = 0x18005fc88;
  memset(local_4d8,0,0x4d0,puVar4[-8]);
  *(undefined8 *)(puVar4 + -8) = 0x18005fc92;
  RtlCaptureContext(local_4d8);
  *(undefined8 *)(puVar4 + -8) = 0x18005fcac;
  FunctionEntry =
       RtlLookupFunctionEntry(local_3e0,&local_res10,(PUNWIND_HISTORY_TABLE)0x0,puVar4[-8]);
  if (FunctionEntry != (PRUNTIME_FUNCTION)0x0) {
    *(undefined8 *)(puVar4 + 0x38) = 0;
    *(undefined **)(puVar4 + 0x30) = local_res18;
    *(undefined **)(puVar4 + 0x28) = local_res20;
    *(undefined **)(puVar4 + 0x20) = local_4d8;
    *(undefined8 *)(puVar4 + -8) = 0x18005fced;
    RtlVirtualUnwind(0,local_res10,local_3e0,FunctionEntry,*(PCONTEXT *)(puVar4 + 0x20),
                     *(PVOID **)(puVar4 + 0x28),*(PDWORD64 *)(puVar4 + 0x30),
                     *(PKNONVOLATILE_CONTEXT_POINTERS *)(puVar4 + 0x38));
  }
  local_440 = &stack0x00000008;
  *(undefined8 *)(puVar4 + -8) = 0x18005fd1f;
  memset(puVar4 + 0x50,0,0x98,puVar4[-8]);
  *(undefined8 *)(puVar4 + 0x60) = in_stack_00000000;
  *(undefined4 *)(puVar4 + 0x50) = 0x40000015;
  *(undefined4 *)(puVar4 + 0x54) = 1;
  *(undefined8 *)(puVar4 + -8) = 0x18005fd41;
  BVar2 = IsDebuggerPresent(puVar4[-8]);
  *(undefined **)(puVar4 + 0x40) = puVar4 + 0x50;
  *(undefined **)(puVar4 + 0x48) = local_4d8;
  *(undefined8 *)(puVar4 + -8) = 0x18005fd62;
  SetUnhandledExceptionFilter((LPTOP_LEVEL_EXCEPTION_FILTER)0x0,puVar4[-8]);
  *(undefined8 *)(puVar4 + -8) = 0x18005fd6d;
  LVar3 = UnhandledExceptionFilter((_EXCEPTION_POINTERS *)(puVar4 + 0x40),puVar4[-8]);
  if ((LVar3 == 0) && (BVar2 != 1)) {
    *(undefined8 *)(puVar4 + -8) = 0x18005fd7d;
    FUN_18005fc3c(puVar4[-8]);
  }
  return;
}



void FUN_18005fe6c(void)

{
  code *pcVar1;
  code **ppcVar2;

  ppcVar2 = (code **)&DAT_1800a5a58;
  while (ppcVar2 < &DAT_1800a5a58) {
    pcVar1 = *ppcVar2;
    if (pcVar1 != (code *)0x0) {
      _guard_check_icall();
      (*pcVar1)();
    }
    ppcVar2 = ppcVar2 + 1;
  }
  return;
}



void FUN_18005feb8(void)

{
  code *pcVar1;
  code **ppcVar2;

  ppcVar2 = (code **)&DAT_1800a5a68;
  while (ppcVar2 < &DAT_1800a5a68) {
    pcVar1 = *ppcVar2;
    if (pcVar1 != (code *)0x0) {
      _guard_check_icall();
      (*pcVar1)();
    }
    ppcVar2 = ppcVar2 + 1;
  }
  return;
}



void _guard_check_icall(void)

{
  return;
}



undefined8 * FUN_18005ff64(undefined8 *param_1)

{
  param_1[2] = 0;
  param_1[1] = "bad allocation";
  *param_1 = std::bad_alloc::vftable;
  return param_1;
}



undefined8 * FUN_18005ff84(undefined8 *param_1,longlong param_2)

{
  *param_1 = std::exception::vftable;
  param_1[1] = (char *)0x0;
  param_1[2] = 0;
  __std_exception_copy((char **)(param_2 + 8),(char **)(param_1 + 1));
  *param_1 = std::bad_array_new_length::vftable;
  return param_1;
}



undefined8 * FUN_18005ffc4(undefined8 *param_1)

{
  param_1[2] = 0;
  param_1[1] = "bad array new length";
  *param_1 = std::bad_array_new_length::vftable;
  return param_1;
}



// Library Function - Single Match
// Name: ??0exception@std@@QEAA@AEBV01@@Z
// Library: Visual Studio 2015 Release
// public: __cdecl std::exception::exception(class std::exception const & __ptr64) __ptr64

void __thiscall std::exception::exception(exception *this,exception *param_1)

{
  *(undefined ***)this = vftable;
  *(char **)(this + 8) = (char *)0x0;
  *(undefined8 *)(this + 0x10) = 0;
  __std_exception_copy((char **)(param_1 + 8),(char **)(this + 8));
  return;
}



undefined8 * FUN_180060070(undefined8 *param_1,ulonglong param_2)

{
  *param_1 = std::exception::vftable;
  __std_exception_destroy((void **)(param_1 + 1));
  if ((param_2 & 1) != 0) {
    FUN_18005f208();
  }
  return param_1;
}



undefined8 * FUN_1800600b4(undefined8 *param_1,ulonglong param_2)

{
  *param_1 = std::exception::vftable;
  __std_exception_destroy((void **)(param_1 + 1));
  if ((param_2 & 1) != 0) {
    FUN_18005f208();
  }
  return param_1;
}



undefined8 * FUN_1800600f8(undefined8 *param_1,ulonglong param_2)

{
  *param_1 = std::exception::vftable;
  __std_exception_destroy((void **)(param_1 + 1));
  if ((param_2 & 1) != 0) {
    FUN_18005f208();
  }
  return param_1;
}



void FUN_18006013c(void)

{
  code *pcVar1;
  undefined8 local_28 [5];

  FUN_18005ff64(local_28);
  _CxxThrowException(local_28,(ThrowInfo *)&DAT_1800ace38);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_18006015c(void)

{
  code *pcVar1;
  undefined8 local_28 [5];

  FUN_18005ffc4(local_28);
  _CxxThrowException(local_28,(ThrowInfo *)&DAT_1800acec0);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



char * FUN_18006017c(longlong param_1)

{
  char *pcVar1;

  pcVar1 = "Unknown exception";
  if (*(longlong *)(param_1 + 8) != 0) {
    pcVar1 = *(char **)(param_1 + 8);
  }
  return pcVar1;
}



// WARNING: Removing unreachable block (ram,0x00018006029b)
// WARNING: Removing unreachable block (ram,0x0001800601fe)
// WARNING: Removing unreachable block (ram,0x0001800601ba)
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_180060190(void)

{
  int *piVar1;
  uint *puVar2;
  longlong lVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  byte in_XCR0;

  DAT_1800b04fc = 2;
  DAT_1800b04f8 = 1;
  piVar1 = (int *)cpuid_basic_info(0);
  uVar6 = 0;
  puVar2 = (uint *)cpuid_Version_info(1);
  uVar4 = puVar2[3];
  if ((piVar1[3] ^ 0x6c65746eU | piVar1[1] ^ 0x756e6547U | piVar1[2] ^ 0x49656e69U) == 0) {
    _DAT_1800b0500 = 0xffffffffffffffff;
    uVar5 = *puVar2 & 0xfff3ff0;
    if ((((uVar5 == 0x106c0) || (uVar5 == 0x20660)) || (uVar5 == 0x20670)) ||
       ((uVar5 - 0x30650 < 0x21 &&
        ((0x100010001U >> ((ulonglong)(uVar5 - 0x30650) & 0x3f) & 1) != 0)))) {
      DAT_1800b1ecc = DAT_1800b1ecc | 1;
    }
  }
  if (((piVar1[1] ^ 0x68747541U | piVar1[2] ^ 0x69746e65U | piVar1[3] ^ 0x444d4163U) == 0) &&
     (0x6010ff < (*puVar2 & 0xff00f00))) {
    DAT_1800b1ecc = DAT_1800b1ecc | 4;
  }
  if (6 < *piVar1) {
    lVar3 = cpuid_Extended_Feature_Enumeration_info(7);
    uVar6 = *(uint *)(lVar3 + 4);
    if ((uVar6 >> 9 & 1) != 0) {
      DAT_1800b1ecc = DAT_1800b1ecc | 2;
    }
  }
  if ((uVar4 >> 0x14 & 1) != 0) {
    DAT_1800b04f8 = 2;
    DAT_1800b04fc = 6;
    if ((((uVar4 >> 0x1b & 1) != 0) && ((uVar4 >> 0x1c & 1) != 0)) && ((in_XCR0 & 6) == 6)) {
      DAT_1800b04fc = 0xe;
      DAT_1800b04f8 = 3;
      if ((uVar6 & 0x20) != 0) {
        DAT_1800b04f8 = 5;
        DAT_1800b04fc = 0x2e;
      }
    }
  }
  return 0;
}



undefined8 FUN_18006034c(void)

{
  return 1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
// Name: __scrt_is_ucrt_dll_in_use
// Library: Visual Studio 2015 Release

ulonglong __scrt_is_ucrt_dll_in_use(void)

{
  return (ulonglong)(_DAT_1800b0544 != 0);
}



void _guard_check_icall(void)

{
  return;
}



// Library Function - Single Match
// Name: ?_com_dispatch_method@@YAJPEAUIDispatch@@JGGPEAXPEBGZZ
// Library: Visual Studio 2015 Release
// long __cdecl _com_dispatch_method(struct IDispatch * __ptr64,long,unsigned short,unsigned
// short,void * __ptr64,unsigned short const * __ptr64,...)

long _com_dispatch_method
               (IDispatch *param_1,long param_2,ushort param_3,ushort param_4,void *param_5,
               ushort *param_6,...)

{
  undefined *puVar1;
  int iVar2;
  undefined8 local_28 [3];

  iVar2 = FUN_180060c90((longlong *)param_1,param_2,param_3,param_4,(undefined8 *)param_5,param_6,
                        (longlong)&stack0x00000038,local_28);
  puVar1 = PTR__com_raise_error_1800b0510;
  if (iVar2 < 0) {
    _guard_check_icall();
    (*(code *)puVar1)(iVar2,local_28[0]);
  }
  return (long)iVar2;
}



// Library Function - Single Match
// Name: ?_com_dispatch_propget@@YAJPEAUIDispatch@@JGPEAX@Z
// Library: Visual Studio 2015 Release
// long __cdecl _com_dispatch_propget(struct IDispatch * __ptr64,long,unsigned short,void * __ptr64)

long _com_dispatch_propget(IDispatch *param_1,long param_2,ushort param_3,void *param_4)

{
  long lVar1;

  lVar1 = _com_dispatch_method(param_1,param_2,2,param_3,param_4,(ushort *)0x0);
  return lVar1;
}



// Library Function - Single Match
// Name: ?_com_dispatch_propput@@YAJPEAUIDispatch@@JGZZ
// Library: Visual Studio 2015 Release
// long __cdecl _com_dispatch_propput(struct IDispatch * __ptr64,long,unsigned short,...)

long _com_dispatch_propput(IDispatch *param_1,long param_2,ushort param_3,...)

{
  undefined *puVar1;
  ushort uVar2;
  int iVar3;
  undefined8 in_R9;
  undefined8 local_res20;
  ushort local_28;
  undefined2 local_26;
  undefined8 local_20 [2];

  local_26 = 0;
  uVar2 = 8;
  if ((param_3 - 9 & 0xfffb) != 0) {
    uVar2 = 4;
  }
  local_res20 = in_R9;
  local_28 = param_3;
  iVar3 = FUN_180060c90((longlong *)param_1,param_2,uVar2,0,(undefined8 *)0x0,&local_28,
                        (longlong)&local_res20,local_20);
  puVar1 = PTR__com_raise_error_1800b0510;
  if (iVar3 < 0) {
    _guard_check_icall();
    (*(code *)puVar1)(iVar3,local_20[0]);
  }
  return (long)iVar3;
}



// Library Function - Single Match
// Name: ?_com_issue_error@@YAXJ@Z
// Library: Visual Studio 2015 Release
// void __cdecl _com_issue_error(long)

void _com_issue_error(long param_1)

{
  undefined *UNRECOVERED_JUMPTABLE;

  UNRECOVERED_JUMPTABLE = PTR__com_raise_error_1800b0510;
  _guard_check_icall();
                    // WARNING: Could not recover jumptable at 0x00018006052c. Too many branches
                    // WARNING: Treating indirect jump as call
  (*(code *)UNRECOVERED_JUMPTABLE)(param_1,0);
  return;
}



// Library Function - Single Match
// Name: ??0_variant_t@@QEAA@JG@Z
// Library: Visual Studio 2015 Release
// public: __cdecl _variant_t::_variant_t(long,unsigned short) __ptr64

void __thiscall _variant_t::_variant_t(_variant_t *this,long param_1,ushort param_2)

{
  code *pcVar1;

  if (param_2 != 3) {
    if (param_2 == 10) goto LAB_180060640;
    if (param_2 != 0xb) {
      _com_issue_error(-0x7ff8ffa9);
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
  }
  if (param_2 != 10) {
    if (param_2 == 0xb) {
      *(undefined2 *)this = 0xb;
      *(ushort *)(this + 8) = -(ushort)(param_1 != 0);
      return;
    }
    *(long *)(this + 8) = param_1;
    *(undefined2 *)this = 3;
    return;
  }
LAB_180060640:
  *(long *)(this + 8) = param_1;
  *(undefined2 *)this = 10;
  return;
}



// Library Function - Multiple Matches With Same Base Name
// Name: ConvertStringToBSTR
// Library: Visual Studio 2015 Release

void ConvertStringToBSTR(LPCSTR param_1)

{
  code *pcVar1;
  ulonglong uVar2;
  int iVar3;
  DWORD DVar4;
  int iVar5;
  int *_Memory;
  ulonglong uVar6;
  longlong lVar7;
  undefined *puVar9;
  int local_38 [2];
  int *local_30;
  ulonglong local_28;
  ulonglong local_20;
  longlong lVar8;

  puVar9 = &stack0xffffffffffffff98;
  local_20 = DAT_1800b04e8 ^ (ulonglong)local_38;
  if (param_1 != (LPCSTR)0x0) {
    lVar7 = -1;
    do {
      lVar8 = lVar7;
      lVar7 = lVar8 + 1;
    } while (param_1[lVar7] != '\0');
    local_28 = lVar8 + 2;
    if (0x7fffffff < local_28) {
      _com_issue_error(-0x7ff8ffa9);
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
    iVar5 = (int)local_28;
    iVar3 = MultiByteToWideChar(0,0,param_1,iVar5,(LPWSTR)0x0,0);
    local_38[0] = iVar3;
    if (iVar3 == 0) {
      DVar4 = GetLastError();
      if (0 < (int)DVar4) {
        DVar4 = DVar4 & 0xffff | 0x80070000;
      }
      _com_issue_error(DVar4);
    }
    if (iVar3 < 0x1000) {
      uVar2 = (longlong)iVar3 * 2;
      uVar6 = uVar2 + 0xf;
      if (uVar6 <= uVar2) {
        uVar6 = 0xffffffffffffff0;
      }
      uVar6 = uVar6 & 0xfffffffffffffff0;
      _alloca_probe();
      _Memory = (int *)((longlong)local_38 + -uVar6);
      puVar9 = &stack0xffffffffffffff98 + -uVar6;
    }
    else {
      _Memory = (int *)malloc((longlong)iVar3 * 2);
      puVar9 = &stack0xffffffffffffff98;
    }
    local_30 = _Memory;
    if (_Memory == (int *)0x0) {
      *(undefined8 *)(puVar9 + -8) = 0x1800608e1;
      _com_issue_error(-0x7ff8fff2,puVar9[-8]);
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
    *(int *)(puVar9 + 0x28) = iVar3;
    *(int **)(puVar9 + 0x20) = _Memory;
    *(undefined8 *)(puVar9 + -8) = 0x1800608fc;
    iVar5 = MultiByteToWideChar(0,0,param_1,iVar5,*(LPWSTR *)(puVar9 + 0x20),*(int *)(puVar9 + 0x28)
                               );
    if (iVar5 == 0) {
      if (0xfff < iVar3) {
        *(undefined8 *)(puVar9 + -8) = 0x180060911;
        free(_Memory,puVar9[-8]);
      }
      *(undefined8 *)(puVar9 + -8) = 0x180060917;
      DVar4 = GetLastError(puVar9[-8]);
      if (0 < (int)DVar4) {
        DVar4 = DVar4 & 0xffff | 0x80070000;
      }
      *(undefined8 *)(puVar9 + -8) = 0x18006092a;
      _com_issue_error(DVar4,puVar9[-8]);
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
    *(undefined8 *)(puVar9 + -8) = 0x180060934;
    lVar7 = Ordinal_2(_Memory);
    if (0xfff < iVar3) {
      *(undefined8 *)(puVar9 + -8) = 0x180060948;
      free(_Memory,puVar9[-8]);
    }
    if (lVar7 == 0) {
      *(undefined8 *)(puVar9 + -8) = 0x180060957;
      _com_issue_error(-0x7ff8fff2,puVar9[-8]);
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
  }
  uVar6 = local_20 ^ (ulonglong)local_38;
  *(undefined8 *)(puVar9 + -8) = 0x180060967;
  FUN_18005f100(uVar6,puVar9[-8]);
  return;
}



// Library Function - Single Match
// Name: ??0_com_error@@QEAA@JPEAUIErrorInfo@@_N@Z
// Library: Visual Studio 2015 Release
// public: __cdecl _com_error::_com_error(long,struct IErrorInfo * __ptr64,bool) __ptr64

void __thiscall
_com_error::_com_error(_com_error *this,long param_1,IErrorInfo *param_2,bool param_3)

{
  _func_6749 *p_Var1;

  *(long *)(this + 8) = param_1;
  *(undefined ***)this = &PTR_FUN_18007a2a0;
  *(IErrorInfo **)(this + 0x10) = param_2;
  *(undefined8 *)(this + 0x18) = 0;
  if ((param_2 != (IErrorInfo *)0x0) && (param_3 != false)) {
    p_Var1 = param_2->lpVtbl->AddRef;
    _guard_check_icall();
    (*p_Var1)(param_2);
  }
  return;
}



undefined8 * FUN_180060ad0(undefined8 *param_1,ulonglong param_2)

{
  longlong *plVar1;
  code *pcVar2;

  plVar1 = (longlong *)param_1[2];
  *param_1 = &PTR_FUN_18007a2a0;
  if (plVar1 != (longlong *)0x0) {
    pcVar2 = *(code **)(*plVar1 + 0x10);
    _guard_check_icall();
    (*pcVar2)(plVar1);
  }
  if ((HLOCAL)param_1[3] != (HLOCAL)0x0) {
    LocalFree((HLOCAL)param_1[3]);
  }
  if ((param_2 & 1) != 0) {
    FUN_18005f208();
  }
  return param_1;
}



// Library Function - Single Match
// Name: ?_com_raise_error@@YAXJPEAUIErrorInfo@@@Z
// Library: Visual Studio 2015 Release
// void __cdecl _com_raise_error(long,struct IErrorInfo * __ptr64)

void _com_raise_error(long param_1,IErrorInfo *param_2)

{
  code *pcVar1;
  _com_error local_28 [40];

  _com_error::_com_error(local_28,param_1,param_2,false);
  _CxxThrowException(local_28,(ThrowInfo *)&DAT_1800acf28);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



// Library Function - Single Match
// Name: ?_com_dispatch_raw_method@@YAJPEAUIDispatch@@JGGPEAXPEBGZZ
// Library: Visual Studio 2015 Release
// long __cdecl _com_dispatch_raw_method(struct IDispatch * __ptr64,long,unsigned short,unsigned
// short,void * __ptr64,unsigned short const * __ptr64,...)

long _com_dispatch_raw_method
               (IDispatch *param_1,long param_2,ushort param_3,ushort param_4,void *param_5,
               ushort *param_6,...)

{
  int iVar1;
  IErrorInfo *local_18 [2];

  iVar1 = FUN_180060c90((longlong *)param_1,param_2,param_3,param_4,(undefined8 *)param_5,param_6,
                        (longlong)&stack0x00000038,local_18);
  if (iVar1 < 0) {
    SetErrorInfo(0,local_18[0]);
  }
  return (long)iVar1;
}



// Library Function - Single Match
// Name: ?_com_dispatch_raw_propget@@YAJPEAUIDispatch@@JGPEAX@Z
// Library: Visual Studio 2015 Release
// long __cdecl _com_dispatch_raw_propget(struct IDispatch * __ptr64,long,unsigned short,void *
// __ptr64)

long _com_dispatch_raw_propget(IDispatch *param_1,long param_2,ushort param_3,void *param_4)

{
  long lVar1;

  lVar1 = _com_dispatch_raw_method(param_1,param_2,2,param_3,param_4,(ushort *)0x0);
  return lVar1;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180060c90(longlong *param_1,uint param_2,ushort param_3,ushort param_4,undefined8 *param_5,
                  ushort *param_6,longlong param_7,undefined8 *param_8)

{
  undefined4 *puVar1;
  undefined4 *_Dst;
  ushort uVar2;
  code *pcVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  longlong *plVar7;
  ushort uVar8;
  int iVar9;
  longlong lVar10;
  undefined4 *puVar11;
  ushort *puVar12;
  ulonglong uVar13;
  longlong lVar14;
  undefined4 *puVar15;
  undefined *puVar16;
  uint uVar17;
  size_t _Size;
  undefined4 *puVar18;
  undefined4 *puVar19;
  undefined8 uStack288;
  undefined auStack280 [80];
  undefined4 local_c8 [2];
  undefined local_c0;
  undefined uStack191;
  undefined2 uStack190;
  undefined4 uStack188;
  undefined8 local_b8;
  ushort local_b0;
  undefined4 *local_a8;
  undefined4 *local_a0;
  undefined8 local_98;
  undefined4 local_90;
  undefined4 local_8c;
  uint local_88;
  longlong *local_80;
  undefined8 local_78;
  undefined8 local_70;
  undefined8 local_68;
  undefined8 local_60;
  undefined8 local_58;
  undefined8 local_50;
  undefined8 local_48;
  undefined8 local_40;
  undefined4 *local_38;
  ulonglong local_30;

  local_30 = DAT_1800b04e8 ^ (ulonglong)local_c8;
  local_b0 = param_3;
  local_88 = param_2;
  local_80 = param_1;
  puVar16 = auStack280;
  if (param_1 == (longlong *)0x0) goto LAB_1800611b6;
  puVar19 = (undefined4 *)0x0;
  if (param_8 != (undefined8 *)0x0) {
    *param_8 = 0;
  }
  local_a8 = (undefined4 *)0x0;
  local_a0 = (undefined4 *)0x0;
  local_98 = 0;
  if (param_6 == (ushort *)0x0) {
    uVar13 = 0;
  }
  else {
    uVar13 = 0xffffffffffffffff;
    do {
      uVar13 = uVar13 + 1;
    } while (param_6[uVar13] != 0);
    puVar16 = auStack280;
    if (0xffffffff < uVar13) goto LAB_1800611b6;
    local_98 = uVar13 & 0xffffffff;
  }
  local_90 = 0xfffffffd;
  if ((param_3 & 0xc) != 0) {
    puVar16 = auStack280;
    if ((int)uVar13 == 0) goto LAB_1800611b6;
    local_98 = CONCAT44(1,(int)local_98);
    local_a0 = &local_90;
  }
  puVar16 = auStack280;
  if ((int)uVar13 == 0) goto LAB_180060ff9;
  _Size = (uVar13 & 0xffffffff) * 0x18;
  uStack288 = 0x180060d92;
  lVar10 = _alloca_probe();
  lVar10 = -lVar10;
  puVar16 = auStack280 + lVar10;
  _Dst = (undefined4 *)((longlong)local_c8 + lVar10);
  local_38 = _Dst;
  *(undefined8 *)((longlong)&uStack288 + lVar10) = 0x180060dab;
  memset(_Dst,0,_Size,*(undefined *)((longlong)&uStack288 + lVar10));
  local_a8 = _Dst;
  uVar13 = local_98 & 0xffffffff;
  puVar15 = _Dst + (uVar13 - 1) * 6;
  if (*param_6 == 0) goto LAB_180060f0a;
  lVar14 = param_7 + -8;
  puVar12 = param_6;
LAB_180060df0:
  uVar2 = *puVar12;
  uVar8 = uVar2 & 0xf7ff;
  *(ushort *)puVar15 = uVar8;
  if (uVar8 < 0x4003) {
    if (uVar8 == 0x4002) goto switchD_180060edc_caseD_4003;
    switch(uVar8) {
    case 2:
    case 0x12:
      *(undefined2 *)(puVar15 + 2) = *(undefined2 *)(lVar14 + 8);
      break;
    case 3:
    case 10:
    case 0x13:
    case 0x16:
    case 0x17:
    case 0x19:
      puVar15[2] = *(undefined4 *)(lVar14 + 8);
      break;
    case 4:
      *(undefined2 *)puVar15 = 5;
    case 5:
    case 7:
    case 8:
    case 9:
    case 0xd:
    case 0x14:
    case 0x15:
    case 0x24:
      goto switchD_180060edc_caseD_4003;
    case 6:
      *(undefined8 *)(puVar15 + 2) = **(undefined8 **)(lVar14 + 8);
      break;
    case 0xb:
      *(ushort *)(puVar15 + 2) = -(ushort)(*(short *)(lVar14 + 8) != 0);
      break;
    case 0xc:
      puVar18 = *(undefined4 **)(lVar14 + 8);
      uVar4 = puVar18[1];
      uVar5 = puVar18[2];
      uVar6 = puVar18[3];
      *puVar15 = *puVar18;
      puVar15[1] = uVar4;
      puVar15[2] = uVar5;
      puVar15[3] = uVar6;
      *(undefined8 *)(puVar15 + 4) = *(undefined8 *)(puVar18 + 4);
      break;
    case 0xe:
      puVar18 = *(undefined4 **)(lVar14 + 8);
      uVar4 = puVar18[1];
      uVar5 = puVar18[2];
      uVar6 = puVar18[3];
      *puVar15 = *puVar18;
      puVar15[1] = uVar4;
      puVar15[2] = uVar5;
      puVar15[3] = uVar6;
      *(undefined2 *)puVar15 = 0xe;
      break;
    default:
      goto switchD_180060edc_caseD_400f;
    case 0x10:
    case 0x11:
      *(undefined *)(puVar15 + 2) = *(undefined *)(lVar14 + 8);
    }
  }
  else {
    switch(uVar8) {
    case 0x4003:
    case 0x4004:
    case 0x4005:
    case 0x4006:
    case 0x4007:
    case 0x4008:
    case 0x4009:
    case 0x400a:
    case 0x400b:
    case 0x400c:
    case 0x400d:
    case 0x400e:
    case 0x4010:
    case 0x4011:
    case 0x4012:
    case 0x4013:
    case 0x4014:
    case 0x4015:
    case 0x4016:
    case 0x4017:
    case 0x4019:
    case 0x4024:
      goto switchD_180060edc_caseD_4003;
    }
switchD_180060edc_caseD_400f:
    if ((uVar2 & 0x2000) == 0) goto LAB_1800611b6;
switchD_180060edc_caseD_4003:
    *(undefined8 *)(puVar15 + 2) = *(undefined8 *)(lVar14 + 8);
  }
  lVar14 = lVar14 + 8;
  puVar15 = puVar15 + -6;
  puVar12 = puVar12 + 1;
  if (*puVar12 == 0) goto code_r0x000180060f06;
  goto LAB_180060df0;
code_r0x000180060f06:
  uVar13 = local_98 & 0xffffffff;
LAB_180060f0a:
  puVar15 = _Dst + (ulonglong)local_98._4_4_ * 6;
  local_98._0_4_ = (int)uVar13;
  puVar12 = param_6 + (uVar13 - local_98._4_4_) + -1;
  puVar18 = puVar19;
  if (param_6 <= puVar12) {
    while ((*puVar12 & 0xbfff) == 0x80c) {
      puVar11 = puVar15;
      if ((*puVar12 & 0x4000) != 0) {
        puVar11 = *(undefined4 **)(puVar15 + 2);
      }
      if ((*(short *)puVar11 != 10) || (puVar11[2] != -0x7ffdfffc)) break;
      puVar18 = (undefined4 *)(ulonglong)((int)puVar18 + 1);
      puVar15 = puVar15 + 6;
      puVar12 = puVar12 + -1;
      if (puVar12 < param_6) break;
    }
  }
  iVar9 = (int)puVar18;
  puVar16 = auStack280 + lVar10;
  if (iVar9 != 0) {
    puVar15 = puVar19;
    if (local_98._4_4_ != 0) {
      do {
        uVar13 = (ulonglong)(uint)((int)puVar15 + iVar9);
        puVar11 = _Dst + (longlong)puVar15 * 6;
        uVar4 = puVar11[1];
        uVar5 = puVar11[2];
        uVar6 = puVar11[3];
        puVar1 = _Dst + uVar13 * 6;
        *puVar1 = *puVar11;
        puVar1[1] = uVar4;
        puVar1[2] = uVar5;
        puVar1[3] = uVar6;
        *(undefined8 *)((longlong)&local_b8 + uVar13 * 0x18 + lVar10) =
             *(undefined8 *)((longlong)&local_b8 + (longlong)puVar15 * 0x18 + lVar10);
        uVar17 = (int)puVar15 + 1;
        puVar15 = (undefined4 *)(ulonglong)uVar17;
      } while (uVar17 < local_98._4_4_);
    }
    local_98 = local_98 & 0xffffffff00000000 | (ulonglong)(uint)((int)local_98 - iVar9);
    local_a8 = local_a8 + (longlong)puVar18 * 6;
    puVar16 = auStack280 + lVar10;
  }
LAB_180060ff9:
  *(undefined8 *)(puVar16 + -8) = 0x180061003;
  Ordinal_8(local_c8);
  local_78 = 0;
  local_70 = 0;
  local_68 = 0;
  local_60 = 0;
  local_58 = 0;
  local_50 = 0;
  local_48 = 0;
  local_40 = 0;
  local_8c = 0xffffffff;
  puVar15 = local_c8;
  if (param_4 == 0) {
    puVar15 = puVar19;
  }
  pcVar3 = *(code **)(*local_80 + 0x30);
  *(undefined8 *)(puVar16 + -8) = 0x180061052;
  _guard_check_icall(puVar16[-8]);
  *(undefined4 **)(puVar16 + 0x40) = &local_8c;
  *(undefined8 **)(puVar16 + 0x38) = &local_78;
  *(undefined4 **)(puVar16 + 0x30) = puVar15;
  *(undefined4 ***)(puVar16 + 0x28) = &local_a8;
  *(ushort *)(puVar16 + 0x20) = local_b0;
  plVar7 = local_80;
  uVar17 = local_88;
  *(undefined8 *)(puVar16 + -8) = 0x18006108e;
  iVar9 = (*pcVar3)(plVar7,uVar17,&DAT_18007a2a8,0);
  if (iVar9 < 0) {
    *(undefined8 *)(puVar16 + -8) = 0x18006109e;
    Ordinal_9(local_c8);
    if (iVar9 == -0x7ffdfff7) {
      *(undefined8 *)(puVar16 + -8) = 0x1800610b6;
      _com_handle_excepinfo((tagEXCEPINFO *)&local_78,(IErrorInfo **)param_8,puVar16[-8]);
    }
    goto LAB_1800611b6;
  }
  if ((param_4 == 0) || (param_5 == (undefined8 *)0x0)) goto LAB_1800611b6;
  if ((param_4 != 0xc) && (param_4 != (ushort)local_c8[0])) {
    *(undefined8 *)(puVar16 + -8) = 0x1800610fa;
    iVar9 = Ordinal_12(local_c8,local_c8,0,param_4);
    if (iVar9 < 0) {
      *(undefined8 *)(puVar16 + -8) = 0x18006110a;
      Ordinal_9(local_c8);
      goto LAB_1800611b6;
    }
  }
  if (param_4 < 0x4003) {
    if (param_4 != 0x4002) {
      switch(param_4) {
      case 2:
      case 0xb:
      case 0x12:
        *(ushort *)param_5 = CONCAT11(uStack191,local_c0);
        break;
      case 3:
      case 10:
      case 0x13:
      case 0x16:
      case 0x17:
      case 0x19:
        *(uint *)param_5 = CONCAT22(uStack190,CONCAT11(uStack191,local_c0));
        break;
      case 4:
        *(uint *)param_5 = CONCAT22(uStack190,CONCAT11(uStack191,local_c0));
        break;
      case 5:
      case 7:
        *param_5 = CONCAT44(uStack188,CONCAT22(uStack190,CONCAT11(uStack191,local_c0)));
        break;
      case 6:
      case 8:
      case 9:
      case 0xd:
      case 0x14:
      case 0x15:
      case 0x24:
        goto switchD_180061192_caseD_4003;
      case 0xc:
        *(undefined4 *)param_5 = local_c8[0];
        *(undefined4 *)((longlong)param_5 + 4) = local_c8[1];
        *(uint *)(param_5 + 1) = CONCAT22(uStack190,CONCAT11(uStack191,local_c0));
        *(undefined4 *)((longlong)param_5 + 0xc) = uStack188;
        param_5[2] = local_b8;
        break;
      case 0xe:
        *(undefined4 *)param_5 = local_c8[0];
        *(undefined4 *)((longlong)param_5 + 4) = local_c8[1];
        *(uint *)(param_5 + 1) = CONCAT22(uStack190,CONCAT11(uStack191,local_c0));
        *(undefined4 *)((longlong)param_5 + 0xc) = uStack188;
        break;
      default:
        goto switchD_180061192_caseD_400f;
      case 0x10:
      case 0x11:
        *(undefined *)param_5 = local_c0;
      }
      goto LAB_1800611b6;
    }
  }
  else {
    switch(param_4) {
    case 0x4003:
    case 0x4004:
    case 0x4005:
    case 0x4006:
    case 0x4007:
    case 0x4008:
    case 0x4009:
    case 0x400a:
    case 0x400b:
    case 0x400c:
    case 0x400d:
    case 0x400e:
    case 0x4010:
    case 0x4011:
    case 0x4012:
    case 0x4013:
    case 0x4014:
    case 0x4015:
    case 0x4016:
    case 0x4017:
    case 0x4019:
    case 0x4024:
      break;
    default:
switchD_180061192_caseD_400f:
      if ((param_4 & 0x2000) == 0) {
        *(undefined8 *)(puVar16 + -8) = 0x1800611ad;
        Ordinal_9(local_c8);
        goto LAB_1800611b6;
      }
    }
  }
switchD_180061192_caseD_4003:
  *param_5 = CONCAT44(uStack188,CONCAT22(uStack190,CONCAT11(uStack191,local_c0)));
LAB_1800611b6:
  uVar13 = local_30 ^ (ulonglong)local_c8;
  *(undefined8 *)(puVar16 + -8) = 0x1800611c5;
  FUN_18005f100(uVar13,puVar16[-8]);
  return;
}



// Library Function - Single Match
// Name: ?_com_handle_excepinfo@@YAJAEAUtagEXCEPINFO@@PEAPEAUIErrorInfo@@@Z
// Library: Visual Studio 2015 Release
// long __cdecl _com_handle_excepinfo(struct tagEXCEPINFO & __ptr64,struct IErrorInfo * __ptr64 *
// __ptr64)

long _com_handle_excepinfo(tagEXCEPINFO *param_1,IErrorInfo **param_2)

{
  ushort uVar1;
  code *pcVar2;
  _func_6759 *p_Var3;
  LPOLESTR pOVar4;
  _func_6760 *p_Var5;
  _func_6761 *p_Var6;
  _func_6762 *p_Var7;
  _func_6763 *p_Var8;
  _func_6756 *p_Var9;
  _func_6758 *p_Var10;
  ICreateErrorInfo *pIVar11;
  HRESULT HVar12;
  ICreateErrorInfo *local_res8;

  pcVar2 = *(code **)(param_1 + 0x30);
  if (pcVar2 != (code *)0x0) {
    _guard_check_icall();
    (*pcVar2)(param_1);
  }
  local_res8 = (ICreateErrorInfo *)0x0;
  if (param_2 != (IErrorInfo **)0x0) {
    HVar12 = CreateErrorInfo(&local_res8);
    pIVar11 = local_res8;
    if (-1 < HVar12) {
      p_Var3 = local_res8->lpVtbl->SetGUID;
      _guard_check_icall();
      (*p_Var3)(pIVar11,(GUID *)&DAT_18007a2b8);
      pIVar11 = local_res8;
      pOVar4 = *(LPOLESTR *)(param_1 + 8);
      if (pOVar4 != (LPOLESTR)0x0) {
        p_Var5 = local_res8->lpVtbl->SetSource;
        _guard_check_icall();
        (*p_Var5)(pIVar11,pOVar4);
      }
      pIVar11 = local_res8;
      pOVar4 = *(LPOLESTR *)(param_1 + 0x10);
      if (pOVar4 != (LPOLESTR)0x0) {
        p_Var6 = local_res8->lpVtbl->SetDescription;
        _guard_check_icall();
        (*p_Var6)(pIVar11,pOVar4);
      }
      pIVar11 = local_res8;
      pOVar4 = *(LPOLESTR *)(param_1 + 0x18);
      if (pOVar4 != (LPOLESTR)0x0) {
        p_Var7 = local_res8->lpVtbl->SetHelpFile;
        _guard_check_icall();
        (*p_Var7)(pIVar11,pOVar4);
      }
      pIVar11 = local_res8;
      p_Var8 = local_res8->lpVtbl->SetHelpContext;
      _guard_check_icall();
      (*p_Var8)(pIVar11,*(DWORD *)(param_1 + 0x20));
      pIVar11 = local_res8;
      p_Var9 = local_res8->lpVtbl->QueryInterface;
      _guard_check_icall();
      HVar12 = (*p_Var9)(pIVar11,(IID *)&DAT_18007a2c8,param_2);
      pIVar11 = local_res8;
      if (HVar12 < 0) {
        *param_2 = (IErrorInfo *)0x0;
      }
      p_Var10 = local_res8->lpVtbl->Release;
      _guard_check_icall();
      (*p_Var10)(pIVar11);
    }
  }
  if (*(longlong *)(param_1 + 8) != 0) {
    Ordinal_6();
  }
  if (*(longlong *)(param_1 + 0x10) != 0) {
    Ordinal_6();
  }
  if (*(longlong *)(param_1 + 0x18) != 0) {
    Ordinal_6();
  }
  uVar1 = *(ushort *)param_1;
  if (uVar1 != 0) {
    if (0xfdff < uVar1) {
      return -0x7ffb0001;
    }
    return (long)(uVar1 + 0x80040200);
  }
  return *(long *)(param_1 + 0x38);
}



undefined8 * FUN_180061620(undefined8 *param_1,longlong param_2)

{
  *param_1 = std::exception::vftable;
  param_1[1] = (char *)0x0;
  param_1[2] = 0;
  __std_exception_copy((char **)(param_2 + 8),(char **)(param_1 + 1));
  *param_1 = std::bad_function_call::vftable;
  return param_1;
}



undefined8 * FUN_180061710(undefined8 *param_1,char *param_2)

{
  char *local_18;
  undefined local_10;

  local_10 = 1;
  *param_1 = std::exception::vftable;
  param_1[1] = (char *)0x0;
  param_1[2] = 0;
  local_18 = param_2;
  __std_exception_copy(&local_18,(char **)(param_1 + 1));
  *param_1 = std::invalid_argument::vftable;
  return param_1;
}



undefined8 * FUN_18006175c(undefined8 *param_1,longlong param_2)

{
  *param_1 = std::exception::vftable;
  param_1[1] = (char *)0x0;
  param_1[2] = 0;
  __std_exception_copy((char **)(param_2 + 8),(char **)(param_1 + 1));
  *param_1 = std::length_error::vftable;
  return param_1;
}



undefined8 * FUN_18006179c(undefined8 *param_1,char *param_2)

{
  char *local_18;
  undefined local_10;

  local_10 = 1;
  *param_1 = std::exception::vftable;
  param_1[1] = (char *)0x0;
  param_1[2] = 0;
  local_18 = param_2;
  __std_exception_copy(&local_18,(char **)(param_1 + 1));
  *param_1 = std::length_error::vftable;
  return param_1;
}



undefined8 * FUN_1800617e8(undefined8 *param_1,longlong param_2)

{
  *param_1 = std::exception::vftable;
  param_1[1] = (char *)0x0;
  param_1[2] = 0;
  __std_exception_copy((char **)(param_2 + 8),(char **)(param_1 + 1));
  *param_1 = std::logic_error::vftable;
  return param_1;
}



undefined8 * FUN_180061828(undefined8 *param_1,char *param_2)

{
  char *local_18;
  undefined local_10;

  local_10 = 1;
  *param_1 = std::exception::vftable;
  param_1[1] = (char *)0x0;
  param_1[2] = 0;
  local_18 = param_2;
  __std_exception_copy(&local_18,(char **)(param_1 + 1));
  *param_1 = std::logic_error::vftable;
  return param_1;
}



undefined8 * FUN_180061874(undefined8 *param_1,longlong param_2)

{
  *param_1 = std::exception::vftable;
  param_1[1] = (char *)0x0;
  param_1[2] = 0;
  __std_exception_copy((char **)(param_2 + 8),(char **)(param_1 + 1));
  *param_1 = std::out_of_range::vftable;
  return param_1;
}



undefined8 * FUN_1800618b4(undefined8 *param_1,char *param_2)

{
  char *local_18;
  undefined local_10;

  local_10 = 1;
  *param_1 = std::exception::vftable;
  param_1[1] = (char *)0x0;
  param_1[2] = 0;
  local_18 = param_2;
  __std_exception_copy(&local_18,(char **)(param_1 + 1));
  *param_1 = std::out_of_range::vftable;
  return param_1;
}



undefined8 * FUN_180061900(undefined8 *param_1,longlong param_2)

{
  *param_1 = std::exception::vftable;
  param_1[1] = (char *)0x0;
  param_1[2] = 0;
  __std_exception_copy((char **)(param_2 + 8),(char **)(param_1 + 1));
  *param_1 = std::overflow_error::vftable;
  return param_1;
}



undefined8 * FUN_180061940(undefined8 *param_1,char *param_2)

{
  char *local_18;
  undefined local_10;

  local_10 = 1;
  *param_1 = std::exception::vftable;
  param_1[1] = (char *)0x0;
  param_1[2] = 0;
  local_18 = param_2;
  __std_exception_copy(&local_18,(char **)(param_1 + 1));
  *param_1 = std::overflow_error::vftable;
  return param_1;
}



undefined8 * FUN_180061a44(undefined8 *param_1,longlong param_2)

{
  *param_1 = std::exception::vftable;
  param_1[1] = (char *)0x0;
  param_1[2] = 0;
  __std_exception_copy((char **)(param_2 + 8),(char **)(param_1 + 1));
  *param_1 = std::runtime_error::vftable;
  return param_1;
}



undefined8 * FUN_180061a84(undefined8 *param_1,char *param_2)

{
  char *local_18;
  undefined local_10;

  local_10 = 1;
  *param_1 = std::exception::vftable;
  param_1[1] = (char *)0x0;
  param_1[2] = 0;
  local_18 = param_2;
  __std_exception_copy(&local_18,(char **)(param_1 + 1));
  *param_1 = std::runtime_error::vftable;
  return param_1;
}



undefined8 * FUN_180061b70(undefined8 *param_1,ulonglong param_2)

{
  *param_1 = std::exception::vftable;
  __std_exception_destroy((void **)(param_1 + 1));
  if ((param_2 & 1) != 0) {
    FUN_18005f208();
  }
  return param_1;
}



undefined8 * FUN_180061bb4(undefined8 *param_1,ulonglong param_2)

{
  *param_1 = std::exception::vftable;
  __std_exception_destroy((void **)(param_1 + 1));
  if ((param_2 & 1) != 0) {
    FUN_18005f208();
  }
  return param_1;
}



undefined8 * FUN_180061bf8(undefined8 *param_1,ulonglong param_2)

{
  *param_1 = std::exception::vftable;
  __std_exception_destroy((void **)(param_1 + 1));
  if ((param_2 & 1) != 0) {
    FUN_18005f208();
  }
  return param_1;
}



undefined8 * FUN_180061c3c(undefined8 *param_1,ulonglong param_2)

{
  *param_1 = std::exception::vftable;
  __std_exception_destroy((void **)(param_1 + 1));
  if ((param_2 & 1) != 0) {
    FUN_18005f208();
  }
  return param_1;
}



undefined8 * FUN_180061c80(undefined8 *param_1,ulonglong param_2)

{
  *param_1 = std::exception::vftable;
  __std_exception_destroy((void **)(param_1 + 1));
  if ((param_2 & 1) != 0) {
    FUN_18005f208();
  }
  return param_1;
}



undefined8 * FUN_180061cc4(undefined8 *param_1,ulonglong param_2)

{
  *param_1 = std::exception::vftable;
  __std_exception_destroy((void **)(param_1 + 1));
  if ((param_2 & 1) != 0) {
    FUN_18005f208();
  }
  return param_1;
}



undefined8 * FUN_180061d08(undefined8 *param_1,ulonglong param_2)

{
  *param_1 = std::exception::vftable;
  __std_exception_destroy((void **)(param_1 + 1));
  if ((param_2 & 1) != 0) {
    FUN_18005f208();
  }
  return param_1;
}



undefined8 * FUN_180061d4c(undefined8 *param_1,ulonglong param_2)

{
  *param_1 = std::exception::vftable;
  __std_exception_destroy((void **)(param_1 + 1));
  if ((param_2 & 1) != 0) {
    FUN_18005f208();
  }
  return param_1;
}



void FUN_180061e5c(void)

{
  code *pcVar1;
  undefined8 local_28 [5];

  FUN_18005ff64(local_28);
  _CxxThrowException(local_28,(ThrowInfo *)&DAT_1800ace38);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_180061ec0(char *param_1)

{
  code *pcVar1;
  undefined8 local_28 [5];

  FUN_18006179c(local_28,param_1);
  _CxxThrowException(local_28,(ThrowInfo *)&DAT_1800ad010);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_180061f50(char *param_1)

{
  code *pcVar1;
  undefined8 local_28 [5];

  FUN_180061a84(local_28,param_1);
  _CxxThrowException(local_28,(ThrowInfo *)&DAT_1800ad170);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



char * FUN_180061f74(void)

{
  return "bad function call";
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 * memcpy_FUN_180061f90(undefined8 *param_1,undefined8 *param_2,ulonglong param_3)

{
  undefined4 *puVar1;
  undefined uVar2;
  undefined2 uVar3;
  undefined8 *puVar4;
  undefined8 *puVar5;
  longlong lVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  undefined8 *puVar10;
  ulonglong uVar11;
  undefined4 *puVar12;
  ulonglong uVar13;
  undefined4 uVar14;
  undefined4 uVar15;
  undefined4 uVar16;
  undefined4 uVar17;
  undefined4 uVar18;
  undefined4 uVar19;
  undefined4 uVar20;
  undefined4 uVar21;

  if (param_3 < 0x11) {
    switch(param_3) {
    case 0:
      return param_1;
    case 1:
      *(undefined *)param_1 = *(undefined *)param_2;
      return param_1;
    case 2:
      *(undefined2 *)param_1 = *(undefined2 *)param_2;
      return param_1;
    case 3:
      uVar2 = *(undefined *)((longlong)param_2 + 2);
      *(undefined2 *)param_1 = *(undefined2 *)param_2;
      *(undefined *)((longlong)param_1 + 2) = uVar2;
      return param_1;
    case 4:
      *(undefined4 *)param_1 = *(undefined4 *)param_2;
      return param_1;
    case 5:
      uVar2 = *(undefined *)((longlong)param_2 + 4);
      *(undefined4 *)param_1 = *(undefined4 *)param_2;
      *(undefined *)((longlong)param_1 + 4) = uVar2;
      return param_1;
    case 6:
      uVar3 = *(undefined2 *)((longlong)param_2 + 4);
      *(undefined4 *)param_1 = *(undefined4 *)param_2;
      *(undefined2 *)((longlong)param_1 + 4) = uVar3;
      return param_1;
    case 7:
      uVar3 = *(undefined2 *)((longlong)param_2 + 4);
      uVar2 = *(undefined *)((longlong)param_2 + 6);
      *(undefined4 *)param_1 = *(undefined4 *)param_2;
      *(undefined2 *)((longlong)param_1 + 4) = uVar3;
      *(undefined *)((longlong)param_1 + 6) = uVar2;
      return param_1;
    case 8:
      *param_1 = *param_2;
      return param_1;
    case 9:
      uVar2 = *(undefined *)(param_2 + 1);
      *param_1 = *param_2;
      *(undefined *)(param_1 + 1) = uVar2;
      return param_1;
    case 10:
      uVar3 = *(undefined2 *)(param_2 + 1);
      *param_1 = *param_2;
      *(undefined2 *)(param_1 + 1) = uVar3;
      return param_1;
    case 0xb:
      uVar3 = *(undefined2 *)(param_2 + 1);
      uVar2 = *(undefined *)((longlong)param_2 + 10);
      *param_1 = *param_2;
      *(undefined2 *)(param_1 + 1) = uVar3;
      *(undefined *)((longlong)param_1 + 10) = uVar2;
      return param_1;
    case 0xc:
      uVar18 = *(undefined4 *)(param_2 + 1);
      *param_1 = *param_2;
      *(undefined4 *)(param_1 + 1) = uVar18;
      return param_1;
    case 0xd:
      uVar18 = *(undefined4 *)(param_2 + 1);
      uVar2 = *(undefined *)((longlong)param_2 + 0xc);
      *param_1 = *param_2;
      *(undefined4 *)(param_1 + 1) = uVar18;
      *(undefined *)((longlong)param_1 + 0xc) = uVar2;
      return param_1;
    case 0xe:
      uVar18 = *(undefined4 *)(param_2 + 1);
      uVar3 = *(undefined2 *)((longlong)param_2 + 0xc);
      *param_1 = *param_2;
      *(undefined4 *)(param_1 + 1) = uVar18;
      *(undefined2 *)((longlong)param_1 + 0xc) = uVar3;
      return param_1;
    case 0xf:
      uVar18 = *(undefined4 *)(param_2 + 1);
      uVar3 = *(undefined2 *)((longlong)param_2 + 0xc);
      uVar2 = *(undefined *)((longlong)param_2 + 0xe);
      *param_1 = *param_2;
      *(undefined4 *)(param_1 + 1) = uVar18;
      *(undefined2 *)((longlong)param_1 + 0xc) = uVar3;
      *(undefined *)((longlong)param_1 + 0xe) = uVar2;
      return param_1;
    case 0x10:
      uVar18 = *(undefined4 *)((longlong)param_2 + 4);
      uVar19 = *(undefined4 *)(param_2 + 1);
      uVar20 = *(undefined4 *)((longlong)param_2 + 0xc);
      *(undefined4 *)param_1 = *(undefined4 *)param_2;
      *(undefined4 *)((longlong)param_1 + 4) = uVar18;
      *(undefined4 *)(param_1 + 1) = uVar19;
      *(undefined4 *)((longlong)param_1 + 0xc) = uVar20;
      return param_1;
    }
  }
  if (param_3 < 0x21) {
    uVar18 = *(undefined4 *)((longlong)param_2 + 4);
    uVar19 = *(undefined4 *)(param_2 + 1);
    uVar20 = *(undefined4 *)((longlong)param_2 + 0xc);
    puVar9 = (undefined4 *)((param_3 - 0x10) + (longlong)param_2);
    uVar21 = *puVar9;
    uVar14 = puVar9[1];
    uVar15 = puVar9[2];
    uVar16 = puVar9[3];
    *(undefined4 *)param_1 = *(undefined4 *)param_2;
    *(undefined4 *)((longlong)param_1 + 4) = uVar18;
    *(undefined4 *)(param_1 + 1) = uVar19;
    *(undefined4 *)((longlong)param_1 + 0xc) = uVar20;
    puVar9 = (undefined4 *)((param_3 - 0x10) + (longlong)param_1);
    *puVar9 = uVar21;
    puVar9[1] = uVar14;
    puVar9[2] = uVar15;
    puVar9[3] = uVar16;
    return param_1;
  }
  puVar10 = (undefined8 *)((longlong)param_2 - (longlong)param_1);
  if ((param_2 < param_1) && ((longlong)param_1 < (longlong)((longlong)param_2 + param_3))) {
    lVar6 = (longlong)param_1 + param_3;
    puVar9 = (undefined4 *)((longlong)puVar10 + lVar6 + -0x10);
    uVar18 = puVar9[1];
    uVar19 = puVar9[2];
    uVar20 = puVar9[3];
    puVar7 = (undefined4 *)(lVar6 + -0x10);
    puVar12 = (undefined4 *)(param_3 - 0x10);
    puVar8 = puVar7;
    uVar21 = *puVar9;
    uVar14 = uVar18;
    uVar15 = uVar19;
    uVar16 = uVar20;
    if (((ulonglong)puVar7 & 0xf) != 0) {
      puVar8 = (undefined4 *)((ulonglong)puVar7 & 0xfffffffffffffff0);
      puVar12 = (undefined4 *)((longlong)puVar10 + (longlong)puVar8);
      uVar21 = *puVar12;
      uVar14 = puVar12[1];
      uVar15 = puVar12[2];
      uVar16 = puVar12[3];
      *puVar7 = *puVar9;
      *(undefined4 *)(lVar6 + -0xc) = uVar18;
      *(undefined4 *)(lVar6 + -8) = uVar19;
      *(undefined4 *)(lVar6 + -4) = uVar20;
      puVar12 = (undefined4 *)((longlong)puVar8 - (longlong)param_1);
    }
    uVar11 = (ulonglong)puVar12 >> 7;
    if (uVar11 != 0) {
      *puVar8 = uVar21;
      puVar8[1] = uVar14;
      puVar8[2] = uVar15;
      puVar8[3] = uVar16;
      puVar9 = puVar8;
      while( true ) {
        puVar7 = (undefined4 *)((longlong)((longlong)puVar10 + -0x10) + (longlong)puVar9);
        uVar18 = puVar7[1];
        uVar19 = puVar7[2];
        uVar20 = puVar7[3];
        puVar8 = (undefined4 *)((longlong)((longlong)puVar10 + -0x20) + (longlong)puVar9);
        uVar21 = *puVar8;
        uVar14 = puVar8[1];
        uVar15 = puVar8[2];
        uVar16 = puVar8[3];
        puVar8 = puVar9 + -0x20;
        puVar9[-4] = *puVar7;
        puVar9[-3] = uVar18;
        puVar9[-2] = uVar19;
        puVar9[-1] = uVar20;
        puVar9[-8] = uVar21;
        puVar9[-7] = uVar14;
        puVar9[-6] = uVar15;
        puVar9[-5] = uVar16;
        puVar7 = (undefined4 *)((longlong)((longlong)puVar10 + 0x50) + (longlong)puVar8);
        uVar18 = puVar7[1];
        uVar19 = puVar7[2];
        uVar20 = puVar7[3];
        puVar1 = (undefined4 *)((longlong)((longlong)puVar10 + 0x40) + (longlong)puVar8);
        uVar21 = *puVar1;
        uVar14 = puVar1[1];
        uVar15 = puVar1[2];
        uVar16 = puVar1[3];
        uVar11 = uVar11 - 1;
        puVar9[-0xc] = *puVar7;
        puVar9[-0xb] = uVar18;
        puVar9[-10] = uVar19;
        puVar9[-9] = uVar20;
        puVar9[-0x10] = uVar21;
        puVar9[-0xf] = uVar14;
        puVar9[-0xe] = uVar15;
        puVar9[-0xd] = uVar16;
        puVar7 = (undefined4 *)((longlong)((longlong)puVar10 + 0x30) + (longlong)puVar8);
        uVar18 = puVar7[1];
        uVar19 = puVar7[2];
        uVar20 = puVar7[3];
        puVar1 = (undefined4 *)((longlong)((longlong)puVar10 + 0x20) + (longlong)puVar8);
        uVar21 = *puVar1;
        uVar14 = puVar1[1];
        uVar15 = puVar1[2];
        uVar16 = puVar1[3];
        puVar9[-0x14] = *puVar7;
        puVar9[-0x13] = uVar18;
        puVar9[-0x12] = uVar19;
        puVar9[-0x11] = uVar20;
        puVar9[-0x18] = uVar21;
        puVar9[-0x17] = uVar14;
        puVar9[-0x16] = uVar15;
        puVar9[-0x15] = uVar16;
        puVar1 = (undefined4 *)((longlong)((longlong)puVar10 + 0x10) + (longlong)puVar8);
        uVar18 = puVar1[1];
        uVar19 = puVar1[2];
        uVar20 = puVar1[3];
        puVar7 = (undefined4 *)((longlong)puVar10 + (longlong)puVar8);
        uVar21 = *puVar7;
        uVar14 = puVar7[1];
        uVar15 = puVar7[2];
        uVar16 = puVar7[3];
        if (uVar11 == 0) break;
        puVar9[-0x1c] = *puVar1;
        puVar9[-0x1b] = uVar18;
        puVar9[-0x1a] = uVar19;
        puVar9[-0x19] = uVar20;
        *puVar8 = uVar21;
        puVar9[-0x1f] = uVar14;
        puVar9[-0x1e] = uVar15;
        puVar9[-0x1d] = uVar16;
        puVar9 = puVar8;
      }
      puVar9[-0x1c] = *puVar1;
      puVar9[-0x1b] = uVar18;
      puVar9[-0x1a] = uVar19;
      puVar9[-0x19] = uVar20;
      puVar12 = (undefined4 *)((ulonglong)puVar12 & 0x7f);
    }
    uVar11 = (ulonglong)puVar12 >> 4;
    while (uVar11 != 0) {
      *puVar8 = uVar21;
      puVar8[1] = uVar14;
      puVar8[2] = uVar15;
      puVar8[3] = uVar16;
      puVar8 = puVar8 + -4;
      puVar9 = (undefined4 *)((longlong)puVar10 + (longlong)puVar8);
      uVar21 = *puVar9;
      uVar14 = puVar9[1];
      uVar15 = puVar9[2];
      uVar16 = puVar9[3];
      uVar11 = uVar11 - 1;
    }
    if (((ulonglong)puVar12 & 0xf) != 0) {
      uVar18 = *(undefined4 *)((longlong)param_2 + 4);
      uVar19 = *(undefined4 *)(param_2 + 1);
      uVar20 = *(undefined4 *)((longlong)param_2 + 0xc);
      *(undefined4 *)param_1 = *(undefined4 *)param_2;
      *(undefined4 *)((longlong)param_1 + 4) = uVar18;
      *(undefined4 *)(param_1 + 1) = uVar19;
      *(undefined4 *)((longlong)param_1 + 0xc) = uVar20;
    }
    *puVar8 = uVar21;
    puVar8[1] = uVar14;
    puVar8[2] = uVar15;
    puVar8[3] = uVar16;
    return param_1;
  }
  if (param_3 < 0x81) {
    if ((DAT_1800b1ecc >> 2 & 1) == 0) {
      puVar9 = (undefined4 *)((longlong)puVar10 + (longlong)param_1);
      uVar18 = *puVar9;
      uVar19 = puVar9[1];
      uVar20 = puVar9[2];
      uVar21 = puVar9[3];
      puVar5 = param_1 + 2;
      uVar11 = param_3 - 0x10;
      goto LAB_18006224a;
    }
  }
  else {
    if ((DAT_1800b1ecc >> 1 & 1) == 0) {
      puVar9 = (undefined4 *)((longlong)puVar10 + (longlong)param_1);
      uVar14 = puVar9[1];
      uVar15 = puVar9[2];
      uVar16 = puVar9[3];
      puVar4 = param_1 + 2;
      uVar18 = *puVar9;
      uVar19 = uVar14;
      uVar20 = uVar15;
      uVar21 = uVar16;
      if (((ulonglong)param_1 & 0xf) != 0) {
        puVar8 = (undefined4 *)((longlong)puVar10 + ((ulonglong)puVar4 & 0xfffffffffffffff0));
        uVar18 = *puVar8;
        uVar19 = puVar8[1];
        uVar20 = puVar8[2];
        uVar21 = puVar8[3];
        puVar4 = (undefined8 *)(((ulonglong)puVar4 & 0xfffffffffffffff0) + 0x10);
        *(undefined4 *)param_1 = *puVar9;
        *(undefined4 *)((longlong)param_1 + 4) = uVar14;
        *(undefined4 *)(param_1 + 1) = uVar15;
        *(undefined4 *)((longlong)param_1 + 0xc) = uVar16;
      }
      uVar11 = (longlong)param_1 + (param_3 - (longlong)puVar4);
      uVar13 = uVar11 >> 7;
      puVar5 = puVar4;
      if (uVar13 != 0) {
        *(undefined4 *)(puVar4 + -2) = uVar18;
        *(undefined4 *)((longlong)puVar4 + -0xc) = uVar19;
        *(undefined4 *)(puVar4 + -1) = uVar20;
        *(undefined4 *)((longlong)puVar4 + -4) = uVar21;
        if (_DAT_1800b0500 < uVar13) {
          while( true ) {
            puVar9 = (undefined4 *)((longlong)puVar10 + (longlong)puVar4);
            uVar18 = puVar9[1];
            uVar19 = puVar9[2];
            uVar20 = puVar9[3];
            puVar8 = (undefined4 *)((longlong)((longlong)puVar10 + 0x10) + (longlong)puVar4);
            uVar21 = *puVar8;
            uVar14 = puVar8[1];
            uVar15 = puVar8[2];
            uVar16 = puVar8[3];
            puVar5 = puVar4 + 0x10;
            *(undefined4 *)puVar4 = *puVar9;
            *(undefined4 *)((longlong)puVar4 + 4) = uVar18;
            *(undefined4 *)(puVar4 + 1) = uVar19;
            *(undefined4 *)((longlong)puVar4 + 0xc) = uVar20;
            *(undefined4 *)(puVar4 + 2) = uVar21;
            *(undefined4 *)((longlong)puVar4 + 0x14) = uVar14;
            *(undefined4 *)(puVar4 + 3) = uVar15;
            *(undefined4 *)((longlong)puVar4 + 0x1c) = uVar16;
            puVar9 = (undefined4 *)((longlong)((longlong)puVar10 + -0x60) + (longlong)puVar5);
            uVar18 = puVar9[1];
            uVar19 = puVar9[2];
            uVar20 = puVar9[3];
            puVar8 = (undefined4 *)((longlong)((longlong)puVar10 + -0x50) + (longlong)puVar5);
            uVar21 = *puVar8;
            uVar14 = puVar8[1];
            uVar15 = puVar8[2];
            uVar16 = puVar8[3];
            uVar13 = uVar13 - 1;
            *(undefined4 *)(puVar4 + 4) = *puVar9;
            *(undefined4 *)((longlong)puVar4 + 0x24) = uVar18;
            *(undefined4 *)(puVar4 + 5) = uVar19;
            *(undefined4 *)((longlong)puVar4 + 0x2c) = uVar20;
            *(undefined4 *)(puVar4 + 6) = uVar21;
            *(undefined4 *)((longlong)puVar4 + 0x34) = uVar14;
            *(undefined4 *)(puVar4 + 7) = uVar15;
            *(undefined4 *)((longlong)puVar4 + 0x3c) = uVar16;
            puVar9 = (undefined4 *)((longlong)((longlong)puVar10 + -0x40) + (longlong)puVar5);
            uVar18 = puVar9[1];
            uVar19 = puVar9[2];
            uVar20 = puVar9[3];
            puVar8 = (undefined4 *)((longlong)((longlong)puVar10 + -0x30) + (longlong)puVar5);
            uVar21 = *puVar8;
            uVar14 = puVar8[1];
            uVar15 = puVar8[2];
            uVar16 = puVar8[3];
            *(undefined4 *)(puVar4 + 8) = *puVar9;
            *(undefined4 *)((longlong)puVar4 + 0x44) = uVar18;
            *(undefined4 *)(puVar4 + 9) = uVar19;
            *(undefined4 *)((longlong)puVar4 + 0x4c) = uVar20;
            *(undefined4 *)(puVar4 + 10) = uVar21;
            *(undefined4 *)((longlong)puVar4 + 0x54) = uVar14;
            *(undefined4 *)(puVar4 + 0xb) = uVar15;
            *(undefined4 *)((longlong)puVar4 + 0x5c) = uVar16;
            puVar9 = (undefined4 *)((longlong)((longlong)puVar10 + -0x20) + (longlong)puVar5);
            uVar14 = *puVar9;
            uVar15 = puVar9[1];
            uVar16 = puVar9[2];
            uVar17 = puVar9[3];
            puVar9 = (undefined4 *)((longlong)((longlong)puVar10 + -0x10) + (longlong)puVar5);
            uVar18 = *puVar9;
            uVar19 = puVar9[1];
            uVar20 = puVar9[2];
            uVar21 = puVar9[3];
            if (uVar13 == 0) break;
            *(undefined4 *)(puVar4 + 0xc) = uVar14;
            *(undefined4 *)((longlong)puVar4 + 100) = uVar15;
            *(undefined4 *)(puVar4 + 0xd) = uVar16;
            *(undefined4 *)((longlong)puVar4 + 0x6c) = uVar17;
            *(undefined4 *)(puVar4 + 0xe) = uVar18;
            *(undefined4 *)((longlong)puVar4 + 0x74) = uVar19;
            *(undefined4 *)(puVar4 + 0xf) = uVar20;
            *(undefined4 *)((longlong)puVar4 + 0x7c) = uVar21;
            puVar4 = puVar5;
          }
        }
        else {
          while( true ) {
            puVar9 = (undefined4 *)((longlong)puVar10 + (longlong)puVar4);
            uVar18 = puVar9[1];
            uVar19 = puVar9[2];
            uVar20 = puVar9[3];
            puVar8 = (undefined4 *)((longlong)((longlong)puVar10 + 0x10) + (longlong)puVar4);
            uVar21 = *puVar8;
            uVar14 = puVar8[1];
            uVar15 = puVar8[2];
            uVar16 = puVar8[3];
            puVar5 = puVar4 + 0x10;
            *(undefined4 *)puVar4 = *puVar9;
            *(undefined4 *)((longlong)puVar4 + 4) = uVar18;
            *(undefined4 *)(puVar4 + 1) = uVar19;
            *(undefined4 *)((longlong)puVar4 + 0xc) = uVar20;
            *(undefined4 *)(puVar4 + 2) = uVar21;
            *(undefined4 *)((longlong)puVar4 + 0x14) = uVar14;
            *(undefined4 *)(puVar4 + 3) = uVar15;
            *(undefined4 *)((longlong)puVar4 + 0x1c) = uVar16;
            puVar9 = (undefined4 *)((longlong)((longlong)puVar10 + -0x60) + (longlong)puVar5);
            uVar18 = puVar9[1];
            uVar19 = puVar9[2];
            uVar20 = puVar9[3];
            puVar8 = (undefined4 *)((longlong)((longlong)puVar10 + -0x50) + (longlong)puVar5);
            uVar21 = *puVar8;
            uVar14 = puVar8[1];
            uVar15 = puVar8[2];
            uVar16 = puVar8[3];
            uVar13 = uVar13 - 1;
            *(undefined4 *)(puVar4 + 4) = *puVar9;
            *(undefined4 *)((longlong)puVar4 + 0x24) = uVar18;
            *(undefined4 *)(puVar4 + 5) = uVar19;
            *(undefined4 *)((longlong)puVar4 + 0x2c) = uVar20;
            *(undefined4 *)(puVar4 + 6) = uVar21;
            *(undefined4 *)((longlong)puVar4 + 0x34) = uVar14;
            *(undefined4 *)(puVar4 + 7) = uVar15;
            *(undefined4 *)((longlong)puVar4 + 0x3c) = uVar16;
            puVar9 = (undefined4 *)((longlong)((longlong)puVar10 + -0x40) + (longlong)puVar5);
            uVar18 = puVar9[1];
            uVar19 = puVar9[2];
            uVar20 = puVar9[3];
            puVar8 = (undefined4 *)((longlong)((longlong)puVar10 + -0x30) + (longlong)puVar5);
            uVar21 = *puVar8;
            uVar14 = puVar8[1];
            uVar15 = puVar8[2];
            uVar16 = puVar8[3];
            *(undefined4 *)(puVar4 + 8) = *puVar9;
            *(undefined4 *)((longlong)puVar4 + 0x44) = uVar18;
            *(undefined4 *)(puVar4 + 9) = uVar19;
            *(undefined4 *)((longlong)puVar4 + 0x4c) = uVar20;
            *(undefined4 *)(puVar4 + 10) = uVar21;
            *(undefined4 *)((longlong)puVar4 + 0x54) = uVar14;
            *(undefined4 *)(puVar4 + 0xb) = uVar15;
            *(undefined4 *)((longlong)puVar4 + 0x5c) = uVar16;
            puVar9 = (undefined4 *)((longlong)((longlong)puVar10 + -0x20) + (longlong)puVar5);
            uVar14 = *puVar9;
            uVar15 = puVar9[1];
            uVar16 = puVar9[2];
            uVar17 = puVar9[3];
            puVar9 = (undefined4 *)((longlong)((longlong)puVar10 + -0x10) + (longlong)puVar5);
            uVar18 = *puVar9;
            uVar19 = puVar9[1];
            uVar20 = puVar9[2];
            uVar21 = puVar9[3];
            if (uVar13 == 0) break;
            *(undefined4 *)(puVar4 + 0xc) = uVar14;
            *(undefined4 *)((longlong)puVar4 + 100) = uVar15;
            *(undefined4 *)(puVar4 + 0xd) = uVar16;
            *(undefined4 *)((longlong)puVar4 + 0x6c) = uVar17;
            *(undefined4 *)(puVar4 + 0xe) = uVar18;
            *(undefined4 *)((longlong)puVar4 + 0x74) = uVar19;
            *(undefined4 *)(puVar4 + 0xf) = uVar20;
            *(undefined4 *)((longlong)puVar4 + 0x7c) = uVar21;
            puVar4 = puVar5;
          }
        }
        *(undefined4 *)(puVar5 + -4) = uVar14;
        *(undefined4 *)((longlong)puVar5 + -0x1c) = uVar15;
        *(undefined4 *)(puVar5 + -3) = uVar16;
        *(undefined4 *)((longlong)puVar5 + -0x14) = uVar17;
        uVar11 = uVar11 & 0x7f;
      }
LAB_18006224a:
      uVar13 = uVar11 >> 4;
      while (uVar13 != 0) {
        *(undefined4 *)(puVar5 + -2) = uVar18;
        *(undefined4 *)((longlong)puVar5 + -0xc) = uVar19;
        *(undefined4 *)(puVar5 + -1) = uVar20;
        *(undefined4 *)((longlong)puVar5 + -4) = uVar21;
        puVar9 = (undefined4 *)((longlong)puVar10 + (longlong)puVar5);
        uVar18 = *puVar9;
        uVar19 = puVar9[1];
        uVar20 = puVar9[2];
        uVar21 = puVar9[3];
        puVar5 = puVar5 + 2;
        uVar13 = uVar13 - 1;
      }
      if ((uVar11 & 0xf) != 0) {
        lVar6 = (uVar11 & 0xf) + (longlong)puVar5;
        puVar9 = (undefined4 *)((longlong)puVar10 + lVar6 + -0x10);
        uVar14 = puVar9[1];
        uVar15 = puVar9[2];
        uVar16 = puVar9[3];
        *(undefined4 *)(lVar6 + -0x10) = *puVar9;
        *(undefined4 *)(lVar6 + -0xc) = uVar14;
        *(undefined4 *)(lVar6 + -8) = uVar15;
        *(undefined4 *)(lVar6 + -4) = uVar16;
      }
      *(undefined4 *)(puVar5 + -2) = uVar18;
      *(undefined4 *)((longlong)puVar5 + -0xc) = uVar19;
      *(undefined4 *)(puVar5 + -1) = uVar20;
      *(undefined4 *)((longlong)puVar5 + -4) = uVar21;
      return param_1;
    }
  }
  puVar10 = param_1;
  while (param_3 != 0) {
    param_3 = param_3 - 1;
    *(undefined *)puVar10 = *(undefined *)param_2;
    param_2 = (undefined8 *)((longlong)param_2 + 1);
    puVar10 = (undefined8 *)((longlong)puVar10 + 1);
  }
  return param_1;
}



// Library Function - Single Match
// Name: _CxxThrowException
// Library: Visual Studio 2015 Release

void _CxxThrowException(void *pExceptionObject,ThrowInfo *pThrowInfo)

{
  longlong lVar1;
  longlong lVar2;
  code *pcVar3;
  PVOID local_res8;
  undefined4 local_38;
  undefined4 uStack52;
  void *local_30;
  ThrowInfo *local_28;
  PVOID local_20;

  local_38 = 0x19930520;
  uStack52 = 0;
  local_30 = (void *)0x0;
  local_28 = (ThrowInfo *)0x0;
  local_20 = (PVOID)0x0;
  if ((pThrowInfo != (ThrowInfo *)0x0) && ((*(byte *)&pThrowInfo->attributes & 0x10) != 0)) {
                    // WARNING: Load size is inaccurate
    lVar1 = *pExceptionObject;
    lVar2 = *(longlong *)(lVar1 + -8);
    pcVar3 = *(code **)(lVar2 + 0x40);
    pThrowInfo = *(ThrowInfo **)(lVar2 + 0x30);
    _guard_check_icall();
    (*pcVar3)(lVar1 + -8);
  }
  local_30 = pExceptionObject;
  local_28 = pThrowInfo;
  local_res8 = RtlPcToFileHeader(pThrowInfo,&local_res8);
  if (pThrowInfo != (ThrowInfo *)0x0) {
    if ((*(byte *)&pThrowInfo->attributes & 8) == 0) {
      if (local_res8 == (PVOID)0x0) {
        local_38 = 0x1994000;
      }
    }
    else {
      local_38 = 0x1994000;
    }
  }
  local_20 = local_res8;
  RaiseException(0xe06d7363,1,4,(ULONG_PTR *)&local_38);
  return;
}



// Library Function - Single Match
// Name: ?_ExecutionInCatch@@YAHPEAU_xDISPATCHER_CONTEXT@@PEBU_s_FuncInfo@@@Z
// Library: Visual Studio 2015 Release
// int __cdecl _ExecutionInCatch(struct _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo const *
// __ptr64)

int _ExecutionInCatch(_xDISPATCHER_CONTEXT *param_1,_s_FuncInfo *param_2)

{
  int iVar1;
  longlong lVar2;
  ulonglong uVar3;

  iVar1 = FUN_1800638c4((longlong)param_2,(ulonglong *)param_1);
  uVar3 = (ulonglong)param_2->nTryBlocks;
  do {
    lVar2 = 0;
    if ((int)uVar3 == 0) break;
    uVar3 = (ulonglong)((int)uVar3 - 1);
    lVar2 = __vcrt_getptd();
    lVar2 = (longlong)(int)param_2->dispTryBlockMap + *(longlong *)(lVar2 + 0x60) + uVar3 * 0x14;
  } while ((iVar1 <= *(int *)(lVar2 + 4)) || (*(int *)(lVar2 + 8) < iVar1));
  return (int)(uint)(lVar2 != 0);
}



// Library Function - Single Match
// Name: ?_GetEstablisherFrame@@YAPEA_KPEA_KPEAU_xDISPATCHER_CONTEXT@@PEBU_s_FuncInfo@@0@Z
// Library: Visual Studio 2015 Release
// unsigned __int64 * __ptr64 __cdecl _GetEstablisherFrame(unsigned __int64 * __ptr64,struct
// _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo const * __ptr64,unsigned __int64 * __ptr64)

__uint64 *
_GetEstablisherFrame
          (__uint64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3,__uint64 *param_4)

{
  uint uVar1;
  int iVar2;
  PRUNTIME_FUNCTION p_Var3;
  uint uVar4;
  ulonglong uVar5;
  int *piVar6;
  longlong lVar7;
  ulonglong uVar8;
  longlong lVar9;
  ulonglong local_res8;

  uVar8 = (ulonglong)param_3->nTryBlocks;
  iVar2 = FUN_1800638c4((longlong)param_3,(ulonglong *)param_2);
  *param_4 = *param_1;
  do {
    do {
      if ((int)uVar8 == 0) {
        return param_4;
      }
      uVar8 = (ulonglong)((int)uVar8 - 1);
      lVar7 = (longlong)(int)param_3->dispTryBlockMap + uVar8 * 0x14 + *(longlong *)(param_2 + 8);
    } while ((iVar2 <= *(int *)(lVar7 + 4)) || (*(int *)(lVar7 + 8) < iVar2));
    p_Var3 = RtlLookupFunctionEntry(*(DWORD64 *)param_2,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
    uVar5 = 0;
    lVar9 = (longlong)*(int *)(lVar7 + 0x10) + local_res8;
    uVar1 = *(uint *)(lVar7 + 0xc);
    if (uVar1 != 0) {
      piVar6 = (int *)(lVar9 + 0xc);
      do {
        if ((longlong)*piVar6 == (ulonglong)p_Var3->BeginAddress) break;
        uVar4 = (int)uVar5 + 1;
        uVar5 = (ulonglong)uVar4;
        piVar6 = piVar6 + 5;
      } while (uVar4 < uVar1);
    }
    if ((uint)uVar5 < uVar1) {
      *param_4 = *(__uint64 *)((longlong)*(int *)(lVar9 + 0x10 + uVar5 * 0x14) + *param_1);
      return param_4;
    }
  } while( true );
}



// Library Function - Single Match
// Name:
?_GetRangeOfTrysToCheck@@YAPEBU_s_TryBlockMapEntry@@PEA_KPEBU_s_FuncInfo@@HHPEAI2PEAU_xDISPATCHER_CONTEXT@@@Z
// Library: Visual Studio 2015 Release
// struct _s_TryBlockMapEntry const * __ptr64 __cdecl _GetRangeOfTrysToCheck(unsigned __int64 *
// __ptr64,struct _s_FuncInfo const * __ptr64,int,int,unsigned int * __ptr64,unsigned int *
// __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64)

_s_TryBlockMapEntry *
_GetRangeOfTrysToCheck
          (__uint64 *param_1,_s_FuncInfo *param_2,int param_3,int param_4,uint *param_5,
          uint *param_6,_xDISPATCHER_CONTEXT *param_7)

{
  uint uVar1;
  longlong lVar2;
  uint uVar3;
  code *pcVar4;
  int iVar5;
  _s_TryBlockMapEntry *p_Var6;
  int *piVar7;
  uint uVar8;
  longlong lVar9;
  longlong lVar10;

  uVar3 = param_2->nTryBlocks;
  lVar9 = 0;
  iVar5 = FUN_1800638c4((longlong)param_2,(ulonglong *)param_7);
  if (uVar3 == 0) {
    terminate();
    pcVar4 = (code *)swi(3);
    p_Var6 = (_s_TryBlockMapEntry *)(*pcVar4)();
    return p_Var6;
  }
  *param_6 = 0xffffffff;
  *param_5 = 0xffffffff;
  lVar10 = (longlong)(int)param_2->dispTryBlockMap;
  uVar8 = uVar3;
  do {
    uVar1 = uVar8 - 1;
    lVar2 = *(longlong *)(param_7 + 8) + (ulonglong)uVar1 * 0x14;
    if ((*(int *)(lVar2 + 4 + lVar10) < iVar5) && (iVar5 <= *(int *)(lVar2 + 8 + lVar10))) break;
    uVar8 = uVar1;
  } while (uVar1 != 0);
  if (uVar8 != 0) {
    lVar9 = lVar10 + (ulonglong)(uVar8 - 1) * 0x14 + *(longlong *)(param_7 + 8);
  }
  uVar8 = 0;
  if (uVar3 != 0) {
    lVar10 = 0;
    do {
      piVar7 = (int *)((longlong)(int)param_2->dispTryBlockMap + *(longlong *)(param_7 + 8) + lVar10
                      );
      if ((((lVar9 == 0) ||
           ((*piVar7 != *(int *)(lVar9 + 4) && *(int *)(lVar9 + 4) <= *piVar7 &&
            (piVar7[1] == *(int *)(lVar9 + 8) || piVar7[1] < *(int *)(lVar9 + 8))))) &&
          (*piVar7 <= param_4)) && (param_4 <= piVar7[1])) {
        if (*param_5 == 0xffffffff) {
          *param_5 = uVar8;
        }
        *param_6 = uVar8 + 1;
      }
      uVar8 = uVar8 + 1;
      lVar10 = lVar10 + 0x14;
    } while (uVar8 < uVar3);
    if (*param_5 != 0xffffffff) {
      return (_s_TryBlockMapEntry *)
             ((longlong)(int)param_2->dispTryBlockMap + (ulonglong)*param_5 * 0x14 +
             *(longlong *)(param_7 + 8));
    }
  }
  *param_5 = 0;
  *param_6 = 0;
  return (_s_TryBlockMapEntry *)0x0;
}



// Library Function - Single Match
// Name: ?__FrameUnwindToEmptyState@@YAXPEA_KPEAU_xDISPATCHER_CONTEXT@@PEBU_s_FuncInfo@@@Z
// Library: Visual Studio 2015 Release
// void __cdecl __FrameUnwindToEmptyState(unsigned __int64 * __ptr64,struct _xDISPATCHER_CONTEXT *
// __ptr64,struct _s_FuncInfo const * __ptr64)

void __FrameUnwindToEmptyState(__uint64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3)

{
  int iVar1;
  __uint64 *p_Var2;
  longlong lVar3;
  ulonglong uVar4;
  __uint64 local_res18 [2];

  p_Var2 = _GetEstablisherFrame(param_1,param_2,param_3,local_res18);
  iVar1 = FUN_1800638c4((longlong)param_3,(ulonglong *)param_2);
  uVar4 = (ulonglong)param_3->nTryBlocks;
  do {
    if ((int)uVar4 == 0) {
      lVar3 = 0;
      break;
    }
    uVar4 = (ulonglong)((int)uVar4 - 1);
    lVar3 = __vcrt_getptd();
    lVar3 = (longlong)(int)param_3->dispTryBlockMap + *(longlong *)(lVar3 + 0x60) + uVar4 * 0x14;
  } while ((iVar1 <= *(int *)(lVar3 + 4)) || (*(int *)(lVar3 + 8) < iVar1));
  if (lVar3 == 0) {
    iVar1 = -1;
  }
  else {
    iVar1 = *(int *)(lVar3 + 4);
  }
  __FrameUnwindToState(p_Var2,param_2,param_3,iVar1);
  return;
}



undefined8
FUN_180062804(int **param_1,undefined8 param_2,__uint64 *param_3,_CONTEXT *param_4,
             _xDISPATCHER_CONTEXT *param_5,_s_FuncInfo *param_6,undefined4 *param_7)

{
  int *piVar1;
  longlong lVar2;

  lVar2 = __vcrt_getptd();
  *(undefined8 *)(lVar2 + 0x70) = param_2;
  piVar1 = *param_1;
  lVar2 = __vcrt_getptd();
  *(undefined8 *)(lVar2 + 0x68) = *(undefined8 *)(piVar1 + 0xe);
  FUN_180064a5c(*param_1,param_3,param_4,param_5,param_6,0,(__uint64 *)0x0,1);
  lVar2 = __vcrt_getptd();
  *(undefined8 *)(lVar2 + 0x70) = 0;
  *param_7 = 1;
  return 1;
}



// Library Function - Single Match
// Name: _CallSETranslator
// Library: Visual Studio 2015 Release

undefined8 _CallSETranslator(uint *param_1,undefined8 param_2,undefined8 param_3)

{
  code *pcVar1;
  longlong lVar2;
  uint *local_30;
  undefined8 local_28;

  local_30 = param_1;
  local_28 = param_3;
  lVar2 = __vcrt_getptd();
  pcVar1 = *(code **)(lVar2 + 0x10);
  _guard_check_icall();
  (*pcVar1)(*param_1,&local_30);
  return 0;
}



// Library Function - Single Match
// Name: _CreateFrameInfo
// Library: Visual Studio 2015 Release

undefined8 * _CreateFrameInfo(undefined8 *param_1,undefined8 param_2)

{
  longlong lVar1;
  undefined8 uVar2;

  *param_1 = param_2;
  lVar1 = __vcrt_getptd();
  if (param_1 < *(undefined8 **)(lVar1 + 0x58)) {
    lVar1 = __vcrt_getptd();
    uVar2 = *(undefined8 *)(lVar1 + 0x58);
  }
  else {
    uVar2 = 0;
  }
  param_1[1] = uVar2;
  lVar1 = __vcrt_getptd();
  *(undefined8 **)(lVar1 + 0x58) = param_1;
  return param_1;
}



// Library Function - Single Match
// Name: _FindAndUnlinkFrame
// Library: Visual Studio 2015 Release

void _FindAndUnlinkFrame(longlong param_1)

{
  code *pcVar1;
  longlong lVar2;
  longlong lVar3;

  lVar2 = __vcrt_getptd();
  if (param_1 != *(longlong *)(lVar2 + 0x58)) {
    terminate();
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  lVar2 = __vcrt_getptd();
  lVar2 = *(longlong *)(lVar2 + 0x58);
  while( true ) {
    if (lVar2 == 0) {
      terminate();
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
    if (param_1 == lVar2) break;
    lVar2 = *(longlong *)(lVar2 + 8);
  }
  lVar3 = __vcrt_getptd();
  *(undefined8 *)(lVar3 + 0x58) = *(undefined8 *)(lVar2 + 8);
  return;
}



// Library Function - Single Match
// Name: _GetImageBase
// Library: Visual Studio 2015 Release

undefined8 _GetImageBase(void)

{
  longlong lVar1;

  lVar1 = __vcrt_getptd();
  return *(undefined8 *)(lVar1 + 0x60);
}



// Library Function - Single Match
// Name: _GetThrowImageBase
// Library: Visual Studio 2015 Release

undefined8 _GetThrowImageBase(void)

{
  longlong lVar1;

  lVar1 = __vcrt_getptd();
  return *(undefined8 *)(lVar1 + 0x68);
}



// Library Function - Single Match
// Name: _SetImageBase
// Library: Visual Studio 2015 Release

void _SetImageBase(undefined8 param_1)

{
  longlong lVar1;

  lVar1 = __vcrt_getptd();
  *(undefined8 *)(lVar1 + 0x60) = param_1;
  return;
}



// Library Function - Single Match
// Name: _SetThrowImageBase
// Library: Visual Studio 2015 Release

void _SetThrowImageBase(undefined8 param_1)

{
  longlong lVar1;

  lVar1 = __vcrt_getptd();
  *(undefined8 *)(lVar1 + 0x68) = param_1;
  return;
}



// Library Function - Single Match
// Name: _UnwindNestedFrames
// Library: Visual Studio 2015 Release

void _UnwindNestedFrames(PVOID *param_1,ULONG_PTR param_2,ULONG_PTR param_3,ULONG_PTR param_4,
                        ULONG_PTR param_5,int param_6,ULONG_PTR param_7,PVOID *param_8,byte param_9)

{
  undefined local_588 [12];
  undefined4 uStack1404;
  undefined4 local_578;
  undefined4 uStack1396;
  DWORD DStack1392;
  undefined4 uStack1388;
  undefined *local_568;
  ULONG_PTR local_560;
  ULONG_PTR local_558;
  ULONG_PTR local_550;
  ULONG_PTR local_548;
  ULONG_PTR local_540;
  ULONG_PTR local_538;
  ulonglong local_530;
  ULONG_PTR local_528;
  undefined4 uStack1312;
  undefined4 uStack1308;
  undefined4 local_518;
  undefined4 uStack1300;
  undefined4 uStack1296;
  undefined4 uStack1292;
  undefined4 local_508;
  undefined4 uStack1284;
  undefined4 uStack1280;
  undefined4 uStack1276;
  ULONG_PTR local_4f8;
  _CONTEXT local_4e8;
  ulonglong local_18;

  local_18 = DAT_1800b04e8 ^ (ulonglong)&stack0xfffffffffffffa48;
  local_588._0_4_ = 0x80000029;
  local_588._4_4_ = 1;
  local_588._8_4_ = 0;
  uStack1404 = 0;
  local_578 = 0;
  uStack1396 = 0;
  DStack1392 = 0xf;
  uStack1388 = 0;
  uStack1312 = 0;
  uStack1308 = 0;
  local_518 = 0;
  uStack1300 = 0;
  uStack1296 = 0;
  uStack1292 = 0;
  local_508 = 0;
  uStack1284 = 0;
  uStack1280 = 0;
  uStack1276 = 0;
  local_4f8 = 0;
  local_568 = &LAB_1800646dc;
  local_558 = param_5;
  local_550 = SEXT48(param_6);
  local_540 = param_7;
  local_530 = (ulonglong)param_9;
  local_528 = 0x19930520;
  local_560 = param_4;
  local_548 = param_3;
  local_538 = param_2;
  RtlUnwindEx(*param_1,*param_8,(PEXCEPTION_RECORD)local_588,(PVOID)0x0,(PCONTEXT)&local_4e8,
              (PUNWIND_HISTORY_TABLE)param_8[8]);
  FUN_18005f100(local_18 ^ (ulonglong)&stack0xfffffffffffffa48);
  return;
}



void FUN_180062b14(int *param_1,__uint64 param_2,_CONTEXT *param_3,_xDISPATCHER_CONTEXT *param_4)

{
  longlong lVar1;
  __uint64 local_res8;

  local_res8 = param_2;
  lVar1 = __vcrt_getptd();
  *(undefined8 *)(lVar1 + 0x60) = *(undefined8 *)(param_4 + 8);
  lVar1 = __vcrt_getptd();
  *(undefined8 *)(lVar1 + 0x68) = *(undefined8 *)(param_1 + 0xe);
  lVar1 = __vcrt_getptd();
  FUN_180064a5c(param_1,&local_res8,param_3,param_4,
                (_s_FuncInfo *)
                ((ulonglong)**(uint **)(param_4 + 0x38) + *(longlong *)(lVar1 + 0x60)),0,
                (__uint64 *)0x0,0);
  return;
}



void FUN_180062bf8(void)

{
  byte bVar1;
  code *pcVar2;

  bVar1 = (byte)DAT_1800b04e8 & 0x3f;
  pcVar2 = (code *)((DAT_1800b04e8 ^ DAT_1800b1f58) >> bVar1 |
                   (DAT_1800b04e8 ^ DAT_1800b1f58) << 0x40 - bVar1);
  if (pcVar2 != (code *)0x0) {
    _guard_check_icall();
    (*pcVar2)();
  }
  abort();
  pcVar2 = (code *)swi(3);
  (*pcVar2)();
  return;
}



// Library Function - Single Match
// Name: __DestructExceptionObject
// Library: Visual Studio 2015 Release

void __DestructExceptionObject(int *param_1)

{
  byte *pbVar1;
  longlong *plVar2;
  code *pcVar3;

  if ((((param_1 != (int *)0x0) && (*param_1 == -0x1f928c9d)) && (param_1[6] == 4)) &&
     ((param_1[8] + 0xe66cfae0U < 3 && (pbVar1 = *(byte **)(param_1 + 0xc), pbVar1 != (byte *)0x0)))
     ) {
    if (*(int *)(pbVar1 + 4) == 0) {
      if (((*pbVar1 & 0x10) != 0) &&
         (plVar2 = **(longlong ***)(param_1 + 10), plVar2 != (longlong *)0x0)) {
        pcVar3 = *(code **)(*plVar2 + 0x10);
        _guard_check_icall();
        (*pcVar3)(plVar2);
      }
    }
    else {
      FUN_180062cf0(*(undefined8 *)(param_1 + 10),
                    (undefined *)((longlong)*(int *)(pbVar1 + 4) + *(longlong *)(param_1 + 0xe)));
    }
  }
  return;
}



void FUN_180062cf0(undefined8 param_1,undefined *param_2)

{
                    // WARNING: Could not recover jumptable at 0x000180062cf0. Too many branches
                    // WARNING: Treating indirect jump as call
  (*(code *)param_2)();
  return;
}



// Library Function - Single Match
// Name: _IsExceptionObjectToBeDestroyed
// Library: Visual Studio 2015 Release

undefined8 _IsExceptionObjectToBeDestroyed(longlong param_1)

{
  longlong lVar1;
  longlong *plVar2;

  lVar1 = __vcrt_getptd();
  plVar2 = *(longlong **)(lVar1 + 0x58);
  while( true ) {
    if (plVar2 == (longlong *)0x0) {
      return 1;
    }
    if (*plVar2 == param_1) break;
    plVar2 = (longlong *)plVar2[1];
  }
  return 0;
}



// Library Function - Single Match
// Name: __AdjustPointer
// Library: Visual Studio 2015 Release

longlong __AdjustPointer(longlong param_1,int *param_2)

{
  longlong lVar1;

  lVar1 = *param_2 + param_1;
  if (-1 < param_2[1]) {
    lVar1 = lVar1 + (longlong)*(int *)((longlong)param_2[2] + *(longlong *)(param_2[1] + param_1)) +
                    (longlong)param_2[1];
  }
  return lVar1;
}



// Library Function - Single Match
// Name: __FrameUnwindFilter
// Library: Visual Studio 2015 Release

undefined8 __FrameUnwindFilter(int **param_1)

{
  int *piVar1;
  code *pcVar2;
  longlong lVar3;
  undefined8 uVar4;

  piVar1 = *param_1;
  if ((*piVar1 == -0x1fbcbcae) || (*piVar1 == -0x1fbcb0b3)) {
    lVar3 = __vcrt_getptd();
    if (0 < *(int *)(lVar3 + 0x30)) {
      lVar3 = __vcrt_getptd();
      *(int *)(lVar3 + 0x30) = *(int *)(lVar3 + 0x30) + -1;
    }
  }
  else {
    if (*piVar1 == -0x1f928c9d) {
      lVar3 = __vcrt_getptd();
      *(undefined4 *)(lVar3 + 0x30) = 0;
      terminate();
      pcVar2 = (code *)swi(3);
      uVar4 = (*pcVar2)();
      return uVar4;
    }
  }
  return 0;
}



// Library Function - Single Match
// Name: __GetPlatformExceptionInfo
// Library: Visual Studio 2015 Release

undefined8 __GetPlatformExceptionInfo(undefined4 *param_1)

{
  longlong lVar1;
  undefined8 uVar2;
  int *local_18;
  undefined8 local_10;

  *param_1 = 0;
  lVar1 = __vcrt_getptd();
  local_18 = *(int **)(lVar1 + 0x20);
  if ((local_18 != (int *)0x0) && (*(byte **)(local_18 + 0xc) != (byte *)0x0)) {
    if ((**(byte **)(local_18 + 0xc) & 0x10) != 0) {
      return *(undefined8 *)(**(longlong **)(local_18 + 10) + -8);
    }
    local_10 = 0;
    uVar2 = _is_exception_typeof((longlong)&class_std__bad_alloc_RTTI_Type_Descriptor,&local_18);
    *param_1 = (int)uVar2;
  }
  return 0;
}



void Unwind_180062e3c(void)

{
  code *pcVar1;

  terminate();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



ulonglong FUN_180062e48(void)

{
  ulonglong uVar1;

  uVar1 = FUN_180063774();
  if (uVar1 != 0) {
    uVar1 = (ulonglong)*(uint *)(uVar1 + 0x30);
  }
  return uVar1 & 0xffffffffffffff00 | (ulonglong)((int)uVar1 != 0);
}



// Library Function - Single Match
// Name: _is_exception_typeof
// Library: Visual Studio 2015 Release

undefined8 _is_exception_typeof(longlong param_1,int **param_2)

{
  char cVar1;
  char cVar2;
  int *piVar3;
  longlong lVar4;
  code *pcVar5;
  char *pcVar6;
  undefined8 uVar7;
  int iVar8;
  int *piVar9;

  if (param_2 == (int **)0x0) {
    terminate();
    pcVar5 = (code *)swi(3);
    uVar7 = (*pcVar5)();
    return uVar7;
  }
  piVar3 = *param_2;
  if (piVar3 == (int *)0x0) {
    terminate();
    pcVar5 = (code *)swi(3);
    uVar7 = (*pcVar5)();
    return uVar7;
  }
  if (((*piVar3 != -0x1f928c9d) || (piVar3[6] != 4)) || (2 < piVar3[8] + 0xe66cfae0U)) {
    terminate();
    pcVar5 = (code *)swi(3);
    uVar7 = (*pcVar5)();
    return uVar7;
  }
  lVar4 = *(longlong *)(piVar3 + 0xe);
  piVar9 = (int *)(lVar4 + 4 + (longlong)*(int *)(*(longlong *)(piVar3 + 0xc) + 0xc));
  iVar8 = *(int *)(*(int *)(*(longlong *)(piVar3 + 0xc) + 0xc) + lVar4);
  if (0 < iVar8) {
    do {
      pcVar6 = (char *)(param_1 + 0x10);
      do {
        cVar1 = *pcVar6;
        cVar2 = pcVar6[(lVar4 + 0x10 + (longlong)*(int *)((longlong)*piVar9 + 4 + lVar4)) -
                       (longlong)(char *)(param_1 + 0x10)];
        if (cVar1 != cVar2) break;
        pcVar6 = pcVar6 + 1;
      } while (cVar2 != '\0');
      if (cVar1 == cVar2) {
        return 1;
      }
      iVar8 = iVar8 + -1;
      piVar9 = piVar9 + 1;
    } while (0 < iVar8);
  }
  return 0;
}



undefined8
FUN_180062f34(PEXCEPTION_RECORD param_1,PVOID param_2,undefined8 param_3,longlong *param_4)

{
  uint uVar1;
  longlong lVar2;
  uint *puVar3;
  int iVar4;
  BOOL BVar5;
  ulonglong uVar6;
  uint uVar7;
  ulonglong uVar8;
  uint uVar9;
  ulonglong uVar10;
  uint uVar11;
  ulonglong uVar12;
  PEXCEPTION_RECORD local_38;
  undefined8 local_30;

  FUN_180064eb4();
  lVar2 = param_4[1];
  puVar3 = (uint *)param_4[7];
  uVar12 = *param_4 - lVar2;
  if ((*(byte *)&param_1->ExceptionFlags & 0x66) == 0) {
    uVar7 = *(uint *)(param_4 + 9);
    local_38 = param_1;
    local_30 = param_3;
    while (uVar7 < *puVar3) {
      uVar8 = (ulonglong)uVar7;
      if (((puVar3[uVar8 * 4 + 1] <= uVar12) && (uVar12 < puVar3[uVar8 * 4 + 2])) &&
         (puVar3[uVar8 * 4 + 4] != 0)) {
        if (puVar3[uVar8 * 4 + 3] != 1) {
          iVar4 = (*(code *)((ulonglong)puVar3[uVar8 * 4 + 3] + lVar2))(&local_38,param_2);
          if (iVar4 < 0) {
            return 0;
          }
          if (iVar4 < 1) goto LAB_18006304e;
        }
        if ((param_1->ExceptionCode == 0xe06d7363) &&
           (BVar5 = _IsNonwritableInCurrentImage((PBYTE)&PTR___DestructExceptionObject_18007abf8),
           BVar5 != 0)) {
          __DestructExceptionObject((int *)param_1);
        }
        FUN_180064e80();
        RtlUnwindEx(param_2,(PVOID)((ulonglong)puVar3[uVar8 * 4 + 4] + lVar2),param_1,
                    (PVOID)(ulonglong)param_1->ExceptionCode,(PCONTEXT)param_4[5],
                    (PUNWIND_HISTORY_TABLE)param_4[8]);
        FUN_180064eb0();
      }
LAB_18006304e:
      uVar7 = uVar7 + 1;
    }
  }
  else {
    uVar7 = *(uint *)(param_4 + 9);
    uVar8 = param_4[4] - lVar2;
    while (uVar1 = *puVar3, uVar7 < uVar1) {
      uVar6 = (ulonglong)uVar7;
      if ((puVar3[uVar6 * 4 + 1] <= uVar12) && (uVar12 < puVar3[uVar6 * 4 + 2])) {
        uVar11 = param_1->ExceptionFlags & 0x20;
        if (uVar11 != 0) {
          uVar10 = 0;
          if (uVar1 != 0) {
            do {
              if ((((puVar3[uVar10 * 4 + 1] <= uVar8) && (uVar8 < puVar3[uVar10 * 4 + 2])) &&
                  (puVar3[uVar10 * 4 + 4] == puVar3[uVar6 * 4 + 4])) &&
                 (puVar3[uVar10 * 4 + 3] == puVar3[uVar6 * 4 + 3])) break;
              uVar9 = (int)uVar10 + 1;
              uVar10 = (ulonglong)uVar9;
            } while (uVar9 < uVar1);
          }
          if ((uint)uVar10 != uVar1) {
            return 1;
          }
        }
        if (puVar3[uVar6 * 4 + 4] == 0) {
          *(uint *)(param_4 + 9) = uVar7 + 1;
          (*(code *)((ulonglong)puVar3[uVar6 * 4 + 3] + lVar2))();
        }
        else {
          if ((uVar8 == puVar3[uVar6 * 4 + 4]) && (uVar11 != 0)) {
            return 1;
          }
        }
      }
      uVar7 = uVar7 + 1;
    }
  }
  return 1;
}



// Library Function - Single Match
// Name: __vcrt_initialize
// Library: Visual Studio 2015 Release

uint __vcrt_initialize(void)

{
  uint uVar1;

  __vcrt_initialize_pure_virtual_call_handler();
  FUN_180065878();
  uVar1 = __vcrt_initialize_locks();
  if ((char)uVar1 != '\0') {
    uVar1 = __vcrt_initialize_ptd();
    if ((char)uVar1 != '\0') {
      return CONCAT31((int3)(uVar1 >> 8),1);
    }
    uVar1 = __vcrt_uninitialize_locks();
  }
  return uVar1 & 0xffffff00;
}



// Library Function - Single Match
// Name: __vcrt_thread_attach
// Library: Visual Studio 2015 Release

ulonglong __vcrt_thread_attach(void)

{
  LPVOID pvVar1;

  pvVar1 = __vcrt_getptd_noexit();
  return (ulonglong)pvVar1 & 0xffffffffffffff00 | (ulonglong)(pvVar1 != (LPVOID)0x0);
}



// Library Function - Single Match
// Name: __vcrt_thread_detach
// Library: Visual Studio 2015 Release

undefined __vcrt_thread_detach(void)

{
  __vcrt_freeptd((undefined *)0x0);
  return 1;
}



// Library Function - Single Match
// Name: __vcrt_uninitialize
// Library: Visual Studio 2015 Release

undefined __vcrt_uninitialize(char param_1)

{
  if (param_1 == '\0') {
    __vcrt_uninitialize_ptd();
    __vcrt_uninitialize_locks();
    __vcrt_uninitialize_winapi_thunks('\0');
  }
  return 1;
}



void FUN_180063200(undefined8 *param_1)

{
  _free_base(*param_1);
  *param_1 = 0;
  return;
}



void FUN_18006321c(undefined8 *param_1)

{
  _free_base(*param_1);
  *param_1 = 0;
  return;
}



void FUN_1800632a4(undefined8 *param_1)

{
  _free_base(*param_1);
  *param_1 = 0;
  return;
}



// Library Function - Single Match
// Name: __std_type_info_compare
// Library: Visual Studio 2015 Release

ulonglong __std_type_info_compare(longlong param_1,longlong param_2)

{
  byte bVar1;
  byte *pbVar2;
  longlong lVar3;

  if (param_1 != param_2) {
    pbVar2 = (byte *)(param_1 + 9);
    lVar3 = (param_2 + 9) - (longlong)pbVar2;
    do {
      bVar1 = *pbVar2;
      if (bVar1 != pbVar2[lVar3]) {
        return (ulonglong)(-(uint)(bVar1 < pbVar2[lVar3]) | 1);
      }
      pbVar2 = pbVar2 + 1;
    } while (bVar1 != 0);
  }
  return 0;
}



void FUN_18006347c(void **param_1)

{
  free(*param_1);
  *param_1 = (void *)0x0;
  return;
}



// Library Function - Single Match
// Name: __std_exception_copy
// Library: Visual Studio 2015 Release

void __std_exception_copy(char **param_1,char **param_2)

{
  longlong lVar1;
  char *_Dst;
  longlong lVar2;

  if ((*(char *)(param_1 + 1) == '\0') || (*param_1 == (char *)0x0)) {
    *param_2 = *param_1;
    *(undefined *)(param_2 + 1) = 0;
  }
  else {
    lVar1 = -1;
    do {
      lVar2 = lVar1;
      lVar1 = lVar2 + 1;
    } while ((*param_1)[lVar2 + 1] != '\0');
    _Dst = (char *)malloc(lVar2 + 2);
    if (_Dst != (char *)0x0) {
      strcpy_s(_Dst,lVar2 + 2,*param_1);
      *(undefined *)(param_2 + 1) = 1;
      *param_2 = _Dst;
      _Dst = (char *)0x0;
    }
    free(_Dst);
  }
  return;
}



// Library Function - Single Match
// Name: __std_exception_destroy
// Library: Visual Studio 2015 Release

void __std_exception_destroy(void **param_1)

{
  if (*(char *)(param_1 + 1) != '\0') {
    free(*param_1);
  }
  *(undefined *)(param_1 + 1) = 0;
  *param_1 = (void *)0x0;
  return;
}



DWORD * FUN_180063598(DWORD *param_1)

{
  DWORD DVar1;

  DVar1 = GetLastError();
  *param_1 = DVar1;
  return param_1;
}



void FUN_1800635b4(undefined8 *param_1)

{
  _free_base(*param_1);
  *param_1 = 0;
  return;
}



// Library Function - Single Match
// Name: __vcrt_freeptd
// Library: Visual Studio 2015 Release

void __vcrt_freeptd(undefined *param_1)

{
  if (DAT_1800b0530 != 0xffffffff) {
    if (param_1 == (undefined *)0x0) {
      param_1 = (undefined *)__vcrt_FlsGetValue(DAT_1800b0530);
    }
    __vcrt_FlsSetValue(DAT_1800b0530,(LPVOID)0x0);
    if ((param_1 != (undefined *)0x0) && (param_1 != &DAT_1800b1ee0)) {
      _free_base(param_1);
    }
  }
  return;
}



// Library Function - Single Match
// Name: __vcrt_getptd
// Library: Visual Studio 2015 Release

void __vcrt_getptd(void)

{
  code *pcVar1;
  LPVOID pvVar2;

  pvVar2 = __vcrt_getptd_noexit();
  if (pvVar2 != (LPVOID)0x0) {
    return;
  }
  abort();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



// Library Function - Single Match
// Name: __vcrt_getptd_noexit
// Library: Visual Studio 2015 Release

LPVOID __vcrt_getptd_noexit(void)

{
  DWORD dwErrCode;
  int iVar1;
  LPVOID pvVar2;
  LPVOID pvVar3;
  LPVOID pvVar4;

  if (DAT_1800b0530 == 0xffffffff) {
    pvVar3 = (LPVOID)0x0;
  }
  else {
    dwErrCode = GetLastError();
    pvVar2 = (LPVOID)__vcrt_FlsGetValue(DAT_1800b0530);
    pvVar4 = (LPVOID)0x0;
    pvVar3 = pvVar4;
    if (((pvVar2 != (LPVOID)0xffffffffffffffff) && (pvVar3 = pvVar2, pvVar2 == (LPVOID)0x0)) &&
       (iVar1 = __vcrt_FlsSetValue(DAT_1800b0530,(LPVOID)0xffffffffffffffff), pvVar3 = pvVar4,
       iVar1 != 0)) {
      pvVar3 = (LPVOID)_calloc_base();
      if ((pvVar3 == (LPVOID)0x0) ||
         (iVar1 = __vcrt_FlsSetValue(DAT_1800b0530,pvVar3), pvVar2 = pvVar4, iVar1 == 0)) {
        __vcrt_FlsSetValue(DAT_1800b0530,(LPVOID)0x0);
        pvVar2 = pvVar3;
        pvVar3 = pvVar4;
      }
      _free_base(pvVar2);
    }
    SetLastError(dwErrCode);
  }
  return pvVar3;
}



longlong FUN_180063774(void)

{
  DWORD dwErrCode;
  longlong lVar1;

  if (DAT_1800b0530 == 0xffffffff) {
    lVar1 = 0;
  }
  else {
    dwErrCode = GetLastError();
    lVar1 = __vcrt_FlsGetValue(DAT_1800b0530);
    SetLastError(dwErrCode);
    if (lVar1 == -1) {
      lVar1 = 0;
    }
  }
  return lVar1;
}



// Library Function - Single Match
// Name: __vcrt_initialize_ptd
// Library: Visual Studio 2015 Release

uint __vcrt_initialize_ptd(void)

{
  uint uVar1;
  int iVar2;

  uVar1 = FUN_18006569c(&LAB_180063630);
  DAT_1800b0530 = uVar1;
  if (uVar1 != 0xffffffff) {
    iVar2 = __vcrt_FlsSetValue(uVar1,&DAT_1800b1ee0);
    if (iVar2 != 0) {
      return CONCAT31((int3)((uint)iVar2 >> 8),1);
    }
    uVar1 = __vcrt_uninitialize_ptd();
  }
  return uVar1 & 0xffffff00;
}



// Library Function - Single Match
// Name: __vcrt_uninitialize_ptd
// Library: Visual Studio 2015 Release

undefined __vcrt_uninitialize_ptd(void)

{
  if (DAT_1800b0530 != 0xffffffff) {
    __vcrt_FlsFree(DAT_1800b0530);
    DAT_1800b0530 = 0xffffffff;
  }
  return 1;
}



// Library Function - Single Match
// Name: ?__GetCurrentState@@YAHPEA_KPEAU_xDISPATCHER_CONTEXT@@PEBU_s_FuncInfo@@@Z
// Library: Visual Studio 2015 Release
// int __cdecl __GetCurrentState(unsigned __int64 * __ptr64,struct _xDISPATCHER_CONTEXT *
// __ptr64,struct _s_FuncInfo const * __ptr64)

int __GetCurrentState(__uint64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3)

{
  int iVar1;
  ulonglong uVar2;

  iVar1 = *(int *)((longlong)param_3->dispUnwindHelp + *param_1);
  if (iVar1 == -2) {
    uVar2 = FUN_1800638cc((longlong)param_3,(longlong)param_2,*(ulonglong *)param_2);
    iVar1 = (int)uVar2;
  }
  return iVar1;
}



// Library Function - Single Match
// Name: ?__GetUnwindTryBlock@@YAHPEA_KPEAU_xDISPATCHER_CONTEXT@@PEBU_s_FuncInfo@@@Z
// Library: Visual Studio 2015 Release
// int __cdecl __GetUnwindTryBlock(unsigned __int64 * __ptr64,struct _xDISPATCHER_CONTEXT *
// __ptr64,struct _s_FuncInfo const * __ptr64)

int __GetUnwindTryBlock(__uint64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3)

{
  __uint64 *p_Var1;
  __uint64 local_res18 [2];

  p_Var1 = _GetEstablisherFrame(param_1,param_2,param_3,local_res18);
  return *(int *)((longlong)param_3->dispUnwindHelp + 4 + *p_Var1);
}



// Library Function - Single Match
// Name: ?__SetState@@YAXPEA_KPEAU_xDISPATCHER_CONTEXT@@PEBU_s_FuncInfo@@H@Z
// Library: Visual Studio 2015 Release
// void __cdecl __SetState(unsigned __int64 * __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct
// _s_FuncInfo const * __ptr64,int)

void __SetState(__uint64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3,int param_4)

{
  *(int *)((longlong)param_3->dispUnwindHelp + *param_1) = param_4;
  return;
}



// Library Function - Single Match
// Name: ?__SetUnwindTryBlock@@YAXPEA_KPEAU_xDISPATCHER_CONTEXT@@PEBU_s_FuncInfo@@H@Z
// Library: Visual Studio 2015 Release
// void __cdecl __SetUnwindTryBlock(unsigned __int64 * __ptr64,struct _xDISPATCHER_CONTEXT *
// __ptr64,struct _s_FuncInfo const * __ptr64,int)

void __SetUnwindTryBlock(__uint64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3,
                        int param_4)

{
  __uint64 *p_Var1;
  __uint64 local_res18 [2];

  p_Var1 = _GetEstablisherFrame(param_1,param_2,param_3,local_res18);
  if (*(int *)((longlong)param_3->dispUnwindHelp + 4 + *p_Var1) < param_4) {
    *(int *)((longlong)param_3->dispUnwindHelp + 4 + *p_Var1) = param_4;
  }
  return;
}



void FUN_1800638c4(longlong param_1,ulonglong *param_2)

{
  FUN_1800638cc(param_1,(longlong)param_2,*param_2);
  return;
}



ulonglong FUN_1800638cc(longlong param_1,longlong param_2,ulonglong param_3)

{
  longlong lVar1;
  code *pcVar2;
  ulonglong uVar3;
  uint uVar4;
  longlong lVar5;

  if (param_1 == 0) {
    terminate();
    pcVar2 = (code *)swi(3);
    uVar3 = (*pcVar2)();
    return uVar3;
  }
  lVar5 = (longlong)*(int *)(param_1 + 0x18);
  lVar1 = *(longlong *)(param_2 + 8);
  if (lVar5 + lVar1 == 0) {
    terminate();
    pcVar2 = (code *)swi(3);
    uVar3 = (*pcVar2)();
    return uVar3;
  }
  uVar3 = 0;
  if (*(uint *)(param_1 + 0x14) != 0) {
    do {
      if (param_3 < (ulonglong)*(uint *)(lVar5 + uVar3 * 8 + lVar1) + lVar1) break;
      uVar4 = (int)uVar3 + 1;
      uVar3 = (ulonglong)uVar4;
    } while (uVar4 < *(uint *)(param_1 + 0x14));
    if ((int)uVar3 != 0) {
      return (ulonglong)*(uint *)(lVar5 + (ulonglong)((int)uVar3 - 1) * 8 + 4 + lVar1);
    }
  }
  return 0xffffffff;
}



undefined8 * FUN_180063938(undefined8 *param_1,longlong param_2)

{
  *param_1 = std::exception::vftable;
  param_1[1] = (char *)0x0;
  param_1[2] = 0;
  __std_exception_copy((char **)(param_2 + 8),(char **)(param_1 + 1));
  *param_1 = std::bad_exception::vftable;
  return param_1;
}



// Library Function - Single Match
// Name: ??0bad_exception@std@@QEAA@XZ
// Library: Visual Studio 2015 Release
// public: __cdecl std::bad_exception::bad_exception(void) __ptr64

void __thiscall std::bad_exception::bad_exception(bad_exception *this)

{
  *(undefined8 *)(this + 0x10) = 0;
  *(char **)(this + 8) = "bad exception";
  *(undefined ***)this = vftable;
  return;
}



undefined8 * FUN_1800639c8(undefined8 *param_1,ulonglong param_2)

{
  *param_1 = std::exception::vftable;
  __std_exception_destroy((void **)(param_1 + 1));
  if ((param_2 & 1) != 0) {
    FUN_18005f208();
  }
  return param_1;
}



// Library Function - Single Match
// Name:
?CatchIt@@YAXPEAUEHExceptionRecord@@PEA_KPEAU_CONTEXT@@PEAU_xDISPATCHER_CONTEXT@@PEBU_s_FuncInfo@@PEBU_s_HandlerType@@PEBU_s_CatchableType@@PEBU_s_TryBlockMapEntry@@H1EE@Z
// Library: Visual Studio 2015 Release
// void __cdecl CatchIt(struct EHExceptionRecord * __ptr64,unsigned __int64 * __ptr64,struct
// _CONTEXT * __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo const *
// __ptr64,struct _s_HandlerType const * __ptr64,struct _s_CatchableType const * __ptr64,struct
// _s_TryBlockMapEntry const * __ptr64,int,unsigned __int64 * __ptr64,unsigned char,unsigned char)

void CatchIt(EHExceptionRecord *param_1,__uint64 *param_2,_CONTEXT *param_3,
            _xDISPATCHER_CONTEXT *param_4,_s_FuncInfo *param_5,_s_HandlerType *param_6,
            _s_CatchableType *param_7,_s_TryBlockMapEntry *param_8,int param_9,__uint64 *param_10,
            uchar param_11,uchar param_12)

{
  _s_FuncInfo *p_Var1;
  _s_HandlerType *p_Var2;
  __uint64 *p_Var3;
  longlong lVar4;
  __uint64 local_res10;

  p_Var1 = param_5;
  p_Var3 = _GetEstablisherFrame(param_2,param_4,param_5,&local_res10);
  p_Var2 = param_6;
  if (param_7 != (_s_CatchableType *)0x0) {
    __BuildCatchObject((longlong)param_1,(longlong *)p_Var3,(uint *)param_6,(byte *)param_7);
  }
  lVar4 = _GetImageBase();
  _UnwindNestedFrames((PVOID *)param_2,(ULONG_PTR)param_1,(ULONG_PTR)param_3,(ULONG_PTR)p_Var3,
                      lVar4 + (int)p_Var2->dispOfHandler,param_8->tryLow,(ULONG_PTR)p_Var1,
                      (PVOID *)param_4,param_12);
  return;
}



// Library Function - Single Match
// Name: ?ExFilterRethrow@@YAHPEAU_EXCEPTION_POINTERS@@PEAUEHExceptionRecord@@PEAH@Z
// Library: Visual Studio 2015 Release
// int __cdecl ExFilterRethrow(struct _EXCEPTION_POINTERS * __ptr64,struct EHExceptionRecord *
// __ptr64,int * __ptr64)

int ExFilterRethrow(_EXCEPTION_POINTERS *param_1,EHExceptionRecord *param_2,int *param_3)

{
  PEXCEPTION_RECORD pEVar1;
  longlong lVar2;
  int iVar3;

  pEVar1 = param_1->ExceptionRecord;
  *param_3 = 0;
  if (pEVar1->ExceptionCode == 0xe06d7363) {
    if ((pEVar1->NumberParameters == 4) && (*(int *)pEVar1->ExceptionInformation + 0xe66cfae0U < 3))
    {
      iVar3 = *param_3;
      if (pEVar1->ExceptionInformation[1] == *(ULONG_PTR *)(param_2 + 0x28)) {
        iVar3 = 1;
      }
      *param_3 = iVar3;
    }
    if ((((pEVar1->ExceptionCode == 0xe06d7363) && (pEVar1->NumberParameters == 4)) &&
        (*(int *)pEVar1->ExceptionInformation + 0xe66cfae0U < 3)) &&
       (pEVar1->ExceptionInformation[2] == 0)) {
      lVar2 = __vcrt_getptd();
      *(undefined4 *)(lVar2 + 0x40) = 1;
      *param_3 = 1;
      return 1;
    }
  }
  return 0;
}



// Library Function - Single Match
// Name:
?FindHandler@@YAXPEAUEHExceptionRecord@@PEA_KPEAU_CONTEXT@@PEAU_xDISPATCHER_CONTEXT@@PEBU_s_FuncInfo@@EH1@Z
// Library: Visual Studio 2015 Release
// void __cdecl FindHandler(struct EHExceptionRecord * __ptr64,unsigned __int64 * __ptr64,struct
// _CONTEXT * __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo const *
// __ptr64,unsigned char,int,unsigned __int64 * __ptr64)

void FindHandler(EHExceptionRecord *param_1,__uint64 *param_2,_CONTEXT *param_3,
                _xDISPATCHER_CONTEXT *param_4,_s_FuncInfo *param_5,uchar param_6,int param_7,
                __uint64 *param_8)

{
  code *pcVar1;
  bool bVar2;
  uchar uVar3;
  int iVar4;
  int iVar5;
  longlong lVar6;
  ulonglong uVar7;
  _s_TryBlockMapEntry *p_Var8;
  undefined8 uVar9;
  _s_ESTypeList *p_Var10;
  __uint64 *p_Var11;
  _s_ESTypeList *p_Var12;
  ulonglong uVar13;
  ulonglong uVar14;
  _s_HandlerType *p_Var15;
  int *piVar16;
  uint uVar17;
  ulonglong uVar18;
  _CONTEXT *local_res18;
  uchar local_78;
  uint local_74;
  int local_70;
  int local_6c;
  uint local_68 [2];
  int *local_60;
  _s_CatchableType *local_58;
  __uint64 local_50;
  bad_exception local_48 [32];

  uVar14 = 0;
  local_78 = '\0';
  bVar2 = false;
  iVar4 = FUN_1800638c4((longlong)param_5,(ulonglong *)param_4);
  _GetEstablisherFrame(param_2,param_4,param_5,&local_50);
  iVar5 = __GetUnwindTryBlock(param_2,param_4,param_5);
  if (iVar5 < iVar4) {
    __SetState(&local_50,param_4,param_5,iVar4);
    __SetUnwindTryBlock(param_2,param_4,param_5,iVar4);
  }
  else {
    iVar4 = __GetUnwindTryBlock(param_2,param_4,param_5);
  }
  if ((iVar4 < -1) || (param_5->maxState <= iVar4)) {
    terminate();
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  if (*(int *)param_1 == -0x1f928c9d) {
    local_res18 = param_3;
    if (((*(int *)(param_1 + 0x18) == 4) && (*(int *)(param_1 + 0x20) + 0xe66cfae0U < 3)) &&
       (*(longlong *)(param_1 + 0x30) == 0)) {
      lVar6 = __vcrt_getptd();
      if (*(longlong *)(lVar6 + 0x20) == 0) {
        return;
      }
      lVar6 = __vcrt_getptd();
      param_1 = *(EHExceptionRecord **)(lVar6 + 0x20);
      lVar6 = __vcrt_getptd();
      local_78 = '\x01';
      local_res18 = *(_CONTEXT **)(lVar6 + 0x28);
      _SetThrowImageBase(*(undefined8 *)((longlong)param_1 + 0x38));
      if ((int *)param_1 == (int *)0x0) {
        terminate();
        pcVar1 = (code *)swi(3);
        (*pcVar1)();
        return;
      }
      if (((*(int *)param_1 == -0x1f928c9d) && (*(int *)((longlong)param_1 + 0x18) == 4)) &&
         ((*(int *)((longlong)param_1 + 0x20) + 0xe66cfae0U < 3 &&
          (*(longlong *)((longlong)param_1 + 0x30) == 0)))) {
        terminate();
        pcVar1 = (code *)swi(3);
        (*pcVar1)();
        return;
      }
      lVar6 = __vcrt_getptd();
      if (*(longlong *)(lVar6 + 0x38) != 0) {
        lVar6 = __vcrt_getptd();
        piVar16 = *(int **)(lVar6 + 0x38);
        lVar6 = __vcrt_getptd();
        *(undefined8 *)(lVar6 + 0x38) = 0;
        uVar3 = IsInExceptionSpec(param_1,(_s_ESTypeList *)piVar16);
        if (uVar3 == '\0') {
          uVar13 = uVar14;
          uVar18 = uVar14;
          if (0 < *piVar16) {
            do {
              lVar6 = _GetImageBase();
              uVar7 = uVar14;
              if (*(int *)((longlong)piVar16[1] + 4 + lVar6 + uVar13) != 0) {
                lVar6 = _GetImageBase();
                iVar4 = *(int *)((longlong)piVar16[1] + 4 + lVar6 + uVar13);
                lVar6 = _GetImageBase();
                uVar7 = lVar6 + iVar4;
              }
              uVar7 = __std_type_info_compare(uVar7 + 8,0x1800b10b0);
              if ((int)uVar7 == 0) {
                __DestructExceptionObject((int *)param_1);
                std::bad_exception::bad_exception(local_48);
                _CxxThrowException(local_48,(ThrowInfo *)&DAT_1800ad270);
                pcVar1 = (code *)swi(3);
                (*pcVar1)();
                return;
              }
              uVar17 = (int)uVar18 + 1;
              uVar13 = uVar13 + 0x14;
              uVar18 = (ulonglong)uVar17;
            } while ((int)uVar17 < *piVar16);
          }
          terminate();
          pcVar1 = (code *)swi(3);
          (*pcVar1)();
          return;
        }
      }
    }
    param_3 = local_res18;
    if (((*(int *)param_1 == -0x1f928c9d) && (*(int *)((longlong)param_1 + 0x18) == 4)) &&
       (*(int *)((longlong)param_1 + 0x20) + 0xe66cfae0U < 3)) {
      if ((param_5->nTryBlocks != 0) &&
         (p_Var8 = _GetRangeOfTrysToCheck(param_2,param_5,param_7,iVar4,&local_74,local_68,param_4),
         local_74 < local_68[0])) {
        piVar16 = &p_Var8->dispHandlerArray;
        uVar17 = local_68[0];
        do {
          if ((piVar16[-4] == iVar4 || piVar16[-4] < iVar4) && (iVar4 <= piVar16[-3])) {
            lVar6 = _GetImageBase();
            p_Var15 = (_s_HandlerType *)(*piVar16 + lVar6);
            local_6c = piVar16[-1];
            while (uVar17 = local_68[0], 0 < local_6c) {
              lVar6 = _GetThrowImageBase();
              local_60 = (int *)(lVar6 + 4 +
                                (longlong)*(int *)(*(longlong *)((longlong)param_1 + 0x30) + 0xc));
              lVar6 = _GetThrowImageBase();
              local_70 = *(int *)(lVar6 + *(int *)(*(longlong *)((longlong)param_1 + 0x30) + 0xc));
              while (0 < local_70) {
                lVar6 = _GetThrowImageBase();
                local_58 = (_s_CatchableType *)(lVar6 + *local_60);
                uVar9 = __TypeMatch((byte *)p_Var15,(byte *)local_58,
                                    *(byte **)((longlong)param_1 + 0x30));
                if ((int)uVar9 != 0) {
                  bVar2 = true;
                  CatchIt(param_1,param_2,local_res18,param_4,param_5,p_Var15,local_58,
                          (_s_TryBlockMapEntry *)(piVar16 + -4),param_7,param_8,local_78,param_6);
                  uVar17 = local_68[0];
                  goto LAB_180063e9b;
                }
                local_60 = local_60 + 1;
                local_70 = local_70 + -1;
              }
              local_6c = local_6c + -1;
              p_Var15 = p_Var15 + 1;
            }
          }
LAB_180063e9b:
          local_74 = local_74 + 1;
          piVar16 = piVar16 + 5;
        } while (local_74 < uVar17);
        if (bVar2) goto LAB_180063f6b;
      }
      p_Var12 = (_s_ESTypeList *)0x0;
      if (0x19930520 < (param_5->magicNumber_and_bbtFlags & 0x1fffffff)) {
        p_Var10 = p_Var12;
        if (param_5->dispESTypeList != 0) {
          lVar6 = _GetImageBase();
          p_Var10 = (_s_ESTypeList *)(lVar6 + (int)param_5->dispESTypeList);
        }
        if ((p_Var10 != (_s_ESTypeList *)0x0) ||
           (((*(byte *)&param_5->EHFlags & 4) != 0 &&
            (iVar4 = _ExecutionInCatch(param_4,param_5), iVar4 == 0)))) {
          if ((*(byte *)&param_5->EHFlags & 4) != 0) {
            terminate();
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          if (param_5->dispESTypeList != 0) {
            lVar6 = _GetImageBase();
            p_Var12 = (_s_ESTypeList *)(lVar6 + (int)param_5->dispESTypeList);
          }
          uVar3 = IsInExceptionSpec(param_1,p_Var12);
          if (uVar3 == '\0') {
            p_Var11 = _GetEstablisherFrame(param_2,param_4,param_5,(__uint64 *)&local_58);
            _UnwindNestedFrames((PVOID *)param_2,(ULONG_PTR)param_1,(ULONG_PTR)local_res18,
                                (ULONG_PTR)p_Var11,0,-1,(ULONG_PTR)param_5,(PVOID *)param_4,param_6)
            ;
          }
        }
      }
      goto LAB_180063f6b;
    }
  }
  if (param_5->nTryBlocks != 0) {
    if (param_6 != '\0') {
      terminate();
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
    FindHandlerForForeignException(param_1,param_2,param_3,param_4,param_5,iVar4,param_7,param_8);
  }
LAB_180063f6b:
  lVar6 = __vcrt_getptd();
  if (*(longlong *)(lVar6 + 0x38) == 0) {
    return;
  }
  terminate();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



// Library Function - Single Match
// Name:
?FindHandlerForForeignException@@YAXPEAUEHExceptionRecord@@PEA_KPEAU_CONTEXT@@PEAU_xDISPATCHER_CONTEXT@@PEBU_s_FuncInfo@@HH1@Z
// Library: Visual Studio 2015 Release
// void __cdecl FindHandlerForForeignException(struct EHExceptionRecord * __ptr64,unsigned __int64 *
// __ptr64,struct _CONTEXT * __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo const
// * __ptr64,int,int,unsigned __int64 * __ptr64)

void FindHandlerForForeignException
               (EHExceptionRecord *param_1,__uint64 *param_2,_CONTEXT *param_3,
               _xDISPATCHER_CONTEXT *param_4,_s_FuncInfo *param_5,int param_6,int param_7,
               __uint64 *param_8)

{
  int iVar1;
  code *pcVar2;
  _s_FuncInfo *p_Var3;
  int iVar4;
  int iVar5;
  longlong lVar6;
  PVOID pvVar7;
  undefined8 uVar8;
  _s_TryBlockMapEntry *p_Var9;
  int *piVar10;
  uint local_res8 [2];
  _CONTEXT *local_res18;
  uint local_48 [4];

  if (*(int *)param_1 != -0x7ffffffd) {
    local_res18 = param_3;
    lVar6 = __vcrt_getptd();
    iVar5 = param_7;
    p_Var3 = param_5;
    if (*(longlong *)(lVar6 + 0x10) != 0) {
      pvVar7 = EncodePointer((PVOID)0x0);
      lVar6 = __vcrt_getptd();
      if ((((*(PVOID *)(lVar6 + 0x10) != pvVar7) && (*(int *)param_1 != -0x1fbcb0b3)) &&
          (*(int *)param_1 != -0x1fbcbcae)) &&
         (uVar8 = _CallSETranslator((uint *)param_1,param_2,param_3), (int)uVar8 != 0)) {
        return;
      }
    }
    iVar4 = param_6;
    if (p_Var3->nTryBlocks == 0) {
      terminate();
      pcVar2 = (code *)swi(3);
      (*pcVar2)();
      return;
    }
    p_Var9 = _GetRangeOfTrysToCheck(param_2,p_Var3,iVar5,param_6,local_res8,local_48,param_4);
    if (local_res8[0] < local_48[0]) {
      piVar10 = &p_Var9->nCatches;
      do {
        if ((piVar10[-3] <= iVar4) && (iVar4 <= piVar10[-2])) {
          lVar6 = _GetImageBase();
          if (*(int *)((longlong)piVar10[1] + 4 + lVar6 + (longlong)(*piVar10 + -1) * 0x14) == 0) {
            lVar6 = 0;
          }
          else {
            lVar6 = _GetImageBase();
            iVar1 = *(int *)((longlong)piVar10[1] + 4 + lVar6 + (longlong)(*piVar10 + -1) * 0x14);
            lVar6 = _GetImageBase();
            lVar6 = lVar6 + iVar1;
          }
          if (lVar6 != 0) {
            lVar6 = _GetImageBase();
            if (*(int *)((longlong)piVar10[1] + 4 + lVar6 + (longlong)(*piVar10 + -1) * 0x14) == 0)
            {
              lVar6 = 0;
            }
            else {
              lVar6 = _GetImageBase();
              iVar1 = *(int *)((longlong)piVar10[1] + 4 + lVar6 + (longlong)(*piVar10 + -1) * 0x14);
              lVar6 = _GetImageBase();
              lVar6 = lVar6 + iVar1;
            }
            if (*(char *)(lVar6 + 0x10) != '\0') goto LAB_18006425d;
          }
          lVar6 = _GetImageBase();
          if ((*(byte *)((longlong)piVar10[1] + lVar6 + (longlong)(*piVar10 + -1) * 0x14) & 0x40) ==
              0) {
            lVar6 = _GetImageBase();
            CatchIt(param_1,param_2,local_res18,param_4,p_Var3,
                    (_s_HandlerType *)
                    ((longlong)piVar10[1] + lVar6 + (longlong)(*piVar10 + -1) * 0x14),
                    (_s_CatchableType *)0x0,(_s_TryBlockMapEntry *)(piVar10 + -3),iVar5,param_8,
                    '\x01','\0');
          }
        }
LAB_18006425d:
        local_res8[0] = local_res8[0] + 1;
        piVar10 = piVar10 + 5;
      } while (local_res8[0] < local_48[0]);
    }
  }
  return;
}



// Library Function - Single Match
// Name: ?IsInExceptionSpec@@YAEPEAUEHExceptionRecord@@PEBU_s_ESTypeList@@@Z
// Library: Visual Studio 2015 Release
// unsigned char __cdecl IsInExceptionSpec(struct EHExceptionRecord * __ptr64,struct _s_ESTypeList
// const * __ptr64)

uchar IsInExceptionSpec(EHExceptionRecord *param_1,_s_ESTypeList *param_2)

{
  int iVar1;
  code *pcVar2;
  uchar uVar3;
  longlong lVar4;
  longlong lVar5;
  undefined8 uVar6;
  int iVar7;
  int iVar8;
  int *piVar9;

  if (param_2 == (_s_ESTypeList *)0x0) {
    terminate();
    pcVar2 = (code *)swi(3);
    uVar3 = (*pcVar2)();
    return uVar3;
  }
  uVar3 = '\0';
  iVar8 = 0;
  if (0 < *(int *)param_2) {
    do {
      lVar4 = _GetThrowImageBase();
      piVar9 = (int *)((longlong)*(int *)(*(longlong *)(param_1 + 0x30) + 0xc) + 4 + lVar4);
      lVar4 = _GetThrowImageBase();
      iVar7 = *(int *)(lVar4 + *(int *)(*(longlong *)(param_1 + 0x30) + 0xc));
      if (0 < iVar7) {
        do {
          lVar4 = _GetThrowImageBase();
          iVar1 = *piVar9;
          lVar5 = _GetImageBase();
          uVar6 = __TypeMatch((byte *)((longlong)*(int *)(param_2 + 4) +
                                      lVar5 + (longlong)iVar8 * 0x14),(byte *)(lVar4 + iVar1),
                              *(byte **)(param_1 + 0x30));
          if ((int)uVar6 != 0) {
            uVar3 = '\x01';
            break;
          }
          iVar7 = iVar7 + -1;
          piVar9 = piVar9 + 1;
        } while (0 < iVar7);
      }
      iVar8 = iVar8 + 1;
    } while (iVar8 < *(int *)param_2);
  }
  return uVar3;
}



undefined8 FUN_180064368(int *param_1)

{
  int iVar1;
  longlong lVar2;
  ulonglong uVar3;
  int iVar4;
  longlong lVar5;

  iVar4 = 0;
  if (0 < *param_1) {
    lVar5 = 0;
    do {
      lVar2 = _GetImageBase();
      if (*(int *)((longlong)param_1[1] + 4 + lVar2 + lVar5) == 0) {
        lVar2 = 0;
      }
      else {
        lVar2 = _GetImageBase();
        iVar1 = *(int *)((longlong)param_1[1] + 4 + lVar2 + lVar5);
        lVar2 = _GetImageBase();
        lVar2 = lVar2 + iVar1;
      }
      uVar3 = __std_type_info_compare(lVar2 + 8,0x1800b10b0);
      if ((int)uVar3 == 0) {
        return 1;
      }
      iVar4 = iVar4 + 1;
      lVar5 = lVar5 + 0x14;
    } while (iVar4 < *param_1);
  }
  return 0;
}



void FUN_1800643f0(undefined8 param_1,undefined *param_2,undefined8 param_3)

{
                    // WARNING: Could not recover jumptable at 0x0001800643f6. Too many branches
                    // WARNING: Treating indirect jump as call
  (*(code *)param_2)(param_1,param_3);
  return;
}



// Library Function - Single Match
// Name: ?_CallMemberFunction2@@YAXPEAXP6AX0@Z0H@Z
// Library: Visual Studio 2015 Release
// void __cdecl _CallMemberFunction2(void * __ptr64,void (__cdecl*)(void * __ptr64),void *
// __ptr64,int)

void _CallMemberFunction2(void *param_1,FuncDef6 *param_2,void *param_3,int param_4)

{
                    // WARNING: Could not recover jumptable at 0x000180064408. Too many branches
                    // WARNING: Treating indirect jump as call
  (*param_2)(param_1);
  return;
}



// Library Function - Single Match
// Name: __BuildCatchObject
// Library: Visual Studio 2015 Release

void __BuildCatchObject(longlong param_1,longlong *param_2,uint *param_3,byte *param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  void *pvVar3;
  FuncDef6 *pFVar4;
  longlong *plVar5;

  pFVar4 = (FuncDef6 *)0x0;
  plVar5 = param_2;
  if (-1 < (int)*param_3) {
    plVar5 = (longlong *)((longlong)(int)param_3[2] + *param_2);
  }
  uVar1 = __BuildCatchObjectHelper(param_1,param_2,param_3,param_4);
  if ((int)uVar1 == 1) {
    if (*(int *)(param_4 + 0x18) != 0) {
      lVar2 = _GetThrowImageBase();
      pFVar4 = (FuncDef6 *)(lVar2 + *(int *)(param_4 + 0x18));
    }
    lVar2 = __AdjustPointer(*(longlong *)(param_1 + 0x28),(int *)(param_4 + 8));
    FUN_1800643f0(plVar5,pFVar4,lVar2);
  }
  else {
    if ((int)uVar1 == 2) {
      if (*(int *)(param_4 + 0x18) != 0) {
        lVar2 = _GetThrowImageBase();
        pFVar4 = (FuncDef6 *)(lVar2 + *(int *)(param_4 + 0x18));
      }
      pvVar3 = (void *)__AdjustPointer(*(longlong *)(param_1 + 0x28),(int *)(param_4 + 8));
      _CallMemberFunction2(plVar5,pFVar4,pvVar3,1);
    }
  }
  return;
}



// Library Function - Single Match
// Name: __BuildCatchObjectHelper
// Library: Visual Studio 2015 Release

ulonglong __BuildCatchObjectHelper(longlong param_1,longlong *param_2,uint *param_3,byte *param_4)

{
  uint uVar1;
  int iVar2;
  code *pcVar3;
  longlong lVar4;
  undefined8 *puVar5;
  longlong lVar6;
  code *pcVar7;

  lVar6 = 0;
  uVar1 = param_3[1];
  lVar4 = lVar6;
  if (uVar1 != 0) {
    lVar4 = _GetImageBase();
    lVar4 = (int)uVar1 + lVar4;
  }
  if (lVar4 != 0) {
    lVar4 = lVar6;
    if (uVar1 != 0) {
      lVar4 = _GetImageBase();
      lVar4 = lVar4 + (int)param_3[1];
    }
    pcVar3 = DAT_1800b1ed0;
    if (*(char *)(lVar4 + 0x10) == '\0') {
      return 0;
    }
    if ((param_3[2] == 0) && (-1 < (int)*param_3)) {
      return 0;
    }
    uVar1 = *param_3;
    pcVar7 = (code *)(ulonglong)uVar1;
    if (-1 < (int)uVar1) {
      param_2 = (longlong *)((longlong)(int)param_3[2] + *param_2);
    }
    if ((((char)uVar1 < '\0') && ((*param_4 & 0x10) != 0)) && (DAT_1800b1ed0 != (code *)0x0)) {
      pcVar7 = DAT_1800b1ed0;
      _guard_check_icall();
      lVar4 = (*pcVar3)();
      if ((lVar4 != 0) && (param_2 != (longlong *)0x0)) {
        *param_2 = lVar4;
        goto LAB_180064611;
      }
      terminate();
    }
    if (((ulonglong)pcVar7 & 8) != 0) {
      lVar4 = *(longlong *)(param_1 + 0x28);
      if ((lVar4 != 0) && (param_2 != (longlong *)0x0)) {
        *param_2 = lVar4;
        goto LAB_180064611;
      }
      terminate();
    }
    if ((*param_4 & 1) != 0) {
      if ((*(undefined8 **)(param_1 + 0x28) != (undefined8 *)0x0) && (param_2 != (longlong *)0x0)) {
        memcpy_FUN_180061f90
                  (param_2,*(undefined8 **)(param_1 + 0x28),(longlong)*(int *)(param_4 + 0x14));
        if (*(int *)(param_4 + 0x14) != 8) {
          return 0;
        }
        if (*param_2 == 0) {
          return 0;
        }
        lVar4 = *param_2;
LAB_180064611:
        lVar4 = __AdjustPointer(lVar4,(int *)(param_4 + 8));
        *param_2 = lVar4;
        return 0;
      }
      terminate();
    }
    iVar2 = *(int *)(param_4 + 0x18);
    lVar4 = lVar6;
    if (iVar2 != 0) {
      lVar4 = _GetThrowImageBase();
      lVar4 = iVar2 + lVar4;
    }
    if (lVar4 == 0) {
      if ((*(longlong *)(param_1 + 0x28) != 0) && (param_2 != (longlong *)0x0)) {
        iVar2 = *(int *)(param_4 + 0x14);
        puVar5 = (undefined8 *)__AdjustPointer(*(longlong *)(param_1 + 0x28),(int *)(param_4 + 8));
        memcpy_FUN_180061f90(param_2,puVar5,(longlong)iVar2);
        return 0;
      }
      terminate();
    }
    if ((*(longlong *)(param_1 + 0x28) != 0) && (param_2 != (longlong *)0x0)) {
      if (iVar2 != 0) {
        lVar6 = _GetThrowImageBase();
        lVar6 = lVar6 + *(int *)(param_4 + 0x18);
      }
      if (lVar6 != 0) {
        return (ulonglong)(((*param_4 & 4) != 0) + 1);
      }
    }
    terminate();
    terminate();
  }
  return 0;
}



// Library Function - Single Match
// Name: __FrameUnwindToState
// Library: Visual Studio 2015 Release

void __FrameUnwindToState
               (__uint64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3,int param_4)

{
  int iVar1;
  code *pcVar2;
  int iVar3;
  undefined8 uVar4;
  longlong lVar5;
  longlong lVar6;

  uVar4 = _GetImageBase();
  iVar3 = __GetCurrentState(param_1,param_2,param_3);
  lVar5 = __vcrt_getptd();
  *(int *)(lVar5 + 0x30) = *(int *)(lVar5 + 0x30) + 1;
  while( true ) {
    if ((iVar3 == -1) || (iVar3 <= param_4)) goto LAB_180064a17;
    if ((iVar3 < 0) || (param_3->maxState <= iVar3)) break;
    lVar6 = (longlong)iVar3;
    lVar5 = _GetImageBase();
    iVar3 = *(int *)((longlong)(int)param_3->dispUnwindMap + lVar5 + lVar6 * 8);
    lVar5 = _GetImageBase();
    if (*(int *)((longlong)(int)param_3->dispUnwindMap + 4 + lVar5 + lVar6 * 8) == 0) {
      lVar5 = 0;
    }
    else {
      lVar5 = _GetImageBase();
      iVar1 = *(int *)((longlong)(int)param_3->dispUnwindMap + 4 + lVar5 + lVar6 * 8);
      lVar5 = _GetImageBase();
      lVar5 = lVar5 + iVar1;
    }
    if (lVar5 != 0) {
      __SetState(param_1,param_2,param_3,iVar3);
      lVar5 = _GetImageBase();
      if (*(int *)((longlong)(int)param_3->dispUnwindMap + 4 + lVar5 + lVar6 * 8) != 0) {
        _GetImageBase();
        _GetImageBase();
      }
      _CallSettingFrame();
      _SetImageBase(uVar4);
    }
  }
  terminate();
LAB_180064a17:
  lVar5 = __vcrt_getptd();
  if (0 < *(int *)(lVar5 + 0x30)) {
    lVar5 = __vcrt_getptd();
    *(int *)(lVar5 + 0x30) = *(int *)(lVar5 + 0x30) + -1;
  }
  if ((iVar3 != -1) && (param_4 < iVar3)) {
    terminate();
    pcVar2 = (code *)swi(3);
    (*pcVar2)();
    return;
  }
  __SetState(param_1,param_2,param_3,iVar3);
  return;
}



undefined8
FUN_180064a5c(int *param_1,__uint64 *param_2,_CONTEXT *param_3,_xDISPATCHER_CONTEXT *param_4,
             _s_FuncInfo *param_5,int param_6,__uint64 *param_7,byte param_8)

{
  int iVar1;
  longlong lVar2;
  ulonglong uVar3;
  code *pcVar4;
  undefined8 uVar5;
  code *pcVar6;
  undefined8 in_stack_ffffffffffffffd0;
  undefined4 uVar7;

  uVar7 = (undefined4)((ulonglong)in_stack_ffffffffffffffd0 >> 0x20);
  FUN_180064eb4();
  lVar2 = __vcrt_getptd();
  pcVar6 = (code *)0x0;
  if ((*(int *)(lVar2 + 0x40) == 0) && (*param_1 != -0x1f928c9d)) {
    if (*param_1 == -0x7fffffd7) {
      if (param_1[6] == 0xf) {
        if (*(longlong *)(param_1 + 0x18) == 0x19930520) goto LAB_180064af0;
        goto LAB_180064ad9;
      }
    }
    else {
LAB_180064ad9:
      if (*param_1 == -0x7fffffda) goto LAB_180064af0;
    }
    if ((0x19930521 < (param_5->magicNumber_and_bbtFlags & 0x1fffffff)) &&
       ((*(byte *)&param_5->EHFlags & 1) != 0)) {
      return 1;
    }
  }
LAB_180064af0:
  if ((*(byte *)(param_1 + 1) & 0x66) != 0) {
    if (param_5->maxState == 0) {
      return 1;
    }
    if (param_6 != 0) {
      return 1;
    }
    if ((*(byte *)(param_1 + 1) & 0x20) != 0) {
      if (*param_1 == -0x7fffffda) {
        uVar3 = FUN_1800638cc((longlong)param_5,(longlong)param_4,param_3->Rip);
        iVar1 = (int)uVar3;
        if ((iVar1 < -1) || (param_5->maxState <= iVar1)) {
          terminate();
          pcVar6 = (code *)swi(3);
          uVar5 = (*pcVar6)();
          return uVar5;
        }
      }
      else {
        if (*param_1 != -0x7fffffd7) goto LAB_180064b78;
        iVar1 = param_1[0xe];
        if ((iVar1 < -1) || (param_5->maxState <= iVar1)) {
          terminate();
          pcVar6 = (code *)swi(3);
          uVar5 = (*pcVar6)();
          return uVar5;
        }
        param_2 = *(__uint64 **)(param_1 + 10);
      }
      __FrameUnwindToState(param_2,param_4,param_5,iVar1);
      return 1;
    }
LAB_180064b78:
    __FrameUnwindToEmptyState(param_2,param_4,param_5);
    return 1;
  }
  if (param_5->nTryBlocks == 0) {
    if (0x19930520 < (param_5->magicNumber_and_bbtFlags & 0x1fffffff)) {
      pcVar4 = pcVar6;
      if (param_5->dispESTypeList != 0) {
        lVar2 = _GetImageBase();
        pcVar4 = (code *)(lVar2 + (int)param_5->dispESTypeList);
      }
      if (pcVar4 != (code *)0x0) goto LAB_180064bd1;
    }
    if ((param_5->magicNumber_and_bbtFlags & 0x1fffffff) < 0x19930522) {
      return 1;
    }
    if ((*(byte *)&param_5->EHFlags & 4) == 0) {
      return 1;
    }
  }
LAB_180064bd1:
  if (((*param_1 == -0x1f928c9d) && (2 < (uint)param_1[6])) && (0x19930522 < (uint)param_1[8])) {
    if (*(int *)(*(longlong *)(param_1 + 0xc) + 8) != 0) {
      lVar2 = _GetThrowImageBase();
      pcVar6 = (code *)(*(int *)(*(longlong *)(param_1 + 0xc) + 8) + lVar2);
    }
    if (pcVar6 != (code *)0x0) {
      _guard_check_icall();
      uVar5 = (*pcVar6)(param_1,param_2,param_3,param_4,param_5,param_6,param_7,
                        CONCAT44(uVar7,(uint)param_8));
      return uVar5;
    }
  }
  FindHandler((EHExceptionRecord *)param_1,param_2,param_3,param_4,param_5,param_8,param_6,param_7);
  return 1;
}



// Library Function - Single Match
// Name: __TypeMatch
// Library: Visual Studio 2015 Release

undefined8 __TypeMatch(byte *param_1,byte *param_2,byte *param_3)

{
  char cVar1;
  char cVar2;
  longlong lVar3;
  longlong lVar4;
  longlong lVar5;
  char *pcVar6;
  int iVar7;

  iVar7 = *(int *)(param_1 + 4);
  lVar5 = 0;
  lVar3 = lVar5;
  if (iVar7 != 0) {
    lVar3 = _GetImageBase();
    lVar3 = iVar7 + lVar3;
  }
  if (lVar3 != 0) {
    lVar3 = lVar5;
    if (iVar7 != 0) {
      iVar7 = *(int *)(param_1 + 4);
      lVar3 = _GetImageBase();
      lVar3 = iVar7 + lVar3;
    }
    if ((*(char *)(lVar3 + 0x10) != '\0') && (((*param_1 & 0x80) == 0 || ((*param_2 & 0x10) == 0))))
    {
      lVar3 = lVar5;
      if (iVar7 != 0) {
        lVar3 = _GetImageBase();
        lVar3 = lVar3 + *(int *)(param_1 + 4);
      }
      lVar4 = _GetThrowImageBase();
      if (lVar3 != lVar4 + *(int *)(param_2 + 4)) {
        if (*(int *)(param_1 + 4) != 0) {
          lVar5 = _GetImageBase();
          lVar5 = lVar5 + *(int *)(param_1 + 4);
        }
        lVar3 = _GetThrowImageBase();
        pcVar6 = (char *)(lVar5 + 0x10);
        lVar3 = ((longlong)*(int *)(param_2 + 4) + 0x10 + lVar3) - (longlong)pcVar6;
        do {
          cVar1 = *pcVar6;
          cVar2 = pcVar6[lVar3];
          if (cVar1 != cVar2) break;
          pcVar6 = pcVar6 + 1;
        } while (cVar2 != '\0');
        if (cVar1 != cVar2) {
          return 0;
        }
      }
      if (((*param_2 & 2) != 0) && ((*param_1 & 8) == 0)) {
        return 0;
      }
      if (((*param_3 & 1) != 0) && ((*param_1 & 1) == 0)) {
        return 0;
      }
      if (((*param_3 & 4) != 0) && ((*param_1 & 4) == 0)) {
        return 0;
      }
      if (((*param_3 & 2) != 0) && ((*param_1 & 2) == 0)) {
        return 0;
      }
      return 1;
    }
  }
  return 1;
}



// Library Function - Single Match
// Name: __vcrt_initialize_pure_virtual_call_handler
// Library: Visual Studio 2015 Release

void __vcrt_initialize_pure_virtual_call_handler(void)

{
  byte bVar1;

  bVar1 = 0x40 - ((byte)DAT_1800b04e8 & 0x3f) & 0x3f;
  DAT_1800b1f58 = ((ulonglong)(0 >> bVar1) | 0 << 0x40 - bVar1) ^ DAT_1800b04e8;
  return;
}



void FUN_180064e80(void)

{
  return;
}



void FUN_180064eb0(void)

{
  return;
}



// WARNING: Removing unreachable block (ram,0x000180064ec7)
// WARNING: Removing unreachable block (ram,0x000180064edd)
// WARNING: Removing unreachable block (ram,0x000180064ee3)

void FUN_180064eb4(void)

{
  return;
}



// Library Function - Single Match
// Name: __vcrt_initialize_locks
// Library: Visual Studio 2015 Release

uint __vcrt_initialize_locks(void)

{
  int iVar1;
  uint uVar2;
  ulonglong uVar3;

  uVar3 = 0;
  do {
    iVar1 = __vcrt_InitializeCriticalSectionEx
                      ((LPCRITICAL_SECTION)(&DAT_1800b1f60 + uVar3 * 0x28),4000,0);
    if (iVar1 == 0) {
      uVar2 = __vcrt_uninitialize_locks();
      return uVar2 & 0xffffff00;
    }
    DAT_1800b1f88 = DAT_1800b1f88 + 1;
    uVar2 = (int)uVar3 + 1;
    uVar3 = (ulonglong)uVar2;
  } while (uVar2 == 0);
  return CONCAT31((int3)((uint)iVar1 >> 8),1);
}



void FUN_180064f74(int param_1)

{
                    // WARNING: Could not recover jumptable at 0x000180064f86. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection((LPCRITICAL_SECTION)(&DAT_1800b1f60 + (longlong)param_1 * 0x28));
  return;
}



// Library Function - Single Match
// Name: __vcrt_uninitialize_locks
// Library: Visual Studio 2015 Release

undefined8 __vcrt_uninitialize_locks(void)

{
  ulonglong uVar1;

  uVar1 = (ulonglong)DAT_1800b1f88;
  while ((int)uVar1 != 0) {
    uVar1 = (ulonglong)((int)uVar1 - 1);
    DeleteCriticalSection((LPCRITICAL_SECTION)(&DAT_1800b1f60 + uVar1 * 0x28));
    DAT_1800b1f88 = DAT_1800b1f88 - 1;
  }
  return 1;
}



void FUN_180064fc8(int param_1)

{
                    // WARNING: Could not recover jumptable at 0x000180064fda. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(&DAT_1800b1f60 + (longlong)param_1 * 0x28));
  return;
}



FARPROC FUN_180065218(uint param_1,LPCSTR param_2,uint *param_3,uint *param_4)

{
  wchar_t *lpLibFileName;
  HMODULE pHVar1;
  byte bVar2;
  DWORD DVar3;
  int iVar4;
  HMODULE hLibModule;
  FARPROC pFVar5;
  ulonglong uVar6;
  ulonglong uVar7;

  uVar7 = (ulonglong)param_1;
  bVar2 = (byte)DAT_1800b04e8 & 0x3f;
  pFVar5 = (FARPROC)((DAT_1800b04e8 ^ *(ulonglong *)((longlong)&DAT_1800b1fa8 + uVar7 * 8)) >> bVar2
                    | (DAT_1800b04e8 ^ *(ulonglong *)((longlong)&DAT_1800b1fa8 + uVar7 * 8)) <<
                      0x40 - bVar2);
  if (pFVar5 != (FARPROC)0xffffffffffffffff) {
    if (pFVar5 != (FARPROC)0x0) {
      return pFVar5;
    }
    if (param_3 != param_4) {
      do {
        uVar6 = (ulonglong)*param_3;
        hLibModule = *(HMODULE *)((longlong)&DAT_1800b1f90 + uVar6 * 8);
        if (hLibModule == (HMODULE)0x0) {
          lpLibFileName = (wchar_t *)(&PTR_u_api_ms_win_core_fibers_l1_1_1_18007ac28)[uVar6];
          hLibModule = LoadLibraryExW(lpLibFileName,(HANDLE)0x0,0x800);
          if (hLibModule == (HMODULE)0x0) {
            DVar3 = GetLastError();
            if (((DVar3 == 0x57) && (iVar4 = wcsncmp(lpLibFileName,L"api-ms-",7), iVar4 != 0)) &&
               (iVar4 = wcsncmp(lpLibFileName,L"ext-ms-",7), iVar4 != 0)) {
              hLibModule = LoadLibraryExW(lpLibFileName,(HANDLE)0x0,0);
            }
            else {
              hLibModule = (HMODULE)0x0;
            }
          }
          if (hLibModule != (HMODULE)0x0) {
            pHVar1 = *(HMODULE *)((longlong)&DAT_1800b1f90 + uVar6 * 8);
            *(HMODULE *)((longlong)&DAT_1800b1f90 + uVar6 * 8) = hLibModule;
            if (pHVar1 != (HMODULE)0x0) {
              FreeLibrary(hLibModule);
            }
            goto LAB_18006534a;
          }
          *(undefined8 *)((longlong)&DAT_1800b1f90 + uVar6 * 8) = 0xffffffffffffffff;
        }
        else {
          if (hLibModule != (HMODULE)0xffffffffffffffff) {
LAB_18006534a:
            if (hLibModule != (HMODULE)0x0) goto LAB_180065365;
          }
        }
        param_3 = param_3 + 1;
      } while (param_3 != param_4);
    }
    hLibModule = (HMODULE)0x0;
LAB_180065365:
    if ((hLibModule != (HMODULE)0x0) &&
       (pFVar5 = GetProcAddress(hLibModule,param_2), pFVar5 != (FARPROC)0x0)) {
      bVar2 = 0x40 - ((byte)DAT_1800b04e8 & 0x3f) & 0x3f;
      *(ulonglong *)((longlong)&DAT_1800b1fa8 + uVar7 * 8) =
           ((ulonglong)pFVar5 >> bVar2 | (longlong)pFVar5 << 0x40 - bVar2) ^ DAT_1800b04e8;
      return pFVar5;
    }
    bVar2 = 0x40 - ((byte)DAT_1800b04e8 & 0x3f) & 0x3f;
    *(ulonglong *)((longlong)&DAT_1800b1fa8 + uVar7 * 8) =
         (0xffffffffffffffffU >> bVar2 | -1 << 0x40 - bVar2) ^ DAT_1800b04e8;
  }
  return (FARPROC)0x0;
}



HMODULE FUN_180065628(wchar_t *param_1)

{
  DWORD DVar1;
  int iVar2;
  HMODULE pHVar3;

  pHVar3 = LoadLibraryExW(param_1,(HANDLE)0x0,0x800);
  if (pHVar3 == (HMODULE)0x0) {
    DVar1 = GetLastError();
    if (DVar1 == 0x57) {
      iVar2 = wcsncmp(param_1,L"api-ms-",7);
      if (iVar2 != 0) {
        iVar2 = wcsncmp(param_1,L"ext-ms-",7);
        if (iVar2 != 0) {
                    // WARNING: Could not recover jumptable at 0x00018006568c. Too many branches
                    // WARNING: Treating indirect jump as call
          pHVar3 = LoadLibraryExW(param_1,(HANDLE)0x0,0);
          return pHVar3;
        }
      }
    }
    pHVar3 = (HMODULE)0x0;
  }
  return pHVar3;
}



void FUN_18006569c(undefined8 param_1)

{
  FARPROC pFVar1;

  pFVar1 = FUN_180065218(0,"FlsAlloc",(uint *)&DAT_18007acf8,(uint *)"FlsAlloc");
  if (pFVar1 == (FARPROC)0x0) {
    TlsAlloc();
  }
  else {
    _guard_check_icall();
    (*pFVar1)(param_1);
  }
  return;
}



// Library Function - Single Match
// Name: __vcrt_FlsFree
// Library: Visual Studio 2015 Release

void __vcrt_FlsFree(uint param_1)

{
  FARPROC pFVar1;

  pFVar1 = FUN_180065218(1,"FlsFree",(uint *)&DAT_18007ad10,(uint *)"FlsFree");
  if (pFVar1 == (FARPROC)0x0) {
    TlsFree(param_1);
  }
  else {
    _guard_check_icall();
    (*pFVar1)((ulonglong)param_1);
  }
  return;
}



// Library Function - Single Match
// Name: __vcrt_FlsGetValue
// Library: Visual Studio 2015 Release

void __vcrt_FlsGetValue(uint param_1)

{
  FARPROC pFVar1;

  pFVar1 = FUN_180065218(2,"FlsGetValue",(uint *)&DAT_18007ad20,(uint *)"FlsGetValue");
  if (pFVar1 == (FARPROC)0x0) {
    TlsGetValue(param_1);
  }
  else {
    _guard_check_icall();
    (*pFVar1)((ulonglong)param_1);
  }
  return;
}



// Library Function - Single Match
// Name: __vcrt_FlsSetValue
// Library: Visual Studio 2015 Release

void __vcrt_FlsSetValue(uint param_1,LPVOID param_2)

{
  FARPROC pFVar1;

  pFVar1 = FUN_180065218(3,"FlsSetValue",(uint *)&DAT_18007ad38,(uint *)"FlsSetValue");
  if (pFVar1 == (FARPROC)0x0) {
    TlsSetValue(param_1,param_2);
  }
  else {
    _guard_check_icall();
    (*pFVar1)((ulonglong)param_1,param_2);
  }
  return;
}



// Library Function - Single Match
// Name: __vcrt_InitializeCriticalSectionEx
// Library: Visual Studio 2015 Release

void __vcrt_InitializeCriticalSectionEx(LPCRITICAL_SECTION param_1,uint param_2,uint param_3)

{
  FARPROC pFVar1;

  pFVar1 = FUN_180065218(4,"InitializeCriticalSectionEx",(uint *)&DAT_18007ad50,
                         (uint *)"InitializeCriticalSectionEx");
  if (pFVar1 == (FARPROC)0x0) {
    InitializeCriticalSectionAndSpinCount(param_1,param_2);
  }
  else {
    _guard_check_icall();
    (*pFVar1)(param_1,(ulonglong)param_2,param_3);
  }
  return;
}



void FUN_180065878(void)

{
  byte bVar1;
  ulonglong uVar2;
  longlong lVar3;
  ulonglong *puVar4;

  bVar1 = 0x40 - ((byte)DAT_1800b04e8 & 0x3f) & 0x3f;
  uVar2 = ((ulonglong)(0 >> bVar1) | 0 << 0x40 - bVar1) ^ DAT_1800b04e8;
  lVar3 = 5;
  puVar4 = &DAT_1800b1fa8;
  while (lVar3 != 0) {
    lVar3 = lVar3 + -1;
    *puVar4 = uVar2;
    puVar4 = puVar4 + 1;
  }
  return;
}



// Library Function - Single Match
// Name: __vcrt_uninitialize_winapi_thunks
// Library: Visual Studio 2015 Release

void __vcrt_uninitialize_winapi_thunks(char param_1)

{
  HMODULE hLibModule;
  HMODULE *ppHVar1;

  if (param_1 == '\0') {
    ppHVar1 = (HMODULE *)&DAT_1800b1f90;
    do {
      hLibModule = *ppHVar1;
      if (hLibModule != (HMODULE)0x0) {
        if (hLibModule != (HMODULE)0xffffffffffffffff) {
          FreeLibrary(hLibModule);
        }
        *ppHVar1 = (HMODULE)0x0;
      }
      ppHVar1 = ppHVar1 + 1;
    } while (ppHVar1 != (HMODULE *)&DAT_1800b1fa8);
  }
  return;
}



longlong * FUN_180065904(longlong *param_1,byte **param_2,byte param_3)

{
  byte *pbVar1;
  byte bVar2;
  byte *pbVar3;
  int iVar4;

  *param_1 = 0;
  *(undefined4 *)(param_1 + 1) = 0;
  pbVar3 = *param_2;
  if (pbVar3 == (byte *)0x0) {
    *(undefined *)(param_1 + 1) = 2;
  }
  else {
    if (*pbVar3 == 0) {
      *(undefined *)(param_1 + 1) = 1;
    }
    else {
      iVar4 = 0;
      do {
        bVar2 = **param_2;
        if (bVar2 == param_3) break;
        if ((((0x3b < (byte)(bVar2 - 0x24)) ||
             ((0x87fffffe53ff201U >> ((ulonglong)(bVar2 - 0x24) & 0x3f) & 1) == 0)) &&
            (0x19 < (byte)(bVar2 + 0x9f))) &&
           ((0x7e < (byte)(bVar2 + 0x80) && ((DAT_1800b2004 & 0x10000) == 0)))) {
          *(undefined *)(param_1 + 1) = 2;
          return param_1;
        }
        pbVar1 = *param_2 + 1;
        iVar4 = iVar4 + 1;
        *param_2 = pbVar1;
      } while (*pbVar1 != 0);
      FUN_18006748c(param_1,(char *)pbVar3,iVar4);
      bVar2 = **param_2;
      if (bVar2 == 0) {
        if (*(char *)(param_1 + 1) == '\0') {
          *(undefined *)(param_1 + 1) = 1;
        }
      }
      else {
        *param_2 = *param_2 + 1;
        if (bVar2 != param_3) {
          *param_1 = 0;
          *(undefined *)(param_1 + 1) = 3;
        }
      }
    }
  }
  return param_1;
}



undefined8 * FUN_180065a24(undefined8 *param_1,undefined8 *param_2)

{
  undefined **ppuVar1;
  undefined **ppuVar2;

  ppuVar2 = (undefined **)0x0;
  *(undefined4 *)(param_1 + 1) = 0;
  if (param_2 == (undefined8 *)0x0) {
    *(undefined *)(param_1 + 1) = 0;
    *param_1 = 0;
  }
  else {
    ppuVar1 = (undefined **)_HeapManager::getMemory((_HeapManager *)&DAT_1800b2018,0x10,0);
    if (ppuVar1 != (undefined **)0x0) {
      *ppuVar1 = (undefined *)pDNameNode::vftable;
      if ((byte)(*(char *)(param_2 + 1) - 2U) < 2) {
        param_2 = ppuVar2;
      }
      ppuVar1[1] = (undefined *)param_2;
      ppuVar2 = ppuVar1;
    }
    *param_1 = ppuVar2;
    *(byte *)(param_1 + 1) = ~-(ppuVar2 != (undefined **)0x0) & 3;
  }
  return param_1;
}



longlong * FUN_180065aa8(longlong *param_1,char *param_2)

{
  char *pcVar1;
  int iVar2;

  iVar2 = 0;
  *param_1 = 0;
  *(undefined4 *)(param_1 + 1) = 0;
  if ((param_2 != (char *)0x0) && (pcVar1 = param_2, *param_2 != '\0')) {
    do {
      pcVar1 = pcVar1 + 1;
      iVar2 = iVar2 + 1;
    } while (*pcVar1 != '\0');
    if (iVar2 != 0) {
      FUN_18006748c(param_1,param_2,iVar2);
    }
  }
  return param_1;
}



DNameStatusNode ** FUN_180065ae8(DNameStatusNode **param_1,int param_2)

{
  DNameStatusNode *pDVar1;
  undefined uVar2;

  *(undefined4 *)(param_1 + 1) = 0;
  *param_1 = (DNameStatusNode *)0x0;
  uVar2 = (undefined)param_2;
  if (1 < param_2 - 2U) {
    uVar2 = 0;
  }
  *(undefined *)(param_1 + 1) = uVar2;
  if (param_2 == 1) {
    pDVar1 = DNameStatusNode::make(1);
    *param_1 = pDVar1;
    if (pDVar1 == (DNameStatusNode *)0x0) {
      *(undefined *)(param_1 + 1) = 3;
    }
  }
  return param_1;
}



void FUN_180065b40(longlong *param_1,ulonglong param_2)

{
  bool bVar1;
  ulonglong uVar2;
  char *pcVar3;
  undefined auStack72 [51];
  char local_15 [5];
  ulonglong local_10;
  char *pcVar4;

  local_10 = DAT_1800b04e8 ^ (ulonglong)auStack72;
  *param_1 = 0;
  *(undefined4 *)(param_1 + 1) = 0;
  bVar1 = false;
  local_15[2] = 0;
  pcVar3 = local_15 + 2;
  if ((longlong)param_2 < 0) {
    bVar1 = true;
    param_2 = -param_2;
  }
  do {
    pcVar4 = pcVar3;
    pcVar3 = pcVar4 + -1;
    uVar2 = param_2 / 10;
    *pcVar3 = (char)param_2 + (char)uVar2 * -10 + '0';
    param_2 = uVar2;
  } while (uVar2 != 0);
  if (bVar1) {
    pcVar3 = pcVar4 + -2;
    *pcVar3 = '-';
  }
  FUN_18006748c(param_1,pcVar3,((int)register0x00000020 + -0x13) - (int)pcVar3);
  FUN_18005f100(local_10 ^ (ulonglong)auStack72);
  return;
}



void FUN_180065be4(longlong *param_1,ulonglong param_2)

{
  ulonglong uVar1;
  char *pcVar2;
  undefined auStack72 [51];
  char local_15 [5];
  ulonglong local_10;

  local_10 = DAT_1800b04e8 ^ (ulonglong)auStack72;
  pcVar2 = local_15 + 1;
  *param_1 = 0;
  *(undefined4 *)(param_1 + 1) = 0;
  local_15[1] = 0;
  do {
    pcVar2 = pcVar2 + -1;
    uVar1 = param_2 / 10;
    *pcVar2 = (char)param_2 + (char)uVar1 * -10 + '0';
    param_2 = uVar1;
  } while (uVar1 != 0);
  FUN_18006748c(param_1,pcVar2,((int)register0x00000020 + -0x14) - (int)pcVar2);
  FUN_18005f100(local_10 ^ (ulonglong)auStack72);
  return;
}



// Library Function - Single Match
// Name: ??0UnDecorator@@QEAA@PEADPEBDHP6APEADJ@ZK@Z
// Library: Visual Studio 2015 Release
// public: __cdecl UnDecorator::UnDecorator(char * __ptr64,char const * __ptr64,int,char * __ptr64
// (__cdecl*)(long),unsigned long) __ptr64

void __thiscall
UnDecorator::UnDecorator
          (UnDecorator *this,char *param_1,char *param_2,int param_3,FuncDef7 *param_4,ulong param_5
          )

{
  *(undefined4 *)this = 0xffffffff;
  *(undefined4 *)(this + 0x58) = 0xffffffff;
  DAT_1800b1ff8 = param_1;
  DAT_1800b2000 = param_3;
  if (param_1 == (char *)0x0) {
    DAT_1800b1ff8 = (char *)0x0;
    DAT_1800b2000 = 0;
  }
  DAT_1800b1fd0 = this;
  DAT_1800b1fd8 = (undefined4 *)(this + 0x58);
  DAT_1800b1fe8 = param_2;
  DAT_1800b1ff0 = param_2;
  DAT_1800b2004 = param_5;
  DAT_1800b2008 = 0;
  DAT_1800b2010 = param_4;
  return;
}



// Library Function - Single Match
// Name: ??0pcharNode@@QEAA@PEBDH@Z
// Library: Visual Studio 2015 Release
// public: __cdecl pcharNode::pcharNode(char const * __ptr64,int) __ptr64

void __thiscall pcharNode::pcharNode(pcharNode *this,char *param_1,int param_2)

{
  longlong lVar1;
  char *pcVar2;
  ulonglong uVar3;

  uVar3 = (ulonglong)(uint)param_2;
  *(undefined ***)this = vftable;
  if ((param_2 == 0) || (param_1 == (char *)0x0)) {
    *(undefined8 *)(this + 8) = 0;
    *(undefined4 *)(this + 0x10) = 0;
  }
  else {
    pcVar2 = (char *)_HeapManager::getMemory((_HeapManager *)&DAT_1800b2018,(longlong)param_2,0);
    *(char **)(this + 8) = pcVar2;
    *(int *)(this + 0x10) = param_2;
    if (pcVar2 == (char *)0x0) {
      *(undefined4 *)(this + 0x10) = 0;
    }
    else {
      if (param_2 != 0) {
        lVar1 = -(longlong)pcVar2;
        do {
          *pcVar2 = (param_1 + lVar1)[(longlong)pcVar2];
          pcVar2 = pcVar2 + 1;
          uVar3 = uVar3 - 1;
        } while (uVar3 != 0);
      }
    }
  }
  return;
}



undefined8 * FUN_180065e50(undefined8 *param_1,undefined8 *param_2)

{
  undefined **ppuVar1;
  undefined **ppuVar2;

  ppuVar2 = (undefined **)0x0;
  *param_1 = 0;
  *(undefined4 *)(param_1 + 1) = 0;
  if (param_2 == (undefined8 *)0x0) {
    *(undefined *)(param_1 + 1) = 3;
  }
  else {
    ppuVar1 = (undefined **)_HeapManager::getMemory((_HeapManager *)&DAT_1800b2018,0x10,0);
    if (ppuVar1 != (undefined **)0x0) {
      *ppuVar1 = (undefined *)pDNameNode::vftable;
      if ((byte)(*(char *)(param_2 + 1) - 2U) < 2) {
        param_2 = ppuVar2;
      }
      ppuVar1[1] = (undefined *)param_2;
      ppuVar2 = ppuVar1;
    }
    *param_1 = ppuVar2;
    if (ppuVar2 == (undefined **)0x0) {
      *(undefined *)(param_1 + 1) = 3;
    }
  }
  return param_1;
}



longlong * FUN_180065ed0(longlong *param_1,char *param_2)

{
  char cVar1;
  char *pcVar2;
  int iVar3;

  iVar3 = 0;
  *param_1 = 0;
  *(undefined4 *)(param_1 + 1) = 0;
  cVar1 = *param_2;
  pcVar2 = param_2;
  while (cVar1 != '\0') {
    pcVar2 = pcVar2 + 1;
    iVar3 = iVar3 + 1;
    cVar1 = *pcVar2;
  }
  FUN_18006748c(param_1,param_2,iVar3);
  return param_1;
}



DNameStatusNode ** FUN_180065f08(DNameStatusNode **param_1,undefined8 param_2)

{
  DNameStatusNode *pDVar1;

  *(undefined4 *)(param_1 + 1) = 0;
  *(char *)(param_1 + 1) = (char)(int)param_2;
  if ((int)param_2 == 1) {
    pDVar1 = DNameStatusNode::make(1);
    *param_1 = pDVar1;
    if (pDVar1 == (DNameStatusNode *)0x0) {
      *(undefined *)(param_1 + 1) = 3;
    }
  }
  else {
    *param_1 = (DNameStatusNode *)0x0;
  }
  return param_1;
}



undefined8 * FUN_180065f44(int *param_1,undefined8 *param_2,uint param_3)

{
  undefined8 *puVar1;

  if (param_3 < 10) {
    if ((*param_1 != -1) && ((int)param_3 <= *param_1)) {
      puVar1 = *(undefined8 **)(param_1 + (longlong)(int)param_3 * 2 + 2);
      *param_2 = *puVar1;
      *(undefined4 *)(param_2 + 1) = *(undefined4 *)(puVar1 + 1);
      return param_2;
    }
    *(undefined4 *)(param_2 + 1) = 0;
    *(undefined *)(param_2 + 1) = 2;
  }
  else {
    *(undefined4 *)(param_2 + 1) = 0;
    *(undefined *)(param_2 + 1) = 3;
  }
  *param_2 = 0;
  return param_2;
}



// WARNING: Could not reconcile some variable overlaps

char * FUN_180065f84(void)

{
  char cVar1;
  code *pcVar2;
  DNameNode **ppDVar3;
  DNameNode **ppDVar4;
  longlong **pplVar5;
  char *pcVar6;
  char *pcVar7;
  undefined4 uVar8;
  code **ppcVar9;
  longlong lVar10;
  code **local_48;
  undefined4 local_40;
  code **local_38;
  undefined4 local_30;
  DNameNode *local_28 [2];
  longlong *local_18 [2];

  local_38 = (code **)0x0;
  local_30 = 0;
  ppcVar9 = (code **)0x0;
  uVar8 = 0;
  if (DAT_1800b1ff0 == (char *)0x0) {
LAB_180066078:
    if (((DAT_1800b2004 & 0x1000) != 0) || (*DAT_1800b1fe8 == '\0')) goto LAB_1800660a6;
  }
  else {
    if (*DAT_1800b1ff0 != '?') goto LAB_18006604c;
    cVar1 = DAT_1800b1ff0[1];
    if (cVar1 == '@') {
      DAT_1800b1fe8 = DAT_1800b1fe8 + 2;
      ppDVar3 = FUN_18006893c(local_28);
      ppDVar4 = (DNameNode **)FUN_180065aa8((longlong *)local_18,"CV: ");
      FUN_180066208(ppDVar4,(DNameNode **)&local_48,ppDVar3);
LAB_18006605e:
      if ((char)local_40 == '\x03') {
        return (char *)0x0;
      }
      ppcVar9 = local_48;
      uVar8 = local_40;
      if ((char)local_40 != '\x02') goto LAB_180066078;
    }
    else {
      if (cVar1 == '$') {
        pplVar5 = FUN_18006ba18(local_18,'\0');
        local_40 = *(undefined4 *)(pplVar5 + 1);
        local_48 = (code **)*pplVar5;
        if (((char)local_40 == '\x02') ||
           (((DAT_1800b2004 & 0x1000) == 0 && (*DAT_1800b1fe8 != '\0')))) {
          DAT_1800b1fe8 = DAT_1800b1ff0;
          goto LAB_18006604c;
        }
        goto LAB_18006605e;
      }
      if ((cVar1 != '?') || (DAT_1800b1ff0[2] != '@')) {
LAB_18006604c:
        ppDVar3 = FUN_18006893c((DNameNode **)local_18);
        local_40 = *(undefined4 *)(ppDVar3 + 1);
        local_48 = (code **)*ppDVar3;
        goto LAB_18006605e;
      }
    }
  }
  FUN_180065ed0((longlong *)&local_38,DAT_1800b1ff0);
  ppcVar9 = local_38;
  uVar8 = local_30;
LAB_1800660a6:
  local_30 = uVar8;
  local_38 = ppcVar9;
  ppcVar9 = local_38;
  if (DAT_1800b1ff8 == (char *)0x0) {
    pcVar6 = DAT_1800b1ff8;
    if (local_38 != (code **)0x0) {
      pcVar2 = *(code **)*local_38;
      _guard_check_icall();
      pcVar6 = (char *)(*pcVar2)(ppcVar9);
    }
    pcVar2 = DAT_1800b2018;
    DAT_1800b2000 = (int)pcVar6 + 1;
    lVar10 = (longlong)DAT_1800b2000;
    _guard_check_icall();
    DAT_1800b1ff8 = (char *)(*pcVar2)(lVar10 + 7U & 0xfffffffffffffff8);
    if (DAT_1800b1ff8 == (char *)0x0) {
      return (char *)0x0;
    }
  }
  DName::getString((DName *)&local_38,DAT_1800b1ff8,DAT_1800b2000);
  cVar1 = *DAT_1800b1ff8;
  pcVar6 = DAT_1800b1ff8;
  pcVar7 = DAT_1800b1ff8;
  while (cVar1 != '\0') {
    pcVar7 = pcVar7 + 1;
    if (cVar1 == ' ') {
      *pcVar6 = ' ';
      while (*pcVar7 == ' ') {
        pcVar7 = pcVar7 + 1;
      }
    }
    else {
      *pcVar6 = cVar1;
    }
    cVar1 = *pcVar7;
    pcVar6 = pcVar6 + 1;
  }
  *pcVar6 = *pcVar7;
  return DAT_1800b1ff8;
}



DNameNode ** FUN_180066208(DNameNode **param_1,DNameNode **param_2,DNameNode **param_3)

{
  *param_2 = *param_1;
  *(undefined4 *)(param_2 + 1) = *(undefined4 *)(param_1 + 1);
  FUN_1800662e4(param_2,param_3);
  return param_2;
}



longlong * FUN_180066234(longlong *param_1,longlong *param_2,char param_3)

{
  *param_2 = *param_1;
  *(undefined4 *)(param_2 + 1) = *(undefined4 *)(param_1 + 1);
  FUN_180066328(param_2,param_3);
  return param_2;
}



undefined8 * FUN_180066260(undefined8 *param_1,undefined8 *param_2,DName *param_3)

{
  *param_2 = *param_1;
  *(undefined4 *)(param_2 + 1) = *(undefined4 *)(param_1 + 1);
  DName::operator__((DName *)param_2,param_3);
  return param_2;
}



undefined8 * FUN_18006628c(undefined8 *param_1,undefined8 *param_2,char *param_3)

{
  *param_2 = *param_1;
  *(undefined4 *)(param_2 + 1) = *(undefined4 *)(param_1 + 1);
  DName::operator__((DName *)param_2,param_3);
  return param_2;
}



undefined8 * FUN_1800662b8(undefined8 *param_1,undefined8 *param_2,DNameStatus param_3)

{
  *param_2 = *param_1;
  *(undefined4 *)(param_2 + 1) = *(undefined4 *)(param_1 + 1);
  DName::operator__((DName *)param_2,param_3);
  return param_2;
}



DNameNode ** FUN_1800662e4(DNameNode **param_1,DNameNode **param_2)

{
  DNameNode *pDVar1;

  if (*(char *)(param_1 + 1) < '\x02') {
    pDVar1 = *param_2;
    if (pDVar1 == (DNameNode *)0x0) {
      DName::operator__((DName *)param_1,(int)*(char *)(param_2 + 1));
    }
    else {
      if (*param_1 == (DNameNode *)0x0) {
        *param_1 = pDVar1;
        *(undefined4 *)(param_1 + 1) = *(undefined4 *)(param_2 + 1);
      }
      else {
        DName::append((DName *)param_1,pDVar1);
      }
    }
  }
  return param_1;
}



longlong * FUN_180066328(longlong *param_1,char param_2)

{
  undefined **ppuVar1;
  char local_res8 [8];

  if ((*(char *)(param_1 + 1) < '\x02') && (param_2 != '\0')) {
    if (*param_1 == 0) {
      *param_1 = 0;
      *(undefined4 *)(param_1 + 1) = 0;
      local_res8[0] = param_2;
      FUN_18006748c(param_1,local_res8,1);
    }
    else {
      ppuVar1 = (undefined **)_HeapManager::getMemory((_HeapManager *)&DAT_1800b2018,0x10,0);
      if (ppuVar1 != (undefined **)0x0) {
        *(char *)(ppuVar1 + 1) = param_2;
        *ppuVar1 = (undefined *)charNode::vftable;
      }
      DName::append((DName *)param_1,(DNameNode *)ppuVar1);
    }
  }
  return param_1;
}



// Library Function - Single Match
// Name: ??YDName@@QEAAAEAV0@PEAV0@@Z
// Library: Visual Studio 2015 Release
// public: class DName & __ptr64 __cdecl DName::operator+=(class DName * __ptr64) __ptr64

DName * __thiscall DName::operator__(DName *this,DName *param_1)

{
  undefined **ppuVar1;
  undefined **ppuVar2;

  if (((char)this[8] < '\x02') && (ppuVar2 = (undefined **)0x0, param_1 != (DName *)0x0)) {
    if (*(longlong *)this == 0) {
      FUN_180065e50((undefined8 *)this,(undefined8 *)param_1);
    }
    else {
      if ((byte)param_1[8] < 2) {
        ppuVar1 = (undefined **)_HeapManager::getMemory((_HeapManager *)&DAT_1800b2018,0x10,0);
        if (ppuVar1 != (undefined **)0x0) {
          *ppuVar1 = (undefined *)pDNameNode::vftable;
          if ((byte)((char)param_1[8] - 2U) < 2) {
            param_1 = (DName *)ppuVar2;
          }
          ppuVar1[1] = param_1;
          ppuVar2 = ppuVar1;
        }
        append(this,(DNameNode *)ppuVar2);
      }
      else {
        operator__(this,(int)(char)param_1[8]);
      }
    }
  }
  return this;
}



// Library Function - Single Match
// Name: ??YDName@@QEAAAEAV0@PEBD@Z
// Library: Visual Studio 2015 Release
// public: class DName & __ptr64 __cdecl DName::operator+=(char const * __ptr64) __ptr64

DName * __thiscall DName::operator__(DName *this,char *param_1)

{
  char cVar1;
  pcharNode *this_00;
  DNameNode *extraout_RAX;
  char *pcVar2;
  DNameNode *pDVar3;
  uint uVar4;

  if ((((char)this[8] < '\x02') && (pDVar3 = (DNameNode *)0x0, param_1 != (char *)0x0)) &&
     (*param_1 != '\0')) {
    if (*(longlong *)this == 0) {
      FUN_180065ed0((longlong *)this,param_1);
    }
    else {
      this_00 = (pcharNode *)_HeapManager::getMemory((_HeapManager *)&DAT_1800b2018,0x18,0);
      if (this_00 != (pcharNode *)0x0) {
        uVar4 = 0;
        cVar1 = *param_1;
        pcVar2 = param_1;
        while (cVar1 != '\0') {
          pcVar2 = pcVar2 + 1;
          uVar4 = (int)pDVar3 + 1;
          pDVar3 = (DNameNode *)(ulonglong)uVar4;
          cVar1 = *pcVar2;
        }
        pcharNode::pcharNode(this_00,param_1,uVar4);
        pDVar3 = extraout_RAX;
      }
      append(this,pDVar3);
    }
  }
  return this;
}



// Library Function - Single Match
// Name: ??YDName@@QEAAAEAV0@W4DNameStatus@@@Z
// Library: Visual Studio 2015 Release
// public: class DName & __ptr64 __cdecl DName::operator+=(enum DNameStatus) __ptr64

DName * __thiscall DName::operator__(DName *this,DNameStatus param_1)

{
  DNameStatusNode *pDVar1;
  undefined4 in_register_00000014;

  if ((char)this[8] < '\x02') {
    if ((*(longlong *)this == 0) || (param_1 + 0xfffffffe < 2)) {
      FUN_180065f08((DNameStatusNode **)this,CONCAT44(in_register_00000014,param_1));
    }
    else {
      if (param_1 != 0) {
        pDVar1 = DNameStatusNode::make(param_1);
        append(this,(DNameNode *)pDVar1);
      }
    }
  }
  return this;
}



int * FUN_180066510(int *param_1,longlong *param_2)

{
  longlong *plVar1;

  if ((*param_1 != 9) && (*param_2 != 0)) {
    plVar1 = (longlong *)_HeapManager::getMemory((_HeapManager *)&DAT_1800b2018,0x10,0);
    if (plVar1 == (longlong *)0x0) {
      plVar1 = (longlong *)0x0;
    }
    else {
      *plVar1 = *param_2;
      *(undefined4 *)(plVar1 + 1) = *(undefined4 *)(param_2 + 1);
    }
    if (plVar1 != (longlong *)0x0) {
      *param_1 = *param_1 + 1;
      *(longlong **)(param_1 + (longlong)*param_1 * 2 + 2) = plVar1;
    }
  }
  return param_1;
}



void FUN_1800665a0(longlong param_1)

{
  undefined8 *puVar1;
  code *pcVar2;
  longlong lVar3;

  if (*(longlong *)(param_1 + 8) != 0) {
    lVar3 = *(longlong *)(param_1 + 0x10);
    *(longlong *)(param_1 + 0x18) = lVar3;
    while (lVar3 != 0) {
      puVar1 = *(undefined8 **)(param_1 + 0x18);
      pcVar2 = *(code **)(param_1 + 8);
      *(undefined8 *)(param_1 + 0x10) = *puVar1;
      _guard_check_icall();
      (*pcVar2)(puVar1);
      lVar3 = *(longlong *)(param_1 + 0x10);
      *(longlong *)(param_1 + 0x18) = lVar3;
    }
  }
  return;
}



// Library Function - Single Match
// Name: ?append@DName@@AEAAXPEAVDNameNode@@@Z
// Library: Visual Studio 2015 Release
// private: void __cdecl DName::append(class DNameNode * __ptr64) __ptr64

void __thiscall DName::append(DName *this,DNameNode *param_1)

{
  undefined *puVar1;
  undefined **ppuVar2;

  if (param_1 == (DNameNode *)0x0) {
    this[8] = (DName)0x3;
  }
  else {
    ppuVar2 = (undefined **)_HeapManager::getMemory((_HeapManager *)&DAT_1800b2018,0x20,0);
    if (ppuVar2 != (undefined **)0x0) {
      puVar1 = *(undefined **)this;
      *(undefined4 *)(ppuVar2 + 3) = 0xffffffff;
      *ppuVar2 = (undefined *)pairNode::vftable;
      ppuVar2[1] = puVar1;
      ppuVar2[2] = param_1;
    }
    *(undefined ***)this = ppuVar2;
    if (ppuVar2 == (undefined **)0x0) {
      this[8] = (DName)0x3;
    }
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps

DNameNode ** FUN_180066680(DNameNode **param_1,DNameNode **param_2)

{
  uint uVar1;
  bool bVar2;
  DName DVar3;
  uint uVar4;
  ulonglong uVar5;
  DNameStatusNode **ppDVar6;
  DNameNode **ppDVar7;
  undefined7 extraout_var;
  undefined8 *puVar8;
  undefined7 extraout_var_00;
  undefined8 **ppuVar9;
  longlong *plVar10;
  undefined8 *puVar11;
  uint uVar12;
  char *pcVar13;
  uint uVar14;
  undefined8 *puVar15;
  uint uVar16;
  char local_res10 [8];
  uint local_res18;
  uint local_res20;
  undefined8 *local_118;
  uint local_110;
  undefined8 *local_108;
  uint local_100;
  undefined8 *local_f8;
  uint local_f0;
  DNameNode *local_e8 [2];
  undefined8 *local_d8;
  uint local_d0;
  DNameNode *local_c8;
  undefined4 local_c0;
  int local_b8;
  uint local_b4;
  uint local_b0;
  uint local_ac;
  undefined8 *local_a8;
  uint local_a0;
  undefined8 *local_98;
  uint local_90;
  undefined8 *local_88;
  uint local_80;
  undefined8 *local_78;
  uint local_70;
  DNameNode *local_68 [2];
  DNameNode *local_58 [2];
  longlong local_48 [2];

  local_118 = (undefined8 *)0x0;
  local_110 = 0;
  uVar5 = FUN_18006bd14();
  uVar1 = (uint)uVar5;
  if ((*param_2 == (DNameNode *)0x0) || ((*(uint *)(param_2 + 1) & 0x200) == 0)) {
    local_b8 = 0;
  }
  else {
    local_b8 = 1;
  }
  if (uVar1 == 0xffff) {
    *(undefined4 *)(param_1 + 1) = 0;
    *param_1 = (DNameNode *)0x0;
    *(undefined *)(param_1 + 1) = 2;
    return param_1;
  }
  if (uVar1 == 0xfffe) {
    ppDVar6 = FUN_180065ae8((DNameStatusNode **)&local_108,1);
    FUN_180066208((DNameNode **)ppDVar6,param_1,param_2);
    return param_1;
  }
  if (uVar1 == 0xfffd) {
    *param_1 = *param_2;
    local_110 = *(uint *)(param_2 + 1);
    goto LAB_180066726;
  }
  if ((uVar5 & 0x8000) == 0) {
LAB_180066f64:
    FUN_1800662e4((DNameNode **)&local_118,param_2);
    if ((uVar5 & 0x8000) == 0) {
      if ((uVar1 & 0x7c00) == 0x6800) {
LAB_180066f89:
        FUN_18006c138(param_1,(DNameNode **)&local_118);
        return param_1;
      }
      if ((uVar5 & 0x8000) == 0) {
        if ((uVar1 & 0x7c00) == 0x7000) goto LAB_180066f89;
        if ((uVar1 & 0x7c00) == 0x6000) {
          FUN_180068bd8((DNameStatusNode **)&local_108,'\0');
          ppDVar7 = (DNameNode **)FUN_180066234((longlong *)&local_118,(longlong *)local_e8,'{');
          ppDVar7 = FUN_180066208(ppDVar7,local_68,(DNameNode **)&local_108);
          FUN_18006628c(ppDVar7,param_1,"}\'");
          return param_1;
        }
      }
    }
    if ((uVar1 & 0xfc00) == 0x7c00) {
      *param_1 = (DNameNode *)local_118;
      *(uint *)(param_1 + 1) = local_110;
      DName::operator__((DName *)param_1,"{for ");
      ppDVar6 = FUN_18006a920((DNameStatusNode **)local_e8);
      FUN_1800662e4(param_1,(DNameNode **)ppDVar6);
      FUN_180066328((longlong *)param_1,'}');
      if (*DAT_1800b1fe8 != '@') {
        return param_1;
      }
      DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
      return param_1;
    }
    local_ac = uVar1 & 0x1800;
    local_res18 = (uint)(local_ac == 0x800);
    local_b0 = (uint)((uVar5 & 0x6000) == 0);
    uVar14 = local_b0;
    if ((uVar5 & 0x8000) != 0) {
      uVar14 = local_res18;
    }
    uVar14 = (-(uint)(uVar14 != 0) & 0xfffff400) + 0x1000 & uVar1;
    if (uVar14 == 0) {
LAB_1800670ef:
      if ((uVar14 != 0) && ((uVar1 & 0x1b00) == 0x1200 && (uVar5 & 0x8000) != 0)) {
        pcVar13 = "`template static data member destructor helper\'";
        goto LAB_180067118;
      }
      if (((uVar5 & 0x8000) == 0) && ((uVar1 & 0x7c00) == 0x7800)) goto LAB_180066c7c;
    }
    else {
      if ((uVar1 & 0x1b00) == 0x1000 && (uVar5 & 0x8000) != 0) {
        pcVar13 = "`local static destructor helper\'";
      }
      else {
        if ((uVar1 & 0x1b00) != 0x1100 || (uVar5 & 0x8000) == 0) goto LAB_1800670ef;
        pcVar13 = "`template static data member constructor helper\'";
      }
LAB_180067118:
      DName::operator__((DName *)&local_118,pcVar13);
    }
    if ((uVar14 == 0) ||
       (((uVar1 & 0x1b00) != 0x1100 || (uVar5 & 0x8000) == 0 &&
        ((uVar1 & 0x1b00) != 0x1200 || (uVar5 & 0x8000) == 0)))) {
      ppDVar7 = (DNameNode **)FUN_180069244((DNameStatusNode **)local_e8,(DNameNode **)&local_118);
LAB_1800671b1:
      local_110 = *(uint *)(ppDVar7 + 1);
      uVar16 = local_110;
      local_118 = (undefined8 *)*ppDVar7;
    }
    else {
      ppDVar7 = (DNameNode **)FUN_180065aa8((longlong *)local_e8," ");
      FUN_180066208(ppDVar7,(DNameNode **)&local_108,(DNameNode **)&local_118);
      uVar16 = local_100;
      local_118 = local_108;
      local_110 = local_100;
    }
  }
  else {
    uVar16 = uVar1 & 0x1800;
    local_res18 = (uint)(uVar16 == 0x800);
    local_b0 = (uint)((uVar5 & 0x6000) == 0);
    uVar14 = 0x1000;
    if (uVar16 == 0x800) {
      uVar14 = 0x400;
    }
    uVar14 = uVar14 & uVar1;
    local_res20 = uVar14;
    local_ac = uVar16;
    if ((uVar14 != 0) &&
       (((uVar4 = uVar1 & 0x1b00, uVar4 == 0x1000 || (uVar4 == 0x1100)) || (uVar4 == 0x1200))))
    goto LAB_180066f64;
    uVar4 = 0;
    if ((uVar1 >> 0xe & 1) != 0) {
      if ((~((DAT_1800b2004 >> 2 | DAT_1800b2004) >> 1) & 1) == 0) {
        ppDVar7 = FUN_180067a20((DNameNode **)&local_108);
        uVar4 = 0;
        if ('\x01' < *(char *)(ppDVar7 + 1)) {
          uVar4 = (uint)*(byte *)(ppDVar7 + 1);
          local_110 = uVar4;
        }
      }
      else {
        ppDVar7 = FUN_180067a20((DNameNode **)&local_108);
        local_d8 = (undefined8 *)0x0;
        local_d0 = 0;
        local_res10[0] = ' ';
        FUN_18006748c((longlong *)&local_d8,local_res10,1);
        FUN_180066208((DNameNode **)&local_d8,(DNameNode **)&local_f8,ppDVar7);
        local_118 = local_f8;
        uVar4 = local_f0;
        local_110 = local_f0;
      }
    }
    if ((uVar14 == 0) || (uVar16 != 0x1800)) {
      local_78 = (undefined8 *)0x0;
      local_70 = 0;
      local_88 = (undefined8 *)0x0;
      local_80 = 0;
      local_98 = (undefined8 *)0x0;
      local_90 = 0;
      local_d8 = (undefined8 *)0x0;
      local_d0 = 0;
      local_a8 = (undefined8 *)0x0;
      local_a0 = 0;
      if (uVar14 != 0) {
        if (uVar16 == 0x800) {
          if ((uVar1 & 0x700) == 0x600) {
            FUN_180068bd8((DNameStatusNode **)&local_f8,'\x01');
            local_78 = local_f8;
            local_70 = local_f0;
            FUN_180068bd8((DNameStatusNode **)&local_f8,'\x01');
            local_88 = local_f8;
            local_80 = local_f0;
          }
          else {
            if ((uVar1 & 0x700) != 0x500) goto LAB_180066a80;
          }
          FUN_180068bd8((DNameStatusNode **)&local_f8,'\x01');
          local_98 = local_f8;
          local_90 = local_f0;
        }
LAB_180066a80:
        FUN_180068bd8((DNameStatusNode **)&local_f8,'\x01');
        local_d8 = local_f8;
        local_d0 = local_f0;
      }
      if ((uVar16 == 0x800) && ((uVar1 & 0x700) != 0x200)) {
        local_c8 = (DNameNode *)0x0;
        local_c0 = 0;
        if (((byte)DAT_1800b2004 & 0x60) == 0x60) {
          local_108 = (undefined8 *)0x0;
          local_100 = 0;
          FUN_180068078((DNameStatusNode **)&local_f8,&local_c8,"",(DNameNode **)&local_108,1);
          if ('\x01' < (char)local_f0) {
            local_a0 = local_f0 & 0xff;
          }
        }
        else {
          local_f8 = (undefined8 *)0x0;
          local_f0 = 0;
          FUN_180068078((DNameStatusNode **)&local_108,&local_c8,"",(DNameNode **)&local_f8,1);
          local_a8 = local_108;
          local_a0 = local_100;
        }
      }
      if (((~(DAT_1800b2004 >> 1) & 1) == 0) || ((~(DAT_1800b2004 >> 4) & 1) == 0)) {
        ppDVar6 = FUN_180067f64((DNameStatusNode **)&local_108);
        if (((char)local_110 != '\x03') && ('\x01' < *(char *)(ppDVar6 + 1))) {
          local_110 = uVar4 & 0xffffff00 | (uint)*(byte *)(ppDVar6 + 1);
        }
      }
      else {
        ppDVar6 = FUN_180067f64((DNameStatusNode **)&local_108);
        ppDVar7 = FUN_180066208((DNameNode **)ppDVar6,&local_c8,(DNameNode **)&local_118);
        local_118 = (undefined8 *)*ppDVar7;
        local_110 = *(uint *)(ppDVar7 + 1);
      }
      puVar8 = (undefined8 *)0x0;
      if ((undefined8 *)*param_2 != (undefined8 *)0x0) {
        if ((local_118 == (undefined8 *)0x0) || ((DAT_1800b2004 & 0x1000) != 0)) {
          local_110 = *(uint *)(param_2 + 1);
          local_118 = (undefined8 *)*param_2;
        }
        else {
          local_res10[0] = ' ';
          local_f8 = (undefined8 *)0x0;
          local_f0 = 0;
          FUN_18006748c((longlong *)&local_f8,local_res10,1);
          FUN_180066208((DNameNode **)&local_f8,(DNameNode **)&local_108,param_2);
          FUN_1800662e4((DNameNode **)&local_118,(DNameNode **)&local_108);
        }
      }
      local_b4 = 0;
      puVar15 = puVar8;
      if (local_b8 == 0) {
        puVar8 = (undefined8 *)_HeapManager::getMemory((_HeapManager *)&DAT_1800b2018,0x10,0);
        if (puVar8 != (undefined8 *)0x0) {
          *puVar8 = 0;
          *(undefined4 *)(puVar8 + 1) = 0;
          puVar15 = puVar8;
        }
        DVar3 = UnDecorator::getReturnType((DName *)&local_108);
        puVar8 = *(undefined8 **)(undefined8 *)CONCAT71(extraout_var_00,DVar3);
        local_b4 = *(uint *)((undefined8 *)CONCAT71(extraout_var_00,DVar3) + 1);
LAB_180066ccd:
        if (local_res20 != 0) {
          if (uVar16 == 0x800) {
            if ((uVar1 & 0x700) == 0x600) {
              ppDVar7 = (DNameNode **)FUN_180065aa8((longlong *)&local_c8,"`vtordispex{");
              FUN_180066208(ppDVar7,(DNameNode **)&local_108,(DNameNode **)&local_78);
              ppDVar7 = (DNameNode **)
                        FUN_180066234((longlong *)&local_108,(longlong *)&local_f8,',');
              ppDVar7 = FUN_180066208(ppDVar7,local_58,(DNameNode **)&local_88);
              ppDVar7 = (DNameNode **)FUN_180066234((longlong *)ppDVar7,local_48,',');
              ppuVar9 = (undefined8 **)FUN_180066208(ppDVar7,local_68,(DNameNode **)&local_98);
              ppDVar7 = local_e8;
            }
            else {
              if ((uVar1 & 0x700) != 0x500) goto LAB_180066da7;
              ppDVar7 = (DNameNode **)FUN_180065aa8((longlong *)local_e8,"`vtordisp{");
              FUN_180066208(ppDVar7,(DNameNode **)&local_108,(DNameNode **)&local_98);
              ppDVar7 = local_68;
              ppuVar9 = &local_108;
            }
            ppDVar7 = (DNameNode **)FUN_180066234((longlong *)ppuVar9,(longlong *)ppDVar7,',');
            FUN_1800662e4((DNameNode **)&local_118,ppDVar7);
          }
          else {
LAB_180066da7:
            DName::operator__((DName *)&local_118,"`adjustor{");
          }
          ppDVar7 = (DNameNode **)FUN_18006628c(&local_d8,local_e8,"}\' ");
          FUN_1800662e4((DNameNode **)&local_118,ppDVar7);
        }
        ppDVar7 = FUN_1800676c8(local_e8);
        local_f8 = (undefined8 *)0x0;
        local_f0 = 0;
        local_res10[0] = '(';
        FUN_18006748c((longlong *)&local_f8,local_res10,1);
        FUN_180066208((DNameNode **)&local_f8,(DNameNode **)&local_108,ppDVar7);
        ppDVar7 = (DNameNode **)FUN_180066234((longlong *)&local_108,(longlong *)local_68,')');
        FUN_1800662e4((DNameNode **)&local_118,ppDVar7);
        if ((uVar16 == 0x800) && ((uVar1 & 0x700) != 0x200)) {
          FUN_1800662e4((DNameNode **)&local_118,(DNameNode **)&local_a8);
        }
        if ((~(DAT_1800b2004 >> 0x13) & 1) == 0) {
          plVar10 = FUN_18006a7b8((longlong *)local_e8);
          if (((char)local_110 != '\x03') && ('\x01' < *(char *)(plVar10 + 1))) {
            local_110 = local_110 & 0xffffff00 | (uint)*(byte *)(plVar10 + 1);
          }
        }
        else {
          ppDVar7 = (DNameNode **)FUN_18006a7b8((longlong *)local_e8);
          FUN_1800662e4((DNameNode **)&local_118,ppDVar7);
        }
        uVar16 = local_110;
        if ((~(DAT_1800b2004 >> 8) & 1) == 0) {
          plVar10 = FUN_18006bc6c((longlong *)local_e8);
          if (((char)local_110 != '\x03') && ('\x01' < *(char *)(plVar10 + 1))) {
            uVar16 = uVar16 & 0xffffff00 | (uint)*(byte *)(plVar10 + 1);
            local_110 = uVar16;
          }
        }
        else {
          ppDVar7 = (DNameNode **)FUN_18006bc6c((longlong *)local_e8);
          FUN_1800662e4((DNameNode **)&local_118,ppDVar7);
          uVar16 = local_110;
        }
        puVar11 = FUN_180068d3c(local_e8);
        if (((char)local_110 != '\x03') && ('\x01' < *(char *)(puVar11 + 1))) {
          uVar16 = uVar16 & 0xffffff00 | (uint)*(byte *)(puVar11 + 1);
          local_110 = uVar16;
        }
        uVar14 = local_res20;
        if (((~(DAT_1800b2004 >> 2) & 1) != 0) && (puVar15 != (undefined8 *)0x0)) {
          *(uint *)(puVar15 + 1) = uVar16;
          *puVar15 = local_118;
          uVar16 = local_b4;
          local_118 = puVar8;
          local_110 = local_b4;
        }
        goto LAB_1800671c0;
      }
      DVar3 = UnDecorator::getReturnType((DName *)&local_c8);
      ppDVar7 = (DNameNode **)FUN_180065aa8((longlong *)&local_f8," ");
      FUN_180066208(ppDVar7,(DNameNode **)&local_108,(DNameNode **)CONCAT71(extraout_var,DVar3));
      FUN_1800662e4((DNameNode **)&local_118,(DNameNode **)&local_108);
      if ((DAT_1800b2004 & 0x1000) == 0) goto LAB_180066ccd;
LAB_180066c7c:
      *param_1 = (DNameNode *)local_118;
LAB_180066726:
      *(uint *)(param_1 + 1) = local_110;
      return param_1;
    }
    FUN_180068bd8((DNameStatusNode **)&local_108,'\0');
    ppDVar7 = (DNameNode **)FUN_180066234((longlong *)param_2,(longlong *)&local_c8,'{');
    ppDVar7 = FUN_180066208(ppDVar7,(DNameNode **)&local_f8,(DNameNode **)&local_108);
    FUN_1800662e4((DNameNode **)&local_118,ppDVar7);
    if (*DAT_1800b1fe8 == '\0') {
      FUN_180065ae8((DNameStatusNode **)&local_a8,1);
    }
    else {
      if (*DAT_1800b1fe8 == 'A') {
        DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
        FUN_180065aa8((longlong *)&local_a8,"{flat}");
      }
      else {
        local_a8 = (undefined8 *)0x0;
        local_a0 = 2;
      }
    }
    if ((DAT_1800b2004 & 0x1000) == 0) {
      local_d8 = (undefined8 *)0x0;
      local_d0 = 0;
      local_res10[0] = ',';
      FUN_18006748c((longlong *)&local_d8,local_res10,1);
      FUN_180066208((DNameNode **)&local_d8,(DNameNode **)&local_108,(DNameNode **)&local_a8);
      ppDVar7 = (DNameNode **)FUN_18006628c(&local_108,&local_c8,"}\' ");
      FUN_1800662e4((DNameNode **)&local_118,ppDVar7);
    }
    DName::operator__((DName *)&local_118,"}\'");
    FUN_180067f64((DNameStatusNode **)&local_108);
    uVar16 = local_110;
    if ((((~(DAT_1800b2004 >> 1) & 1) != 0) && ((~(DAT_1800b2004 >> 4) & 1) != 0)) &&
       ((DAT_1800b2004 >> 0xc & 1) == 0)) {
      local_d8 = (undefined8 *)0x0;
      local_d0 = 0;
      local_res10[0] = ' ';
      FUN_18006748c((longlong *)&local_d8,local_res10,1);
      FUN_180066208((DNameNode **)&local_d8,&local_c8,(DNameNode **)&local_108);
      ppDVar7 = (DNameNode **)FUN_180066234((longlong *)&local_c8,(longlong *)&local_f8,' ');
      ppDVar7 = FUN_180066208(ppDVar7,(DNameNode **)&local_88,(DNameNode **)&local_118);
      goto LAB_1800671b1;
    }
  }
LAB_1800671c0:
  uVar4 = local_b0;
  if ((uVar5 & 0x8000) != 0) {
    uVar4 = local_res18;
  }
  if (uVar4 != 0) {
    if ((~(DAT_1800b2004 >> 9) & 1) != 0) {
      uVar4 = uVar1 & 0x700;
      if ((uVar5 & 0x8000) == 0 || uVar4 == 0x200) {
        ppDVar7 = (DNameNode **)FUN_180065aa8((longlong *)local_e8,"static ");
        FUN_180066208(ppDVar7,(DNameNode **)&local_108,(DNameNode **)&local_118);
        local_118 = local_108;
        local_110 = local_100;
        uVar16 = local_100;
      }
      if ((((uVar5 & 0x8000) != 0) && (uVar4 == 0x100)) ||
         ((uVar14 != 0 && (((uVar4 - 0x400 & 0xfffffcff) == 0 && (uVar4 != 0x700)))))) {
        ppDVar7 = (DNameNode **)FUN_180065aa8((longlong *)local_e8,"virtual ");
        FUN_180066208(ppDVar7,(DNameNode **)&local_108,(DNameNode **)&local_118);
        local_118 = local_108;
        local_110 = local_100;
        uVar16 = local_100;
      }
    }
    if ((~(DAT_1800b2004 >> 7) & 1) != 0) {
      uVar12 = uVar1 & 0xc0;
      uVar4 = local_res18;
      if ((uVar5 & 0x8000) != 0) {
        uVar4 = (uint)(uVar12 == 0x40);
      }
      if (uVar4 == 0) {
        bVar2 = local_ac == 0x1000;
        if ((uVar5 & 0x8000) != 0) {
          bVar2 = uVar12 == 0x80;
        }
        if (bVar2) {
          pcVar13 = "protected: ";
        }
        else {
          uVar4 = local_ac;
          if ((uVar5 & 0x8000) != 0) {
            uVar4 = uVar12;
          }
          if (uVar4 != 0) goto LAB_180067356;
          pcVar13 = "public: ";
        }
      }
      else {
        pcVar13 = "private: ";
      }
      ppDVar7 = (DNameNode **)FUN_180065aa8((longlong *)local_e8,pcVar13);
      FUN_180066208(ppDVar7,(DNameNode **)&local_108,(DNameNode **)&local_118);
      local_118 = local_108;
      local_110 = local_100;
      uVar16 = local_100;
    }
  }
LAB_180067356:
  if ((uVar14 != 0) && ((DAT_1800b2004 & 0x1000) == 0)) {
    ppDVar7 = (DNameNode **)FUN_180065aa8((longlong *)local_e8,"[thunk]:");
    FUN_180066208(ppDVar7,(DNameNode **)&local_108,(DNameNode **)&local_118);
    local_118 = local_108;
    local_110 = local_100;
    uVar16 = local_100;
  }
  if ((uVar1 >> 0x10 & 1) != 0) {
    ppDVar7 = (DNameNode **)FUN_180065aa8((longlong *)local_e8,"extern \"C\" ");
    FUN_180066208(ppDVar7,(DNameNode **)&local_108,(DNameNode **)&local_118);
    local_118 = local_108;
    uVar16 = local_100;
  }
  *param_1 = (DNameNode *)local_118;
  *(uint *)(param_1 + 1) = uVar16;
  return param_1;
}



void FUN_18006748c(longlong *param_1,char *param_2,int param_3)

{
  char cVar1;
  pcharNode *this;
  undefined **extraout_RAX;
  undefined **ppuVar2;

  if (*param_1 != 0) {
    *(undefined4 *)(param_1 + 1) = 0;
    *param_1 = 0;
    *(undefined *)(param_1 + 1) = 3;
    return;
  }
  if ((param_2 == (char *)0x0) || (param_3 == 0)) {
    *(undefined *)(param_1 + 1) = 2;
    return;
  }
  if (param_3 == 1) {
    ppuVar2 = (undefined **)_HeapManager::getMemory((_HeapManager *)&DAT_1800b2018,0x10,0);
    if (ppuVar2 != (undefined **)0x0) {
      cVar1 = *param_2;
      *ppuVar2 = (undefined *)charNode::vftable;
      *(char *)(ppuVar2 + 1) = cVar1;
      goto LAB_180067510;
    }
  }
  else {
    this = (pcharNode *)_HeapManager::getMemory((_HeapManager *)&DAT_1800b2018,0x18,0);
    if (this != (pcharNode *)0x0) {
      pcharNode::pcharNode(this,param_2,param_3);
      ppuVar2 = extraout_RAX;
      goto LAB_180067510;
    }
  }
  ppuVar2 = (undefined **)0x0;
LAB_180067510:
  *param_1 = (longlong)ppuVar2;
  if (ppuVar2 == (undefined **)0x0) {
    *(undefined *)(param_1 + 1) = 3;
  }
  return;
}



DNameNode ** FUN_180067590(DNameNode **param_1)

{
  char cVar1;
  bool bVar2;
  char *pcVar3;
  DNameNode **ppDVar4;
  DNameStatusNode *local_38;
  undefined4 local_30;
  DNameStatusNode *local_28 [2];
  undefined8 local_18 [2];

  *param_1 = (DNameNode *)0x0;
  *(undefined4 *)(param_1 + 1) = 0;
  bVar2 = true;
  cVar1 = *(char *)(param_1 + 1);
  while( true ) {
    if (cVar1 != '\0') {
      return param_1;
    }
    if (*DAT_1800b1fe8 == '@') {
      return param_1;
    }
    if (*DAT_1800b1fe8 == 'Z') {
      return param_1;
    }
    if (bVar2) {
      bVar2 = false;
    }
    else {
      FUN_180066328((longlong *)param_1,',');
    }
    pcVar3 = DAT_1800b1fe8;
    if (*DAT_1800b1fe8 == '\0') break;
    cVar1 = *DAT_1800b1fe8;
    if ((int)cVar1 - 0x30U < 10) {
      DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
      ppDVar4 = (DNameNode **)FUN_180065f44(DAT_1800b1fd0,local_18,(int)cVar1 - 0x30U);
      FUN_1800662e4(param_1,ppDVar4);
    }
    else {
      local_38 = (DNameStatusNode *)0x0;
      local_30 = 0;
      FUN_18006a2b8(local_28,&local_38);
      if ((1 < (longlong)(DAT_1800b1fe8 + -(longlong)pcVar3)) && (*DAT_1800b1fd0 != 9)) {
        FUN_180066510(DAT_1800b1fd0,(longlong *)local_28);
      }
      FUN_1800662e4(param_1,(DNameNode **)local_28);
      if (DAT_1800b1fe8 == pcVar3) {
        *(undefined4 *)(param_1 + 1) = 0;
        *param_1 = (DNameNode *)0x0;
        *(undefined *)(param_1 + 1) = 2;
      }
    }
    cVar1 = *(char *)(param_1 + 1);
  }
  DName::operator__((DName *)param_1,1);
  return param_1;
}



DNameNode ** FUN_1800676c8(DNameNode **param_1)

{
  DNameNode **ppDVar1;
  char *pcVar2;
  DNameNode *local_28;
  undefined4 local_20;
  undefined8 local_18 [2];

  if (*DAT_1800b1fe8 == 'X') {
    pcVar2 = "void";
  }
  else {
    if (*DAT_1800b1fe8 != 'Z') {
      FUN_180067590(&local_28);
      if (((char)local_20 == '\0') && (*DAT_1800b1fe8 != '\0')) {
        if (*DAT_1800b1fe8 != '@') {
          if (*DAT_1800b1fe8 != 'Z') {
            *(undefined4 *)(param_1 + 1) = 0;
            *(undefined *)(param_1 + 1) = 2;
            *param_1 = (DNameNode *)0x0;
            return param_1;
          }
          DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
          pcVar2 = ",<ellipsis>";
          if ((~(DAT_1800b2004 >> 0x12) & 1) != 0) {
            pcVar2 = ",...";
          }
          ppDVar1 = (DNameNode **)FUN_18006628c(&local_28,local_18,pcVar2);
          *param_1 = *ppDVar1;
          *(undefined4 *)(param_1 + 1) = *(undefined4 *)(ppDVar1 + 1);
          return param_1;
        }
        DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
      }
      *param_1 = local_28;
      *(undefined4 *)(param_1 + 1) = local_20;
      return param_1;
    }
    pcVar2 = "<ellipsis>";
    if ((~(DAT_1800b2004 >> 0x12) & 1) != 0) {
      pcVar2 = "...";
    }
  }
  DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
  FUN_180065aa8((longlong *)param_1,pcVar2);
  return param_1;
}



// WARNING: Could not reconcile some variable overlaps

DNameStatusNode ** FUN_1800677cc(DNameStatusNode **param_1,DNameNode **param_2)

{
  int iVar1;
  longlong *plVar2;
  DNameStatusNode **ppDVar3;
  DNameNode **ppDVar4;
  DNameNode **ppDVar5;
  char local_res18 [8];
  DNameNode *local_78;
  undefined4 local_70;
  DNameNode *local_68;
  undefined4 local_60;
  DNameStatusNode *local_58;
  uint local_50;
  DNameNode *local_48 [2];
  DNameStatusNode *local_38 [2];
  DNameNode *local_28 [2];

  if (*DAT_1800b1fe8 == '\0') {
    local_68 = (DNameNode *)0x0;
    local_60 = 0;
    if (*param_2 == (DNameNode *)0x0) {
      local_res18[0] = '[';
      FUN_18006748c((longlong *)&local_68,local_res18,1);
      plVar2 = FUN_1800662b8(&local_68,local_28,1);
      ppDVar3 = local_38;
      goto LAB_1800679e9;
    }
    local_res18[0] = '(';
    FUN_18006748c((longlong *)&local_68,local_res18,1);
    FUN_180066208(&local_68,local_48,param_2);
    ppDVar4 = (DNameNode **)FUN_18006628c(local_48,local_28,")[");
    ppDVar5 = (DNameNode **)local_38;
  }
  else {
    iVar1 = UnDecorator::getNumberOfDimensions();
    local_78 = (DNameNode *)0x0;
    local_70 = 0;
    if (iVar1 < 0) {
      iVar1 = 0;
    }
    if (iVar1 != 0) {
      if ((*(uint *)(param_2 + 1) & 0x800) == 0) goto LAB_18006786a;
      DName::operator__((DName *)&local_78,"[]");
      while ((char)local_70 < '\x02') {
LAB_18006786a:
        if ((iVar1 == 0) || (*DAT_1800b1fe8 == '\0')) break;
        ppDVar3 = FUN_180068bd8(local_38,'\0');
        local_res18[0] = '[';
        local_68 = (DNameNode *)0x0;
        local_60 = 0;
        FUN_18006748c((longlong *)&local_68,local_res18,1);
        FUN_180066208(&local_68,local_48,(DNameNode **)ppDVar3);
        ppDVar5 = (DNameNode **)FUN_180066234((longlong *)local_48,(longlong *)local_28,']');
        FUN_1800662e4(&local_78,ppDVar5);
        iVar1 = iVar1 + -1;
      }
      if (*param_2 != (DNameNode *)0x0) {
        if ((*(uint *)(param_2 + 1) & 0x800) == 0) {
          local_res18[0] = '(';
          local_68 = (DNameNode *)0x0;
          local_60 = 0;
          FUN_18006748c((longlong *)&local_68,local_res18,1);
          FUN_180066208(&local_68,local_48,param_2);
          param_2 = (DNameNode **)FUN_180066234((longlong *)local_48,(longlong *)local_28,')');
          ppDVar5 = (DNameNode **)local_38;
        }
        else {
          ppDVar5 = local_28;
        }
        ppDVar5 = FUN_180066208(param_2,ppDVar5,&local_78);
        local_78 = *ppDVar5;
        local_70 = *(undefined4 *)(ppDVar5 + 1);
      }
      FUN_18006a2b8(&local_58,(DNameStatusNode **)&local_78);
      *(uint *)(param_1 + 1) = local_50 | 0x800;
      *param_1 = local_58;
      return param_1;
    }
    local_res18[0] = '[';
    FUN_18006748c((longlong *)&local_78,local_res18,1);
    ppDVar5 = local_48;
    ppDVar4 = &local_78;
  }
  plVar2 = FUN_1800662b8(ppDVar4,ppDVar5,1);
  ppDVar3 = &local_58;
LAB_1800679e9:
  ppDVar5 = (DNameNode **)FUN_180066234(plVar2,(longlong *)ppDVar3,']');
  FUN_180067ae4(param_1,ppDVar5);
  return param_1;
}



DNameNode ** FUN_180067a20(DNameNode **param_1)

{
  char cVar1;
  DNameStatusNode **ppDVar2;
  char *pcVar3;
  DNameNode *local_28;
  undefined4 local_20;
  DNameStatusNode *local_18 [2];

  pcVar3 = "__based(";
  if ((~DAT_1800b2004 & 1) == 0) {
    pcVar3 = "based(";
  }
  FUN_180065aa8((longlong *)&local_28,pcVar3);
  if (*DAT_1800b1fe8 == '\0') {
    DName::operator__((DName *)&local_28,1);
  }
  else {
    cVar1 = *DAT_1800b1fe8;
    DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
    if (cVar1 == '0') {
      DName::operator__((DName *)&local_28,"void");
    }
    else {
      if (cVar1 == '2') {
        ppDVar2 = FUN_18006ad98(local_18,0);
        FUN_1800662e4(&local_28,(DNameNode **)ppDVar2);
      }
      else {
        if (cVar1 == '5') {
          *(undefined4 *)(param_1 + 1) = 0;
          *(undefined *)(param_1 + 1) = 2;
          *param_1 = (DNameNode *)0x0;
          return param_1;
        }
      }
    }
  }
  DName::operator__((DName *)&local_28,") ");
  *param_1 = local_28;
  *(undefined4 *)(param_1 + 1) = local_20;
  return param_1;
}



DNameStatusNode ** FUN_180067ae4(DNameStatusNode **param_1,DNameNode **param_2)

{
  uint uVar1;
  DNameNode **ppDVar2;
  byte *pbVar3;
  char *pcVar4;
  byte bVar5;
  uint uVar6;
  byte local_res18 [8];
  byte local_res20;
  DNameNode *local_48;
  uint local_40;
  DNameStatusNode *local_38;
  uint local_30;
  DNameNode *local_28;
  uint local_20;

  local_res20 = *DAT_1800b1fe8;
  if (local_res20 == 0) {
    ppDVar2 = (DNameNode **)FUN_180065ae8((DNameStatusNode **)&local_28,1);
LAB_180067f2a:
    FUN_180066208(ppDVar2,(DNameNode **)param_1,param_2);
    return param_1;
  }
  pbVar3 = DAT_1800b1fe8 + 1;
  uVar6 = 0xffffffff;
  local_res18[0] = 0;
  local_48 = (DNameNode *)0x0;
  local_40 = 0;
  uVar1 = (uint)local_res20;
  if (local_res20 < 0x4f) {
    if (local_res20 == 0x4e) {
LAB_180067df5:
      DAT_1800b1fe8 = pbVar3;
      DName::operator__((DName *)&local_48,"double");
LAB_180067e07:
      bVar5 = local_res18[0];
      if (uVar6 != 0xffffffff) {
LAB_180067d43:
        local_28 = *param_2;
        local_20 = *(uint *)(param_2 + 1);
        local_48 = (DNameNode *)0x0;
        local_40 = 0;
        if (uVar6 != 0xfffffffe) {
          if (local_28 == (DNameNode *)0x0) {
            if ((uVar6 & 1) == 0) {
              if ((uVar6 & 2) != 0) {
                FUN_180065ed0((longlong *)&local_48,"volatile");
              }
            }
            else {
              FUN_180065ed0((longlong *)&local_48,"const");
              if ((uVar6 & 2) != 0) {
                DName::operator__((DName *)&local_48," volatile");
              }
            }
          }
          FUN_18006a668(param_1,&local_48,&local_28,"*");
          return param_1;
        }
        local_20 = local_20 | 0x800;
        FUN_18006a668(&local_38,&local_48,&local_28,"");
        if ((local_30 & 0x800) == 0) {
          DName::operator__((DName *)&local_38,"[]");
        }
        *param_1 = local_38;
LAB_180067cfa:
        *(uint *)(param_1 + 1) = local_30;
        return param_1;
      }
    }
    else {
      if (local_res20 < 0x43) goto LAB_180067dbb;
      if (local_res20 < 0x46) {
        pcVar4 = "char";
      }
      else {
        if (local_res20 < 0x48) {
          pcVar4 = "short";
        }
        else {
          if (uVar1 < 0x4a) {
            pcVar4 = "int";
          }
          else {
            if (uVar1 < 0x4c) {
              pcVar4 = "long";
            }
            else {
              if (uVar1 != 0x4d) goto LAB_180067dbb;
              pcVar4 = "float";
            }
          }
        }
      }
LAB_180067b61:
      DAT_1800b1fe8 = pbVar3;
      FUN_180065ed0((longlong *)&local_48,pcVar4);
      bVar5 = local_res18[0];
    }
  }
  else {
    if (local_res20 == 0x4f) {
      DAT_1800b1fe8 = pbVar3;
      FUN_180065ed0((longlong *)&local_48,"long ");
      pbVar3 = DAT_1800b1fe8;
      goto LAB_180067df5;
    }
    if (local_res20 < 0x50) {
LAB_180067dbb:
      ppDVar2 = FUN_180068da4(&local_28);
      local_48 = *ppDVar2;
      local_30 = *(uint *)(ppDVar2 + 1);
      bVar5 = local_res18[0];
joined_r0x000180067cf0:
      local_40 = local_30;
      if (local_48 == (DNameNode *)0x0) {
        *param_1 = (DNameStatusNode *)0x0;
        goto LAB_180067cfa;
      }
      goto LAB_180067e13;
    }
    if (local_res20 < 0x54) {
      uVar6 = uVar1 & 3;
      DAT_1800b1fe8 = pbVar3;
      goto LAB_180067e07;
    }
    if (uVar1 == 0x58) {
      pcVar4 = "void";
      goto LAB_180067b61;
    }
    if (local_res20 != 0x5f) goto LAB_180067dbb;
    bVar5 = *pbVar3;
    pbVar3 = DAT_1800b1fe8 + 2;
    uVar1 = (uint)bVar5;
    if (bVar5 < 0x4f) {
      if (bVar5 == 0x4e) {
        pcVar4 = "bool";
      }
      else {
        if (bVar5 < 0x48) {
          if (uVar1 < 0x46) {
            if (uVar1 == 0) {
              DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
              FUN_180065f08((DNameStatusNode **)&local_48,1);
              goto LAB_180067e13;
            }
            if (uVar1 == 0x24) {
              DAT_1800b1fe8 = pbVar3;
              param_2 = (DNameNode **)FUN_180067ae4((DNameStatusNode **)&local_28,param_2);
              ppDVar2 = (DNameNode **)FUN_180065aa8((longlong *)&local_38,"__w64 ");
              goto LAB_180067f2a;
            }
            if (1 < uVar1 - 0x44) goto LAB_180067d02;
            pcVar4 = "__int8";
          }
          else {
            pcVar4 = "__int16";
          }
        }
        else {
          if (uVar1 < 0x48) {
LAB_180067d02:
            pcVar4 = "UNKNOWN";
          }
          else {
            if (uVar1 < 0x4a) {
              pcVar4 = "__int32";
            }
            else {
              if (uVar1 < 0x4c) {
                pcVar4 = "__int64";
              }
              else {
                if (0x4d < uVar1) goto LAB_180067d02;
                pcVar4 = "__int128";
              }
            }
          }
        }
      }
    }
    else {
      if (uVar1 == 0x4f) {
        uVar6 = 0xfffffffe;
        DAT_1800b1fe8 = pbVar3;
        goto LAB_180067d43;
      }
      if (uVar1 == 0x52) {
        pcVar4 = "<unknown>";
      }
      else {
        if (uVar1 == 0x53) {
          pcVar4 = "char16_t";
        }
        else {
          if (uVar1 == 0x55) {
            pcVar4 = "char32_t";
          }
          else {
            if (uVar1 != 0x57) {
              if (1 < uVar1 - 0x58) goto LAB_180067d02;
              DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
              ppDVar2 = FUN_180068da4(&local_28);
              local_48 = *ppDVar2;
              local_30 = *(uint *)(ppDVar2 + 1);
              goto joined_r0x000180067cf0;
            }
            pcVar4 = "wchar_t";
          }
        }
      }
    }
    DAT_1800b1fe8 = pbVar3;
    FUN_180065ed0((longlong *)&local_48,pcVar4);
  }
LAB_180067e13:
  if (local_res20 == 0x43) {
    pcVar4 = "signed ";
  }
  else {
    if (((local_res20 + 0xbb & 0xf9) != 0) &&
       (((local_res20 != 0x5f || (8 < (byte)(bVar5 + 0xbb))) || ((bVar5 + 0xbb & 1) != 0))))
    goto LAB_180067e6b;
    pcVar4 = "unsigned ";
  }
  ppDVar2 = (DNameNode **)FUN_180065aa8((longlong *)&local_38,pcVar4);
  FUN_180066208(ppDVar2,&local_28,&local_48);
  local_48 = local_28;
  local_40 = local_20;
LAB_180067e6b:
  if (*param_2 != (DNameNode *)0x0) {
    local_res18[0] = 0x20;
    local_28 = (DNameNode *)0x0;
    local_20 = 0;
    FUN_18006748c((longlong *)&local_28,(char *)local_res18,1);
    FUN_180066208(&local_28,(DNameNode **)&local_38,param_2);
    FUN_1800662e4(&local_48,(DNameNode **)&local_38);
  }
  *param_1 = (DNameStatusNode *)local_48;
  *(uint *)(param_1 + 1) = local_40;
  return param_1;
}



DNameStatusNode ** FUN_180067f48(DNameStatusNode **param_1)

{
  FUN_180068bd8(param_1,'\0');
  return param_1;
}



DNameStatusNode ** FUN_180067f64(DNameStatusNode **param_1)

{
  char cVar1;
  uint uVar2;
  char *pcVar3;
  DNameStatusNode *local_18;
  undefined4 local_10;

  if (*DAT_1800b1fe8 == '\0') {
    FUN_180065ae8(param_1,1);
    return param_1;
  }
  cVar1 = *DAT_1800b1fe8;
  DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
  if (0x10 < (int)cVar1 - 0x41U) {
    *(undefined4 *)(param_1 + 1) = 0;
    *(undefined *)(param_1 + 1) = 2;
    *param_1 = (DNameStatusNode *)0x0;
    return param_1;
  }
  local_18 = (DNameStatusNode *)0x0;
  local_10 = 2;
  if ((~(DAT_1800b2004 >> 1) & 1) != 0) {
    uVar2 = (int)cVar1 - 0x41U & 0xfffffffe;
    if (uVar2 == 0) {
      pcVar3 = "__cdecl";
    }
    else {
      if (uVar2 == 2) {
        pcVar3 = "__pascal";
      }
      else {
        if (uVar2 == 4) {
          pcVar3 = "__thiscall";
        }
        else {
          if (uVar2 == 6) {
            pcVar3 = "__stdcall";
          }
          else {
            if (uVar2 == 8) {
              pcVar3 = "__fastcall";
            }
            else {
              if (uVar2 == 0xc) {
                pcVar3 = "__clrcall";
              }
              else {
                if (uVar2 == 0xe) {
                  pcVar3 = "__eabi";
                }
                else {
                  if (uVar2 != 0x10) goto LAB_18006803f;
                  pcVar3 = "__vectorcall";
                }
              }
            }
          }
        }
      }
    }
    if ((~DAT_1800b2004 & 1) == 0) {
      pcVar3 = pcVar3 + 2;
    }
    FUN_180065ed0((longlong *)&local_18,pcVar3);
  }
LAB_18006803f:
  *param_1 = local_18;
  *(undefined4 *)(param_1 + 1) = local_10;
  return param_1;
}



// WARNING: Could not reconcile some variable overlaps

DNameStatusNode **
FUN_180068078(DNameStatusNode **param_1,DNameNode **param_2,char *param_3,DNameNode **param_4,
             int param_5)

{
  char cVar1;
  int iVar2;
  longlong *plVar3;
  DNameNode **ppDVar4;
  DNameStatusNode **ppDVar5;
  uint uVar6;
  uint uVar7;
  DNameNode *pDVar8;
  char *pcVar9;
  char *local_res18;
  char local_e8 [8];
  char local_e0 [8];
  DNameNode *local_d8;
  uint local_d0;
  char local_c8;
  DNameStatusNode *local_c0;
  undefined4 local_b8;
  DNameNode *local_b0;
  uint local_a8;
  DNameNode *local_a0 [2];
  DNameNode *local_90;
  undefined4 local_88;
  DNameNode *local_80 [2];
  longlong local_70 [2];
  DNameNode *local_60 [2];
  longlong local_50 [2];
  undefined8 local_40 [3];

  pDVar8 = (DNameNode *)0x0;
  local_b0 = (DNameNode *)0x0;
  local_a8 = 0;
  local_e0[0] = '\0';
  local_res18 = param_3;
  if (*DAT_1800b1fe8 == '\0') {
    if (param_5 == 0) {
      if (*param_2 == (DNameNode *)0x0) {
        if (*param_4 == (DNameNode *)0x0) goto LAB_1800687ec;
        ppDVar4 = (DNameNode **)FUN_180065ae8((DNameStatusNode **)local_a0,1);
      }
      else {
        if (((*(uint *)(param_2 + 1) & 0x100) == 0) && (*param_4 != (DNameNode *)0x0)) {
          ppDVar5 = FUN_180065ae8((DNameStatusNode **)local_a0,1);
          FUN_180066208((DNameNode **)ppDVar5,&local_b0,param_4);
          ppDVar4 = (DNameNode **)FUN_180066234((longlong *)&local_b0,(longlong *)local_80,' ');
          param_4 = param_2;
        }
        else {
          ppDVar4 = (DNameNode **)FUN_180065ae8((DNameStatusNode **)local_a0,1);
          param_4 = param_2;
        }
      }
      FUN_180066208(ppDVar4,(DNameNode **)param_1,param_4);
      return param_1;
    }
LAB_1800687ec:
    FUN_180065ae8(param_1,1);
    return param_1;
  }
  if ((*DAT_1800b1fe8 != '$') ||
     (FUN_18006901c(&local_c0,&local_res18,local_e0,param_5), local_c0 == (DNameStatusNode *)0x0)) {
    local_90 = (DNameNode *)0x0;
    local_88 = 0;
    local_b8 = 0;
    local_c8 = '\0';
    local_e8[0] = '\0';
    local_c0 = (DNameStatusNode *)0x0;
    iVar2 = 0x16;
    if ('@' < *DAT_1800b1fe8) {
      iVar2 = 0x41;
    }
    uVar6 = *DAT_1800b1fe8 - iVar2;
    uVar7 = DAT_1800b2004;
    do {
      pcVar9 = local_res18;
      if (uVar6 == 4) {
        if ((~((DAT_1800b2004 >> 0x10 | uVar7) >> 1) & 1) != 0) {
          if (pDVar8 == (DNameNode *)0x0) {
            pcVar9 = "__ptr64";
LAB_1800682ac:
            if ((~uVar7 & 1) == 0) {
              pcVar9 = pcVar9 + 2;
            }
            FUN_180065ed0((longlong *)&local_90,pcVar9);
            pDVar8 = local_90;
            uVar7 = DAT_1800b2004;
          }
          else {
            pcVar9 = "__ptr64";
            if ((~uVar7 & 1) == 0) {
              pcVar9 = "ptr64";
            }
            plVar3 = FUN_180066234((longlong *)&local_90,(longlong *)local_80,' ');
            ppDVar4 = local_a0;
LAB_18006819d:
            ppDVar4 = (DNameNode **)FUN_18006628c(plVar3,ppDVar4,pcVar9);
            pDVar8 = *ppDVar4;
            local_88 = *(undefined4 *)(ppDVar4 + 1);
            uVar7 = DAT_1800b2004;
            local_90 = pDVar8;
          }
        }
      }
      else {
        if (uVar6 == 5) {
          if ((~(uVar7 >> 1) & 1) != 0) {
            if (local_c0 == (DNameStatusNode *)0x0) {
              pcVar9 = "__unaligned";
              if ((~uVar7 & 1) == 0) {
                pcVar9 = "unaligned";
              }
              FUN_180065ed0((longlong *)&local_c0,pcVar9);
              uVar7 = DAT_1800b2004;
            }
            else {
              pcVar9 = "__unaligned";
              if ((~uVar7 & 1) == 0) {
                pcVar9 = "unaligned";
              }
              plVar3 = FUN_180066234((longlong *)&local_c0,local_50,' ');
              ppDVar5 = (DNameStatusNode **)FUN_18006628c(plVar3,local_40,pcVar9);
              local_c0 = *ppDVar5;
              local_b8 = *(undefined4 *)(ppDVar5 + 1);
              uVar7 = DAT_1800b2004;
            }
          }
        }
        else {
          if (uVar6 == 6) {
            if (param_5 == 0) {
LAB_180068754:
              *(undefined4 *)(param_1 + 1) = 0;
              *(undefined *)(param_1 + 1) = 2;
              *param_1 = (DNameStatusNode *)0x0;
              return param_1;
            }
            local_c8 = '\x01';
          }
          else {
            if (uVar6 == 7) {
              if (param_5 == 0) goto LAB_180068754;
              local_e8[0] = '\x01';
            }
            else {
              if (uVar6 != 8) {
                if (*DAT_1800b1fe8 != '\0') {
                  DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
                }
                if (0x1f < uVar6) goto LAB_180068754;
                FUN_180065aa8((longlong *)&local_d8,local_res18);
                ppDVar4 = FUN_180066208(&local_b0,local_a0,&local_d8);
                local_d8 = *ppDVar4;
                local_d0 = *(uint *)(ppDVar4 + 1);
                if (pDVar8 != (DNameNode *)0x0) {
                  ppDVar4 = (DNameNode **)
                            FUN_180066234((longlong *)&local_d8,(longlong *)local_a0,' ');
                  ppDVar4 = FUN_180066208(ppDVar4,local_80,&local_90);
                  local_d8 = *ppDVar4;
                  local_d0 = *(uint *)(ppDVar4 + 1);
                }
                if (local_c0 != (DNameStatusNode *)0x0) {
                  ppDVar4 = (DNameNode **)
                            FUN_180066234((longlong *)&local_c0,(longlong *)local_a0,' ');
                  ppDVar4 = FUN_180066208(ppDVar4,local_80,&local_d8);
                  local_d8 = *ppDVar4;
                  local_d0 = *(uint *)(ppDVar4 + 1);
                }
                uVar7 = local_d0;
                iVar2 = param_5;
                if ((uVar6 & 0x10) != 0) {
                  if (param_5 != 0) {
                    *(undefined4 *)(param_1 + 1) = 0;
                    *param_1 = (DNameStatusNode *)0x0;
                    *(undefined *)(param_1 + 1) = 2;
                    return param_1;
                  }
                  if (*pcVar9 == '\0') {
                    if (*DAT_1800b1fe8 != '\0') {
                      ppDVar5 = FUN_18006a920((DNameStatusNode **)local_a0);
                      if (((char)local_d0 != '\x03') && ('\x01' < *(char *)(ppDVar5 + 1))) {
                        uVar7 = uVar7 & 0xffffff00 | (uint)*(byte *)(ppDVar5 + 1);
                        local_d0 = uVar7;
                      }
                      goto LAB_1800684d0;
                    }
                  }
                  else {
                    ppDVar4 = (DNameNode **)FUN_180065aa8((longlong *)local_a0,"::");
                    FUN_180066208(ppDVar4,&local_b0,&local_d8);
                    local_d8 = local_b0;
                    local_d0 = local_a8;
                    if (*DAT_1800b1fe8 == '\0') {
                      ppDVar5 = FUN_180065ae8((DNameStatusNode **)local_a0,1);
                      FUN_180066208((DNameNode **)ppDVar5,&local_b0,&local_d8);
                      local_d8 = local_b0;
                      uVar7 = local_a8;
                      local_d0 = local_a8;
                    }
                    else {
                      ppDVar5 = FUN_18006a920((DNameStatusNode **)local_a0);
                      ppDVar4 = FUN_180066208((DNameNode **)ppDVar5,local_80,&local_d8);
                      local_d8 = *ppDVar4;
                      uVar7 = *(uint *)(ppDVar4 + 1);
                      local_d0 = *(uint *)(ppDVar4 + 1);
                    }
LAB_1800684d0:
                    cVar1 = *DAT_1800b1fe8;
                    if (cVar1 != '\0') {
                      DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
                      if (cVar1 != '@') goto LAB_1800684ec;
                      goto LAB_180068513;
                    }
                  }
                  DName::operator__((DName *)&local_d8,1);
                  uVar7 = local_d0;
                }
LAB_180068513:
                if ((~(DAT_1800b2004 >> 1) & 1) == 0) {
                  if (((byte)uVar6 & 0xc) == 0xc) {
                    ppDVar4 = FUN_180067a20(local_a0);
                    if (((char)local_d0 != '\x03') && ('\x01' < *(char *)(ppDVar4 + 1))) {
                      uVar7 = uVar7 & 0xffffff00 | (uint)*(byte *)(ppDVar4 + 1);
                      local_d0 = uVar7;
                    }
                  }
                }
                else {
                  if (((byte)uVar6 & 0xc) == 0xc) {
                    if (iVar2 != 0) {
LAB_1800684ec:
                      *(undefined4 *)(param_1 + 1) = 0;
                      *(undefined *)(param_1 + 1) = 2;
                      *param_1 = (DNameStatusNode *)0x0;
                      return param_1;
                    }
                    ppDVar4 = FUN_180067a20(local_a0);
                    ppDVar4 = FUN_180066208(ppDVar4,local_80,&local_d8);
                    local_d8 = *ppDVar4;
                    uVar7 = *(uint *)(ppDVar4 + 1);
                    local_d0 = uVar7;
                  }
                }
                if ((uVar6 & 2) != 0) {
                  ppDVar4 = (DNameNode **)FUN_180065aa8((longlong *)local_a0,"volatile ");
                  FUN_180066208(ppDVar4,&local_b0,&local_d8);
                  local_d8 = local_b0;
                  local_d0 = local_a8;
                  uVar7 = local_a8;
                }
                if ((uVar6 & 1) != 0) {
                  ppDVar4 = (DNameNode **)FUN_180065aa8((longlong *)local_a0,"const ");
                  FUN_180066208(ppDVar4,&local_b0,&local_d8);
                  local_d8 = local_b0;
                  local_d0 = local_a8;
                  uVar7 = local_a8;
                }
                if (local_c8 != '\0') {
                  ppDVar4 = (DNameNode **)FUN_18006628c(&local_d8,local_a0,"& ");
                  local_d8 = *ppDVar4;
                  uVar7 = *(uint *)(ppDVar4 + 1);
                  local_d0 = uVar7;
                }
                if (local_e8[0] != '\0') {
                  ppDVar4 = (DNameNode **)FUN_18006628c(&local_d8,local_a0,"&& ");
                  local_d8 = *ppDVar4;
                  uVar7 = *(uint *)(ppDVar4 + 1);
                  local_d0 = uVar7;
                }
                pDVar8 = local_d8;
                if (iVar2 != 0) goto LAB_180068737;
                if (*param_2 == (DNameNode *)0x0) {
                  if (*param_4 == (DNameNode *)0x0) goto LAB_180068737;
                  local_e8[0] = ' ';
                  local_c0 = (DNameStatusNode *)0x0;
                  local_b8 = 0;
                  FUN_18006748c((longlong *)&local_c0,local_e8,1);
                  param_2 = param_4;
LAB_180068719:
                  FUN_180066208((DNameNode **)&local_c0,&local_b0,param_2);
                  ppDVar4 = &local_b0;
                }
                else {
                  uVar7 = *(uint *)(param_2 + 1);
                  if (((uVar7 & 0x100) != 0) || (*param_4 == (DNameNode *)0x0)) {
                    pDVar8 = *param_2;
                    if ((uVar7 >> 0xb & 1) != 0) goto LAB_180068737;
                    local_e8[0] = ' ';
                    local_c0 = (DNameStatusNode *)0x0;
                    local_b8 = 0;
                    FUN_18006748c((longlong *)&local_c0,local_e8,1);
                    goto LAB_180068719;
                  }
                  local_e8[0] = ' ';
                  local_c0 = (DNameStatusNode *)0x0;
                  local_b8 = 0;
                  FUN_18006748c((longlong *)&local_c0,local_e8,1);
                  FUN_180066208((DNameNode **)&local_c0,&local_b0,param_4);
                  ppDVar4 = (DNameNode **)
                            FUN_180066234((longlong *)&local_b0,(longlong *)local_a0,' ');
                  ppDVar4 = FUN_180066208(ppDVar4,local_80,param_2);
                }
                FUN_1800662e4(&local_d8,ppDVar4);
                uVar7 = local_d0;
                pDVar8 = local_d8;
LAB_180068737:
                local_d8 = pDVar8;
                uVar6 = uVar7 | 0x100;
                if (local_e0[0] != '\0') {
                  uVar6 = uVar7 | 0x2100;
                }
                *param_1 = (DNameStatusNode *)local_d8;
                *(uint *)(param_1 + 1) = uVar6;
                return param_1;
              }
              if ((~(uVar7 >> 1) & 1) != 0) {
                if (pDVar8 == (DNameNode *)0x0) {
                  pcVar9 = "__restrict";
                  goto LAB_1800682ac;
                }
                pcVar9 = "__restrict";
                if ((~uVar7 & 1) == 0) {
                  pcVar9 = "restrict";
                }
                plVar3 = FUN_180066234((longlong *)&local_90,local_70,' ');
                ppDVar4 = local_60;
                goto LAB_18006819d;
              }
            }
          }
        }
      }
      DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
      if ((*DAT_1800b1fe8 == '$') &&
         (FUN_18006901c((DNameStatusNode **)&local_d8,&local_res18,local_e0,param_5),
         uVar7 = DAT_1800b2004, local_d8 != (DNameNode *)0x0)) goto LAB_180068763;
      iVar2 = 0x16;
      if ('@' < *DAT_1800b1fe8) {
        iVar2 = 0x41;
      }
      uVar6 = *DAT_1800b1fe8 - iVar2;
    } while( true );
  }
  *param_1 = local_c0;
  goto LAB_1800680f0;
LAB_180068763:
  *param_1 = (DNameStatusNode *)local_d8;
  local_b8 = local_d0;
LAB_1800680f0:
  *(undefined4 *)(param_1 + 1) = local_b8;
  return param_1;
}



DNameStatusNode ** FUN_18006885c(DNameStatusNode **param_1,undefined8 *param_2)

{
  DNameNode **ppDVar1;
  DNameStatusNode **ppDVar2;
  DNameStatusNode *local_38;
  undefined4 local_30;
  DNameNode *local_28;
  undefined4 local_20;
  DNameStatusNode *local_18 [2];

  FUN_180065a24(&local_38,param_2);
  if (*DAT_1800b1fe8 == '\0') {
    ppDVar1 = (DNameNode **)FUN_180065ae8(local_18,1);
LAB_18006891e:
    FUN_180066208(ppDVar1,(DNameNode **)param_1,(DNameNode **)&local_38);
  }
  else {
    if (*DAT_1800b1fe8 == '?') {
      DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
      local_28 = (DNameNode *)0x0;
      local_20 = 0;
      ppDVar2 = FUN_180068078(local_18,(DNameNode **)&local_38,"",&local_28,0);
      local_38 = *ppDVar2;
      local_30 = *(undefined4 *)(ppDVar2 + 1);
    }
    else {
      if (*DAT_1800b1fe8 == 'X') {
        DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
        if (local_38 == (DNameStatusNode *)0x0) {
          FUN_180065aa8((longlong *)param_1,"void");
          return param_1;
        }
        ppDVar1 = (DNameNode **)FUN_180065aa8((longlong *)&local_28,"void ");
        goto LAB_18006891e;
      }
    }
    FUN_18006a2b8(param_1,&local_38);
  }
  return param_1;
}



// WARNING: Could not reconcile some variable overlaps

DNameNode ** FUN_18006893c(DNameNode **param_1)

{
  bool bVar1;
  byte *pbVar2;
  longlong **pplVar3;
  DNameStatusNode **ppDVar4;
  DNameNode **ppDVar5;
  uint uVar6;
  DNameNode **ppDVar7;
  uint uVar8;
  longlong *local_48;
  uint local_40;
  DNameStatusNode *local_38;
  undefined4 local_30;
  DNameNode *local_28 [2];
  DNameNode *local_18 [2];

  if ((DAT_1800b2004 >> 0xd & 1) != 0) {
    DAT_1800b2004 = DAT_1800b2004 & 0xffffdfff;
    FUN_18006885c(&local_38,(undefined8 *)0x0);
    DAT_1800b2004 = DAT_1800b2004 | 0x2000;
LAB_18006897a:
    *param_1 = (DNameNode *)local_38;
    *(undefined4 *)(param_1 + 1) = local_30;
    return param_1;
  }
  if (*DAT_1800b1fe8 != 0x3f) {
    if (*DAT_1800b1fe8 == 0) {
      FUN_180065ae8((DNameStatusNode **)param_1,1);
      return param_1;
    }
    goto LAB_180068b59;
  }
  pbVar2 = DAT_1800b1fe8 + 1;
  if (*pbVar2 == 0x3f) {
    DAT_1800b1fe8 = DAT_1800b1fe8 + 2;
    if (*DAT_1800b1fe8 == 0x3f) {
      DAT_1800b1fe8 = pbVar2;
      FUN_18006893c((DNameNode **)&local_38);
      while (*DAT_1800b1fe8 != 0) {
        DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
      }
      goto LAB_18006897a;
    }
    if (*DAT_1800b1fe8 == 0x24) {
      DAT_1800b1fe8 = pbVar2;
      FUN_18006ba18(&local_48,'\x01');
    }
    else {
      FUN_180069ae4(&local_48,'\0',(undefined *)0x0);
    }
  }
  else {
    DAT_1800b1fe8 = pbVar2;
    FUN_18006c314(&local_48,'\x01','\0');
  }
  uVar8 = local_40;
  if ((local_48 == (longlong *)0x0) || ((local_40 >> 9 & 1) == 0)) {
    bVar1 = false;
  }
  else {
    bVar1 = true;
  }
  uVar6 = local_40 >> 0xf;
  if ((char)local_40 < '\x02') {
    if (((*DAT_1800b1fe8 & 0xbf) != 0) &&
       (FUN_18006a920(&local_38), local_38 != (DNameStatusNode *)0x0)) {
      if (DAT_1800b2008 == '\0') {
        ppDVar5 = (DNameNode **)FUN_18006628c(&local_38,local_18,"::");
        ppDVar7 = local_28;
      }
      else {
        DAT_1800b2008 = '\0';
        pplVar3 = (longlong **)
                  FUN_180066208((DNameNode **)&local_48,local_28,(DNameNode **)&local_38);
        local_48 = *pplVar3;
        uVar8 = *(uint *)(pplVar3 + 1);
        local_40 = uVar8;
        if (*DAT_1800b1fe8 == 0x40) goto LAB_180068b0d;
        ppDVar4 = FUN_18006a920((DNameStatusNode **)local_28);
        local_38 = *ppDVar4;
        local_30 = *(undefined4 *)(ppDVar4 + 1);
        ppDVar5 = (DNameNode **)FUN_18006628c(&local_38,local_28,"::");
        ppDVar7 = local_18;
      }
      pplVar3 = (longlong **)FUN_180066208(ppDVar5,ppDVar7,(DNameNode **)&local_48);
      local_48 = *pplVar3;
      uVar8 = *(uint *)(pplVar3 + 1);
      local_40 = uVar8;
    }
LAB_180068b0d:
    if ((bVar1) && (local_48 != (longlong *)0x0)) {
      uVar8 = uVar8 | 0x200;
      local_40 = uVar8;
    }
    if ((uVar6 & 1) != 0) {
      uVar8 = uVar8 | 0x8000;
      local_40 = uVar8;
    }
    if ((local_48 != (longlong *)0x0) && ((uVar8 & 0x1000) == 0)) {
      if (*DAT_1800b1fe8 != 0) {
        if (*DAT_1800b1fe8 != 0x40) {
LAB_180068b59:
          *(undefined4 *)(param_1 + 1) = 0;
          *param_1 = (DNameNode *)0x0;
          *(undefined *)(param_1 + 1) = 2;
          return param_1;
        }
        DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
      }
      if ((((DAT_1800b2004 & 0x1000) == 0) || (bVar1)) || ((uVar8 & 0x8000) != 0)) {
        FUN_180066680(param_1,(DNameNode **)&local_48);
        return param_1;
      }
      local_38 = (DNameStatusNode *)0x0;
      local_30 = 0;
      FUN_180066680(local_18,(DNameNode **)&local_38);
      *param_1 = (DNameNode *)local_48;
      goto LAB_180068a3d;
    }
  }
  *param_1 = (DNameNode *)local_48;
LAB_180068a3d:
  *(uint *)(param_1 + 1) = uVar8;
  return param_1;
}



DNameStatusNode ** FUN_180068bd8(DNameStatusNode **param_1,char param_2)

{
  char cVar1;
  DNameNode **ppDVar2;
  DNameNode **ppDVar3;
  DNameStatusNode **ppDVar4;
  longlong *plVar5;
  char *pcVar6;
  char *pcVar7;
  DNameNode *local_48 [2];
  longlong local_38 [2];
  longlong local_28 [2];
  longlong local_18 [2];

  pcVar6 = (char *)0x0;
  pcVar7 = pcVar6;
  if (*DAT_1800b1fe8 == 'Q') {
    DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
    pcVar7 = "`non-type-template-parameter";
  }
  cVar1 = *DAT_1800b1fe8;
  if (cVar1 == '\0') {
LAB_180068c24:
    FUN_180065ae8(param_1,1);
    return param_1;
  }
  if ((byte)(cVar1 - 0x30U) < 10) {
    DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
    pcVar6 = (char *)(longlong)(cVar1 + -0x2f);
    if (pcVar7 != (char *)0x0) {
      plVar5 = local_38;
LAB_180068ce2:
      ppDVar2 = (DNameNode **)FUN_180065be4(plVar5,(ulonglong)pcVar6);
LAB_180068ce7:
      ppDVar3 = (DNameNode **)FUN_180065aa8(local_28,pcVar7);
      FUN_180066208(ppDVar3,local_48,ppDVar2);
      ppDVar4 = (DNameStatusNode **)local_48;
      goto LAB_180068d14;
    }
    plVar5 = local_18;
  }
  else {
    while (cVar1 != '@') {
      if (cVar1 == '\0') goto LAB_180068c24;
      if (0xf < (byte)(cVar1 + 0xbfU)) goto LAB_180068cc1;
      pcVar6 = (char *)((longlong)(cVar1 + -0x41) + (longlong)pcVar6 * 0x10);
      DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
      cVar1 = *DAT_1800b1fe8;
    }
    cVar1 = *DAT_1800b1fe8;
    DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
    if (cVar1 != '@') {
LAB_180068cc1:
      *(undefined4 *)(param_1 + 1) = 0;
      *(undefined *)(param_1 + 1) = 2;
      *param_1 = (DNameStatusNode *)0x0;
      return param_1;
    }
    if (param_2 != '\0') {
      if (pcVar7 == (char *)0x0) {
        ppDVar4 = (DNameStatusNode **)FUN_180065b40(local_38,(ulonglong)pcVar6);
        goto LAB_180068d14;
      }
      ppDVar2 = (DNameNode **)FUN_180065b40(local_18,(ulonglong)pcVar6);
      goto LAB_180068ce7;
    }
    if (pcVar7 != (char *)0x0) {
      plVar5 = local_18;
      goto LAB_180068ce2;
    }
    plVar5 = local_38;
  }
  ppDVar4 = (DNameStatusNode **)FUN_180065be4(plVar5,(ulonglong)pcVar6);
LAB_180068d14:
  *param_1 = *ppDVar4;
  *(undefined4 *)(param_1 + 1) = *(undefined4 *)(ppDVar4 + 1);
  return param_1;
}



undefined8 * FUN_180068d3c(undefined8 *param_1)

{
  char *pcVar1;

  if (((*DAT_1800b1fe8 == '_') && (DAT_1800b1fe8[1] == '_')) &&
     (pcVar1 = DAT_1800b1fe8 + 2, DAT_1800b1fe8 = DAT_1800b1fe8 + 3, 3 < (int)*pcVar1 - 0x41U)) {
    *(undefined4 *)(param_1 + 1) = 0;
    *param_1 = 0;
    *(undefined *)(param_1 + 1) = 2;
    return param_1;
  }
  *param_1 = 0;
  *(undefined4 *)(param_1 + 1) = 0;
  return param_1;
}



DNameNode ** FUN_180068da4(DNameNode **param_1)

{
  char cVar1;
  DNameStatusNode **ppDVar2;
  DNameNode **ppDVar3;
  char *pcVar4;
  uint uVar5;
  uint uVar6;
  DNameNode *local_48;
  undefined4 local_40;
  DNameNode *local_38;
  undefined4 local_30;
  DNameStatusNode *local_28 [2];
  longlong local_18 [2];

  uVar6 = ~(DAT_1800b2004 >> 0xf) & 1;
  if ((uVar6 == 0) || ((DAT_1800b2004 >> 0xc & 1) != 0)) {
    uVar5 = 0;
  }
  else {
    uVar5 = 1;
  }
  local_48 = (DNameNode *)0x0;
  local_40 = 0;
  cVar1 = *(char *)DAT_1800b1fe8;
  ppDVar3 = (DNameNode **)((longlong)DAT_1800b1fe8 + 1);
  if (cVar1 == '\0') {
    FUN_180065aa8((longlong *)param_1,"unknown ecsu\'");
    return param_1;
  }
  DAT_1800b1fe8 = ppDVar3;
  if (cVar1 == 'T') {
    pcVar4 = "union ";
  }
  else {
    if (cVar1 == 'U') {
      pcVar4 = "struct ";
    }
    else {
      if (cVar1 == 'V') {
        pcVar4 = "class ";
      }
      else {
        if (cVar1 == 'W') {
          ppDVar2 = FUN_180068f24(local_28);
          ppDVar3 = (DNameNode **)FUN_180065aa8(local_18,"enum ");
          pcVar4 = (char *)&local_38;
          FUN_180066208(ppDVar3,(DNameNode **)pcVar4,(DNameNode **)ppDVar2);
          local_48 = local_38;
          local_40 = local_30;
          goto LAB_180068e98;
        }
        if (cVar1 == 'X') {
          pcVar4 = "coclass ";
        }
        else {
          pcVar4 = (char *)ppDVar3;
          uVar6 = uVar5;
          if (cVar1 != 'Y') goto LAB_180068e98;
          pcVar4 = "cointerface ";
        }
      }
    }
  }
  FUN_180065ed0((longlong *)&local_48,pcVar4);
  uVar6 = uVar5;
LAB_180068e98:
  local_38 = (DNameNode *)0x0;
  local_30 = 0;
  if (uVar6 != 0) {
    local_38 = local_48;
    local_30 = local_40;
  }
  FUN_18006ad98((DNameStatusNode **)&local_48,pcVar4);
  FUN_1800662e4(&local_38,&local_48);
  *param_1 = local_38;
  *(undefined4 *)(param_1 + 1) = local_30;
  return param_1;
}



DNameStatusNode ** FUN_180068f0c(DNameStatusNode **param_1,undefined8 param_2)

{
  FUN_18006ad98(param_1,param_2);
  return param_1;
}



DNameStatusNode ** FUN_180068f24(DNameStatusNode **param_1)

{
  char cVar1;
  DNameNode **ppDVar2;
  char *pcVar3;
  DNameStatusNode *local_38;
  undefined4 local_30;
  DNameStatusNode *local_28;
  undefined4 local_20;
  longlong local_18 [2];

  local_38 = (DNameStatusNode *)0x0;
  local_30 = 0;
  if (*DAT_1800b1fe8 == '\0') {
    FUN_180065ae8(param_1,1);
    return param_1;
  }
  cVar1 = *DAT_1800b1fe8;
  if (cVar1 < '0') {
LAB_180068ff3:
    *(undefined4 *)(param_1 + 1) = 0;
    *(undefined *)(param_1 + 1) = 2;
    *param_1 = (DNameStatusNode *)0x0;
    return param_1;
  }
  if (cVar1 < '2') {
    pcVar3 = "char ";
  }
  else {
    if (cVar1 < '4') {
      pcVar3 = "short ";
    }
    else {
      if (cVar1 == '4') goto LAB_180068f9b;
      if (cVar1 == '5') {
        pcVar3 = "int ";
      }
      else {
        if (1 < (byte)(cVar1 - 0x36U)) goto LAB_180068ff3;
        pcVar3 = "long ";
      }
    }
  }
  FUN_180065ed0((longlong *)&local_38,pcVar3);
LAB_180068f9b:
  cVar1 = *DAT_1800b1fe8;
  DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
  if (((int)cVar1 - 0x31U & 0xfffffff9) == 0) {
    ppDVar2 = (DNameNode **)FUN_180065aa8(local_18,"unsigned ");
    FUN_180066208(ppDVar2,(DNameNode **)&local_28,(DNameNode **)&local_38);
    local_38 = local_28;
    local_30 = local_20;
  }
  *param_1 = local_38;
  *(undefined4 *)(param_1 + 1) = local_30;
  return param_1;
}



DNameStatusNode **
FUN_18006901c(DNameStatusNode **param_1,char **param_2,undefined *param_3,int param_4)

{
  char *pcVar1;
  DNameNode **ppDVar2;
  DNameStatusNode **ppDVar3;
  char *pcVar4;
  uint uVar5;
  int iVar6;
  char local_48 [8];
  DNameStatusNode *local_40;
  uint local_38;
  longlong local_30 [2];
  DNameNode *local_20 [3];

  local_40 = (DNameStatusNode *)0x0;
  local_38 = 0;
  pcVar4 = (char *)((longlong)DAT_1800b1fe8 + 1);
  iVar6 = (int)*pcVar4;
  if (iVar6 == 0x41) {
    DAT_1800b1fe8 = pcVar4;
    if (param_4 == 0) {
      if (**param_2 == '&') {
        *param_2 = "%";
      }
      if (**param_2 == '*') {
        *param_2 = "^";
      }
    }
LAB_18006921f:
    DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
    *(undefined4 *)(param_1 + 1) = 0;
  }
  else {
    if (iVar6 == 0x42) {
      if (param_4 == 0) {
        DAT_1800b1fe8 = pcVar4;
        *param_3 = 1;
        local_48[0] = '>';
        local_40 = (DNameStatusNode *)0x0;
        local_38 = 0;
        FUN_18006748c((longlong *)&local_40,local_48,1);
        goto LAB_18006921f;
      }
    }
    else {
      if (iVar6 == 0x43) {
        DAT_1800b1fe8 = pcVar4;
        *param_2 = "%";
        goto LAB_18006921f;
      }
      if ((*pcVar4 == '\0') || (pcVar1 = (char *)((longlong)DAT_1800b1fe8 + 2), *pcVar1 == '\0')) {
        DAT_1800b1fe8 = pcVar4;
        FUN_180065ae8(param_1,1);
        return param_1;
      }
      if (param_4 == 0) {
        DAT_1800b1fe8 = (char *)((longlong)DAT_1800b1fe8 + 3);
        uVar5 = *pcVar1 + -0x330 + iVar6 * 0x10;
        if (1 < uVar5) {
          local_48[0] = ',';
          local_40 = (DNameStatusNode *)0x0;
          local_38 = 0;
          FUN_18006748c((longlong *)&local_40,local_48,1);
          ppDVar2 = (DNameNode **)FUN_180065be4(local_30,(ulonglong)uVar5);
          ppDVar2 = FUN_180066208((DNameNode **)&local_40,local_20,ppDVar2);
          local_40 = (DNameStatusNode *)*ppDVar2;
          local_38 = *(uint *)(ppDVar2 + 1);
        }
        ppDVar3 = (DNameStatusNode **)FUN_180066234((longlong *)&local_40,(longlong *)local_20,'>');
        local_40 = *ppDVar3;
        local_38 = *(uint *)(ppDVar3 + 1);
        if (*DAT_1800b1fe8 == '$') {
          DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
        }
        else {
          ppDVar3 = (DNameStatusNode **)
                    FUN_180066234((longlong *)&local_40,(longlong *)local_20,'^');
          local_40 = *ppDVar3;
          local_38 = *(uint *)(ppDVar3 + 1);
        }
        if (*DAT_1800b1fe8 == '\0') {
          DName::operator__((DName *)&local_40,1);
        }
        else {
          DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
        }
        *param_1 = local_40;
        *(uint *)(param_1 + 1) = local_38 | 0x4000;
        return param_1;
      }
    }
    DAT_1800b1fe8 = pcVar4;
    *(undefined4 *)(param_1 + 1) = 0;
    *(undefined *)(param_1 + 1) = 2;
  }
  *param_1 = (DNameStatusNode *)0x0;
  return param_1;
}



DNameStatusNode ** FUN_180069244(DNameStatusNode **param_1,DNameNode **param_2)

{
  DNameNode **ppDVar1;
  DNameNode **ppDVar2;
  DNameNode *local_58;
  undefined4 local_50;
  DNameNode *local_48;
  undefined4 local_40;
  DNameStatusNode *local_38 [2];
  longlong local_28 [2];
  DNameNode *local_18 [2];

  ppDVar1 = (DNameNode **)_HeapManager::getMemory((_HeapManager *)&DAT_1800b2018,0x10,0);
  if (ppDVar1 == (DNameNode **)0x0) {
    ppDVar1 = (DNameNode **)0x0;
  }
  else {
    *ppDVar1 = (DNameNode *)0x0;
    *(undefined4 *)(ppDVar1 + 1) = 0;
  }
  FUN_18006885c(param_1,ppDVar1);
  local_58 = (DNameNode *)0x0;
  local_50 = 0;
  local_48 = (DNameNode *)0x0;
  local_40 = 0;
  FUN_180068078(local_38,&local_48,"",&local_58,0);
  ppDVar2 = (DNameNode **)FUN_180066234((longlong *)local_38,local_28,' ');
  ppDVar2 = FUN_180066208(ppDVar2,local_18,param_2);
  *ppDVar1 = *ppDVar2;
  *(undefined4 *)(ppDVar1 + 1) = *(undefined4 *)(ppDVar2 + 1);
  return param_1;
}



// WARNING: Could not reconcile some variable overlaps

DNameNode ** FUN_18006930c(DNameNode **param_1,DNameNode **param_2)

{
  DNameNode **ppDVar1;
  DNameNode **ppDVar2;
  DNameStatusNode **ppDVar3;
  longlong *plVar4;
  char *pcVar5;
  uint uVar6;
  uint uVar7;
  char local_res18 [8];
  DNameNode *local_98;
  uint local_90;
  DNameStatusNode *local_88;
  uint local_80;
  DNameNode *local_78;
  uint local_70;
  DNameStatusNode *local_68;
  undefined4 local_60;
  DNameStatusNode *local_58;
  uint local_50;
  DNameNode *local_48;
  undefined4 local_40;
  DNameNode *local_38 [2];

  ppDVar1 = (DNameNode **)0x0;
  pcVar5 = DAT_1800b1fe8;
  if (*DAT_1800b1fe8 == '\0') {
LAB_180069348:
    DAT_1800b1fe8 = pcVar5;
    ppDVar1 = (DNameNode **)FUN_180065ae8(&local_58,1);
LAB_180069354:
    FUN_180066208(ppDVar1,param_1,param_2);
    return param_1;
  }
  if (((byte)(*DAT_1800b1fe8 - 0x36U) < 4) || (*DAT_1800b1fe8 == '_')) {
    pcVar5 = DAT_1800b1fe8 + 1;
    uVar7 = (int)*DAT_1800b1fe8 - 0x36;
    if (uVar7 == 0x29) {
      if (*pcVar5 == '\0') goto LAB_180069348;
      DAT_1800b1fe8 = DAT_1800b1fe8 + 2;
      uVar7 = (int)*pcVar5 - 0x3d;
      if (3 < (int)*pcVar5 - 0x41U) {
        uVar7 = 0xffffffff;
      }
    }
    else {
      DAT_1800b1fe8 = pcVar5;
      if (3 < uVar7) {
        uVar7 = 0xffffffff;
      }
    }
    if (uVar7 != 0xffffffff) {
      local_98 = *param_2;
      uVar6 = *(uint *)(param_2 + 1);
      local_88 = (DNameStatusNode *)0x0;
      local_80 = 0;
      local_90 = uVar6;
      if ((uVar7 & 2) != 0) {
        if (*DAT_1800b1fe8 == '@') {
          DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
        }
        else {
          ppDVar2 = (DNameNode **)FUN_180065aa8((longlong *)&local_58,"::");
          FUN_180066208(ppDVar2,&local_78,&local_98);
          local_98 = local_78;
          local_90 = local_70;
          if (*DAT_1800b1fe8 == '\0') {
            ppDVar3 = FUN_180065ae8((DNameStatusNode **)local_38,1);
            FUN_180066208((DNameNode **)ppDVar3,&local_78,&local_98);
            local_98 = local_78;
            uVar6 = local_70;
          }
          else {
            ppDVar3 = FUN_18006a920(&local_68);
            local_res18[0] = ' ';
            local_78 = (DNameNode *)0x0;
            local_70 = 0;
            FUN_18006748c((longlong *)&local_78,local_res18,1);
            FUN_180066208(&local_78,(DNameNode **)&local_58,(DNameNode **)ppDVar3);
            ppDVar2 = FUN_180066208((DNameNode **)&local_58,local_38,&local_98);
            local_98 = *ppDVar2;
            uVar6 = *(uint *)(ppDVar2 + 1);
          }
        }
        local_90 = uVar6;
        if (*DAT_1800b1fe8 == '\0') {
          ppDVar1 = (DNameNode **)FUN_180065ae8((DNameStatusNode **)local_38,1);
          param_2 = &local_98;
          goto LAB_180069354;
        }
        if (*DAT_1800b1fe8 != '@') goto LAB_180069371;
        DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
        local_68 = (DNameStatusNode *)0x0;
        local_60 = 0;
        if (((byte)DAT_1800b2004 & 0x60) == 0x60) {
          local_58 = (DNameStatusNode *)0x0;
          local_50 = 0;
          FUN_180068078((DNameStatusNode **)&local_78,(DNameNode **)&local_68,"",
                        (DNameNode **)&local_58,1);
          if ('\x01' < (char)local_70) {
            local_80 = local_70 & 0xff;
          }
        }
        else {
          local_78 = (DNameNode *)0x0;
          local_70 = 0;
          FUN_180068078(&local_58,(DNameNode **)&local_68,"",&local_78,1);
          local_88 = local_58;
          local_80 = local_50;
        }
      }
      if ((uVar7 & 4) != 0) {
        if ((~(byte)(DAT_1800b2004 >> 1) & 1) == 0) {
          ppDVar2 = FUN_180067a20(local_38);
          if (((char)local_90 != '\x03') && ('\x01' < *(char *)(ppDVar2 + 1))) {
            uVar6 = uVar6 & 0xffffff00 | (uint)*(byte *)(ppDVar2 + 1);
            local_90 = uVar6;
          }
        }
        else {
          ppDVar2 = FUN_180067a20(local_38);
          local_res18[0] = ' ';
          local_78 = (DNameNode *)0x0;
          local_70 = 0;
          FUN_18006748c((longlong *)&local_78,local_res18,1);
          FUN_180066208(&local_78,(DNameNode **)&local_58,ppDVar2);
          ppDVar2 = FUN_180066208((DNameNode **)&local_58,(DNameNode **)&local_68,&local_98);
          local_98 = *ppDVar2;
          uVar6 = *(uint *)(ppDVar2 + 1);
          local_90 = uVar6;
        }
      }
      if ((~(byte)(DAT_1800b2004 >> 1) & 1) == 0) {
        ppDVar3 = FUN_180067f64((DNameStatusNode **)local_38);
        if (((char)local_90 != '\x03') && ('\x01' < *(char *)(ppDVar3 + 1))) {
          local_90 = uVar6 & 0xffffff00 | (uint)*(byte *)(ppDVar3 + 1);
        }
      }
      else {
        ppDVar3 = FUN_180067f64((DNameStatusNode **)local_38);
        ppDVar2 = FUN_180066208((DNameNode **)ppDVar3,(DNameNode **)&local_58,&local_98);
        local_98 = *ppDVar2;
        local_90 = *(uint *)(ppDVar2 + 1);
      }
      if (*param_2 != (DNameNode *)0x0) {
        local_res18[0] = '(';
        local_78 = (DNameNode *)0x0;
        local_70 = 0;
        FUN_18006748c((longlong *)&local_78,local_res18,1);
        FUN_180066208(&local_78,(DNameNode **)&local_58,&local_98);
        ppDVar2 = (DNameNode **)FUN_180066234((longlong *)&local_58,(longlong *)local_38,')');
        local_98 = *ppDVar2;
        local_90 = *(uint *)(ppDVar2 + 1);
      }
      ppDVar2 = (DNameNode **)_HeapManager::getMemory((_HeapManager *)&DAT_1800b2018,0x10,0);
      if (ppDVar2 != (DNameNode **)0x0) {
        *ppDVar2 = (DNameNode *)0x0;
        *(undefined4 *)(ppDVar2 + 1) = 0;
        ppDVar1 = ppDVar2;
      }
      UnDecorator::getReturnType((DName *)&local_48);
      ppDVar2 = FUN_1800676c8(local_38);
      local_res18[0] = '(';
      local_78 = (DNameNode *)0x0;
      local_70 = 0;
      FUN_18006748c((longlong *)&local_78,local_res18,1);
      FUN_180066208(&local_78,(DNameNode **)&local_58,ppDVar2);
      ppDVar2 = (DNameNode **)FUN_180066234((longlong *)&local_58,(longlong *)&local_68,')');
      FUN_1800662e4(&local_98,ppDVar2);
      if ((((byte)DAT_1800b2004 & 0x60) != 0x60) && ((uVar7 & 2) != 0)) {
        FUN_1800662e4(&local_98,(DNameNode **)&local_88);
      }
      if ((~(byte)(DAT_1800b2004 >> 0x13) & 1) == 0) {
        plVar4 = FUN_18006a7b8((longlong *)local_38);
        if (((char)local_90 != '\x03') && ('\x01' < *(char *)(plVar4 + 1))) {
          local_90 = local_90 & 0xffffff00 | (uint)*(byte *)(plVar4 + 1);
        }
      }
      else {
        ppDVar2 = (DNameNode **)FUN_18006a7b8((longlong *)local_38);
        FUN_1800662e4(&local_98,ppDVar2);
      }
      uVar7 = local_90;
      if ((~(byte)(DAT_1800b2004 >> 8) & 1) == 0) {
        plVar4 = FUN_18006bc6c((longlong *)local_38);
        if (((char)local_90 != '\x03') && ('\x01' < *(char *)(plVar4 + 1))) {
          uVar7 = uVar7 & 0xffffff00 | (uint)*(byte *)(plVar4 + 1);
        }
      }
      else {
        ppDVar2 = (DNameNode **)FUN_18006bc6c((longlong *)local_38);
        FUN_1800662e4(&local_98,ppDVar2);
        uVar7 = local_90;
      }
      if (ppDVar1 != (DNameNode **)0x0) {
        *ppDVar1 = local_98;
        *(uint *)(ppDVar1 + 1) = uVar7;
        *param_1 = local_48;
        *(undefined4 *)(param_1 + 1) = local_40;
        return param_1;
      }
      *(undefined4 *)(param_1 + 1) = 0;
      *(undefined *)(param_1 + 1) = 3;
      goto LAB_180069809;
    }
  }
LAB_180069371:
  *(undefined4 *)(param_1 + 1) = 0;
  *(undefined *)(param_1 + 1) = 2;
LAB_180069809:
  *param_1 = (DNameNode *)0x0;
  return param_1;
}



// Library Function - Single Match
// Name: ?getLastChar@DName@@QEBADXZ
// Library: Visual Studio 2015 Release
// public: char __cdecl DName::getLastChar(void)const __ptr64

char __thiscall DName::getLastChar(DName *this)

{
  longlong *plVar1;
  code *pcVar2;
  char cVar3;

  plVar1 = *(longlong **)this;
  if (plVar1 == (longlong *)0x0) {
    cVar3 = '\0';
  }
  else {
    pcVar2 = *(code **)(*plVar1 + 8);
    _guard_check_icall();
    cVar3 = (*pcVar2)(plVar1);
  }
  return cVar3;
}



byte FUN_180069884(longlong param_1)

{
  return (*(int *)(param_1 + 8) != 1) - 1U & 0x20;
}



undefined FUN_180069890(longlong param_1)

{
  return *(undefined *)(param_1 + 8);
}



undefined8 FUN_180069894(longlong param_1)

{
  longlong *plVar1;
  code *pcVar2;
  undefined8 uVar3;

  uVar3 = 0;
  if ((*(longlong ***)(param_1 + 8) != (longlong **)0x0) &&
     (plVar1 = **(longlong ***)(param_1 + 8), plVar1 != (longlong *)0x0)) {
    pcVar2 = *(code **)(*plVar1 + 8);
    _guard_check_icall();
    uVar3 = (*pcVar2)(plVar1);
  }
  return uVar3;
}



void FUN_1800698d0(longlong param_1)

{
  longlong *plVar1;
  code *pcVar2;
  char cVar3;

  plVar1 = *(longlong **)(param_1 + 0x10);
  pcVar2 = *(code **)(*plVar1 + 8);
  _guard_check_icall();
  cVar3 = (*pcVar2)(plVar1);
  if (cVar3 == '\0') {
    plVar1 = *(longlong **)(param_1 + 8);
    pcVar2 = *(code **)(*plVar1 + 8);
    _guard_check_icall();
    (*pcVar2)(plVar1);
  }
  return;
}



ulonglong FUN_180069928(longlong param_1)

{
  ulonglong uVar1;

  uVar1 = 0;
  if (*(int *)(param_1 + 0x10) != 0) {
    uVar1 = *(ulonglong *)(param_1 + 8) & 0xffffffffffffff00 |
            (ulonglong)
            *(byte *)((longlong)(*(int *)(param_1 + 0x10) + -1) + *(ulonglong *)(param_1 + 8));
  }
  return uVar1;
}



longlong * FUN_180069940(longlong *param_1)

{
  DNameStatusNode **ppDVar1;
  char local_res8 [8];
  DNameNode *local_38;
  undefined4 local_30;
  DNameNode *local_28 [2];
  DNameStatusNode *local_18 [2];

  ppDVar1 = FUN_180068bd8(local_18,'\0');
  local_38 = (DNameNode *)0x0;
  local_30 = 0;
  local_res8[0] = '`';
  FUN_18006748c((longlong *)&local_38,local_res8,1);
  FUN_180066208(&local_38,local_28,(DNameNode **)ppDVar1);
  FUN_180066234((longlong *)local_28,param_1,'\'');
  return param_1;
}



// Library Function - Single Match
// Name: ?getMemory@_HeapManager@@QEAAPEAX_KH@Z
// Library: Visual Studio 2015 Release
// public: void * __ptr64 __cdecl _HeapManager::getMemory(unsigned __int64,int) __ptr64

void * __thiscall _HeapManager::getMemory(_HeapManager *this,__uint64 param_1,int param_2)

{
  code *pcVar1;
  void *pvVar2;
  undefined8 *puVar3;
  ulonglong uVar4;

  uVar4 = param_1 + 7 & 0xfffffffffffffff8;
  if (param_2 == 0) {
    if (uVar4 == 0) {
      uVar4 = 8;
    }
    if (*(ulonglong *)(this + 0x20) < uVar4) {
      if ((0x1000 < uVar4) ||
         (puVar3 = (undefined8 *)getMemory((_HeapManager *)&DAT_1800b2018,0x1008,1),
         puVar3 == (undefined8 *)0x0)) {
        return (void *)0x0;
      }
      *puVar3 = 0;
      if (*(undefined8 **)(this + 0x18) == (undefined8 *)0x0) {
        *(undefined8 **)(this + 0x10) = puVar3;
      }
      else {
        **(undefined8 **)(this + 0x18) = puVar3;
      }
      *(undefined8 **)(this + 0x18) = puVar3;
      *(ulonglong *)(this + 0x20) = 0x1000 - uVar4;
    }
    else {
      *(ulonglong *)(this + 0x20) = *(ulonglong *)(this + 0x20) - uVar4;
    }
    pvVar2 = (void *)(*(longlong *)(this + 0x20) + 8 + *(longlong *)(this + 0x18));
  }
  else {
    pcVar1 = *(code **)this;
    _guard_check_icall();
    pvVar2 = (void *)(*pcVar1)(uVar4);
  }
  return pvVar2;
}



// Library Function - Single Match
// Name: ?getNumberOfDimensions@UnDecorator@@CAHXZ
// Library: Visual Studio 2015 Release
// private: static int __cdecl UnDecorator::getNumberOfDimensions(void)

int UnDecorator::getNumberOfDimensions(void)

{
  char cVar1;
  int iVar2;

  cVar1 = *DAT_1800b1fe8;
  if (cVar1 == '\0') {
    return 0;
  }
  if (9 < (byte)(cVar1 - 0x30U)) {
    iVar2 = 0;
    while( true ) {
      if (cVar1 == '@') {
        if (*DAT_1800b1fe8 != '@') {
          DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
          return -1;
        }
        DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
        return iVar2;
      }
      if (cVar1 == '\0') break;
      if (0xf < (byte)(cVar1 + 0xbfU)) {
        return -1;
      }
      iVar2 = iVar2 * 0x10 + -0x41 + (int)cVar1;
      DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
      cVar1 = *DAT_1800b1fe8;
    }
    return 0;
  }
  DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
  return cVar1 + -0x2f;
}



longlong ** FUN_180069ae4(longlong **param_1,char param_2,undefined *param_3)

{
  code *pcVar1;
  bool bVar2;
  longlong *plVar3;
  char *pcVar4;
  char cVar5;
  DName DVar6;
  int iVar7;
  uint uVar8;
  DNameNode **ppDVar9;
  longlong **pplVar10;
  DNameStatusNode **ppDVar11;
  undefined7 extraout_var;
  char *pcVar12;
  char *pcVar13;
  char local_res20 [8];
  longlong *local_68;
  uint local_60;
  longlong *local_58;
  uint local_50;
  longlong *local_48;
  uint local_40;
  longlong *local_38;
  uint local_30;
  longlong *local_28 [2];

  local_68 = (longlong *)0x0;
  local_60 = 0;
  bVar2 = false;
  local_58 = (longlong *)0x0;
  cVar5 = *DAT_1800b1fe8;
  pcVar12 = DAT_1800b1fe8 + 1;
  local_50 = 0;
  if (cVar5 < 'B') {
    bVar2 = false;
    if (cVar5 != 'A') {
      if (cVar5 == '\0') goto LAB_180069d32;
      if (cVar5 < '0') goto LAB_18006a21f;
      if (cVar5 < '2') {
        local_58 = (longlong *)0x0;
        local_50 = 0;
        if (param_2 == '\0') {
LAB_180069c93:
          plVar3 = local_58;
          DAT_1800b1fe8 = pcVar12;
          pplVar10 = (longlong **)FUN_18006c314(local_28,'\0','\0');
          local_68 = *pplVar10;
          local_60 = *(uint *)(pplVar10 + 1);
          DAT_1800b1fe8 = pcVar12;
          if ((local_68 != (longlong *)0x0) && (pcVar12[-1] == '1')) {
            local_48 = (longlong *)0x0;
            local_40 = 0;
            local_res20[0] = '~';
            FUN_18006748c((longlong *)&local_48,local_res20,1);
            FUN_180066208((DNameNode **)&local_48,(DNameNode **)&local_38,(DNameNode **)&local_68);
            local_68 = local_38;
            local_60 = local_30;
          }
          if (plVar3 != (longlong *)0x0) {
            FUN_1800662e4((DNameNode **)&local_68,(DNameNode **)&local_58);
          }
          *param_1 = local_68;
          *(uint *)(param_1 + 1) = local_60;
          return param_1;
        }
        DAT_1800b1fe8 = pcVar12;
        ppDVar9 = (DNameNode **)FUN_18006b334((DNameNode **)local_28);
        local_48 = (longlong *)0x0;
        local_40 = 0;
        local_res20[0] = '<';
        FUN_18006748c((longlong *)&local_48,local_res20,1);
        FUN_180066208((DNameNode **)&local_48,(DNameNode **)&local_38,ppDVar9);
        FUN_1800662e4((DNameNode **)&local_58,(DNameNode **)&local_38);
        plVar3 = local_58;
        if (local_58 != (longlong *)0x0) {
          pcVar1 = *(code **)(*local_58 + 8);
          _guard_check_icall();
          cVar5 = (*pcVar1)(plVar3);
          if (cVar5 == '>') {
            FUN_180066328((longlong *)&local_58,' ');
          }
        }
        FUN_180066328((longlong *)&local_58,'>');
        if (param_3 != (undefined *)0x0) {
          *param_3 = 1;
        }
        if (*DAT_1800b1fe8 != '\0') {
          pcVar12 = DAT_1800b1fe8 + 1;
          goto LAB_180069c93;
        }
        *param_1 = local_58;
        local_60 = local_50;
        goto LAB_180069bba;
      }
      if ('9' < cVar5) goto LAB_18006a21f;
      iVar7 = *DAT_1800b1fe8 + -0x32;
      DAT_1800b1fe8 = pcVar12;
      goto LAB_180069b5e;
    }
LAB_18006a234:
    cVar5 = *DAT_1800b1fe8;
    DAT_1800b1fe8 = pcVar12;
    FUN_180065ed0((longlong *)&local_68,(&PTR_DAT_18007adf0)[cVar5 + -0x39]);
    if (!bVar2) goto LAB_180069b7c;
    if (local_68 != (longlong *)0x0) {
      local_60 = local_60 | 0x200;
    }
  }
  else {
    if (cVar5 == 'B') {
      bVar2 = true;
      goto LAB_18006a234;
    }
    if (cVar5 < 'C') {
LAB_18006a21f:
      DAT_1800b1fe8 = pcVar12;
      *(undefined4 *)(param_1 + 1) = 0;
      *(undefined *)(param_1 + 1) = 2;
      *param_1 = (longlong *)0x0;
      return param_1;
    }
    if (cVar5 < '[') goto LAB_18006a234;
    if (cVar5 != '_') goto LAB_18006a21f;
    cVar5 = *pcVar12;
    pcVar13 = DAT_1800b1fe8 + 2;
    pcVar4 = pcVar13;
    if (cVar5 < 'P') {
      if (cVar5 < 'D') {
        if (cVar5 < ':') {
          if (cVar5 == '9') {
            DAT_1800b1fe8 = pcVar13;
            FUN_180065aa8((longlong *)&local_38,(&PTR_DAT_18007adf0)[*pcVar12 + -0xe]);
            local_30 = local_30 | 0x8000;
            goto LAB_180069e14;
          }
          DAT_1800b1fe8 = pcVar13;
          if (cVar5 != '\0') {
            if (cVar5 < '0') goto LAB_180069e71;
            if ('6' < cVar5) {
              if ('8' < cVar5) goto LAB_180069e71;
              iVar7 = *pcVar12 + -0xe;
              goto LAB_180069dac;
            }
            iVar7 = *pcVar12 + -0xe;
            goto LAB_180069b5e;
          }
LAB_180069de1:
          DAT_1800b1fe8 = DAT_1800b1fe8 + -1;
LAB_180069d32:
          FUN_180065ae8((DNameStatusNode **)param_1,1);
          return param_1;
        }
        if (cVar5 == '?') {
          DAT_1800b1fe8 = DAT_1800b1fe8 + 3;
          if (*pcVar13 == '\0') goto LAB_180069de1;
          pcVar4 = DAT_1800b1fe8;
          if (*pcVar13 != '0') goto LAB_180069e71;
          pcVar12 = "`anonymous namespace\'";
        }
        else {
          if (cVar5 < 'A') goto LAB_180069e71;
          if (cVar5 < 'C') goto LAB_18006a207;
          if (cVar5 != 'C') goto LAB_180069e71;
          pcVar12 = "`string\'";
          DAT_1800b1fe8 = pcVar13;
        }
        FUN_18006b1e8((DNameStatusNode **)&local_38,pcVar12);
        local_30 = local_30 | 0x1000;
LAB_180069e14:
        *param_1 = local_38;
        *(uint *)(param_1 + 1) = local_30;
        return param_1;
      }
LAB_18006a207:
      iVar7 = *pcVar12 + -0x15;
      DAT_1800b1fe8 = pcVar13;
LAB_180069dac:
      FUN_180065aa8((longlong *)param_1,(&PTR_DAT_18007adf0)[iVar7]);
      return param_1;
    }
    if (cVar5 < 'U') {
      if (cVar5 < 'S') {
        if (cVar5 == 'P') {
          DAT_1800b1fe8 = pcVar13;
          FUN_180065ed0((longlong *)&local_68,(&PTR_DAT_18007adf0)[*pcVar12 + -0x15]);
          pplVar10 = FUN_180069ae4(local_28,'\0',(undefined *)0x0);
          local_58 = *pplVar10;
          local_50 = *(uint *)(pplVar10 + 1);
          if ((local_58 != (longlong *)0x0) && ((local_50 >> 10 & 1) != 0)) {
LAB_18006a0a5:
            *(undefined4 *)(param_1 + 1) = 0;
            *param_1 = (longlong *)0x0;
            *(undefined *)(param_1 + 1) = 2;
            return param_1;
          }
        }
        else {
          DAT_1800b1fe8 = pcVar13;
          if (cVar5 == 'Q') goto LAB_180069b7c;
          if (cVar5 != 'R') goto LAB_180069e71;
          FUN_180065ed0((longlong *)&local_68,(&PTR_DAT_18007adf0)[*pcVar12 + -0x15]);
          if (*DAT_1800b1fe8 == '\0') {
            FUN_1800662b8(&local_68,param_1,1);
            return param_1;
          }
          uVar8 = (int)*DAT_1800b1fe8 - 0x30;
          if (((int)uVar8 < 0) || (4 < uVar8)) goto LAB_18006a0a5;
          FUN_180065ed0((longlong *)&local_58,(&PTR_s__Type_Descriptor__18007b080)[(int)uVar8]);
          iVar7 = (int)*DAT_1800b1fe8;
          DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
          if (iVar7 == 0x30) {
            FUN_18006885c((DNameStatusNode **)&local_38,(undefined8 *)0x0);
            ppDVar9 = (DNameNode **)FUN_180066234((longlong *)&local_38,(longlong *)local_28,' ');
            pplVar10 = (longlong **)
                       FUN_180066208(ppDVar9,(DNameNode **)&local_48,(DNameNode **)&local_68);
            goto LAB_180069f4b;
          }
          if (iVar7 == 0x31) {
            FUN_180066208((DNameNode **)&local_68,(DNameNode **)&local_48,(DNameNode **)&local_58);
            ppDVar11 = FUN_18006ae98((DNameStatusNode **)local_28);
            ppDVar9 = (DNameNode **)FUN_180066234((longlong *)ppDVar11,(longlong *)&local_38,',');
            FUN_1800662e4((DNameNode **)&local_48,ppDVar9);
            ppDVar11 = FUN_18006ae98((DNameStatusNode **)local_28);
            ppDVar9 = (DNameNode **)FUN_180066234((longlong *)ppDVar11,(longlong *)&local_38,',');
            FUN_1800662e4((DNameNode **)&local_48,ppDVar9);
            ppDVar11 = FUN_18006ae98((DNameStatusNode **)local_28);
            ppDVar9 = (DNameNode **)FUN_180066234((longlong *)ppDVar11,(longlong *)&local_38,',');
            FUN_1800662e4((DNameNode **)&local_48,ppDVar9);
            ppDVar11 = FUN_180068bd8((DNameStatusNode **)local_28,'\0');
            ppDVar9 = (DNameNode **)FUN_180066234((longlong *)ppDVar11,(longlong *)&local_38,')');
            FUN_1800662e4((DNameNode **)&local_48,ppDVar9);
            FUN_180066234((longlong *)&local_48,(longlong *)param_1,'\'');
            return param_1;
          }
          if (2 < iVar7 - 0x32U) goto LAB_180069de1;
        }
        pplVar10 = &local_68;
LAB_180069f4b:
        FUN_180066208((DNameNode **)pplVar10,(DNameNode **)param_1,(DNameNode **)&local_58);
        return param_1;
      }
      goto LAB_18006a207;
    }
    if ('V' < cVar5) {
      if (cVar5 < 'X') goto LAB_180069e71;
      if (cVar5 < 'Z') goto LAB_18006a207;
      if (cVar5 != '_') {
LAB_180069e71:
        DAT_1800b1fe8 = pcVar4;
        *(undefined4 *)(param_1 + 1) = 0;
        *(undefined *)(param_1 + 1) = 2;
        *param_1 = (longlong *)0x0;
        return param_1;
      }
      cVar5 = *pcVar13;
      DAT_1800b1fe8 = DAT_1800b1fe8 + 3;
      pcVar4 = DAT_1800b1fe8;
      if (cVar5 < 'A') goto LAB_180069e71;
      if ('D' < cVar5) {
        if (cVar5 < 'G') {
          FUN_180065aa8((longlong *)&local_48,(&PTR_DAT_18007adf0)[*pcVar13 + 4]);
          if (*DAT_1800b1fe8 == '?') {
            ppDVar9 = FUN_18006893c((DNameNode **)local_28);
            FUN_1800662e4((DNameNode **)&local_48,ppDVar9);
            if (*DAT_1800b1fe8 == '@') {
              DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
            }
          }
          else {
            DVar6 = UnDecorator::getSymbolName();
            FUN_1800662e4((DNameNode **)&local_48,(DNameNode **)CONCAT71(extraout_var,DVar6));
          }
          DName::operator__((DName *)&local_48,"\'\'");
LAB_18006a177:
          *param_1 = local_48;
          local_60 = local_40;
          goto LAB_180069bba;
        }
        if ('J' < cVar5) {
          if (cVar5 == 'K') {
            FUN_180065aa8((longlong *)&local_48,(&PTR_DAT_18007adf0)[*pcVar13 + 4]);
            while (cVar5 = *DAT_1800b1fe8, cVar5 != '\0') {
              if (cVar5 == '@') {
                DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
                break;
              }
              DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
              FUN_180066328((longlong *)&local_48,cVar5);
            }
            goto LAB_18006a177;
          }
          if (cVar5 != 'L') goto LAB_180069e71;
        }
      }
      iVar7 = *pcVar13 + 4;
      goto LAB_180069dac;
    }
    iVar7 = *pcVar12 + -0x15;
    DAT_1800b1fe8 = pcVar13;
LAB_180069b5e:
    FUN_180065ed0((longlong *)&local_68,(&PTR_DAT_18007adf0)[iVar7]);
LAB_180069b7c:
    if (local_68 != (longlong *)0x0) {
      ppDVar9 = (DNameNode **)FUN_180065aa8((longlong *)local_28,"operator");
      FUN_180066208(ppDVar9,(DNameNode **)&local_38,(DNameNode **)&local_68);
      local_68 = local_38;
      local_60 = local_30;
    }
  }
  *param_1 = local_68;
LAB_180069bba:
  *(uint *)(param_1 + 1) = local_60;
  return param_1;
}



DNameStatusNode ** FUN_18006a278(DNameStatusNode **param_1,DNameNode **param_2,DNameNode **param_3)

{
  FUN_18006a668(param_1,param_2,param_3,"*");
  return param_1;
}



DNameStatusNode ** FUN_18006a298(DNameStatusNode **param_1,DNameNode **param_2,DNameNode **param_3)

{
  FUN_18006a668(param_1,param_2,param_3,"");
  return param_1;
}



DNameStatusNode ** FUN_18006a2b8(DNameStatusNode **param_1,DNameStatusNode **param_2)

{
  char cVar1;
  DNameNode **ppDVar2;
  char *pcVar3;
  int iVar4;
  uint uVar5;
  char *pcVar6;
  DNameNode *local_28;
  undefined4 local_20;
  DNameStatusNode *local_18;
  uint local_10;

  local_28 = (DNameNode *)0x0;
  local_20 = 0;
  cVar1 = *DAT_1800b1fe8;
  pcVar3 = DAT_1800b1fe8;
  if (cVar1 != '\0') {
    if (cVar1 != '$') {
      if (cVar1 != 'A') {
        if (cVar1 != 'B') {
LAB_18006a302:
          FUN_180067ae4(param_1,(DNameNode **)param_2);
          return param_1;
        }
        FUN_180065ed0((longlong *)&local_28,"volatile");
        pcVar3 = DAT_1800b1fe8;
        if (*param_2 != (DNameStatusNode *)0x0) {
          FUN_180066328((longlong *)&local_28,' ');
          pcVar3 = DAT_1800b1fe8;
        }
      }
      pcVar6 = "&";
LAB_18006a33d:
      local_18 = *param_2;
      DAT_1800b1fe8 = pcVar3 + 1;
      local_10 = *(uint *)(param_2 + 1) | 0x100;
      FUN_18006a668(param_1,&local_28,(DNameNode **)&local_18,pcVar6);
      return param_1;
    }
    if (DAT_1800b1fe8[1] == '$') {
      pcVar3 = DAT_1800b1fe8 + 2;
      iVar4 = (int)*pcVar3;
      if (*pcVar3 != '\0') {
        if (iVar4 == 0x41) {
          DAT_1800b1fe8 = DAT_1800b1fe8 + 3;
          FUN_18006930c((DNameNode **)param_1,(DNameNode **)param_2);
          return param_1;
        }
        if (iVar4 == 0x42) {
          DAT_1800b1fe8 = DAT_1800b1fe8 + 3;
          FUN_18006a508(param_1,(DNameNode **)param_2,1);
          return param_1;
        }
        if (iVar4 == 0x43) {
          DAT_1800b1fe8 = DAT_1800b1fe8 + 3;
          local_18 = (DNameStatusNode *)0x0;
          local_10 = 0;
          param_2 = FUN_180068078((DNameStatusNode **)&local_28,(DNameNode **)param_2,"",
                                  (DNameNode **)&local_18,0);
          goto LAB_18006a302;
        }
        if (iVar4 != 0x51) {
          if (iVar4 != 0x52) {
            if (iVar4 == 0x53) {
              pcVar3 = DAT_1800b1fe8 + 3;
LAB_18006a37c:
              DAT_1800b1fe8 = pcVar3;
              *(undefined4 *)(param_1 + 1) = 0;
              *(undefined *)(param_1 + 1) = 2;
              *param_1 = (DNameStatusNode *)0x0;
              return param_1;
            }
            uVar5 = iVar4 - 0x54;
            if (uVar5 != 0) {
              if (uVar5 == 5) {
                DAT_1800b1fe8 = DAT_1800b1fe8 + 3;
                FUN_18006ad98(param_1,(ulonglong)uVar5);
                return param_1;
              }
              goto LAB_18006a37c;
            }
            DAT_1800b1fe8 = DAT_1800b1fe8 + 3;
            if (*param_2 == (DNameStatusNode *)0x0) {
              FUN_180065aa8((longlong *)param_1,"std::nullptr_t");
              return param_1;
            }
            ppDVar2 = (DNameNode **)FUN_180065aa8((longlong *)&local_18,"std::nullptr_t ");
            goto LAB_18006a4e0;
          }
          DAT_1800b1fe8 = pcVar3;
          FUN_180065ed0((longlong *)&local_28,"volatile");
          pcVar3 = DAT_1800b1fe8;
          if (*param_2 != (DNameStatusNode *)0x0) {
            FUN_180066328((longlong *)&local_28,' ');
            pcVar3 = DAT_1800b1fe8;
          }
        }
        pcVar6 = "&&";
        goto LAB_18006a33d;
      }
    }
    else {
      if (DAT_1800b1fe8[1] != '\0') goto LAB_18006a37c;
    }
  }
  DAT_1800b1fe8 = pcVar3;
  ppDVar2 = (DNameNode **)FUN_180065ae8(&local_18,1);
LAB_18006a4e0:
  FUN_180066208(ppDVar2,(DNameNode **)param_1,(DNameNode **)param_2);
  return param_1;
}



DNameStatusNode ** FUN_18006a508(DNameStatusNode **param_1,DNameNode **param_2,int param_3)

{
  DNameNode **ppDVar1;
  char *pcVar2;
  DNameStatusNode *local_38;
  undefined4 local_30;
  DNameStatusNode *local_28;
  undefined4 local_20;
  DNameStatusNode *local_18 [2];

  if (*DAT_1800b1fe8 == '\0') {
    ppDVar1 = (DNameNode **)FUN_180065ae8(local_18,1);
    goto LAB_18006a645;
  }
  if (param_3 == 0) {
LAB_18006a58f:
    if (((*DAT_1800b1fe8 != '$') || (DAT_1800b1fe8[1] != '$')) || (DAT_1800b1fe8[2] != 'T')) {
      if (*DAT_1800b1fe8 == 'Y') {
        DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
        FUN_1800677cc(param_1,param_2);
        return param_1;
      }
      FUN_180067ae4(&local_38,param_2);
      if ((*(uint *)(param_2 + 1) & 0x4000) == 0) {
        if ((*(uint *)(param_2 + 1) & 0x2000) == 0) goto LAB_18006a62f;
        pcVar2 = "cli::pin_ptr<";
      }
      else {
        pcVar2 = "cli::array<";
      }
      ppDVar1 = (DNameNode **)FUN_180065aa8((longlong *)local_18,pcVar2);
      FUN_180066208(ppDVar1,(DNameNode **)&local_28,(DNameNode **)&local_38);
      local_38 = local_28;
      local_30 = local_20;
LAB_18006a62f:
      *param_1 = local_38;
      *(undefined4 *)(param_1 + 1) = local_30;
      return param_1;
    }
    DAT_1800b1fe8 = DAT_1800b1fe8 + 3;
    if (*param_2 == (DNameNode *)0x0) {
      pcVar2 = "std::nullptr_t";
LAB_18006a551:
      FUN_180065aa8((longlong *)param_1,pcVar2);
      return param_1;
    }
    pcVar2 = "std::nullptr_t ";
  }
  else {
    if (*DAT_1800b1fe8 != 'X') {
      if (((*DAT_1800b1fe8 == '_') && (DAT_1800b1fe8[1] == '_')) && (DAT_1800b1fe8[2] == 'Z')) {
        DAT_1800b1fe8 = DAT_1800b1fe8 + 3;
      }
      goto LAB_18006a58f;
    }
    DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
    if (*param_2 == (DNameNode *)0x0) {
      pcVar2 = "void";
      goto LAB_18006a551;
    }
    pcVar2 = "void ";
  }
  ppDVar1 = (DNameNode **)FUN_180065aa8((longlong *)&local_28,pcVar2);
LAB_18006a645:
  FUN_180066208(ppDVar1,(DNameNode **)param_1,param_2);
  return param_1;
}



DNameStatusNode **
FUN_18006a668(DNameStatusNode **param_1,DNameNode **param_2,DNameNode **param_3,char *param_4)

{
  char cVar1;
  DNameStatusNode *local_28;
  undefined4 local_20;

  cVar1 = *DAT_1800b1fe8;
  if (cVar1 == '\0') {
    FUN_180065ae8(&local_28,1);
    DName::operator__((DName *)&local_28,param_4);
    if (*param_2 != (DNameNode *)0x0) {
      FUN_1800662e4((DNameNode **)&local_28,param_2);
    }
    if (*param_3 != (DNameNode *)0x0) {
      if (*param_2 != (DNameNode *)0x0) {
        FUN_180066328((longlong *)&local_28,' ');
      }
      FUN_1800662e4((DNameNode **)&local_28,param_3);
    }
    *param_1 = local_28;
    *(undefined4 *)(param_1 + 1) = local_20;
  }
  else {
    if (((byte)(cVar1 - 0x36U) < 4) || (cVar1 == '_')) {
      FUN_180065aa8((longlong *)&local_28,param_4);
      if ((*param_2 != (DNameNode *)0x0) &&
         ((*param_3 == (DNameNode *)0x0 || ((*(uint *)(param_3 + 1) & 0x100) == 0)))) {
        FUN_1800662e4((DNameNode **)&local_28,param_2);
      }
      if (*param_3 != (DNameNode *)0x0) {
        FUN_1800662e4((DNameNode **)&local_28,param_3);
      }
      FUN_18006930c((DNameNode **)param_1,(DNameNode **)&local_28);
    }
    else {
      FUN_180068078(&local_28,param_3,param_4,param_2,0);
      FUN_18006a508(param_1,(DNameNode **)&local_28,(uint)(*param_4 == '*'));
    }
  }
  return param_1;
}



DNameStatusNode **
FUN_18006a7a0(DNameStatusNode **param_1,DNameNode **param_2,DNameNode **param_3,char *param_4)

{
  FUN_18006a668(param_1,param_2,param_3,param_4);
  return param_1;
}



longlong * FUN_18006a7b8(longlong *param_1)

{
  char *pcVar1;
  undefined4 uVar2;
  uint uVar3;
  uint uVar4;
  longlong lVar5;
  longlong local_18;
  undefined4 local_10;

  if (*DAT_1800b1fe8 == '_') {
    pcVar1 = DAT_1800b1fe8 + 1;
    DAT_1800b1fe8 = DAT_1800b1fe8 + 2;
    uVar4 = (int)*pcVar1 - 0x41;
    if (uVar4 < 4) {
      local_18 = 0;
      local_10 = 0;
      lVar5 = 0;
      uVar2 = 0;
      if ((~(DAT_1800b2004 >> 1) & 1) != 0) {
        DName::operator__((DName *)&local_18," ");
        pcVar1 = "restrict(";
        if ((~DAT_1800b2004 & 1) == 0) {
          pcVar1 = "strict(";
        }
        DName::operator__((DName *)&local_18,pcVar1);
        if (uVar4 != 0) {
          while( true ) {
            uVar3 = ~uVar4 + 1 & uVar4;
            if (uVar3 == 1) {
              pcVar1 = "cpu";
            }
            else {
              if (uVar3 != 2) {
                *(undefined4 *)(param_1 + 1) = 0;
                *(undefined *)(param_1 + 1) = 2;
                *param_1 = 0;
                return param_1;
              }
              pcVar1 = "amp";
            }
            DName::operator__((DName *)&local_18,pcVar1);
            uVar4 = uVar4 & ~uVar3;
            if (uVar4 == 0) break;
            DName::operator__((DName *)&local_18,", ");
          }
        }
        FUN_180066328(&local_18,')');
        lVar5 = local_18;
        uVar2 = local_10;
      }
      *param_1 = lVar5;
      *(undefined4 *)(param_1 + 1) = uVar2;
      return param_1;
    }
    *(undefined4 *)(param_1 + 1) = 0;
    *(undefined *)(param_1 + 1) = 2;
  }
  else {
    *(undefined4 *)(param_1 + 1) = 0;
  }
  *param_1 = 0;
  return param_1;
}



// Library Function - Single Match
// Name: ?getReturnType@UnDecorator@@CA?AVDName@@PEAV2@@Z
// Libraries: Visual Studio 2008 Release, Visual Studio 2010 Release, Visual Studio 2012 Release,
// Visual Studio 2015 Release
// private: static class DName __cdecl UnDecorator::getReturnType(class DName * __ptr64)

DName UnDecorator::getReturnType(DName *param_1)

{
  undefined8 *in_RDX;

  if (*DAT_1800b1fe8 == '@') {
    DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
    FUN_180065a24((undefined8 *)param_1,in_RDX);
  }
  else {
    FUN_18006885c((DNameStatusNode **)param_1,in_RDX);
  }
  return SUB81(param_1,0);
}



// WARNING: Could not reconcile some variable overlaps

DNameStatusNode ** FUN_18006a920(DNameStatusNode **param_1)

{
  byte bVar1;
  bool bVar2;
  undefined4 uVar3;
  DNameNode **ppDVar4;
  byte *pbVar5;
  DNameNode **ppDVar6;
  longlong **pplVar7;
  DNameStatusNode **ppDVar8;
  longlong *plVar9;
  longlong *plVar10;
  bool bVar11;
  char local_res8 [8];
  longlong *local_1f8;
  undefined4 local_1f0;
  DNameNode *local_1e8;
  undefined4 local_1e0;
  longlong *local_1d8;
  undefined4 local_1d0;
  DNameNode *local_1c8;
  undefined4 local_1c0;
  DNameNode *local_1b8;
  undefined4 local_1b0;
  DNameStatusNode *local_1a8;
  undefined4 local_1a0;
  DNameStatusNode *local_198;
  undefined4 local_190;
  DNameStatusNode *local_188;
  undefined4 local_180;
  DNameNode *local_178 [2];
  DNameNode *local_168 [2];
  longlong local_158 [2];
  DNameNode *local_148 [2];
  longlong *local_138 [2];
  DNameNode *local_128 [2];
  longlong local_118 [2];
  longlong local_108 [2];
  DNameNode *local_f8 [2];
  undefined8 local_e8 [2];
  DNameNode *local_d8 [2];
  longlong local_c8 [2];
  longlong *local_b8 [2];
  longlong local_a8 [2];
  DNameNode *local_98 [2];
  longlong *local_88 [2];
  DNameNode *local_78 [2];
  DNameNode *local_68 [2];
  longlong local_58 [2];
  DNameNode *local_48 [2];
  longlong local_38 [2];
  longlong *local_28 [2];

  *param_1 = (DNameStatusNode *)0x0;
  bVar2 = false;
  *(undefined4 *)(param_1 + 1) = 0;
  bVar11 = true;
  do {
    if ((!bVar11) || ((*DAT_1800b1fe8 & 0xbf) == 0)) {
      if (*DAT_1800b1fe8 == 0) {
        if (*param_1 == (DNameStatusNode *)0x0) {
          FUN_180065f08(param_1,1);
        }
        else {
          ppDVar8 = FUN_180065ae8((DNameStatusNode **)local_128,1);
          ppDVar4 = (DNameNode **)FUN_18006628c(ppDVar8,local_138,"::");
          ppDVar4 = FUN_180066208(ppDVar4,local_148,(DNameNode **)param_1);
          *param_1 = (DNameStatusNode *)*ppDVar4;
          *(undefined4 *)(param_1 + 1) = *(undefined4 *)(ppDVar4 + 1);
        }
      }
      else {
        if (*DAT_1800b1fe8 != 0x40) {
          *(undefined4 *)(param_1 + 1) = 0;
          *(undefined *)(param_1 + 1) = 2;
          *param_1 = (DNameStatusNode *)0x0;
        }
      }
      return param_1;
    }
    if ((DAT_1800b2008 != '\0') && (DAT_1800b2009 == '\0')) {
      return param_1;
    }
    if (*param_1 != (DNameStatusNode *)0x0) {
      ppDVar4 = (DNameNode **)FUN_180065aa8(local_118,"::");
      FUN_180066208(ppDVar4,(DNameNode **)&local_1a8,(DNameNode **)param_1);
      *param_1 = local_1a8;
      *(undefined4 *)(param_1 + 1) = local_1a0;
      if (bVar2) {
        local_res8[0] = '[';
        local_1e8 = (DNameNode *)0x0;
        local_1e0 = 0;
        FUN_18006748c((longlong *)&local_1e8,local_res8,1);
        FUN_180066208(&local_1e8,(DNameNode **)&local_198,(DNameNode **)param_1);
        bVar2 = false;
        *param_1 = local_198;
        *(undefined4 *)(param_1 + 1) = local_190;
      }
    }
    if (*DAT_1800b1fe8 == 0x3f) {
      pbVar5 = DAT_1800b1fe8 + 1;
      bVar1 = *pbVar5;
      if (bVar1 == 0x24) {
        ppDVar6 = (DNameNode **)FUN_18006c314(local_28,'\x01','\0');
        ppDVar4 = local_148;
        goto LAB_18006acf1;
      }
      if (bVar1 != 0x25) {
        if (bVar1 == 0x3f) {
          if ((DAT_1800b1fe8[2] != 0x5f) || (DAT_1800b1fe8[3] != 0x3f)) {
            DAT_1800b1fe8 = pbVar5;
            ppDVar4 = FUN_18006893c(local_68);
            local_res8[0] = '`';
            local_1b8 = (DNameNode *)0x0;
            local_1b0 = 0;
            FUN_18006748c((longlong *)&local_1b8,local_res8,1);
            FUN_180066208(&local_1b8,local_168,ppDVar4);
            ppDVar6 = (DNameNode **)FUN_180066234((longlong *)local_168,local_58,'\'');
            ppDVar4 = local_48;
            goto LAB_18006acf1;
          }
          DAT_1800b1fe8 = DAT_1800b1fe8 + 2;
          pplVar7 = FUN_180069ae4(local_88,'\0',(undefined *)0x0);
          ppDVar4 = FUN_180066208((DNameNode **)pplVar7,local_78,(DNameNode **)param_1);
          *param_1 = (DNameStatusNode *)*ppDVar4;
          *(undefined4 *)(param_1 + 1) = *(undefined4 *)(ppDVar4 + 1);
          if (*DAT_1800b1fe8 == 0x40) {
LAB_18006ab46:
            DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
          }
          goto LAB_18006ad08;
        }
        if (bVar1 == 0x41) goto LAB_18006ac66;
        if (bVar1 != 0x49) {
          if (bVar1 == 0x51) {
            DAT_1800b1fe8 = DAT_1800b1fe8 + 2;
            local_1f8 = (longlong *)0x0;
            local_1f0 = 0;
            do {
              plVar9 = local_1f8;
              FUN_18006c314(&local_1d8,'\x01','\0');
              if ((char)local_1d0 == '\0') {
                plVar10 = local_1d8;
                uVar3 = local_1d0;
                if (plVar9 != (longlong *)0x0) {
                  ppDVar4 = (DNameNode **)FUN_18006628c(&local_1d8,local_e8,"::");
                  pplVar7 = (longlong **)FUN_180066208(ppDVar4,local_d8,(DNameNode **)&local_1f8);
                  plVar10 = *pplVar7;
                  uVar3 = *(undefined4 *)(pplVar7 + 1);
                }
              }
              else {
                local_1f0 = 2;
                plVar10 = (longlong *)0x0;
                uVar3 = local_1f0;
              }
              local_1f0 = uVar3;
              local_1f8 = plVar10;
              if ((char)local_1f0 != '\0') {
                *(undefined4 *)(param_1 + 1) = 0;
                *(undefined *)(param_1 + 1) = 2;
                *param_1 = (DNameStatusNode *)0x0;
                goto LAB_18006ad08;
              }
            } while (*DAT_1800b1fe8 != 0x40);
            local_res8[0] = '[';
            local_1c8 = (DNameNode *)0x0;
            local_1c0 = 0;
            FUN_18006748c((longlong *)&local_1c8,local_res8,1);
            FUN_180066208(&local_1c8,local_178,(DNameNode **)&local_1f8);
            ppDVar8 = (DNameStatusNode **)FUN_180066234((longlong *)local_178,local_c8,']');
            *param_1 = *ppDVar8;
            *(undefined4 *)(param_1 + 1) = *(undefined4 *)(ppDVar8 + 1);
            goto LAB_18006ab46;
          }
          DAT_1800b1fe8 = pbVar5;
          ppDVar6 = (DNameNode **)FUN_180069940(local_108);
          ppDVar4 = local_f8;
          goto LAB_18006acf1;
        }
        DAT_1800b1fe8 = DAT_1800b1fe8 + 2;
        plVar9 = (longlong *)FUN_18006c314(local_b8,'\x01','\0');
        ppDVar4 = (DNameNode **)FUN_180066234(plVar9,local_a8,']');
        ppDVar4 = FUN_180066208(ppDVar4,local_98,(DNameNode **)param_1);
        bVar2 = true;
        goto LAB_18006acfc;
      }
LAB_18006ac66:
      DAT_1800b1fe8 = pbVar5;
      FUN_180065904(local_158,&DAT_1800b1fe8,0x40);
      ppDVar4 = (DNameNode **)FUN_180065aa8(local_38,"`anonymous namespace\'");
      FUN_180066208(ppDVar4,(DNameNode **)&local_188,(DNameNode **)param_1);
      *param_1 = local_188;
      *(undefined4 *)(param_1 + 1) = local_180;
      if (*DAT_1800b1fd8 != 9) {
        FUN_180066510(DAT_1800b1fd8,local_158);
      }
    }
    else {
      ppDVar6 = (DNameNode **)FUN_18006c314(local_138,'\x01','\0');
      ppDVar4 = local_128;
LAB_18006acf1:
      ppDVar4 = FUN_180066208(ppDVar6,ppDVar4,(DNameNode **)param_1);
LAB_18006acfc:
      *param_1 = (DNameStatusNode *)*ppDVar4;
      *(undefined4 *)(param_1 + 1) = *(undefined4 *)(ppDVar4 + 1);
    }
LAB_18006ad08:
    bVar11 = *(char *)(param_1 + 1) == '\0';
  } while( true );
}



DNameStatusNode ** FUN_18006ad98(DNameStatusNode **param_1,undefined8 param_2)

{
  undefined4 uVar1;
  DNameStatusNode **ppDVar2;
  DNameNode **ppDVar3;
  longlong *local_38 [2];
  undefined8 local_28 [2];
  DNameNode *local_18 [2];

  *param_1 = (DNameStatusNode *)0x0;
  *(undefined4 *)(param_1 + 1) = 0;
  ppDVar2 = (DNameStatusNode **)FUN_18006c314(local_38,'\x01','\0');
  *param_1 = *ppDVar2;
  uVar1 = *(undefined4 *)(ppDVar2 + 1);
  *(undefined4 *)(param_1 + 1) = uVar1;
  if (((char)uVar1 == '\0') && (*DAT_1800b1fe8 != '\0')) {
    if (*DAT_1800b1fe8 == '@') goto LAB_18006ae1f;
    ppDVar2 = FUN_18006a920((DNameStatusNode **)local_38);
    ppDVar3 = (DNameNode **)FUN_18006628c(ppDVar2,local_28,"::");
    ppDVar3 = FUN_180066208(ppDVar3,local_18,(DNameNode **)param_1);
    *param_1 = (DNameStatusNode *)*ppDVar3;
    *(undefined4 *)(param_1 + 1) = *(undefined4 *)(ppDVar3 + 1);
  }
  if (*DAT_1800b1fe8 != '@') {
    if (*DAT_1800b1fe8 != '\0') {
      *(undefined4 *)(param_1 + 1) = 0;
      *param_1 = (DNameStatusNode *)0x0;
      *(undefined *)(param_1 + 1) = 2;
      return param_1;
    }
    if (*param_1 == (DNameStatusNode *)0x0) {
      FUN_180065f08(param_1,1);
      return param_1;
    }
    ppDVar2 = FUN_180065ae8((DNameStatusNode **)local_18,1);
    ppDVar3 = (DNameNode **)FUN_18006628c(ppDVar2,local_28,"::");
    ppDVar3 = FUN_180066208(ppDVar3,(DNameNode **)local_38,(DNameNode **)param_1);
    *param_1 = (DNameStatusNode *)*ppDVar3;
    *(undefined4 *)(param_1 + 1) = *(undefined4 *)(ppDVar3 + 1);
    return param_1;
  }
LAB_18006ae1f:
  DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
  return param_1;
}



DNameStatusNode ** FUN_18006ae98(DNameStatusNode **param_1)

{
  DNameStatusNode **ppDVar1;
  char local_res10 [24];
  DNameNode *local_28;
  undefined4 local_20;
  DNameStatusNode *local_18 [2];

  if (*DAT_1800b1fe8 == '\0') {
    FUN_180065ae8(param_1,1);
  }
  else {
    if (*DAT_1800b1fe8 == '?') {
      DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
      ppDVar1 = FUN_180068bd8(local_18,'\0');
      local_28 = (DNameNode *)0x0;
      local_20 = 0;
      local_res10[0] = '-';
      FUN_18006748c((longlong *)&local_28,local_res10,1);
      FUN_180066208(&local_28,(DNameNode **)param_1,(DNameNode **)ppDVar1);
    }
    else {
      FUN_180068bd8(param_1,'\0');
    }
  }
  return param_1;
}



// Library Function - Single Match
// Name: ?getString@DName@@QEBAPEADPEADH@Z
// Library: Visual Studio 2015 Release
// public: char * __ptr64 __cdecl DName::getString(char * __ptr64,int)const __ptr64

char * __thiscall DName::getString(DName *this,char *param_1,int param_2)

{
  code **ppcVar1;
  code *pcVar2;
  longlong *plVar3;
  int iVar4;
  char *pcVar5;

  ppcVar1 = *(code ***)this;
  if (ppcVar1 == (code **)0x0) {
    if (param_1 != (char *)0x0) {
      *param_1 = '\0';
    }
  }
  else {
    if (param_1 == (char *)0x0) {
      pcVar2 = *(code **)*ppcVar1;
      _guard_check_icall();
      iVar4 = (*pcVar2)(ppcVar1);
      param_2 = iVar4 + 1;
      param_1 = (char *)_HeapManager::getMemory((_HeapManager *)&DAT_1800b2018,(longlong)param_2,0);
      if (param_1 == (char *)0x0) {
        return (char *)0x0;
      }
    }
    plVar3 = *(longlong **)this;
    pcVar5 = param_1;
    if (plVar3 != (longlong *)0x0) {
      pcVar2 = *(code **)(*plVar3 + 0x10);
      _guard_check_icall();
      pcVar5 = (char *)(*pcVar2)(plVar3,param_1,param_1 + (longlong)param_2 + -1);
    }
    *pcVar5 = '\0';
  }
  return param_1;
}



undefined * FUN_18006b074(longlong param_1,undefined *param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  undefined *puVar3;
  ulonglong uVar4;

  if (*(int *)(param_1 + 8) == 1) {
    uVar2 = param_3 - (int)param_2;
    uVar1 = 4;
    if ((int)uVar2 < 4) {
      uVar1 = uVar2;
    }
    if (uVar1 != 0) {
      uVar4 = (ulonglong)uVar1;
      puVar3 = param_2;
      do {
        *puVar3 = puVar3[(longlong)(&DAT_18007bc20 + -(longlong)param_2)];
        puVar3 = puVar3 + 1;
        uVar4 = uVar4 - 1;
      } while (uVar4 != 0);
    }
    return param_2 + (int)uVar1;
  }
  return param_2;
}



undefined * FUN_18006b0b8(longlong param_1,undefined *param_2,undefined *param_3)

{
  if (param_2 < param_3) {
    *param_2 = *(undefined *)(param_1 + 8);
    param_2 = param_2 + 1;
  }
  return param_2;
}



// Library Function - Single Match
// Name: ?getString@pDNameNode@@UEBAPEADPEAD0@Z
// Library: Visual Studio 2015 Release
// public: virtual char * __ptr64 __cdecl pDNameNode::getString(char * __ptr64,char * __ptr64)const
// __ptr64

char * __thiscall pDNameNode::getString(pDNameNode *this,char *param_1,char *param_2)

{
  longlong *plVar1;
  code *pcVar2;

  if ((*(longlong ***)(this + 8) != (longlong **)0x0) &&
     (plVar1 = **(longlong ***)(this + 8), plVar1 != (longlong *)0x0)) {
    pcVar2 = *(code **)(*plVar1 + 0x10);
    _guard_check_icall();
    param_1 = (char *)(*pcVar2)(plVar1,param_1,param_2);
  }
  return param_1;
}



void FUN_18006b12c(longlong param_1,undefined8 param_2,ulonglong param_3)

{
  longlong *plVar1;
  code *pcVar2;
  ulonglong uVar3;

  plVar1 = *(longlong **)(param_1 + 8);
  pcVar2 = *(code **)(*plVar1 + 0x10);
  _guard_check_icall();
  uVar3 = (*pcVar2)(plVar1,param_2,param_3);
  if (uVar3 < param_3) {
    plVar1 = *(longlong **)(param_1 + 0x10);
    pcVar2 = *(code **)(*plVar1 + 0x10);
    _guard_check_icall();
    (*pcVar2)(plVar1,uVar3,param_3);
  }
  return;
}



undefined * FUN_18006b1b0(longlong param_1,undefined *param_2,int param_3)

{
  longlong lVar1;
  undefined *puVar2;
  uint uVar3;
  ulonglong uVar4;
  uint uVar5;

  uVar3 = param_3 - (int)param_2;
  lVar1 = *(longlong *)(param_1 + 8);
  uVar5 = *(uint *)(param_1 + 0x10);
  if ((int)uVar3 < (int)*(uint *)(param_1 + 0x10)) {
    uVar5 = uVar3;
  }
  if (uVar5 != 0) {
    uVar4 = (ulonglong)uVar5;
    puVar2 = param_2;
    do {
      *puVar2 = puVar2[lVar1 - (longlong)param_2];
      puVar2 = puVar2 + 1;
      uVar4 = uVar4 - 1;
    } while (uVar4 != 0);
  }
  return param_2 + (int)uVar5;
}



DNameStatusNode ** FUN_18006b1e8(DNameStatusNode **param_1,char *param_2)

{
  char *pcVar1;
  char cVar2;
  DNameStatusNode *local_28;
  undefined4 local_20;
  DNameStatusNode *local_18 [2];

  FUN_180065aa8((longlong *)&local_28,param_2);
  pcVar1 = DAT_1800b1fe8 + 1;
  if ((*DAT_1800b1fe8 == '@') && (pcVar1 = DAT_1800b1fe8 + 2, DAT_1800b1fe8[1] == '_')) {
    DAT_1800b1fe8 = DAT_1800b1fe8 + 3;
    FUN_180068bd8(local_18,'\0');
    FUN_180068bd8(local_18,'\0');
    cVar2 = *DAT_1800b1fe8;
    if (cVar2 != '\0') {
      do {
        if (cVar2 == '@') break;
        DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
        cVar2 = *DAT_1800b1fe8;
      } while (cVar2 != '\0');
      if (*DAT_1800b1fe8 != '\0') {
        DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
        *param_1 = local_28;
        *(undefined4 *)(param_1 + 1) = local_20;
        return param_1;
      }
    }
    DAT_1800b1fe8 = DAT_1800b1fe8 + -1;
    FUN_180065ae8(param_1,1);
  }
  else {
    DAT_1800b1fe8 = pcVar1;
    *(undefined4 *)(param_1 + 1) = 0;
    *param_1 = (DNameStatusNode *)0x0;
    *(undefined *)(param_1 + 1) = 2;
  }
  return param_1;
}



// Library Function - Single Match
// Name: ?getSymbolName@UnDecorator@@CA?AVDName@@XZ
// Library: Visual Studio 2015 Release
// private: static class DName __cdecl UnDecorator::getSymbolName(void)

DName UnDecorator::getSymbolName(void)

{
  longlong **in_RCX;

  if (*DAT_1800b1fe8 == '?') {
    if (DAT_1800b1fe8[1] == '$') {
      FUN_18006ba18(in_RCX,'\x01');
    }
    else {
      DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
      FUN_180069ae4(in_RCX,'\0',(undefined *)0x0);
    }
  }
  else {
    FUN_18006c314(in_RCX,'\x01','\0');
  }
  return SUB81(in_RCX,0);
}



void FUN_18006b334(DNameNode **param_1)

{
  char cVar1;
  byte bVar2;
  code *pcVar3;
  bool bVar4;
  bool bVar5;
  byte *pbVar6;
  bool bVar7;
  longlong *plVar8;
  bool bVar9;
  long lVar10;
  DNameStatusNode **ppDVar11;
  undefined *puVar12;
  DNameNode **ppDVar13;
  char *pcVar14;
  undefined8 *puVar15;
  undefined auStack296 [32];
  DNameStatusNode *local_108;
  undefined4 local_100;
  longlong *local_f8 [2];
  DNameStatusNode *local_e8;
  undefined4 local_e0;
  DNameNode *local_d8 [2];
  DNameNode *local_c8 [2];
  undefined8 local_b8 [2];
  DNameNode *local_a8 [2];
  longlong local_98 [2];
  undefined8 local_88 [2];
  longlong local_78 [2];
  undefined8 local_68 [2];
  DNameStatusNode *local_58 [2];
  char local_48 [16];
  ulonglong local_38;

  local_38 = DAT_1800b04e8 ^ (ulonglong)auStack296;
  *(undefined4 *)(param_1 + 1) = 0;
  *param_1 = (DNameNode *)0x0;
  DAT_1800b2009 = 1;
  cVar1 = *(char *)(param_1 + 1);
  pbVar6 = DAT_1800b1fe8;
  bVar7 = true;
  do {
    DAT_1800b1fe8 = pbVar6;
    if ((cVar1 != '\0') || ((*pbVar6 & 0xbf) == 0)) {
      DAT_1800b2009 = 0;
      FUN_18005f100(local_38 ^ (ulonglong)auStack296);
      return;
    }
    local_108 = (DNameStatusNode *)0x0;
    bVar4 = false;
    if (!bVar7) {
      bVar4 = bVar7;
    }
    local_100 = 0;
    bVar5 = false;
    if ((int)(char)*pbVar6 - 0x30U < 10) {
      DAT_1800b1fe8 = pbVar6 + 1;
      ppDVar11 = (DNameStatusNode **)
                 FUN_180065f44(DAT_1800b1fe0,local_b8,(int)(char)*pbVar6 - 0x30U);
      local_108 = *ppDVar11;
      local_100 = *(undefined4 *)(ppDVar11 + 1);
LAB_18006b5d7:
      if (local_108 != (DNameStatusNode *)0x0) {
        if (!bVar7) {
          FUN_180066328((longlong *)param_1,',');
        }
        FUN_1800662e4(param_1,(DNameNode **)&local_108);
        if (bVar5) {
          DName::operator__((DName *)param_1,"...");
        }
      }
    }
    else {
      if ((*pbVar6 != 0x24) || (pbVar6[1] != 0x24)) {
LAB_18006b41d:
        bVar2 = *DAT_1800b1fe8;
        if (bVar2 == 0x58) {
          DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
          pcVar14 = "void";
LAB_18006b434:
          FUN_180065ed0((longlong *)&local_108,pcVar14);
        }
        else {
          if ((bVar2 == 0x24) && (DAT_1800b1fe8[1] != 0x24)) {
            DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
            ppDVar11 = (DNameStatusNode **)FUN_18006b654(local_a8);
          }
          else {
            if (bVar2 == 0x3f) {
              FUN_18006ae98((DNameStatusNode **)local_f8);
              plVar8 = local_f8[0];
              if (((DAT_1800b2004 & 0x4000) == 0) || (DAT_1800b2010 == (code *)0x0)) {
                ppDVar13 = (DNameNode **)FUN_180065aa8(local_78,"`template-parameter");
                FUN_180066208(ppDVar13,local_c8,(DNameNode **)local_f8);
                puVar15 = local_68;
                ppDVar13 = local_c8;
              }
              else {
                if (local_f8[0] == (longlong *)0x0) {
                  local_48[0] = '\0';
                }
                else {
                  pcVar3 = *(code **)(*local_f8[0] + 0x10);
                  _guard_check_icall();
                  puVar12 = (undefined *)(*pcVar3)(plVar8,local_48);
                  *puVar12 = 0;
                }
                lVar10 = atol(local_48);
                pcVar3 = DAT_1800b2010;
                _guard_check_icall();
                pcVar14 = (char *)(*pcVar3)(lVar10);
                if (pcVar14 != (char *)0x0) goto LAB_18006b434;
                ppDVar13 = (DNameNode **)FUN_180065aa8(local_98,"`template-parameter");
                FUN_180066208(ppDVar13,local_d8,(DNameNode **)local_f8);
                puVar15 = local_88;
                ppDVar13 = local_d8;
              }
              ppDVar11 = (DNameStatusNode **)FUN_18006628c(ppDVar13,puVar15,"\'");
            }
            else {
              local_e8 = (DNameStatusNode *)0x0;
              local_e0 = 0;
              ppDVar11 = FUN_18006a2b8(local_58,&local_e8);
            }
          }
          local_108 = *ppDVar11;
          local_100 = *(undefined4 *)(ppDVar11 + 1);
        }
        if ((1 < (longlong)(DAT_1800b1fe8 + -(longlong)pbVar6)) && (*DAT_1800b1fe0 != 9)) {
          FUN_180066510(DAT_1800b1fe0,(longlong *)&local_108);
        }
        goto LAB_18006b5d7;
      }
      bVar2 = pbVar6[2];
      if (bVar2 == 0x24) {
        if (pbVar6[3] != 0x56) goto LAB_18006b41d;
        DAT_1800b1fe8 = pbVar6 + 4;
      }
      else {
        bVar9 = false;
        if (bVar2 == 0x55) {
LAB_18006b446:
          bVar5 = bVar9;
          DAT_1800b1fe8 = pbVar6 + 3;
          goto LAB_18006b41d;
        }
        if (bVar2 != 0x56) {
          if (bVar2 == 0x57) {
            bVar9 = true;
            goto LAB_18006b446;
          }
          if (bVar2 != 0x5a) goto LAB_18006b41d;
        }
        DAT_1800b1fe8 = pbVar6 + 3;
      }
    }
    cVar1 = *(char *)(param_1 + 1);
    pbVar6 = DAT_1800b1fe8;
    bVar7 = bVar4;
  } while( true );
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18006b654(DNameNode **param_1)

{
  char cVar1;
  code *pcVar2;
  uint uVar3;
  longlong *plVar4;
  DNameNode **ppDVar5;
  DNameStatusNode **ppDVar6;
  undefined *puVar7;
  char *pcVar8;
  int iVar9;
  undefined auStack264 [32];
  char local_e8 [8];
  DNameNode *local_e0 [2];
  longlong *local_d0;
  char local_c8;
  longlong local_c0 [2];
  DNameStatusNode *local_b0;
  undefined4 local_a8;
  undefined local_a1 [9];
  char local_98;
  char local_97;
  char local_96;
  ulonglong local_28;

  local_28 = DAT_1800b04e8 ^ (ulonglong)auStack264;
  cVar1 = *DAT_1800b1fe8;
  iVar9 = (int)cVar1;
  pcVar8 = DAT_1800b1fe8 + 1;
  if (0x4a < iVar9) {
    DAT_1800b1fe8 = pcVar8;
    if (iVar9 == 0x51) {
LAB_18006b8c7:
      *(undefined4 *)(param_1 + 1) = 0;
      *param_1 = (DNameNode *)0x0;
      *(undefined *)(param_1 + 1) = 2;
    }
    else {
      if (iVar9 != 0x52) {
        if (iVar9 == 0x53) {
          *param_1 = (DNameNode *)0x0;
          *(undefined4 *)(param_1 + 1) = 0;
          goto LAB_18006b8d3;
        }
        if (2 < iVar9 - 0x54U) goto LAB_18006b8c7;
      }
      FUN_18006ae98((DNameStatusNode **)&local_d0);
      if (local_d0 == (longlong *)0x0) {
        local_b0 = (DNameStatusNode *)((ulonglong)local_b0 & 0xffffffffffffff00);
      }
      else {
        pcVar2 = *(code **)(*local_d0 + 0x10);
        _guard_check_icall();
        puVar7 = (undefined *)(*pcVar2)(local_d0,&local_b0,local_a1);
        *puVar7 = 0;
      }
      uVar3 = atol((char *)&local_b0);
      pcVar2 = DAT_1800b2010;
      if (((DAT_1800b2004 & 0x4000) != 0) && (DAT_1800b2010 != (code *)0x0)) {
        _guard_check_icall();
        pcVar8 = (char *)(*pcVar2)(uVar3 & 0xfff);
        if (pcVar8 != (char *)0x0) goto LAB_18006b78c;
      }
      FUN_18003e5b0(&local_b0,0x10,&DAT_18007b7b0,(ulonglong)(uVar3 & 0xfff));
      FUN_180065aa8((longlong *)&local_d0,(char *)&local_b0);
      if ((iVar9 == 0x52) || (iVar9 == 0x54)) {
        pcVar8 = "`template-type-parameter-";
      }
      else {
        if (iVar9 == 0x55) {
          pcVar8 = "`generic-class-parameter-";
        }
        else {
          if (iVar9 != 0x56) goto LAB_18006b8c7;
          pcVar8 = "`generic-method-parameter-";
        }
      }
      ppDVar5 = (DNameNode **)FUN_180065aa8(local_c0,pcVar8);
      FUN_180066208(ppDVar5,local_e0,(DNameNode **)&local_d0);
      FUN_18006628c(local_e0,param_1,"\'");
    }
    goto LAB_18006b8d3;
  }
  if (iVar9 < 0x46) {
    if (cVar1 == '\0') {
LAB_18006b7d2:
      FUN_180065ae8((DNameStatusNode **)param_1,1);
      goto LAB_18006b8d3;
    }
    if (iVar9 == 0x30) {
      DAT_1800b1fe8 = pcVar8;
      FUN_18006ae98((DNameStatusNode **)param_1);
      goto LAB_18006b8d3;
    }
    if (iVar9 != 0x31) {
      if (iVar9 == 0x32) {
        DAT_1800b1fe8 = pcVar8;
        FUN_18006ae98((DNameStatusNode **)&local_d0);
        FUN_18006ae98(&local_b0);
        if (('\x01' < local_c8) || ('\x01' < (char)local_a8)) goto LAB_18006b7d2;
        pcVar8 = DName::getString((DName *)&local_d0,&local_97,99);
        if (pcVar8 != (char *)0x0) {
          local_98 = local_97;
          if (local_97 == '-') {
            local_97 = local_96;
            local_96 = '.';
          }
          else {
            local_97 = '.';
          }
          plVar4 = FUN_180065aa8((longlong *)local_e0,&local_98);
          ppDVar5 = (DNameNode **)FUN_180066234(plVar4,(longlong *)&local_d0,'e');
          ppDVar6 = &local_b0;
          goto LAB_18006b766;
        }
      }
      else {
        DAT_1800b1fe8 = pcVar8;
        if (iVar9 == 0x45) {
          FUN_18006893c(param_1);
          goto LAB_18006b8d3;
        }
      }
      goto LAB_18006b8c7;
    }
    if (*pcVar8 != '@') {
      DAT_1800b1fe8 = pcVar8;
      ppDVar6 = (DNameStatusNode **)FUN_18006893c(local_e0);
      ppDVar5 = (DNameNode **)FUN_180065aa8((longlong *)&local_d0,"&");
LAB_18006b766:
      FUN_180066208(ppDVar5,param_1,(DNameNode **)ppDVar6);
      goto LAB_18006b8d3;
    }
    DAT_1800b1fe8 = DAT_1800b1fe8 + 2;
    pcVar8 = "NULL";
LAB_18006b78c:
    FUN_180065aa8((longlong *)param_1,pcVar8);
    goto LAB_18006b8d3;
  }
  local_b0 = (DNameStatusNode *)0x0;
  local_a8 = 0;
  local_e8[0] = '{';
  DAT_1800b1fe8 = pcVar8;
  FUN_18006748c((longlong *)&local_b0,local_e8,1);
  if ((byte)(cVar1 + 0xb8U) < 3) {
    ppDVar5 = FUN_18006893c(local_e0);
    FUN_1800662e4((DNameNode **)&local_b0,ppDVar5);
    FUN_180066328((longlong *)&local_b0,',');
  }
  if (iVar9 == 0x46) {
LAB_18006b864:
    ppDVar6 = FUN_18006ae98((DNameStatusNode **)local_e0);
    FUN_1800662e4((DNameNode **)&local_b0,(DNameNode **)ppDVar6);
    FUN_180066328((longlong *)&local_b0,',');
LAB_18006b885:
    ppDVar6 = FUN_18006ae98((DNameStatusNode **)local_e0);
    FUN_1800662e4((DNameNode **)&local_b0,(DNameNode **)ppDVar6);
  }
  else {
    if (iVar9 == 0x47) {
LAB_18006b843:
      ppDVar6 = FUN_18006ae98((DNameStatusNode **)local_e0);
      FUN_1800662e4((DNameNode **)&local_b0,(DNameNode **)ppDVar6);
      FUN_180066328((longlong *)&local_b0,',');
      goto LAB_18006b864;
    }
    if (iVar9 == 0x48) goto LAB_18006b885;
    if (iVar9 == 0x49) goto LAB_18006b864;
    if (iVar9 == 0x4a) goto LAB_18006b843;
  }
  FUN_180066234((longlong *)&local_b0,(longlong *)param_1,'}');
LAB_18006b8d3:
  FUN_18005f100(local_28 ^ (ulonglong)auStack264);
  return;
}



longlong ** FUN_18006ba18(longlong **param_1,char param_2)

{
  code *pcVar1;
  undefined8 uVar2;
  longlong *plVar3;
  char cVar4;
  longlong **pplVar5;
  DNameNode **ppDVar6;
  char local_res18 [8];
  undefined8 local_res20;
  longlong *local_198;
  undefined4 local_190;
  undefined8 local_188;
  DNameNode *local_180;
  undefined4 local_178;
  longlong *local_170 [2];
  DNameNode *local_160 [3];
  undefined4 local_148 [24];
  undefined4 local_e8 [24];
  undefined4 local_88 [24];

  uVar2 = DAT_1800b1fd0;
  if ((*DAT_1800b1fe8 == '?') && (DAT_1800b1fe8[1] == '$')) {
    local_res20 = DAT_1800b1fd8;
    cVar4 = '\0';
    local_188 = DAT_1800b1fe0;
    DAT_1800b1fd0 = local_148;
    local_148[0] = 0xffffffff;
    DAT_1800b1fd8 = local_e8;
    DAT_1800b1fe0 = local_88;
    local_e8[0] = 0xffffffff;
    local_88[0] = 0xffffffff;
    local_res18[0] = '\0';
    if (DAT_1800b1fe8[2] == '?') {
      DAT_1800b1fe8 = DAT_1800b1fe8 + 3;
      pplVar5 = FUN_180069ae4(local_170,'\x01',local_res18);
      cVar4 = local_res18[0];
    }
    else {
      DAT_1800b1fe8 = DAT_1800b1fe8 + 2;
      pplVar5 = (longlong **)FUN_18006c314(local_170,'\x01','\x01');
    }
    local_198 = *pplVar5;
    local_190 = *(undefined4 *)(pplVar5 + 1);
    if (local_198 == (longlong *)0x0) {
      DAT_1800b2008 = 1;
    }
    if (cVar4 == '\0') {
      ppDVar6 = (DNameNode **)FUN_18006b334(local_160);
      local_180 = (DNameNode *)0x0;
      local_178 = 0;
      local_res18[0] = '<';
      FUN_18006748c((longlong *)&local_180,local_res18,1);
      FUN_180066208(&local_180,(DNameNode **)local_170,ppDVar6);
      FUN_1800662e4((DNameNode **)&local_198,(DNameNode **)local_170);
      plVar3 = local_198;
      if (local_198 != (longlong *)0x0) {
        pcVar1 = *(code **)(*local_198 + 8);
        _guard_check_icall();
        cVar4 = (*pcVar1)(plVar3);
        if (cVar4 == '>') {
          FUN_180066328((longlong *)&local_198,' ');
        }
      }
      FUN_180066328((longlong *)&local_198,'>');
      if ((param_2 != '\0') && (*DAT_1800b1fe8 != '\0')) {
        DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
      }
    }
    DAT_1800b1fd8 = (undefined4 *)local_res20;
    DAT_1800b1fe0 = (undefined4 *)local_188;
    *(undefined4 *)(param_1 + 1) = local_190;
    DAT_1800b1fd0 = (undefined4 *)uVar2;
    *param_1 = local_198;
  }
  else {
    *(undefined4 *)(param_1 + 1) = 0;
    *param_1 = (longlong *)0x0;
    *(undefined *)(param_1 + 1) = 2;
  }
  return param_1;
}



longlong * FUN_18006bc6c(longlong *param_1)

{
  DNameNode **ppDVar1;
  DNameNode **ppDVar2;
  longlong *plVar3;
  DNameNode *local_38 [2];
  DNameNode *local_28 [2];
  longlong local_18 [2];

  if (*DAT_1800b1fe8 == '\0') {
    plVar3 = FUN_180065aa8(local_18," throw(");
    ppDVar1 = (DNameNode **)FUN_1800662b8(plVar3,local_28,1);
  }
  else {
    if (*DAT_1800b1fe8 == 'Z') {
      DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
      *param_1 = 0;
      *(undefined4 *)(param_1 + 1) = 0;
      return param_1;
    }
    ppDVar1 = FUN_1800676c8(local_28);
    ppDVar2 = (DNameNode **)FUN_180065aa8(local_18," throw(");
    FUN_180066208(ppDVar2,local_38,ppDVar1);
    ppDVar1 = local_38;
  }
  FUN_180066234((longlong *)ppDVar1,param_1,')');
  return param_1;
}



ulonglong FUN_18006bd14(void)

{
  byte bVar1;
  ulonglong uVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  byte *pbVar6;
  byte *pbVar7;
  uint uVar8;
  byte bVar9;

  do {
    uVar4 = 0;
    uVar5 = 0x4000;
    if (*DAT_1800b1fe8 == 0x5f) {
      DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
      uVar4 = 0x4000;
    }
    bVar9 = 1;
    if ((byte)(*DAT_1800b1fe8 + 0xbf) < 0x1a) {
      uVar8 = (int)(char)*DAT_1800b1fe8 - 0x41;
      DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
      uVar5 = uVar4 | 0xa000;
      if ((uVar8 & 1) == 0) {
        uVar5 = uVar4 | 0x8000;
      }
      if (0x17 < (int)uVar8) goto LAB_18006c061;
      uVar4 = uVar8 & 0x18;
      pbVar6 = DAT_1800b1fe8;
      if (uVar4 == 0) {
        uVar5 = uVar5 | 0x840;
      }
      else {
        if (uVar4 == 8) {
          uVar5 = uVar5 | 0x880;
        }
        else {
          uVar5 = uVar5 | 0x800;
          if (uVar4 != 0x10) goto LAB_18006c029;
        }
      }
      uVar8 = uVar8 & 6;
      if (uVar8 == 0) goto LAB_18006c061;
      if (uVar8 == 2) {
        uVar5 = uVar5 | 0x200;
        goto LAB_18006c061;
      }
      if (uVar8 == 4) {
        uVar5 = uVar5 | 0x100;
      }
      else {
        if (uVar8 != 6) goto LAB_18006c029;
        uVar5 = uVar5 | 0x400;
      }
      goto LAB_18006c061;
    }
    if (*DAT_1800b1fe8 != 0x24) {
      bVar9 = *DAT_1800b1fe8;
      if (8 < (byte)(bVar9 - 0x30)) {
        if (bVar9 == 0x39) {
          DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
          uVar5 = 0xfffd;
        }
        else {
          uVar5 = (bVar9 != 0) + 0xfffe;
        }
        goto LAB_18006c061;
      }
      DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
      if (bVar9 == 0x30) {
        uVar5 = 0x800;
        goto LAB_18006c061;
      }
      if (bVar9 == 0x31) {
        uVar5 = 0x1000;
        goto LAB_18006c061;
      }
      if (bVar9 == 0x32) {
        uVar5 = 0;
        goto LAB_18006c061;
      }
      if (bVar9 == 0x33) goto LAB_18006c061;
      if (bVar9 == 0x34) {
        uVar5 = 0x2000;
        goto LAB_18006c061;
      }
      if (bVar9 == 0x35) {
        uVar5 = 0x6000;
        goto LAB_18006c061;
      }
      if (bVar9 == 0x36) {
        uVar5 = 0x6800;
        goto LAB_18006c061;
      }
      if (bVar9 == 0x37) {
        uVar5 = 0x7000;
      }
      else {
        pbVar6 = DAT_1800b1fe8;
        if (bVar9 != 0x38) goto LAB_18006c029;
        uVar5 = 0x7800;
      }
      goto LAB_18006c061;
    }
    pbVar6 = DAT_1800b1fe8 + 1;
    bVar1 = *pbVar6;
    if ('B' < (char)bVar1) {
      if (bVar1 == 0x43) {
        uVar5 = 0x7c00;
        goto LAB_18006bf0b;
      }
      if (bVar1 == 0x44) {
        uVar5 = uVar4 | 0x9100;
        goto LAB_18006bf0b;
      }
      if (bVar1 == 0x45) {
        uVar5 = uVar4 | 0x9200;
        goto LAB_18006bf0b;
      }
      if (bVar1 != 0x52) goto LAB_18006c029;
      pbVar6 = DAT_1800b1fe8 + 2;
      if (5 < (byte)(*pbVar6 - 0x30)) {
        DAT_1800b1fe8 = pbVar6;
        return (ulonglong)(0xffff - (*pbVar6 != 0));
      }
LAB_18006be9f:
      uVar4 = (bVar9 + 5) * 0x100 | uVar4;
      uVar5 = uVar4 | 0xa800;
      if ((*pbVar6 & 1) == 0) {
        uVar5 = uVar4 | 0x8800;
      }
      bVar9 = *pbVar6 & 6;
      if (bVar9 == 0) {
        uVar5 = uVar5 | 0x40;
        goto LAB_18006bf0b;
      }
      if (bVar9 != 2) {
        if (bVar9 == 4) goto LAB_18006bf0b;
        goto LAB_18006c029;
      }
      uVar5 = uVar5 | 0x80;
      goto LAB_18006bf0b;
    }
    if (bVar1 == 0x42) {
      uVar5 = uVar4 | 0x9800;
      goto LAB_18006bf0b;
    }
    if (bVar1 == 0) {
      uVar5 = 0xfffe;
      pbVar6 = DAT_1800b1fe8;
      goto LAB_18006bf0b;
    }
    if (bVar1 != 0x24) {
      if ((char)bVar1 < '0') goto LAB_18006c029;
      bVar9 = 0;
      if ((char)bVar1 < '6') goto LAB_18006be9f;
      if (bVar1 != 0x41) goto LAB_18006c029;
      uVar5 = uVar4 | 0x9000;
      goto LAB_18006bf0b;
    }
    pbVar7 = pbVar6;
    if (DAT_1800b1fe8[2] == 0x50) {
      pbVar7 = DAT_1800b1fe8 + 2;
    }
    pbVar6 = pbVar7 + 1;
    iVar3 = (int)(char)*pbVar6;
    if (iVar3 < 0x4e) {
      if (iVar3 < 0x4c) {
        if (iVar3 == 0) {
          DAT_1800b1fe8 = pbVar6;
          return 0xfffe;
        }
        if ((iVar3 - 0x46U & 0xfffffffd) != 0) {
          if (iVar3 == 0x4a) {
LAB_18006bde6:
            pbVar6 = pbVar7 + 2;
            if ((byte)(*pbVar6 - 0x30) < 10) {
              DAT_1800b1fe8 = pbVar6 + ((char)*pbVar6 + -0x2f);
              uVar2 = FUN_18006bd14();
              uVar2 = (ulonglong)((uint)uVar2 | 0x10000);
            }
            else {
              uVar5 = 0xffff;
LAB_18006bf0b:
              DAT_1800b1fe8 = pbVar6 + 1;
LAB_18006c061:
              uVar2 = (ulonglong)uVar5;
            }
          }
          else {
LAB_18006c029:
            DAT_1800b1fe8 = pbVar6;
            uVar2 = 0xffff;
          }
          return uVar2;
        }
      }
    }
    else {
      if (iVar3 < 0x50) goto LAB_18006bde6;
      if ((iVar3 != 0x51) && (iVar3 != 0x68)) goto LAB_18006c029;
    }
    DAT_1800b1fe8 = pbVar7 + 2;
  } while( true );
}



DNameNode ** FUN_18006c0d8(DNameNode **param_1,DNameNode **param_2)

{
  DNameStatusNode **ppDVar1;
  DNameStatusNode *local_18 [2];

  *param_1 = *param_2;
  *(undefined4 *)(param_1 + 1) = *(undefined4 *)(param_2 + 1);
  DName::operator__((DName *)param_1,"{for ");
  ppDVar1 = FUN_18006a920(local_18);
  FUN_1800662e4(param_1,(DNameNode **)ppDVar1);
  FUN_180066328((longlong *)param_1,'}');
  if (*DAT_1800b1fe8 == '@') {
    DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
  }
  return param_1;
}



DNameNode ** FUN_18006c138(DNameNode **param_1,DNameNode **param_2)

{
  undefined4 uVar1;
  DNameNode **ppDVar2;
  DNameStatusNode **ppDVar3;
  char *pcVar4;
  char local_res8 [8];
  DNameNode *local_58;
  undefined4 local_50;
  DNameNode *local_48;
  undefined4 local_40;
  DNameStatusNode *local_38 [2];
  longlong local_28 [2];
  DNameNode *local_18 [2];

  *param_1 = *param_2;
  uVar1 = *(undefined4 *)(param_2 + 1);
  *(undefined4 *)(param_1 + 1) = uVar1;
  if ((char)uVar1 < '\x02') {
    if (*DAT_1800b1fe8 == 0) {
      ppDVar3 = FUN_180065ae8((DNameStatusNode **)local_18,1);
      FUN_180066208((DNameNode **)ppDVar3,&local_48,param_1);
      *param_1 = local_48;
      *(undefined4 *)(param_1 + 1) = local_40;
    }
    else {
      local_58 = (DNameNode *)0x0;
      local_50 = 0;
      local_48 = (DNameNode *)0x0;
      local_40 = 0;
      FUN_180068078(local_38,&local_48,"",&local_58,0);
      ppDVar2 = (DNameNode **)FUN_180066234((longlong *)local_38,local_28,' ');
      ppDVar2 = FUN_180066208(ppDVar2,local_18,param_1);
      *param_1 = *ppDVar2;
      uVar1 = *(undefined4 *)(ppDVar2 + 1);
      *(undefined4 *)(param_1 + 1) = uVar1;
      if ((char)uVar1 < '\x02') {
        if (*DAT_1800b1fe8 != 0x40) {
          pcVar4 = "{for ";
          do {
            DName::operator__((DName *)param_1,pcVar4);
            do {
              if ('\x01' < *(char *)(param_1 + 1)) {
LAB_18006c2c0:
                if (*DAT_1800b1fe8 != 0x40) {
                  return param_1;
                }
                goto LAB_18006c2c5;
              }
              if ((*DAT_1800b1fe8 & 0xbf) == 0) {
                if (*(char *)(param_1 + 1) < '\x02') {
                  if (*DAT_1800b1fe8 == 0) {
                    DName::operator__((DName *)param_1,1);
                  }
                  FUN_180066328((longlong *)param_1,'}');
                }
                goto LAB_18006c2c0;
              }
              ppDVar3 = FUN_18006a920((DNameStatusNode **)local_18);
              local_58 = (DNameNode *)0x0;
              local_50 = 0;
              local_res8[0] = '`';
              FUN_18006748c((longlong *)&local_58,local_res8,1);
              FUN_180066208(&local_58,(DNameNode **)local_38,(DNameNode **)ppDVar3);
              ppDVar2 = (DNameNode **)FUN_180066234((longlong *)local_38,local_28,'\'');
              FUN_1800662e4(param_1,ppDVar2);
              if (*DAT_1800b1fe8 == 0x40) {
                DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
              }
              if ('\x01' < *(char *)(param_1 + 1)) goto LAB_18006c2c0;
            } while (*DAT_1800b1fe8 == 0x40);
            pcVar4 = "s ";
          } while( true );
        }
LAB_18006c2c5:
        DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
      }
    }
  }
  return param_1;
}



void FUN_18006c314(longlong **param_1,char param_2,char param_3)

{
  char cVar1;
  code *pcVar2;
  long lVar3;
  longlong **pplVar4;
  char *pcVar5;
  undefined *puVar6;
  DNameNode **ppDVar7;
  char *pcVar8;
  longlong *plVar9;
  int iVar10;
  char *pcVar11;
  undefined auStack168 [32];
  longlong *local_88;
  undefined4 local_80;
  longlong *local_70 [2];
  longlong *local_60 [2];
  longlong local_50 [2];
  longlong local_40 [2];
  char local_30 [15];
  undefined local_21;
  ulonglong local_20;

  local_20 = DAT_1800b04e8 ^ (ulonglong)auStack168;
  cVar1 = *DAT_1800b1fe8;
  if ((int)cVar1 - 0x30U < 10) {
    DAT_1800b1fe8 = DAT_1800b1fe8 + 1;
    FUN_180065f44(DAT_1800b1fd8,param_1,(int)cVar1 - 0x30U);
    goto LAB_18006c5ca;
  }
  local_88 = (longlong *)0x0;
  local_80 = 0;
  if (*DAT_1800b1fe8 == '?') {
    pplVar4 = FUN_18006ba18(local_70,'\0');
    local_88 = *pplVar4;
    local_80 = *(undefined4 *)(pplVar4 + 1);
    pcVar8 = DAT_1800b1fe8 + 1;
    if (*DAT_1800b1fe8 != '@') {
      FUN_180065f08((DNameStatusNode **)&local_88,(ulonglong)((*DAT_1800b1fe8 != '\0') + 1));
      pcVar8 = DAT_1800b1fe8;
    }
  }
  else {
    pcVar11 = "template-parameter-";
    pcVar5 = "template-parameter-";
    iVar10 = 0x12;
    pcVar8 = DAT_1800b1fe8;
    do {
      if ((*pcVar8 == '\0') || (*pcVar8 != *pcVar5)) break;
      pcVar8 = pcVar8 + 1;
      pcVar5 = pcVar5 + 1;
      iVar10 = iVar10 + -1;
    } while (iVar10 != 0);
    if (*pcVar8 == *pcVar5) {
      DAT_1800b1fe8 = DAT_1800b1fe8 + 0x13;
    }
    else {
      pcVar11 = "generic-type-";
      pcVar5 = "generic-type-";
      iVar10 = 0xc;
      pcVar8 = DAT_1800b1fe8;
      do {
        if ((*pcVar8 == '\0') || (*pcVar8 != *pcVar5)) break;
        pcVar8 = pcVar8 + 1;
        pcVar5 = pcVar5 + 1;
        iVar10 = iVar10 + -1;
      } while (iVar10 != 0);
      if (*pcVar8 != *pcVar5) {
        if ((param_3 == '\0') || (*DAT_1800b1fe8 != '@')) {
          pplVar4 = (longlong **)FUN_180065904(local_50,(byte **)&DAT_1800b1fe8,0x40);
          local_88 = *pplVar4;
          local_80 = *(undefined4 *)(pplVar4 + 1);
          pcVar8 = DAT_1800b1fe8;
        }
        else {
          local_88 = (longlong *)0x0;
          local_80 = 0;
          pcVar8 = DAT_1800b1fe8 + 1;
        }
        goto LAB_18006c5a3;
      }
      DAT_1800b1fe8 = DAT_1800b1fe8 + 0xd;
    }
    FUN_18006ae98((DNameStatusNode **)local_60);
    if (((DAT_1800b2004 & 0x4000) == 0) || (DAT_1800b2010 == (code *)0x0)) {
      FUN_180065ed0((longlong *)&local_88,"`");
      ppDVar7 = (DNameNode **)FUN_180065aa8(local_50,pcVar11);
      FUN_180066208(ppDVar7,(DNameNode **)local_70,(DNameNode **)local_60);
      plVar9 = local_40;
    }
    else {
      if (local_60[0] == (longlong *)0x0) {
        local_30[0] = '\0';
      }
      else {
        pcVar2 = *(code **)(*local_60[0] + 0x10);
        _guard_check_icall();
        puVar6 = (undefined *)(*pcVar2)(local_60[0],local_30,&local_21);
        *puVar6 = 0;
      }
      lVar3 = atol(local_30);
      pcVar2 = DAT_1800b2010;
      _guard_check_icall();
      pcVar8 = (char *)(*pcVar2)(lVar3);
      if (pcVar8 != (char *)0x0) {
        FUN_180065ed0((longlong *)&local_88,pcVar8);
        pcVar8 = DAT_1800b1fe8;
        goto LAB_18006c5a3;
      }
      FUN_180065ed0((longlong *)&local_88,"`");
      ppDVar7 = (DNameNode **)FUN_180065aa8(local_40,pcVar11);
      FUN_180066208(ppDVar7,(DNameNode **)local_70,(DNameNode **)local_60);
      plVar9 = local_50;
    }
    ppDVar7 = (DNameNode **)FUN_18006628c(local_70,plVar9,"\'");
    FUN_1800662e4((DNameNode **)&local_88,ppDVar7);
    pcVar8 = DAT_1800b1fe8;
  }
LAB_18006c5a3:
  DAT_1800b1fe8 = pcVar8;
  if ((param_2 != '\0') && (*DAT_1800b1fd8 != 9)) {
    FUN_180066510(DAT_1800b1fd8,(longlong *)&local_88);
  }
  *param_1 = local_88;
  *(undefined4 *)(param_1 + 1) = local_80;
LAB_18006c5ca:
  FUN_18005f100(local_20 ^ (ulonglong)auStack168);
  return;
}



ulonglong FUN_18006c6d4(longlong param_1)

{
  return (ulonglong)*(uint *)(param_1 + 0xc);
}



undefined8 FUN_18006c6d8(void)

{
  return 1;
}



undefined8 FUN_18006c6e0(longlong param_1)

{
  code **ppcVar1;
  code *pcVar2;
  undefined8 uVar3;

  uVar3 = 0;
  if ((*(code ***)(param_1 + 8) != (code **)0x0) &&
     (ppcVar1 = (code **)**(code ***)(param_1 + 8), ppcVar1 != (code **)0x0)) {
    pcVar2 = *(code **)*ppcVar1;
    _guard_check_icall();
    uVar3 = (*pcVar2)(ppcVar1);
  }
  return uVar3;
}



ulonglong FUN_18006c71c(longlong param_1)

{
  code **ppcVar1;
  code **ppcVar2;
  code *pcVar3;
  int iVar4;
  int iVar5;

  if (*(int *)(param_1 + 0x18) < 0) {
    ppcVar1 = *(code ***)(param_1 + 0x10);
    ppcVar2 = *(code ***)(param_1 + 8);
    pcVar3 = *(code **)*ppcVar1;
    _guard_check_icall();
    iVar4 = (*pcVar3)(ppcVar1);
    pcVar3 = *(code **)*ppcVar2;
    _guard_check_icall();
    iVar5 = (*pcVar3)(ppcVar2);
    *(int *)(param_1 + 0x18) = iVar4 + iVar5;
  }
  return (ulonglong)*(uint *)(param_1 + 0x18);
}



ulonglong FUN_18006c788(longlong param_1)

{
  return (ulonglong)*(uint *)(param_1 + 0x10);
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
// Name: ?make@DNameStatusNode@@SAPEAV1@W4DNameStatus@@@Z
// Library: Visual Studio 2015 Release
// public: static class DNameStatusNode * __ptr64 __cdecl DNameStatusNode::make(enum DNameStatus)

DNameStatusNode * DNameStatusNode::make(DNameStatus param_1)

{
  if ((DAT_1800b2080 & 1) == 0) {
    DAT_1800b2080 = DAT_1800b2080 | 1;
    _DAT_1800b2058 = 1;
    _DAT_1800b2048 = 0;
    _DAT_1800b2040 = vftable;
    _DAT_1800b2050 = vftable;
    _DAT_1800b2060 = vftable;
    _DAT_1800b2070 = vftable;
    _DAT_1800b205c = 4;
    _DAT_1800b2068 = 2;
    _DAT_1800b2078 = 3;
  }
  if (param_1 < 4) {
    return (DNameStatusNode *)(&DAT_1800b2040 + (longlong)(int)param_1 * 0x10);
  }
  return (DNameStatusNode *)&DAT_1800b2070;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

char * FUN_18006c97c(char *param_1,char *param_2,int param_3,longlong param_4,undefined8 param_5,
                    FuncDef7 *param_6,ulong param_7)

{
  char *pcVar1;
  UnDecorator local_b8 [176];

  if (param_4 == 0) {
    pcVar1 = (char *)0x0;
  }
  else {
    FUN_180064f74(0);
    _DAT_1800b2020 = param_5;
    _DAT_1800b2038 = 0;
    _DAT_1800b2028 = ZEXT816(0);
    DAT_1800b2018 = param_4;
    UnDecorator::UnDecorator(local_b8,param_1,param_2,param_3,param_6,param_7);
    pcVar1 = FUN_180065f84();
    FUN_1800665a0((longlong)&DAT_1800b2018);
    FUN_180064fc8(0);
  }
  return pcVar1;
}



// Library Function - Single Match
// Name: _CallSettingFrame
// Library: Visual Studio 2015 Release

void _CallSettingFrame(void)

{
  code *pcVar1;

  pcVar1 = (code *)FUN_180064e80();
  (*pcVar1)();
  FUN_180064eb0();
  FUN_180064e80();
  return;
}



BOOL IsProcessorFeaturePresent(DWORD ProcessorFeature)

{
  BOOL BVar1;

                    // WARNING: Could not recover jumptable at 0x00018006cb2a. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = IsProcessorFeaturePresent(ProcessorFeature);
  return BVar1;
}



void _initterm(void)

{
                    // WARNING: Could not recover jumptable at 0x00018006cbb4. Too many branches
                    // WARNING: Treating indirect jump as call
  _initterm();
  return;
}



void _initterm_e(void)

{
                    // WARNING: Could not recover jumptable at 0x00018006cbba. Too many branches
                    // WARNING: Treating indirect jump as call
  _initterm_e();
  return;
}



int _callnewh(size_t _Size)

{
  int iVar1;

                    // WARNING: Could not recover jumptable at 0x00018006cbc0. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = _callnewh(_Size);
  return iVar1;
}



void _configure_narrow_argv(void)

{
                    // WARNING: Could not recover jumptable at 0x00018006cbcc. Too many branches
                    // WARNING: Treating indirect jump as call
  _configure_narrow_argv();
  return;
}



void _initialize_narrow_environment(void)

{
                    // WARNING: Could not recover jumptable at 0x00018006cbd2. Too many branches
                    // WARNING: Treating indirect jump as call
  _initialize_narrow_environment();
  return;
}



void _initialize_onexit_table(void)

{
                    // WARNING: Could not recover jumptable at 0x00018006cbd8. Too many branches
                    // WARNING: Treating indirect jump as call
  _initialize_onexit_table();
  return;
}



void _register_onexit_function(void)

{
                    // WARNING: Could not recover jumptable at 0x00018006cbde. Too many branches
                    // WARNING: Treating indirect jump as call
  _register_onexit_function();
  return;
}



void _crt_atexit(void)

{
                    // WARNING: Could not recover jumptable at 0x00018006cbea. Too many branches
                    // WARNING: Treating indirect jump as call
  _crt_atexit();
  return;
}



void _cexit(void)

{
                    // WARNING: Could not recover jumptable at 0x00018006cbf6. Too many branches
                    // WARNING: Treating indirect jump as call
  _cexit();
  return;
}



void terminate(void)

{
                    // WARNING: Could not recover jumptable at 0x00018006cbfc. Too many branches
                    // WARNING: Treating indirect jump as call
  terminate();
  return;
}



void abort(void)

{
                    // WARNING: Could not recover jumptable at 0x00018006cc02. Too many branches
                    // WARNING: Treating indirect jump as call
  abort();
  return;
}



void _free_base(void)

{
                    // WARNING: Could not recover jumptable at 0x00018006cc08. Too many branches
                    // WARNING: Treating indirect jump as call
  _free_base();
  return;
}



errno_t strcpy_s(char *_Dst,rsize_t _SizeInBytes,char *_Src)

{
  errno_t eVar1;

                    // WARNING: Could not recover jumptable at 0x00018006cc14. Too many branches
                    // WARNING: Treating indirect jump as call
  eVar1 = strcpy_s(_Dst,_SizeInBytes,_Src);
  return eVar1;
}



void _calloc_base(void)

{
                    // WARNING: Could not recover jumptable at 0x00018006cc1a. Too many branches
                    // WARNING: Treating indirect jump as call
  _calloc_base();
  return;
}



int wcsncmp(wchar_t *_Str1,wchar_t *_Str2,size_t _MaxCount)

{
  int iVar1;

                    // WARNING: Could not recover jumptable at 0x00018006cc20. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = wcsncmp(_Str1,_Str2,_MaxCount);
  return iVar1;
}



long atol(char *_Str)

{
  long lVar1;

                    // WARNING: Could not recover jumptable at 0x00018006cc26. Too many branches
                    // WARNING: Treating indirect jump as call
  lVar1 = atol(_Str);
  return lVar1;
}



void thunk_FUN_18005f1cc(size_t param_1)

{
  code *pcVar1;
  int iVar2;
  void *pvVar3;

  do {
    pvVar3 = malloc(param_1);
    if (pvVar3 != (void *)0x0) {
      return;
    }
    iVar2 = _callnewh(param_1);
  } while (iVar2 != 0);
  if (param_1 != 0xffffffffffffffff) {
    FUN_18006013c();
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  FUN_18006015c();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



// Library Function - Single Match
// Name: __GSHandlerCheck_SEH
// Library: Visual Studio 2015 Release

void __GSHandlerCheck_SEH
               (PEXCEPTION_RECORD param_1,PVOID param_2,undefined8 param_3,longlong *param_4)

{
  uint *puVar1;

  puVar1 = (uint *)param_4[7] + (ulonglong)*(uint *)param_4[7] * 4;
  FUN_18005f088((ulonglong)param_2,(longlong)param_4,puVar1 + 1);
  if ((puVar1[1] & ((param_1->ExceptionFlags & 0x66) != 0) + 1) != 0) {
    FUN_180062f34(param_1,param_2,param_3,param_4);
  }
  return;
}



// Library Function - Single Match
// Name: _FindPESection
// Library: Visual Studio 2015 Release

PIMAGE_SECTION_HEADER _FindPESection(PBYTE pImageBase,DWORD_PTR rva)

{
  PIMAGE_SECTION_HEADER p_Var1;
  PBYTE pBVar2;
  uint uVar3;

  uVar3 = 0;
  pBVar2 = pImageBase + *(int *)(pImageBase + 0x3c);
  p_Var1 = (PIMAGE_SECTION_HEADER)(pBVar2 + (ulonglong)*(ushort *)(pBVar2 + 0x14) + 0x18);
  if (*(ushort *)(pBVar2 + 6) != 0) {
    do {
      if ((p_Var1->VirtualAddress <= rva) && (rva < p_Var1->Misc + p_Var1->VirtualAddress)) {
        return p_Var1;
      }
      uVar3 = uVar3 + 1;
      p_Var1 = p_Var1 + 1;
    } while (uVar3 < *(ushort *)(pBVar2 + 6));
  }
  return (PIMAGE_SECTION_HEADER)0x0;
}



// Library Function - Single Match
// Name: _IsNonwritableInCurrentImage
// Library: Visual Studio 2015 Release

BOOL _IsNonwritableInCurrentImage(PBYTE pTarget)

{
  uint uVar1;
  PIMAGE_SECTION_HEADER p_Var2;

  uVar1 = _ValidateImageBase((PBYTE)&IMAGE_DOS_HEADER_180000000);
  p_Var2 = (PIMAGE_SECTION_HEADER)(ulonglong)uVar1;
  if (uVar1 != 0) {
    p_Var2 = _FindPESection((PBYTE)&IMAGE_DOS_HEADER_180000000,(DWORD_PTR)(pTarget + -0x180000000));
    if (p_Var2 != (PIMAGE_SECTION_HEADER)0x0) {
      p_Var2 = (PIMAGE_SECTION_HEADER)(ulonglong)(~(p_Var2->Characteristics >> 0x1f) & 1);
    }
  }
  return (BOOL)p_Var2;
}



// Library Function - Single Match
// Name: _ValidateImageBase
// Library: Visual Studio 2015 Release

BOOL _ValidateImageBase(PBYTE pImageBase)

{
  uint uVar1;

  if (*(short *)pImageBase != 0x5a4d) {
    return 0;
  }
  uVar1 = 0;
  if (*(int *)(pImageBase + *(int *)(pImageBase + 0x3c)) == 0x4550) {
    uVar1 = (uint)(*(short *)((longlong)(pImageBase + *(int *)(pImageBase + 0x3c)) + 0x18) == 0x20b)
    ;
  }
  return (BOOL)uVar1;
}



undefined FUN_18006cd90(void)

{
  return 1;
}



undefined FUN_18006cd94(void)

{
  return 1;
}



undefined FUN_18006cd98(void)

{
  return 1;
}



undefined FUN_18006cd9c(void)

{
  return 1;
}



undefined FUN_18006cda0(void)

{
  return 1;
}



undefined8 FUN_18006cda4(void)

{
  return 0;
}



undefined * Catch_18006cf70(void)

{
  return &DAT_18004bba9;
}



void Catch_All_18006cf90(undefined8 param_1,longlong param_2)

{
  code *pcVar1;

  FUN_18005e980(*(undefined8 *)(param_2 + 0x40),*(void **)(param_2 + 0x48));
  _CxxThrowException((void *)0x0,(ThrowInfo *)0x0);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void Catch_All_18006cfc0(void)

{
  code *pcVar1;

  _CxxThrowException((void *)0x0,(ThrowInfo *)0x0);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void Catch_All_18006cfe0(undefined8 param_1,longlong param_2)

{
  code *pcVar1;

  FUN_18005e990(*(undefined8 *)(param_2 + 0x40),*(void **)(param_2 + 0x48),1);
  _CxxThrowException((void *)0x0,(ThrowInfo *)0x0);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void Catch_All_18006d010(undefined8 param_1,longlong param_2)

{
  longlong lVar1;

  FUN_18005e990(*(undefined8 *)(param_2 + 0x40),*(void **)(param_2 + 0x48),1);
  lVar1 = 0;
  _CxxThrowException((void *)0x0,(ThrowInfo *)0x0);
  __scrt_release_startup_lock(*(char *)(lVar1 + 0x40));
  return;
}



void FUN_18006d051(undefined8 param_1,longlong param_2)

{
  FUN_18005f464();
  __scrt_release_startup_lock(*(char *)(param_2 + 0x38));
  return;
}



void FUN_18006d06d(uint **param_1,longlong param_2)

{
  FUN_18005f3d0(*(undefined8 *)(param_2 + 0x60),*(int *)(param_2 + 0x68),
                *(undefined8 *)(param_2 + 0x70),FUN_18005ece4,**param_1,param_1);
  return;
}



undefined * Catch_All_18006d0c0(void)

{
  return &LAB_1800607a4;
}



ulonglong FUN_18006d16c(undefined8 param_1,longlong param_2)

{
  return (ulonglong)(*(char *)(param_2 + 0x38) != '\0');
}



void FUN_18006d184(_EXCEPTION_POINTERS *param_1,longlong param_2)

{
  *(_EXCEPTION_POINTERS **)(param_2 + 0x58) = param_1;
  ExFilterRethrow(param_1,*(EHExceptionRecord **)(param_2 + 0xb8),(int *)(param_2 + 0x20));
  return;
}



void FUN_18006d221(int **param_1)

{
  __FrameUnwindFilter(param_1);
  return;
}



// Library Function - Single Match
// Name: __FrameUnwindToState$fin$1
// Library: Visual Studio 2015 Release

void __FrameUnwindToState_fin_1(void)

{
  longlong lVar1;

  lVar1 = __vcrt_getptd();
  if (0 < *(int *)(lVar1 + 0x30)) {
    lVar1 = __vcrt_getptd();
    *(int *)(lVar1 + 0x30) = *(int *)(lVar1 + 0x30) + -1;
  }
  return;
}



void FUN_18006d25a(void)

{
  FUN_180064fc8(0);
  return;
}



void FUN_18006d270(void)

{
  FUN_180064fc8(0);
  return;
}



ulonglong FUN_18006d290(int **param_1)

{
  return (ulonglong)(**param_1 == -0x3ffffffb);
}


